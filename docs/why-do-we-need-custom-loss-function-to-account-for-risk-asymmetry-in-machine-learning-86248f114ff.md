# 机器学习中为什么需要自定义损失函数

> 原文：<https://medium.com/mlearning-ai/why-do-we-need-custom-loss-function-to-account-for-risk-asymmetry-in-machine-learning-86248f114ff?source=collection_archive---------0----------------------->

## 机器学习模型的预测越准确并不总是带来更高的利润

![](img/2ce1e8991fd52ea4a3ddb3b54dff1a13.png)

Photo by [Fabrice Villard](https://unsplash.com/photos/QrRSm-QbjW0) on [Unsplash](https://unsplash.com/s/photos/three-doors?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

# 介绍

如果你在山顶上，正在寻找去山脚的路，损失函数就像一个指南针，会指引你下山。然而，如果你想到达山麓的某个特定位置，专门指向该特定位置的自定义指南针可以比一般指南针更快、更准确地引导你到达期望的目的地，这就是自定义丢失功能的好处。

# 什么是损失函数？

损失函数用于评估机器学习模型对数据集每一次观察的表现。损耗越低，模型的性能越好。一些优化或搜索算法，例如梯度下降，用于通过改变模型的参数来最小化总损失函数(成本函数),这也涉及机器学习中的训练过程。简单来说，当你在山顶寻找到达山脚的路时，损失函数就像一个指南针。

# 损失和成本函数之间的差异

损失函数仅从数据的单个观察值计算，而成本函数是来自数据集的所有损失函数的平均值。例如 MSE(均方误差)，MSE 本身是成本函数，而 SE(均方误差)是损失函数。

# 常见损失函数

## 1.绝对误差

通过取预测值和实际值之差的绝对值(防止负值抵消损失)来计算误差。AE 的成本函数是 MAE。

![](img/669b20ed7fc05de0f9754f7422ef1670.png)

Absolute Error Loss

## 2.平方误差

这里，误差被平方(而不是取绝对值，仍然防止负值),这比小误差更不利于大误差。SE 的成本函数是 MSE。

![](img/b8ee9ef4b41ac09c134f3e56ebc1bc3a.png)

Squared Error Loss

# 为什么我们需要自定义损失函数？

有时，机器学习模型的预测越准确并不总是意味着对业务越有利，因为数据科学指标和业务指标之间可能存在一些偏差。因此，为了将机器学习模型驱动到与商业目标相同的目标，定制损失函数是至关重要的。

# 什么是风险不对称，为什么它很重要？

当你在家的时候，需要计划好什么时候准时去面试。你不希望去得太早，因为你必须等待面试时间，可能不得不浪费你的钱来买一杯昂贵的咖啡。你也不想去得太晚，因为你可能会因为不负责任而被拒绝。然而，走得太早的风险比走得太晚的风险要低得多。等待的代价比不上失业的代价。这就是风险不对称。

一些业务目标可能存在风险不对称。以回归问题为例，由过度预测(当预测值高于实际值时)导致的业务成本可能不总是等于由欠预测(当预测值低于实际值时)导致的业务成本。如果过度预测的成本高于预测不足，机器学习模型应该以某种方式考虑这一点，并更倾向于预测不足，以降低整体业务成本。

正如我们从上面的 AE 和 SE 图中看到的损失函数曲线，曲线是对称的，这意味着它们同等地惩罚了过度预测和欠预测。这就是为什么自定义损失函数很重要。