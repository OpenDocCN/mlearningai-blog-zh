<html>
<head>
<title>Decoding strategies in language modelling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">语言建模中的解码策略</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/decoding-strategies-in-language-modelling-c5752710e31a?source=collection_archive---------7-----------------------#2022-01-28">https://medium.com/mlearning-ai/decoding-strategies-in-language-modelling-c5752710e31a?source=collection_archive---------7-----------------------#2022-01-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5171" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">语言模型可以计算出词汇表中任何给定单词出现在输入序列之后的概率。但是他们如何选择实际输出哪一个呢？</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/507f28002608992f130d9a7f35d6ea2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*tWBYV3HrciXJ_0MG.gif"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">How does the decoder choose the words “please”, “come” and “here” given the probability of every word in its vocabulary? Source: <a class="ae jo" href="https://towardsdatascience.com/gpt-3-rnns-and-all-that-deep-dive-into-language-modelling-7f67658ba0d5" rel="noopener" target="_blank">GPT-3, RNNs and all that: A deep-dive into language modelling</a>.</figcaption></figure><p id="122f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在高层次上，现代语言模型是这样工作的:你输入一系列单词，然后一个“编码器网络”逐个处理它们。该编码器网络的输出然后被传递到“解码器网络”,该“解码器网络”将输出单词序列。在每一步，解码器网络可以为它知道的词汇表中的每个单词分配一个概率。但是考虑到概率，你需要给模型一个策略来选择输出哪些单词。这种策略被称为<strong class="ig hi">解码器策略</strong>。</p><p id="b7fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最简单的一个是<strong class="ig hi">贪婪策略</strong>:在每一步，简单地输出最可能的单词。</p><p id="80a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，在第一个绿色节点中，解码器RNN会为其词汇表中的每个单词分配一个概率，并简单地选择最可能的一个。这是一个很好的策略，它倾向于产生连贯的输出。但是如果应用程序类似于聊天机器人，你可能会发现这会产生相当无聊的对话。例如:</p><blockquote class="jp jq jr"><p id="ee08" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated"><strong class="ig hi">输入</strong>:你觉得这本书怎么样？<br/> <strong class="ig hi">贪婪策略输出</strong>:耶没事。<br/> <strong class="ig hi">输出更好</strong>:我发现超级有意思。</p></blockquote><p id="1ba3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">贪婪搜索的一个简单变体是<strong class="ig hi"> top-k sampling </strong>:挑选一个数字<strong class="ig hi"> k </strong>，取k个最有可能的单词和它们各自的概率。然后将概率归一化，并根据获得的概率分布对其进行采样。所以，不是每一步只取最有可能的单词，而是从k个最有可能的单词中选择，你如何选择是通过使用这些单词的标准化概率分布。例如，如果k=5，归一化的概率是[0.45，0.25，0.2，0.05，0.05]，那么你会在45%的时间里选择最有可能的单词，在25%的时间里选择第二有可能的单词，等等……这就是<a class="ae jo" href="https://www.infoq.com/news/2021/07/eleutherai-gpt-j/" rel="noopener ugc nofollow" target="_blank"> GPT-J </a>，EleutherAI的GPT-3的开源替代品所做的。</p><p id="3b53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">理想情况下，我们可以计算每一个可能的输出句子(单词序列)的可能性。这就是<strong class="ig hi">穷举搜索</strong>:如果你想要5个单词的输出，把所有可能的5个单词的句子串在一起，给它们都分配一个概率，选择最有可能的一个。问题是，如果你的词汇表中有n个单词，你需要考虑N⁵可能的输出。N的典型值是10000，因此计算量很大。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jw"><img src="../Images/b3a81d21c201f2240ad62ca356accb5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*kXOZEHrYIB-2O7Pl0BWtiA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Beam search with beam width B=3. For each possible word in the vocabulary {e, a, b} we consider the three most likely examples. Edited from <a class="ae jo" href="https://github.com/distillpub/post--ctc/issues/4" rel="noopener ugc nofollow" target="_blank">source</a>.</figcaption></figure><p id="219b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">采用这种想法并使其计算成本稍微降低的一种方法是进行<strong class="ig hi">波束搜索</strong>。这结合了上述所有策略的思想。挑梁宽度<strong class="ig hi"> B </strong>。在输出的每一步:选择B个最有可能的单词，然后针对这B个可能性中的每一个，考虑B个最有可能的下一个单词。这样做，直到输出是所需的长度。然后计算每个可能输出的概率(如果我们输出3个单词，将有B种可能性)并输出最有可能的一个。</p><h2 id="1716" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ip ki kj kk it kl km kn ix ko kp kq kr bi translated"><strong class="ak">总之</strong>:</h2><ul class=""><li id="b625" class="ks kt hh ig b ih ku il kv ip kw it kx ix ky jb kz la lb lc bi translated">解码策略是语言模型在知道概率后如何选择应该输出什么单词。</li><li id="f3e4" class="ks kt hh ig b ih ld il le ip lf it lg ix lh jb kz la lb lc bi translated">流行的解码策略包括贪婪搜索、top-k采样和波束搜索。</li></ul><p id="d86e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">延伸阅读:</strong></p><ul class=""><li id="2c60" class="ks kt hh ig b ih ii il im ip li it lj ix lk jb kz la lb lc bi translated"><a class="ae jo" href="https://towardsdatascience.com/gpt-3-rnns-and-all-that-deep-dive-into-language-modelling-7f67658ba0d5?source=your_stories_page----------------------------------------" rel="noopener" target="_blank">全面了解语言建模</a></li><li id="895b" class="ks kt hh ig b ih ld il le ip lf it lg ix lh jb kz la lb lc bi translated"><a class="ae jo" rel="noopener" href="/mlearning-ai/practical-introduction-to-language-modelling-f5337bc26c5">通过构建对话式人工智能在实践中运用这些知识</a></li></ul><div class="ll lm ez fb ln lo"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lp ab dw"><div class="lq ab lr cl cj ls"><h2 class="bd hi fi z dy lt ea eb lu ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lv l"><h3 class="bd b fi z dy lt ea eb lu ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lw l"><p class="bd b fp z dy lt ea eb lu ed ef dx translated">medium.com</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc ji lo"/></div></div></a></div></div></div>    
</body>
</html>