<html>
<head>
<title>How to Install TensorFlow 2.x with CUDA and cuDNN on Ubuntu 20.04 LTS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Ubuntu 20.04 LTS上安装带CUDA和cuDNN的TensorFlow 2.x</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/how-to-install-tensorflow-2-x-with-cuda-and-cudnn-on-ubuntu-20-04-lts-b73c209d8e88?source=collection_archive---------6-----------------------#2022-07-12">https://medium.com/mlearning-ai/how-to-install-tensorflow-2-x-with-cuda-and-cudnn-on-ubuntu-20-04-lts-b73c209d8e88?source=collection_archive---------6-----------------------#2022-07-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3799" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我将指导你在Ubuntu机器上安装带有CUDA和cuDNN的TensorFlow 2.x。</p><p id="2551" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你的系统中有NVIDIA显卡，并且想用它来训练机器学习和深度学习模型，你需要先在你的系统中安装CUDA和cuDNN库。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/3aafcfdb4c840d2d267ca2ef8a79c8fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KhIsj0rHaaEnrmAJ.jpg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@christianw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Christian Wiediger</a> on <a class="ae js" href="https://unsplash.com/s/photos/rtx?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d590" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是我的系统配置以及CUDA和cuDNN的版本:<br/> OS : <strong class="ig hi"> Ubuntu 20.04 LTS </strong></p><p id="e486" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们开始吧！</p><h1 id="b0e1" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">安装必备组件</h1><p id="bae2" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在您安装任何东西之前，我们需要确保系统中安装了必要的图形驱动程序。这些驱动程序需要与底层显卡通信。</p><p id="4382" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过按cltr + alt + T打开终端，并键入以下命令。</p><p id="ef9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果该命令返回一条消息，说明系统无法识别“nvidia-smi ”,则通过运行以下命令来安装nvidia-smi:</p><p id="c1e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kw kx ky kz b">sudo add-apt-repository ppa:graphics-drivers/ppa</code></p><p id="246d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kw kx ky kz b">sudo apt install nvidia-driver-470</code></p><p id="0848" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">运行上述命令后，再次运行nvidia-smi命令，检查驱动程序是否安装成功。您应该会看到类似如下的输出。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es la"><img src="../Images/ac1d12490c0c72764b7c0cd6951421ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qolWL5ENo2ybByp9.png"/></div></div></figure><p id="df59" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你仍然看不到上面的输出，重启你的电脑并再次运行命令。</p><h1 id="94e0" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">为TensorFlow 2.x安装CUDA和CuDNN</h1><p id="240a" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">访问<a class="ae js" href="https://www.tensorflow.org/install/source#gpu" rel="noopener ugc nofollow" target="_blank"> TensorFlow指南</a>查看您正在使用的TensorFlow相应版本的Cuda和CuDNN兼容版本。对于本指南，我使用TensorFlow 2.9.1，它使用Cuda 11.2和CuDNN 8.1。</p><p id="ed99" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">打开一个新的终端并创建一个新的conda环境，这样您的所有依赖项都封装在这个特定的环境中。</p><p id="7dfd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kw kx ky kz b">conda create --name tensorflow python=3.9</code></p><p id="c3ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建环境后，继续激活环境。</p><p id="b43f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kw kx ky kz b">conda activate tensorflow</code></p><p id="fe0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用您将创建的环境的名称替换TensorFlow。</p><p id="e061" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在运行下面的命令，在你的Ubuntu机器上安装Cuda和CuDNN库。</p><p id="f241" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kw kx ky kz b">conda install -c conda-forge cudatoolkit=11.2 cudnn=8.1.0</code></p><p id="5bbb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kw kx ky kz b">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$CONDA_PREFIX/lib/</code></p><h1 id="0ac8" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">安装TensorFlow 2.9.1</h1><p id="c8d7" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">一旦对Cuda和Cudnn的依赖关系进行了排序，我们现在可以继续在系统上安装TensorFlow GPU了。对于最新的TensorFlow版本，现在不需要为CPU ad GPU安装特定版本的TensorFlow。我们只需运行下面的命令，它就会在您的系统中安装必要的版本。</p><p id="6d49" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kw kx ky kz b">pip3 install --upgrade pip</code> <code class="du kw kx ky kz b">pip3 install tensorflow</code></p><h1 id="2881" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">测试安装</h1><p id="8ed3" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我们可以使用下面的命令测试安装</p><p id="de97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kw kx ky kz b">python3 -c "import tensorflow as tf; print(tf.config.list_physical_devices('GPU'))"</code></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lb"><img src="../Images/55a59fb7d9d5ffce651cc2f3259bd4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FVk4apTyMLUPMBDq.png"/></div></div></figure><p id="6d29" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上述命令将列出您系统上可用的GPU设备。如果您能够看到您的图形卡设备号作为上述命令的输出弹出，则安装成功。</p><h1 id="6ed9" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">命令过程</h1><p id="087f" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">对于那些觉得一个接一个地运行命令很麻烦的人，我创建了一个shell脚本，它会自动为您安装所有的依赖项。只要在你的终端上运行这个脚本，其他的事情就会迎刃而解。不客气:)</p><p id="5098" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae js" href="https://github.com/errolPereira/blog_resources/blob/main/install_tf_with_gpu.sh" rel="noopener ugc nofollow" target="_blank"> Shell脚本(2.x) </a></p><p id="5774" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于像我这样喜欢使用TensorFlow 1.x运行代码的人，我已经创建了另一个脚本，它将安装TensorFlow 1.15以及cuda和cudnn依赖项。再次欢迎:)</p><p id="05db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae js" href="https://github.com/errolPereira/blog_resources/blob/main/install_tf1.15_with_gpu.sh" rel="noopener ugc nofollow" target="_blank"> Shell脚本(1.x) </a></p><h1 id="3ef9" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考资料:</h1><p id="cfce" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated"><a class="ae js" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow官网</a></p></div><div class="ab cl lc ld go le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ha hb hc hd he"><p id="f331" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lj">原载于2022年7月12日</em><a class="ae js" href="https://errolpereira.github.io/how-to-install-CUDA-and-cuDNN-on-ubuntu/" rel="noopener ugc nofollow" target="_blank"><em class="lj">https://errolpereira . github . io</em></a><em class="lj">。</em></p><div class="lk ll ez fb lm ln"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hi fi z dy ls ea eb lt ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb jm ln"/></div></div></a></div></div></div>    
</body>
</html>