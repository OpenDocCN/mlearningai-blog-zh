<html>
<head>
<title>Three Simple Methods for Dealing with Outliers in Regression Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">回归分析中处理异常值的三种简单方法</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/three-simple-methods-for-dealing-with-outliers-in-regression-analysis-8003ca56734c?source=collection_archive---------2-----------------------#2022-07-05">https://medium.com/mlearning-ai/three-simple-methods-for-dealing-with-outliers-in-regression-analysis-8003ca56734c?source=collection_archive---------2-----------------------#2022-07-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="b5c9" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated"><strong class="ak">我写这个主题的动机</strong></h1><p id="87ba" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">作为一名自由职业者，我经常被要求解释我是如何处理数据分析中的异常值的。作为一名长期的经济学家，我的第一个答案总是“视情况而定”，接下来是我答案中最重要的部分:为什么要视情况而定。在这篇文章中，我将讨论如何考虑线性回归中的异常值。简单的密度分布图有助于理解异常值如何影响线性回归结果。最后，我将讨论处理异常值的三种方法以及何时使用它们比较合适。</p><p id="d743" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这篇文章将使用随机生成的两个不同社区的房价数据来探索离群值的影响。假设这两个街区的房价是不同的。也许我们是一名房地产经纪人，正在寻找最符合客户预算的社区，或者我们想实施一项社会计划来帮助低收入房主，并想知道这两个社区中的哪一个是我们的目标。不考虑原因，我使用线性回归模型来更好地理解这两个邻域。</p><p id="1dda" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">第一步是生成正态分布的数据，以模拟两个虚拟社区的房价调查。随机生成的“低价”邻域(Neighborhood_1)将使用平均房价150，000美元，样本为30户住宅，标准差为20，000美元，而“高价”邻域(Neighborhood_2)将使用平均房价350，000美元，样本为30户住宅，标准差为50，000美元。</p></div><div class="ab cl kf kg go kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ha hb hc hd he"><h1 id="3b95" class="ie if hh bd ig ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb bi translated"><strong class="ak">一个奇妙的房价线性回归模型</strong></h1><p id="1205" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们将首先对使用上述条件生成的数据有所了解，然后应用线性回归模型。下面的密度分布图和两个街区房价样本的汇总统计数据显示，它们的均值分布明显不同，正如我们基于对街区的假设所希望的那样。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es kr"><img src="../Images/992f69d1f6137a828b738cf0b4d5cd13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vc_UcsuI1S-pNgcQruFm2A.png"/></div></figure><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es kz"><img src="../Images/fa6010a938853f909d91dc5a38f64a45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KR3t44zP-GXUifxYWj-EWw.png"/></div></div></figure><p id="f827" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这里有几个重要的要点。首先，样本数据对于每个邻域呈正态分布，这非常适合线性回归建模。第二，样本中的街区之间没有重叠的价格。第三，neighbor _ 1的平均房价低于neighbor _ 2的平均房价。从这些信息中，我们可以很好地感觉到我们对邻居的假设是正确的。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es le"><img src="../Images/48d28b350e4479c204166237c4076c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*CqUXOPGMPRvNxmbWyz39wQ.png"/></div></figure><p id="deb8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">上面的回归结果给了我们很大的信心，相信我们的假设是正确的。回归结果告诉我们，根据我们的样本数据，两个街区的房价相似的可能性极低。</p><p id="707e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">此外，下面的Q-Q图以图形方式显示，数据中没有异常值对模型的残值有负面影响，这意味着满足正态分布残差的线性回归假设。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es lf"><img src="../Images/beb95880bd166c9304696a560c62c7d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*6xHElAP1d3DpcI97eqmI9g.png"/></div></figure><h1 id="4e7b" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">仅仅一个异常值就能毁掉一个漂亮的线性回归模型</h1><p id="9ed1" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">那么，如果我们将Neighborhood_1中的一个房价替换为500万美元的房价，上面的分析会是什么样子呢？发生这种情况有几个原因，我将在本文后面讨论这些原因。但是现在，我们既不会假设关于离群值的先验知识，也不会假设当发现离群值时为什么会出现离群值。</p><p id="3790" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">同样，我们将从以下密度分布的样本数据和样本房价的汇总统计开始，并应用线性回归模型。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es kr"><img src="../Images/f283908c292e148615f1aeac8c1b113d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MVs17anoEHRkCiGOROMkqw.png"/></div></figure><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lh"><img src="../Images/fe35c9400286af4e9438f6a9a38626f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EWOpM3vu8OYNeCNb8ZXQTA.png"/></div></div></figure><p id="c8bb" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这张密度分布图与之前的图表最重要的区别在于，现在Neighborhood_2的所有房价都在Neighborhood_1的房价范围内。虽然Neighborhood _ 2的价格正态分布在它的平均价格附近，但是我们不能再对Neighborhood_1的房价说同样的话，因为我们只有一个异常价格。此外，请注意两个街区之间的平均价格。两个价格之间不再有那么大的差异，当考虑到Neighborhood_1价格的巨大标准差时，我们将不得不质疑我们的假设。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es li"><img src="../Images/7f4d3b0f6ab5e6b8c25d7221b6eb9983.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*hacziTE0AHDInD6MaVvcNA.png"/></div></figure><p id="4249" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">来自具有较大异常值的模型的线性回归结果并没有给我们多少信心来证明我们的工作假设是正确的。虽然常数值(即Neighborhood_1中的平均房价)在统计上仍然有意义，但它比没有异常值的模型大2倍以上。Neighborhood_2的系数不再具有统计学意义，这进一步使我们得出结论，这两个街区的房价可能没有差异。虽然第一个模型中的r平方度量告诉我们，房价差异的86%是由邻里之间的差异解释的，但在离群值模型中，这一比例几乎为零。检验基于样本数据的两个总体之间的均值显著不同的可能性的假设的F统计不再支持我们的假设。</p><p id="d556" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我们现在可以从Q-Q图中看到，价格数据中有一个异常值正在破坏我们原本很棒的线性回归模型！</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lj"><img src="../Images/a02fa7cf452bb54c9f42e9d16c69f24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*Pt0rGdSbAoaHFqWYX3UFUw.png"/></div></div></figure></div><div class="ab cl kf kg go kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ha hb hc hd he"><h1 id="ff8b" class="ie if hh bd ig ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb bi translated">处理异常值的三种方法</h1><p id="83be" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">如何处理异常值取决于对底层数据的理解。</p><h2 id="6740" class="lk if hh bd ig ll lm ln ik lo lp lq io jn lr ls is jr lt lu iw jv lv lw ja lx bi translated">方法1:“Fogetaboutit…”</h2><p id="134b" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">处理异常值的一个选择是完全丢弃观察值。如果可以通过进一步调查确定调查条目有误，这可能是一个合适的选项。也许搜索一下财产税记录，甚至个人对附近房产的了解，就能得出这个结论。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es ly"><img src="../Images/2137bdc22503e2da3099f078a1bb7cbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*oKMvx04WunQYFUOik0xd7A.png"/></div></figure><p id="181e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">“排除异常值”模型的回归结果与第一次检查的“无异常值”模型的回归结果非常相似，两个模型之间唯一的实际差异是常量值和观察值数量。较大的r-square和F-Statistic值给了我们很大的信心，根据样本数据，这两个街区的房价并不相似。</p><p id="4ff2" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">请记住，这在很大程度上是因为我有意生成了2组正态分布的数据，并且只添加了一个异常值。真实世界的数据集很少如此简单，很可能会生成与“无异常值”情况不太相似的回归结果。</p><h2 id="169a" class="lk if hh bd ig ll lm ln ik lo lp lq io jn lr ls is jr lt lu iw jv lv lw ja lx bi translated">方法2:用另一个值替换异常值</h2><p id="d797" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">如果有理由相信可能有理由在模型中包含异常值，另一种选择是为相关变量设置上限或下限。如果我们可以假设价格是异常的，这可能是有益的，但有多个独立变量我们可以合理地假设是准确的，并且将有助于包括在模型中。在这里，我们可能知道Neighborhood_1的最高房价，196206美元，是最贵的房子。在不知道异常值的真实值的情况下，我们可以假设它不大于在我们的原始、非异常样本中收集的最大值，因此我们将用“Neighborhood_1”的最大房价替换异常值。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es lz"><img src="../Images/7d1cacdd6e28232fc2cb8473380df9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*r8ijcfNyMTUuJpMLAxZhsg.png"/></div></figure><p id="084e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">该模型的回归结果类似于“无异常值”和“排除异常值”。同样，较大的平方值和F统计值给了我们很大的信心，根据样本数据，两个街区的房价并不相似。请记住，对真实世界的数据使用这种方法也可能会生成与“无异常值”情况不太相似的回归结果。</p><h2 id="46e3" class="lk if hh bd ig ll lm ln ik lo lp lq io jn lr ls is jr lt lu iw jv lv lw ja lx bi translated">方法3:给异常值分配一个虚拟变量</h2><p id="e71f" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在处理异常值时，这通常是我的首选。它允许模型使用所有的样本数据，并给出关于数据中异常值的信息。在这里，我将简单地创建一个虚拟变量，如果房价高于500，000美元，则等于“1 ”,如果低于500，000美元，则等于“0”。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ma"><img src="../Images/07192595be34d6355b2247afb3da5451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lv3pfrw-HArUqv7Co7H7OA.png"/></div></div></figure><p id="e9b6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在这个模型中需要注意的区别是，我们已经从单变量回归模型变成了多变量回归模型。再次回忆一下，由于我们使用的是二元变量，我们只是计算每组的平均值。Neighborhood_1的平均值与排除异常值时的平均值相同，Neighborhood_2的系数也是如此。将Neighborhood_1均值与虚拟变量的系数相加，得出异常值的房价为5，000，000美元。所有这三个系数在统计上都是显著的，并且F统计给了我们很大的信心，根据样本数据，两个街区的房价并不相似。</p><p id="2bf0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">有趣的是，现在等于1.00的r平方度量告诉我们，邻域和虚拟变量的变化完全解释了房价的变化。这也部分是因为正常生成的数据。但另一个需要考虑的问题是，添加到线性回归模型中的任何额外的独立/解释变量，如本例中的虚拟变量，将生成更大的r平方统计量。无论添加的变量在统计上是否显著，都是如此。</p><div class="mb mc ez fb md me"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hi fi z dy mj ea eb mk ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">medium.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms kx me"/></div></div></a></div></div></div>    
</body>
</html>