<html>
<head>
<title>Trendlines with Sklearn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Sklearn的趋势线</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/trendlines-with-sklearn-32791fa76d30?source=collection_archive---------4-----------------------#2021-05-19">https://medium.com/mlearning-ai/trendlines-with-sklearn-32791fa76d30?source=collection_archive---------4-----------------------#2021-05-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="2e5c" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">我第一次用这个工具编码感觉如何？</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es iw"><img src="../Images/25cd0c07189873b8fdbbc0ecdc6e1730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*ZF8ftYal5dzWPu7yd5IFZA.png"/></div></figure><p id="3a54" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">继续我解决一本关于商业统计的书的传奇，今天我们将谈论我使用机器学习工具的第一种方法以及书籍练习。这真的不是一个复杂的解决问题的练习，它相当简单，但是，有一些关键的东西我真的想在这里与你分享。</p><p id="76c9" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">所以如果你没有读过我以前的文章，我强烈推荐你，你可以在这里找到它们。我选大卫·r·安德森、丹尼斯·j·斯威尼和托马斯·a·威廉姆斯的《商业和经济统计》这本书，第11版，练习30，第2章。</p></div><div class="ab cl kb kc go kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="ha hb hc hd he"><h2 id="fbe9" class="ki kj hh bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc bi translated">有什么计划？</h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es iw"><img src="../Images/c3e78f1751d6f2c4ec5e8850d60dafc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*9e8D4yGSe-HITzDMuFoLWw.png"/></div></figure><p id="b9a7" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">这个想法很简单，这个练习给你一个数据集，它要求你建立一个散点图和一个趋势线。</p><p id="66cf" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">老实说，这是你能做的最简单的事情，说真的，如果你想使用Pandas，Numpy或任何其他库，趋势线就是一行代码，但是，我决定用sci-kit learn，为什么？好吧，在互联网上查找，如果你想得到任何类型的指标，如果你的模型足够好，你至少需要使用r2_score，一个sklearn工具，所以如果我无论如何都要走这条路，为什么我不一直走下去呢？</p><h2 id="76ca" class="ki kj hh bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc bi translated">好吧，但是为什么这么明显的选择？</h2><p id="f3d0" class="pw-post-body-paragraph je jf hh jg b jh ld ii jj jk le il jm jn lf jp jq jr lg jt ju jv lh jx jy jz ha bi translated">好吧，我的朋友，我要给你快速的版本，但真的，迫切地阅读它，因为你需要帮助，真的。但是，趋势线是由某种线性回归建立的，这是一种找到包含所有数据条目的最佳拟合方程的技术。</p><p id="3355" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">那么，为什么这对数据科学家如此重要呢？基本上，因为你可以从方程中预测出一些值，这很有价值。有很多种方法可以做到这一点，在这里我使用了最小二乘法，没有深入到这种技术的数学中，但是这个模型建立了一条线的方程，它与你所拥有的点的距离尽可能的近，即使你的值是负的。</p><p id="80fc" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Sklearn也提供了其他进行线性回归的方法，非常复杂和错综复杂，让您找出哪种方法最适合您，但现在，我将以一种非常简单的方式进行，这里的要点是了解如何使用它，而不是使用支持向量机来处理极其简单的数据集。</p><h2 id="0e0f" class="ki kj hh bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc bi translated">那么结果是什么？</h2><p id="c28d" class="pw-post-body-paragraph je jf hh jg b jh ld ii jj jk le il jm jn lf jp jq jr lg jt ju jv lh jx jy jz ha bi translated">下面是这次尝试的结果代码:</p><pre class="ix iy iz ja fd li lj lk ll aw lm bi"><span id="a06b" class="ki kj hh lj b fi ln lo l lp lq"># 30.</span><span id="dc1b" class="ki kj hh lj b fi lr lo l lp lq">import pandas as pd<br/>from sklearn import linear_model<br/>from sklearn.metrics import mean_squared_error, r2_score<br/>import matplotlib.pyplot as plt<br/>scatter = pd.read_excel('~/Documentos/projetos_ds/livro_1/excel_files/ch_02/Scatter.xlsx', 'Data')<br/>print(scatter)</span><span id="a652" class="ki kj hh lj b fi lr lo l lp lq"># A)</span><span id="d8a3" class="ki kj hh lj b fi lr lo l lp lq">scatter_x_train = scatter.iloc[0:19, 1:2]<br/>scatter_x_test = scatter.iloc[0:19, 1:2]</span><span id="cc3b" class="ki kj hh lj b fi lr lo l lp lq">scatter_y_train = scatter.iloc[0:19, 2]<br/>scatter_y_test = scatter.iloc[0:19, 2]</span><span id="85bb" class="ki kj hh lj b fi lr lo l lp lq">trend = linear_model.LinearRegression()</span><span id="e29e" class="ki kj hh lj b fi lr lo l lp lq">model = trend.fit(scatter_x_train, scatter_y_train)</span><span id="e216" class="ki kj hh lj b fi lr lo l lp lq">scatter_y_pred = trend.predict(scatter_x_test)</span><span id="a54d" class="ki kj hh lj b fi lr lo l lp lq">print('The coeffitient is: {0}'.format(trend.coef_))</span><span id="0af4" class="ki kj hh lj b fi lr lo l lp lq">print('The intercept is: {0}'.format(trend.intercept_))</span><span id="8696" class="ki kj hh lj b fi lr lo l lp lq">print('The correlation of the values is: {0}'.format(r2_score(scatter_y_test, scatter_y_pred)))</span><span id="34b3" class="ki kj hh lj b fi lr lo l lp lq">plt.scatter(scatter_x_test, scatter_y_test,  color='black')<br/>plt.plot(scatter_x_test, scatter_y_pred, color='blue', linewidth=1)</span><span id="0c62" class="ki kj hh lj b fi lr lo l lp lq">plt.xticks(())<br/>plt.yticks(())</span><span id="7c80" class="ki kj hh lj b fi lr lo l lp lq">plt.show()</span></pre><p id="c82d" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">如果你已经读过sklearn文档中的简单线性回归示例，实际上你会看到结构上非常相似，是的，我把它从那里拿了出来，你可以在这里<a class="ae ka" href="https://scikit-learn.org/stable/auto_examples/linear_model/plot_ols.html" rel="noopener ugc nofollow" target="_blank">检查一下</a>。</p><p id="6be8" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">现在，让我告诉你我在这里的选择，从数据条目开始，如果你读了我的上一篇文章，你就会知道我对互联网上免费教育内容的看法，以及你如何通过浏览文档文件了解更多。事情是这样的，在我的国家，我们没有一个词来定义数组，我们把一切都称为矩阵，所以1D矩阵是一个数组，2D矩阵是一个矩阵，在巴西，所有矩阵。我非常确定大约一年前我在youtube上的一个免费编码内容中学到了这一点，当它应用到一个更实际的问题时变得非常混乱。</p><p id="e24f" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">好的，由于这种等价性，事情在开始时变得很奇怪，因为sklearn有不同的看法，如果你有一个熊猫系列，它是一个2D数组，你需要在你的模型中输入任何x。因此，这显然是sklearn在线性回归上发挥作用的一个非常重要的特征，原因是它计算数据集上的行数(n_samples)和x的特征(n_features)，这在多变量分析中可能不止一个，但这里只有一个，结果证明该定义并不完全错误，但在实际问题中却是不必要的时间浪费。</p><p id="1deb" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">第二，我到处计算每一行，为什么？我不想预测任何事情，只是为了拟合一条趋势线，我知道这听起来像是滥用这样一个强大的工具，但是，将它拟合到这个目的是探索这个工具的一些属性，当预测任何事情的时候，我会知道如何预测一些事情，我仍然不能100%确定这种方式是否正确，但肯定是有效的。</p><p id="e6f3" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我努力工作，结果是y = 4.66–0.95 x，R = 0.73，这是一个非常强的相关性。</p><p id="ef81" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我在sklearn(预测方法)中了解到的关于此功能的最后一点是，当我们的模型绘制在图表中时，它会给我们的模型一个外观，因此，我认为有两个东西可以满足此目的，即要绘制的<em class="ls">模型</em>变量和<em class="ls"> scatter_y_pred </em>，第一个给出x值的预测，第二个给出y值。</p><p id="e692" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我使用Matplotlib绘制图形，因为它在示例中，但是可以很容易地将其转换为Plotly，但是对于练习新工具，这是我的学习方式。其他细节，我解决了我在Jupyter笔记本和Matplotlib之间的问题，事情是这是一个非常新手的错误，再次，如果你看到当导入Matplotlib时，我没有使用。pyplot，给人那种只有大三编码时才有的喘息。</p><h2 id="4820" class="ki kj hh bd kk kl km kn ko kp kq kr ks jn kt ku kv jr kw kx ky jv kz la lb lc bi translated">现在怎么办？</h2><p id="5132" class="pw-post-body-paragraph je jf hh jg b jh ld ii jj jk le il jm jn lf jp jq jr lg jt ju jv lh jx jy jz ha bi translated">所以我决定从两个方面来发表我的帖子，一个是非常技术性的，另一个是更多地谈论统计数据本身。这样，我可以在每个前端放更多的香蕉，而不会觉得“这太长了”。</p><p id="868c" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">你怎么想呢?我很想听听你对学习这些工具的最佳方法的看法，这似乎是一种练习和建立统计基础的好方法，如果我使用所有的线来拟合数据集的趋势线是正确的。</p><p id="ef77" class="pw-post-body-paragraph je jf hh jg b jh ji ii jj jk jl il jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">总而言之，安全保重，不断学习。</p></div></div>    
</body>
</html>