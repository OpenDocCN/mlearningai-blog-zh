<html>
<head>
<title>Forecasting Recessions With Scikit-Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Scikit-Learn预测衰退</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/forecasting-recessions-with-scikit-learn-df58e1ea695f?source=collection_archive---------1-----------------------#2022-04-25">https://medium.com/mlearning-ai/forecasting-recessions-with-scikit-learn-df58e1ea695f?source=collection_archive---------1-----------------------#2022-04-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9260" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">众所周知，每个人都想预测衰退。许多经济学家和金融公司都尝试过这种方法，但成效有限，但总的来说，美国经济衰退有几个众所周知的领先指标。然而，当呈现给公众时，这些指标通常被单独看待，而不是以能够给出与即将到来的衰退相关联的概率陈述的方式来构建。在这个项目中，我采用了一些经济指标，并建立了一个分类模型来生成概率报表。在这里，实际的分类(“衰退”或“不衰退”)没有衰退的<strong class="ig hi">概率</strong>重要，因为这个概率将用于确定一个基本的投资组合方案，我将在后面描述。首先，让我们看看一些数据来源。访问<a class="ae jc" href="https://github.com/DanlBradley/RecessionPredictor" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> github </strong> </a> <strong class="ig hi"> </strong>进行全面分析。</p><h1 id="20d7" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">纳斯达克数据链</h1><p id="ecdf" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">纳斯达克数据链在2018年收购了Quandl，它是一个非常强大的工具，可以通过易于使用的API nasdaqdatalink访问广泛的经济，金融和其他时间序列数据集。对于Python，只需输入:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="28ce" class="kp je hh kl b fi kq kr l ks kt">pip install nasdaq-data-link</span></pre><p id="cc58" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">成功安装后，您需要在他们的<a class="ae jc" href="https://data.nasdaq.com/" rel="noopener ugc nofollow" target="_blank">网站</a>上创建一个帐户，并导航至您的帐户设置以获取您的免费API密钥。付费数据集比免费数据集要多得多，但是仍然有相当数量的数据集可以通过这个API访问。然后，您可以在Python中加载数据集，例如美联储经济数据库(FRED)提供的美国GDP:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="d6e5" class="kp je hh kl b fi kq kr l ks kt">import nasdaqdatalink<br/>import pandas as pd</span><span id="c46e" class="kp je hh kl b fi ku kr l ks kt">nasdaqdatalink.read_key("/.../.apikey")<br/>GDP = nasdaqdatalink.get('FRED/GDP')</span></pre><p id="4260" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">默认情况下，它将作为熊猫数据帧加载。记得把你的API密匙保存在一个不会上传到Github的文件里，尤其是如果你决定为任何数据集付费的话。</p><p id="af96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个项目中，我主要使用了来自FRED的数据集和来自密歇根大学消费者调查的数据集。让我们来看一看其中的每一个:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="16b7" class="kp je hh kl b fi kq kr l ks kt">GDP = nasdaqdatalink.get('FRED/GDP')<br/>unemployment = nasdaqdatalink.get('FRED/UNRATE')<br/>UMICH = nasdaqdatalink.get('UMICH/SOC35')<br/>target = nasdaqdatalink.get('FRED/USREC')</span></pre><p id="8ba6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">国家GDP增长和平民失业率是衰退相对直接的指标。衰退被定义为负GDP，因此GDP增长较低对应于衰退几率增加也就不足为奇了。目标变量是弗雷德的历史，即自1854年以来的任何一个月是否已经衰退，衰退时期被定义为该月的GDP负增长。这将在我们的分类模型中用作目标变量。UMICH的数据代表了人们在不久的将来购买大型家用商品的意愿的月度调查，如炉子、冰箱、汽车等。</p><p id="1b4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们加载更多的数据集:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="046c" class="kp je hh kl b fi kq kr l ks kt">ten_year_treas = nasdaqdatalink.get('FRED/DGS10')<br/>three_month_treas = nasdaqdatalink.get('FRED/DTB3')</span></pre><p id="bf1d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这两个数据集更有趣一点。第一个是到期利率不变的10年期美国国债的年利率，第二个是3个月期国债的年利率。这两个值之间的差异通常被称为收益率曲线，当它变得小于零时(即，3个月期债券的收益率高于10年期债券)，几乎总是会在不久后出现衰退。点击了解更多信息<a class="ae jc" href="https://www.investopedia.com/terms/i/invertedyieldcurve.asp" rel="noopener ugc nofollow" target="_blank">。你可以从下面1970年、1974年、1980年、2001年、2008年甚至2020年的衰退中看到这种行为。</a></p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kv"><img src="../Images/ccdc1c6a0009462f1c92c501d232d380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T06_x2Ga5cwh3Esz8u6Cvg.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Whenever yield spread goes below 0, a recession is sure to follow.</figcaption></figure><h1 id="fd90" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">模型准备和调整</h1><p id="5f98" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">现在我们有了数据，可以开始考虑如何构建模型了。为了简洁，我在这里跳过了一些数据清理和功能工程步骤，但完整的细节可以在我的<a class="ae jc" href="https://github.com/DanlBradley/RecessionPredictor" rel="noopener ugc nofollow" target="_blank"> github repo </a>中看到。然而，一般的方法是将特征和目标变量按季度分类，因为我的问题是预测下一个财政季度是否会出现衰退。然后，我将目标偏移四分之一，以确定特征中是否有足够的数据来预测下一个季度(而不是当前季度)是否会出现衰退。说我们目前正处于衰退并不是很有趣，因为从GDP负增长和媒体喋喋不休的谈论中可以明显看出这一点。</p><p id="af70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于非衰退月份明显多于衰退月份，我们正在处理一个高度不平衡的阶级问题，必须予以适当考虑。我们使用不平衡学习工具包中包含的SMOTE transformer来处理这个问题，你可以在<a class="ae jc" href="https://imbalanced-learn.org/stable/over_sampling.html#smote-adasyn" rel="noopener ugc nofollow" target="_blank">不平衡学习用户指南</a>和<a class="ae jc" href="https://www.jair.org/index.php/jair/article/view/10302/24590" rel="noopener ugc nofollow" target="_blank">原始论文</a>中了解更多信息。</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lh"><img src="../Images/c131f325f56285e058bf7de3dd55c52e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uj9pu70Y1w9L7LNEu6enHQ.png"/></div></div></figure><p id="dafb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，SMOTE不能很好地与scikit-learn的管道类一起工作，而管道类对于进行适当的模型调优至关重要。因此，您需要使用下面的命令来使用不平衡学习的内置管道:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="3189" class="kp je hh kl b fi kq kr l ks kt">from imblearn.pipeline import Pipeline<br/>from imblearn.over_sampling import SMOTE</span></pre><p id="797f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">方便的是，许多scikit-learn的转换器和估算器与不平衡学习管道一起工作，就像它们在原生scikit-learn环境中一样，并且它可以直接插入网格搜索以进行模型调整。切记不要对测试数据应用SMOTE，因为它生成的合成要素仅用于训练目的。我们的前三个模型在下面使用接收器操作特征曲线进行比较，随机森林分类器和梯度增强分类器表现类似。</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es li"><img src="../Images/fb683f42ba0fb4273d2084fc11a43217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cNp4CAf_8zaLL5lr4pjuOw.png"/></div></div></figure><p id="0df2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，我们发现随机森林模型对训练集的过度拟合更健壮，并且给出了比梯度提升更一致的结果，所以我们用随机森林作为我们的最终模型。随机森林的混淆矩阵如下所示。</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lj"><img src="../Images/783ce3616558bbf32321c0ae8e4c9391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*utvlWcCqAtFrXczFSDRivg.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">The model successfully predicts 9 out of 10 recessions in the test set.</figcaption></figure><h1 id="c115" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">模拟简单的投资组合</h1><p id="ec39" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">以我们的winning模型为例，我们可以根据逐月衰退的概率模拟一个基本投资组合，以确定如何在衰退期间以外表现良好的激进头寸(股票)和衰退期间更保守的头寸(现金、黄金、债券)之间进行分割。毫无疑问，这是对金融市场的过度简化，但它应该表明，至少在原则上，该模型在预测市场低迷方面表现良好。在我们的模拟中，我们将投资组合分为购买道琼斯指数(这在实践中无法实现，但有许多指数基金以接近1:1的比例追随它)和黄金。</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lk"><img src="../Images/0b8caadbb13c989ed4dc60c703132186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WYhOiN_3KVGDvKQLiHztfA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Model-based portfolio nets ~ 8.5% vs ~ 4.8% pure stocks.</figcaption></figure><p id="162f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该模型在2001年至2022年期间表现明显更好。但是性能的提高来自哪里呢？在非衰退时期，它应该最好与市场匹配，如果不是表现不佳的话，因为模型总是预测一些衰退的机会。看一下上图中的日志，可以更清楚地看到发生了什么。</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ll"><img src="../Images/0f9f973a22a672d3a7e94df1bba86816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c2k44A0VZKK-cVJDcihSZQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Log of portfolio value vs. time.</figcaption></figure><p id="61d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上面的对数图中可以看出，基于模型的投资组合实现了大部分收益，因为它在2008年的衰退中受到的打击要小得多。之后，增长率看起来非常相似。但由于投资组合避免了2008年经济衰退时的部分风险敞口，该基金得以在随后的牛市中大幅增加投资。事实上，该模型很好地预测了许多训练数据没有发现的衰退。下面是模型将一段时间划分为衰退的方框区域，它通常与股票市场的衰退相匹配(这里我们使用标准普尔500指数作为衡量标准)。然而，它并不总是与低迷相匹配，这部分是因为并非所有的衰退都伴随着股市低迷。烛台图片是在<a class="ae jc" href="https://www.tradingview.com/" rel="noopener ugc nofollow" target="_blank"> TradingView </a>历史图表环境中拍摄的。</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lm"><img src="../Images/c10b169f2285267c6c50ed4c87e8da44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7uOWToRN_c0hvwXlCVR2eA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Model predicting downturn correctly in recession of 1974.</figcaption></figure><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es ln"><img src="../Images/25faa546c228236f548d5bdf38046b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2X2ByAiJ3eZ34B8sCsQyPA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Model predicting downturn correctly in recession of 2001.</figcaption></figure><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lo"><img src="../Images/d39bdeb3a3264c8a2ed9ea5c970fa2fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UPIiyUI1BY0xCot9URJ7eQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Model predicting downturn correctly in recession of 2008.</figcaption></figure><p id="8ae5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，该模型在预测2020年的衰退时表现相当糟糕。然而，这并不奇怪，因为这次衰退是由新冠肺炎疫情引发的，这一事件不可能仅用经济指标来预测。见下文模型反应和市场时机失灵。</p><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lp"><img src="../Images/73cb0882ff33b091c34f48d1ef42099c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RXvh5979S5O6-vbN-bgukQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Model failing to predict COVID-19 recession.</figcaption></figure><figure class="kg kh ki kj fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lq"><img src="../Images/a81de2cdddf837b4bf5dad232204820f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WrI-nN5uvCKiMdi4mvMMzA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx">Model fails here to time downturn in the stock market due to COVID-19.</figcaption></figure><h1 id="cb08" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">结论</h1><p id="35e8" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">这个项目展示了scikit-learn的许多强大功能和其中可用的基本分类算法。虽然该模型有许多成分对实际衰退和实际交易条件来说是天真的，但它有力地证明了衰退在大多数时候并不是不可预测的黑天鹅，应该在现代投资组合中加以考虑。</p></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><p id="e706" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">参考文献</strong></p><p id="aba5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[1] <a class="ae jc" href="https://www.jair.org/index.php/jair/article/view/10302/24590" rel="noopener ugc nofollow" target="_blank"> SMOTE:合成少数过采样技术(Chawle <em class="ly"> et。阿尔</em>，2002年)</a></p><p id="3910" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[2] <a class="ae jc" href="https://fred.stlouisfed.org/" rel="noopener ugc nofollow" target="_blank">圣路易斯美联储经济数据</a></p><p id="b553" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[3] <a class="ae jc" href="https://data.sca.isr.umich.edu/" rel="noopener ugc nofollow" target="_blank">消费者调查—密歇根大学</a></p><p id="6e16" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[4] <a class="ae jc" href="https://www.investopedia.com/terms/i/invertedyieldcurve.asp" rel="noopener ugc nofollow" target="_blank">反向收益率曲线，<em class="ly"> Investopedia </em> </a></p><p id="289a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ly">注</em> </strong> <em class="ly">:所有图像、图表、表格、方程式均由本人创作，除非另有说明。</em></p><p id="718a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你对这篇文章有任何意见或者想要联系我，请随时通过<a class="ae jc" href="https://www.linkedin.com/in/daniel-bradley-85653b65/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>给我发一个连接，或者让我们通过<a class="ae jc" href="https://github.com/DanlBradley" rel="noopener ugc nofollow" target="_blank"> Github </a>进行合作和联系。</p><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hi fi z dy mh ea eb mi ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq lb mc"/></div></div></a></div></div></div>    
</body>
</html>