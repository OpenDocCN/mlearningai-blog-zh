<html>
<head>
<title>A Thorough Dive into the Ames Iowa Housing Dataset. Part 1 of 4.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对艾姆斯衣阿华州住房数据的深入研究。第1部分，共4部分。</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/a-thorough-dive-into-the-ames-iowa-housing-dataset-part-1-of-5-7205093a5a53?source=collection_archive---------1-----------------------#2021-02-16">https://medium.com/mlearning-ai/a-thorough-dive-into-the-ames-iowa-housing-dataset-part-1-of-5-7205093a5a53?source=collection_archive---------1-----------------------#2021-02-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="2950" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">第1部分:处理空值和非数值。</h1><p id="38aa" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Ames Iowa housing数据集是一个广泛使用的数据集，用于向数据科学专业的学生教授回归分析的基础知识，同时提供清理和探索数据集的良好实践。</p><p id="4a70" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这篇文章是为机器学习准备艾姆斯爱荷华数据集的一步一步的演练。在本笔记结束时，我们将通过删除所有空值、验证数据类型、将序号数据转换为数值类型以及执行一些初步EDA，为功能工程准备好数据集。我们将很快拥有一个可以在我们选择的机器学习算法中处理的数据集！</p><p id="a8c8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><a class="ae kg" href="https://jesservillines.medium.com/a-thorough-dive-into-the-ames-iowa-housing-dataset-part-2-of-5-3e24ea276e1c" rel="noopener"> <strong class="je hi">本系列的第2部分</strong> </a>包含额外的EDA、特征工程和用于建模的特征选择。<a class="ae kg" href="https://jesservillines.medium.com/a-thorough-dive-into-the-ames-iowa-housing-dataset-part-3-of-4-2c00e0a0eacf" rel="noopener"> <strong class="je hi">本系列的第3部分</strong> </a> <strong class="je hi"> </strong>介绍了各种线性回归模型(OLS、岭、Lasso和ElasticNet)的构建、数据管道的实现以及优化模型超参数的网格搜索。<a class="ae kg" href="https://jesservillines.medium.com/a-thorough-dive-into-the-ames-iowa-housing-dataset-part-4-of-4-e127321885da" rel="noopener"> <strong class="je hi">第4部分</strong> </a> <strong class="je hi">，</strong>最后一部分，将向您展示如何将选择的模型部署到Streamlit在线应用程序。所有代码都包含在最终的Github存储库中。在这篇文章底部的Github知识库中有<a class="ae kg" href="https://github.com/jesservillines/Housing-Prices/tree/master/datasets" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi">数据集</strong> </a>，这样读者就可以跟随并复制这项工作。由于对所有功能的深入研究的细节，其中一些可能看起来是重复的，但彻底检查数据集是数据科学工作流程不可或缺的一部分，也是回答所选问题陈述的必要条件。</p><p id="18f1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在本演练中，您是一名数据科学家，在爱荷华州埃姆斯市的虚拟公共利益现实公司工作。你是一个团队中的一员，该团队致力于开发一个在线购房者工具箱，以帮助潜在购房者简化购房过程。这是一项非常重要的任务，因为研究表明，普通购房者在选定合适的房子之前，会在10周内参观10所房子。这是一个重大的财务和人生决定，因为购房者会在新买的房子里住上大约13年。【<a class="ae kg" href="https://www.nar.realtor/blogs/economists-outlook/how-long-do-homeowners-stay-in-their-homes#:~:text=As%20of%202018%2C%20the%20median,U.S.%20is%2013%20years1" rel="noopener ugc nofollow" target="_blank">消息来源</a>该项目的目标是减少寻求住房者寻找合适住房的时间，从而增加公司销售额，减少我们的房地产经纪人在每个客户身上花费的时间，并通过为每个客户的预算提供更好的住房匹配来提高公司的推荐率。</p><p id="28c8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">给你一个数据集，包括过去几十年的2051条房屋销售记录，有81个特征列。您的目标是创建一个具有特定于在线平台的功能的准确模型。总之，我们最终将使用28个特性列，其中许多都是为了满足上述问题陈述而设计的，只删除了13条记录，实现了92%的R。完整的数据字典可以在<a class="ae kg" href="http://jse.amstat.org/v19n3/decock/DataDocumentation.txt" rel="noopener ugc nofollow" target="_blank">这里</a>找到。打开Jupyter Lab的副本，按照提供的代码片段进行操作。</p><p id="c579" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">第一步是导入所有必需的库。这应该总是在你的笔记本顶部完成。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="2489" class="kq if hh km b fi kr ks l kt ku">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="1896" class="kq if hh km b fi kv ks l kt ku">#set_style<br/>plt.style.use('fivethirtyeight')</span><span id="88c8" class="kq if hh km b fi kv ks l kt ku">#configure for retina display<br/>%config InlineBackend.figure_format = 'retina'</span></pre><p id="a989" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">使用相对路径导入数据集，并为数据框指定一个描述性名称。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="da77" class="kq if hh km b fi kr ks l kt ku"># Read in data<br/>ames = pd.read_csv('../datasets/train.csv')</span><span id="3ef5" class="kq if hh km b fi kv ks l kt ku">#want to change columns names to lower/snake_case so a little easier to work with<br/>ames.columns = ames.columns.str.lower().str.replace(' ', '_')</span><span id="11b3" class="kq if hh km b fi kv ks l kt ku">#increase pandas default max_rows so I can view all columns at once<br/>pd.options.display.max_rows = 250<br/>pd.options.display.max_columns = 250</span></pre><p id="e52a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">然后，我们将看看数据集的形状、信息和汇总统计数据。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="d61b" class="kq if hh km b fi kr ks l kt ku">ames.shape #81 columns and 2051 records</span><span id="583c" class="kq if hh km b fi kv ks l kt ku">ames.info() # There are a lot of columns</span><span id="8e5f" class="kq if hh km b fi kv ks l kt ku">ames.describe().T #Summary statistics </span></pre><p id="7e3e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">下一步是处理空值，也就是缺失值。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="8eae" class="kq if hh km b fi kr ks l kt ku">#Investigate nulls<br/>ames.isnull().sum()[0:90]</span></pre><p id="0159" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">地段临街:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="0991" class="kq if hh km b fi kr ks l kt ku">ames['lot_frontage'].value_counts().head() #Linear feet of street connected to property</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es kw"><img src="../Images/19a42599068de1ad45a73f187ba97d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*hjxIGIkQ0V9SdWWIn80UZA.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="19b2" class="kq if hh km b fi kr ks l kt ku"># Apply mask/filter to examine only null values.<br/>lot_nulls = ames[ames['lot_frontage'].isna()] #lots with no linear feet of street connected to property</span><span id="25a1" class="kq if hh km b fi kv ks l kt ku"># These appear to be real properties. Setting to average for the corrosponding type of lot_config.</span><span id="aa67" class="kq if hh km b fi kv ks l kt ku">lot_nulls.head()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/5dcdb3d193c608385745433a320708a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0-13vUCnLAdQ0N-nReIWQ.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="1eeb" class="kq if hh km b fi kr ks l kt ku"># Group lots by configuration<br/>grouped_lots = ames.groupby(['lot_config']).agg({<br/>   'lot_frontage' : 'mean', <br/>})</span><span id="e48c" class="kq if hh km b fi kv ks l kt ku">grouped_lots</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es lj"><img src="../Images/5bbb83617341171eaae623518c67560b.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*rFvkGLEUHcvU2F4oLz0t5A.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><p id="11ff" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我决定用该批次配置类型的平均值来估算缺失值。这里有另外两种方法没有在本笔记本中探讨，但是可能值得研究一下，包括线性回归和K-means聚类。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="3e1a" class="kq if hh km b fi kr ks l kt ku">#replace np.nan with average for lot_config of that type<br/>ames.loc[(ames['lot_frontage'].isna()) &amp; (ames['lot_config'] == 'Corner'), 'lot_frontage'] = 83.25<br/>ames.loc[(ames['lot_frontage'].isna()) &amp; (ames['lot_config'] == 'CulDSac'), 'lot_frontage'] = 54.734375        <br/>ames.loc[(ames['lot_frontage'].isna()) &amp; (ames['lot_config'] == 'FR2'), 'lot_frontage'] = 60.836735        <br/>ames.loc[(ames['lot_frontage'].isna()) &amp; (ames['lot_config'] == 'FR3'), 'lot_frontage'] = 87.000000        <br/>ames.loc[(ames['lot_frontage'].isna()) &amp; (ames['lot_config'] == 'Inside'), 'lot_frontage'] = 66.759571</span></pre><p id="50e1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">检查以确保所有空值都得到处理:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="1355" class="kq if hh km b fi kr ks l kt ku">ames[‘lot_frontage’].isna().sum()</span></pre><p id="7a15" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">寻找异常值:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="d2e0" class="kq if hh km b fi kr ks l kt ku"># looking at outliers<br/>ames['lot_frontage'].sort_values().tail()</span></pre><p id="15e1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">记下要剔除的潜在异常值:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="ded1" class="kq if hh km b fi kr ks l kt ku">x_frontage_maybe_drop = ames[ames['lot_frontage'] == 313]<br/>x_frontage_maybe_drop</span></pre><p id="c250" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">然后进入下一个专栏“小巷”:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="ff46" class="kq if hh km b fi kr ks l kt ku">ames[‘alley’].value_counts()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es lk"><img src="../Images/c41c9d69662f1f08fc32adddcde9cb2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*aE9UAFvxIpgWbwoFqs7R-Q.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="be4a" class="kq if hh km b fi kr ks l kt ku">ames[‘alley’].isnull().sum() #1911 null values</span></pre><p id="a032" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这就是查阅我们的数据字典提供有价值的见解的地方。根据数据字典，这些值应该是NA，意味着这些房子没有小巷。我将一个热编码(OHE)/虚拟这个变量稍后。1如果有胡同，0如果房子没有胡同。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="b708" class="kq if hh km b fi kr ks l kt ku">ames['alley'] = ames['alley'].replace(np.nan, 'NA')</span></pre><p id="8a6b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">对特征的最终检查:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="b2e8" class="kq if hh km b fi kr ks l kt ku">ames['alley'].value_counts()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es ll"><img src="../Images/0425d574833e09503aec971b80084cbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*XNofa5x5nSU2zOzs-wFynw.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><p id="8a45" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">接下来，mas_vnr_type &amp; mas_vnr_area也称为砖石饰面类型和面积。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="fa08" class="kq if hh km b fi kr ks l kt ku">print(ames['mas_vnr_type'].value_counts())<br/>print(ames['mas_vnr_area'].value_counts())</span><span id="ff7c" class="kq if hh km b fi kv ks l kt ku">ames[ames['mas_vnr_type'].isna()].head()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lm"><img src="../Images/b25482e495b98a98ee8bc83c825b2927.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ijrQKdxv9oM04UbZjzyOkA.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><p id="148b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">同样，数据字典是我们的朋友，我们知道下面的代码片段将解决我们缺少值的问题。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="0344" class="kq if hh km b fi kr ks l kt ku">ames['mas_vnr_type'] = ames['mas_vnr_type'].replace(np.nan, 'None') #replace masonry np.nan with None<br/>ames['mas_vnr_area'] = ames['mas_vnr_area'].replace(np.nan, 0) #replace masonry np.nan with 0</span></pre><p id="3472" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">接下来，我们检查与地下室相关的变量:<br/> * bsmt_qual(评估地下室的高度)、<br/> * bsmt_cond(评估地下室的总体状况)、<br/> * bsmt_exposure(指步行区或花园水平墙)<br/>* bsmtfin _ type _ 1<br/>* bsmtfin _ SF _ 1<br/>* bsmtfin _ type _ 2<br/>* bsmtfin _ SF _ 2<br/>* bsmt _ UNF _ SF<br/>* total _ total</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="a00d" class="kq if hh km b fi kr ks l kt ku">ames['bsmt_qual'].value_counts() #missing NA for no basement</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es ln"><img src="../Images/2b47e90ced1e61bfa6e4fdbf6c88def6.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*2vfoieRnjtSor41X6NXZbg.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="8f75" class="kq if hh km b fi kr ks l kt ku">ames[['bsmt_qual', 'bsmt_cond', 'bsmt_exposure', 'bsmtfin_type_1', 'bsmtfin_sf_1', 'bsmtfin_type_2', 'bsmtfin_sf_2', 'bsmt_unf_sf', 'total_bsmt_sf','bsmt_full_bath', 'bsmt_half_bath']].isnull().sum()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es lj"><img src="../Images/bcae2291e5b49856f68ee96f94145dda.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*5HISawGMMC--C3lYzu9x7w.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="ee7a" class="kq if hh km b fi kr ks l kt ku">#these all receive an NA if no basement<br/>basement_to_na = [‘bsmt_qual’, ‘bsmt_cond’, ‘bsmt_exposure’, ‘bsmtfin_type_1’, <br/> ‘bsmtfin_type_2’]</span><span id="08c5" class="kq if hh km b fi kv ks l kt ku">#these receive 0sqft if basement is NA<br/>basement_to_zero = [‘bsmtfin_sf_2’, ‘bsmt_unf_sf’, ‘total_bsmt_sf’, ‘bsmtfin_sf_1’, ‘bsmt_full_bath’,<br/> ‘bsmt_half_bath’]</span><span id="4951" class="kq if hh km b fi kv ks l kt ku">for i in basement_to_na:<br/> ames[i] = ames[i].replace(np.nan, ‘NA’)</span><span id="6dc4" class="kq if hh km b fi kv ks l kt ku">ames[ames['bsmtfin_sf_1'].isna()] #the missing records are for NA basement properties. Setting to sqft value to zero.</span><span id="950e" class="kq if hh km b fi kv ks l kt ku">#set basement sqft to 0 IF basement is NA, else drop as incomplete basement data and only 1 null record for each    <br/>for i in basement_to_zero:<br/>    ames[i] = ames[i].replace(np.nan, 0)</span></pre><p id="dc28" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">接下来，壁炉_曲或壁炉质量。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="b877" class="kq if hh km b fi kr ks l kt ku">print(ames['fireplace_qu'].isnull().sum()) # There are 1000 missing values</span><span id="4c8d" class="kq if hh km b fi kv ks l kt ku">print(len(ames['fireplace_qu'])) # Remember we only have 2051 records. This is nearly half of the dataset</span></pre><p id="b622" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">该数据集中有许多序数值。为了使用这些特性进行建模，我们必须将dtype=object转换为numeric数据类型，但是只能在处理所有空值之后。在整个过程中，关注数据类型是非常重要的。计算机喜欢数字，但不喜欢别的。一切最终都需要简化成某种数字形式。在数据科学中，有许多方法可以做到这一点，甚至对于应用了自然语言处理(NLP)的复杂文本文档也是如此。这个数据集不需要任何NLP，但我们必须将序数特征转换为数字特征，以便我们的机器学习算法能够正确运行。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="a2e6" class="kq if hh km b fi kr ks l kt ku">ames['fireplace_qu'].unique()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es lo"><img src="../Images/607950755948bd4f28151e575e1ce558.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*kFlrN3yZHxQ3a3tjLxFM5g.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output, an example of ordinal values</figcaption></figure><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="6b6a" class="kq if hh km b fi kr ks l kt ku">ames[‘fireplaces’].unique()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es lp"><img src="../Images/1495492f47c5d863ef16702fd33a5aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*e8B5Awr2LULdksnsfFpLzw.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output, an example of discrete numeric values</figcaption></figure><p id="8771" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">确认没有壁炉的房子也是壁炉质量缺失的房子。使用多个列(如果可能的话)是一个非常好的主意，这样可以更好地了解为什么数据集中缺少信息。在这种情况下，我们确认可以用NA替换缺失值。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="a691" class="kq if hh km b fi kr ks l kt ku">len(ames[(ames['fireplace_qu'].isna()) &amp; (ames['fireplaces'] &lt; 1)]) #number of houses w/o fireplace = fireplace_qu np.nan is 1000!</span></pre><p id="91e9" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">执行更换:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="aeac" class="kq if hh km b fi kr ks l kt ku">ames['fireplace_qu'] = ames['fireplace_qu'].replace(np.nan, 'NA') #NA for 'No Fireplace'</span></pre><p id="e719" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在为车库相关的功能栏:</p><ul class=""><li id="25b4" class="lq lr hh je b jf ka jj kb jn ls jr lt jv lu jz lv lw lx ly bi translated">车库_类型<br/> *车库_yr_blt <br/> *车库_完成<br/> *车库_汽车<br/> *车库_面积<br/> *车库_质量<br/> *车库_条件</li></ul><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="a10b" class="kq if hh km b fi kr ks l kt ku">ames[['garage_type','garage_finish','garage_qual','garage_cond']].isnull().sum()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es lz"><img src="../Images/d35662a8a07802e377f84b0e62e1e236.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/format:webp/1*0efQ_wuEJfQY44dzMY-1yA.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="b10c" class="kq if hh km b fi kr ks l kt ku">#create two lists, one for catagorical and one for numeric</span><span id="32f8" class="kq if hh km b fi kv ks l kt ku">garage_to_na = ['garage_type','garage_finish','garage_qual','garage_cond']<br/>garage_to_0 = ['garage_yr_blt','garage_cars', 'garage_area']</span></pre><p id="0cb6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">基于数据字典用NA替换序数列。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="021f" class="kq if hh km b fi kr ks l kt ku">for i in garage_to_na:<br/>    ames[i] = ames[i].replace(np.nan, 'NA')</span></pre><p id="08b3" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">近距离观察数字车库的功能:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="c7d6" class="kq if hh km b fi kr ks l kt ku">ames[(ames[‘garage_yr_blt’].isna()) &amp; (ames[‘garage_type’] ==’NA’)] #113 rows, whats up with the missing 1 to make 114?</span><span id="8226" class="kq if hh km b fi kv ks l kt ku">garage_to_0.isnull().sum()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es ma"><img src="../Images/7e21740476a6802d8b1dcc021307d8e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:326/format:webp/1*tCUe8hTtI0wCFIPTPLON7Q.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="0881" class="kq if hh km b fi kr ks l kt ku">ames[ames['garage_cars'].isna()] #it has a garage type, but no more infor. I'm going to set this value to zero. This is an educated guess.</span></pre><p id="d849" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">最后一次检查，仔细检查你的工作总是一个好主意。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="127b" class="kq if hh km b fi kr ks l kt ku">ames[['garage_type','garage_finish','garage_qual','garage_cond','garage_yr_blt','garage_cars', 'garage_area']].isnull().sum()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div class="er es mb"><img src="../Images/b34be1201baca73e4ef0f11e5fbf1f49.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*N_Ql1Xz4ipPEr-Ttu2upFw.png"/></div><figcaption class="la lb et er es lc ld bd b be z dx">output, all garage nulls dealt with!</figcaption></figure><p id="0e6c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">接下来，pool_qc</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="1ed4" class="kq if hh km b fi kr ks l kt ku">ames['pool_qc'].isnull().sum() #mostly empty column. There are only 2051 records and 2042 of these are null values.</span></pre><p id="450d" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">从池特征中获得的信息很少。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="61b5" class="kq if hh km b fi kr ks l kt ku">print(ames['pool_qc'].unique()) #almost no information on pool. Going to set to a default 'TA' for average/typical IF pool YES.<br/>#Will probably end up dropping this column. May be important if pool dummy to YES/NO, but less so for pool quality.</span><span id="1f73" class="kq if hh km b fi kv ks l kt ku">for i in ames[(ames['pool_qc'].isna()) &amp; (ames['pool_area'] == 0)]:<br/>    ames['pool_qc'] = ames['pool_qc'].replace(np.nan, 'NA')</span></pre><p id="2068" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">栅栏特征:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="4c2d" class="kq if hh km b fi kr ks l kt ku">print(ames['fence'].isnull().sum()) # There are 1651 nulls for this feature</span><span id="e4b7" class="kq if hh km b fi kv ks l kt ku">#This replacement should feel like second nature by now.</span><span id="5d49" class="kq if hh km b fi kv ks l kt ku">ames['fence'] = ames['fence'].replace(np.nan, 'NA')</span><span id="8176" class="kq if hh km b fi kv ks l kt ku">ames['fence'].isnull().sum() #Zero nulls remain</span></pre><p id="15ad" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">杂项功能:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="7c58" class="kq if hh km b fi kr ks l kt ku">ames['misc_feature'].isnull().sum() #not surprise most do not have a 'Tennis court' or 'Elevator' on their property... 1986 nulls here. </span><span id="e985" class="kq if hh km b fi kv ks l kt ku">for i in ames[(ames['misc_feature'].isna()) &amp; (ames['misc_val'] == 0)]:<br/>    ames['misc_feature'] = ames['misc_feature'].replace(np.nan, 'NA')</span><span id="2d68" class="kq if hh km b fi kv ks l kt ku">ames['misc_feature'].isnull().sum() #no remaining null values</span></pre><p id="ee6e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">最后一次检查:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="3889" class="kq if hh km b fi kr ks l kt ku">ames.isnull().sum()</span></pre><p id="86d2" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">接下来，我们对照数据字典检查数据类型，以确保我们的数据框正确读取数据，并创建用于EDA的每种数据类型的列表。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="1e3b" class="kq if hh km b fi kr ks l kt ku">ames_indexing = [['id', 'pid']]</span><span id="268f" class="kq if hh km b fi kv ks l kt ku">#ordinal data. <br/>#Will want to convert these to numeric lists. <br/>#Note:'overall_qual','overall_cond' are already numeric</span><span id="07f2" class="kq if hh km b fi kv ks l kt ku">ames_ordinal = ames[['saleprice','lot_shape','utilities','land_slope','overall_qual','overall_cond','exter_qual', exter_cond','bsmt_qual', 'bsmt_cond', 'bsmt_exposure','bsmtfin_type_1','bsmtfin_type_2','heating_qc','electrical','kitchen_qual','functional', 'fireplace_qu','garage_finish', 'garage_qual','garage_cond','paved_drive','pool_qc','fence']]</span><span id="6f03" class="kq if hh km b fi kv ks l kt ku">ames_nominal = ames[['ms_subclass','ms_zoning','street','alley','land_contour','lot_config','neighborhood','condition_1', 'condition_2', 'bldg_type','house_style','roof_style','roof_matl', 'exterior_1st', 'exterior_2nd','mas_vnr_type','foundation','heating','central_air','garage_type','misc_feature','sale_type'     <br/>]]</span><span id="b01a" class="kq if hh km b fi kv ks l kt ku">ames_catagorical = ames[['street','alley', 'lot_shape', 'land_contour','utilities', 'lot_config', 'land_slope', 'neighborhood','condition_1', 'condition_2', 'bldg_type','house_style','roof_style', 'roof_matl', 'exterior_1st', 'exterior_2nd', 'mas_vnr_type','exter_qual', 'exter_cond', 'foundation', 'bsmt_qual','bsmt_cond', 'bsmt_exposure', 'bsmtfin_type_1','bsmtfin_type_2','heating', 'heating_qc', 'central_air', 'electrical','kitchen_qual', 'functional', 'fireplace_qu','garage_type','garage_finish','garage_qual',<br/>'garage_cond', 'paved_drive','pool_qc','fence', 'misc_feature','sale_type']]</span><span id="adab" class="kq if hh km b fi kv ks l kt ku">ames_numeric_catagory = ames[['saleprice','ms_subclass', 'ms_zoning', 'overall_qual','overall_cond', 'mo_sold'                ]]</span><span id="a1e8" class="kq if hh km b fi kv ks l kt ku">ames_numeric = ames[['saleprice','lot_frontage', 'lot_area','year_built','year_remod/add','mas_vnr_area','bsmtfin_sf_2', 'bsmt_unf_sf', 'total_bsmt_sf','1st_flr_sf', '2nd_flr_sf', 'low_qual_fin_sf', 'gr_liv_area', 'bsmt_full_bath',<br/> 'bsmt_half_bath', 'full_bath', 'half_bath', 'bedroom_abvgr',<br/>'kitchen_abvgr','totrms_abvgrd','fireplaces','garage_yr_blt','garage_cars', 'garage_area','wood_deck_sf', 'open_porch_sf', 'enclosed_porch', '3ssn_porch','screen_porch', 'pool_area','misc_val','yr_sold']]</span><span id="dbea" class="kq if hh km b fi kv ks l kt ku">y = ames['saleprice'] # our target variable</span></pre><p id="22e1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在进行一些初步的探索性数据分析。在这里，我们着眼于视觉上检查我们的变量的洞察力可能不容易显而易见。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="e720" class="kq if hh km b fi kr ks l kt ku">sns.pairplot(ames_numeric_catagory) #initial eda on numeric features</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es mc"><img src="../Images/8d310db3485c5015fb23d864bc124c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CEMHlRCU93untdj7gViPcQ.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">output, what trends stand out to you?</figcaption></figure><p id="041b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在这个初步的视觉检查之后，我们看到夏季月份有更多的销售，销售价格(我们的目标)有一个明显的倾斜，并且有更多的房子比其他月份有平均的整体状况。</p><p id="3b93" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">让我们将我们的顺序特性列转换成数字，这样我们也可以看看这些特性的相关性。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="28f6" class="kq if hh km b fi kr ks l kt ku">#ordinal columns<br/>ames_ordinal.head()</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es md"><img src="../Images/f1c1208866a627420e38eb8661579ded.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dHw8hkNx-Za1IUKPQ_ehxw.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">output</figcaption></figure><p id="8875" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我选择了字典替换法，因为这是一种简单的映射技术，初级分析师可以很容易地接受培训来更新，以防Common Good Reality决定将购房者工具箱的这一部分扩展到其他城市或使用最近的房屋销售来更新我们的数据集。现在的情况是，高质量或高权重的值被赋予比小数值更大的数值。在这里，数字是基于对特征列中每个值的分布的视觉检查来选择的。可以使用一种更复杂的方法来研究标准偏差和分布，以改进这一部分。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="6774" class="kq if hh km b fi kr ks l kt ku">#ordinal data. Will want to convert these to ordinal lists.</span><span id="5861" class="kq if hh km b fi kv ks l kt ku">#columns I want to replace values in<br/>ames_ordinal_str_columns = ames[['lot_shape','utilities','land_slope','exter_qual', <br/>                 'exter_cond','bsmt_qual',<br/>       'bsmt_cond', 'bsmt_exposure', 'bsmtfin_type_1','bsmtfin_type_2','heating_qc','electrical','kitchen_qual',<br/>                'functional','fireplace_qu','garage_finish','garage_qual','garage_cond','paved_drive','pool_qc','fence']]</span><span id="35b0" class="kq if hh km b fi kv ks l kt ku">#dictionary of values I want to replace<br/>dict_ordinal = {<br/>    #overall_qual, overall_cond,exter_qual,exter_cond,bsmt_qual,bsmt_cond,bsmt_exposure,heatingqc,kitchenqual<br/>    #firplacequ,garage_qual,garage_cond,pool_qc,fence<br/>    'Ex': 5,<br/>    'Gd': 4,<br/>    'TA': 3,<br/>    'Fa': 2,<br/>    'Po': 1,<br/>    'NA': 0,<br/>     #lot_shape<br/>    'Reg':4,<br/>    'IR1':3,<br/>    'IR2':2,<br/>    'IR3':1,<br/>    #utilities<br/>    'AllPub':4,<br/>    'NoSewr':3,<br/>    'NoSeWa':2,<br/>    'ELO':1,<br/>    #land_slope<br/>    'Gtl':3,<br/>    'Mod':2,<br/>    'Sev':1,<br/>    #bsmt_exposure<br/>    'Av': 3,<br/>    'Mn': 2,<br/>    'No': 1,<br/>    #bsmtfin_type_1, bsmtfin_type_1<br/>    'GLQ':6,<br/>    'ALQ':5,<br/>    'BLQ':4,<br/>    'Rec':3,<br/>    'LwQ':2,<br/>    'Unf':1,<br/>    #Electrical<br/>    'SBrkr':1,<br/>    'FuseA':0,<br/>    'FuseF':0,<br/>    'FuseP':0,<br/>    'Mix':0,<br/>    #Functional<br/>    'Typ':1,<br/>    'Min1':0,<br/>    'Min2':0,<br/>    'Mod':0,<br/>    'Maj1':0,<br/>    'Maj2':0,<br/>    'Sev':0,<br/>    'Sal':0,<br/>    #garage_finish    <br/>    'Fin': 3,<br/>    'RFn': 2,<br/>    'Unf':1,<br/>    #paved_drive<br/>    'Y' : 2,<br/>    'P' : 1,<br/>    'N' : 0,<br/>    #fence<br/>    'GdPrv':4,<br/>    'MnPrv':3,<br/>    'GdWo':2,<br/>    'MnWw':1   <br/>}</span><span id="41d1" class="kq if hh km b fi kv ks l kt ku">#loop to get the job done<br/>for i in ames_ordinal_str_columns.columns:<br/>    ames.replace({i: dict_ordinal},inplace = True)</span></pre><p id="e8ed" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这些特性列现在应该都是数字，让我们来看看:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="3e7a" class="kq if hh km b fi kr ks l kt ku">#visually inspect that the change took<br/>ames[['lot_shape','utilities','land_slope','exter_qual', 'exter_cond','bsmt_qual','bsmt_cond', 'bsmt_exposure', 'bsmtfin_type_1','bsmtfin_type_2','heating_qc','electrical','kitchen_qual','functional','fireplace_qu','garage_finish','garage_qual','garage_cond','paved_drive','pool_qc','fence']].head(3)</span></pre><figure class="kh ki kj kk fd kx er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es me"><img src="../Images/c05cdfad035fa0762caae18fff1aa68d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_RFj4oUpIp517cSF-7rkpA.png"/></div></div><figcaption class="la lb et er es lc ld bd b be z dx">output, exactly what we want!</figcaption></figure><p id="5aa4" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">直观地检查数据类型，所有数据类型都返回int64:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="4ff3" class="kq if hh km b fi kr ks l kt ku">#checking to see if all dtypes now numeric<br/>ames[['lot_shape','utilities','land_slope','exter_qual', 'exter_cond','bsmt_qual','bsmt_cond', 'bsmt_exposure', 'bsmtfin_type_1','bsmtfin_type_2','heating_qc','electrical','kitchen_qual','functional','fireplace_qu','garage_finish','garage_qual','garage_cond','paved_drive','pool_qc','fence']].dtypes</span></pre><p id="dd8f" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在让我们对邻域特征做同样的操作。直觉上，这将是一个重要的特性。谈到房价，位置很重要。</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="da28" class="kq if hh km b fi kr ks l kt ku">#I don't want to dummy neighboorhood, but I do want to bin it into oridinal columns based on mean price<br/>ames['neighborhood_order'] = ames['neighborhood']<br/>ames_ordinal_str_columns = ames[['neighborhood_order']]</span><span id="4576" class="kq if hh km b fi kv ks l kt ku">dict_ordinal = {<br/>    'MeadowV': 1,<br/>    'IDOTRR' : 1,<br/>    'BrDale' : 1,<br/>    'OldTown': 1,<br/>    'BrkSide': 1,<br/>    'Edwards': 1,<br/>    'SWISU': 1,<br/>    'Landmrk':2,<br/>    'Sawyer':2,<br/>    'NPkVill':2,<br/>    'Blueste':2,<br/>    'NAmes':2,<br/>    'Mitchel':2,<br/>    'SawyerW':2,<br/>    'Greens':3,<br/>    'Gilbert':3,<br/>    'NWAmes':3,<br/>    'Blmngtn':3,<br/>    'CollgCr':3,<br/>    'Crawfor':3,<br/>    'ClearCr':3,<br/>    'Somerst':4,<br/>    'Timber':4,<br/>    'Veenker':4,<br/>    'GrnHill':4,<br/>    'StoneBr':4,<br/>    'NoRidge':4,<br/>    'NridgHt':4,<br/>        }</span><span id="dbe3" class="kq if hh km b fi kv ks l kt ku">#loop to get the job done<br/>for i in ames_ordinal_str_columns.columns:<br/>    ames.replace({i: dict_ordinal},inplace = True)</span></pre><p id="222e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">请注意，我决定将它分成四个独立的箱，而不是为所有的邻域使用一个唯一的箱。这是特征工程的一部分，也是数据科学的一部分，与其说是科学，不如说是艺术。这也是进入本系列下一部分的完美过渡。</p><p id="3a0e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">查看这个四部分系列的<a class="ae kg" href="https://jesservillines.medium.com/a-thorough-dive-into-the-ames-iowa-housing-dataset-part-2-of-5-3e24ea276e1c" rel="noopener"> <strong class="je hi">第二部分</strong> </a>，在这里我们将继续深入研究艾姆斯衣阿华数据集，其中包括额外的EDA、特征工程和用于建模的特征选择。</p><p id="0125" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">Github资源库:【https://github.com/jesservillines/Housing-Prices T4】</p><p id="56c7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">作者的领英:<a class="ae kg" href="https://www.linkedin.com/in/jesse-villines/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jesse-villines/</a></p><p id="e2c3" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如果你喜欢这项工作，请直接在LinkedIn上提出问题或想法，以便进一步合作！</p></div></div>    
</body>
</html>