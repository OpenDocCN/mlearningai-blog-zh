<html>
<head>
<title>Automatic Training using FastAPI, Pytorch and SerpApi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用FastAPI、Pytorch和SerpApi进行自动训练</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/automatic-training-using-fastapi-pytorch-and-serpapi-7d052ab3ac23?source=collection_archive---------1-----------------------#2022-06-02">https://medium.com/mlearning-ai/automatic-training-using-fastapi-pytorch-and-serpapi-7d052ab3ac23?source=collection_archive---------1-----------------------#2022-06-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/89f1a30a056282f8ad9b3d80aa3671a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ds1cO8Ae7qlEbfkhqnlYyg.jpeg"/></div></div></figure><div class=""/><p id="fa38" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是与人工智能实现相关的系列博文的一部分。如果你对故事的背景或情节感兴趣:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="e9df" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在前几周，我们探索了如何使用SerpApi的Google Images Scraper API自动创建自己的图像数据集。本周，我们将使用这些图像来自动训练一个使用简单命令对象传递给FastAPI的网络。</p><h1 id="cad4" class="ju jv hs bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">自定义CSV</h1><p id="19f6" class="pw-post-body-paragraph ip iq hs ir b is ks iu iv iw kt iy iz ja ku jc jd je kv jg jh ji kw jk jl jm ha bi translated">我们需要创建一个自定义的CSV文件，其中包含我们需要的图像。我们将使用熊猫图书馆。以下是要求:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="9245" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们需要创建一个从SerpApi的Google Image Scraper API收集的项目列表，设置要创建的csv文档的名称，并为训练数据定义一个分数。分数在这里的意思很简单。测试数据包含了我们收集的所有图像，而训练数据只占其中的一小部分。为此，我们需要创建一个可以传递给端点的对象:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="eb1e" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里提到的分数有一个简单的解释。测试数据集将包含所有图像，而训练数据集将只取其中的一小部分。这是为了在我们使用尚未训练的图像(即测试数据集的差异)对模型进行训练后测试模型。<br/>现在我们已经定义了负责命令的对象，让我们定义CSVCreator类:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="7596" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">它接受我们给出的参数列表，这些参数是我们对SerpApi的Google Images Scraper API进行的查询，并在相应的文件夹中为每个图像创建一个CSV。一旦所有的图像都完成了，它会随机抽取一小部分样本，并创建一个训练CSV。<br/>让我们在<code class="du kx ky kz la b">main.py</code>中定义一个函数来调用这样的动作:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="3675" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这些类有必要在<code class="du kx ky kz la b">main.py</code>中调用它<br/>负责动作的函数是:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="f8e7" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">举个直观的例子，如果你去<code class="du kx ky kz la b">http://localhost:8000/docs</code>用以下参数测试<code class="du kx ky kz la b">/create/</code>:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><figure class="jn jo jp jq fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lb"><img src="../Images/42d806aa538c483ad48fc0a50581c30c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7KHuYRSWQ5DUDWwE.png"/></div></div></figure><p id="a6f5" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您将在<code class="du kx ky kz la b">datasets/csv</code>中创建两个名为<code class="du kx ky kz la b">apples_and_oranges.csv</code>和<code class="du kx ky kz la b">apples_and_oranges_train.csv</code>的csv文件</p><p id="c7ad" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du kx ky kz la b">apples_and_oranges.csv</code>将是测试CSV，将是有序的，将有所有的图像，并将看起来像这样:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="c597" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du kx ky kz la b">apples_and_oranges_train.csv</code>将会是火车CSV，将会被打乱，将会有80%的图片，并且将会是这样的:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="ea8d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这两个将用于创建数据集项。</p><h1 id="4e6d" class="ju jv hs bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">自定义训练命令</h1><p id="86d0" class="pw-post-body-paragraph ip iq hs ir b is ks iu iv iw kt iy iz ja ku jc jd je kv jg jh ji kw jk jl jm ha bi translated">我们需要一个对象来指定训练操作的细节，并在多个类之间共享使用以避免循环导入:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="32e3" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们来分解这个对象中的项目:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="5ce0" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里固定的图像高度和宽度本身有时是不够的。图像可能会失真。本周，我们将不应用任何变换来减少噪声。这种行为的原因来自批量装载。成批的张量图像应该具有相同的大小。</p><h1 id="a186" class="ju jv hs bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">自定义数据集和自定义数据加载器</h1><p id="e524" class="pw-post-body-paragraph ip iq hs ir b is ks iu iv iw kt iy iz ja ku jc jd je kv jg jh ji kw jk jl jm ha bi translated">现在我们已经有了所需的命令，让我们来看看创建数据集和数据加载器的要求:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="480a" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，让我们初始化数据集类:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="e29b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们使用<code class="du kx ky kz la b">type</code>参数来定义我们是否正在用以下部分初始化<code class="du kx ky kz la b">train</code>数据库或<code class="du kx ky kz la b">test</code>数据库:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="5b7a" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要定义在模型成形中使用的标签列表，我们使用以下行:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="d462" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这为我们提供了一个要分类的项目字典，每个项目都有自己唯一的整数:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="1763" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们必须为输入和标签定义特定的转换。这些变换定义了它们将如何被转换成用于训练的张量，以及在它们的变换之后应该应用哪些操作:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="8b41" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们定义一个函数，它给出给定数据集中的图像数量:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="90b8" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，我们需要定义给出什么，一个图像张量和一个标签张量:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="1c4c" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们一部分一部分地分解它。<br/>下面一行将获得具有给定索引的图像路径:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="4951" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">假设数据集是训练数据集，索引为0:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="6478" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这将是我们的<code class="du kx ky kz la b">self.img_labels.iloc[0,0]</code>。<br/>路径中有<code class="du kx ky kz la b">test</code>的原因是因为我们暂时将所有文件保存在<code class="du kx ky kz la b">test</code>目录中。图像取自<code class="du kx ky kz la b">apples_and_oranges_train.csv</code>的数据帧。所以它不会引起问题。<br/>下面几行将从有问题的标签索引中创建一个热点向量:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="eedd" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我之所以注释<code class="du kx ky kz la b">[0., 0.]</code>是因为在我们的例子中有2个标签，分别是<code class="du kx ky kz la b">Apple</code>和<code class="du kx ky kz la b">Orange</code>，所以向量的大小将由此定义。我们把它转换成numpy数组，以便转换成张量。<br/>以下代码行将使用PIL库读取图像并将其调整到所需的大小:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="b7be" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将图像转换成RGB，得到一个三维向量，第三个是颜色。然后，我们使用抗锯齿方法调整它的大小，使它仍然可以被眼睛识别。就像我之前说的，这通常是不够的。但是我们现在就这样做。</p><p id="0e2f" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在是定制数据加载器:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="7023" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们使用前面提到的<code class="du kx ky kz la b">type</code>参数初始化其中的<code class="du kx ky kz la b">self.train_dataloader</code>和<code class="du kx ky kz la b">self.test_dataloader</code>。然后，我们使用Pytorch的DataLoader函数来声明一个加载器。批处理大小定义了调用dataloader时要获取的图像数量。<br/>在迭代中，我们在<code class="du kx ky kz la b">self.train_dataloader</code>上迭代，使用我们在初始化中定义的定制图像数据集给出一个图像及其相应的标签。<br/> <code class="du kx ky kz la b">train_features</code>将是我们从数据集中取出的一批图像的张量，<code class="du kx ky kz la b">train_labels</code>将是这些图像对应的一批标签。</p><h1 id="c344" class="ju jv hs bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">自动训练</h1><p id="d647" class="pw-post-body-paragraph ip iq hs ir b is ks iu iv iw kt iy iz ja ku jc jd je kv jg jh ji kw jk jl jm ha bi translated">现在我们有了一个定制的图像数据集，一个从数据集加载图像的定制数据加载器，让我们通过使用<code class="du kx ky kz la b">TrainCommands</code>对象来利用自动训练。培训课程和模型的要求是:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="a735" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们也声明我们想要使用的CNN模型:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="6a00" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里需要注意的一点是，在我们的例子中，输出大小n_labels是2，因为我们只在<code class="du kx ky kz la b">Apple</code>和<code class="du kx ky kz la b">Orange</code>之间进行分类。还有一个计算要做，这是从我手动计算的嵌入大小和图像的高度和宽度。总的来说，这是一个非常通用的图像分类函数。在接下来的几周里，我们将讨论如何自动计算我手动计算的尺寸，以及如何从<code class="du kx ky kz la b">TrainCommands</code>添加更多的层来进一步自动化这个过程。<br/>现在让我们定义使用自定义数据集和自定义数据加载器的训练函数:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="2c8b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们一部分一部分地分解它。以下代码行使用训练命令，用自定义数据集初始化自定义训练数据加载器。：</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="ed4e" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一行使用训练命令声明模型(卷积神经网络):</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="cd78" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下行负责创建标准:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="e0c3" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在我们的例子中，这等同于<code class="du kx ky kz la b">torch.nn.CrossEntropyLoss()</code>。</p><p id="3292" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一行用于创建具有所需参数的优化器:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="91d3" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这相当于<code class="du kx ky kz la b">torch.optim.SGD(CNN.parameters(), lr=0.001, momentum=0.9)</code> <br/>在接下来的几周中，我们将有一种方法给出带有可选名称的可选参数，以无限制地填充优化器和标准。但是现在，这已经足够了。</p><p id="af50" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，我们初始化要运行的epochs的数量以及要保存的模型的名称:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="bd4d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在以下部分中，我们迭代历元，消除损失，并使用<code class="du kx ky kz la b">enumerate</code>函数从数据集中调用图像和标签:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="f1cc" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据将以元组的形式出现:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="a318" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，我们将优化器中的梯度归零:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="0299" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">运行预测:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="8fba" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后将预测值与实际标签进行比较，使用我们的标准计算损失:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="bd15" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">标签在这里被压缩以匹配在标准函数中计算的输入的形状。</p><p id="0fdb" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，我们运行反向传播来自动重新累积梯度:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="ddfe" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们逐步优化:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="3f10" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后更新<code class="du kx ky kz la b">running_loss</code>:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="1e15" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下各行是流程每5步的输出:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="0e21" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，我们将模型保存到所需的位置:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="f5d7" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们已经准备好了一切，让我们在<code class="du kx ky kz la b">main.py</code>中声明一个可以获取训练命令的端点。<code class="du kx ky kz la b">main.py</code>的最终形式将是:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><p id="2588" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du kx ky kz la b">/train/</code> endpoint将接受我们的命令，并自动为我们训练一个模型。</p><p id="218e" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，如果你前往<code class="du kx ky kz la b">localhost:8000/docs</code>，用以下参数试试我们的<code class="du kx ky kz la b">/train/</code>:</p><figure class="jn jo jp jq fd hj"><div class="bz dy l di"><div class="jr js l"/></div></figure><figure class="jn jo jp jq fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lc"><img src="../Images/d30c9b76b17d0fbb186de4e506cdaca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AzrI75pDe69qAG7M.png"/></div></div></figure><p id="a1cb" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以从终端观察训练过程，因为我们为epochs声明了打印功能:</p><figure class="jn jo jp jq fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ld"><img src="../Images/89454a747c0a0dc0560ce77cf0e9c2b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Pb9vHHotDnY2wi77.png"/></div></div></figure><p id="2d47" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">培训结束后，您将在<code class="du kx ky kz la b">models</code>文件夹中保存一个模型，并使用您指定的名称:</p><figure class="jn jo jp jq fd hj er es paragraph-image"><div class="er es le"><img src="../Images/b19935d6715fb4653eba02de3c51952f.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/0*2w6kb8F6XFwt43dh.png"/></div></figure><h1 id="c5d3" class="ju jv hs bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">结论</h1><p id="3cc1" class="pw-post-body-paragraph ip iq hs ir b is ks iu iv iw kt iy iz ja ku jc jd je kv jg jh ji kw jk jl jm ha bi translated">我感谢SerpApi 的<a class="ae jt" href="https://serpapi.com/team" rel="noopener ugc nofollow" target="_blank">聪明人让这篇博文成为可能，我也感谢读者的关注。在接下来的几周，我们将讨论如何使这里提到的一些部分更有效，更可定制。我们还将讨论更多关于FastAPI对所有进程的异步处理，以及对SerpApi的Google Images Scraper API的调用。</a></p></div><div class="ab cl lf lg go lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ha hb hc hd he"><p id="5ad5" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="lm">原载于2022年6月2日https://serpapi.com</em><a class="ae jt" href="https://serpapi.com/blog/automatic-training-fastapi-pytorch-serpapi/" rel="noopener ugc nofollow" target="_blank"><em class="lm"/></a><em class="lm">。</em></p><div class="hg hh ez fb hi ln"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd ht fi z dy ls ea eb lt ed ef hr bi translated">Mlearning.ai提交建议</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb ho ln"/></div></div></a></div></div></div>    
</body>
</html>