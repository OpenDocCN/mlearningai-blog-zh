<html>
<head>
<title>Can the data split method improve your model performance?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据分割方法能提高你的模型性能吗？</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/can-the-data-split-method-improve-your-model-performance-b2571691c61d?source=collection_archive---------3-----------------------#2022-06-04">https://medium.com/mlearning-ai/can-the-data-split-method-improve-your-model-performance-b2571691c61d?source=collection_archive---------3-----------------------#2022-06-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="5e82" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">我很久以来的第一个科技故事…</h1><p id="e62d" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">大家好，在这篇文章中，我想谈论一个有趣而简单的话题，这是我正在从事的一个项目中的一个隐藏问题，我们所有人都忽略了这一事实，我们花了几个月的时间尝试模型和清理数据，相信我们的数据加载和拆分方法，但我们没有得到任何改进，那是什么呢？？</p><p id="5cdc" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">让我们从陈述一些规则开始</p><ol class=""><li id="f5c6" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">我不能陈述关于项目范围的许多细节，所以我将谈论可能适合其他类似问题的主线</li><li id="b828" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">我想def不会谈论火车测试分流obv-</li></ol></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><ul class=""><li id="4927" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz la kl km kn bi translated">假设读者对ML模型有足够的了解并测试它们-</li></ul><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lb"><img src="../Images/4c83fc1c4b1617524cb0dfa88aef19a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r73p1rxMZWnZLoYi5Odf4A.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx">the process of splitting the data</figcaption></figure><h1 id="45e3" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">为什么我们需要分割我们的数据？</h1><p id="902e" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">通常，在构建ML模型进行实验时，我们会尝试几种模型架构或学习方法，因此将数据集分成训练/测试/验证部分有助于我们:</p><ol class=""><li id="097c" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">在众多型号中选择最佳型号。</li><li id="b8ae" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">选择最佳的模型参数或设置。</li><li id="e796" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">拥有一个维持测试集有助于我们通过显示模型看不见的数据来测量真实的性能，也就是准确性，而不仅仅是通过验证准确性来判断——因为它可能会因为数据泄漏而具有欺骗性</li></ol><h1 id="8b6a" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">我们如何分割数据？</h1><p id="be24" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">有许多已知的方法，最常见的方法是选择70%用于训练，剩下的30%用于验证和测试，您可以使用任何工具来这样做scikit learn、numpy、pandas，或者如果您的数据集包含几个文件夹/文件，如果它们不是很多，您可以手动完成。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lr"><img src="../Images/a6229c9ab71efb80e65d442eae064318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z-LE3kis3SeeLWoiW2EzRw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx">different split ratios</figcaption></figure><h1 id="0dd2" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">我的问题</h1><p id="868a" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在我的例子中，我的训练集由大约250GB的原始卫星图像加上25个标签文件组成，数据经过几个处理步骤，直到到达最后一步，大约有25个大的CSV文件。</p><p id="a4ad" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这是一个:</p><p id="5180" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">多类像素分类</strong>分割也很重要的问题。</p><p id="1215" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">我们使用的旧方法</strong>是我们将25个CSV文件分割如下:13个完整文件用于训练，6个用于测试，6个用于验证。</p><p id="ef16" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我们不断训练不同的模型，即使在执行了所有应该改善结果的技术之后，也总是得到相同的坏结果，无论是增强、上采样、下采样、数据清理(手动/自动)，还是将模型更改为更简单/复杂的模型，更改优化器、损失函数和<strong class="je hi">等一切。</strong></p><p id="1b95" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">然而同样的坏结果只有不到1%的改善。</p><p id="afa3" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">然后一个偶然的机会，</strong>我正在对一小组数据做实验，所以我使用了sklearn的train_test_split方法，<strong class="je hi">令人惊讶的是，所有类别的准确率都达到了+90%!！！！</strong></p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es ls"><img src="../Images/758aad97538aa4fd0dc3941e6360de76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VmM5uZiSJihB9hZfnCzzsQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx">a similar example to my problem — image segmentation/pixel classification</figcaption></figure><h1 id="b961" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated"><strong class="ak">思维过程</strong></h1><p id="45ba" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">作为一个一直在那个项目中为所有类获得80%的准确率而奋斗的人，我感到震惊！然后我做了3件事，教会了我关于问题范围的不同事情。</p><p id="aa84" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">1-使用旧方法重新训练所有模型以比较结果。</p><p id="13b4" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">2-将所有数据合并成一个巨大的CSV文件，将其随机化，并分成训练/测试/验证。</p><p id="7c23" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">3-将25个文件中的每个文件分成培训/测试/验证，结果是25个文件用于培训，25个用于测试，25个用于验证。</p><h1 id="246b" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结果和行动/实验</h1><p id="014c" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><strong class="je hi">方法#1: <br/>虽然有些人认为这是最合理的方法，但模型学习曲线和绩效都没有反映出这一点</strong></p><ol class=""><li id="9da7" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">学习过程非常不稳定，模型从未达到饱和点，曲线从未平滑或稳定。</li><li id="9301" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">数字/结果总是非常非常低。</li><li id="37df" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">即使在它之前看到的数据(使用训练数据作为输入)上，生产中的性能也很糟糕</li></ol><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es lt"><img src="../Images/5c7e4e613d46fbb6c4733c6d9e2657c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ctp86mmjQE2U1TVzcK5HlA.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx">model instability</figcaption></figure><p id="2b5d" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">方法#2: <br/>没有#1那么糟糕，事实上，模特的表现令人惊讶</strong></p><ol class=""><li id="c100" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">学习曲线非常稳定。</li><li id="df83" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">所有类别的准确率都非常高，达到90%以上。</li></ol><p id="6cbb" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">但是<br/> </strong>巨大的问题是随机化像素使它失去了正确分割图像的能力，它在单个像素上表现良好，但是相邻的相似像素没有被正确定位</p><p id="1f86" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">同样在方法#1和#2 <strong class="je hi">中，模型没有看到每个时期的所有类。</strong></p><p id="01c0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">方法#3 <br/>我称之为成功，它在所有方面都表现得令人惊讶，模型能够正确地定位片段，顺利地学习，并产生良好的结果，这是一个巨大的惊喜。</strong></p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lu"><img src="../Images/4526f138ca23d2e968cf916e8ed64609.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_fatNDj9whEyuXlHPwMTg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx">stable curve</figcaption></figure><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lv"><img src="../Images/edb1f6f0ee7afc5c320bb029c4677329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6Uhb8MI4REGcYKkYM9OUQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx">example stable output</figcaption></figure><h1 id="42d3" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">外卖</h1><p id="9b55" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我从所有这些实验中学到的最大教训是，永远不要低估我们在构建每个ML模型时所做的非常简单、重复的任务的力量，有时最小的事情也很重要。</p><p id="93d6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">另一件事是尝试，永远不要怀疑我的猜测，我曾经猜测这可能是我们的问题，有人说没有办法，但我尝试了，它的工作。</p></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><p id="e913" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在ML/DL模型上工作有时会非常乏味和烦人，当你认为你的问题是架构时，它可能只是数据、软件错误或逻辑错误，而在其他时候，你可能认为它是数据，结果是模型或另一个错误，还没有明确的规则，这可能使事情有点烦人，但它也使它们有趣和有趣，每天打开一个区域来学习新的东西。</p><div class="lw lx ez fb ly lz"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hi fi z dy me ea eb mf ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">medium.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn ll lz"/></div></div></a></div></div></div>    
</body>
</html>