<html>
<head>
<title>Database for Datascientist? Easy and quick solution with MongoDB and Pandas+Streamlit (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学家的数据库？用MongoDB和Pandas+Streamlit实现简单快速的解决方案(第2部分)</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/database-for-datascientist-easy-and-quick-solution-with-mongodb-and-pandas-streamlit-part-2-e8ec1eeb9a58?source=collection_archive---------1-----------------------#2022-10-30">https://medium.com/mlearning-ai/database-for-datascientist-easy-and-quick-solution-with-mongodb-and-pandas-streamlit-part-2-e8ec1eeb9a58?source=collection_archive---------1-----------------------#2022-10-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/86368bdd460b4e889c95b8e36609c80e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*py79SthYDTOMpwW3"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/es/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kelly Sikkema</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="699e" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">简介</strong></h2><p id="239d" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km ha bi translated">在上一篇文章中，我们已经看到了如何使用MongoDB创建数据库，以及如何在Pandas中使用它。在本文中，我们将看到如何将MongoDB与Streamlit一起使用，并作为web应用程序进行部署。</p><h2 id="765a" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">什么是细流？</strong></h2><p id="f3bf" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km ha bi translated"><a class="ae it" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>是一个开源的Python库，可以轻松创建和共享漂亮的、定制的机器学习和数据科学web应用。</p><p id="3d02" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">对于数据科学家和机器学习工程师来说，这是为他们的项目创建web应用程序的一个很好的工具。这是非常容易使用，并有很多功能。</p><p id="f384" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">Streamlit的好处在于它非常易于使用。您只需几行代码就可以创建一个web应用程序，不需要HTML、CSS或JavaScript。</p><p id="6be2" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">另一个好处是，你可以在不同的平台上免费部署，比如Heroku、AWS和Google Cloud。</p><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ks"><img src="../Images/98959717f608d18517a8a12dbc941283.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pY-SllIs-E9WpnWUiQgukQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image taken from the Streamlit website: <a class="ae it" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank">https://streamlit.io/</a></figcaption></figure><p id="17d0" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated"><strong class="ju hi">安装</strong></p><p id="f626" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">安装Streamlit非常简单，可以在您的专用python环境中使用pip来完成。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="c60a" class="iu iv hh ky b fi lc ld l le lf"><strong class="ky hi">pip</strong> <strong class="ky hi">install streamlit</strong></span></pre><p id="a916" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">安装Streamlit后，要验证它是否安装正确，可以在终端中运行以下命令。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="50ff" class="iu iv hh ky b fi lc ld l le lf">`<strong class="ky hi">streamlit hello</strong></span></pre><p id="41ba" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">这将在您的浏览器中打开一个新的选项卡，并带有一个简单的web应用程序，如下图所示。</p><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lg"><img src="../Images/f1ac99eeb7e5b8a1289f59930f5243bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*POW723SHC3FwHsR2GyFg-w.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Source: <a class="ae it" href="https://pythonforundergradengineers.com/streamlit-app-with-bokeh.html" rel="noopener ugc nofollow" target="_blank">https://pythonforundergradengineers.com/streamlit-app-with-bokeh.html</a></figcaption></figure><h2 id="33fd" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">使用Streamlit创建一个基本的web应用程序，并将其插入MongoDB </strong></h2><p id="0c2d" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km ha bi translated">在下一节中，我们将使用Streamlit创建一个基本的web应用程序，该应用程序从MongoDB中检索数据并将其显示在一个表中。</p><p id="f575" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">该应用程序非常基本，它只是为了展示如何使用MongoDB的Streamlit，所以不要期望有很多功能，它只会显示用st.dataframe() :-)构建的表中的数据。</p><p id="8d11" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated"><strong class="ju hi">如果你对Streamlit更高级的特性感兴趣，请在下面写评论，我会再写一篇关于它的文章:-)。</strong></p><h2 id="93ea" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">数据集:西雅图Airbnb房源</strong></h2><p id="b689" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km ha bi translated">我在这个例子中使用的数据集是西雅图Airbnb房源数据集。它<strong class="ju hi">包含了西雅图Airbnb的房源信息。</strong>数据集在<a class="ae it" href="https://www.kaggle.com/airbnb/seattle/data" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上可用。</p><p id="96ae" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">我不会在这里详细解释我是如何在我的MongoDB数据库上加载数据集的，但是对于这个练习，你可以使用<strong class="ju hi"> MongoDB Compass GUI </strong>上传csv文件，你可以在这里找到文档<a class="ae it" href="https://docs.mongodb.com/compass/master/import-export/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="c622" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">这很容易做到。您也可以使用pymongo Python API for MongoDB以编程方式实现这一点。</p><p id="5f53" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">请看下面的截图，使用MongoDB Compass将csv文件添加到您的数据库是多么容易。</p><ol class=""><li id="8827" class="lh li hh ju b jv kn jz ko jf lj jj lk jn ll km lm ln lo lp bi translated"><strong class="ju hi">将数据集添加到MongoDB Compass </strong></li></ol><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/79cca56c94b85f9d2a2e0f977da267b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tI1CX4T5WVd4y1_WxBUtTA.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">MongoDB Compass Console Import FIle</figcaption></figure><p id="eee0" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">2.<strong class="ju hi">导入CSV和JSON文件到MongoDB Compass </strong></p><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lr"><img src="../Images/bd10abeca07773851b5fa55a696efe91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QgNM6_6j_DbSXWGjwM1w5w.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">MongoDB Compass Select File Window (CSV or JSON)</figcaption></figure><p id="ccb9" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">3.<strong class="ju hi">数据集可视化为MongoDB Compass中的集合</strong></p><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/840b6036421095592486877931a53a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yLq3gKJAGhH9cN3jwHK-WA.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Seattle Dataset as a Mongo Collection on MongoDB Compass</figcaption></figure><h2 id="be37" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">代码:让我们构建一个简单的web应用程序</h2><p id="fccb" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km ha bi translated">现在我们在MongoDB中有了数据集，我们可以开始构建我们的web应用程序了。代码非常简单，它只是展示了如何使用MongoDB的Streamlit。</p><p id="ac94" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated"><strong class="ju hi">这是一个python文件</strong>，所以我们需要用。py扩展名。我把它叫做app_st.py(不是很有创意，我知道:-))。</p><ol class=""><li id="bf8f" class="lh li hh ju b jv kn jz ko jf lj jj lk jn ll km lm ln lo lp bi translated"><strong class="ju hi">导入库</strong></li></ol><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="cc12" class="iu iv hh ky b fi lc ld l le lf"><strong class="ky hi">import pandas as pd</strong></span><span id="884e" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">import numpy as np</strong></span><span id="4122" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">import pymongo</strong></span><span id="1a40" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">from pymongo import MongoClient</strong></span><span id="d257" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">import streamlit as st</strong></span></pre><p id="fb1c" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">2.<strong class="ju hi">连接到MongoDB </strong></p><p id="9613" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">导入库之后，我们需要连接到我们的MongoDB数据库。我们可以使用pymongo库中的MongoClient()函数来实现。我们需要指定MongoDB数据库的主机和端口。</p><p id="fb35" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">在我的例子中，我使用默认的主机和端口，所以我不需要指定它们。我屏蔽了我的用户名和密码，当然:-)。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="4ccb" class="iu iv hh ky b fi lc ld l le lf">#connect to mongodb</span><span id="5eed" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">client = MongoClient('mongodb+srv://User:mypsw@cluster0.ragcpnf.mongodb.net/?retryWrites=true&amp;w=majority')</strong></span></pre><p id="bbff" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">3.<strong class="ju hi">获取数据库和集合</strong></p><p id="4c4f" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">连接到MongoDB后，我们需要指定数据库和我们想要使用的集合。在我的例子中，我使用数据库“Marcello_test”(我的名字……)和集合“Seattle_listing”。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="19af" class="iu iv hh ky b fi lc ld l le lf">#  Get an existing database named "Marcello_test"</span><span id="402b" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">db1 = client.Marcello_test</strong></span><span id="e595" class="iu iv hh ky b fi lt ld l le lf">#   Get a collection named "Seattle_listing"</span><span id="05c8" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">collection_main = db1.Seattle_listing</strong></span></pre><p id="2427" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">4.<strong class="ju hi">解析从MongoDB到Pandas的文档</strong></p><p id="b24a" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">现在我们有了集合，我们可以解析熊猫的文档。我们可以使用pymongo库中的<strong class="ju hi"> find() </strong>函数来实现。我们还可以指定要从集合中检索的字段。在我的例子中，我正在检索所有的字段。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="175e" class="iu iv hh ky b fi lc ld l le lf"># save the documents in a dataframe</span><span id="1c49" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">df = pd.DataFrame(<em class="lu">list</em>(collection_main.find()))</strong></span><span id="b4cd" class="iu iv hh ky b fi lt ld l le lf"># drop the _id field, not needed, it is created automatically by MongoDB</span><span id="54b1" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">df1 = df.drop(['_id'], <em class="lu">axis</em>=1)</strong></span></pre><p id="6a7a" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">5.<strong class="ju hi">用Streamlit创建网络应用</strong></p><p id="70f1" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">现在我们有了熊猫数据框架中的数据，我们可以用Streamlit创建我们的web应用程序。我们可以使用<strong class="ju hi"> st.dataframe() </strong>函数来显示表格中的数据。我们还可以使用<strong class="ju hi"> st.title() </strong>函数为我们的web应用程序添加一个标题。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="b443" class="iu iv hh ky b fi lc ld l le lf"># setting the screen size</span><span id="f0ac" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">st.set_page_config(<em class="lu">layout</em>="wide",<em class="lu">page_title</em>="Seattle Airbnb Data")</strong></span><span id="5079" class="iu iv hh ky b fi lt ld l le lf"># main title</span><span id="c223" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">st.title('Seattle Airbnb Listings MongoDB') </strong></span><span id="00a2" class="iu iv hh ky b fi lt ld l le lf"># main text</span><span id="6ff1" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">st.subheader('This app is a Streamlit app that retrieve mongodb data and show it in a dataframe')</strong> # subheader</span><span id="5f7f" class="iu iv hh ky b fi lt ld l le lf"># write text and description</span><span id="749b" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">st.write('Data: Sample of Seattle listing with Name, Description, Price')</strong> </span><span id="11d3" class="iu iv hh ky b fi lt ld l le lf"># display the dataframe in a table</span><span id="e745" class="iu iv hh ky b fi lt ld l le lf"><strong class="ky hi">st.dataframe(df1)</strong> </span></pre><p id="ee84" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">全部完成！！只用几行代码，我们就创建了一个web应用程序，它从MongoDB中检索数据，并将其显示在一个表格中。</p><p id="c423" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">6.<strong class="ju hi">使用Streamlit在本地运行web应用</strong></p><p id="f9d2" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">现在代码已经准备好了，我们可以使用Streamlit在本地运行web应用程序。我们可以在终端中使用下面的命令。</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="2c87" class="iu iv hh ky b fi lc ld l le lf"><strong class="ky hi">streamlit run app_st.py</strong></span></pre><p id="8a8f" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">该代码将使用本地主机，在您的浏览器中打开一个新的选项卡，web应用程序如下图所示。</p><p id="ce5e" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">瞧啊。我们已经创建了一个web应用程序，它从MongoDB中检索数据并将其显示在一个表中。</p><figure class="kt ku kv kw fd ii"><div class="bz dy l di"><div class="lv lw l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Simple Streamlit App deployed on localhost</figcaption></figure></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><h1 id="ebc4" class="me iv hh bd iw mf mg mh ja mi mj mk je ml mm mn ji mo mp mq jm mr ms mt jq mu bi translated">作者:</h1><p id="8f09" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km ha bi translated">我写关于数据科学、python编码项目和数据驱动营销的文章。我还为数据新手或数据入门者提供数据和业务指导。</p><p id="8217" class="pw-post-body-paragraph js jt hh ju b jv kn jx jy jz ko kb kc jf kp ke kf jj kq kh ki jn kr kk kl km ha bi translated">你可以在<a class="ae it" rel="noopener" href="/@Marcello_Dichiera">媒体</a>和<a class="ae it" href="https://twitter.com/ItalyMarcello" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我，或者访问我的<a class="ae it" href="https://marcello-personal-website.netlify.app/" rel="noopener ugc nofollow" target="_blank">网站</a>和<a class="ae it" href="https://github.com/marcello-calabrese" rel="noopener ugc nofollow" target="_blank"> Github页面</a>。</p><div class="mv mw ez fb mx my"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mz ab dw"><div class="na ab nb cl cj nc"><h2 class="bd hi fi z dy nd ea eb ne ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nf l"><h3 class="bd b fi z dy nd ea eb ne ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ng l"><p class="bd b fp z dy nd ea eb ne ed ef dx translated">medium.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm in my"/></div></div></a></div></div></div>    
</body>
</html>