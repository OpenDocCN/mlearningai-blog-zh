<html>
<head>
<title>MediaPipe with Python for Dummies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">假人用Python制作的MediaPipe</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/mediapipe-with-python-for-dummies-3d3021da6705?source=collection_archive---------3-----------------------#2022-08-22">https://medium.com/mlearning-ai/mediapipe-with-python-for-dummies-3d3021da6705?source=collection_archive---------3-----------------------#2022-08-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/bf1c4a2949da95a94ba79c1bce71d503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hgg6bLceoIjubE2hBiJK4g.png"/></div></div></figure><p id="f572" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">MediaPipe是Google的一个项目，它为直播和流媒体提供“开源、跨平台、可定制的ML解决方案”。换句话说，MediaPipe提供了对各种强大的机器学习模型的访问，这些模型是在考虑到移动设备的硬件限制的情况下构建的。</p></div><div class="ab cl jn jo go jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ha hb hc hd he"><p id="823d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">MediaPipe适用于C++、Android等；但是，在本教程中，我们将只使用Python。基本思路可以看参考文献[1]。这里，我们将用简单的代码展示几个例子。请注意，我们使用的是<strong class="ir hi"> MediaPipe版本0.8.3 </strong>。</p><p id="76f2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">示例1:三维面网格</p><blockquote class="ju jv jw"><p id="89de" class="ip iq jx ir b is it iu iv iw ix iy iz jy jb jc jd jz jf jg jh ka jj jk jl jm ha bi translated">这里我们将捕捉面网格(3D)；在空白画布上重新绘制，得到如下输出:</p></blockquote><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kb"><img src="../Images/7711317a40f58f022e44f581286282ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VyPTcSjAfKaXkprIUC0ZVA.png"/></div></div></figure><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="d02a" class="kl km hh kh b fi kn ko l kp kq"><strong class="kh hi">#Code </strong>with comments<br/>import cv2 as cv<br/>import mediapipe as mp<br/>import numpy as np</span><span id="2e10" class="kl km hh kh b fi kr ko l kp kq">mpfacemesh = mp.solutions.face_mesh<br/>FaceMesh = mpfacemesh.FaceMesh(max_num_faces=1)<br/>mpdraw = mp.solutions.drawing_utils<br/>drawspec1 = mpdraw.DrawingSpec(color = (255,255,0), circle_radius = 0, thickness = 1)<br/>drawspec2 = mpdraw.DrawingSpec(color = (0,255,0), circle_radius = 0, thickness = 1)<br/>webcam = cv.VideoCapture(0)</span><span id="8819" class="kl km hh kh b fi kr ko l kp kq">while True:<br/>  <br/> scc,img = webcam.read()<br/> img = cv.flip(img,1)<br/> h,w,c = img.shape<br/> blank_img = np.zeros((h,w,c), np.uint8)<br/> results = FaceMesh.process(img)<br/> <br/> if results.multi_face_landmarks:<br/>  for face_lm in results.multi_face_landmarks:<br/>   img = blank_img<br/>   mpdraw.draw_landmarks(img,face_lm,<br/>         mpfacemesh.FACE_CONNECTIONS,<br/>         drawspec1,drawspec2)<br/> k = cv.waitKey(1)<br/> if k == ord('q'):<br/>  break<br/> cv.imshow('face mesh 3d', img)</span><span id="710c" class="kl km hh kh b fi kr ko l kp kq">webcam.release()  <br/>cv.destroyAllWindows()</span></pre><p id="7b7a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">示例2:简单的增强现实</p><blockquote class="ju jv jw"><p id="f555" class="ip iq jx ir b is it iu iv iw ix iy iz jy jb jc jd jz jf jg jh ka jj jk jl jm ha bi translated">在这里，我们首先将检测眼睛和眉毛；然后最后画一个虚拟眼镜(2D)得到如下输出:</p></blockquote><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kb"><img src="../Images/9615f721c2f81ff5af88e0b703ce0c87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-8exLucKlS4fu2OQVLKB1g.png"/></div></div></figure><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="8543" class="kl km hh kh b fi kn ko l kp kq"><strong class="kh hi">#Code </strong>with comments<br/>import cv2 as cv<br/>import mediapipe as mp<br/>import numpy as np</span><span id="9965" class="kl km hh kh b fi kr ko l kp kq">mpfacemesh = mp.solutions.face_mesh<br/>FaceMesh = mpfacemesh.FaceMesh(max_num_faces=1)<br/>mpdraw = mp.solutions.drawing_utils<br/>drawspec1 = mpdraw.DrawingSpec(color = (255,255,0), circle_radius = 0, thickness = 1)<br/>drawspec2 = mpdraw.DrawingSpec(color = (0,255,0), circle_radius = 0, thickness = 1)<br/>webcam = cv.VideoCapture(0)</span><span id="c0e5" class="kl km hh kh b fi kr ko l kp kq">#following indices are available in mediapipe dev site<br/>EYE_LEFT_CONTOUR = [<br/>    249, 263, 362, 373, 374,<br/>    380, 381, 382, 384, 385,<br/>    386, 387, 388, 390, 398, 466]<br/>EYE_RIGHT_CONTOUR = [<br/>    7, 33, 133, 144, 145,<br/>    153, 154, 155, 157, 158,<br/>    159, 160, 161, 163, 173, 246]<br/>LEFT_EYEBROW = [<br/>    276, 282, 283, 285, 293, 295, 296, 300, 334, 336]<br/> <br/>RIGHT_EYEBROW = [<br/>    46, 52, 53, 55, 63, 65, 66, 70, 105, 107]</span><span id="8e4e" class="kl km hh kh b fi kr ko l kp kq">while True:<br/>  <br/> scc,img = webcam.read()<br/> img = cv.flip(img,1)<br/> h,w,c = img.shape<br/> results = FaceMesh.process(img)<br/> <br/> if results.multi_face_landmarks:<br/>  for face_lm in results.multi_face_landmarks:<br/>   X=[]<br/>   Y=[]<br/>   for lm in face_lm.landmark:<br/>    X.append(int(lm.x*w))<br/>    Y.append(int(lm.y*h))<br/>   #left eye center<br/>   xl = int(np.mean([X[i] for i in EYE_LEFT_CONTOUR]))<br/>   yl = int(np.mean([Y[i] for i in EYE_LEFT_CONTOUR]))<br/>   cv.circle(img,(xl,yl),9,(255,0,255),7)<br/>   #right eye center<br/>   xr = int(np.mean([X[i] for i in EYE_RIGHT_CONTOUR]))<br/>   yr = int(np.mean([Y[i] for i in EYE_RIGHT_CONTOUR]))<br/>   cv.circle(img,(xr,yr),9,(255,0,255),7)<br/>   cv.line(img,(xl,yl),(xr,yr),(255,0,255),3)<br/>   #eyebrows<br/>   xlb = int(np.mean([X[i] for i in LEFT_EYEBROW]))<br/>   ylb = int(np.mean([Y[i] for i in LEFT_EYEBROW]))<br/>   xrb = int(np.mean([X[i] for i in RIGHT_EYEBROW]))<br/>   yrb = int(np.mean([Y[i] for i in RIGHT_EYEBROW]))<br/>   #final drawing<br/>   cv.putText(img,'*',(xl-9,yl+9),cv.FONT_HERSHEY_SIMPLEX,1,(0,255,0),3)<br/>   cv.putText(img,'*',(xr-9,yr+9),cv.FONT_HERSHEY_SIMPLEX,1,(0,255,0),3)<br/>   cv.putText(img,'^',(xlb-9,ylb),cv.FONT_HERSHEY_SIMPLEX,1,(0,255,0),3)<br/>   cv.putText(img,'^',(xrb-9,yrb),cv.FONT_HERSHEY_SIMPLEX,1,(0,255,0),3)<br/>   <br/> k = cv.waitKey(1)<br/> if k == ord('q'):<br/>  break<br/> cv.imshow('augmented reality', img)</span><span id="060d" class="kl km hh kh b fi kr ko l kp kq">webcam.release()  <br/>cv.destroyAllWindows()</span></pre><p id="94b3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">注意，示例1给出3D输出，而示例2给出2D输出。如果你喜欢这个帖子，请鼓掌。保持联系，获取更多关于Vision的帖子。谢了。</p></div><div class="ab cl jn jo go jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ha hb hc hd he"><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="6859" class="kl km hh kh b fi kn ko l kp kq">References:</span><span id="52ba" class="kl km hh kh b fi kr ko l kp kq">[1] <a class="ae ks" href="https://google.github.io/mediapipe/" rel="noopener ugc nofollow" target="_blank">https://google.github.io/mediapipe/</a></span></pre><div class="kt ku ez fb kv kw"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kx ab dw"><div class="ky ab kz cl cj la"><h2 class="bd hi fi z dy lb ea eb lc ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ld l"><h3 class="bd b fi z dy lb ea eb lc ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="le l"><p class="bd b fp z dy lb ea eb lc ed ef dx translated">medium.com</p></div></div><div class="lf l"><div class="lg l lh li lj lf lk in kw"/></div></div></a></div></div></div>    
</body>
</html>