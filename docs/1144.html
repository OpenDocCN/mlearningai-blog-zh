<html>
<head>
<title>Drawing and plotting observations from a Multivariate Normal Distribution using R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用R绘制多元正态分布的观察值</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/drawing-and-plotting-observations-from-a-multivariate-normal-distribution-using-r-4c2b2f64e1a3?source=collection_archive---------1-----------------------#2021-10-11">https://medium.com/mlearning-ai/drawing-and-plotting-observations-from-a-multivariate-normal-distribution-using-r-4c2b2f64e1a3?source=collection_archive---------1-----------------------#2021-10-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4d59" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大多数人熟悉的第一个分布是正态分布，即高斯分布。这是有意义的，因为世界上的许多过程都可以用正态分布来近似，如果它们不能，那么它们肯定可以通过<a class="ae jc" href="https://en.wikipedia.org/wiki/Central_limit_theorem" rel="noopener ugc nofollow" target="_blank">中心极限定理</a>来近似。</p><p id="c348" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正态分布如此吸引人的另一个方面是它由两个独立估计的参数组成——均值和方差。它们不是真正独立的，因为较大的平均值通常会导致较大的方差，但它们很容易构思和估计。</p><p id="0587" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我已经发布了很多关于<a class="ae jc" rel="noopener" href="/@marc.jacobs012/introduction-to-mixed-models-in-r-9c017fd83a63">混合模型</a>的内容，混合模型的一个关键部分是<a class="ae jc" href="https://en.wikipedia.org/wiki/Covariance_matrix" rel="noopener ugc nofollow" target="_blank">方差-协方差矩阵</a>，它被引入模型的随机部分。方差-协方差听起来令人印象深刻，但实际上并不新鲜，因为你们大多数人很早就已经了解了它最著名的变换——相关性。相关矩阵是缩放的方差-协方差矩阵。</p><p id="7f2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你没记错的话，你知道相关性是两个或更多变量之间的关联，范围从-1到1，0表示没有任何关联。因为变量不能与自身相关，所以这里的值为0。所有这些使得相关矩阵非常吸引人，但是对于大多数算法来说，它一点帮助都没有。他们更喜欢方差-协方差矩阵。</p><p id="c60c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">多元正态分布是用方差-协方差矩阵来描述一组变量之间关系的正态分布。潜在的假设是每个变量都遵循正态分布&amp;任何两个变量的组合也遵循正态分布。</p><p id="54af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个介绍性示例中，我将向您展示如何使用方差-协方差矩阵来创建多元正态分布，以及如何测试您是否真正拥有多元正态分布</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Import the necessary libraries. Both MASS and mvtnorm can product multivariate normal observations</figcaption></figure><p id="b210" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该分布最重要的部分是方差-协方差矩阵，这里描述为适马。在左下方的图中，您可以看到变量1和2的方差分别为10和2。他们的协方差是3。因此，变量2的值依赖于变量1，反之亦然。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">To create a multi-normal distribution, you need a mean (0), and variance-covariance matrix (Sigma)</figcaption></figure><div class="jd je jf jg fd ab cb"><figure class="jo jh jp jq jr js jt paragraph-image"><img src="../Images/7b96e344e1070a08fca3d496a05db210.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/format:webp/1*NG2KYl00PTieA0AYsZf_Vw.png"/></figure><figure class="jo jh jw jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/2c6f9cdbe04d54498870547099fbeb74.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*6cPWD21qaR989zjze4Mj1w.png"/></div></figure><figure class="jo jh kb jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/21a14797808135d2e1d473c97ef9f0db.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*EW8H5MAKnDU-Bh2BF6oZEA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx kc di kd ke">Left: the variance-covariance matrix. Middle is the dataset created by the MASS package based on the input. Right you will find a plot of what you produced.</figcaption></figure></div><p id="f7b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://cran.r-project.org/web/packages/MVN/MVN.pdf" rel="noopener ugc nofollow" target="_blank"> MVN包</a>提供了一些很好的工具来测试你的数据集是否真正包含服从多元正态分布的数据。直方图，QQ，盒，散点图可以要求。还有多种测试可用于查看变量是单变量还是多变量正态分布。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Code is straightforward.</figcaption></figure><div class="jd je jf jg fd ab cb"><figure class="jo jh kf jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/0664289b9c204c0175b6936d486f6395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*3vtcMiJYj8rdep0-61PGgw.png"/></div></figure><figure class="jo jh kg jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/66f3805e31f96776d3c0b0cd8812b220.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*a77ivJXIPDU_coy9zRePPg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx kh di ki ke">I requested a bootstrapped test, showing that the dataset is NOT multivariate normal, although both variables separately are normally distributed.</figcaption></figure></div><div class="ab cb"><figure class="jo jh kj jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/6e734002a05af1f7a6d4441cf7df145f.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*JHqSZDsvW6CXGM-ClkH_xw.png"/></div></figure><figure class="jo jh kk jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/ee7db3900c36975e73580adf52e23466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*o6zYu4nMid2WrLX3l5aNYg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx kl di km ke">Boxplot shows nothing strange, but the scatterplot does. The correlation is too much. In an Multivariate Normal distribution, you do not expect observations to show a slope. I do not see outliers that worry me.</figcaption></figure></div><p id="1976" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二个例子，使用来自<a class="ae jc" href="https://cran.r-project.org/web/packages/mvtnorm/mvtnorm.pdf" rel="noopener ugc nofollow" target="_blank"> mvtnorm </a>包的rmvnorm函数。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><div class="jd je jf jg fd ab cb"><figure class="jo jh kn jq jr js jt paragraph-image"><img src="../Images/1f093a21290442be71785d723033056b.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*Cs4DS7xBfW6vz2dYyifuuA.png"/></figure><figure class="jo jh ko jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/8ce99561263baaeabf6d20a13eebc307.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*GeIKyOIkCNtpKlmzIFWREQ.png"/></div></figure></div><p id="3632" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们通过创建一个七变量方差-协方差矩阵来让事情变得更令人兴奋。你在下面看到的矩阵是通过一位科学家提供给我的。所以，最难的部分其实已经完成了。记住方差永远不会低于零，但是协方差可以是负的。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Create dataframe based on zero means and variance-covariance matrix. Then request assessments of univariate/multivariate normality and outliers.</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kp"><img src="../Images/0a5a4d1371bae3ffa4706df2d5fce26a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zb5LtRQ2jsaIYOUP2KP0XQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Observations coming from the Multivariate Normal distribution.</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kq"><img src="../Images/d520fa0127814600fd8932c75608bc05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3p0ivegSyzqva7NRA6slQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Test statistic shows that only variable 6 does not fit the specific for Normality, but that as a group it is Multivariate Normal.</figcaption></figure><div class="jd je jf jg fd ab cb"><figure class="jo jh kr jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/9db70a3653e8f1dd0f1bfce0b4309a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*GPYbIqmRLh1wMggfY98otA.png"/></div></figure><figure class="jo jh ks jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/7e13ace310fb48008f4c35614ddfa1d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*KOkv1hIC108hQ5YfDmyINA.png"/></div></figure><figure class="jo jh ks jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/217b8b15eead39d8a21f04e2e1232ed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*jspr0Wk_vpjZJtEKEO00Ig.png"/></div></figure></div><div class="ab cb"><figure class="jo jh kt jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/852084a15c4c855cf217c17414bfeb33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*Eu0inznviC4R-IqkztB4Kw.png"/></div></figure><figure class="jo jh ku jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/f99dd6d58fefd52703befee3369750c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*a7k0tpycaFFQFYYoRcY5lg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx kh di ki ke">Plots confirm this.</figcaption></figure></div><p id="364c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们进入最有趣的部分——绘制数据集中所有变量之间的关系，以及特定的组合。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><div class="jd je jf jg fd ab cb"><figure class="jo jh kv jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/00326f36afdc0ccf4dcbdd98a8949786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*cgP5N8T5ZjOgDnnehwhhoA.png"/></div></figure><figure class="jo jh kv jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/c5efb15a44d767b6ca044d80dba43676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*S_v17VNaapF99i99ARxGJg.png"/></div></figure></div><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><div class="jd je jf jg fd ab cb"><figure class="jo jh kw jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/de188e79727a1034d1fc65da3fd58d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*GTrhOszjtywuot9RVae02Q.png"/></div></figure><figure class="jo jh kw jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/5cde53cbf16fc06523af2a0b0af3b407.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*v6uBs1w-d0wcII5J0_IRJw.png"/></div></figure><figure class="jo jh kw jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/8ec82061110496bb6656deb9bf5f121b.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*hC5QdrOu6tooiMCSIkc5hw.png"/></div></figure></div><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><div class="jd je jf jg fd ab cb"><figure class="jo jh kv jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/fd51beb11c050e69f17025996f17c2c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*2FKM8F_bKmO4glUVPYmmRw.png"/></div></figure><figure class="jo jh kv jq jr js jt paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><img src="../Images/2ec34039426d54b2886b73f469381efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*cztsnU_UPH9CWNp8HcI-mA.png"/></div></figure></div><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jx jy di jz bf ka"><div class="er es kx"><img src="../Images/f5abbe6a6c5fdca6f47812f611788766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4QtadICr9C1bWAbLuDcKug.png"/></div></div></figure><p id="3d2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本质上，多元正态分布没什么可怕的。它只是一个正态分布与一个正态分布配对，从而产生一个多元分布，因为这两个变量不是独立的。生活中的许多变量都不是独立的，所以习惯这一点是有好处的。</p><div class="ky kz ez fb la lb"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lc ab dw"><div class="ld ab le cl cj lf"><h2 class="bd hi fi z dy lg ea eb lh ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="li l"><h3 class="bd b fi z dy lg ea eb lh ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lj l"><p class="bd b fp z dy lg ea eb lh ed ef dx translated">medium.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp ju lb"/></div></div></a></div></div></div>    
</body>
</html>