<html>
<head>
<title>AI in the real world — 3. Make your own Grammarly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现实世界中的人工智能-3。用你自己的语法</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/ai-in-the-real-world-3-make-your-own-grammarly-36348d3f1c62?source=collection_archive---------3-----------------------#2021-12-18">https://medium.com/mlearning-ai/ai-in-the-real-world-3-make-your-own-grammarly-36348d3f1c62?source=collection_archive---------3-----------------------#2021-12-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/eff7c603a9d7c7c9bb09df7793544b98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*RGiOY0Du1eQ70CVWWR5u1g.jpeg"/></div></figure><p id="514b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Grammarly是AI在这十年取得的重大突破之一。我假设我们大多数人都知道什么是语法，以及我们如何从这样的工具中受益匪浅。如果我告诉你，你可以使用<a class="ae jj" href="https://huggingface.co/docs/transformers/index" rel="noopener ugc nofollow" target="_blank">变形金刚</a>很容易地制作你自己的最小拼写纠正工具，而不需要专门的编码知识。好吧，让我们不要等待，一头扎进帖子里。</p><p id="396e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">根据我的理解，Grammarly的补充版本完成了这三项主要任务:</p><ul class=""><li id="316a" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated">寻找<strong class="in hi">拼写错误</strong></li><li id="591d" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated"><strong class="in hi">意译</strong>句子</li><li id="7019" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">为我们提供了句子的情感</li></ul><p id="f351" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，我们将无法实现与语法相似的性能，但我们可以通过为拼写错误建立简单的序列到序列模型以及为分类任务建立零命中率学习器来轻松达到基本准确性。</p><h1 id="9a99" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">先决条件</h1><ul class=""><li id="a640" class="jk jl hh in b io kw is kx iw ky ja kz je la ji jp jq jr js bi translated">至少支持2GB GPU的系统</li><li id="7ca1" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">变形金刚(电影名)</li><li id="a3ab" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">火炬</li><li id="a666" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">大约50，000个随机句子的数据</li></ul><h1 id="9606" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">系统模型化</h1><p id="dd71" class="pw-post-body-paragraph il im hh in b io kw iq ir is kx iu iv iw lb iy iz ja lc jc jd je ld jg jh ji ha bi translated">为了建立任何模型，我们都需要数据，如果你得不到足够的数据，不用担心，使用任何文本生成模型，如GPT，甚至任何文本到文本生成模型，可以生成大约5万到10万个句子。然后使用这段简单的代码随机估算句子中的拼写错误，这样现在您就可以将源作为损坏的句子，将目标作为语法正确的句子。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="ede3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">上面的代码片段将估算句子中随机选择的单词的错误。参数<strong class="in hi"> <em class="lk"> n_words </em> </strong>是我们如何控制一个句子中我们需要估算错误的单词数。</p><p id="e259" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我选择了T5 small并使用了大约50k个句子作为建立模型的数据集。选择T5模型的主要原因是因为它们是seq-seq建模任务中最好的模型之一，并且由于变压器中的注意力机制，它们在效率和性能方面远远优于LSTMs或rnn。为了实现建模部分，你可以看看<a class="ae jj" href="https://github.com/huggingface/notebooks/blob/master/examples/summarization.ipynb" rel="noopener ugc nofollow" target="_blank">变形金刚</a>的官方教程。上面提到的笔记本解释了如何微调t5-small模型的摘要任务，但是通过更改每个句子的前缀，您可以根据自己的意愿针对不同的任务进行微调。如果您想跳过所有这些，并且需要一个带有可配置参数的简单包装器，请随意尝试<a class="ae jj" href="https://www.kaggle.com/vishnunkumar/neuspell" rel="noopener ugc nofollow" target="_blank">这个</a>。这基本上是一个简单的包装器，我写的微调NLP模型目前，它只支持这三个:</p><ul class=""><li id="9eb8" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated">Bert-base-不考虑分类任务</li><li id="cab3" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">t5-小型，用于序列-序列任务。</li></ul><p id="0b46" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一旦你对你的模型进行了微调，你就可以尝试你的模型，或者使用下面的代码片段来利用我已经微调过的模型。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="bab1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">上面的代码实例化了两个transformers模型，分别用于给定句子中的拼写纠正和情感分类。对于后者，请仔细阅读变压器给出的关于<a class="ae jj" href="https://huggingface.co/docs/transformers/v4.14.1/en/main_classes/pipelines#transformers.ZeroShotClassificationPipeline" rel="noopener ugc nofollow" target="_blank">零炮</a>分类的文件。请在下面找到上述代码如何工作的简单例子</p><pre class="le lf lg lh fd ll lm ln lo aw lp bi"><span id="0ce4" class="lq jz hh lm b fi lr ls l lt lu">input_text = input()<br/>gram = Grammarly(input_text)<br/>gram.grammarly()</span></pre><p id="7043" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">输出:</strong></p><pre class="le lf lg lh fd ll lm ln lo aw lp bi"><span id="f846" class="lq jz hh lm b fi lr ls l lt lu">input_text = I am happu to inform that w ehave won the competetio</span><span id="9f57" class="lq jz hh lm b fi lv ls l lt lu">{'emotion': 'happy',<br/> 'emotion_score': 0.5591591596603394,<br/> 'modified_text': 'I am happy to inform that i have won the competition'}</span><span id="8fbe" class="lq jz hh lm b fi lv ls l lt lu"><br/>input_text = That is sad to har the passing away of hs grandfather</span><span id="1ee3" class="lq jz hh lm b fi lv ls l lt lu">{'emotion': 'sad',<br/> 'emotion_score': 0.5666968822479248,<br/> 'modified_text': 'That is sad to have the passing away of his grandfather'}</span></pre><p id="b51d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">好吧，我们不会对上面看到的完全满意，但至少有一个重要的部分，拼写纠正器能够正确地找到不正确的单词，并用语义上接近句子上下文的单词替换它。通过使用更大的模型，即(来自BigScience的t5-large甚至T0，它在许多任务中击败了来自OpenAI的GPT-3)或增加训练数据，调整参数，我们可以获得更好的结果。我用最大序列长度32对模型进行了微调，这里使用的模型对较长的句子不太适用。也就是说，对于更小更简单的句子，这种模式将一如既往地有效</p><p id="e3b4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">好吧，让我们总结一下，因为我想拖X)，谢谢大家的宝贵时间和支持。再见，下次再见。</p><div class="lw lx ez fb ly lz"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hi fi z dy me ea eb mf ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">medium.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn ij lz"/></div></div></a></div></div></div>    
</body>
</html>