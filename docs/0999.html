<html>
<head>
<title>Getting started with YOLOv5 in a few minutes!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">几分钟后开始使用YOLOv5！</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/getting-started-with-yolov5-in-a-few-minutes-80ea2ff25c3c?source=collection_archive---------1-----------------------#2021-09-12">https://medium.com/mlearning-ai/getting-started-with-yolov5-in-a-few-minutes-80ea2ff25c3c?source=collection_archive---------1-----------------------#2021-09-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="b3f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你好，今天我将向你展示如何开始使用写作时最好的物体检测算法之一，即YOLO。</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><p id="93c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我们将使用由<a class="ae jj" href="https://github.com/ultralytics/yolov5" rel="noopener ugc nofollow" target="_blank"> Ultralytics </a>实现的YOLOv5。Ultralytics实现得非常好，非常流畅，这让我们非常容易使用和开始对象检测。这个网络是用PyTorch实现的，但是使用这个实现并不需要成为PyTorch专家。如果你对PyTorch不是很熟悉，这就更好了。</p><h2 id="07d8" class="jk jl hh bd jm jn jo jp jq jr js jt ju ip jv jw jx it jy jz ka ix kb kc kd ke bi translated">准备存储库</h2><p id="cfb4" class="pw-post-body-paragraph ie if hh ig b ih kf ij ik il kg in io ip kh ir is it ki iv iw ix kj iz ja jb ha bi translated">首先，我们必须将GitHub中的存储库克隆到一个项目中。我个人喜欢在虚拟环境中做，但是做你想做的。</p><p id="2ced" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建项目(虚拟或非虚拟)后，打开终端并运行以下命令:</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="64ef" class="jk jl hh kp b fi kt ku l kv kw">git clone https://github.com/ultralytics/yolov5</span></pre><p id="03f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当存储库被克隆时，安装需求。</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="4db4" class="jk jl hh kp b fi kt ku l kv kw">cd yolov5<br/>pip install -r requirements.txt</span></pre><p id="e522" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在存储库被克隆，需求被安装，我们准备好进行训练和推理。但是在我们继续之前，我们需要决定网络的规模。</p><h2 id="e177" class="jk jl hh bd jm jn jo jp jq jr js jt ju ip jv jw jx it jy jz ka ix kb kc kd ke bi translated">模型尺寸</h2><p id="cc3b" class="pw-post-body-paragraph ie if hh ig b ih kf ij ik il kg in io ip kh ir is it ki iv iw ix kj iz ja jb ha bi translated">YOLOv5有4种尺寸(s、m、l和xl)。直观上，网络越大，可调参数越多，性能越好。但是，更多的参数意味着更长的训练时间和推理时间。如果您正在构建一个用于实时检测的系统，您肯定会选择小型或中型的模型。以下是四种型号的概述:</p><figure class="kk kl km kn fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kx"><img src="../Images/2bc52c62f6900ffc695b8991bd285936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wehFRRy2_6ERFsPhcnt6Jw.jpeg"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx">source: <a class="ae jj" href="https://github.com/ultralytics/yolov5/wiki/Tips-for-Best-Training-Results" rel="noopener ugc nofollow" target="_blank">https://github.com/ultralytics/yolov5/wiki/Tips-for-Best-Training-Results</a></figcaption></figure><p id="3004" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">增加模型大小需要更多的CUDA内存，从而减少批量大小以使批量适合内存。不建议使用小批量，因为小批量提供的批量标准化统计数据较差。这激励了中小型模型，而不是大型模型。</p><h1 id="5d87" class="lj jl hh bd jm lk ll lm jq ln lo lp ju lq lr ls jx lt lu lv ka lw lx ly kd lz bi translated">测试预先训练的模型</h1><p id="c5fb" class="pw-post-body-paragraph ie if hh ig b ih kf ij ik il kg in io ip kh ir is it ki iv iw ix kj iz ja jb ha bi translated">为了确保我们已经正确安装了所有东西，我们将测试一个在COCO上预先训练的模型。使用<a class="ae jj" href="https://pytorch.org/hub/" rel="noopener ugc nofollow" target="_blank">火炬中枢</a>初始化网络和加载预训练的重量非常方便。</p><p id="e404" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要加载网络并对测试映像进行推断，请运行以下脚本:</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="a581" class="jk jl hh kp b fi kt ku l kv kw">import torch<br/><br/># Initialize the (small) network from ultralytics<br/>model = torch.hub.load('ultralytics/yolov5', 'yolov5s')</span><span id="2963" class="jk jl hh kp b fi ma ku l kv kw"># Load test image, could be any image<br/>img = 'https://ultralytics.com/images/zidane.jpg'</span><span id="7bdc" class="jk jl hh kp b fi ma ku l kv kw"># Do inference<br/>results = model(img)</span><span id="b1e0" class="jk jl hh kp b fi ma ku l kv kw"># Show results<br/>results.show()</span></pre><p id="89bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">应该会出现下面的图像，否则，一定是出错了(如果您有任何问题，请告诉我，我会尽力帮助您)。</p><figure class="kk kl km kn fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mb"><img src="../Images/4cfb1eecd9d9cdcdaa4c77d6af398384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l9Y_vhnVO36riCz57vNMYg.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx"><a class="ae jj" href="https://github.com/ultralytics/yolov5" rel="noopener ugc nofollow" target="_blank">https://github.com/ultralytics/yolov5</a></figcaption></figure><p id="452c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">很简单，对吧？现在我们已经初始化了一个强大的网络，并在COCO上预先训练了参数。如果您对人物检测感兴趣，这可能就足够了。但是在大多数情况下，您对在自己的自定义数据集上进行训练感兴趣。在接下来的几节中，我将介绍在您的自定义数据集上训练YOLOv5的步骤。</p><h2 id="61ce" class="jk jl hh bd jm jn jo jp jq jr js jt ju ip jv jw jx it jy jz ka ix kb kc kd ke bi translated">准备数据集</h2><p id="d78e" class="pw-post-body-paragraph ie if hh ig b ih kf ij ik il kg in io ip kh ir is it ki iv iw ix kj iz ja jb ha bi translated">YOLOv5遵循注释的标准darknet格式，所以如果您熟悉这种格式，可以跳过这一节。然而，如果没有，让我们看看如何为框架提供注释文件。</p><p id="2b0f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">darknet(YOLO的原始框架)使用规范化的注释文件，其中注释是相对于图像大小给出的。<br/>这意味着所有注释都在[0，1]的范围内，其中1表示图像大小的100%。</p><p id="3479" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于每个图像，我们需要一个对应的。txt文件，其中包含各个图像的注释。例如，如果您有一个名为0001.txt的图像，您应该有一个名为0001.txt的文件，其中包含带注释的边界框。名称必须相同，否则图像将被跳过，不会包含在训练过程中。</p><p id="2e86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每个注释文件的结构如下，用空格分隔。</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="c4d5" class="jk jl hh kp b fi kt ku l kv kw">&lt;class label&gt; &lt;center x&gt; &lt;center y&gt; &lt;width&gt; &lt;height&gt;</span></pre><p id="b3b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，与更快的RCNN类标签不同，RCNN类标签是零索引的，所以从0开始到数据集中的类数。YOLO不需要背景课。如上所述，YOLO需要规范化注释。这些转换可通过以下公式获得:</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="8411" class="jk jl hh kp b fi kt ku l kv kw">&lt;center x&gt; = (x1 + w/2) / image_w<br/>&lt;center x&gt; = (y1 + h/2) / image_h<br/>&lt;width&gt;    = w / image_w<br/>&lt;height&gt;   = h / image_h</span></pre><p id="d511" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中x1和y1是边界框的左上角，w和h是边界框的宽度和高度，image_w和image_h是图像大小。&lt;&gt;中的变量是注释的规范化版本。请看下图以获取灵感:</p><figure class="kk kl km kn fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mc"><img src="../Images/089970aa4342758c9e9ef28357e30958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0pW4Jv2pJ8FDQZulaRVHqQ.jpeg"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx">source: <a class="ae jj" href="https://github.com/ultralytics/yolov5/wiki/Train-Custom-Data" rel="noopener ugc nofollow" target="_blank">https://github.com/ultralytics/yolov5/wiki/Train-Custom-Data</a></figcaption></figure><p id="b7ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">文件夹结构应按以下顺序排列:</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="fb91" class="jk jl hh kp b fi kt ku l kv kw">./Dataset<br/>../Train<br/>.../images<br/>..../img01.jpg<br/>..../img02.jpg<br/>.../labels<br/>..../img01.txt<br/>..../img02.txt</span></pre><p id="9e9f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">保持这种结构很重要，因为框架的实现是为了用“标签”和文件的扩展名替换“图像”文件夹，以找到相应的注释。</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="39c7" class="jk jl hh kp b fi kt ku l kv kw">dataset/train/images/img01.jpg<br/>dataset/train/labels/img01.txt</span></pre><p id="6f11" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后需要做的是用数据集信息创建一个YAML文件。文件名为dataset_name.yaml，例如cars.yaml:</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="2e8b" class="jk jl hh kp b fi kt ku l kv kw">train: ../cars/train/images<br/>val: ../cars/val/images<br/>test:    # optional, if any test images.</span><span id="dd50" class="jk jl hh kp b fi ma ku l kv kw">nc: 1    # number of classes<br/>names: [ 'car' ] # List of class names</span></pre><p id="00de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在您得到了所需的东西，一个以正确方式注释的数据集和一个描述路径和名称的YAML文件。包含数据集文件的文件夹应该位于yolov5文件夹旁边。换句话说，在项目文件夹中，而不是在克隆的文件夹中。YAML文件应该在yolov5/data文件夹中。现在我们准备开始训练。</p><h2 id="bc86" class="jk jl hh bd jm jn jo jp jq jr js jt ju ip jv jw jx it jy jz ka ix kb kc kd ke bi translated">在自定义数据集上训练</h2><p id="5110" class="pw-post-body-paragraph ie if hh ig b ih kf ij ik il kg in io ip kh ir is it ki iv iw ix kj iz ja jb ha bi translated">当一切设置正确时，开始训练程序应该是相当容易的。从终端，您只需运行以下命令:</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="240c" class="jk jl hh kp b fi kt ku l kv kw">python train.py --img 640 --batch 16 --epochs 3 --data cars.yaml <br/>                --weights yolov5s.pt</span></pre><p id="f4a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，这些参数指定了培训。第一个参数是所需的图像大小，640 px是常用的形状，但是您可以选择其他大小。下一个参数指定批处理大小，并且应该总是尽可能大。第三个参数指定历元的数量(在整个数据集上迭代的次数),而数据参数指定在训练期间应该使用的数据集。最后一个参数指定预先训练的权重，并确定使用哪个模型。</p><h2 id="120f" class="jk jl hh bd jm jn jo jp jq jr js jt ju ip jv jw jx it jy jz ka ix kb kc kd ke bi translated">培训时的最佳实践！</h2><p id="15d7" class="pw-post-body-paragraph ie if hh ig b ih kf ij ik il kg in io ip kh ir is it ki iv iw ix kj iz ja jb ha bi translated">训练对象检测时，您应该仔细关注数据集的各个方面。</p><p id="e76d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Ultralytics建议您首先使用默认设置进行训练，因为这通常足以获得良好的结果，并为进一步的优化提供一个基线。之后，您可以尝试检查您的数据集和超参数。</p><p id="7233" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您得到大量的误报检测(检测到没有对象存在的边界框)，您可以包括一些背景图像。背景图像仅仅是没有对象和注释的图像。此外，你应该留意你的班级的平衡。不平衡数据集通常会抑制少数类，因为它们对损失函数的贡献不如多数类大。一条经验法则是，每门课至少要有1500张图片。注释应该尽可能精确地适合对象，并且训练图像应该反映应用程序打算实现的环境。如果数据集包含许多小对象，选择较大的图像尺寸来容纳小对象可能是有益的。</p><p id="749c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">任何进一步的信息可以在这里找到:</p><ul class=""><li id="920e" class="md me hh ig b ih ii il im ip mf it mg ix mh jb mi mj mk ml bi translated"><a class="ae jj" href="https://github.com/ultralytics/yolov5/wiki/Tips-for-Best-Training-Results" rel="noopener ugc nofollow" target="_blank">https://github . com/ultralytics/yolov 5/wiki/Tips-for-Best-Training-Results</a></li><li id="4b45" class="md me hh ig b ih mm il mn ip mo it mp ix mq jb mi mj mk ml bi translated">http://karpathy.github.io/2019/04/25/recipe/<a class="ae jj" href="http://karpathy.github.io/2019/04/25/recipe/" rel="noopener ugc nofollow" target="_blank"/></li></ul><p id="af61" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就对了。关于如何使用YOLOv5进行对象检测以及如何在您自己的自定义数据集上进行训练的分步指南。YOLO的好处是速度，它比许多其他对象检测网络的训练略快，例如更快的RCNN。</p><p id="4844" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望这篇文章对你如何开始使用YOLOv5有所帮助，其目的不是提供架构和底层机制的基本理解，而是如何开始使用它的高级概述。</p><p id="440a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如有任何意见或建议，请随时与我联系。</p><p id="2cba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">感谢您的阅读…</p><h2 id="44b1" class="jk jl hh bd jm jn jo jp jq jr js jt ju ip jv jw jx it jy jz ka ix kb kc kd ke bi translated">来源:</h2><ul class=""><li id="1765" class="md me hh ig b ih kf il kg ip mr it ms ix mt jb mi mj mk ml bi translated">【https://github.com/ultralytics/yolov5 T4】</li><li id="e306" class="md me hh ig b ih mm il mn ip mo it mp ix mq jb mi mj mk ml bi translated"><a class="ae jj" href="http://karpathy.github.io/2019/04/25/recipe/" rel="noopener ugc nofollow" target="_blank">http://karpathy.github.io/2019/04/25/recipe/</a></li></ul></div></div>    
</body>
</html>