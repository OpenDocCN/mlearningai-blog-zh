<html>
<head>
<title>Machine Learning on Google Cloud using Big Query ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用大查询ML在Google Cloud上进行机器学习</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/machine-learning-on-google-cloud-using-big-query-ml-a23d41c3b94?source=collection_archive---------2-----------------------#2021-05-21">https://medium.com/mlearning-ai/machine-learning-on-google-cloud-using-big-query-ml-a23d41c3b94?source=collection_archive---------2-----------------------#2021-05-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="d3c2" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">使用大查询ML在MNIST数据集上训练和评估分类模型</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/1fd9cf23682045175f32907e60c541fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RS6gbqPKA7w8gcDz"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@robynnexy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Robynne Hu</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4a0c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">谷歌、亚马逊和微软等顶级云计算平台已经进行了大量投资，并在人工智能和机器学习的民主化上下了大赌注。最重要的是，越来越多的公司采用机器学习来提高盈利能力，并通过改善业务流程来更好地服务于客户。</p><p id="0626" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">公司发现使用云平台提供的ML选项更容易实验和测量他们的机器学习能力，因为这些工具主要是为了让每个人都可以使用人工智能和ML技术而开发的。因此，公司不需要等到拥有高级人工智能技能的成熟数据科学家团队建立起来。相反，他们可以利用现有资源开始实验和ML建模。</p></div><div class="ab cl kj kk go kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ha hb hc hd he"><h2 id="43ea" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">这个系列涵盖了哪些内容？</h2><p id="b15d" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">在这一系列的三个故事中，我将向您介绍在GCP上执行机器学习的三种不同方式。我们将使用GCP提供的以下ML选项在MNIST数据集上训练和评估分类模型。然后，我们将使用我们训练的模型来正确预测MNIST测试数据集上的手写数字。</p><p id="ace0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">本系列探讨的ML选项:</strong></p><ul class=""><li id="e704" class="lq lr hh jp b jq jr jt ju jw ls ka lt ke lu ki lv lw lx ly bi translated">大查询ML(在这个故事中涉及)</li><li id="6291" class="lq lr hh jp b jq lz jt ma jw mb ka mc ke md ki lv lw lx ly bi translated"><a class="ae jm" href="https://hshirodkar.medium.com/machine-learning-on-google-cloud-using-automl-vision-88e16abf986e" rel="noopener">汽车视觉(第二部)</a></li><li id="f7ec" class="lq lr hh jp b jq lz jt ma jw mb ka mc ke md ki lv lw lx ly bi translated"><a class="ae jm" href="https://hshirodkar.medium.com/machine-learning-on-google-cloud-using-the-ai-platform-custom-model-ab0cbc874388" rel="noopener">定制模型使用Keras(第三个故事)</a></li></ul></div><div class="ab cl kj kk go kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ha hb hc hd he"><h2 id="01b9" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">Google提供的免费试用积分:</h2><p id="7e5f" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">谷歌将向其新客户提供300美元的免费试用信贷，以全面探索和评估其谷歌云平台。这是获得谷歌人工智能产品实践经验的好方法。</p><h2 id="235d" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated"><strong class="ak">先决条件:</strong></h2><ul class=""><li id="889d" class="lq lr hh jp b jq ll jt lm jw me ka mf ke mg ki lv lw lx ly bi translated"><strong class="jp hi">机器学习的基本概念:<br/> </strong>本教程更侧重于理解如何利用GCP来执行机器学习，而不是学习ML概念。</li><li id="5ee6" class="lq lr hh jp b jq lz jt ma jw mb ka mc ke md ki lv lw lx ly bi translated"><strong class="jp hi"> Google Cloud帐户:<br/> </strong>如果您还没有帐户，请在<a class="ae jm" href="https://cloud.google.com" rel="noopener ugc nofollow" target="_blank"> Google Cloud </a>上注册一个新帐户。<br/>一旦您的帐户设置完毕，请使用GCP控制台的导航菜单并转到账单页面。账单概览页面应显示应用于您帐户的300美元试用信用(我在截图中看到了额外的信用，但您的帐户在首次注册时应显示300美元)。<strong class="jp hi">请确认您拥有必要的学分，然后再继续本教程的剩余部分，否则将会产生费用。</strong></li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mh"><img src="../Images/c307bd7c748e1608d61a847fcf36a474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D13d98QyFAtVWX0DDaPH2w.png"/></div></div></figure><p id="2fe2" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">“账单”下的概览页面应显示已应用于您帐户的点数。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mi"><img src="../Images/9eab34007ae8769e2a47f17d630ea3af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*9dhIkFF475W-nzdnqUuKdw.png"/></div></figure></div><div class="ab cl kj kk go kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ha hb hc hd he"><h2 id="23bc" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">什么是MNIST数据集及其在本系列中的用途？</h2><p id="83f1" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">MNIST是机器学习爱好者中非常受欢迎的数据集，当谈到学习真实世界数据的新建模技术时，没有数据预处理要求。数据一开始就结构良好，易于理解。我个人更喜欢使用MNIST数据集，这样我们可以专注于手头的任务，学习GCP提供的ML选项，而不是被数据集本身的复杂性分散注意力。</p><blockquote class="mj mk ml"><p id="598c" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">MNIST数据库(改进的国家标准和技术研究所数据库[1])是手写数字的大型数据库，通常用于训练各种图像处理系统。</p><p id="5790" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">数据文件mnist_train.csv和mnist_test.csv包含手绘数字的灰度图像，从0到9。</p><p id="12c0" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">每幅图像高28像素，宽28像素，总共784像素。每个像素都有一个与之关联的像素值，表示该像素的亮度或暗度，数字越大表示越暗。该像素值是0到255之间的整数，包括0和255。</p><p id="807d" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">训练数据集(mnist_train.csv)有785列。第一列称为“标签”，是用户绘制的数字。其余的列包含相关图像的像素值。</p><p id="f786" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">测试数据集(mnist_test.csv)与训练集相同，只是它不包含“标签”列。</p></blockquote><h2 id="9306" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated"><strong class="ak">大查询ML: </strong></h2><blockquote class="mj mk ml"><p id="3a65" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated"><strong class="jp hi">什么是BigQuery？</strong>这是一个企业数据仓库，利用谷歌基础设施的处理能力，在海量数据集上实现超快速的SQL查询。</p><p id="3726" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated"><strong class="jp hi">什么是BigQuery ML？</strong>它让你使用标准的SQL查询在BigQuery中创建和执行机器学习模型。主要目标是通过让SQL从业者使用现有的SQL工具和技能来构建模型，从而使机器学习民主化。<a class="ae jm" href="https://cloud.google.com/bigquery-ml/docs/introduction" rel="noopener ugc nofollow" target="_blank">大查询ML支持的当前模型可以在这里找到。</a></p></blockquote><h2 id="ee56" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated"><strong class="ak">步骤1:下载MNIST训练和测试数据集。</strong></h2><p id="f988" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">为了加快训练速度，我们将只使用原始MNIST数据集的一个子集。继续从本地机器上git存储库内的ML文件夹中下载MNIST训练(mnist_train.csv)和测试(mnist_test.csv)数据集。<a class="ae jm" href="https://github.com/crazycoder20/MLonGCP/tree/main/ML" rel="noopener ugc nofollow" target="_blank">这里是GitHub的链接。</a></p><h2 id="b13c" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated"><strong class="ak">步骤2:创建一个云存储桶并上传MNIST数据集。</strong></h2><p id="31aa" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">从项目仪表板中，<strong class="jp hi">复制项目ID </strong>。我们将使用这个项目ID来设置一个全球唯一的云存储桶，以上传MNIST数据集。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mq"><img src="../Images/f31df0c0ca0d9a05234ff433bdeec09a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GTxxnZHzAoTc-EmXFGzCxw.png"/></div></div></figure><p id="b6c9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">从导航菜单中，选择<strong class="jp hi">云存储，然后点击浏览器。</strong></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mr"><img src="../Images/512066fd829620409444fcf0f8757a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1qT3_9JygynK8iBlHVi-2g.png"/></div></div></figure><p id="8ed4" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">点击创建桶。</strong></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ms"><img src="../Images/8075eba72c5a030fccf0fa158514f8c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rFGPOWNGNSm3wH1Od3bRfQ.png"/></div></div></figure><p id="4f30" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">使用&lt;<strong class="jp hi">ProjectID</strong>&gt;<strong class="jp hi">-ml</strong>作为您的存储桶和离您最近的地区的名称。对存储类别、访问控制和高级设置使用默认值。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mt"><img src="../Images/ad364c1e47188afc1e1b3af7e398dca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qCi17QX4aW4i8uIrjf0-gA.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mu"><img src="../Images/5c943ab48a7f49b9e0a93be05a3aff5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZVJzMA-zsKJMeSytcqDLvA.png"/></div></div></figure><p id="2474" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">点击创建。</strong></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mu"><img src="../Images/57f98f0b4ffc40d93bcd52fc63b578ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*240Ynqeb5vPIEsINAKFBaA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Click on CREATE.</figcaption></figure><p id="d415" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">一旦创建了CS bucket，<strong class="jp hi">点击上传文件</strong>从您的本地机器中选择mnist_train.csv和mnist_test.csv。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mv"><img src="../Images/1bafa7984f66b5c22b2649f5259390e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3mdxUyTlrcBEZS7Owa-RAQ.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mw"><img src="../Images/fb71dfb5d831d5e187a554ca661bf556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vQtXeaYBFVlNDisHBvAbMA.png"/></div></div></figure><p id="a036" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">文件上传后，CS bucket应该如下所示:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mx"><img src="../Images/3f42d6023df04e80de8cc49b0a6acffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2z2g7F0muniH3zp96_tGrQ.png"/></div></div></figure><h2 id="2577" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated"><strong class="ak">第三步:将MNIST数据集从云存储上传到大查询。</strong></h2><p id="9150" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">从导航菜单中，向下滚动到<strong class="jp hi">选择大查询</strong>。您可以选择锁定产品，以便将来更快地查找。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es my"><img src="../Images/2efdbf092349915501c6761c53c815a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*iBJId7GkNscqg4NrEIPXkw.png"/></div></figure><p id="ffec" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">从左侧菜单中选择您的项目，然后点击<strong class="jp hi">创建数据集。</strong>数据集类似于大查询的数据库。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mz"><img src="../Images/6863e4cc2e30a7906108e6aabc16a1a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_0IF1uI4aT64nRHaob_jA.png"/></div></div></figure><p id="16a8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">给<strong class="jp hi"> mnist </strong>作为数据集ID，位置与您的云存储桶相同。将其他选项保留为默认选项，并点击<strong class="jp hi">创建数据集</strong>。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es na"><img src="../Images/85af1604a1af64ed07ec7c7b9833eebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y0HMYX0fPtUbV2XHsRFKAw.png"/></div></div></figure><p id="7080" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">一段时间后，在左侧菜单面板上，您应该看到在您的项目下创建的数据集mnist。</p><p id="15e3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在，我们有了数据集，是时候创建表来保存这些文件了。我们将创建两个单独的表，一个用于训练数据集，另一个用于测试数据集。</p><p id="90ff" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">点击创建表格</strong>从CS上传训练数据集。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nb"><img src="../Images/a8156759635dacf51f474215f3342748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQwXlFy549N_65hBt8bS5Q.png"/></div></div></figure><p id="4b28" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在下一个屏幕上，请选择以下选项，然后单击创建表格。</p><ul class=""><li id="35df" class="lq lr hh jp b jq jr jt ju jw ls ka lt ke lu ki lv lw lx ly bi translated"><strong class="jp hi"> Source </strong>:选择Source为“<strong class="jp hi"> Google Cloud Storage </strong>”，并为训练数据集提供GCS bucket的位置(使用browse选择文件)。文件格式为csv。</li><li id="0f93" class="lq lr hh jp b jq lz jt ma jw mb ka mc ke md ki lv lw lx ly bi translated"><strong class="jp hi">目的地</strong>:提供表名为<strong class="jp hi">车次</strong>。</li><li id="e07c" class="lq lr hh jp b jq lz jt ma jw mb ka mc ke md ki lv lw lx ly bi translated"><strong class="jp hi">模式</strong>:勾选自动检测框。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/462aab9c209ecd38fe13f062fb40a2dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KgC7Z3x7WeVYHUzYpPVIiw.png"/></div></div></figure><p id="cdaa" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">按照相同的步骤创建测试表。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nd"><img src="../Images/7c6ce27f07f43b45dc2b683db4bac8c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hG1t4swFl8cvcNFyrdzqEg.png"/></div></div></figure><p id="5f96" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">一旦数据集被加载，训练和测试表应该显示在mnist数据集下。</p><p id="46bf" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">选择列车表并<strong class="jp hi">点击预览</strong>。在这里花点时间熟悉一下数据。该表上的每一行都是来自训练数据集的实例，并带有相应的标签。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ne"><img src="../Images/dcd32244a0c754c4e4fe2402283429d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gA7aAFeJD3xmNL1O-VO8kg.png"/></div></div></figure><p id="ec42" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">您可以在查询编辑器中运行以下查询，该查询提供了每个标签的训练数据集中的样本数。只需将from子句中的<project-id>替换为仪表板中的项目号。</project-id></p><p id="dad8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">训练数据集总共有6000个样本。这些或多或少均匀分布在标签上。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nf ng l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nh"><img src="../Images/5778cd5aac522df118989040206e2835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j7Ry75HFnupZ37yOeJYE8A.png"/></div></div></figure><p id="34f9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们现在准备好运行我们的分类模型了！</p><h2 id="2738" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">第四步:使用逻辑回归训练模型。</h2><blockquote class="mj mk ml"><p id="b462" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">逻辑回归是一种监督学习分类算法，用于使用成本函数(如Sigmoid)预测目标变量的概率。</p></blockquote><p id="5da3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">通常，逻辑回归用于二元分类问题，其中只有两种可能的结果(例如:电子邮件是垃圾邮件还是不是垃圾邮件)。</p><p id="3930" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">但是，在这个故事中，我们将使用它来训练一个多类预测模型。共有10个类别，从0到9的每个数字一个类别。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nf ng l"/></div></figure><p id="2524" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">再次将上述查询粘贴到编辑器中，然后单击Run来训练模型。大约需要。5分钟让BigQuery ML训练你的模型。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ni"><img src="../Images/ec51d9de55e7399b5c319093ca37f509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6uABXY_YYv2r9J68bV3Skw.png"/></div></div></figure><p id="04fc" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">一旦模型被训练，它将作为“分类_模型”被添加到您的mnist数据集中。单击它查看模型详细信息。聚合指标在评估中提供。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nj"><img src="../Images/5e2b41959f49ba7ab29c563f56dea080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3Uwxf-1AXAP-wubDYyFTA.png"/></div></div></figure><p id="beda" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">基于ROC AUC评分，结果相当有希望。你的结果可能与我的不完全相同，但应该足够接近。</p><p id="a1c5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">向下滚动查看混淆矩阵。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nk"><img src="../Images/bd08155d71996a0f0e2150dba6d09b6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M3BfDpUxbpDpEEa7aLwZ0g.png"/></div></div></figure><p id="79cb" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">使用混淆矩阵，我们可以观察到该模型在某些标签上比其他标签表现得更好。它在1号和6号上表现很好。预测数字5肯定需要改进，我们可以通过添加更多数据或试验其他模型参数来实现，但这将是另一天的讨论主题。</p><blockquote class="mj mk ml"><p id="edec" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">ROC曲线代表受试者操作特征曲线，通常与二元分类器一起使用。ROC绘制了真阳性率对假阳性率的曲线。</p><p id="35b3" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">您可以通过测量两个分类器的ROC曲线的AUC(曲线下面积)来比较分类器。完美分类器的ROC AUC等于1，而纯随机分类器的ROC AUC等于0.5。</p><p id="b680" class="jn jo mm jp b jq jr ii js jt ju il jv mn jx jy jz mo kb kc kd mp kf kg kh ki ha bi translated">混淆矩阵用于<strong class="jp hi">评估分类器的性能。</strong>一个完美的分类器将只有TPs和TNs(对角线值)</p></blockquote><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nl"><img src="../Images/2b734c64ac0aa27c8e2e54969e5a983c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t8b2_OBZbgB7AoM-k4HX1g.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Confusion Matrix</figcaption></figure><h2 id="a07c" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated"><strong class="ak">第五步:是时候做一些预测了。</strong></h2><p id="2b6e" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">我们将使用新训练的模型对测试数据集进行预测。请注意，我们的模型在训练期间从未暴露给测试实例。</p><p id="89d6" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在编辑器中运行下面的查询。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nf ng l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nm"><img src="../Images/916a087a6bf69a2f33e0ed18301b3ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9xth7vSDrRJu6MwFBMhmQ.png"/></div></div></figure><p id="b216" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">查询完成后，<strong class="jp hi">点击结果</strong>查看预测。</p><p id="fc30" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在下面的屏幕截图中，测试数据集中的第一个实例被正确预测为0。如概率分数0.998所示，该模型对此预测具有非常高的置信度。如果你仔细观察，你会发现这个模型也给了我们预测其他标签的概率分数，在这个例子中这个分数相当低。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nn"><img src="../Images/6e0a500765a27de97a92b63424c41d46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bbB2N0n3oNB7ISXe0PMQxg.png"/></div></div></figure><h2 id="aecd" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">第六步:删除大查询数据集和云存储桶。</h2><p id="3773" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">完成评估后，请继续删除大型查询数据集和云存储空间，以避免任何成本。</p><p id="4a8e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在下面的屏幕上，选择mnist数据集，然后点击<strong class="jp hi">删除数据集</strong>。确认数据集已被删除。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es no"><img src="../Images/05a34e4f595644e89fbb7c22e97a6e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WfNsC9qCZ2EDe91PytqPcw.png"/></div></div></figure><p id="113a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">同样，进入云存储控制台，选中<projectid-ml>桶的复选框，然后<strong class="jp hi">点击删除</strong>。确认该存储桶不再存在。</projectid-ml></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es np"><img src="../Images/946054e04d1fffb89ee3c266a93d02ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ANVu-bc7Y-gZ0pawB0Y9rw.png"/></div></div></figure><h2 id="8703" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">结论:</h2><p id="ac1a" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">我们只是触及了表面，但是您可以随时使用Big Query提供的其他公共数据集进行实验。像Big Query ML这样的产品无疑让我们在大众化机器学习方面更进了一步，我完全同意！</p><p id="ff48" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">以下是本系列其他两个故事的链接:</p><ul class=""><li id="0c6b" class="lq lr hh jp b jq jr jt ju jw ls ka lt ke lu ki lv lw lx ly bi translated"><a class="ae jm" href="https://hshirodkar.medium.com/machine-learning-on-google-cloud-using-automl-vision-88e16abf986e" rel="noopener">使用AutoML视觉在谷歌云上进行机器学习</a></li><li id="f9e0" class="lq lr hh jp b jq lz jt ma jw mb ka mc ke md ki lv lw lx ly bi translated"><a class="ae jm" href="https://hshirodkar.medium.com/machine-learning-on-google-cloud-using-the-ai-platform-custom-model-ab0cbc874388" rel="noopener">使用人工智能平台在谷歌云上进行机器学习(定制模式)</a></li></ul><h2 id="2085" class="kq kr hh bd ks kt ku kv kw kx ky kz la jw lb lc ld ka le lf lg ke lh li lj lk bi translated">提醒一句:</h2><p id="1d82" class="pw-post-body-paragraph jn jo hh jp b jq ll ii js jt lm il jv jw ln jy jz ka lo kc kd ke lp kg kh ki ha bi translated">请小心使用谷歌云上的服务，不要超出300美元的试用预算。不要忘记关闭API，删除任何未使用的实例或在使用后清理云存储桶，以避免向您的帐户收取任何额外费用。</p></div></div>    
</body>
</html>