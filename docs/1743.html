<html>
<head>
<title>Univariate Time Series Forecasting using RNN(LSTM)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RNN(LSTM)的单变量时间序列预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/univariate-time-series-forecasting-using-rnn-lstm-32702bd5cf4?source=collection_archive---------0-----------------------#2022-01-25">https://medium.com/mlearning-ai/univariate-time-series-forecasting-using-rnn-lstm-32702bd5cf4?source=collection_archive---------0-----------------------#2022-01-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="f8fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我们将讨论使用LSTM方法的单变量时间序列预测，这种方法在预测少数时间序列问题时似乎更准确。我的帖子也将帮助大家理解问题和模型实现的基础。</p><p id="bdfd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从编码开始。</p><p id="2c95" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">导入python的基本模块对训练数据集进行分析。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/6da4538171ecee8fc0b16e58e2d700cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*cSgGrL7C7OJ4DyAHiUgXmA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">importing basic modules</figcaption></figure><p id="3029" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有两个数据集训练数据集和测试数据集。我们必须在训练数据集上拟合我们的LSTM模型，然后尝试在测试数据集上预测股票价值。让我们来看一下测试数据集样本，它有6列，我们将只使用一列“<strong class="ig hi"> Open </strong>”进行测试。下面的示例数据视图:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jo"><img src="../Images/0eb56e6ec531f80e788012d9c64ed243.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*xAWp2rqA2BPYzgohg2lsuQ.png"/></div></figure><p id="ae6c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们尝试使用python来分析训练数据集上的数据趋势。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jp"><img src="../Images/6599b4c54eab6174fc7b018e4cf9e1b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*dKTYuCbDbF_e9VM0fHCLTg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Trend : Price is going upward</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jq"><img src="../Images/df6ca8f8e93ae8400ff9a1dd5ee08f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gdBASst3V5BHiUNGrcECDQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">One column-Univariate Time Series</figcaption></figure><p id="3e29" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为该列的分布类型不是高斯分布类型。因此我使用了最小最大缩放器。虽然我觉得StandardScaler也可以很好地工作。请尝试一下，让我知道它是否比这个更好。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jv"><img src="../Images/db12504cd7225f0e200a173657bef43e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*foY3lSD0byB6XU3YzAgTcg.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Feature Ranges from 0–1</figcaption></figure><p id="3e33" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是关于时间序列预测的最重要的部分。我们必须回顾股票价格以前的值，它可能以不同的方式跳跃，可能是3，6，9，12，30，60，90任何值。让我用一个简单的列表例子来解释它。让我们考虑下面的时间序列列表:</p><p id="1ceb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a1=[10，20，30，40，50，60]</p><p id="d3e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的例子中，如果我们试图看到前3个值，并试图预测下一个值，那么我们的数据集如下所示。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jw"><img src="../Images/98f52f49c8b1d8af5ca440537bac9193.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*Zgj7iiYY7YzoaoCQwoZnzg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Seems quite easy right now</figcaption></figure><p id="3b2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以编程方式应用以下内容:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jx"><img src="../Images/6342374786bb17ed5273db9b5287e506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*yc2fFvxYc_578qWqGpwSxg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Hopping is 60</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jy"><img src="../Images/1831e12f07e8c6827099dba4061e1a56.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*LssEn7e50ST5sl6vNL-8pw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">total count reduced by 60(1258–60). Considering the last 3 months data as every month has 20 working days.</figcaption></figure><p id="0032" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面我们来看看RNN-LSTM模型:</p><p id="28c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从Keras导入必要的模块。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jz"><img src="../Images/33785c110e7c0febbc3f1c01e9e1ca7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*nZw9h39WR_X6q49DMue7qA.png"/></div></figure><p id="32b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我已经创建了两个LSTM层，每个层有50个单位，并将它们与密集层连接起来。我还添加了Dropout层，使模型不会过拟合。我已经放弃了20%的单位，以确保我的模型不会过度拟合。我还使用了ADAM optimizer，因为我可以使用RMSPROP或任何其他优化器。请尝试与其他优化，让我知道结果。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ka"><img src="../Images/98861d5dee0db23d9bfb1326f48cc4b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fpgnjTGY_3VIzeKEwTd7XQ.png"/></div></div></figure><p id="f744" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们在训练数据集上拟合模型，并让模型被训练并熟悉数据集。你可以看到，经过75个周期后，MSE误差没有进一步减小。希望我们的重量调整正确，模型训练完美。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kb"><img src="../Images/0eef4ff99ec1d8ece82992e8cc86ec46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZEwYocmB0BhIL0dDNjjovA.png"/></div></div></figure><p id="4e69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">现在该准备测试数据集并尝试预测相同的值了。</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kc"><img src="../Images/e501f56992ffa7b561b873c3a0bd191f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*fUgEiJg7mV-qVSmD7TTipA.png"/></div></figure><p id="3bff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请确保应用缩放转换并重塑测试数据集。这是因为我们在训练数据集上做了同样的事情。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kd"><img src="../Images/2ac3ad490c8b338c2d119206bc434dcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o08yyUNBwUtK-B50w31G4w.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ke"><img src="../Images/f4a841fc08a6dfe53dbafac12b00c1be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lt6Jem5yGpz9GdhHwjB_jw.png"/></div></div></figure><p id="2408" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望您理解我们为什么从训练数据集中提取最后60条记录，因为我们试图收集前几天的60个不同值，并试图预测下一个值。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kf"><img src="../Images/02ef7c8ad84d4f17fdd2569c9b2963ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTWhJAKOC_mLxS6uj-G6UA.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kg"><img src="../Images/6b967950a1759488c01e2100efaead66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*8hnVL6mXe66_UqY2qsArBQ.png"/></div></figure><p id="f3a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将两个值连接成一个数据帧。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kh"><img src="../Images/da3a5571a74f68fb57fa6ac33d9e818e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PZNMkGvugvyzYeg4Wk8Ylg.png"/></div></div></figure><p id="0b6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在图表上绘制预测值和实际值。当我研究它时，我发现结果相当不错。它能够识别实际图表中的下降和增长，并能够跟踪趋势。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ki"><img src="../Images/e714ade70ae28e1bb75a11519b90fa9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bwa9YNzTrO__TXrcaG_wGg.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Trend is captured in prediction</figcaption></figure><p id="0f70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我觉得现在你必须清楚如何使用LSTM进行单变量时间序列预测。如有任何疑问，请随时在下面评论。我将很快提出下一个帖子，我们将尝试使用LSTM模型进行多元预测。快乐深度学习。</p><div class="kj kk ez fb kl km"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kn ab dw"><div class="ko ab kp cl cj kq"><h2 class="bd hi fi z dy kr ea eb ks ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kt l"><h3 class="bd b fi z dy kr ea eb ks ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ku l"><p class="bd b fp z dy kr ea eb ks ed ef dx translated">medium.com</p></div></div><div class="kv l"><div class="kw l kx ky kz kv la ji km"/></div></div></a></div></div></div>    
</body>
</html>