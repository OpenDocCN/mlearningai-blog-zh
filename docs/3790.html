<html>
<head>
<title>Exploring &amp; Analyzing a Time Series</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索和分析时间序列</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/exploring-analyzing-a-time-series-d1e9a8e2081a?source=collection_archive---------1-----------------------#2022-10-22">https://medium.com/mlearning-ai/exploring-analyzing-a-time-series-d1e9a8e2081a?source=collection_archive---------1-----------------------#2022-10-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d34e74fcd110972fa67d19f2a9dff908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d3mc2jEOXJ5wpN6_"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@nate_dumlao?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nathan Dumlao</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d97d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以有序方式记录的并且在时间上相关的观测值构成时间序列。时间序列的一个非常普遍的应用是用它来预测未来会发生什么。例如<strong class="iw hi">销售预测、股票市场分析、库存预测等。</strong></p><p id="e3dd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">利用时间序列而不是预测的另一个感兴趣的领域是异常值检测。离群点检测是从时间序列数据挖掘过程中得出的有重点的推论。时间序列数据挖掘旨在从历史数据中提取所有有意义的知识，这些历史数据以等间隔的时间间隔表示为一系列变量的值。</p><p id="d6fe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我将展示我分析20世纪葡萄酒销售时间序列的方法。以下是采取的步骤:</p><ol class=""><li id="d424" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">探索性数据分析</li><li id="5d73" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">级数的分解</li><li id="a571" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">推理</li></ol><p id="a76f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="kg">注意:这个练习已经用python实现了。我在下面添加了代码片段。</em></p><p id="7db5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们看一下数据集的前几行及其图表:</p><pre class="kh ki kj kk fd kl km kn bn ko kp bi"><span id="9dd1" class="kq kr hh km b be ks kt l ku kv">sparkling_df = pd.read_csv("Sparkling.csv", parse_dates= True, index_col= 'YearMonth')  # Sparkling<br/>#index_col= 'YearMonth'<br/>display(sparkling_df.index)<br/>sparkling_df.head()</span></pre><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/80c6adb83dc48e4e2106d95e486a6ad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uPkSWWeOQm8hUjbR_0aY5g.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Sparkling Wine Data set</figcaption></figure><pre class="kh ki kj kk fd kl km kn bn ko kp bi"><span id="1ce5" class="kq kr hh km b be ks kt l ku kv">from pylab import rcParams<br/>rcParams['figure.figsize'] = 10,5<br/>sparkling_df.plot(grid = True)<br/>plt.show()</span></pre><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kx"><img src="../Images/4f748695291e684e2e85fe0d5fec6aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0qMFM9CK4JqqdXvjYiJyYQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Plot for the Dataset</figcaption></figure><p id="c270" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该图显示了1985年后的趋势略有增加，1991年后保持不变，然而，它显示了明显的季节性(一种逐年可重复的模式)，尽管不能称之为不变。我们将深入探讨趋势和季节性，但首先，让我们深入探讨数据集本身。</p><p id="9868" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">条形图:</p><pre class="kh ki kj kk fd kl km kn bn ko kp bi"><span id="d83c" class="kq kr hh km b be ks kt l ku kv">plt.figure(figsize=(20, 10))<br/>ax1= plt.subplot(2,1,1)<br/>sns.barplot(x = sparkling_df1['Year'], <br/>y = sparkling_df1['Sparkling'], hue= sparkling_df1['Month'], ax= ax1)<br/>ax2= plt.subplot(2,1,2)<br/>plt.show()</span></pre><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ky"><img src="../Images/c7430203d0a38d18f4cc8715e0d7b579.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0crKtYpu6gR26bX0caOEaw.png"/></div></div></figure><p id="e824" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">条形图的高层次视图向我们显示，葡萄酒销售额似乎在每年年底都会上升。</p><p id="c7fe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">箱线图:</p><pre class="kh ki kj kk fd kl km kn bn ko kp bi"><span id="258f" class="kq kr hh km b be ks kt l ku kv">ax = sparkling_df1.boxplot('Sparkling', by= 'Year')<br/>ax1 = sparkling_df1.boxplot('Sparkling', by= 'Month')<br/>plt.show()</span></pre><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kz"><img src="../Images/b8d6c1344aac124bc1ff69dd38fe0f4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k6TybYvSOv41iuDJ1s34XQ.png"/></div></div></figure><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/68f44f612f00d31581013af2db7da45a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H3jER7F6NvAtK35miBOPag.png"/></div></div></figure><p id="81f2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们没有看到每年都有很多异常值，这有助于我们更好地理解分解中的季节性。月度箱线图不能给我们提供太多我们已经不知道的信息。</p><p id="508d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们已经对数据进行了一些探索，让我们对时间序列进行分解。时间序列有三个组成部分:</p><p id="c483" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">I .趋势(Tx)—趋势是代表低频变化的时间序列的组成部分，高频和中频波动已被滤除。趋势用于捕捉长期变动，如果变量值在很长一段时间内保持法定值，则称该序列没有趋势</p><p id="7c5d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">二。季节性(Sx) —以固定频率在系列中重复循环</p><p id="8db2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">三。残差(Ix)——序列中既不构成趋势也不构成季节性的部分，基本上是噪声</p><p id="0ddb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据从数据集绘图中获得的最佳直觉，可以进行两种类型的分解:</p><ol class=""><li id="3c80" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated"><strong class="iw hi">加法</strong>分解顾名思义，时间序列是其分量之和的函数(TS = Tx + Sx + Ix)而</li><li id="5da2" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated"><strong class="iw hi">乘法</strong>分解，其分量乘积的函数(TS = Tx * Sx * Ix)</li></ol><p id="37e6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将探索我们系列的两个分解图:</p><pre class="kh ki kj kk fd kl km kn bn ko kp bi"><span id="521b" class="kq kr hh km b be ks kt l ku kv">#additive decompose<br/>decompose_sparkling_add = seasonal_decompose(sparkling_df, model='additive', period=10)<br/>ax = decompose_sparkling_add.plot()<br/>plt.show()</span></pre><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lb"><img src="../Images/310b76a1644c20fd64e519808712d8ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RdtvQPPwNY0e0RJIMLBM9Q.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Additive Decomposition</figcaption></figure><p id="7b54" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在相加分解中，我们看到一个不够平滑的趋势，然而，在1986年至1990年之后，这一趋势略有上升，随后又略有下降。一般来说，关于残差需要注意的一点是，残差必须具有随机性，这种随机性可以构成波动，最终有助于发现与通常模式不同的异常值。残差不应该捕获序列中的任何模式。这里确实显示了随机性。因为我们已经知道季节性的存在，我们现在唯一的动机是发现重复的块随着趋势的一个因素而变化&amp;残差或者只是一些噪声的增加(波动)。现在我们来看看乘法分解。</p><pre class="kh ki kj kk fd kl km kn bn ko kp bi"><span id="48b0" class="kq kr hh km b be ks kt l ku kv">#multiplicative decompose<br/>decompose_sparkling_mul = seasonal_decompose(sparkling_df, model='multiplicative', period=10)<br/>ax1 = decompose_sparkling_mul.plot()<br/>plt.show()</span></pre><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lc"><img src="../Images/d3696083503049a83d194db255232702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LwCUz3Xi23DxDHOq8g8dpg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Multiplicative Decomposition</figcaption></figure><p id="5c39" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">乘法分解看起来非常类似于加法，除了尺度变化。在这个阶段，我们看到季节性和残差取决于趋势波动。峰值和噪声随着趋势增加而放大，尽管看不出很大的差异。让我们来看看我们的时间序列的对数变换。</p><p id="015a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果序列是乘法的，它将被转换成具有恒定波峰和波谷的加法序列(平滑的季节性)</p><p id="e2a8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">乘法— TS = Tx * Sx * Ix</p><p id="1d37" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">加法—Log(TS)= Log(Tx)+Log(Sx)+Log(Ix)</p><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kx"><img src="../Images/4f748695291e684e2e85fe0d5fec6aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0qMFM9CK4JqqdXvjYiJyYQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Dataset Plot</figcaption></figure><pre class="kh ki kj kk fd kl km kn bn ko kp bi"><span id="1ba2" class="kq kr hh km b be ks kt l ku kv">from pylab import rcParams<br/>rcParams['figure.figsize'] = 10,5<br/>np.log(sparkling_df).plot(grid = True)<br/>plt.show()</span></pre><figure class="kh ki kj kk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ld"><img src="../Images/01bf2a6456f0cdf8f811e5c4f036044e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*ifA1QMtkQTNIXM_ai4KkMw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Logarithmic-Dataset plot</figcaption></figure><p id="47a6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于我们看不到明显的差异，可以说季节性与趋势无关，不规则性在本质上是相加的。</p><p id="e92c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据我们的最佳直觉，我们总结了以下几点:</p><ol class=""><li id="323f" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">波动可以用于异常值分析，因为它们是特殊的，不会随着趋势或季节性的%或倍数而变化</li><li id="7488" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">由于季节性是不变的，它可以被形象化&amp;促销策略可以在低谷期前后制定</li><li id="aa2e" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">在制定预测策略时，趋势和季节性可以分开处理</li></ol><p id="ae3c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是我对这个系列的分析，请让我知道你们是如何分析你们的系列的。谢谢！</p><div class="le lf ez fb lg lh"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="li ab dw"><div class="lj ab lk cl cj ll"><h2 class="bd hi fi z dy lm ea eb ln ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lo l"><h3 class="bd b fi z dy lm ea eb ln ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lp l"><p class="bd b fp z dy lm ea eb ln ed ef dx translated">medium.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv in lh"/></div></div></a></div></div></div>    
</body>
</html>