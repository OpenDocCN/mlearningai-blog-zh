<html>
<head>
<title>Invisible Man using Mask-RCNN â€” with source code â€” Fun Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">éšå½¢äººä½¿ç”¨é¢å…·-RCNN-å¸¦æºä»£ç -è¶£å‘³é¡¹ç›®</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/invisible-man-using-mask-rcnn-with-source-code-fun-project-956815e61a44?source=collection_archive---------5-----------------------#2021-12-10">https://medium.com/mlearning-ai/invisible-man-using-mask-rcnn-with-source-code-fun-project-956815e61a44?source=collection_archive---------5-----------------------#2021-12-10</a></blockquote><div><div class="es gk gl gm gn go"/><div class="gp gq gr gs gt"><div class=""/><p id="ed90" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">æ‰€ä»¥åœ¨ä»Šå¤©çš„åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨æ©æ¨¡R-CNNæ¥æ‰§è¡Œäººä½“åˆ†å‰²ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å…ˆè¿›çš„é¡¹ç›®ï¼Œè®¸å¤šäº‹æƒ…æ­£åœ¨å‘ç”Ÿå¼•æ“ç›–ä¸‹ã€‚æ‰€ä»¥æ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„åŸå› ã€‚</p><p id="7a69" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated"><strong class="hv gx">ç‚¹å‡»æ­¤å¤„é˜…è¯»å¸¦æºä»£ç çš„æ•´ç¯‡æ–‡ç« â€”</strong><a class="ae ir" href="https://machinelearningprojects.net/invisible-man-using-mask-rcnn/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/invisible-man-using-mask-rcnn/</a></p><figure class="it iu iv iw ek ix dy dz paragraph-image"><div class="dy dz is"><img src="../Images/b0f6282d7c529306a900f611a2745b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*_GTtihiTeUiv1woNfs5K-w.gif"/></div></figure><h1 id="52a2" class="ja jb gw bd jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx bi translated">è®©æˆ‘ä»¬å¼€å§‹å§â€¦</h1><h2 id="942a" class="jy jb gw bd jc jz ka kb jg kc kd ke jk ie kf kg jo ii kh ki js im kj kk jw kl bi translated">ä»£ç ä¸ºäººç±»åˆ†å‰²ä½¿ç”¨æ©æ¨¡-RCNNâ€¦</h2><pre class="it iu iv iw ek km kn ko kp aw kq bi"><span id="6bd6" class="jy jb gw kn b ev kr ks l kt ku">from imutils.video import FPS<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import cv2<br/>import os<br/><br/>webcam = 1<br/>expected_confidence = 0.3<br/>threshold = 0.1<br/>show_output = 1<br/>save_output = 1<br/>kernel = np.ones((5,5),np.uint8)<br/>writer = None<br/>fps = FPS().start()<br/><br/>weightsPath = "mask-rcnn-coco/frozen_inference_graph.pb"<br/>configPath = "mask-rcnn-coco/mask_rcnn_inception_v2_coco_2018_01_28.pbtxt"<br/><br/>print("[INFO] loading Mask R-CNN from disk...")<br/>net = cv2.dnn.readNetFromTensorflow(weightsPath, configPath)<br/><br/>if use_gpu:<br/>    # set CUDA as the preferable backend and target<br/>    print("[INFO] setting preferable backend and target to CUDA...")<br/>    net.setPreferableBackend(cv2.dnn.DNN_BACKEND_CUDA)<br/>    net.setPreferableTarget(cv2.dnn.DNN_TARGET_CUDA)<br/><br/>print("[INFO] accessing video stream...")<br/>cap = cv2.VideoCapture(0)<br/><br/>print("[INFO] background recording...")<br/>for _ in range(60):<br/>    _,bg = cap.read()<br/>print("[INFO] background recording done...")<br/><br/>fourcc = cv2.VideoWriter_fourcc(*"MJPG")<br/>writer = cv2.VideoWriter('output.avi', fourcc, 20,(bg.shape[1], bg.shape[0]), True)<br/><br/>while True:<br/>    grabbed, frame = cap.read()<br/>    cv2.imshow('org',frame)<br/>    if not grabbed:<br/>        break<br/><br/>    blob = cv2.dnn.blobFromImage(frame, swapRB=True, crop=False)<br/>    net.setInput(blob)<br/>    (boxes, masks) = net.forward(["detection_out_final","detection_masks"])<br/>    for i in range(0, boxes.shape[2]):<br/>        classID = int(boxes[0, 0, i, 1])<br/>        if classID!=0:continue<br/>        confidence = boxes[0, 0, i, 2]<br/><br/>        if confidence &gt; expected_confidence:<br/>            (H, W) = frame.shape[:2]<br/>            box = boxes[0, 0, i, 3:7] * np.array([W, H, W, H])<br/>            (startX, startY, endX, endY) = box.astype("int")<br/>            boxW = endX - startX<br/>            boxH = endY - startY<br/>            mask = masks[i, classID]<br/>            mask = cv2.resize(mask, (boxW, boxH),interpolation=cv2.INTER_CUBIC)<br/>            mask = (mask &gt; threshold)<br/>            bwmask = np.array(mask,dtype=np.uint8) * 255<br/>            bwmask = np.reshape(bwmask,mask.shape)<br/>            bwmask = cv2.dilate(bwmask,kernel,iterations=1)<br/><br/>            frame[startY:endY, startX:endX][np.where(bwmask==255)] = bg[startY:endY, startX:endX][np.where(bwmask==255)]<br/><br/>    if show_output:<br/>        cv2.imshow("Frame", frame)<br/><br/>        if cv2.waitKey(1) ==27:<br/>            break<br/><br/>    if save_output:<br/>        writer.write(frame)<br/><br/>    fps.update()<br/><br/>fps.stop()<br/>print("[INFO] elasped time: {:.2f}".format(fps.elapsed()))<br/>print("[INFO] approx. FPS: {:.2f}".format(fps.fps()))</span></pre><ul class=""><li id="add7" class="kv kw gw hv b hw hx ia ib ie kx ii ky im kz iq la lb lc ld bi translated">ç¬¬1â€“5è¡Œâ€”å¯¼å…¥Mask-RCNNæ‰€éœ€çš„åº“ã€‚</li><li id="f839" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬7â€“14è¡Œâ€”å£°æ˜ä¸€äº›å¸¸é‡ã€‚</li><li id="534e" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬16â€“20è¡Œâ€”åŠ è½½å±è”½RCNNç½‘ç»œã€‚</li></ul><figure class="it iu iv iw ek ix dy dz paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="dy dz lj"><img src="../Images/0796cd318a2f371477304706c26867aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*95ld2kTdy_rTAql6.png"/></div></div></figure><ul class=""><li id="2a8d" class="kv kw gw hv b hw hx ia ib ie kx ii ky im kz iq la lb lc ld bi translated">ç¬¬22â€“26è¡Œâ€”å¦‚æœæ‚¨æƒ³ä½¿ç”¨GPUï¼Œè¯·å°†åç«¯å’Œç›®æ ‡è®¾ç½®ä¸ºCUDAã€‚</li><li id="ce14" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬28â€“29è¡Œâ€”ä»å®æ—¶æµä¸­è¯»å–å¸§ã€‚</li><li id="acfa" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬31â€“34è¡Œâ€”è®°å½•èƒŒæ™¯ã€‚</li><li id="eb00" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬36â€“37è¡Œâ€”ä½¿ç”¨<a class="ae ir" href="https://docs.opencv.org/3.4/dd/d9e/classcv_1_1VideoWriter.html#ad59c61d8881ba2b2da22cff5487465b5" rel="noopener ugc nofollow" target="_blank"> cv2ã€‚VideoWriter() </a>ä»¥è§†é¢‘æ ¼å¼ä¿å­˜è¾“å‡ºã€‚</li><li id="baaf" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬39â€“43è¡Œâ€”å¯åŠ¨whileå¾ªç¯ï¼Œå¹¶å¼€å§‹ä»ç½‘ç»œæ‘„åƒå¤´æŠ“å–å¸§ã€‚å¦‚æœç½‘ç»œæ‘„åƒå¤´æ²¡æœ‰åé¦ˆä»»ä½•ä¿¡æ¯ï¼Œè¯·ä¸­æ–­ã€‚</li><li id="077d" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬45â€“47è¡Œâ€”â€”ä½¿ç”¨<a class="ae ir" href="https://docs.opencv.org/4.5.2/d6/d0f/group__dnn.html#ga29f34df9376379a603acd8df581ac8d7" rel="noopener ugc nofollow" target="_blank"> cv2.dnn.blobFromImage() </a>ä»å›¾åƒä¸­åˆ›å»ºä¸€ä¸ªæ–‘ç‚¹ï¼Œç„¶åè¯¥æ–‘ç‚¹è¢«è®¾ç½®ä¸ºç½‘ç»œçš„è¾“å…¥ï¼Œå®ƒæµç»ç½‘ç»œï¼Œæˆ‘ä»¬å¾—åˆ°ä½œä¸ºè¾¹ç•Œæ¡†å’Œé®ç½©çš„è¾“å‡ºã€‚</li><li id="698d" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬48â€“66è¡Œâ€”éå†æ‰€æœ‰è¾“å‡ºï¼Œå¹¶å¯¹æ©è†œè¿›è¡Œä¸€äº›é¢„å¤„ç†ä»¥è¿›ä¸€æ­¥å¢å¼ºå®ƒã€‚ç°åœ¨ï¼Œåœ¨è¿™ä¸ªè’™ç‰ˆä¸­ï¼Œæ— è®ºå“ªé‡Œçš„åƒç´ æ˜¯ç™½è‰²çš„ï¼Œéƒ½ç”¨èƒŒæ™¯åƒç´ æ›¿æ¢åŸå§‹å›¾åƒä¸­çš„åƒç´ (ç¬¬66è¡Œ)ã€‚</li><li id="cc8b" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬68â€“72è¡Œâ€”æ˜¾ç¤ºå½“æœ‰äººæŒ‰ESCé”®æ—¶çš„è¾“å‡ºå’Œä¸­æ–­ã€‚</li><li id="60a6" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬74â€“75è¡Œâ€”ä»¥è§†é¢‘å½¢å¼ä¿å­˜è¾“å‡ºã€‚</li><li id="c06b" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬77è¡Œâ€”æ›´æ–°fpsã€‚</li><li id="602a" class="kv kw gw hv b hw le ia lf ie lg ii lh im li iq la lb lc ld bi translated">ç¬¬79â€“81è¡Œâ€”æ‰“å°fpsã€‚</li></ul><h2 id="134e" class="jy jb gw bd jc jz ka kb jg kc kd ke jk ie kf kg jo ii kh ki js im kj kk jw kl bi translated">æœ€ç»ˆç»“æœâ€¦</h2><figure class="it iu iv iw ek ix dy dz paragraph-image"><div class="dy dz is"><img src="../Images/b0f6282d7c529306a900f611a2745b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*_GTtihiTeUiv1woNfs5K-w.gif"/></div></figure><p id="cbcb" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated"><em class="lo"> PS â€”æˆ‘çŸ¥é“ç»“æœå¹¶ä¸å®Œç¾ï¼Œä½†è¿™äº›ç»“æœä¹Ÿæ˜¯ä¸å¯æ€è®®çš„ã€‚</em></p><p id="042f" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated"><strong class="hv gx"> <em class="lo">æ³¨æ„â€”â€”å¦‚æœæ‚¨çš„ç³»ç»Ÿä¸­æ²¡æœ‰GPUï¼Œè¯·ä¸è¦å°è¯•è¿è¡Œå®ƒï¼Œå› ä¸ºå®ƒå°†æ°¸è¿œè¿è¡Œï¼Œå› ä¸ºä½¿ç”¨äº†Mask-RCNNã€‚å³ä½¿åœ¨GPUä¸Šï¼Œå®ƒä¹Ÿå¾ˆéš¾è¾¾åˆ°5-8 fpsã€‚</em>T13ã€‘</strong></p><p id="2666" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated">å¦‚æœå¯¹ä½¿ç”¨Mask-RCNNè¿›è¡Œäººä½“åˆ†å‰²æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·é€šè¿‡ç”µå­é‚®ä»¶æˆ–LinkedInè”ç³»æˆ‘ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ä¸‹é¢è¯„è®ºä»»ä½•é—®é¢˜ã€‚</p><p id="1693" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated"><strong class="hv gx"> <em class="lo">æ¢ç´¢æ›´å¤šæœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€è®¡ç®—æœºè§†è§‰ã€NLPã€Flaské¡¹ç›®è®¿é—®æˆ‘çš„åšå®¢â€” </em> </strong> <a class="ae ir" href="https://machinelearningprojects.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="hv gx"> <em class="lo">æœºå™¨å­¦ä¹ é¡¹ç›®</em> </strong> </a></p><p id="af54" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated"><strong class="hv gx">å¦‚éœ€è¿›ä¸€æ­¥çš„ä»£ç è§£é‡Šå’Œæºä»£ç ï¼Œè¯·è®¿é—®æ­¤å¤„</strong> â€”</p><div class="lp lq eg ei lr ls"><a href="https://machinelearningprojects.net/invisible-man-using-mask-rcnn/" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab fy"><div class="lu ab lv cl cj lw"><h2 class="bd gx ev z lx ly lz ma mb mc md gv bi translated">éšå½¢äººä½¿ç”¨é¢å…·-RCNN -é™„æºä»£ç -è¶£å‘³å·¥ç¨‹- 2021 -æœºå™¨å­¦ä¹ é¡¹ç›®</h2><div class="me l"><h3 class="bd b ev z lx ly lz ma mb mc md ft translated">å› æ­¤ï¼Œåœ¨ä»Šå¤©çš„åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨æ©æ¨¡R-CNNæ¥æ‰§è¡Œäººä½“åˆ†å‰²ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸â€¦</h3></div><div class="mf l"><p class="bd b fc z lx ly lz ma mb mc md ft translated">machinelearningprojects.net</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml iy ls"/></div></div></a></div><p id="5e34" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated"><em class="lo">æ‰€ä»¥è¿™å°±æ˜¯è¿™ç¯‡åšå®¢çš„å…¨éƒ¨å†…å®¹ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œæˆ‘å¸Œæœ›ä½ åœ¨é˜…è¯»å®Œè¿™ç¯‡æ–‡ç« åï¼Œèƒ½æœ‰æ‰€æ”¶è·ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡ğŸ‘‹â€¦ </em></p><p id="2e4b" class="pw-post-body-paragraph ht hu gw hv b hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ip iq gp bi translated"><strong class="hv gx"> <em class="lo">çœ‹æˆ‘ä»¥å‰çš„å¸–å­:</em></strong><a class="ae ir" href="https://machinelearningprojects.net/sudoku-solver/" rel="noopener ugc nofollow" target="_blank"><strong class="hv gx"><em class="lo">NEUR</em></strong></a><a class="ae ir" href="https://machinelearningprojects.net/neural-style-transfer/" rel="noopener ugc nofollow" target="_blank"><strong class="hv gx"><em class="lo">ALé£æ ¼è½¬ç§»</em> </strong> </a></p><div class="lp lq eg ei lr ls"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lt ab fy"><div class="lu ab lv cl cj lw"><h2 class="bd gx ev z lx ly lz ma mb mc md gv bi translated">Mlearning.aiæäº¤å»ºè®®</h2><div class="me l"><h3 class="bd b ev z lx ly lz ma mb mc md ft translated">å¦‚ä½•æˆä¸ºMlearning.aiä¸Šçš„ä½œå®¶</h3></div><div class="mf l"><p class="bd b fc z lx ly lz ma mb mc md ft translated">medium.com</p></div></div><div class="mg l"><div class="mm l mi mj mk mg ml iy ls"/></div></div></a></div></div></div>    
</body>
</html>