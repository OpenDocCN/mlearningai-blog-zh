<html>
<head>
<title>CIFAR-10 Image Classification: Linear Model vs CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CIFAR-10图像分类:线性模型与CNN</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/cifar-10-image-classification-linear-model-vs-cnn-e1596ec2be26?source=collection_archive---------1-----------------------#2022-07-21">https://medium.com/mlearning-ai/cifar-10-image-classification-linear-model-vs-cnn-e1596ec2be26?source=collection_archive---------1-----------------------#2022-07-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4a20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于跨多个平台(如ResNet和MobileNet)的算法和架构的显著改进以及数据的可用性，计算机视觉应用在过去十年中一直在急剧增长。</p><p id="79de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我想分享我使用流行的CIFAR-10数据集在图像多类分类任务上实现卷积神经网络(CNN)的情况。目标是仅使用20个历元实现良好的宏观精度(至少80%)。还显示了与简单线性模型的比较，以帮助理解CNN在这种类型的机器学习中如何优越得多。</p><h2 id="cd87" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">一.导言和数据探索</h2><p id="7d68" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">首先，CIFAR-10包含60000幅32x32像素的RGB彩色图像和10个类别。每个类有6000个图像，其中5000个属于训练集，1000个属于测试集。</p><p id="1431" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们应该导入所有必需的库。数据集可以很容易地从Keras导入到我们的Jupyter笔记本中。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><p id="9487" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">类名按以下顺序排列:</p><p id="52e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kj kk kl km b">label_names = ['airplane', 'automobile', 'bird, 'cat', 'deer', 'dog', 'frog', 'horse', 'ship', 'truck']</code></p><p id="5a7b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以通过以下代码随机检查每张图片及其标签。这次返回的图像是一只狗(标签索引= 5)</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kn"><img src="../Images/193358a9f3baea27c6355538e5c0826a.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*b_YetOrW-108885aUN5FxA.png"/></div></figure><p id="7774" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以更进一步，看一看每一类中的10个随机图像，并将它们绘制在一个轴上。如图所示，在每一行上，显示了每一类的10个随机图像。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kq"><img src="../Images/d1ef630757eb3ce9588c59c4fb54edc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tFH7ptOESYu5doz_gt3PlQ.png"/></div></div></figure><h2 id="a0d9" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">二。数据预处理</h2><p id="ba12" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">预处理图像数据的常用方法是将RGB值归一化255。接下来是对响应变量(类标签)的一次性编码。</p><pre class="kc kd ke kf fd kv km kw kx aw ky bi"><span id="fe4f" class="jc jd hh km b fi kz la l lb lc">x_train = train_images/255<br/>x_test = test_images/255<br/>y_train_onehot = to_categorical(train_labels)<br/>y_test_onehot = to_categorical(test_labels)</span></pre><h2 id="0c28" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">三。线性模型</h2><p id="5667" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">首先，让我们尝试一个简单的具有20个时期的密集线性模型。这相当于没有指定任何非线性激活函数的密集网络。输出图层正在使用softmax执行多类分类任务。这里我使用任意数量的层(1000)来测试性能。我们可以使用Keras中的顺序API来实现这个架构。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><p id="fa7d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面的混淆矩阵说明了模型的性能。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ld"><img src="../Images/50aca7f350cfc81d86588c69316772c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*hZn249edwZjGkbeJ4ZbSqQ.png"/></div></figure><p id="c125" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，我们可以打印出分类报告来查看特定类别的性能，并输出每个时期的精度/损失进度。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es le"><img src="../Images/9c6e1beadb003714dbb8cfb0bc3f6e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*AtMN2bGBdMLPcMuCKSs6Eg.png"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lf"><img src="../Images/de4ccf6e7c71f27773784da5a4c1af14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5daZFQuLHyWPoi29qsWLRw.png"/></div></div></figure><p id="d94e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从报告和图中可以看出，准确性相当差。鸟类(类别=2)是预测最错误的，召回率非常低(高假阴性)，其次是猫(类别= 3)。它们都经常被错误地归类为其他动物，如狗(类别= 5)、鹿(类别= 4)、马(类别7)，导致其精确度非常低(高假阳性)。同样可以观察到许多马和鸟类被错误地归类为鹿。</p><p id="edfa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这可能是因为它们属于相似的颜色(RGB通道中接近的数字)，导致线性模型做出相似的分类。线性模型无法从边缘等其他低层特征和其他高层特征中学习，无法很好地进行分类。</p><h2 id="e71b" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">三。美国有线新闻网；卷积神经网络</h2><p id="9717" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">现在，让我们尝试一个CNN架构，看看它是否更适合这个任务。以下测试的架构受VGG-16(替代conv-最大池、3x3内核、步幅1x1“相同”填充)的启发，并通过使用以下来源的丢弃层进行了修改:</p><div class="lg lh ez fb li lj"><a href="https://www.analyticsvidhya.com/blog/2020/02/learn-image-classification-cnn-convolutional-neural-networks-3-datasets/" rel="noopener  ugc nofollow" target="_blank"><div class="lk ab dw"><div class="ll ab lm cl cj ln"><h2 class="bd hi fi z dy lo ea eb lp ed ef hg bi translated">CNN图像分类|使用CNN的图像分类</h2><div class="lq l"><h3 class="bd b fi z dy lo ea eb lp ed ef dx translated">卷积神经网络(CNN)——深度学习最近突破和发展背后的概念。CNNs</h3></div><div class="lr l"><p class="bd b fp z dy lo ea eb lp ed ef dx translated">www.analyticsvidhya.com</p></div></div><div class="ls l"><div class="lt l lu lv lw ls lx ko lj"/></div></div></a></div><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ly"><img src="../Images/41545354c06b130a0ba2a84c47bbe991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*g9VCiDJs-5MTGi6mL15KhA.png"/></div></figure><p id="e79b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在混淆矩阵的帮助下，我们清楚地看到了巨大的改进，因为大多数对角线值更接近1000，这意味着大多数预测的标签与实际标签非常一致。</p><p id="3d07" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">同样，让我们更深入地看看分类报告和准确性/损失图表。</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="kh ki l"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lz"><img src="../Images/b290b5c661a11c8aed06f1be5d2f4885.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*cIfFkqh7Iwnsf8rf8VUm6g.png"/></div></figure><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ma"><img src="../Images/2f74a80f410f74231f7aca880b04b27a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6-Era-1ZGf4R6qEFKB_pTA.png"/></div></div></figure><p id="3c3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们可以看到CNN模型在所有类别中都表现得很好，提高了召回率和精确度。猫-狗-鹿-鸟仍然是最混乱的类别，但是已经实现了重要的真实分类。此外，val-精度和val-损耗曲线显示，随着运行更多的时期，有显著的改善，并且如果运行更多的时期，显示出潜在的改善(还不是平稳期)。</p><h2 id="9711" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">四。结论</h2><p id="f4b4" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">总之，这个小项目让我更好地理解了CNN等现代机器学习技术如何彻底改变我们日常生活的数字世界。我希望收到反馈和评论，以改进我未来的项目。非常感谢您的阅读！</p><div class="lg lh ez fb li lj"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lk ab dw"><div class="ll ab lm cl cj ln"><h2 class="bd hi fi z dy lo ea eb lp ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lq l"><h3 class="bd b fi z dy lo ea eb lp ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lr l"><p class="bd b fp z dy lo ea eb lp ed ef dx translated">medium.com</p></div></div><div class="ls l"><div class="mb l lu lv lw ls lx ko lj"/></div></div></a></div></div></div>    
</body>
</html>