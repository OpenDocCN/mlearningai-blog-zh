<html>
<head>
<title>Time Series Forecasting While Considering Holidays with FBProphet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用FBProphet进行考虑假期的时间序列预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/time-series-forecasting-while-considering-holidays-with-fbprophet-cccde95572e1?source=collection_archive---------0-----------------------#2021-12-26">https://medium.com/mlearning-ai/time-series-forecasting-while-considering-holidays-with-fbprophet-cccde95572e1?source=collection_archive---------0-----------------------#2021-12-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/46491a5d91e7819f6a3d9635f36e43f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OfhJ0SP9WLCrCAuJ"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@linkhoang?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Link Hoang</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9afe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">FBProphet是一个经过验证的时间序列预测项目库。与其他时间序列预测库相比，它的一些优势包括:</p><ul class=""><li id="8549" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">可以适应季节性数据，无论是每年，每月，每周，甚至每天。</li><li id="52f4" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">能够很好地处理异常值和缺失数据。</li><li id="640b" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">易于添加特殊的日子，如假期和用户定义的日期，要考虑的学习过程。</li><li id="d351" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">能够应对趋势的极端变化。</li></ul><p id="9bc3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该库本身非常容易实现，不需要太多的努力来清理数据。</p><p id="70e8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这个故事中，我们将看到FBProphet在时间序列预测案例上的实现。该库将帮助我们预测某电商一整月的几个产品订单。</p><p id="feb9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于其特点，一个电子商务可以在 <strong class="iw hi">节日和特殊日期(如情人节)或重复编号的日期(如11-11(11月11日)</strong>)进行多次<strong class="iw hi">促销。这是创建时序预测模型时应该考虑的重要信息。</strong></p><h1 id="80a9" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">时序数据</h1><p id="73f6" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">让我们检查一下这个电子商务历史交易的综合数据。<strong class="iw hi">您可以在这里</strong> 访问csv和ipynb文件 <a class="ae it" href="https://github.com/evanbudianto/forecasting-with-fbprophet" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi">。</strong></a></p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/b919a805f1cd156c0aa1d1c05e749876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aEBAjjEokoEsNV1Xfuqugw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Number of order per product for 1 Jan 2020–29 Jeb 2020</figcaption></figure><p id="38e6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这里可以看出，重复编号日期的活动对订单数量的增加起到了重要作用。你可以看到01–01–20和02–02–20的峰值。这可能是大规模促销计划或其他营销活动的结果。</p><h1 id="38e5" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">预测</h1><p id="2a64" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">使用这些数据，我们将<strong class="iw hi">预测上个月(2021年2月)</strong>每种产品的订单。然后将预测的数字与当月的实际订单数据进行比较。</p><p id="db73" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了做到这一点，我们需要两个数据:</p><ul class=""><li id="9434" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">历史订单编号</li><li id="0f38" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">特殊日期参考(节假日、促销日等)。)</li></ul><p id="bcea" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先，我们需要导入所需的库和相关数据集。</p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="2f87" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在数据集上实现fbprophet模块之前，拥有正确的列名是至关重要的。</p><p id="ea4c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，拟合和预测过程非常简单，就像其他常规的机器学习库一样。我们将首先对一列进行预测。</p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="db04" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该模型可以接受季节性和节假日作为其参数。您可以调整此参数，以寻找模型的最佳拟合。</p><p id="73de" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">预测值可以直接从模型中绘制出来:</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/b4a9f22a03cf6f23db54c516af4b4084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vjlods0xEaMkJ_0ZJKTwOA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">The dots represent the actual data while the line represent fitting and predicting result</figcaption></figure><p id="5297" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您可以看到该模型预测了未来一个月(2021年2月)的订单。</p><p id="0c80" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该模型还可以显示数据中的相关信息，例如:</p><ul class=""><li id="d2cc" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">一般趋势</li><li id="0dcc" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">特殊日期对订单编号的影响</li><li id="b37d" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">每周/每年的季节性</li></ul><figure class="lk ll lm ln fd ii er es paragraph-image"><div class="er es lr"><img src="../Images/9524020a3bd4510a9dd67e62f01cfba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*Rbfp7p6VSVubVFuuUhc-zw.png"/></div></figure><h1 id="36e7" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">测量误差</h1><p id="166a" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">为了衡量预测结果和实际数据之间的误差，我们将使用MAPE和梅。</p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="2737" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您可能会发现实际值和预测值之间存在差距，尤其是在订单数量非常多的日期。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/be17704e642c93186b127a56834f68d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y9Gmq6qOIKpKfkQE2YAotA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Actual data (orange) vs predicted data (blue)</figcaption></figure><p id="3c46" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这个阶段，您可以通过进行超参数调整来尝试改进您的模型，以更好地拟合数据。然后，您可以将该过程应用于其他剩余的列。</p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="lo lp l"/></div></figure><h1 id="67eb" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">摘要</h1><p id="db46" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">FBProphet是一个非常强大但易于使用的时间序列预测库。从该算法中获得最佳结果的关键是首先理解您的数据，然后将其特征作为参数进行拟合，如季节性、节假日等。</p><div class="lt lu ez fb lv lw"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hi fi z dy mb ea eb mc ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">medium.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk in lw"/></div></div></a></div></div></div>    
</body>
</html>