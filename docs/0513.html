<html>
<head>
<title>A brief overview of R-CNN, Fast R-CNN and Faster R-CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R-CNN、快速R-CNN和更快R-CNN概述</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/a-brief-overview-of-r-cnn-fast-r-cnn-and-faster-r-cnn-9c6843c9ffc0?source=collection_archive---------0-----------------------#2021-05-06">https://medium.com/mlearning-ai/a-brief-overview-of-r-cnn-fast-r-cnn-and-faster-r-cnn-9c6843c9ffc0?source=collection_archive---------0-----------------------#2021-05-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="01a4" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">基于区域的CNN (R-CNN)</h2></div><p id="e357" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">R-CNN架构用于检测图像中对象的类别以及这些对象的包围盒。RCNN架构已经被开发，因为在包含一个以上对象的视觉中，不能用CNN对一个以上的对象进行分类。</p><p id="f985" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">R-CNN的一般工作原理分两步进行。首先，通过选择性搜索来确定视觉中可以找到对象的特征，然后在确定区域之后，将每个区域作为CNN模型的输入，并对类和边界框执行预测过程。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es js"><img src="../Images/b9a287caf6910ea295f4c23ad56a1366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*yJBiHhK8t_zTQKBqlZKlWQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">R-CNN Architecture</figcaption></figure><blockquote class="ke kf kg"><p id="e291" class="iw ix kh iy b iz ja ii jb jc jd il je ki jg jh ji kj jk jl jm kk jo jp jq jr ha bi translated">选择性搜索:</p><p id="502d" class="iw ix kh iy b iz ja ii jb jc jd il je ki jg jh ji kj jk jl jm kk jo jp jq jr ha bi translated">它用于确定图像上应该捕获的区域。首先确定小区域。然后，相似的区域被组合以创建更大的新区域。该过程重复进行，在该过程中的每一步都创建更大的区域，然而，视觉中的对象实际上是聚集的。</p></blockquote><p id="71a2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在R-CNN，我们使用选择性搜索来识别特定地区的候选人。每个候选区域作为不同CNN网络的输入。作为在区域岛上执行操作的结果，获得了大约2000个不同的区域，2000个CNN网络用于所获得的2000个区域。通过使用来自这些网络的特征，利用SVM来确定对象的类别，并且通过回归来确定对象的边界框。</p><p id="e35a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">并集上的交集(IoU)分数指的是预测边界框的准确性。将获得的包围盒与真实包围盒进行比较，通过该比较过程，获得IoU分数。</p><blockquote class="ke kf kg"><p id="0d54" class="iw ix kh iy b iz ja ii jb jc jd il je ki jg jh ji kj jk jl jm kk jo jp jq jr ha bi translated">→边界框的预测区域和实际边界框区域的交集/边界框的预测区域和边界框的实际区域的组合</p></blockquote><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kl"><img src="../Images/08e4a05d6d4ae9fe9e5b5a5f2dbe153c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*kjgStzvnHk6hYc8ul3P8kA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Intersection Over Union</figcaption></figure><blockquote class="ke kf kg"><p id="59b6" class="iw ix kh iy b iz ja ii jb jc jd il je ki jg jh ji kj jk jl jm kk jo jp jq jr ha bi translated">非最大抑制:</p><p id="7c2b" class="iw ix kh iy b iz ja ii jb jc jd il je ki jg jh ji kj jk jl jm kk jo jp jq jr ha bi translated">并非所有从图像中获得的区域都被使用。使用非最大值压缩技术来获得正确的区域。使用这种技术，获得的交集(IoU)分数大于0.5的边界框被保留，而其他边界框被抑制。如果为一个对象获得超过0.5个边界框，则使用具有最高IoU分数的边界框。</p></blockquote><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es km"><img src="../Images/8b318d572438e57660f5b94d910898e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMU4aKAJv354rACudbkkYA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Non-Max Suppression Technique</figcaption></figure><h2 id="5406" class="kr ks hh bd kt ku kv kw kx ky kz la lb jf lc ld le jj lf lg lh jn li lj lk ll bi translated">快速R-CNN</h2><p id="1529" class="pw-post-body-paragraph iw ix hh iy b iz lm ii jb jc ln il je jf lo jh ji jj lp jl jm jn lq jp jq jr ha bi translated">R-CNN模型的成本相当高，因为每幅图像要提取近2000个不同的候选区域，每个区域使用不同的CNN网络。这些工艺步骤导致巨大的成本和长时间的培训。</p><p id="0799" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于这个原因，在R-CNN架构中为每个区域创建的不同CNN模型被移除，并且快速R-CNN架构被开发为对区域使用单个CNN。与R-CNN不同，CNN、SVM和回归器的使用得到了发展。结合CNN、SVM和回归器创建的架构与开发的模型一起表现得非常好。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lr"><img src="../Images/e9818bc7d02240f1a2cab6a4f6b92ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*7haXXOJjZdibibU0c4eNgw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Fast R-CNN</figcaption></figure><p id="b824" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">用CNN对整幅图像进行处理，得到特征图。收集区域建议所需的特征(区域建议特征地图)。然后，对获得的特征图应用最大池，并降低特征图的维数。执行最大池化过程的图层称为RoI(感兴趣区域)池化图层。降维后的特征图被转换成一维向量，并作为CNN模型的输入。使用Softmax，确定区域中对象的类别信息，同时确定对象的包围盒回归量。<br/> <em class="kh">比R-CNN快10倍左右。</em></p><h2 id="85dc" class="kr ks hh bd kt ku kv kw kx ky kz la lb jf lc ld le jj lf lg lh jn li lj lk ll bi translated">更快的R-CNN</h2><p id="4e05" class="pw-post-body-paragraph iw ix hh iy b iz lm ii jb jc ln il je jf lo jh ji jj lp jl jm jn lq jp jq jr ha bi translated">因为在R-CNN和快速R-CNN中应用的选择性搜索在计算方面是昂贵的，所以在快速R-CNN中使用区域前向网络(RPN)。某些研究已经证明了RPN的使用效率。</p><p id="1774" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">任何大小的图像都可以作为输入。然后，该图像被作为CNN模型的输入。如果你用的模型是VGG16，AlexNet之类的模型，重建模型时不要在模型中使用全连通层。因为我们必须给出特征图作为RPN的输入，所以特征图也由卷积层产生。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es ls"><img src="../Images/4f5f34bba8be3a8bced3a1c3a088f3b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*xHbajCZBE0O0bn-RDmY8IA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Faster R-CNN</figcaption></figure><p id="7dfe" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">说到RPN我们需要知道的一个重要结构:锚盒。锚是不同比例和长宽比的盒子。当要创建的小网络在特征图上滑动时，根据锚在特征图中进行对象搜索。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lt"><img src="../Images/0289ae91915c7e820a5aed34369cfbf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cadNfgOu1Y6KH5vMy55tJw.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Anchor Boxes Example</figcaption></figure><p id="df97" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">RPN中的第一卷积层默认应用3x3的滤波器，输出通道的数量是512。该conv图层将要素地图作为输入。卷积层的输出作为两个不同卷积层的输入给出。两者的滤波器大小都是1x1。第一层是cls，即分类层。cls层通知我们在滑动窗口的位置是否有物体。这里应用了二元分类过程。在对象1的情况下，在没有对象0的情况下，在建模阶段，sigmoid激活函数通常与卷积层一起使用。该层的输出通道数表示为2 * 9，默认情况下k值为9(因此第一层的滤波器大小为3×3)，Cls层的输出通道数应为2 * k。Reg层与Cls层并行工作。Reg层负责绘制Cls中检测到的对象的边界框。因为它包含4个坐标信息，所以该层的输出通道数被表示为4 * 9 (4 * k)。对于模型编码中的Reg层，conv层优选线性激活函数。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lu"><img src="../Images/ace8183f979eb76ace5553106fcbba4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*G3SjzqU7HK9f9ulXRnRAsQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">RPN</figcaption></figure><p id="fbf8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">总之，作为过滤过程的结果，RPN的输出是标记为具有对象的锚盒。cls图层中值为0的边界框被放入背景中。</p><p id="2f9a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">RPN之后的RoI层接收RPN的cls和reg层的输出作为输入，以及RPN作为输入的特征地图。RoI层负责在全连接层之前使每个特征图的大小相同，这是更快的R-CNN的最后一层。由于来自RPN的区域推荐具有不同的大小(因为锚盒具有不同的比例和纵横比)，所以有必要产生具有固定大小的特征地图。RoI层使用大小为7x7的最大池层。输出层数为512。<br/>RoI后获得的值经过分类处理，在展平后作为输入提供给全连接层。在分类过程中，在回归器的帮助下创建被预测类别的对象的包围盒。</p><p id="419d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我希望我能够正确地传达R-CNN、快速R-CNN和更快R-CNN的基本知识。感谢您的阅读！</p></div><div class="ab cl lv lw go lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ha hb hc hd he"><p id="2732" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">资源:</p><p id="b44f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">1-<a class="ae mc" href="https://arxiv.org/abs/1506.01497" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1506.01497</a></p><p id="9e57" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2-<a class="ae mc" href="https://www.youtube.com/watch?v=iHf2xHQ2VYo" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=iHf2xHQ2VYo</a></p><p id="2032" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3-<a class="ae mc" href="https://towardsdatascience.com/r-cnn-fast-r-cnn-faster-r-cnn-yolo-object-detection-algorithms-36d53571365e" rel="noopener" target="_blank">https://towards data science . com/r-CNN-fast-r-CNN-faster-r-CNN-yolo-object-detection-algorithms-36d 53571365 e</a></p><p id="c938" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4-<a class="ae mc" href="https://www.hackerearth.com/blog/developers/object-detection-for-self-driving-cars/" rel="noopener ugc nofollow" target="_blank">https://www . hackere earth . com/blog/developers/object-detection-for-self-driving-cars/</a></p></div></div>    
</body>
</html>