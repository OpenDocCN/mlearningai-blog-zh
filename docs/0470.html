<html>
<head>
<title>Become a more efficient data analyst, a comprehensive guide to pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">成为更高效的数据分析师，熊猫综合指南</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/be-a-more-efficient-data-analyst-a-comprehensive-guide-to-pandas-63ea057bf828?source=collection_archive---------2-----------------------#2021-04-27">https://medium.com/mlearning-ai/be-a-more-efficient-data-analyst-a-comprehensive-guide-to-pandas-63ea057bf828?source=collection_archive---------2-----------------------#2021-04-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="93f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">熊猫简介</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/fb5215ea8f865a3122ea60dd41b5051b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OMi_C7cwoUKzQxmFV5UcZg.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@itookthose?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Sid Balachandran</a> on <a class="ae js" href="https://unsplash.com/s/photos/pandas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="48af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您有一个包含一些令人信服的见解的大型数据集，但您仍然很难找出如何提取这些见解或浏览数据的统计数据。在这种情况下，熊猫就派上了用场。</p><p id="296a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">熊猫能快速阅读和理解数据，并给你洞察力，这样你就能更有效地发挥你的作用。要开始学习pandas，我们需要熟悉pandas系列和Data Frame中的两种数据结构。虽然它们不是解决所有问题的通用解决方案，但是它们为大多数应用程序提供了一个坚实、易于使用的基础。</p><p id="9ab0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">系列</strong> —一维阵列状物体。</p><p id="86ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">数据框架</strong>—pandas中一种类似excel的表格数据结构。</p><p id="6ca7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从导入包开始:</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="80e2" class="jy jz hh ju b fi ka kb l kc kd">import pandas as pd</span></pre><p id="e036" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">进口熊猫最流行的惯例是用pd别名。</p><h1 id="27b1" class="ke jz hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">系列</strong></h1><p id="7329" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">通过传递一系列值，pandas将创建一个默认的整数索引</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="a83b" class="jy jz hh ju b fi ka kb l kc kd">data = pd.Series([1,2,3,4])</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lg"><img src="../Images/192c797c050e166e373a0d2be1762a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*5qThOIjqYFKMNkMRaW6Prg.png"/></div></figure><p id="4516" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">左边的是索引(0，1，2，3)，右边的是数值(1，2，3，4)。</p><h2 id="91a9" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">检查值和索引</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="c9ab" class="jy jz hh ju b fi ka kb l kc kd">data.values<br/>data.index</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lu"><img src="../Images/ed28d430392d5d16da1e374255b9f183.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*GC-n2z4uCnSBLrpbpL-Sbg.png"/></div></figure><h2 id="2975" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">将默认索引值0，1，2，3更改为新的自定义索引值</strong></h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="4d69" class="jy jz hh ju b fi ka kb l kc kd">data1 = pd.Series([1,2,3,4], index = [‘a’, ‘b’, ‘c’, ‘d’]</span><span id="53d8" class="jy jz hh ju b fi lv kb l kc kd">data1</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lw"><img src="../Images/c95399e2dbafc7d718d5e8d97faff0a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_tTamJfxhVcs50V4lJCesA.png"/></div></div></figure><h2 id="ea5d" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">数据选择</h2><p id="65fb" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">单值选择将选择对应于索引值<strong class="ig hi">‘a’</strong>的值。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="2c6a" class="jy jz hh ju b fi ka kb l kc kd">data1[‘a’]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lx"><img src="../Images/db8590bbe8048fa0bb3ab70a08954df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*OKmNrehyCGJlGvJLH3meFQ.png"/></div></figure><h2 id="b67f" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">数据选择-多值</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="8ea1" class="jy jz hh ju b fi ka kb l kc kd">data1[[‘a’,’b’]]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ly"><img src="../Images/2350f0f274aa996d8a1db897049fa17c.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*3gBJP7Z1VXFxMQRvrDzSJA.png"/></div></figure></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><h1 id="ffbe" class="ke jz hh bd kf kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la bi translated"><strong class="ak">数据帧</strong></h1><p id="6abb" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">Dataframe是一种类似表格的数据结构，就像excel一样。它包含一个有序的列集合，这些列可以是不同的值类型(数字、字符串、布尔值等)。).它既有行索引又有列索引。</p><h2 id="acb8" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">创建数据帧</h2><p id="5015" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">数据帧的索引将被指定为序列。</p><p id="a7d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面我们创建一个数据框，其中包含国家名称、年份和特定年份的人口(百万)。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="4ebe" class="jy jz hh ju b fi ka kb l kc kd">data = {‘Country’: [‘India’, ‘UK’, ‘USA’, ‘Japan’, ‘Ireland’],</span><span id="04f4" class="jy jz hh ju b fi lv kb l kc kd">‘year’: [2020, 2021, 2022, 2023, 2024],</span><span id="303b" class="jy jz hh ju b fi lv kb l kc kd">‘population’: [1.4, 1.2, 0.5, 0.4, 1.6]}</span><span id="d752" class="jy jz hh ju b fi lv kb l kc kd">df = pd.DataFrame(data)</span><span id="b1b3" class="jy jz hh ju b fi lv kb l kc kd">df</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ml"><img src="../Images/e29971a19d9e1ca6e0a7a1ccc7ebbccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQxsSyp0it56GyKfnYjZCA.png"/></div></div></figure><h2 id="c5d7" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">您可以指定列的顺序，输出将与您传递的完全相同。</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="ab83" class="jy jz hh ju b fi ka kb l kc kd">df1 = pd.DataFrame(data, columns = [‘population’,’year’,’Country’])</span><span id="916e" class="jy jz hh ju b fi lv kb l kc kd">df1</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mm"><img src="../Images/68e4b1bcc0085f91e7a78ad04e351c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FlWYnWIO_7xQx3wewGm0ow.png"/></div></div></figure><h2 id="f54c" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">访问数据帧中的列</strong></h2><p id="3c81" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">通过字典式符号:</strong></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="79e6" class="jy jz hh ju b fi ka kb l kc kd">df1[‘Year’]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mn"><img src="../Images/4358b3daac3c132c958dff55efb7c61b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_WQIjzu1PtfbtYgjf1c2qw.png"/></div></div></figure><p id="2148" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">通过点符号:</strong></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="f475" class="jy jz hh ju b fi ka kb l kc kd">df1.Country</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mo"><img src="../Images/0a58f3b64f3c85f080536f7e61303451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i8mDnTUuehxDMOdB25pk-w.png"/></div></div></figure></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><h2 id="983e" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">导入CSV文件</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="af13" class="jy jz hh ju b fi ka kb l kc kd">data = pd.read_csv(‘pokemon.csv’)</span></pre><p id="ccce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以看到数据的类型和'口袋妖怪'包含多少数据。</p><p id="6890" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mp"> len </em> </strong>只统计行数，如果你想查看行数和列数，我们可以用<strong class="ig hi">来做。形状</strong>。在我们的数据中，有800行和12列。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mq"><img src="../Images/9647e8e720cece9491af630cfdcdd968.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3-o6c5HjM_ML7JNZU9gs6g.png"/></div></div></figure><h2 id="b7df" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">显示所有列及其数据类型。info() </strong></h2><p id="3c86" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">这提供了索引范围的总数、数据集中的列数、列类型(计数)和数据类型。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mr"><img src="../Images/27b7b1e99625e7f19c35b82819814d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jjTq0TAko8WW0ZF-iioLyA.png"/></div></div></figure><p id="9d4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以快速分析我们的数据集包含三种不同类型的数据类型(整数、对象、布尔)。对象是字符串值。</p><h2 id="2aec" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">顶视图</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="95a3" class="jy jz hh ju b fi ka kb l kc kd">data.head()# by defalut it shows only 5 rows.<br/># data.head(n=10) # will display the 10 number of rows.</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ms"><img src="../Images/3b47e89bab626d6887620785d5436fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1NCgFnUbBekXdWFbHkaxQ.png"/></div></div></figure><h2 id="bdc5" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">仰视图</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="1429" class="jy jz hh ju b fi ka kb l kc kd">data.tail()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mt"><img src="../Images/08c97203a7897f3901ddae34babc6672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gJ2Q8M84BaAfEP4vMSK8Q.png"/></div></div></figure><p id="8c3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">默认情况下，头尾只显示5行。如果您有一个包含数百列的数据框，您可以使用<strong class="ig hi"> <em class="mp"> pd.set_option </em> </strong>进行更改。您还可以指定要查看多少列。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="54aa" class="jy jz hh ju b fi ka kb l kc kd">pd.set_option(“display.max.columns”, None) # will show all columns</span><span id="328b" class="jy jz hh ju b fi lv kb l kc kd">pd.set_option(‘display.max_columns’, 50)# will show 50 columns</span><span id="9b82" class="jy jz hh ju b fi lv kb l kc kd"># will show top 50 rows</span><span id="c379" class="jy jz hh ju b fi lv kb l kc kd">data.head(50)</span><span id="9deb" class="jy jz hh ju b fi lv kb l kc kd"># will show last 100 rows</span><span id="0d20" class="jy jz hh ju b fi lv kb l kc kd">data.tail(100)</span></pre><h2 id="2fdd" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">为了快速统计，汇总使用<strong class="ak"> describe() </strong></h2><p id="e615" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">这将提供数据集中所有数值列的描述性统计信息。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="c40c" class="jy jz hh ju b fi ka kb l kc kd">data.describe()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mu"><img src="../Images/ebb07528edcbcaa84a9d38e4f167ef65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9WPtls0vq-Rsi8_DmimrEQ.png"/></div></div></figure><h2 id="0ae3" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">转置数据</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="a74f" class="jy jz hh ju b fi ka kb l kc kd">data.T</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mv"><img src="../Images/5b41df7c7e835725b4b39e4594fe8cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wFKAHBzrPQ0Z_QRTpovriQ.png"/></div></div></figure><h2 id="7863" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">按轴排序</h2><p id="d767" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">axis = 0表示行，axis =1表示列。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="8c1c" class="jy jz hh ju b fi ka kb l kc kd">data.sort_index(axis=1, ascending=True)<br/># it sorts the columns alphabetically.</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mw"><img src="../Images/e1031300caf0141e693f6ac9cd23dd6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HD940htxNQNES5hCfavlNw.png"/></div></div></figure><h2 id="1213" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">按值排序</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="bf8a" class="jy jz hh ju b fi ka kb l kc kd">data.sort_values(by=”Name”)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mx"><img src="../Images/0165cd39887f7ec5fdac37446784b08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jnxhPEVhMzqn2bxhdc1Npg.png"/></div></div></figure><h2 id="bb61" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">将列名更改为数据框</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="5cb0" class="jy jz hh ju b fi ka kb l kc kd">data.rename(columns = { ‘Name’ : ‘Pokemon name’, ‘Type 1’: ‘ first type’})</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es my"><img src="../Images/823aec56c950258ee6fb5f670a711040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJSrnvZgx9AkPGfdaLMe6w.png"/></div></div></figure><h2 id="228d" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">删除列</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="96ae" class="jy jz hh ju b fi ka kb l kc kd">data.drop(columns=[‘Pokemon name’,’first type', ‘Type 2’])</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mz"><img src="../Images/5ac2c61e6db75509152728515438abae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4nrqRK8kSTn3ng1CYv7NiA.png"/></div></div></figure><h2 id="f8bc" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">行子集观察</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="3f5e" class="jy jz hh ju b fi ka kb l kc kd"><em class="mp">data[data.Length &gt; 10] #Extract rows that meet logical criteria.</em></span><span id="545f" class="jy jz hh ju b fi lv kb l kc kd"><em class="mp">df.sample(frac=0.5) #Randomly select fraction of rows.</em></span><span id="496d" class="jy jz hh ju b fi lv kb l kc kd"><em class="mp">df.sample(n=10) #Randomly select n rows.</em></span><span id="f682" class="jy jz hh ju b fi lv kb l kc kd"><em class="mp">df.iloc[10:20] #Select rows by position.</em></span></pre><p id="6cf0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">使用标签选择行和列(loc): </strong></p><p id="25f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以通过pandas数据框中的相应标签来访问行和列。</p><h2 id="e616" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">按标签选择单行:</h2><p id="0e28" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">这给出了第一行的所有细节。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="d67e" class="jy jz hh ju b fi ka kb l kc kd">data.loc[0]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es na"><img src="../Images/c2d63d37a498360c20c7e18e0a5ad52f.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*JoH34AG_3c1Fxen-DaTtxw.png"/></div></figure><h2 id="5630" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">通过标签访问多行:</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="a906" class="jy jz hh ju b fi ka kb l kc kd">data.loc[[0,1]] # selecting the rows at index 0 and 1</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nb"><img src="../Images/04e5ab9e3e3c369d82ab905e6baae836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Esegi7nxJMfy6fOoF1Zkeg.png"/></div></div></figure><h2 id="d4a3" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">按行和列访问:</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="8ea0" class="jy jz hh ju b fi ka kb l kc kd">data.loc[0,”Type 2"] # selection of index 0 and colum namne Type 2</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nc"><img src="../Images/ca4cd162b35246545afcb71b174fd605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*vRB8MC9hFxpEJlupOsNLUA.png"/></div></figure><h2 id="fa8c" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated">选择单行、多列:</h2><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="64b5" class="jy jz hh ju b fi ka kb l kc kd">data.loc[1,[‘Name’,’Attack’,’Defense’]]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nd"><img src="../Images/046909d78debee18b66acfd58afc591d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*Mif8exuKPpJErnc7DawEDw.png"/></div></figure></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><h2 id="b784" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">按步进位置选择(iloc): </strong></h2><p id="518b" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">按索引位置排列的行:</strong></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="e986" class="jy jz hh ju b fi ka kb l kc kd">data.iloc[1] # index starts from zero</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ne"><img src="../Images/82d40d770d948f89a54334c5ca3c89b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*sqkcWlJRiL7xje4uJ-86vg.png"/></div></figure><p id="cd86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">按索引位置的列:</strong></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="3136" class="jy jz hh ju b fi ka kb l kc kd">data.iloc[:, 3] # ‘Type 2’ column in pokemon data</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nc"><img src="../Images/bc04daf6d10ae850c00e42148b4626be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*KUQBaqddxuoUo-epOxL1qw.png"/></div></figure><h1 id="2f42" class="ke jz hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">使用标签对行和列进行切片:</strong></h1><p id="4a86" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">按标签对行进行切片</strong></p><p id="4948" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">选择位置1–3处的行和所有列。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="fde3" class="jy jz hh ju b fi ka kb l kc kd">data.loc[1:3, :]<br/></span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nf"><img src="../Images/75da093cbdd0f882165e6bb2897e42e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9sVUqvwdmpzxKgS-OLWM0w.png"/></div></div></figure><p id="79f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">切片标签列</strong></p><p id="ec09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在位置1-3处选择，并且只有两个列值。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="ad79" class="jy jz hh ju b fi ka kb l kc kd">data.loc[1:3, ‘Type 1’:’Type 2']</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ng"><img src="../Images/081fffa8736f77a7de676a716a24635f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*le7PJFk4CW3n6FA6Zdjxew.png"/></div></figure><h2 id="0278" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">使用位置(iloc)对行和列进行切片:</strong></h2><p id="4e73" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">索引从0开始到(行数/列数-1)。</p><p id="0a34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">根据索引位置对行进行切片</strong></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="0a7e" class="jy jz hh ju b fi ka kb l kc kd">data.iloc[0:3,:]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nh"><img src="../Images/af92c52290b68de06e93c9503fba1ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wi99q48pUWCCXNozQ66FTw.png"/></div></div></figure><p id="f3e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">按索引位置对列进行切片</strong></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="823c" class="jy jz hh ju b fi ka kb l kc kd">data.iloc[:,1:3]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ni"><img src="../Images/93aeac0533a9ad538116b59ef77ba506.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*u_yITxupn2PPZzXPAR9tew.png"/></div></figure><p id="88ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">根据索引位置对行和列进行切片</strong></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="e9d6" class="jy jz hh ju b fi ka kb l kc kd">data.iloc[1:2,1:3]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nj"><img src="../Images/e2ee9c40348c6cf4f983054c1c26b01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*6ZuOdUicAzu-G0X5DT87fg.png"/></div></figure></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><h1 id="0688" class="ke jz hh bd kf kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la bi translated"><strong class="ak">处理缺失值</strong></h1><p id="7080" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">在pandas <strong class="ig hi">中，dropna() </strong>函数用于删除具有Null/NaN值的行和列。当数据框中有任何缺失数据时，此函数会大量使用。</p><p id="b728" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">dropna()函数的语法如下所示。</p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="0ecf" class="jy jz hh ju b fi ka kb l kc kd">dropna(self, axis=0, how=”any”, thresh=None, subset=None, inplace=False)</span></pre><ul class=""><li id="584a" class="nk nl hh ig b ih ii il im ip nm it nn ix no jb np nq nr ns bi translated"><strong class="ig hi">轴</strong>:可能值为0或1，默认为0。如果为0，则删除行，如果为1，则删除列。</li><li id="6b43" class="nk nl hh ig b ih nt il nu ip nv it nw ix nx jb np nq nr ns bi translated"><strong class="ig hi">如何</strong>:可能值为(任意，全部)，默认为任意。如果<strong class="ig hi">任何</strong>删除值为空的行/列。如果<strong class="ig hi">全部，</strong>删除行/列。</li><li id="5158" class="nk nl hh ig b ih nt il nu ip nv it nw ix nx jb np nq nr ns bi translated"><strong class="ig hi"> thresh </strong>:一个int来指定drop的阈值。</li><li id="72f4" class="nk nl hh ig b ih nt il nu ip nv it nw ix nx jb np nq nr ns bi translated"><strong class="ig hi">子集</strong>:指定查找空值的行/列。</li><li id="2130" class="nk nl hh ig b ih nt il nu ip nv it nw ix nx jb np nq nr ns bi translated"><strong class="ig hi">原地</strong>:一个布尔值。如果为True，源数据帧将被更改，它将返回none。</li></ul><p id="b69e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">删除所有包含空值的行。移除na后，数据帧中还剩414行。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ny"><img src="../Images/2dcf143cf073ce9851a5e8ed6abcaa67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*-UpElGgd8sXWt8wKAeMe-g.png"/></div></figure><p id="9c10" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">删除缺少值的列</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nz"><img src="../Images/9fac2ce46354cfd8059a368421667fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*XXQ-DnTLxrL-M8yFPar4gg.png"/></div></figure></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><h1 id="00d2" class="ke jz hh bd kf kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw mk ky kz la bi translated"><strong class="ak">合并数据集</strong></h1><p id="5117" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">合并或联接操作通过使用一个或多个键链接行来组合数据集。</p><p id="7f9a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> pd.merge </strong>的主要参数及其描述</p><p id="9a0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mp">左侧- &gt; </em> </strong>左侧要合并的数据框。</p><p id="2a59" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mp">右侧- &gt; </em> </strong>要合并的数据框右侧。</p><p id="2d1b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mp">如何-&gt;</em></strong>‘内’、‘外’、‘左’或‘右’之一。默认情况下为“内部”</p><p id="f46d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">-<em class="mp">对</em>-</strong>-&gt;列名进行加入。必须在两个DataFrame对象中找到。如果未指定，也未给定其他连接键，将使用左侧和右侧列名的交集作为连接键。</p><p id="edea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们创建两个数据帧，在一个数据帧中完成所有这些合并操作。</p><p id="d664" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一数据帧</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es oa"><img src="../Images/d183cc1d93037bba811089141c27d676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lhP8gJ30kJA4XNXv8r4kSw.png"/></div></div></figure><p id="a3ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二数据帧</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ob"><img src="../Images/ab99ffcd516d3436680d0cd5ada405a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*3RJZx3USAhploH5HV43z6A.png"/></div></figure><h2 id="5720" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">内部连接</strong></h2><p id="8f85" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">连接df2到df1的匹配行</strong></p><p id="1f99" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mp">返回包含左侧数据帧所有行的数据帧。</em></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="4aef" class="jy jz hh ju b fi ka kb l kc kd">pd.merge(df1, df2,how=’left’, on=’key’)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es oc"><img src="../Images/c65847bb97455eb244f35e13bbde5364.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*Ax9MCANcKXjMt-w8ZrPeTw.png"/></div></figure><h2 id="fe3f" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">右连接</strong> -</h2><p id="7a88" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">连接df1到df2的匹配行</strong></p><p id="3776" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mp">右数据帧的所有行都照原样取，只有左数据帧的那些行在两者中是公共的。</em></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="61fe" class="jy jz hh ju b fi ka kb l kc kd">pd.merge(df1, df2,how=’right’, on=’key’)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nd"><img src="../Images/a22af26a8aad59ddb4f8f2bb06c0ce4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*QDsiBhjvU5Tgt3EeVWfyBw.png"/></div></figure><h2 id="6215" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">内部连接</strong></h2><p id="70eb" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">返回一个数据帧，该数据帧只包含在两个数据帧中有共同点的那些行。</strong></p><p id="275b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">pd.merge(df1，df2，how='inner '，on='key ')</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es od"><img src="../Images/0b14289ae8585417f86eb8b3df6758fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*NN0RFc9yowQU7p_HCqYq7g.png"/></div></figure><h2 id="e4ab" class="jy jz hh bd kf lh li lj kj lk ll lm kn ip ln lo kr it lp lq kv ix lr ls kz lt bi translated"><strong class="ak">外部连接</strong></h2><p id="2016" class="pw-post-body-paragraph ie if hh ig b ih lb ij ik il lc in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">保留所有行和所有值中可用的所有数据</strong></p><pre class="jd je jf jg fd jt ju jv jw aw jx bi"><span id="d433" class="jy jz hh ju b fi ka kb l kc kd">pd.merge(df1, df2,how=’outer’, on=’key’)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es oe"><img src="../Images/62de8a172f4619096647d78428ac3402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*regf1RKp8GeCfb1CmNw_tg.png"/></div></figure></div><div class="ab cl lz ma go mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ha hb hc hd he"><p id="c2ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总之，这些是最常见的pandas函数，可以帮助您挖掘数据以进行进一步分析。</p></div></div>    
</body>
</html>