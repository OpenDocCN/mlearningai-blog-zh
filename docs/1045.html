<html>
<head>
<title>Glasses Detection - OpenCV, DLIB &amp; Edge Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">眼镜检测- OpenCV、DLIB和边缘检测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/glasses-detection-opencv-dlib-bf4cd50856da?source=collection_archive---------1-----------------------#2021-09-21">https://medium.com/mlearning-ai/glasses-detection-opencv-dlib-bf4cd50856da?source=collection_archive---------1-----------------------#2021-09-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="8f5b" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">戴眼镜AI能检测到吗？让我们找出答案...</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/d68345d9b8ef5d593b33af8ae4edf0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7FHs_Ky3IyzoQp8AJtZ8QQ.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx"><a class="ae js" href="https://unsplash.com/@lunarts" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/@lunarts</a></figcaption></figure><p id="40a7" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">打印(' Hello World ')！这篇文章是关于使用OpenCV和Dlib检测用户是否戴了一副眼镜/墨镜。OpenCV是python中一个流行的库/模块，用于图像处理和计算机视觉。Dlib是C++中另一个流行的库，用于执行不同的机器学习应用程序。除了这些库，下面是这个项目的要求。</p><ol class=""><li id="8c6d" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq kw kx ky kz bi translated">Python 3(最好是版本≥ 3.5+)</li><li id="6c2a" class="kr ks hh jv b jw la ka lb ke lc ki ld km le kq kw kx ky kz bi translated">Numpy</li><li id="fd90" class="kr ks hh jv b jw la ka lb ke lc ki ld km le kq kw kx ky kz bi translated">Matplotlib</li><li id="262d" class="kr ks hh jv b jw la ka lb ke lc ki ld km le kq kw kx ky kz bi translated">统计数字</li><li id="b751" class="kr ks hh jv b jw la ka lb ke lc ki ld km le kq kw kx ky kz bi translated">枕头</li></ol><h1 id="1ce4" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated"><strong class="ak"> 1。理论方法</strong></h1><p id="d121" class="pw-post-body-paragraph jt ju hh jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq ha bi translated">一副眼镜总是由横跨鼻子的鼻梁连接(让我们称之为'<strong class="jv hi">'镜架桥'</strong>)，这将是我们检测的主要ROI。如果我们能检测到这个桥的存在，我们就能有效地检测到眼镜的存在。因此，我们的方法将是使用Dlib来检测一个人的面部标志，然后使用这些标志将注意力集中在鼻子上，以使用边缘检测来检测鼻梁的存在。</p><h1 id="f93f" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">2.编码</h1><p id="0b41" class="pw-post-body-paragraph jt ju hh jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq ha bi translated">说够了！让我们开始编码…</p><ul class=""><li id="9e02" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">让我们导入该项目所需的导入库</li></ul><pre class="jd je jf jg fd ll lm ln lo aw lp bi"><span id="645f" class="lq if hh lm b fi lr ls l lt lu">import numpy as np<br/>import dlib<br/>import cv2<br/>import matplotlib.pyplot as plt<br/>from PIL import Image<br/>import statistics</span></pre><ul class=""><li id="53f5" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">我们还需要下载‘shape _ predictor _ 68 _ face _ landmarks . dat’。这是网上免费提供的，上面有关于不同面部标志的所有信息。一个人的脸上总共有68个这样的标志点。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lv"><img src="../Images/6528480756b8d0cea147c89eae13fceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XWo_ZNRhkeZr9pfd8TCCZQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Universal Facial Landmarks</figcaption></figure><p id="1868" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">我们对第28、29、30和31点感兴趣。每个点都会给我们一个x和y坐标。为了清晰的可视化，我们还将考虑33、34和35。</p><ul class=""><li id="9640" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">让我们导入在上述地标上训练的Dlib人脸检测模型</li></ul><pre class="jd je jf jg fd ll lm ln lo aw lp bi"><span id="79f7" class="lq if hh lm b fi lr ls l lt lu">detector = dlib.get_frontal_face_detector()<br/>predictor = dlib.shape_predictor('shape_predictor_68_face_landmarks.dat')</span></pre><p id="2e63" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">让我们照张相让我照张相。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lw"><img src="../Images/bd1eedacc1de51dcde7b3fefd5196f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IwJ9WmpSJ15hwajyJlaUGQ.jpeg"/></div></div></figure><ul class=""><li id="334d" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">让我们得到所有68个面部标志。</li></ul><pre class="jd je jf jg fd ll lm ln lo aw lp bi"><span id="5c4d" class="lq if hh lm b fi lr ls l lt lu">img = dlib.load_rgb_image(path)<br/>plt.imshow(img)<br/>    <br/>rect = detector(img)[0]<br/>sp = predictor(img, rect)<br/>landmarks = np.array([[p.x, p.y] for p in sp.parts()])</span></pre><p id="5540" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">这段代码将帮助我们加载图像，获得矩形边界框，并为每个特征生成面部点。landmark变量将生成x，y坐标。</p><ul class=""><li id="5a49" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">现在我们想得到我的咳嗽对象的鼻子。</li></ul><pre class="jd je jf jg fd ll lm ln lo aw lp bi"><span id="80bb" class="lq if hh lm b fi lr ls l lt lu">nose_bridge_x = []<br/>nose_bridge_y = []</span><span id="4c4d" class="lq if hh lm b fi lx ls l lt lu">for i in [28,29,30,31,33,34,35]:<br/>        nose_bridge_x.append(landmarks[i][0])<br/>        nose_bridge_y.append(landmarks[i][1])<br/>        <br/>        <br/>### x_min and x_max<br/>x_min = min(nose_bridge_x)<br/>x_max = max(nose_bridge_x)</span><span id="8d6e" class="lq if hh lm b fi lx ls l lt lu">### ymin (from top eyebrow coordinate),  ymax<br/>y_min = landmarks[20][1]<br/>y_max = landmarks[31][1]</span><span id="907f" class="lq if hh lm b fi lx ls l lt lu">img2 = Image.open(path)<br/>img2 = img2.crop((x_min,y_min,x_max,y_max))<br/>plt.imshow(img2)</span></pre><p id="661b" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">聚焦于上面提到的坐标，我们得到这个图像。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ly"><img src="../Images/4821347adcd1bb66cef97f85ef7b23fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*ELbZ8WLdOYzAn0qYu0J8Tw.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">The nose section and the frame bridge</figcaption></figure><p id="06b4" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">我们现在将使用著名的用于边缘检测的Canny滤波器来获得边缘(轮廓)。注意，为了准确检测，我们将首先使用高斯模糊来模糊图像。</p><pre class="jd je jf jg fd ll lm ln lo aw lp bi"><span id="0f4c" class="lq if hh lm b fi lr ls l lt lu">img_blur = cv2.GaussianBlur(np.array(img2),(3,3), sigmaX=0, sigmaY=0)</span><span id="4b2b" class="lq if hh lm b fi lx ls l lt lu">edges = cv2.Canny(image =img_blur, threshold1=100, threshold2=200)<br/>plt.imshow(edges, cmap =plt.get_cmap('gray'))</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ly"><img src="../Images/b9b8c3f4087c4ff32693d28a9a4b4e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*WVElYEb6m3dWs3VMyvrfvw.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">The edges of the above image</figcaption></figure><p id="a2a9" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">请注意，我们可以将该帧视为一条白色像素带(大约在y - 50到100之间)。我们将使用沿着鼻子中心<strong class="jv hi"/>的单个列向量来检测这些像素。</p><pre class="jd je jf jg fd ll lm ln lo aw lp bi"><span id="4bf6" class="lq if hh lm b fi lr ls l lt lu">#center strip<br/>edges_center = edges.T[(int(len(edges.T)/2))]</span></pre><ul class=""><li id="d201" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">对图像进行转置以获得列向量，并沿着鼻子的中心取一个向量。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lz"><img src="../Images/7e86843dbe854d4c121ec358feb090d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k6d25iiAESEmzg_UVvzogg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">A strip of 0s between 255s</figcaption></figure><pre class="jd je jf jg fd ll lm ln lo aw lp bi"><span id="0d5b" class="lq if hh lm b fi lr ls l lt lu">if 255 in edges_center:<br/> print(“Glasses are present”)<br/>else:<br/> print(“Glasses are absent”)</span></pre><p id="3471" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">正如你在上面看到的，我们在黑色(表示鼻子)之间有一条白色的像素带(表示鼻梁)。确认眼镜的存在。</p><h1 id="4afb" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">3.另一个例子</h1><p id="bfb4" class="pw-post-body-paragraph jt ju hh jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq ha bi translated">我们举个例子。这是蕾哈娜，让我们看看我们是否能检测出她是否戴着眼镜。</p><ul class=""><li id="441c" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">输入图像</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ma"><img src="../Images/2c588c6f65a2f567a04bac3ade936655.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8zAIVW7moR5LT5i18OTS1w.png"/></div></div></figure><ul class=""><li id="c857" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">庄稼</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mb"><img src="../Images/6d9f7d4f9bbe0698b1296143112d0582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7pYlS6zmjSP3-95KRs1Sw.png"/></div></div></figure><ul class=""><li id="fcd4" class="kr ks hh jv b jw jx ka kb ke kt ki ku km kv kq lk kx ky kz bi translated">边缘和检测</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mc"><img src="../Images/0b9f22c0193f05ec57dd2bbe49130ffe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VpoLd8c9T5i33N5rjm4qZA.png"/></div></div></figure><p id="2058" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">因此，我们可以肯定蕾哈娜确实戴着眼镜。</p><h1 id="7d24" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">4.完整代码</h1><div class="md me ez fb mf mg"><a href="https://github.com/siddh30/Glasses-Detection/blob/main/Glasses_detection.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hi fi z dy ml ea eb mm ed ef hg bi translated">Glasses-Detection/Glasses _ Detection . ipynb at main siddh 30/Glasses-Detection</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">使用- OpenCV和DLI b-Glasses-Detection/Glasses _ Detection . ipynb在main …</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">github.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu jm mg"/></div></div></a></div><p id="2198" class="pw-post-body-paragraph jt ju hh jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq ha bi translated">这是该项目的GitHub repo，我也把所有东西放在一个可用的函数中——glasses _ detector。我还增加了实时检测功能。</p><h1 id="da1a" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated"><strong class="ak"> 5。结果</strong></h1><p id="237a" class="pw-post-body-paragraph jt ju hh jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq ha bi translated">这里有更多的结果，1，0 -玻璃存在/不存在</p><div class="jd je jf jg fd ab cb"><figure class="mv jh mw mx my mz na paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/559cf2aa05d6af2f033fd22ba38c43ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*6db8UgH1zku8N0_cP3Prug.png"/></div></figure><figure class="mv jh nb mx my mz na paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/76b64414c115608ad3bf0631b3e5b28a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*6_Rexb2jh8upojkd_q_rww.png"/></div></figure></div><h1 id="287e" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">6.这种模式可能失败的地方</h1><p id="8cab" class="pw-post-body-paragraph jt ju hh jv b jw lf jy jz ka lg kc kd ke lh kg kh ki li kk kl km lj ko kp kq ha bi translated">对于质量非常低的图像，如果帧非常薄且颜色较浅。</p><h1 id="01b5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">7.对于更多这样的项目</h1><div class="md me ez fb mf mg"><a href="https://github.com/siddh30/" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hi fi z dy ml ea eb mm ed ef hg bi translated">siddh30 -概述</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">Cognizant的数据科学家Cognizant的数据科学家欢迎您！这个投资组合有一个项目集在机器…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">github.com</p></div></div><div class="mp l"><div class="nc l mr ms mt mp mu jm mg"/></div></div></a></div><h1 id="5d57" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">8.你也可以跟着我</h1><div class="md me ez fb mf mg"><a href="https://www.linkedin.com/in/siddharthmandgi/" rel="noopener  ugc nofollow" target="_blank"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hi fi z dy ml ea eb mm ed ef hg bi translated">西达尔特·曼奇——高级助理数据科学家——认知| LinkedIn</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">在世界上最大的职业社区LinkedIn上查看西达尔特·曼奇的个人资料。西达尔特有2份工作列在…</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">www.linkedin.com</p></div></div><div class="mp l"><div class="nd l mr ms mt mp mu jm mg"/></div></div></a></div></div></div>    
</body>
</html>