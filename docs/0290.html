<html>
<head>
<title>Techniques in cleaning large datasets using pandas.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用pandas清理大型数据集的技术。</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/techniques-in-cleaning-large-datasets-sing-pandas-1e0fb1cb8544?source=collection_archive---------3-----------------------#2021-03-17">https://medium.com/mlearning-ai/techniques-in-cleaning-large-datasets-sing-pandas-1e0fb1cb8544?source=collection_archive---------3-----------------------#2021-03-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="dc4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将在本出版物中使用的数据集是Ames Housing数据集。可以在这里找到:<a class="ae jc" href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/house-prices-advanced-regression-techniques/data</a>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/3479eef7638fbb7502f912b810aa92ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*w0-FBK5aaHTJsF3Fib5gPg.jpeg"/></div></figure><p id="d52a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们使用这段代码将数据集读入pandas</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/ed52e4884d229f38eee76b180fb5564e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZneeiPku7oS4w-3nHwzuA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">importing the dataset into pandas</figcaption></figure><p id="a234" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了获得行和列的完整视图，我们将运行代码</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ju"><img src="../Images/063edf2d9f5bdf7b2f03cbb29e33bec5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f5tItn5zHwr-KAeH_A-Hqg.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">code to ensure the maximum display of the rows and columns</figcaption></figure><p id="0d24" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后我们查看数据集，注意行数、列数及其属性。但是，在此之前，我们保存了raw_data，以便在更改完成后需要时可以访问它。这将是我们的第一个检查站。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jv"><img src="../Images/814b96c755acbe41a3c9cb574d1a1b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-WY8VHf_1eOzsHR4sL2beA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">checkpoint 1</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jw"><img src="../Images/b7821ad8262e5fc645e30fe6307b21d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qNupa9bbRVKPD2oYGHGaaw.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">number of rows and columns in the data set</figcaption></figure><p id="ada1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们将查看数据集中缺失的数值变量</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jx"><img src="../Images/6804c5adbf559b4ff52f65e80104ead3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJpFCn2zlyUoy1D9HCKR9Q.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">numerical variables and their description</figcaption></figure><p id="fc92" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">只有两个数值变量具有缺失数据LotFrontage(包含1201行)和MasVnrArea(包含8个缺失行)。因为它们不多，即缺失值的百分比小于20 %，所以我们将用平均值来代替它们。</p><p id="f648" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，这并不是一直都这样做的，对于数值型的分类变量也不起作用</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jy"><img src="../Images/fd70aa94215cacf20a6a6357eac3cf43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yRqNSrlonIpsPNUuFCBNCg.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">replacing missing values for numerical values</figcaption></figure><h1 id="c030" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">处理缺失的分类变量</h1><p id="f27f" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip kz ir is it la iv iw ix lb iz ja jb ha bi translated">我们使用。info()来查看缺少的值</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lc"><img src="../Images/81d26f03fab31763fb1823d17373c1bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CZ79w-BxyiE_zIWKkTHYKw.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">info on categorical variables</figcaption></figure><p id="3c13" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MasVnrType</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ju"><img src="../Images/576c792f4206cfa0df56678b3f9754b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2NQ9Bsqyg4JX0mWPaxN6Hg.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">clean the MasVnrType</figcaption></figure><h2 id="0491" class="ld ka hh bd kb le lf lg kf lh li lj kj ip lk ll kn it lm ln kr ix lo lp kv lq bi translated">地下室</h2><p id="1732" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip kz ir is it la iv iw ix lb iz ja jb ha bi translated">通过查看数据集，我们注意到BsmtQual、BsmtCond、BsmtExposure、BsmtFinType1和BsmtFinType2这四列包含缺失值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lr"><img src="../Images/9f4b11f99f0a4cc0e9ca582eca0f5a95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ANwnc7y_yKs2NJ6xTO97A.jpeg"/></div></div></figure><p id="8112" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">和都依赖于BsmtQual，所以<br/>对于没有BsmtQual的值，相应的3列也没有，所以<br/>的4列有37个相同的缺失值。但是BsmtExposure和BsmtFinType2有38个缺失值，37个与BsmtQual相同的缺失值和一个额外的缺失值，它们分别位于行948和333中。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ls"><img src="../Images/668ad6b54368c74900252e0187619b80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S7p8OUf8m2wmdenjzq2mNA.jpeg"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lt"><img src="../Images/3ba0e185a0b61771fc3293070aa1928e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h9VSaIPINhl967cvJ2XCyA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">The five corresponding values are related to BsmtQual</figcaption></figure><p id="0518" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以我们首先填充BsmtExposure和BsmtFinType2这两列，它们有38个缺失值。从数据的描述来看，他们有</p><p id="0b43" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">bsmt暴露:指步行或花园水平墙</p><p id="63ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Gd良好曝光度<br/> Av平均曝光度(错层或门厅通常得分为平均或以上)<br/> Mn最小曝光度<br/>否无曝光度<br/> NA无地下室</p><p id="5664" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">BsmtFinType2:地下室完工面积的评级(如果有多种类型)</p><p id="ca3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">GLQ良好生活区<br/> ALQ一般生活区<br/> BLQ低于一般生活区<br/> Rec一般娱乐室<br/> LwQ低质量<br/> Unf未装修<br/> NA无地下室</p><p id="622a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为他们唯一的参赛作品。因此，我们将在BsmtExpo中重新填入“No ”,因为它没有风险，而在BsmtFinType2中填入“unf”</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lu"><img src="../Images/ee3878f1696da42fc0a56e7bd6aa5b60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*umYc03YnlxlmeRyaUyUKOQ.jpeg"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ju"><img src="../Images/c7809f96e9b90f300c0e88c0e0032dda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*caVa10mplsT0_wCSQjoo9w.jpeg"/></div></div></figure><p id="9d20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">浏览数据集，可以看到基底变量的唯一值由下式给出</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lv"><img src="../Images/f5ad88e1b90d9ca376f02652d5d5c9e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RXer1pYoPS6djH4DkcoS_g.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">unique values of BsmtQual</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lw"><img src="../Images/844edcf90fec28ee90bd7b349f674780.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-Apj4SnmQOui2IH6VB-AA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">unique values of BsmtFintype2</figcaption></figure><p id="6377" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">而根据数据描述，BsmtQual的唯一值由下式给出</p><p id="8902" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Ex优秀(100+英寸)<br/> Gd良好(90–99英寸)<br/> TA典型(80–89英寸)<br/> Fa一般(70–79英寸)<br/> Po较差(&lt; 70英寸<br/> NA无地下室</p><p id="8c69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以这意味着没有地下室的房子被存储为所有五个相同变量的缺失值。我们将用NA替换五个相关基底细胞中所有37个相同的nan条目。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lx"><img src="../Images/5eeaf915917d9fa840bdec91cf265d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ZTAK4eZobVrSWaCGgtHow.jpeg"/></div></div></figure><h2 id="8444" class="ld ka hh bd kb le lf lg kf lh li lj kj ip lk ll kn it lm ln kr ix lo lp kv lq bi translated">与电有关的</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jy"><img src="../Images/373984d245f59799b9adf89060def1f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8n9tqC7zzdSP9njkyEirTQ.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">description of the entries in the Electrical column</figcaption></figure><p id="f563" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以看出，电气列只有一个缺失值，出现频率最高的是SBrkr，我们将用它来填充缺失值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ly"><img src="../Images/65e62e545ce3fba32b5b6a732c394600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JN79zjc20T_gn-Kyk6B98g.jpeg"/></div></div></figure><h2 id="b49f" class="ld ka hh bd kb le lf lg kf lh li lj kj ip lk ll kn it lm ln kr ix lo lp kv lq bi translated">壁炉</h2><p id="bcc4" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip kz ir is it la iv iw ix lb iz ja jb ha bi translated">具有空值的两列是Fireplaces和FireplaceQu</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lr"><img src="../Images/99060a1a1548874374e55671fbc4e126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qiPp0dvixDBeW-ejKTeqng.jpeg"/></div></div></figure><p id="c9f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到这两列是相关的，每个没有壁炉的条目都具有空壁炉质量。所以我们将用NA来填充缺失的值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lc"><img src="../Images/1da252fae26902c542b91d9db5a08565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qqE2H_2n4wXBm1iCvMT4SQ.jpeg"/></div></div></figure><h2 id="0997" class="ld ka hh bd kb le lf lg kf lh li lj kj ip lk ll kn it lm ln kr ix lo lp kv lq bi translated">车库</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lz"><img src="../Images/d4787b8962aa4bf010566b600e6a0cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLmK5n3mrlXHTM3HeBvEUw.jpeg"/></div></div></figure><p id="8d49" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上图可以看出，没有车库类型的列也有与之相关的四个变量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es ma"><img src="../Images/0b105543eb42d5c2f383848b2bfe6e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cKadu59KnE52UW72z52yvg.jpeg"/></div></div></figure><h2 id="68fe" class="ld ka hh bd kb le lf lg kf lh li lj kj ip lk ll kn it lm ln kr ix lo lp kv lq bi translated">泳池</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es lx"><img src="../Images/98a51c13a20b1f97e4ce975c38a97811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yny-eVfFH43opjOUVExyiw.jpeg"/></div></div></figure><p id="adfb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到，没有公摊面积的房屋数量对应的是没有给出的poolqc的数量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mb"><img src="../Images/13866006c102f9e3589dc2e81027e364.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMS7_eb7zlnqLGr0tFidwQ.jpeg"/></div></div></figure><h2 id="7ada" class="ld ka hh bd kb le lf lg kf lh li lj kj ip lk ll kn it lm ln kr ix lo lp kv lq bi translated">检查站2</h2><p id="add6" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip kz ir is it la iv iw ix lb iz ja jb ha bi translated">我们将在这里用代码创建第二个检查点</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es mc"><img src="../Images/d2cba8ff950d4519e81fd7be0b1438d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxhWPmBJvShyped7qxOckQ.jpeg"/></div></div></figure><h2 id="84b9" class="ld ka hh bd kb le lf lg kf lh li lj kj ip lk ll kn it lm ln kr ix lo lp kv lq bi translated">小巷，栅栏，恶作剧</h2><p id="9285" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip kz ir is it la iv iw ix lb iz ja jb ha bi translated">剩下三列是空的数据通道、围栏和杂项特征。我们会删除它们，因为它们只包含占数据集不到20%的值。</p><p id="96a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将感谢您的回复和评论。有没有其他无缝且更快的技术？请回复。</p></div></div>    
</body>
</html>