<html>
<head>
<title>Recommendation Systems: ARL (Association Rule Learning)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐系统:ARL(关联规则学习)</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/recommendation-systems-arl-association-rule-learning-bed1a07b5d9a?source=collection_archive---------0-----------------------#2022-11-30">https://medium.com/mlearning-ai/recommendation-systems-arl-association-rule-learning-bed1a07b5d9a?source=collection_archive---------0-----------------------#2022-11-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/997723b2ee98ea0c70f1f68b13c25869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tt_WOoZpTwhOnsPmRGo7Bw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Jerry-Lee Bosmans</figcaption></figure><p id="1c26" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">推荐系统旨在使用一些方法和算法向用户推荐内容、产品和服务。虽然它从90年代就开始使用了，但自2009年以来，它已被广泛用于数据分析。</p><p id="a83c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">虽然内容丰富，但用户的兴趣更倾向于定制整个内容集，并且因人而异。为了不迷失在这个丰富的集群中，并根据感兴趣的领域达到期望的个性化服务，需要进行各种过滤。这些过滤器和算法表现为“推荐系统”。它被用于许多领域，如约会应用、电子商务网站、社交媒体渠道等。</p><p id="4f32" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">可以在4个主要标题下检查推荐系统:</p><ul class=""><li id="eb59" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">简单推荐系统:</strong>利用商业知识或简单的排序技术进行一般性推荐。</li><li id="a08b" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">关联规则学习:</strong>根据通过关联分析学习到的规则提出建议。</li><li id="b0f0" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">基于内容的过滤:</strong>根据产品的相似性进行推荐。</li><li id="33c0" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">协同过滤:</strong>根据共同意见，基于用户或产品进行推荐。它分为基于用户、基于产品和基于模型。</li></ul><p id="9220" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">本文是推荐系统的第一部分，重点是简单的推荐系统和关联规则学习，关注基于内容的过滤和协同过滤方法。</p></div><div class="ab cl kf kg go kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ha hb hc hd he"><h1 id="ed99" class="km kn hh bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">简单的推荐系统</h1><p id="d093" class="pw-post-body-paragraph it iu hh iv b iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm lo jo jp jq ha bi translated">简单的推荐系统不关心用户行为或产品特征。这些系统通常集中于具有最高分数的优选的、流行的、传奇的产品等。并将这些产品直接推荐给用户。</p></div><div class="ab cl kf kg go kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ha hb hc hd he"><h1 id="cc90" class="km kn hh bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">关联规则学习</h1><p id="3998" class="pw-post-body-paragraph it iu hh iv b iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm lo jo jp jq ha bi translated">它是一种基于规则的机器学习技术，用于发现数据中的模式。关联规则学习时使用Apriori算法。Apriori是一种篮子分析方法，用于揭示产品关联。先验中有3个重要指标:</p><ul class=""><li id="149e" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">支持</strong>:测量产品X和Y一起购买的频率</li></ul><pre class="lp lq lr ls fd lt lu lv bn lw lx bi"><span id="28a1" class="ly kn hh lu b be lz ma l mb mc"><strong class="lu hi">Support(X, Y)</strong> <strong class="lu hi">= Freq(X, Y) / Total Transaction</strong></span></pre><ul class=""><li id="3ea7" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">置信度</strong>:购买产品X时，购买产品Y的概率</li></ul><pre class="lp lq lr ls fd lt lu lv bn lw lx bi"><span id="e879" class="ly kn hh lu b be lz ma l mb mc"><strong class="lu hi">Confidence(X, Y)</strong> <strong class="lu hi">= Freq(X, Y) / Freq(X)</strong></span></pre><ul class=""><li id="179e" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi"> Lift: </strong>购买产品X时，购买产品Y的概率增加的系数。</li></ul><pre class="lp lq lr ls fd lt lu lv bn lw lx bi"><span id="ab92" class="ly kn hh lu b be lz ma l mb mc"><strong class="lu hi">Lift = Support(X, Y) / (Support(X) * Support(Y))</strong></span></pre><h2 id="2f6f" class="md kn hh bd ko me mf mg ks mh mi mj kw je mk ml la ji mm mn le jm mo mp li mq bi translated">先验是如何工作的？</h2><p id="22bb" class="pw-post-body-paragraph it iu hh iv b iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm lo jo jp jq ha bi translated">Apriori算法根据流程开始时确定的支持度阈值计算可能的产品对，并根据每次迭代中确定的支持度值进行淘汰，从而创建最终表。</p><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mr"><img src="../Images/2a8f7654aaa809c8105215a5334e4ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IX_5vPTsY1q3IVDwr_zTWw.png"/></div></div></figure><ul class=""><li id="0322" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">第一步</strong>:计算每个产品的支持值。</li></ul><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ms"><img src="../Images/b6fe3c8c989f210c0ed1ebe43faffc34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrgA4Pr7SD4SscYzTEm5Mw.png"/></div></div></figure><ul class=""><li id="f592" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">步骤2: </strong>剔除支持值等于或低于流程开始时确定的支持阈值的产品。</li></ul><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mt"><img src="../Images/17d4fc3463904a06914779d03015c3b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ub7F729fc9cH7aV5nqjOTQ.png"/></div></div></figure><ul class=""><li id="f9a3" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">第三步:</strong>确定可能的产品对并计算支持值。</li></ul><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mt"><img src="../Images/87cf9686eb347387ff84b7ecc24d20e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULnB8t83tJZ10oh9PG3Xgg.png"/></div></div></figure><ul class=""><li id="3285" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">第四步:</strong>根据确定的支持度阈值进行剔除。</li></ul><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mr"><img src="../Images/3305b712719f07188cabbfd0728231e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*akqooxrIBnq_BCjavXcmCw.png"/></div></div></figure><ul class=""><li id="8b76" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">第五步:</strong>确定新的可能产品对，计算支持值。</li></ul><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ms"><img src="../Images/99c270f0c0185905aade886006df4add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3yi0FbI_wf1LR6DBwqnxQg.png"/></div></div></figure><ul class=""><li id="9d0d" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">第六步:</strong>根据确定的支持度阈值进行淘汰。</li></ul><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mu"><img src="../Images/022061922c309ffbd89574953387ac66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bGk2T73Y9fQMRkIiuJqR1A.png"/></div></div></figure><ul class=""><li id="7443" class="jr js hh iv b iw ix ja jb je jt ji ju jm jv jq jw jx jy jz bi translated"><strong class="iv hi">第7步:</strong>最终表格</li></ul><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mv"><img src="../Images/c5eee9dc7c3c8cf714d775ff98696f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1yF1kkSgcz4QNpTDL9az-g.png"/></div></div></figure><p id="de20" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">鸡蛋和啤酒一起出现在40%的购买中。67%买鸡蛋的顾客也买啤酒。鸡蛋购买量增加了1.11倍。根据最后的表格，可以做出这几种评论。</p><p id="c660" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">既然我们已经研究了Apriori算法的工作逻辑，那么是时候创建一个Python项目了，在这个项目中，我们将使用Apriori算法实现关联规则学习。</p><p id="bcff" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在这个项目中，我将使用之前在RFM 和CLTV<a class="ae mw" rel="noopener" href="/the-modern-scientist/crm-analytics-cltv-customer-lifetime-value-6a02825d7cbe">(客户终身价值)</a>项目的<a class="ae mw" rel="noopener" href="/@zbeyza/crm-analytics-customer-segmentation-with-rfm-208ddc10c623">客户细分中使用的online_retail_II数据集。要记住变量:</a></p><h2 id="0757" class="md kn hh bd ko me mf mg ks mh mi mj kw je mk ml la ji mm mn le jm mo mp li mq bi translated">可变包:</h2><ul class=""><li id="dc52" class="jr js hh iv b iw lk ja ll je mx ji my jm mz jq jw jx jy jz bi translated"><strong class="iv hi">发票</strong>:发票号。名义上。分配给每笔交易的6位整数。如果此代码以字母“C”开头，则表示取消。</li><li id="7a8e" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">库存代码</strong>:产品(项目)代码。名义上。一个5位数的整数，唯一分配给每个不同的产品。</li><li id="09de" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">描述</strong>:产品(物品)名称。名义上。</li><li id="d8db" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">数量</strong>:每笔交易每种产品(物品)的数量。数字。</li><li id="c40a" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">发票日期</strong>:发票日期和时间。数字。生成交易的日期和时间。</li><li id="db85" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">单价</strong>:单价。数字。以英镑为单位的产品价格()。</li><li id="b555" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi"> CustomerID </strong>:客户编号。名义上。唯一分配给每个客户的5位整数。</li><li id="1950" class="jr js hh iv b iw ka ja kb je kc ji kd jm ke jq jw jx jy jz bi translated"><strong class="iv hi">国家</strong>:国家名称。名义上。客户居住的国家的名称。</li></ul><p id="f485" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">与数据集相关的操作和各种操作已经在前面的代码部分完成，你可以在这里找到项目<a class="ae mw" href="https://github.com/zbeyza/association_rule_learning" rel="noopener ugc nofollow" target="_blank">的完整代码。</a></p><p id="df54" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要应用ARL，首先，您应该准备ARL数据结构。我们需要一个由0和1组成的发票项目矩阵，但在创建这个矩阵之前，我将把数据集缩减到一个国家。我选了法国，你可以选别的国家，自己试试。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="na nb l"/></div></figure><p id="dd55" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">由于我们将数据集减少到法国，现在我们可以创建发票项目矩阵。我们可以将StockCode和Description都作为Item，但是将Description作为Item会导致它占用大量内存并且代码运行缓慢，所以将StockCode作为Item会更健康，而不是产品名称。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="na nb l"/></div></figure><p id="e44f" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">频繁项目集是一组经常一起出现并达到预定义的支持度和置信度的项目。使用关联规则可以发现频繁项集。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="na nb l"/></div></figure><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="na nb l"/></div></figure><pre class="lp lq lr ls fd lt lu lv bn lw lx bi"><span id="ae81" class="ly kn hh lu b be lz ma l mb mc"><strong class="lu hi">antecedents</strong> : first product<br/><strong class="lu hi">consequents</strong> : second product<br/><strong class="lu hi">antecedent support</strong> : proportion of transactions that contains antecedent A<br/><strong class="lu hi">consequent</strong> <strong class="lu hi">support </strong>: proportion of transactions that contains consequent C<br/><strong class="lu hi">support</strong> : items’ frequency of occurrence<br/><strong class="lu hi">confidence</strong> : conditional probability of purchasing consequents Y <br/>when antecedents X is purchased<br/><strong class="lu hi">lift </strong>: How many times the probability of purchasing consequents Y <br/>increases when antecedents X is purchased<br/><strong class="lu hi">leverage</strong> : similar to lift but it gives priority to higher support.<br/><strong class="lu hi">conviction</strong> : expected frequency of antecedents X without consequent Y</span></pre><p id="9c45" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在创建规则表之后，可以根据需要(支持、信任、提升、杠杆)进行排序，然后可以执行推荐过程。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="na nb l"/></div></figure><p id="6263" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">作为项目的最后一步，我们将进行产品推荐。为此，我们将使用一个函数，该函数将规则数据框、产品id和建议数量作为参数。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="na nb l"/></div></figure><p id="aad3" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">假设我们为产品id为22492的产品推荐2个产品。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="na nb l"/></div></figure><p id="3046" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">通过使用下面的函数，我们可以从我们将要推荐的产品的id中检查产品名称。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="na nb l"/></div></figure></div><div class="ab cl kf kg go kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ha hb hc hd he"><p id="cbb2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们已经到达终点了！有问题，遇到困难或者只是想打个招呼？请使用评论框。🦖</p><div class="nc nd ez fb ne nf"><a href="https://github.com/zbeyza/association_rule_learning" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab dw"><div class="nh ab ni cl cj nj"><h2 class="bd hi fi z dy nk ea eb nl ed ef hg bi translated">GitHub-zbeyza/association _ rule _ learning</h2><div class="nm l"><h3 class="bd b fi z dy nk ea eb nl ed ef dx translated">一种基于规则的机器学习技术，用于发现数据中的模式。使用Apriori算法的同时…</h3></div><div class="nn l"><p class="bd b fp z dy nk ea eb nl ed ef dx translated">github.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt in nf"/></div></div></a></div><p id="62fb" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">请继续关注基于内容的过滤和协作过滤，这将是关于推荐系统的下一篇文章。🔔</p><div class="nc nd ez fb ne nf"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ng ab dw"><div class="nh ab ni cl cj nj"><h2 class="bd hi fi z dy nk ea eb nl ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nm l"><h3 class="bd b fi z dy nk ea eb nl ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nn l"><p class="bd b fp z dy nk ea eb nl ed ef dx translated">medium.com</p></div></div><div class="no l"><div class="nu l nq nr ns no nt in nf"/></div></div></a></div></div></div>    
</body>
</html>