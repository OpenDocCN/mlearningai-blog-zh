<html>
<head>
<title>Predicting the Feed Consumption of a Swine Farm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测养猪场的饲料消耗</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/predicting-the-feed-consumption-of-a-swine-farm-81ce4f703f3a?source=collection_archive---------2-----------------------#2022-02-22">https://medium.com/mlearning-ai/predicting-the-feed-consumption-of-a-swine-farm-81ce4f703f3a?source=collection_archive---------2-----------------------#2022-02-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="fc12" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">在R中使用时间序列、线性混合模型和一般可加混合模型</h2></div><p id="c3f9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这篇博文中，我将向你展示如何使用几种不同类型的模型来预测养猪场的饲料曲线。当然，通往成功模式的道路不是技术本身，而是研究问题的有效性及其潜在的含义。</p><p id="e0c3" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们看一下这个例子。因为这是商业数据，我不能与你分享这些数据。不过，如果您尝试将代码和工作方式附加到您自己的数据中，这对于学习练习来说总是最好的。任何数据集都可以，只要它有重复的观察。</p><p id="25d7" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，让我们从加载库和数据开始。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es jz"><img src="../Images/e57dd7f5b3f316ac3ddff01ed0107ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iyTDcIuhf68AWz2IHha3gA.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">As you can see, quite a nice dataset. It is not that clean, since it is commercial data. Clean data only exist in text-book examples.</figcaption></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kk"><img src="../Images/5c4a1a3b3ac10c6cccf90d6787a9a353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n8B1oHQvjQF04kLbtyOZ8Q.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Data on three farms, and the stables / pens within each farm.</figcaption></figure><pre class="js jt ju jv fd kl km kn ko aw kp bi"><span id="f217" class="kq kr hh km b fi ks kt l ku kv">DataExplorer::plot_missing(combined4)<br/>df &lt;- combined4[,colSums(is.na(combined4))&lt;nrow(combined4)]<br/>DataExplorer::plot_missing(df)<br/>table(df$ble_id)<br/>table(df$vbf_id)<br/>table(df$vbf_id, df$lcn_id)</span></pre><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es kw"><img src="../Images/d260392b308a8fe7f5d1dbb16c247edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EV6XHe8JlEDb_opysdwuvA.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Quite some missing data.</figcaption></figure><p id="fc1f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，在每一个围栏里都有不同的喂食周期。因此，如果我们想要分析日内曲线的函数，我需要通过添加另一个我称为<em class="kx"> newField的层来进一步取消数据列表。</em>最后，我们有农场级、笔级和<em class="kx">纽菲尔德</em>(运行)级<em class="kx">的数据。</em></p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/f8a3ede31b0f570c9136720ab104f144.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*PIiYIFaMdxBXu_7ZNZGV3w.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/76c67b099289e793efe3df33ae61f4db.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*VLcTD75eG0F3eTEMeffL-g.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/1075b05c8cedc7160e284bf1e5124300.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*qvW4HhdBnYlB2BxpEV5KZA.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx le di lf lg">The original data, the run identifier added, and the daily feed provision. The first two plots to the left show the cumulated feed provision. In this post I will show you how to model the data on the right to mimic the data on the left.</figcaption></figure></div><p id="1cee" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们继续进行数据探索。千万不要认为这部分过程是浪费时间！它帮助了我很多很多次，通常是在我建立了第一套模型之后，帮助我理解为什么没有一个模型是有意义的。你会经常发现自己在剧情、模型、剧情、模型之间来来回回。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/d4c744d86fc4b2b9af4c682cba251e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*HYJjCabJcrc0tG-W1PQnRw.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/567dd6bc50f1a7a7b647b92e0f242621.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*LVfAJDh2aa5uEt2VONpwlw.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/a989c2a19e944de638effeaa1c5b605a.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*qH9MhyRekdcjVROEWQwTdw.png"/></div></figure></div><div class="ab cb"><figure class="ky jw lh la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/83991f8e537abde37159cc2d834e3663.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*asEVMC_EhxJ_b0Bka4I9Gw.png"/></div></figure><figure class="ky jw li la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/ce9e8ff0f76e3d6c87e5a37a4ad2eafb.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*SsFQGnRDlxpspGsb5-ZJkA.png"/></div></figure><figure class="ky jw li la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/6ef055d4214674fcd395a1e2a987ce0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*M_B5eHZsENpmXbtQXSgvgw.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx lj di lk lg">Feed curves plotted by farm and pen. Either cumulated or not, looking at components or not. There is no shortage of data to say the least.</figcaption></figure></div><p id="721e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我对这类数据建模的第一直觉是使用时间序列。除了数据实际上是时间序列的性质之外，还有几种创建时间序列集合的方法可以挑选季节影响。所以，这是我首先尝试做的。找到任何一种时间模式。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es ll"><img src="../Images/19fb6f15221aab675cc8f604dd5e3a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qp10-JC7_p4BK8YNDzH8Pg.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Time-series models do not like (some actually throw a temper tantrum) when you have missing data. So, I used the Kalman method of the <a class="ae lm" href="https://cran.r-project.org/web/packages/imputeTS/index.html" rel="noopener ugc nofollow" target="_blank"><strong class="bd ln">imputeTS</strong></a> package to fill in the blanks.</figcaption></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lo"><img src="../Images/8c3a3ad3b1fd781d32407b5bacb67c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AsVBv9X9SUlzb0YwCLd8Lg.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Plotting a <a class="ae lm" href="https://tsibble.tidyverts.org/" rel="noopener ugc nofollow" target="_blank"><strong class="bd ln">tsibble</strong></a>.</figcaption></figure><p id="3780" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，让我们使用这个tsibble并释放几个时间序列模型，包括一个<a class="ae lm" href="https://blog.devgenius.io/ensemble-models-using-caret-in-r-d54e4e646968" rel="noopener ugc nofollow" target="_blank">集合</a>。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lp"><img src="../Images/048ebb48d75384abaf1e05beefaab0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ccxQjEklCwvP3h_P8EIxcA.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">And then THIS is what happens. To be honest, I still have not figured out why it produces NULL models, even if I ask it to only run on feed curves that have at least 30m data points included. There should also be no missing data, but it just does not work. If you try to run forecasts on this list of models it will stop immediately since the first model on the list is actually not there. It is a list with holes.</figcaption></figure><p id="ce15" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最终，经过一番调整，我放弃了，求助于另一套模型——<a class="ae lm" rel="noopener" href="/mlearning-ai/introduction-to-mixed-models-in-r-9c017fd83a63">混合模型</a>。我非常喜欢混合模型，因为它能够处理缺失数据(在某些假设下)，并且能够在嵌套的数据框架中对纵向数据进行建模。这正是我们现在所拥有的。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lq"><img src="../Images/96ea4108e11123ce24313675e30b0c0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_UTJevV-EISZ-2hCi1IgQ.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">ANOVA to find the best possible model.</figcaption></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lo"><img src="../Images/959af043dc63a795c18a1546982d3171.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3PfivEsx2WMGswGW_xdpg.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Comparing five models. Model 4 has some serious issues despite having the lowest AIC. Just using the AIC to determine which model to use is not the best strategy as overfitting may easily take place.</figcaption></figure><p id="e4ff" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们更仔细地看看模型4和模型1。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es lr"><img src="../Images/faae1a37b775f4b9593744d69df64a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v7mYrnZfkqfRatYJ8VlWHA.jpeg"/></div></div></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw ls la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/472eb27cf1a934e49603d7dfacf3e32b.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*1E0NSAzXo72V9d_AAVs93A.png"/></div></figure><figure class="ky jw lt la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/0e2cdd94fe89dbf2c0e42514a62e3dfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*DwIIvwQQVUC0r895tPvLWw.png"/></div></figure><figure class="ky jw lt la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/cad8b27d58afe687427fd5a9f9056eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*EHqAB8e3qYjd8aq9LZt-WQ.png"/></div></figure></div><div class="ab cb"><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/acb79e3b3dc574ddcd71ff4ba8e3e901.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*C4U4eCCb8gcSS56DZ5Rvlg.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/994960ea1933f4c5f32083eb1431dec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*9EXpdpMdvPampioHf6ICHA.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/180d9a45b1fbcd53894590583a4a33ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*V3Vcx6HDJsfCRFkGAOTgqg.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx le di lf lg">Model 4 is not too bad to be honest, but I still do not like the standard error of the coefficient estimates.</figcaption></figure></div><div class="ab cb"><figure class="ky jw lu la lb lc ld paragraph-image"><img src="../Images/1293276907675c4be9e579e9a27695f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*iDMoBgi6f61TCiTIszgOSw.png"/></figure><figure class="ky jw lv la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/f000c89de45e35aa12294cb8e11a3126.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*jp8Ddi1fMPWlFWc7kwWzMQ.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx lw di lx lg">Negative predicted values of the cumulative feed provision is not what I want to look at. Random effects look okay.</figcaption></figure></div><div class="ab cb"><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/ad67450ebb7a68007faf10461dbbcf54.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Xq9gVQCHucEathHZNkE_pA.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/6f98fd9f5467017ce457d4052de461c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*AH3yrPlAhqBVRtfZn8IVhg.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/71081863c8551276b3a63fb13b798d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*o_DZWWj97bXan8LRk3efgg.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx le di lf lg">Residuals — total, across feed run (<strong class="bd ln">newField</strong>) and pen. Residuals by pen shows some funny values. These value may easily disturb the model.</figcaption></figure></div><div class="ab cb"><figure class="ky jw ly la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/8a6091494317a457c6b6800778e858fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*9Lf35ekPhqSG7Xj5k9qAaQ.png"/></div></figure><figure class="ky jw lz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/371580281221fb6db73ffebc615ce491.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*j4ElQ4RsX0l6sYox7xf6zQ.png"/></div></figure><figure class="ky jw ma la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/9c247514e47c22372e6f8670fca37c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*bw_T3EUPlDs5fgQ07HDrzg.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx mb di mc lg">Calibration plot to the left, residuals by time, and QQ-plot by feed run (<strong class="bd ln">newField</strong>). The calibration plot is not that bad actually, but the residuals by time shows some weird values. As if the <strong class="bd ln">curve_day</strong> variable itself is not really correct.</figcaption></figure></div><p id="a32c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">模型系数如下表所示。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es md"><img src="../Images/18a72db31cbca4f29f7ec13355f1a222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A8XaJF9cGG8FDvZ6SFyN6g.jpeg"/></div></div></figure><p id="2aa7" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我已经给你们展示了一个校准图。让我们再看几个。老实说，校准图在使用和比较模型时并不方便，显示模型间残差的密度图会更好。然而，当我到这里的时候，我已经下定决心，线性混合模型不是使用的模型集。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es me"><img src="../Images/5890d17d80332c3f4e2770c93d1cf1a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ZQocjunAS4VyEYKMVq8Ug.png"/></div></div></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/d774bf621996610ea35195cedb3c4e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*yxn5WPZZpwJShuDWyuHERw.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/8c6e7890bd9687dea69486fc13a170ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*tTHLnqRT6jHph4fNM-e2lA.png"/></div></figure><figure class="ky jw kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/af748e8b84164c38a34e2143a0493414.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*SmqPT25dwtVMj5nlnztp7g.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx le di lf lg">Different models reveal different colors which reveals different levels of accuracy for the model fit. It does not matter anymore to be honest, since I wanted to shift to a different set of models by this time anyhow.</figcaption></figure></div><p id="d8e6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我在上面做的是给线性混合模型添加样条——这是一个我已经在不同物种间采用了无数次的<a class="ae lm" href="https://blog.devgenius.io/growth-modeling-in-piglets-534766dcad1f" rel="noopener ugc nofollow" target="_blank"/>的<a class="ae lm" rel="noopener" href="/mlearning-ai/growth-modeling-in-ruminants-fbeb08fa58ab">过程。同样，</a><a class="ae lm" href="https://blog.devgenius.io/modelling-feed-intake-data-in-swine-1af3d72f263d" rel="noopener ugc nofollow" target="_blank">馈送数据</a>的建模也不是新的。但是这一次我想采用不同的建模方式，在混合模型格式中使用<a class="ae lm" href="https://blog.devgenius.io/dose-response-response-surface-designs-and-splines-using-sas-42535db1302e" rel="noopener ugc nofollow" target="_blank">通用附加模型</a>。此外，我想使用训练和测试来分割数据，以便更好地理解模型。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw mf la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/4b76fe82b7e9ef2cd891ec4c980db2b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*Uv4oXQep5OkJbGs_RjGFKg.png"/></div></figure><figure class="ky jw mg la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/fd18f9c0f3756986062b9b9ccddc21c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*eXHn8G9ubr98yTAjqejl5A.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx mh di mi lg">Train and test data of selected pen’s. THIS is the level at which I will be modelling using GAMs in a Mixed Model structure.</figcaption></figure></div><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es mj"><img src="../Images/fea552ea80bdbf2878c0e2ac1568ca56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EBtQdsg4bzkfm6-zSDsWHQ.jpeg"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">The model output.</figcaption></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es mk"><img src="../Images/a4c3c995f57f93d33b91527ce7d3ed23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*c50pnjQ3yqaxwA5Us0jdOg.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">And the functions for each of the predictors included to model the cumulative feed curve.</figcaption></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw ml la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/1a52e7cc65274a0902e4d29a0a3cbc26.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*cxhx8c1x4gi_9sKpQzZKdA.png"/></div></figure><figure class="ky jw mm la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/066487c9080ebfdb0b76580fb5702927.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*ZBOEXeR_sjcOoSS809UU5Q.png"/></div></figure><figure class="ky jw ml la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/c0d2df20f2a1973c2ccd0fa4ea6ddef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*eGxPUwzL9gpvq2SJWt_Xhg.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx mn di mo lg">Calibration plots. For some pens, the model performs much better then for other pens.</figcaption></figure></div><div class="ab cb"><figure class="ky jw mp la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/1fc97cdf14e30dac6abcfc00853084f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*F0biuBFQHDdHqCarCDbnSw.png"/></div></figure><figure class="ky jw mp la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/daa2c52c6d616840413f33ea4fd879ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*DEhDArCAswkIPKM-djsm2g.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx mq di mr lg">Residuals as density plots, and predictions per feed run (<strong class="bd ln">newField</strong>).</figcaption></figure></div><div class="ab cb"><figure class="ky jw ms la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/fd58705cf026755eb7e188cb84360c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*LP1nAOhVjUFxVTFUzWAVmw.png"/></div></figure><figure class="ky jw mt la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/fedb992c60a7021a6579efa8e0f7f284.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*9JmAVJqe98bw3HdBe8Gfhw.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx lw di lx lg">Calibration plot, overall, per feed run. To the right, the observed and predicted feed curve per feed run. The GAMs do a very nice job, but there is some intermittent demend / provision going on that the GAMs do not directly pick up. I need to keep a careful eye on that.</figcaption></figure></div><p id="4757" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，上述练习是针对提供的总累积饲料。但是，如果我们按成分来估计饲料供给呢？如你所见，我创建的所有模型都是在个体层面上运行的，然后将预测汇总，形成一条累积供给曲线。这似乎起了作用。它并不完美，但没有一个模型是完美的。</p><p id="a714" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们试试组件1的情况。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw mu la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/b531e0c9b96150ba5754d8522b458dc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*uhO_v2D4D1jWtp9cnab6jw.png"/></div></figure><figure class="ky jw mv la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/adfa0c782120988e33bc3e09de34f32e.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*TOCLm0ieXNesnCK5Xy9wFQ.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx mw di mx lg">Predictors and predictions. Not too bad.</figcaption></figure></div><div class="ab cb"><figure class="ky jw mp la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/a766f64d44dff0d151618f6c7990a1f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*-WMMzM_j3BvSh8veW6aXpg.png"/></div></figure><figure class="ky jw mp la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/a4e7cd6d19acf23d16451122a203d961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*gGLldXMJVQVxbIV2E-kxwQ.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx mq di mr lg">Predictions on the individual and the cumulative level. Easy to see how the trained data is better then than the test data, but the test data is really not that bad. Especially if you will deploy this model and re-estimate predictions daily.</figcaption></figure></div><p id="2d64" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在组件2上。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw mu la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/47964d925b87ce283e9a35a448bce8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*rGhXe4LlcOhgwZmVpcmqIw.png"/></div></figure><figure class="ky jw mv la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/51053bf539e18ea8269153c91561a392.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*tu648HzJAC8EQYWVPJhUSA.png"/></div></figure></div><div class="ab cb"><figure class="ky jw mp la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/92008a30ca6aef294b2600e42ee5eccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*iVkfCx8x-_yqN50uDIiCiA.png"/></div></figure><figure class="ky jw mp la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/f3e976aec886d169030546bb33079ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*xs_sGhn5L21wDWsolsyWuQ.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx mq di mr lg">A bit more tricky, but it does seem to do the trick. Empty oberserved values are true empty values of component 2. The model keeps predicting though because component 1 is a predictor of component 2.</figcaption></figure></div><p id="5d8b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，让我们把成分3加入到混合物中，把所有的东西加在一起，看看预测结果如何。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="er es my"><img src="../Images/c1f19271e5da95229fdf6a64e1e1a153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0XiFCj2_sPW4PxVXlcaCIw.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Component 1 and 2 together is really not that bad!</figcaption></figure><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="jx jy l"/></div></figure><div class="js jt ju jv fd ab cb"><figure class="ky jw mp la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/af730ad9e7c7afd44e165ed3391c4ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*FblwijsIh3LfsY6AlTQ8pw.png"/></div></figure><figure class="ky jw mp la lb lc ld paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><img src="../Images/2e7dc5056af415984dde24e51aecd7f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ELZ_fn73-cL4ynO3lCTcWw.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx mq di mr lg">Not bad at all! Okay, it is not perfect, but we are able to do it!</figcaption></figure></div><p id="0016" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以，这是一个小例子，说明如何使用一般的加性混合模型来估计养猪场的饲料曲线。继续，因为这只是一个很小的开始！</p><div class="mz na ez fb nb nc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hi fi z dy nh ea eb ni ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">medium.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq ke nc"/></div></div></a></div><p id="e0ef" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">🔵<a class="ae lm" rel="noopener" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"> <strong class="iy hi">成为作家</strong> </a></p></div></div>    
</body>
</html>