<html>
<head>
<title>How to use multiple linear regression in R to determine which marketing actions drives sales</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在R中使用多元线性回归来确定哪些营销行为推动了销售</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/how-to-use-multiple-linear-regression-in-r-to-determine-which-marketing-actions-drives-sales-cf733eeae28e?source=collection_archive---------0-----------------------#2021-09-01">https://medium.com/mlearning-ai/how-to-use-multiple-linear-regression-in-r-to-determine-which-marketing-actions-drives-sales-cf733eeae28e?source=collection_archive---------0-----------------------#2021-09-01</a></blockquote><div><div class="dt gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="40e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">降价会增加销量吗？</p><figure class="je jf jg jh fe ji es et paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="es et jd"><img src="../Images/00fd839723348e16cb53d7ff875a2131.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SlNTgEcs7HyKoja-8O6Hdg.jpeg"/></div></div><figcaption class="jp jq eu es et jr js bd b be z dy">My local grocery store canned goods tomato aisle</figcaption></figure><p id="c8d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用多元线性回归来确定促销、优惠券或降价是否会推动罐装番茄杂货产品的销售。继续阅读<a class="ae jt" href="https://www.amazon.com/Marketing-Analytics-Data-Driven-Techniques-Microsoft/dp/111837343X" rel="noopener ugc nofollow" target="_blank"> Wayne L. Winston的《营销分析:使用Microsoft Excel的数据驱动技术》</a>一书，我将构建一个多元线性回归模型来回答以下问题:</p><p id="cb36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.确定促销、优惠券或降价是否会影响销售。</p><p id="f707" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.预测一周内罐装西红柿的销售情况，在这一周内，你使用购物车通知、优惠券，并将价格降低1美分。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="a238" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的数据集包含超市中罐装番茄12周的销售数据。</p><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et kb"><img src="../Images/c0c200c8ad73a5d33404ff3e28cf4523.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*SdTCYP1A_iIojKu5CPyiQw.png"/></div><figcaption class="jp jq eu es et jr js bd b be z dy">Preview grocery store sales data</figcaption></figure><p id="6c73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">周:</strong>观察销售的周数。<br/> <strong class="ih hj">大车。注意:</strong>是否有促销。<br/> <strong class="ih hj">优惠券:</strong>是否有优惠券发售。<br/> <strong class="ih hj">价格。降价</strong>:提供的降价。要么不降价，要么减1分钱，要么减2分钱。<br/> <strong class="ih hj">销量:</strong>一周卖出的番茄罐头的箱数。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="37e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要通过将我们的字符变量转换为因子类型变量来准备我们的数据集，这可以在<strong class="ih hj"> <em class="kc"> Cart的一行代码中完成。注意</em> </strong>和<strong class="ih hj"> <em class="kc">息</em> </strong>变量。然而，<strong class="ih hj"> <em class="kc">的价格。Reduction </em> </strong>是一个数值变量，所以我们将单独转换这个变量。</p><pre class="je jf jg jh fe kd ke kf kg aw kh bi"><span id="e14c" class="ki kj hi ke b fj kk kl l km kn">#Convert all character variables into factor in one line: Make sure tidyverse package is loaded.<br/>grocery &lt;- grocery %&gt;% mutate_if(is.character, as.factor)</span><span id="30a5" class="ki kj hi ke b fj ko kl l km kn">#Factor Price Reduction variable<br/>grocery$Price.Reduction &lt;- as.factor(grocery$Price.Reduction)</span></pre><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et kp"><img src="../Images/7f737325717f5ab9c9ad709c33a9b388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*ZYC0n7x6CxqTSPNbbhZ1VA.png"/></div><figcaption class="jp jq eu es et jr js bd b be z dy">Transformed dataframe</figcaption></figure><p id="2700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">虚拟变量回归</strong></p><p id="44c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在回归中处理分类变量时，变量采用的值是一个标签，因此它没有数字解释。例如，我们的优惠券变量有两个标签(是或否)。由于它只能取2个值，为了将它们包含在我们的回归模型中，我们使用了一种称为虚拟变量回归的技术。</p><p id="9f9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">幸运的是，简单地将我们的变量转换为因子类型就可以标记我们的变量，所以当我们将分类变量输入到函数中时，R会自动使用其中一个分类作为参考变量。回归中所需的虚拟变量数量比分类变量中的类别数量少一个<strong class="ih hj">。</strong></p><p id="501f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">多元线性回归模型</strong></p><p id="ad37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们使用lm()函数构建多元回归模型。多元回归仅仅意味着我们的模型中有两(2)个或更多的独立变量或解释变量。我们将车型<strong class="ih hj"><em class="kc"/></strong>解释为<strong class="ih hj"> <em class="kc">【券】</em></strong><strong class="ih hj"><em class="kc">大车。注意</em> </strong>和<strong class="ih hj"> <em class="kc">价格。</em>还原</strong>。我们不需要<strong class="ih hj"> <em class="kc">周</em> </strong>列。</p><pre class="je jf jg jh fe kd ke kf kg aw kh bi"><span id="5bc6" class="ki kj hi ke b fj kk kl l km kn"># All variables with the exception of Week as an independent variable<br/>grocery_model_lm &lt;- lm(Sales ~ Coupon + Cart.Notice + Price.Reduction, data = grocery)</span></pre><p id="01fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型摘要输出:</p><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et kq"><img src="../Images/3df2c74e03d74e3c2bc76ec4852a2094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*7QkqdHbn-4p9rZmuOFKCuw.png"/></div><figcaption class="jp jq eu es et jr js bd b be z dy">Multiple linear regression output</figcaption></figure><p id="2013" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们来解读一下输出。</p><p id="8a12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">拦截</strong></p><p id="c85f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">截距是所有自变量为零时因变量(销售额)的值。在没有优惠券、没有购物车通知、没有降价的情况下，我们每周可以卖出14.5箱西红柿。</p><p id="b629" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">系数</strong></p><p id="5d26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kc">夫妻关系</em></p><p id="0a48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">CouponYes系数为-1.17(负系数)，但p值不显著；因此，我们估计的系数在统计上与0没有区别。换句话说，我们不能排除该系数的真实值为零。这意味着不管有没有优惠券促销，西红柿的销售都没有什么不同。</p><p id="6fa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kc">推车。注意事项</em></p><p id="5bf3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">推车。注意力系数为20.17(正系数)，p值具有统计学意义。当有购物车通知时，我们可以预计多卖20箱西红柿，同时保持所有其他变量在同一水平。</p><p id="cb56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kc">价格。缩减1 </em></p><p id="0582" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">价格。Reduction1系数为5(正系数)，但p值不显著；因此，我们估计的系数在统计上与0没有区别。这意味着当降价1美分时，销售没有什么不同。</p><p id="7110" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kc">价格。缩减2 </em></p><p id="a940" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">价格。缩减2系数为12.8(正系数)，p值具有统计学意义。当价格降低2美分时，我们可以预期多卖出12.8箱西红柿，而所有其他变量保持在同一水平。</p><p id="705f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">无关紧要的变量</strong></p><p id="40cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以得出结论，优惠券和1美分的降价在影响销售方面并不显著。我们将删除无关紧要的变量，并再次运行我们的回归模型。首先，我简单地创建了一个新列，将所有1美分的降价记录为0，并将这个新变量作为因子，然后检查结果。</p><pre class="je jf jg jh fe kd ke kf kg aw kh bi"><span id="516a" class="ki kj hi ke b fj kk kl l km kn">#Create new price reduction variable<br/>grocery &lt;- grocery %&gt;% <br/>    mutate(Price.Reduction_new =<br/>      case_when(<br/>        Price.Reduction == 2 ~ 2,<br/>        Price.Reduction == 1 ~ 0,<br/>        Price.Reduction == 0 ~ 0))</span><span id="50ab" class="ki kj hi ke b fj ko kl l km kn">#We need to factor Price.Reduction_new<br/>grocery$Price.Reduction_new &lt;- as.factor(grocery$Price.Reduction_new)</span><span id="8457" class="ki kj hi ke b fj ko kl l km kn">#Check levels<br/>levels(grocery$Price.Reduction_new)</span><span id="aba6" class="ki kj hi ke b fj ko kl l km kn">#Inspect results<br/>str(grocery)</span></pre><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et kr"><img src="../Images/ff660496fd84fc601465494e7e4951ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*gYS7vsC3dbNvYj-nT406JA.png"/></div><figcaption class="jp jq eu es et jr js bd b be z dy">Inspect the results of our new Price.Reduction variable</figcaption></figure><p id="0f03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">最终回归模型</strong></p><p id="65a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">仅使用重要变量构建模型，并检查模型输出。</p><pre class="je jf jg jh fe kd ke kf kg aw kh bi"><span id="7d98" class="ki kj hi ke b fj kk kl l km kn">#Model sales as explained by Cart.Notice and Price.Reduction_new<br/>grocery_model_lm_signifvars &lt;- lm(Sales ~ Cart.Notice + Price.Reduction_new, data = grocery)</span><span id="858c" class="ki kj hi ke b fj ko kl l km kn">#Print model output<br/>summary(grocery_model_lm_signifvars)</span></pre><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et ks"><img src="../Images/12ecda80c6c2c6852c60b7bab1d172fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*rq0BB7zE0CrNpfFAr729Sw.png"/></div><figcaption class="jp jq eu es et jr js bd b be z dy">Final regression summary model output with significant variables only</figcaption></figure><p id="8f99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">移除无关紧要的变量肯定会对模型拟合产生影响。</p><p id="318b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">拟合优度测量</strong></p><p id="84d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">0.855的R平方表明，在给定所有独立变量的情况下，该模型能够解释约86%的番茄销售变化。剩下的14%无法解释。</p><p id="7133" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型本身的p值为0.0001639，小于0.05，表明该模型具有预测能力。</p><p id="3e22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回归模型的剩余标准误差是5.29，并且测量我们的模型有多远。你必须解释相对于你预测的标准误差。实际上，观察销售和预测销售之间的典型差异是5.29例。只要残差是正态的，那么我们预测的68%应该落在1个标准误差内(5.29例)，95%应该准确在2个标准误差内(10.58例)。大于2个标准误差的预测将被视为异常值。</p><p id="cbd0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">值得注意的是，去除无关紧要的变量并没有改善R平方。但是如果我们看一下我们调整后的R平方，第二个模型确实改善了一点点。更重要的是，模型2确实降低了我们的剩余标准误差。如果您的目标是建立准确的预测，那么减少剩余标准误差在评估模型时变得非常重要。</p><p id="9887" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">预测销售额</strong></p><p id="afc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将预测一周内罐装西红柿的销售情况，在这一周内，你将使用购物车通知、优惠券，并将价格降低1美分。</p><p id="eafa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，创建一个新的数据框来保存我们想要预测的值<em class="kc">(样本外数据)</em>。正如我们的第一个回归模型所示，由于优惠券和1美分的降价对销售没有影响，我们将在新的数据框架中完全忽略<strong class="ih hj"> <em class="kc">优惠券</em> </strong>变量，但我们需要包括<strong class="ih hj"> <em class="kc">价格。</em> </strong>化简，但将其编码为零(0)以便符合模型。</p><pre class="je jf jg jh fe kd ke kf kg aw kh bi"><span id="f647" class="ki kj hi ke b fj kk kl l km kn"># Create new data frame and print output<br/>(new_data_02 &lt;- data.frame(Cart.Notice = "Yes", Price.Reduction_new="0"))</span></pre><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et kt"><img src="../Images/b6764c13f78ce2a99553e8452de2a00c.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*0eZXIeDxmX-klZSAP-GMtg.png"/></div><figcaption class="jp jq eu es et jr js bd b be z dy">Output of new data frame with the values we want to predict</figcaption></figure><p id="71fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其次，加载broom包，因为我们将使用augment()函数来进行预测。我们的回归模型是第一个参数，新数据框架是第二个参数。我们将使用只有显著变量的回归模型。</p><pre class="je jf jg jh fe kd ke kf kg aw kh bi"><span id="2f86" class="ki kj hi ke b fj kk kl l km kn">#Using broom package<br/>augment(grocery_model_lm_signifvars, newdata = new_data_02)</span></pre><p id="d291" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">augment函数返回一个包含名为<strong class="ih hj">的新列的tibble。拟合</strong>保存我们的预测。</p><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et ku"><img src="../Images/45338f5c10b2da082f797c8f0a989525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*U9z7GHgw5LrhCldLNM26Ig.png"/></div><figcaption class="jp jq eu es et jr js bd b be z dy">Augment function output contains a new column .fitted with our predicted sales</figcaption></figure><p id="4978" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们预计能卖出36.5箱西红柿。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="4e0c" class="kv kj hi bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">最终总结</strong></h1><p id="0ba8" class="pw-post-body-paragraph if ig hi ih b ii ls ik il im lt io ip iq lu is it iu lv iw ix iy lw ja jb jc hb bi translated">1.确定促销、优惠券或降价是否会影响销售。</p><p id="16d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">影响西红柿销售的最重要因素是提车通知，随后降价2美分。T19】</p><p id="6493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.预测一周内罐装西红柿的销售情况，在这一周内，你使用购物车通知、优惠券，并将价格降低1美分。</p><p id="0c00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="kc"> 36.5例。</em> </strong></p><p id="9520" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整代码可以在<a class="ae jt" href="https://github.com/bonheurgirl/Forecasting-in-R/blob/main/Multiple%20Linear%20Regression%20to%20Determine%20If%20a%20Price%20Cut%20Increases%20Sales.Rmd" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p></div></div>    
</body>
</html>