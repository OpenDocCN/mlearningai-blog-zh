<html>
<head>
<title>Machine learning Pipelines Explainedâœ¨ğŸ’¡!!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æœºå™¨å­¦ä¹ ç®¡é“Explainedâœ¨ğŸ’¡ï¼ï¼</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/machine-learning-pipelines-explained-ef1094fec9b3?source=collection_archive---------4-----------------------#2022-07-17">https://medium.com/mlearning-ai/machine-learning-pipelines-explained-ef1094fec9b3?source=collection_archive---------4-----------------------#2022-07-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6e27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æœ¬åšå®¢å°†å‘ä½ è§£é‡Šåœ¨æœºå™¨å­¦ä¹ é—®é¢˜ä¸­å®ç°æµæ°´çº¿çš„ç®€å•æ–¹æ³•ã€‚</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a3120624a8eb7a63ae737ba2fcf65bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*P5xgi_5JoA_edV3bainqdw.png"/></div></div></figure><blockquote class="jp jq jr"><p id="9a13" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">å› æ­¤ï¼Œé¦–å…ˆæˆ‘ä»¬å°†ä»å¯¼å…¥æ‰€æœ‰ç”¨äºæ•°æ®æ“ä½œå’Œæ•°æ®å¯è§†åŒ–çš„åŸºæœ¬åº“å¼€å§‹ï¼Œæˆ‘ä»¬å°†å¯¼å…¥æ­Œæ›²æµè¡Œåº¦é¢„æµ‹çš„<strong class="ig hi"> Kaggleæ•°æ®é›†</strong>ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="1edc" class="ka kb hh jw b fi kc kd l ke kf">import numpy as np <em class="jc"># linear algebra</em><br/>import pandas as pd <em class="jc"># data processing, CSV file I/O (e.g. pd.read_csv)<br/></em>import seaborn as sns #data visualization library<br/>import matplotlib.pyplot as plt #data visualization library</span><span id="b54e" class="ka kb hh jw b fi kg kd l ke kf">import warnings # ignoring warnings<br/>warnings.filterwarnings('ignore')<br/><br/><br/>import os<br/>for dirname, _, filenames <strong class="jw hi">in</strong> os.walk('/kaggle/input'):<br/>    for filename <strong class="jw hi">in</strong> filenames:<br/>        print(os.path.join(dirname, filename))</span><span id="cc54" class="ka kb hh jw b fi kg kd l ke kf">Output:</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/b403d239a53f644a590028be7dc4d256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*esLgJov74WeALOswtgqbNQ.png"/></div></div></figure><blockquote class="jp jq jr"><p id="2ebc" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">ç„¶åæˆ‘ä»¬å°†ä½¿ç”¨<strong class="ig hi"> pandas.read_csv() </strong>å‡½æ•°ä»è®­ç»ƒé›†å’Œæµ‹è¯•é›†è¯»å–æ•°æ®å¹¶æäº¤æ ·æœ¬ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="5fd1" class="ka kb hh jw b fi kc kd l ke kf">train=pd.read_csv("/kaggle/input/song-popularity-prediction/train.csv")<br/>test=pd.read_csv("/kaggle/input/song-popularity-prediction/test.csv")<br/>submission=pd.read_csv("/kaggle/input/song-popularity-prediction/sample_submission.csv")</span></pre><blockquote class="jp jq jr"><p id="c682" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">è¯»å–æ•°æ®é›†åï¼Œæˆ‘ä»¬å°†é€šè¿‡æŸ¥çœ‹æ•°æ®é›†ä¸­å‰äº”è¡Œå’Œæ‰€æœ‰åˆ—æ¥æµè§ˆæ•°æ®é›†ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="ea71" class="ka kb hh jw b fi kc kd l ke kf">train.head()<br/>Output:</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kh"><img src="../Images/25c21ab4ff68f4663640fea551bc58df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CYGmesBmyg6IN1ELg-qC-g.png"/></div></div></figure><blockquote class="jp jq jr"><p id="1a16" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">ç„¶åï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹æ•°æ®é›†çš„æ¯ä¸€åˆ—ä¸­æ˜¯å¦æœ‰ä»»ä½•ç©ºå€¼ï¼Œå› ä¸ºå¤§å¤šæ•°MLç®—æ³•éƒ½ä¸èƒ½å¤„ç†ç©ºå€¼ï¼Œæ‰€ä»¥ç©ºå€¼éœ€è¦é€šè¿‡æŸäº›å€¼è¿›è¡Œä¼°ç®—ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰8åˆ—éœ€è¦ä¼°ç®—ç©ºå€¼ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="ea17" class="ka kb hh jw b fi kc kd l ke kf">train.isna().sum()<br/>Output:</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/eb888c12defa27369ddd043f7c2d7a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hn4V9NcD4O4PiAg_y6wkFQ.png"/></div></div></figure><blockquote class="jp jq jr"><p id="45dc" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬å°†çœ‹åˆ°æ•°æ®é›†çš„å½¢çŠ¶ï¼Œå› ä¸ºè¯¥æ•°æ®é›†åŒ…å«<strong class="ig hi"> 28000 </strong>è¡Œå’Œ<strong class="ig hi"> 14 </strong>åˆ—ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="a508" class="ka kb hh jw b fi kc kd l ke kf">x_train.shape<br/>Output: ( 28000,14 )</span></pre><blockquote class="jp jq jr"><p id="0e9f" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">å› æ­¤ï¼Œåœ¨è·å¾—ä¸€äº›æ•°æ®åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨sklearnæ¨¡å—ä¸­çš„è®­ç»ƒå’Œæµ‹è¯•åˆ†å‰²æ•°æ®ä¸ºè®­ç»ƒæ•°æ®(70%æ•°æ®)å’ŒéªŒè¯æ•°æ®(30%æ•°æ®)ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="20a1" class="ka kb hh jw b fi kc kd l ke kf">from sklearn.model_selection import train_test_split<br/>x_train,x_test,y_train,y_test=train_test_split(train.drop("song_popularity",axis=1),train["song_popularity"],test_size=0.3,random_state=0)</span></pre><blockquote class="jp jq jr"><p id="5599" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬æ­£åœ¨å¯¼å…¥sklearnæ¨¡å—ï¼Œç”¨äºç¼–ç æ•°å€¼å’Œåˆ†ç±»å€¼ï¼Œç¼©æ”¾æ•´ä¸ªæ•°æ®é›†çš„å€¼ï¼Œå¹¶ä½¿ç”¨å†³ç­–æ ‘ç®—æ³•ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="d80f" class="ka kb hh jw b fi kc kd l ke kf">from sklearn.impute import SimpleImputer # imputing numeric values<br/>from sklearn.preprocessing import OneHotEncoder # imputing catogerical values<br/>from sklearn.preprocessing import StandardScaler # scaling values<br/>from sklearn.tree import DecisionTreeClassifier # Tree algorithm</span></pre><blockquote class="jp jq jr"><p id="b707" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬æ­£åœ¨ä»sklearnæ¨¡å—ä¸­å¯¼å…¥åˆ—è½¬æ¢å™¨å’Œç®¡é“æ¥è½¬æ¢å€¼ï¼Œå¹¶ä¸ºæˆ‘ä»¬çš„æ•´ä¸ªMLæµç¨‹åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œä»¥é¿å…æ•°æ®æ³„æ¼ï¼Œå¹¶åœ¨æ²¡æœ‰é‡å¤çš„æƒ…å†µä¸‹åˆ¶ä½œç”Ÿäº§å°±ç»ªä»£ç ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä»»ä½•éœ€è¦é¢„æµ‹çš„æ–°ç‚¹å¯ä»¥ç›´æ¥è¾“å…¥ç®¡é“ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="5bc3" class="ka kb hh jw b fi kc kd l ke kf">from sklearn.compose import ColumnTransformer #to transform column<br/>from sklearn.pipeline import Pipeline,make_pipeline # to make pipeine</span></pre><blockquote class="jp jq jr"><p id="9191" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬ä½¿ç”¨é»˜è®¤ç­–ç•¥è¾“å…¥æ‰€æœ‰ç©ºå€¼åˆ—ï¼Œå³ä½¿ç”¨åˆ—è½¬æ¢å™¨ï¼Œè¿™ä½¿å¾—è¯»å–å’Œä½¿ç”¨æ‰€æœ‰è¾“å…¥æ­¥éª¤æˆä¸ºä¸€ä¸ªåˆ—è½¬æ¢å™¨å¯¹è±¡<strong class="ig hi"> trf1 </strong>ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="69a7" class="ka kb hh jw b fi kc kd l ke kf">trf1=ColumnTransformer([<br/>    ("impute values1",SimpleImputer(),[1]),<br/>    ("impute values2",SimpleImputer(),[2]),<br/>    ("impute values3",SimpleImputer(),[3]),<br/>    ("impute values4",SimpleImputer(),[4]),<br/>    ("impute values5",SimpleImputer(),[5]),<br/>    ("impute values7",SimpleImputer(),[7]),<br/>    ("impute values8",SimpleImputer(),[8])],remainder="passthrough")</span></pre><blockquote class="jp jq jr"><p id="8ac2" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬ä½¿ç”¨column transformeré€šè¿‡ä¸€ä¸ªçƒ­ç¼–ç è¾“å…¥æ‰€æœ‰åˆ†ç±»å€¼åˆ—ï¼Œè¿™ä½¿å¾—è¯»å–å’Œä½¿ç”¨æ‰€æœ‰è¾“å…¥æ­¥éª¤æˆä¸ºä¸€ä¸ªåˆ—è½¬æ¢å™¨å¯¹è±¡<strong class="ig hi"> trf2 </strong>ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="a7ef" class="ka kb hh jw b fi kc kd l ke kf">trf2=ColumnTransformer([<br/>    ("OHE values6",OneHotEncoder(sparse=False,handle_unknown="ignore"),[6])]<br/>    ,remainder="passthrough")</span></pre><blockquote class="jp jq jr"><p id="f158" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬ä½¿ç”¨åˆ—è½¬æ¢å™¨é€šè¿‡æ ‡å‡†ç¼©æ”¾å™¨å¯¹è±¡ç¼©æ”¾æ‰€æœ‰åˆ—ï¼Œè¿™ä½¿å¾—è¯»å–å’Œä½¿ç”¨æ‰€æœ‰è¾“å…¥æ­¥éª¤æˆä¸ºä¸€ä¸ªåˆ—è½¬æ¢å™¨å¯¹è±¡<strong class="ig hi"> trf3 </strong>ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="3b75" class="ka kb hh jw b fi kc kd l ke kf">trf3=ColumnTransformer([<br/>    ("Scale",StandardScaler(),slice(0,19))])</span></pre><blockquote class="jp jq jr"><p id="d016" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬ä½¿ç”¨å†³ç­–æ ‘åˆ†ç±»å™¨ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨åˆ—è½¬æ¢å™¨ï¼Œè¿™ä½¿å¾—è¯»å–å’Œä½¿ç”¨æ‰€æœ‰æ­¥éª¤æˆä¸ºä¸€ä¸ªåˆ—è½¬æ¢å™¨å¯¹è±¡å˜å¾—å®¹æ˜“ï¼Œå¦‚<strong class="ig hi"> trf4 </strong>ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="45d2" class="ka kb hh jw b fi kc kd l ke kf">trf4=DecisionTreeClassifier()</span></pre><blockquote class="jp jq jr"><p id="f8d3" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ‰€æœ‰åˆ—è½¬æ¢å™¨åˆ¶ä½œæˆä¸€ä¸ªåä¸ºpipeçš„ç®¡é“ï¼Œé¡ºåºä»1åˆ°4ï¼Œè¿™æ ·ï¼Œæ‰€æœ‰æ­¥éª¤éƒ½å°†ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°ä¼ é€’åˆ°æ¯ä¸ªåˆ—è½¬æ¢å™¨ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªåˆ—è½¬æ¢å™¨ä¸Šæ‰§è¡Œä¸€ä¸ªç‰¹å¾å·¥ç¨‹æ­¥éª¤ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="d328" class="ka kb hh jw b fi kc kd l ke kf">pipe=Pipeline([<br/>    ('trf1',trf1),<br/>    ('trf2',trf2),<br/>    ('trf3',trf3),<br/>    ('trf4',trf4),<br/>])</span></pre><blockquote class="jp jq jr"><p id="e7e9" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">è¿™é‡Œæˆ‘ä»¬ç”¨sklearnæ¨¡å—ä¸­çš„set_configæ¨¡å—æ˜¾ç¤ºæˆ‘ä»¬çš„ç®¡é“ï¼Œå½“æˆ‘ä»¬è°ƒç”¨fitå‡½æ•°æ—¶ï¼Œç®¡é“å°±æ˜¾ç¤ºåœ¨è¿™é‡Œã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="7d14" class="ka kb hh jw b fi kc kd l ke kf">from sklearn import set_config<br/>set_config(display="diagram")</span></pre><blockquote class="jp jq jr"><p id="29fc" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ç®¡é“å¯¹è±¡æ‹Ÿåˆæ•°æ®ï¼Œä½¿ç”¨x_trainå’Œy_trainè¿›è¡Œæ‰€æœ‰ç‰¹å¾å·¥ç¨‹å’Œæ¨¡å‹æ‹Ÿåˆæ­¥éª¤ã€‚</p><p id="bb9f" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">è¾“å‡ºéå¸¸ç›´è§‚åœ°æ˜¾ç¤ºæ‰€æœ‰ç‰¹å¾å·¥ç¨‹å’Œæ¨¡å‹æ‹Ÿåˆæ­¥éª¤ï¼Œä»¥äº†è§£æ•´ä¸ªç®¡é“ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="5202" class="ka kb hh jw b fi kc kd l ke kf">pipe.fit(x_train,y_train)<br/>Output:</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kj"><img src="../Images/6858d0068bba65f7013723a90b00191c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DxpyxopUjfReA6PphPhjCw.png"/></div></div></figure><blockquote class="jp jq jr"><p id="cb9e" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬ä½¿ç”¨ç®¡é“å¯¹è±¡é¢„æµ‹éªŒè¯ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨y_predä¸­ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="8c23" class="ka kb hh jw b fi kc kd l ke kf">y_pred=pipe.predict(x_test)</span></pre><blockquote class="jp jq jr"><p id="c4c9" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬æ­£åœ¨å¯¼å…¥<strong class="ig hi"> ROC AUCå¾—åˆ†</strong>æŒ‡æ ‡ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œéœ€è¦å°†å„ä¸ªç±»åˆ«åˆ†å¼€ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="0148" class="ka kb hh jw b fi kc kd l ke kf">from sklearn.metrics import roc_auc_score <br/>roc_auc_score(y_test,y_pred)</span><span id="7771" class="ka kb hh jw b fi kg kd l ke kf">Output: 0.5</span></pre><blockquote class="jp jq jr"><p id="6b29" class="ie if jc ig b ih ii ij ik il im in io js iq ir is jt iu iv iw ju iy iz ja jb ha bi translated">æˆ‘ä»¬å°†æ¨¡å‹çš„é¢„æµ‹æäº¤åˆ°æäº¤æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬æ²¡æœ‰å¾—åˆ°å¥½çš„<strong class="ig hi"> ROC AUCåˆ†æ•°ï¼Œ</strong>è¿™ä¸ªåšå®¢çš„ç›®æ ‡æ˜¯æ•™å¯¼ä½¿ç”¨ç®¡é“å’Œåˆ—è½¬æ¢å™¨è§£å†³MLé—®é¢˜ã€‚</p></blockquote><pre class="je jf jg jh fd jv jw jx jy aw jz bi"><span id="a94a" class="ka kb hh jw b fi kc kd l ke kf">pred=pipe.predict(test)<br/>test['song_popularity'] = pred<br/>submission = test[['id', 'song_popularity']]<br/>submission.to_csv('submission.csv', index=False)</span></pre><p id="6257" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å¦‚æœä½ æƒ³çœ‹Kaggleç¬”è®°æœ¬çš„å…¨éƒ¨ä»£ç ï¼Œè¯·ç‚¹å‡»è¿™é‡Œçš„é“¾æ¥<a class="ae kk" href="https://www.kaggle.com/code/mahendragundeti/pipelines-approach-in-ml" rel="noopener ugc nofollow" target="_blank"/>ã€‚</p><p id="e649" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æ„Ÿè°¢é˜…è¯»ï¼</p><p id="79a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å…³æ³¨æˆ‘äº†è§£æ›´å¤šå…³äºDSå’ŒMLçš„å†…å®¹ã€‚</p><div class="kl km ez fb kn ko"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kp ab dw"><div class="kq ab kr cl cj ks"><h2 class="bd hi fi z dy kt ea eb ku ed ef hg bi translated">Mlearning.aiæäº¤å»ºè®®</h2><div class="kv l"><h3 class="bd b fi z dy kt ea eb ku ed ef dx translated">å¦‚ä½•æˆä¸ºMlearning.aiä¸Šçš„ä½œå®¶</h3></div><div class="kw l"><p class="bd b fp z dy kt ea eb ku ed ef dx translated">medium.com</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc jn ko"/></div></div></a></div></div></div>    
</body>
</html>