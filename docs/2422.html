<html>
<head>
<title>Understanding a Linear Regression Algorithm with Example.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用实例理解线性回归算法。</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/understanding-a-linear-regression-algorithm-with-example-6c3f285c2100?source=collection_archive---------4-----------------------#2022-04-30">https://medium.com/mlearning-ai/understanding-a-linear-regression-algorithm-with-example-6c3f285c2100?source=collection_archive---------4-----------------------#2022-04-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/052ea6e9158980a6cec2fd3d2c32c524.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/0*ccl1bJPjquPn5_qe.png"/></div><figcaption class="il im et er es in io bd b be z dx">source- pinterest</figcaption></figure><h2 id="67f3" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">本文中使用的数据集和笔记本可以在这里找到:</h2><p id="7ebc" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">完整笔记本链接:<a class="ae ki" href="https://github.com/Jnjerry/Multiple-Linear-Regression--Ecommerce-Analysis/blob/main/Customer%20Spending.ipynb" rel="noopener ugc nofollow" target="_blank">多元线性回归模型</a></p><p id="3b3c" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">数据集链接:<a class="ae ki" href="https://github.com/Jnjerry/Multiple-Linear-Regression--Ecommerce-Analysis/blob/main/Ecommerce%20Customers.csv" rel="noopener ugc nofollow" target="_blank">电子商务客户</a></p><h1 id="1012" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">让我们从几个场景的线性回归开始:</h1><ul class=""><li id="675f" class="lf lg hh jp b jq jr ju jv ja lh je li ji lj kh lk ll lm ln bi translated">金融公司预测导致客户贷款违约的主要因素。</li><li id="3006" class="lf lg hh jp b jq lo ju lp ja lq je lr ji ls kh lk ll lm ln bi translated">体育公司分析训练的哪些变化对运动员的表现有影响。</li><li id="c03b" class="lf lg hh jp b jq lo ju lp ja lq je lr ji ls kh lk ll lm ln bi translated">影响一个国家经济增长的因素。</li><li id="642f" class="lf lg hh jp b jq lo ju lp ja lq je lr ji ls kh lk ll lm ln bi translated">预测股票价格。</li></ul><p id="f379" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">上述场景是现实生活中的用例，我们在<strong class="jp hi">一个或多个数值变量</strong>的基础上预测一个<strong class="jp hi">数值变量</strong>。这些变量通常绘制在X轴和Y轴上，如下图所示。</p><p id="15c1" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">例如，下图向我们展示了客户在应用程序上花费的<strong class="jp hi">时间</strong>和他们花费的<strong class="jp hi">金额</strong>之间的关系。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es lt"><img src="../Images/52604b60fb5f661264a9e1de0cb33dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1EOrMA8JSnTIMWrZ7amocw.png"/></div></div><figcaption class="il im et er es in io bd b be z dx">Linear Regression Graph</figcaption></figure><p id="0a6c" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">线性回归试图<strong class="jp hi">研究一种趋势或模式</strong>，然后基于此我们可以预测一个输出。例如，在上图中，我们的线性回归是通过以下步骤实现的</p><ul class=""><li id="5d57" class="lf lg hh jp b jq kj ju kk ja mc je md ji me kh lk ll lm ln bi translated">利用历史数据，我们在x轴<strong class="jp hi">上绘制了人们在应用上花费的时间</strong>，在y轴上绘制了他们在应用上花费的时间。</li><li id="0cf9" class="lf lg hh jp b jq lo ju lp ja lq je lr ji ls kh lk ll lm ln bi translated">然后，我们绘制一条尽可能接近我们所有点的线，称为最佳拟合线<strong class="jp hi"/>。</li><li id="cb26" class="lf lg hh jp b jq lo ju lp ja lq je lr ji ls kh lk ll lm ln bi translated">然后，我们将使用这条最佳路线来帮助我们预测数量。如果我们有一个不在最佳拟合线上的观察值，那么我们将<strong class="jp hi">外推</strong>这条线来找到我们的预测值。</li></ul><p id="8d98" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">在数学语言中，这条最佳拟合线可以通过方程y=mx+c来表示和推导。</p><p id="4e03" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">假设你想预测一个客户在我们公司花费的<strong class="jp hi">年金额</strong>，给定客户在App上的<strong class="jp hi">时间</strong>和<strong class="jp hi">会员资格年限(年)</strong>。</p><p id="b943" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi">App上的时间</strong>和<strong class="jp hi">隶属长度</strong>将称为<strong class="jp hi">自变量</strong>。这意味着它们的价值不受其他变量的影响。</p><p id="4f3f" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">然而，<strong class="jp hi">年金额</strong>将被称为<strong class="jp hi">因变量</strong>，这意味着其值根据自变量而变化，在这种情况下，App上的<strong class="jp hi">时间</strong>和<strong class="jp hi">会员资格长度(年)</strong>。</p><p id="711d" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">因此，在我们的上下文中，等式y=mx+c将被解释为App  + <strong class="jp hi"> m2 </strong> * <strong class="jp hi">成员资格长度</strong> + <strong class="jp hi"> c. </strong>上的<strong class="jp hi">年度金额</strong> = <strong class="jp hi"> m1 </strong> * <strong class="jp hi">时间</strong></p><h1 id="a063" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">方程式分解</h1><p id="5e46" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated"><strong class="jp hi">每年金额</strong>=<strong class="jp hi">m1</strong>*<strong class="jp hi">App上时间</strong> + <strong class="jp hi"> m2 </strong> * <strong class="jp hi">会员年限</strong> + <strong class="jp hi"> c. </strong></p><p id="01cd" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi"> c </strong>换句话说叫做<strong class="jp hi"> y轴截距</strong>(图形与y轴相交的点)。在这种情况下，我们的y截距是350美元。这意味着任何客户消费的最低金额预计为350美元。</p><p id="65df" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">m1和m2是系数。我们将在本文后面看到系数的含义。</p><h1 id="8545" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">例子</h1><p id="e81f" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">假设你被一家电子商务公司聘用为他们的数据科学家。该公司正试图:</p><ul class=""><li id="1c33" class="lf lg hh jp b jq kj ju kk ja mc je md ji me kh lk ll lm ln bi translated">在新的营销和财务策略中，决定是否将精力和资源集中在移动应用体验或网站上。</li><li id="658a" class="lf lg hh jp b jq lo ju lp ja lq je lr ji ls kh lk ll lm ln bi translated">确定哪些因素对客户的年度支出影响最大。</li></ul><p id="a659" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">这家商店有店内服装建议环节，以特征(平均值)表示。会话长度)。</p><p id="5f44" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">我们将使用此<a class="ae ki" href="https://github.com/Jnjerry/Multiple-Linear-Regression--Ecommerce-Analysis/blob/main/Ecommerce%20Customers.csv" rel="noopener ugc nofollow" target="_blank">数据集</a>根据如下所示的总体特征中的相关特征来预测客户每年的消费金额。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mf"><img src="../Images/3d25b32d7b724bfaa18bd09380f5a982.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCgU7E6ByAPpWeTNhXvpRA.png"/></div></div></figure><h1 id="3645" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated"><strong class="ak"> #检测连续变量</strong></h1><p id="9c6b" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">线性回归找出连续变量之间的关系。这意味着我们只需要包括数值，而不是分类变量。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es mg"><img src="../Images/deae66f5125d3ddf4168da98a0d898e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*57JqwjUqqNUT-_AlNy8y9Q.png"/></div></figure><p id="9a5c" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">我们现在只有连续的变量在我们的数据框架中，删除了电子邮件、地址和头像列。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mh"><img src="../Images/d60facf78330c294a7c1138d15cd6019.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*PgJZe5HTII33y0qtwjTGMw.png"/></div></div></figure><h1 id="b9de" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated"><strong class="ak"> #然后我们需要检查丢失的值</strong></h1><p id="fca7" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">数据中缺少值会导致模型性能不佳。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es mi"><img src="../Images/98da82b9180b07801c4297ad2c40db61.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*a4bUnhH9E_-Dw3v19suNcg.png"/></div></figure><p id="e563" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">我们的模型没有缺失值。但是，如果我们有缺失的价值观，我们可以用这些主要方法之一或组合来处理它们:</p><ul class=""><li id="dbcb" class="lf lg hh jp b jq kj ju kk ja mc je md ji me kh lk ll lm ln bi translated">摆脱列中有大量缺失值的客户。</li><li id="2e6a" class="lf lg hh jp b jq lo ju lp ja lq je lr ji ls kh lk ll lm ln bi translated">去掉整个属性或删除整个列。</li><li id="5c95" class="lf lg hh jp b jq lo ju lp ja lq je lr ji ls kh lk ll lm ln bi translated">将缺失值设置为某个值(零、平均值、中间值等。).</li></ul><h1 id="a585" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated"><strong class="ak"> #检测目标变量</strong></h1><p id="0703" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">在我们的数据集中，目标变量很容易识别和处理。我们的<strong class="jp hi">目标变量</strong>是<strong class="jp hi">每年花费的金额</strong>，这是在给定我们数据框架中所有或部分独立变量的情况下，我们希望能够预测的值。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es mj"><img src="../Images/db56bcc343142a1af107c148a114bd30.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*auxlceNKblTLLeMClqdm_Q.png"/></div></figure><h1 id="bf80" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated"><strong class="ak"> #检测线性关系</strong></h1><p id="c6d3" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">我们的自变量和因变量之间必须存在线性关系，这样我们才能继续使用回归分析来分析数据集。这可以用散点图来证实。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mk"><img src="../Images/5dce5856198a96bd2efcbc4cb23b1896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ohOCkcS3uulGY5fusfuZEQ.png"/></div></div></figure><p id="cdb1" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">我们的自变量随着因变量的增加而增加。这很好，我们可以继续我们的分析。</p><h1 id="5d84" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#检测异常值</h1><p id="6793" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">异常值代表太小或太大的数据点。它可以通过夸大错误率来影响模型。如果数据中有异常值，则删除它们，或者用平均值或中值替换它们。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es ml"><img src="../Images/7a7f7a2149fe398d929e92deae2419b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VH0AkDGz3Kq5Cq-Nf0d0OQ.png"/></div></div></figure><p id="002e" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">对于我们的特性，我们将删除那些属性高于0.999分位数的客户，这可以解释为高度异常的数据点。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es mm"><img src="../Images/5921174d6be7ddde860c23363f9db400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*IfWDRxRcMS2zeX5Z5-02jQ.png"/></div></figure><p id="b84f" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">从计数输出中，剔除了4个数据点高度异常的客户。</p><h1 id="0c34" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#检查数据点的正态分布。</h1><p id="4fe4" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">为了进行线性回归，我们的数据点需要围绕真实平均值对称分布。我们可以通过绘制分布图来检查分布情况。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mn"><img src="../Images/e505372a67b8d43cb095cb27f4a2895d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HeqT7XJlz0PN8Ycip_rfNg.png"/></div></div></figure><p id="b465" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">如果数据不正常，执行数据转换以减少其偏斜度。</p><p id="8056" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">负偏差数据需要幂变换或指数变换。相反，正偏差数据需要对数变换或平方根变换。</p><h1 id="ae56" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#检测相关性</h1><p id="cb23" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">相关性衡量变量之间的关系。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mo"><img src="../Images/a367f4b8c1d2330fdc3d3a76c3a97164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zi9ECWfJMuY3BjF6vPXCYw.png"/></div></div></figure><h1 id="539d" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#按照自变量与因变量的相关性顺序排列自变量。</h1><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es mp"><img src="../Images/596a519d1a40de59c9fb04174e4ba3b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*P4bZ7YGjL4zK8wlVZsOd0A.png"/></div></figure><p id="3ee0" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">会员资格的长短和在App上的时间对每年花费的金额影响最大。</p><p id="8e1b" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">相关性衡量两个变量之间的关系。当这两个变量高度相关，可以相互解释(以至于可以用一个变量预测另一个变量)，那么我们就有共线性。</p><p id="8f19" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">数据中必须很少或没有多重共线性。</p><h1 id="ddf7" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#检查独立变量之间的相关性</h1><p id="c148" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">我们丢弃相关性为1.0的结果，这表明我们正在处理自相关。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mq"><img src="../Images/e44181aa9a417f4b407f1164d999e71f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Twgtkvf7Ab4j9CjlHSHtbg.png"/></div></div></figure><p id="5d52" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">我们没有任何产出，因此我们没有任何相互高度相关的独立变量，这就是我们想要的情景。</p><h1 id="658c" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#定义我们的自变量X和因变量y</h1><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mr"><img src="../Images/9fdf51d2ecdefc660709478329cd2459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b7TeJFS0otTcmttFFW5JCg.png"/></div></div></figure><h1 id="8be0" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#将数据分为训练数据和测试数据</h1><p id="a057" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">我们只在部分数据上训练我们的模型，因为并保留其余的(测试数据)来评估我们模型的质量。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es ms"><img src="../Images/6b599d2654bfeadc45b661f02b154b55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n2EhCM9lNAbpv3l_kSENdA.png"/></div></div></figure><h1 id="719f" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#标准化数据</h1><p id="094e" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">进行特征缩放是为了标准化在量值和单位上有很大差异的特征。这包括:kNN算法、kMeans聚类(欧几里德距离)、线性回归、逻辑回归和SVM。</p><p id="1a18" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi"> NB-缩放通常用于x轴变量，而不需要用于目标变量。</strong></p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mt"><img src="../Images/49f6560e5b377c5a01bd58d8ef87ff26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTt-uOw363AZY5FKWOlVpg.png"/></div></div></figure><h1 id="a7c4" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#根据训练数据训练模型(拟合模型)</h1><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es mt"><img src="../Images/16521e3cb47efd554f41ffcd9712801a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rkG8ES02H6syYtUpJyfktA.png"/></div></div></figure><h1 id="c860" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#使用统计模型</h1><p id="ce30" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">我们将使用统计模型库，它将探索我们的数据，并执行统计测试和估计统计模型。</p><pre class="lu lv lw lx fd mu mv mw mx aw my bi"><span id="e637" class="ip iq hh mv b fi mz na l nb nc">import statsmodels.api as sm</span></pre><p id="5762" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">导入统计模型后，我们将把它放入我们的训练数据中。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es nd"><img src="../Images/a74ae265621d5b88672b6b12343624f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XrNX7G36gKI1swODhDGFHg.png"/></div></div></figure><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es ne"><img src="../Images/82155c2a12dfbca5d2e1b15968a7be00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*6f9LwtMuNPvHHzO73m5qwQ.png"/></div></figure><p id="6030" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">y_pred输出是我们对模型的预测。这些预测将与实际y_test(保留值)进行比较，以使用R平方和调整后R平方等方法评估我们的模型。</p><h1 id="5c42" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#使用statsmodel的模型性能总结</h1><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es nf"><img src="../Images/ee5dc37c8f61bf72c7e221b9a1811cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*ES6_b4IIgHiRSt0rX8dGmg.png"/></div></figure><h1 id="7f1c" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">解释</h1><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es ng"><img src="../Images/8fa992f92b843177e697f74677cd0187.png" data-original-src="https://miro.medium.com/v2/resize:fit:238/format:webp/1*bXvP_YPScq9wP0OWD07A3w.png"/></div></figure><p id="2c56" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi">常量501 </strong>是我们的y轴截距。这意味着任何客户每年消费的最低金额预计为501美元。</p><p id="e4fa" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi"> x1 </strong>是我们的变量<strong class="jp hi"> Avg。会话长度。</strong>这是一个回归系数。这意味着，平均而言，每增加一次客户会话时间，客户每年的消费金额就会增加24.5649美元。</p><p id="b856" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi"> x2 </strong>是我们在App 上的变量<strong class="jp hi">时间。这是回归系数。这意味着，平均而言，客户在应用上每多花一分钟，每年的消费金额就会增加38.7219美元。</strong></p><p id="da06" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi"> x3 </strong>是我们的变量<strong class="jp hi">成员资格的长度</strong>。这是回归系数。这意味着，平均而言，随着客户会员资格的延长，客户每年的消费金额将增加58.3532美元。</p><p id="df4f" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi"> x4 </strong>是我们在网站上的变量<strong class="jp hi">时间。</strong>这是回归系数。这意味着，平均而言，客户在网站上每多花一分钟，客户每年的消费金额就会增加0.312美元。</p><h1 id="6ef2" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#我们的系数和业务问题的结论？</h1><p id="0685" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">在网站上花费的<strong class="jp hi">时间似乎对<strong class="jp hi">年花费金额(0.312美元)</strong>影响不大</strong></p><p id="f022" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">App上的<strong class="jp hi">时间</strong>对顾客消费的影响更大。</p><p id="4074" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">你对公司有什么建议？也许顾客在网站上的体验不好，他们可以做一个调查，问顾客为什么不喜欢在网站上购买产品。</p><p id="286f" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">会员资格的长短对顾客每年的花费影响最大。</p><h1 id="c335" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#假设检验和P值</h1><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es nh"><img src="../Images/4fcf5cc7184d514093221d7493231eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*TodyoGnVyikau-V3h1fNtA.png"/></div></figure><p id="147b" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">p值为0，意味着<strong class="jp hi">零假设被拒绝</strong>并且我们的测试具有统计显著性<strong class="jp hi">。</strong></p><p id="d744" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">p值越小，我们应该拒绝零假设的证据就越强。</p><p id="b4fe" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi"> <em class="ni"> R平方</em> </strong> —这是用来衡量独立变量的变化可以解释多少结果的变化。它也被称为模型的拟合优度。</p><p id="3cbf" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">其值的范围是从0到1，其中0表示结果不能由任何独立变量预测，1表示结果可以由独立变量预测而没有误差</p><p id="7461" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">我们的R-Square是0.983或98.3%，这意味着98.3%的“Y <strong class="jp hi">早期花费金额</strong>”可以用“<strong class="jp hi">平均值来解释。会话时长</strong>、<strong class="jp hi">应用时间、【会员时长】和</strong>网站时间。</p><p id="47ce" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">然而，我想指出的是。这并不意味着我们的模型有98.3%的准确性。低R平方值表明我们的自变量不能解释因变量的变化。</p><p id="7c23" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi">调整后的R平方</strong></p><p id="e971" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">r平方是确定模型与因变量拟合程度的一个好方法。然而，它没有考虑过拟合问题。如果您的回归模型有许多独立变量，由于模型太复杂，它可能非常适合定型数据，但对于测试数据来说表现很差。</p><p id="9693" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">引入调整的R平方是因为它惩罚了添加到我们模型中的任何额外的独立变量，并调整了度量以防止过度拟合问题。</p><p id="ab9d" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi">注意:调整后的R平方应始终低于或等于R平方</strong></p><p id="80dd" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">我们调整后的R平方也是0.983或98.3%，这意味着98.3%的“Y <strong class="jp hi">早期花费金额</strong>”可以用“<strong class="jp hi">平均”来解释。“会话时长</strong>”、“App上的<strong class="jp hi">时间”、“会员时长”和“网站上的时间</strong>”。</p><p id="df91" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated"><strong class="jp hi"> <em class="ni">问题？计算并解释平均绝对误差、均方误差和均方根误差。</em> </strong></p><h1 id="4995" class="ko iq hh bd ir kp kq kr iv ks kt ku iz kv kw kx jd ky kz la jh lb lc ld jl le bi translated">#我们还可以做些什么来提高我们的模型性能？答案:超参数调谐</h1><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="er es nj"><img src="../Images/1e469f0769c0f7f81075d442aa02c54f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LFocoR_aZmVF_td6pZ0ing.png"/></div></div></figure><p id="d487" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">我们已经结束了我们的线性回归文章，并看到了我们如何将业务问题应用到模型中，并从统计角度结束我们的分析。我们还看到了在处理线性回归模型时需要注意的事项，如相关性、异常值、分布等。</p><p id="959b" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">完整笔记本链接:<a class="ae ki" href="https://github.com/Jnjerry/Multiple-Linear-Regression--Ecommerce-Analysis/blob/main/Customer%20Spending.ipynb" rel="noopener ugc nofollow" target="_blank">多元线性回归模型</a></p><p id="0d19" class="pw-post-body-paragraph jn jo hh jp b jq kj js jt ju kk jw jx ja kl jz ka je km kc kd ji kn kf kg kh ha bi translated">数据集链接:<a class="ae ki" href="https://github.com/Jnjerry/Multiple-Linear-Regression--Ecommerce-Analysis/blob/main/Ecommerce%20Customers.csv" rel="noopener ugc nofollow" target="_blank">电子商务客户</a></p><div class="nk nl ez fb nm nn"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="no ab dw"><div class="np ab nq cl cj nr"><h2 class="bd hi fi z dy ns ea eb nt ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nu l"><h3 class="bd b fi z dy ns ea eb nt ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nv l"><p class="bd b fp z dy ns ea eb nt ed ef dx translated">medium.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob ij nn"/></div></div></a></div></div></div>    
</body>
</html>