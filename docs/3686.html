<html>
<head>
<title>Pytorch &amp; C++ #6: Bert Text Classification in C++</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">py torch &amp; c++ # 6:c++中的Bert文本分类</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/pytorch-c-6-bert-text-classification-in-c-b5d94350f564?source=collection_archive---------1-----------------------#2022-10-09">https://medium.com/mlearning-ai/pytorch-c-6-bert-text-classification-in-c-b5d94350f564?source=collection_archive---------1-----------------------#2022-10-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/2df193ef8fcb85dc3308b62b246c4add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CCzSulsaZvXvQktwYMRTPw.png"/></div></div></figure><h1 id="0ff0" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">介绍</h1><p id="0e78" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">我试图在这个系列中提供Pytorch c++ API的例子/实践/项目。如果你是这个系列的新手，你可以在潜水前查看<a class="ae kl" rel="noopener" href="/@yozkose3/pytorch-c-intro-b50571762162">的第一篇博客</a>。在这个故事中，我们将训练一个Bert模型来分类推文是否具有攻击性。所有代码都可以在<a class="ae kl" href="https://github.com/EmreOzkose/pytorch_cpp" rel="noopener ugc nofollow" target="_blank">这个Github repo </a>中找到。</p><h1 id="d6a2" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">内容</h1><ol class=""><li id="5a96" class="km kn hh jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">用Python训练Bert模型</li><li id="1677" class="km kn hh jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">C++中的推理</li></ol><h1 id="043d" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">用Python训练Bert模型</h1><p id="0125" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">我们将使用<a class="ae kl" href="https://github.com/t-davidson/hate-speech-and-offensive-language" rel="noopener ugc nofollow" target="_blank">仇恨言论检测数据集</a>。该数据集包含被标记为仇恨言论、攻击性语言或两者都不是的推文。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="80f9" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">在将数据作为pandas数据帧读取后，我们应该创建数据加载器。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="b5c8" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">我们将使用预先训练的Bert和相应的标记器。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="ce89" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">我们将用保存的<code class="du ll lm ln lo b">bert_cased_vocab.txt</code>创建一个C++词汇表。在创建了数据库和模型之后，我们就可以开始训练了。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="4a82" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">训练精度和损耗如下。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lp"><img src="../Images/61b8833bef3f1907c691e16e3d5b3985.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*Oh51Yug9cyFM9NHXjCekwQ.png"/></div></figure><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lp"><img src="../Images/117b4788b339968b482da9d359e27156.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*GM0xkiUeHeil6bASJA_aOg.png"/></div></figure><p id="8d0e" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">既然是教程，我觉得这些结果已经足够漂亮了。训练之后，我们应该导出我们的分类模型，以便在c++中使用。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><h1 id="fb81" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">C++中的推理</h1><p id="f194" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">首先，我们将创建一个词汇表。为此，我们将读取<code class="du ll lm ln lo b">bert_cased_vocab.txt</code>并创建一个地图对象。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="cef4" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">我们将把这个vocab存储在一个模型结构中。模型结构还包含加载模型函数和必要的变量。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/367aae125d48043160f5a7ad655a4d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BS83lDNZE4NfVirLBmscKA.png"/></div></div></figure><p id="27b6" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">现在，我们正在定义模型。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="76c5" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">我们必须对给定的输入文本做一些预处理。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="6249" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">现在，我们已经准备好给模型输入这些信息了。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><h1 id="f189" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">结论</h1><p id="48b5" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在这篇博客中，我们训练了一个Bert模型来分类攻击性的推文，并在c++中使用了这个训练好的模型。所有代码都可以在<a class="ae kl" href="https://github.com/EmreOzkose/pytorch_cpp" rel="noopener ugc nofollow" target="_blank">这个Github Repo </a>中找到。</p><div class="lr ls ez fb lt lu"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lv ab dw"><div class="lw ab lx cl cj ly"><h2 class="bd hi fi z dy lz ea eb ma ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mb l"><h3 class="bd b fi z dy lz ea eb ma ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mc l"><p class="bd b fp z dy lz ea eb ma ed ef dx translated">medium.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi in lu"/></div></div></a></div></div></div>    
</body>
</html>