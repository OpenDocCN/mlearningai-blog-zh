<html>
<head>
<title>Chatbot Using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习的聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/chatbot-using-deep-learning-2c648a733c6d?source=collection_archive---------4-----------------------#2021-05-04">https://medium.com/mlearning-ai/chatbot-using-deep-learning-2c648a733c6d?source=collection_archive---------4-----------------------#2021-05-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/59f7a7e6e3ace3f02b5683fb6d280658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8v1xC0NTgoduh_ei9F7Pw.png"/></div></div></figure><p id="d1d9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">什么是聊天机器人？</p><p id="0356" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">聊天机器人是一个使用自然语言与用户交互的对话代理。它也经常被描述为人类和机器之间互动的一种表达。在后端，它识别用户的请求并返回响应。</p><p id="844e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">背景</strong></p><p id="41f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">第一个聊天机器人是1966年在麻省理工学院开发的，名为ELIZA。伊莱扎是一个简单的决策树问题，它回答了几个问题。现在，它已经发展到日常生活中，包括messenger应用程序、语音助手等等。聊天机器人正在迅速取代人类提供技术支持和客户服务。</p><p id="4ba6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">好处</strong></p><p id="dba6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">每个企业的网站或应用程序都需要一个聊天机器人。甚至私营部门和其他公司也需要聊天机器人来为他们的客户服务。聊天机器人可以用24小时服务取代客户服务代理，并帮助企业节省资金。</p><p id="ab20" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你想查看我对这个项目的介绍，这里有<a class="ae jn" href="https://www.youtube.com/watch?v=cg_5bDdfCSw&amp;ab_channel=tenzinwangdu" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><h1 id="1fb5" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">创建聊天机器人的不同方法</strong></h1><ul class=""><li id="c9f9" class="km kn hh ir b is ko iw kp ja kq je kr ji ks jm kt ku kv kw bi translated">创建一定数量的模式和响应</li><li id="a2f0" class="km kn hh ir b is kx iw ky ja kz je la ji lb jm kt ku kv kw bi translated">使用RASA框架</li><li id="12b7" class="km kn hh ir b is kx iw ky ja kz je la ji lb jm kt ku kv kw bi translated">创建自己的框架</li></ul><h2 id="e511" class="lc jp hh bd jq ld le lf ju lg lh li jy ja lj lk kc je ll lm kg ji ln lo kk lp bi translated"><strong class="ak">创建您自己的数据/意图</strong></h2><p id="7700" class="pw-post-body-paragraph ip iq hh ir b is ko iu iv iw kp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated">我的笔记本第一种方法是<a class="ae jn" href="https://github.com/tw1270/Chatbot/blob/master/Different%20types%20of%20Chatbot/twitter_chatbot/Apple%20Chatbot.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="be27" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">意图是用户输入的文本的类别。例如，“嗨”是一种问候，“你能为我做些什么？”会有所帮助。您可以为不同的目的创建不同的意图。这是一个很好的常见问题解答，并且很容易创建，你可以创建不同的回答。这是</p><h1 id="8e9a" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">第一步:根据您想要的FAQ类型创建意图</strong></h1><p id="d2a0" class="pw-post-body-paragraph ip iq hh ir b is ko iu iv iw kp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated">下面是我创建的一个简短的苹果股价常见问题。</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lt"><img src="../Images/41061ad90254f48cfd9b404e8ca87245.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jX6aPAxo65nm3dkQXqZ2Nw.png"/></div></div></figure><p id="cf56" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">标签</strong>:用户提问意图的可能类别</p><p id="fbfa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">模式</strong>:用户通常询问特定标签相关问题的方式越多越好</p><p id="89b5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">响应</strong>:数据集中每个标签的预定义响应，模型可以从中选择对特定问题的响应</p><p id="2a73" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">上下文</strong>:与标签相关的上下文单词，便于更好地对用户的请求进行分类</p><h1 id="8b17" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">下一步</strong>:载入文件，然后对数据进行预处理</h1><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="1f2c" class="lc jp hh lz b fi md me l mf mg">## Loading the file<br/>with open(“intents.json”) as file:<br/> data = json.load(file)</span></pre><p id="a813" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于预处理，您需要为建模部件更改数字数组中的模式。下面是对数据模式的预处理部分:</p><p id="c4d0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">标记化</strong>:把单词分成一个列表</p><p id="3b7c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">斯特梅尔</strong>:把类似程序、程序、程序这样的单词制作成它的基本单词程序</p><p id="f247" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">删除所有特殊字符</strong>:我用归一化的方法删除所有的ASCII和UTF8单词</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="0d5a" class="lc jp hh lz b fi md me l mf mg">for word in new_words:<br/>    word = unicodedata.normalize('NFKD', word).encode('ascii', 'ignore').decode('utf-8', 'ignore')<br/>    words.append(word)</span></pre><p id="8ebf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">标签:</strong>我们需要一个标签，通过使用我们上面创建的意图文件的标签来为单词列表标注。</p><h1 id="fd84" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">创建一个二进制单词包来训练模型</strong></h1><p id="33ae" class="pw-post-body-paragraph ip iq hh ir b is ko iu iv iw kp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated">因此，对于我们使用预处理创建的单词列表，我们需要将其转换为一个数字数组。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="c4d5" class="lc jp hh lz b fi md me l mf mg">for x, doc in enumerate(docs_x):<br/>    bag = []<br/>    wrds = [stemmer.stem(w) for w in doc]</span><span id="e7de" class="lc jp hh lz b fi mh me l mf mg">for w in words: <br/>        if w in wrds:<br/>            bag.append(1)<br/>        else:<br/>            bag.append(0)<br/>    output_row = out_empty[:]<br/>    output_row[labels.index(docs_y[x])] = 1<br/>    training.append(bag)<br/>    output.append(output_row)<br/>## switching the list into an array for input into a model<br/>training = np.array(training)<br/>output = np.array(output)</span></pre><h1 id="92ca" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">建模:深层神经网络</h1><p id="747e" class="pw-post-body-paragraph ip iq hh ir b is ko iu iv iw kp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated">对于这个模型，我使用了一个tflearn模块来使用神经网络模型来训练模型。由于数据非常少，我使用了1000个纪元，因为它可以非常快地处理1000个纪元。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="7936" class="lc jp hh lz b fi md me l mf mg">## defines the input shape for the model<br/>net = tflearn.input_data(shape = [None, len(training[0])])<br/>## adding to the neural network to 2 hidden layers <br/>## more hidden layers for more complex problem<br/>net = tflearn.fully_connected(net, 8)<br/>net = tflearn.fully_connected(net, 8)<br/>## output layers activation will allow us to get probablity for each neuron.<br/>net = tflearn.fully_connected(net, len(output[0]), activation = 'softmax')<br/>net = tflearn.regression(net)<br/>## Deep Neural Networl model<br/>model = tflearn.DNN(net)<br/>model.fit(training, output, n_epoch = 1000, batch_size = 8, show_metric = True)</span></pre><h1 id="1afc" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">建造机器人</strong></h1><p id="b7ef" class="pw-post-body-paragraph ip iq hh ir b is ko iu iv iw kp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated">现在，我们需要改变机器理解的输入。因此，我们需要一个从用户输入创建数组的函数。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="4356" class="lc jp hh lz b fi md me l mf mg">def bag_of_words(s, words):<br/>    bag = [0 for _ in range(len(words))]<br/>    <br/>    s_words = nltk.word_tokenize(s)<br/>    s_words = [stemmer.stem(word.lower()) for word in s_words]<br/>    <br/>    for se in s_words:<br/>        for i, w in enumerate(words):<br/>            if w == se:<br/>                bag[i] = 1<br/>    return np.array(bag)</span></pre><p id="5280" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个函数接受输入“s”和你在上面预处理的单词列表。然后，它对您的输入进行标记和词干分析，然后将其转换为二进制数组，以便机器理解。如果您输入的单词在列表中，它将被转换为1和0:如果不在列表中。</p><p id="51c3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，您可以创建一个可以与您交互的聊天机器人功能。</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="bc13" class="lc jp hh lz b fi md me l mf mg">def chat():<br/>    print('Hello, I am an Apple Stock FAQ Bot!! How may I help you? (type q to stop) !')<br/>    while True:<br/>        inp = input('You: ')<br/>        if inp.lower() == 'q':<br/>            break<br/>        ## it will giveout a probablity<br/>        results = model.predict([bag_of_words(inp,words)])</span><span id="386d" class="lc jp hh lz b fi mh me l mf mg">## gives an index of the largest probablity, so you can display the best answer<br/>        results_index = np.argmax(results)<br/>        tag = labels[results_index]<br/>        if results[results_index] &gt; 0.7:<br/>#             print(results)</span><span id="9723" class="lc jp hh lz b fi mh me l mf mg">for tg in data['intents']:<br/>                if tg['tag'] == tag:<br/>                    responses = tg['responses']</span><span id="7861" class="lc jp hh lz b fi mh me l mf mg">print('Chatbot: ' + random.choice(responses))<br/>        else:<br/>            print("Chatbot: Sorry, Here is Customer Service number Phone: 877-360-5390 (U.S. toll-free) for better help!")</span></pre><p id="f47e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这个函数中，该函数的作用是运行单词包函数，将您的输入转换为二进制数组，然后使用该模型进行预测。它将列出意图相似的概率。然后它得到最大的结果意图，如果它大于70%，它给出响应。</p><h1 id="489e" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">RASA框架</h1><p id="58df" class="pw-post-body-paragraph ip iq hh ir b is ko iu iv iw kp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated">Rasa是一个开发人工智能驱动的工业级聊天机器人的框架。它非常强大，被世界各地的开发者用来创建聊天机器人和上下文助手。Rasa有很多依赖问题，所以我建议你要么创建一个新的虚拟环境，要么使用google colab。这是在您的<a class="ae jn" href="https://rasa.com/docs/rasa/installation" rel="noopener ugc nofollow" target="_blank">计算机</a>上安装rasa的指南的链接。</p><p id="2475" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Rasa允许我们设计故事，这样你就可以继续和机器人交流。所以它会记住前面的商店答案。所以聊天机器人可以控制对话的流程。因此，这对酒店和航空公司等企业很有用。因此，客户可以预订房间或航班。</p><p id="99fa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当您创建rasa项目时，它会附带一些您需要编辑的文件，以便自定义您的喜好。</p><h1 id="ad93" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak"> RASA文件</strong></h1><p id="b339" class="pw-post-body-paragraph ip iq hh ir b is ko iu iv iw kp iy iz ja lq jc jd je lr jg jh ji ls jk jl jm ha bi translated"><strong class="ir hi"> Config.yml: </strong>所有机器学习设置<br/> <strong class="ir hi"> Domain.yml </strong>:意图+响应自定义动作概述<br/> <strong class="ir hi"> Stories.md </strong>:意图/动作序列示例<br/> <strong class="ir hi"> Nlu.md </strong>:意图/实体示例</p><h1 id="6c50" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">RASA管道</h1><ul class=""><li id="f8ed" class="km kn hh ir b is ko iw kp ja kq je kr ji ks jm kt ku kv kw bi translated">空白标记器(使用空白作为分隔符)</li><li id="f2f0" class="km kn hh ir b is kx iw ky ja kz je la ji lb jm kt ku kv kw bi translated">计数向量特性(创建用户消息、意图和响应的单词包表示)</li><li id="ed4c" class="km kn hh ir b is kx iw ky ja kz je la ji lb jm kt ku kv kw bi translated">从1到4的n元语法</li><li id="a9f8" class="km kn hh ir b is kx iw ky ja kz je la ji lb jm kt ku kv kw bi translated">NLU模型(自然语言理解)</li></ul><p id="fac9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以在config.yml文件中编辑为您的chatbot优化的管道。这是为it部门准备的笔记本。</p><p id="07ac" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你想看看这个项目，下面是Github的链接。</p><p id="07d9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">https://github.com/tw1270/Chatbot<a class="ae jn" href="https://github.com/tw1270/Chatbot" rel="noopener ugc nofollow" target="_blank"/></p><p id="e62f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">【https://www.linkedin.com/in/tenzin-wangdu/ T4】</p></div></div>    
</body>
</html>