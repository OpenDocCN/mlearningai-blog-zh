<html>
<head>
<title>Pandas QuickStart for Beginners 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫初学者快速入门2</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/pandas-quickstart-for-beginners-2-ed1b4232ef05?source=collection_archive---------5-----------------------#2022-06-30">https://medium.com/mlearning-ai/pandas-quickstart-for-beginners-2-ed1b4232ef05?source=collection_archive---------5-----------------------#2022-06-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/ae5aaed8c32b5b8361b91112f43f2989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VAJAePEEoi61-Xwt"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Photo by <a class="ae hu" href="https://unsplash.com/@maxcodes?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Maxwell Nelson</a> on <a class="ae hu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="8ec5" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">它是我上一篇文章“熊猫初学者快速入门1”的延续。在这篇文章中，我将介绍一些对数据分析至关重要的工具。这些方法对于第一眼理解数据和快速钻研数据非常有用。</p><p id="3dde" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">聚合&amp;分组</strong></p><p id="1376" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">聚合实际上是与数据相关联的特定值的表示，就像它的统计数据一样。其中一些是:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="e24a" class="kb kc hx jx b fi kd ke l kf kg"># - count()<br/># - first()<br/># - last()<br/># - mean()<br/># - median()<br/># - min()<br/># - max()<br/># - std()<br/># - var()<br/># - sum()<br/># - pivot table</span></pre><p id="8433" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些函数在“groupby”命令之后使用。我们举个例子来看看。我们继续使用同一个数据集“泰坦尼克号”。我们将计算女性和男性的平均年龄。回想一下，我们使用方括号从数据集中选择一个变量。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="c492" class="kb kc hx jx b fi kd ke l kf kg">import pandas as pd<br/>import seaborn as sns<br/>pd.set_option('display.max_columns', None)</span><span id="d1c5" class="kb kc hx jx b fi kh ke l kf kg">df = sns.load_dataset("titanic")<br/>df.head()</span><span id="4f90" class="kb kc hx jx b fi kh ke l kf kg">df["age"].mean() #mean of all group</span><span id="c02d" class="kb kc hx jx b fi kh ke l kf kg">df.groupby("sex")["age"].mean() #mean of age variable according to sex variable</span></pre><p id="1d0a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请注意，我们对分类变量应用了groupby操作。它根据行在变量中的类别对行进行分组。需要注意的是，如果我们的类较少，分组是有意义的。在接下来的文章中，我将在分析数据时检查这些点的重要性。</p><p id="4f8d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">实际上，应用groupby的模式是:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="8b73" class="kb kc hx jx b fi kd ke l kf kg">#dataframe_name.groupby(variable1)[variable2].aggregation_function</span></pre><p id="8c26" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这将在根据分类变量1的类别分组后，对变量2应用聚合函数。</p><p id="96f1" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以计算给定数据的多个描述值。为此，人们可能更喜欢在“agg”命令中使用字典。作为关键字，我们选择数字变量，作为项目，我们给出一个由应用的统计方法组成的列表。一些例子:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="e339" class="kb kc hx jx b fi kd ke l kf kg">df.groupby("sex").agg({"age": "mean"}) #calculates means of ages of female and male classes</span><span id="3567" class="kb kc hx jx b fi kh ke l kf kg">df.groupby("sex").agg({"age": ["mean", "sum"]}) #calculates sums and means of ages of female and male classes</span><span id="79ac" class="kb kc hx jx b fi kh ke l kf kg">#calculates sums and means of ages of female and male classes, means of survived classes<br/>df.groupby("sex").agg({"age": ["mean", "sum"],<br/>                       "survived": "mean"})</span></pre><p id="d7db" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">透视表</strong></p><p id="20e4" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">数据透视表函数接受一些参数，这些参数详细描述了您希望数据呈现的形状。输出是数据透视表的形式。</p><p id="098b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">模式就像</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="3837" class="kb kc hx jx b fi kd ke l kf kg"># df.pivot_table(intersection values, index-row values, column values)<br/># it computes default means of intersection values.</span><span id="2a8a" class="kb kc hx jx b fi kh ke l kf kg">df.pivot_table("survived", "sex", "embarked")</span><span id="d25c" class="kb kc hx jx b fi kh ke l kf kg">df.pivot_table("survived", "sex", ["embarked", "class"])</span></pre><p id="b2ba" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以改变我们寻找的统计值:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="dc65" class="kb kc hx jx b fi kd ke l kf kg">df.pivot_table("survived", "sex", "embarked",aggfunc="std")</span></pre><p id="ee2c" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将把数字变量“年龄”转换成分类变量。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="d1cf" class="kb kc hx jx b fi kd ke l kf kg"># converting num to cat<br/>df["new_age"] = pd.cut(df["age"], [0, 10, 18, 25, 40, 90])</span><span id="8da6" class="kb kc hx jx b fi kh ke l kf kg">df.pivot_table("survived", "sex", ["new_age", "class"])</span></pre><p id="d690" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">不是:“pd.qcut”函数也可以用在这里。“cut”和“qcut”的区别在于，qcut对变量的值进行排序，并将它们与第一、第二、第三四分位数分开。</p><p id="5991" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">应用&amp;λ</strong></p><p id="4837" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Apply将任何给定的函数应用于行或列，而不使用任何循环。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="9f14" class="kb kc hx jx b fi kd ke l kf kg">df[["age"]].apply(lambda x: x/10).head()</span><span id="6590" class="kb kc hx jx b fi kh ke l kf kg">df.loc[:, df.columns.str.contains("age")].apply(lambda x: x/10).head()</span><span id="804e" class="kb kc hx jx b fi kh ke l kf kg">df.loc[:, df.columns.str.contains("age")].apply(lambda x: (x - x.mean()) / x.std()).head()</span></pre><p id="452e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">没有lambda函数的最后一个命令的另一种方式:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="10e4" class="kb kc hx jx b fi kd ke l kf kg">def standart_scaler(col_name):<br/>    return (col_name - col_name.mean()) / col_name.std()</span><span id="627d" class="kb kc hx jx b fi kh ke l kf kg">df.loc[:, df.columns.str.contains("age")].apply(standart_scaler).head()</span></pre><p id="57b7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">加入流程</strong></p><p id="ff9e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有两种方法:“concat”(比较常见)和“merge”。</p><p id="f325" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用pd.concat连接:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="cffb" class="kb kc hx jx b fi kd ke l kf kg">m = np.random.randint(1, 30, size=(5, 3))<br/>df1 = pd.DataFrame(m, columns=["var1", "var2", "var3"])<br/>df2 = df1 + 99</span><span id="6243" class="kb kc hx jx b fi kh ke l kf kg">pd.concat([df1, df2])</span><span id="d644" class="kb kc hx jx b fi kh ke l kf kg">pd.concat([df1, df2], ignore_index=True) #to fix indices</span></pre><p id="0baa" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">加入pd.merge:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="3c5b" class="kb kc hx jx b fi kd ke l kf kg">df1 = pd.DataFrame({'employees': ['john', 'dennis', 'mark', 'maria'],<br/>                    'group': ['accounting', 'engineering', 'engineering', 'hr']})</span><span id="9f29" class="kb kc hx jx b fi kh ke l kf kg">df2 = pd.DataFrame({'employees': ['mark', 'john', 'dennis', 'maria'],<br/>                    'start_date': [2010, 2009, 2014, 2019]})</span><span id="67ad" class="kb kc hx jx b fi kh ke l kf kg">pd.merge(df1, df2) #joins with respect to employee variable<br/>pd.merge(df1, df2, on="employees")#joins with respect to employee variable</span></pre><div class="hg hh ez fb hi ki"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kj ab dw"><div class="kk ab kl cl cj km"><h2 class="bd hy fi z dy kn ea eb ko ed ef hw bi translated">Mlearning.ai提交建议</h2><div class="kp l"><h3 class="bd b fi z dy kn ea eb ko ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kq l"><p class="bd b fp z dy kn ea eb ko ed ef dx translated">medium.com</p></div></div><div class="kr l"><div class="ks l kt ku kv kr kw ho ki"/></div></div></a></div></div></div>    
</body>
</html>