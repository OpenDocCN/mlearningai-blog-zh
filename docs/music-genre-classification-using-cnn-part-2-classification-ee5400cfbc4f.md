# ä½¿ç”¨ CNN çš„éŸ³ä¹ç±»å‹åˆ†ç±»:ç¬¬ 2 éƒ¨åˆ†-åˆ†ç±»

> åŸæ–‡ï¼š<https://medium.com/mlearning-ai/music-genre-classification-using-cnn-part-2-classification-ee5400cfbc4f?source=collection_archive---------2----------------------->

äº†è§£å¦‚ä½•ä½¿ç”¨ CNN å¯¹éŸ³ä¹æµæ´¾è¿›è¡Œåˆ†ç±»ã€‚

![](img/562ce9f3d89216e7d3a32fd02b5ba152.png)

Photo by [Marius Masalar](https://unsplash.com/@marius?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

åœ¨[å‰ä¸€éƒ¨åˆ†](/mlearning-ai/music-genre-classification-using-cnn-part-1-feature-extraction-b417547b8981)ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ä»éŸ³é¢‘æ ·æœ¬ä¸­æå–ç‰¹å¾ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸åŒçš„ç‰¹æ€§ï¼Œæˆ‘ä»¬ç»§ç»­åˆ†ç±»ä»»åŠ¡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ†åˆ«ä½¿ç”¨ç‰¹å¾å¯¹éŸ³é¢‘æ ·æœ¬è¿›è¡Œåˆ†ç±»ï¼Œç„¶åæˆ‘ä»¬å°†ä½¿ç”¨æ‰€æœ‰ç‰¹å¾çš„é›†åˆè¿›è¡Œåˆ†ç±»ã€‚

## æ­¥éª¤ 1:å¯¼å…¥åº“

## æ­¥éª¤ 2:å¯¼å…¥ npz æ–‡ä»¶ï¼Œæå–ç‰¹å¾ï¼Œåˆ†å‰²è®­ç»ƒæµ‹è¯•æ•°æ®

æˆ‘ä»¬åœ¨[ä¹‹å‰çš„æ–‡ç« ](/mlearning-ai/music-genre-classification-using-cnn-part-1-feature-extraction-b417547b8981)ä¸­æå–äº†è¿™äº›ç‰¹å¾ï¼Œå¹¶ä¿å­˜åœ¨ npz æ–‡ä»¶ä¸­ã€‚æˆ‘ä»¬åªæ˜¯åœ¨è¿™é‡ŒåŠ è½½æ–‡ä»¶ã€‚

## æ­¥éª¤ 3:è°ƒæ•´æ•°æ®çš„å¤§å°å’Œå½¢çŠ¶

ç¼©æ”¾æ“ä½œä»…é€‚ç”¨äºå®šå‹æ•°æ®é›†ã€‚åœ¨æµ‹è¯•æœŸé—´ï¼Œç›¸åŒçš„æœ€å¤§å€¼(æ¥è‡ªè®­ç»ƒæ•°æ®)ç”¨äºå¯¹æµ‹è¯•æ•°æ®æ‰§è¡Œç¼©æ”¾ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬æ‰¾å‡º *S_train* å’Œ*T7 çš„æœ€å¤§å€¼ï¼Œç„¶åå°† *S_train* é™¤ä»¥æœ€å¤§å€¼ã€‚åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå°† *S_test* é™¤ä»¥ *S_train* çš„æœ€å¤§å€¼ã€‚*

ä¹‹åï¼Œæˆ‘ä»¬å°†æ•°æ®æ•´å½¢ä¸º(Nï¼Œrowï¼Œcolï¼Œ1)å½¢å¼ï¼Œå› ä¸º CNN è¦æ±‚è¾“å…¥æ˜¯è¿™ç§å½¢å¼ã€‚å®ƒè¡¨ç¤ºå›¾åƒä¸­åªæœ‰ä¸€ä¸ªé€šé“ã€‚è°±å›¾çš„åŸå§‹å½¢çŠ¶æ˜¯(944ï¼Œ1025ï¼Œ1295)ã€‚

MFCC çš„æœ€åˆå½¢çŠ¶æ˜¯(944ï¼Œ10ï¼Œ1293)ã€‚æˆ‘ä»¬é¦–å…ˆå°† MFCC è®­ç»ƒå’Œæµ‹è¯•æ•°æ®çš„å¤§å°è°ƒæ•´ä¸º(944ï¼Œ120ï¼Œ600)ã€‚ä¹‹åï¼Œæˆ‘ä»¬ä¸º CNN å°†æ•°æ®æ•´å½¢ä¸º(Nï¼Œrowï¼Œcolï¼Œ1)ã€‚ç„¶åæˆ‘ä»¬å°†æ•°æ®æ ‡å‡†åŒ–ã€‚

Mel è°±å›¾çš„åŸå§‹å½¢çŠ¶æ˜¯(944ï¼Œ128ï¼Œ1293)ã€‚æˆ‘ä»¬é¦–å…ˆä½¿ç”¨æœ€å¤§çš„è®­ç»ƒæ•°æ®æ¥ç¼©æ”¾è®­ç»ƒå’Œæµ‹è¯•æ•°æ®ã€‚ç„¶åï¼Œæˆ‘ä»¬å°† CNN çš„æ•°æ®æ•´å½¢ä¸º(Nï¼Œrowï¼Œcolï¼Œ1)ã€‚

## æ­¥éª¤ 4:åœ¨ npz æ–‡ä»¶ä¸­ä¿å­˜åŸ¹è®­å’Œæµ‹è¯•ç‰¹å¾

å¯¹äºæ‰€æœ‰æ¨¡å‹ï¼Œæˆ‘ä»¬å°†çºªå…ƒè®¾ç½®ä¸º 100ï¼Œæ‰¹é‡å¤§å°ä¸º 32ï¼Œå­¦ä¹ ç‡ä¸º 0.001ã€‚

## æ­¥éª¤ 5:ä½¿ç”¨å…‰è°±å›¾è¿›è¡Œåˆ†ç±»

æˆ‘ä»¬å°†é¦–å…ˆåŠ è½½è®­ç»ƒæµ‹è¯•åˆ†å‰²æ•°æ®(ã€‚npz æ–‡ä»¶)ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª CNN æ¨¡å‹è¿›è¡Œåˆ†ç±»ã€‚é™¤äº†æœ€åä¸€å±‚æˆ‘ä»¬ä½¿ç”¨äº† softmaxï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨ ReLU ä½œä¸ºå±‚çš„æ¿€æ´»å‡½æ•°ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨ Adam ä¼˜åŒ–å™¨ã€‚æˆ‘ä»¬åœ¨æ¯ 5 ä¸ªæ—¶æœŸåæœ‰ä¸€ä¸ªæ£€æŸ¥ç‚¹ï¼Œå¦‚æœåœ¨ä»»ä½•æƒ…å†µä¸‹æˆ‘ä»¬çš„æ¨¡å‹åœ¨è®­ç»ƒæœŸé—´è¢«ä¸­æ–­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒã€‚ä¹‹åï¼Œæˆ‘ä»¬ä¿å­˜è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¨¡å‹è®­ç»ƒéƒ¨åˆ†è¿›è¡Œæ³¨é‡Šï¼Œå¹¶åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚æˆ‘ä»¬è®¡ç®—è®­ç»ƒæ•°æ®çš„å‡†ç¡®åº¦ï¼Œç„¶åæµ‹è¯•æ•°æ®ã€‚ç„¶åï¼Œæˆ‘ä»¬æ˜¾ç¤ºæµ‹è¯•æ•°æ®çš„æ··æ·†çŸ©é˜µã€‚æˆ‘ä»¬åœ¨æµ‹è¯•æ•°æ®é›†ä¸Šå–å¾—äº† 71.96%çš„å‡†ç¡®ç‡ã€‚

ç°åœ¨ï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ç§å…‰è°±å›¾æ¨¡å‹ã€‚ä¸‹é¢çš„ä»£ç æ˜¯å£°è°±å›¾çš„ç¬¬äºŒä¸ªæ¨¡å‹ã€‚æˆ‘ä»¬åœ¨æµ‹è¯•æ•°æ®é›†ä¸Šå–å¾—äº† 73.54%çš„å‡†ç¡®ç‡ã€‚æˆ‘ä»¬å°†è€ƒè™‘è¿™ä¸¤ç§æ¨¡å¼ï¼ŒåŒæ—¶é‡‡å–åˆå¥ã€‚

æœ€ä½³è°±å›¾æ¨¡å‹çš„æ··æ·†çŸ©é˜µå¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/d195b2a747b7d92eb1bbc4022344d3aa.png)

Confusion matrix for the best model of Spectrogram (Image by the Author)

## ç¬¬å…­æ­¥:ä½¿ç”¨ MFCC åˆ†ç±»

å¯¹äº MFCCï¼Œæˆ‘ä»¬è®­ç»ƒäº†ä¸‰ä¸ªæ¨¡å‹ï¼Œå¹¶ä½¿ç”¨è¿™ä¸‰ä¸ªæ¨¡å‹çš„é›†åˆæ¥æŠ¥å‘Šå‡†ç¡®æ€§ã€‚æˆ‘ä»¬è¿˜ä½¿ç”¨äº† k å€äº¤å‰éªŒè¯ï¼Œk =10ã€‚æˆ‘ä»¬åœ¨æµ‹è¯•æ•°æ®ä¸Šå–å¾—äº† 74.07%çš„å‡†ç¡®ç‡ã€‚

æˆ‘ä»¬å†æ¬¡åŠ è½½ MFCC çš„åˆ—è½¦æµ‹è¯•åˆ†å‰²å¹¶å®šä¹‰æ¨¡å‹ã€‚

ç°åœ¨ï¼Œå› ä¸ºæˆ‘ä»¬å°†é‡‡ç”¨ä¸‰ä¸ª MFCC æ¨¡å‹çš„é›†åˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥ä»ä¸‰ä¸ªæ¨¡å‹ä¸­å–å¤šæ•°ç¥¨ã€‚ç„¶åæˆ‘ä»¬è®­ç»ƒæ‰€æœ‰ä¸‰ä¸ªæ¨¡å‹ã€‚

åœ¨æˆ‘ä»¬è®­ç»ƒå®Œæ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬å°†åŠ è½½æ¨¡å‹å¹¶å°† *y_pred* å‘é€åˆ° *get_majority()* å‡½æ•°ä¸­ã€‚

æˆ‘ä»¬åœ¨æµ‹è¯•æ•°æ®ä¸Šå–å¾—äº† 74.07%çš„å‡†ç¡®ç‡ã€‚MFCC çš„æ··æ·†çŸ©é˜µå¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/9d1786d690e75fe69caf560352a2dd65.png)

Confusion matrix for MFCC (Image by the Author)

## æ­¥éª¤ 7:ä½¿ç”¨ Mel è°±å›¾è¿›è¡Œåˆ†ç±»

æˆ‘ä»¬åœ¨æµ‹è¯•æ•°æ®ä¸Šå–å¾—äº† 75.13%çš„å‡†ç¡®ç‡ã€‚Mel è°±å›¾çš„æ··æ·†çŸ©é˜µå¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/cb51010736c26f2de9ba2f4b985cac22.png)

Confusion matrix for Mel-spectrogram (Image by the Author)

## æ­¥éª¤ 8:åˆ›å»ºå£°è°±å›¾ã€æ¢…å°”å£°è°±å›¾å’Œ MFCC CNN çš„é›†åˆ

ç°åœ¨ï¼Œå¯¹äºç³»ç»¼ï¼Œæˆ‘ä»¬å°†åŠ è½½æ‰€æœ‰æ¨¡å‹(ä½¿ç”¨æ–°æ–‡ä»¶ä»¥é¿å…ä»»ä½•æ··æ·†å’Œé”™è¯¯)å¹¶è®¡ç®— *y-pred* ã€‚è¯¥é›†åˆåŒ…å« 2 ä¸ªå£°è°±å›¾æ¨¡å‹ã€3 ä¸ª MFCC æ¨¡å‹å’Œ 1 ä¸ªæ¢…å°”å£°è°±å›¾æ¨¡å‹ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†æŠŠé¢„æµ‹å‘é€ç»™ *get_majority* å‡½æ•°ï¼Œå¹¶æŠ¥å‘Šé›†åˆçš„å‡†ç¡®æ€§ã€‚

ä½¿ç”¨é›†æˆè·å¾—çš„å‡†ç¡®ç‡ä¸º 79.36%ã€‚

ç³»ç»¼çš„æ··æ·†çŸ©é˜µå¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/98cef85416d9e8cf2ce7335a7e0c7389.png)

Confusion matrix for the Ensemble (Image by the Author)

# ç»“è®º

æˆ‘ä»¬å·²ç»å­¦ä¼šäº†å¦‚ä½•ä½¿ç”¨ CNN è¿›è¡ŒéŸ³ä¹æµæ´¾åˆ†ç±»ã€‚æµ‹è¯•æ•°æ®è¢«å•ç‹¬å–å‡ºï¼Œä»¥é¿å…ä»»ä½•æ•°æ®æ³„éœ²ã€‚é¦–å…ˆï¼Œåˆ†åˆ«è®­ç»ƒç‰¹å¾è¿›è¡Œåˆ†ç±»ã€‚å…¶æ¬¡ï¼Œåˆ›å»ºä¸åŒç‰¹å¾çš„é›†åˆï¼Œå¹¶ä½¿ç”¨å¤šæ•°æŠ•ç¥¨ç­–ç•¥è¿›è¡Œé¢„æµ‹ã€‚æˆ‘ä»¬ä½¿ç”¨äº† 2 ä¸ªå£°è°±å›¾æ¨¡å‹ã€3 ä¸ª MFCC æ¨¡å‹å’Œ 1 ä¸ªæ¢…å°”å£°è°±å›¾æ¨¡å‹ã€‚æˆ‘ä»¬åœ¨é›†æˆä¸Šå®ç°äº† 79.36%çš„å‡†ç¡®ç‡ï¼Œè¿™æ˜æ˜¾ä¼˜äºå•ä¸€ç‰¹å¾æ¨¡å‹ã€‚è¿™æ˜¾ç¤ºäº†ä½¿ç”¨é›†åˆæ¨¡å‹çš„ç¨³å¥æ€§å’Œæ•ˆç‡ã€‚åœ¨è¢«é”™è¯¯åˆ†ç±»çš„æµæ´¾ä¸­ï¼Œè¢«é”™è¯¯åˆ†ç±»æœ€å¤šçš„æµæ´¾æ˜¯â€œæ‘‡æ»šâ€ã€‚å®ƒå¤§å¤šè¢«é”™è¯¯åœ°å½’ç±»ä¸ºâ€œé‡‘å±â€ã€â€œè¿ªæ–¯ç§‘â€ã€â€œå¸ƒé²æ–¯â€å’Œâ€œä¹¡æ‘éŸ³ä¹â€ã€‚ç¬¬äºŒå¤§è¢«é”™è¯¯åˆ†ç±»çš„æµæ´¾æ˜¯â€œä¹¡æ‘â€ï¼Œå®ƒè¢«é”™è¯¯åœ°åˆ†ç±»ä¸ºâ€œæ‘‡æ»šâ€ã€â€œé›·é¬¼â€å’Œâ€œå¸ƒé²æ–¯â€ã€‚

> å®Œæ•´ä»£ç å¯åœ¨ [Github](https://github.com/namratadutt/Music-genre-classification-part-2/tree/main) ä¸Šè·å¾—ã€‚
> 
> æ„Ÿè°¢é˜…è¯»ï¼æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚
> 
> åŠ æ²¹é³„é±¼é˜Ÿï¼ğŸŠ

[](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb) [## Mlearning.ai æäº¤å»ºè®®

### å¦‚ä½•æˆä¸º Mlearning.ai ä¸Šçš„ä½œå®¶

medium.com](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb)