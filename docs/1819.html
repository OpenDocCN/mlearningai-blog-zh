<html>
<head>
<title>Deploying your first Machine Learning Project to Streamlit Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署您的第一个机器学习项目来简化云计算</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/deploying-your-first-machine-learning-project-to-streamlit-cloud-d6b62ee03874?source=collection_archive---------2-----------------------#2022-02-01">https://medium.com/mlearning-ai/deploying-your-first-machine-learning-project-to-streamlit-cloud-d6b62ee03874?source=collection_archive---------2-----------------------#2022-02-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/9ab5d39bd2d9fe5d52bda8ffd21257d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvxW4ENUgfdayJaCybVJOQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Screenshot of the web app.</figcaption></figure><p id="f494" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">感谢像Streamlit或Heroku这样的平台，将你的任何项目部署到UI都变得如此容易。就我而言，我非常喜欢这种体验，所以不确定我是否会选择另一种体验。这至少是我此刻的感受。</p><p id="db49" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">你可以通过点击这个<a class="ae jr" href="https://share.streamlit.io/avangarde2225/seoul_bike_count_prediction/Seoul_Bike_Prediction_Model.py" rel="noopener ugc nofollow" target="_blank">链接</a>来检查这个项目的最终版本，然后告诉我它需要的任何改进。</p><p id="034a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">步骤</strong>:</p><ol class=""><li id="3889" class="js jt hh iv b iw ix ja jb je ju ji jv jm jw jq jx jy jz ka bi translated">数据清理和探索性数据分析</li><li id="009c" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated">简单线性回归</li><li id="1f3a" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated">套索和山脊规则</li><li id="9f50" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated">部署</li></ol></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><h1 id="6bac" class="kn ko hh bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">介绍</h1><p id="aa61" class="pw-post-body-paragraph it iu hh iv b iw ll iy iz ja lm jc jd je ln jg jh ji lo jk jl jm lp jo jp jq ha bi translated">我通过Medium.com分享我的数据科学路线图经验，并试图在我所做的事情上独树一帜。正如你已经知道的，博客中涉及的大部分项目几乎是相同的。我意识到的一件事是解决你可能面临的挑战。在这个项目中，我尝试实现了一个从数据提取阶段到UI部署的端到端的机器学习项目。</p><p id="6f9c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我最初的想法是从各种网络应用程序中收集数据并进行分析。我做到了，但它成为了另一篇文章的主题，这篇文章可以在这里找到:</p><div class="lq lr ez fb ls lt"><a rel="noopener follow" target="_blank" href="/mlearning-ai/lessons-learned-while-scraping-data-from-dynamic-sites-for-my-regression-ml-project-c7f52e5ef7ea"><div class="lu ab dw"><div class="lv ab lw cl cj lx"><h2 class="bd hi fi z dy ly ea eb lz ed ef hg bi translated">为我的回归ML项目从动态站点收集数据时学到的经验教训</h2><div class="ma l"><h3 class="bd b fi z dy ly ea eb lz ed ef dx translated">希望这篇文章是关于分享我的经验，关于我用“两行代码”刮一个网站或…</h3></div><div class="mb l"><p class="bd b fp z dy ly ea eb lz ed ef dx translated">medium.com</p></div></div><div class="mc l"><div class="md l me mf mg mc mh in lt"/></div></div></a></div><p id="d9df" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">许多现代城市引入了租赁自行车，为通勤提供了另一种方式。例如，在T4的一些城市，自行车比汽车多。至关重要的是，不仅在像市中心这样受欢迎的地方，而且在有一些交通的地方，都可以在码头找到租赁自行车。骑自行车也与天气和季节密切相关。也可能不是...让我们深入细节...</p><h1 id="fffe" class="kn ko hh bd kp kq mi ks kt ku mj kw kx ky mk la lb lc ml le lf lg mm li lj lk bi translated">资料组</h1><p id="3f85" class="pw-post-body-paragraph it iu hh iv b iw ll iy iz ja lm jc jd je ln jg jh ji lo jk jl jm lp jo jp jq ha bi translated">这些数据是从UCI ML知识库中提取的，可以在这里找到<a class="ae jr" href="https://archive.ics.uci.edu/ml/datasets/Seoul+Bike+Sharing+Demand" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="d617" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">数据集包含天气信息(温度、湿度、风速、能见度、露点、太阳辐射、降雪量、降雨量)、每小时租赁的自行车数量和日期信息。</p><p id="c28b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">属性信息:</strong></p><p id="582b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">日期</strong>:年月日<br/> <strong class="iv hi">出租自行车数</strong> —每小时出租自行车数<br/> <strong class="iv hi">小时</strong> —一天中的小时<br/> <strong class="iv hi">温度</strong>—摄氏度温度<br/> <strong class="iv hi">湿度</strong> — % <br/> <strong class="iv hi">风速</strong> —米/秒<br/> <strong class="iv hi">能见度</strong>—10米<br/> <strong class="iv hi">露点温度</strong> —摄氏度<br/> <strong class="iv hi">季节</strong> —冬、春、夏、秋<br/> <strong class="iv hi">节假日</strong> —节假日/无节假日<br/> <strong class="iv hi">功能日</strong> —无功能时间(NoFunc)，乐趣(Fun)</p><p id="e1af" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在我们知道了我们在这里处理的是什么样的变量，让我们来看看事情的本质。</p><figure class="mo mp mq mr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mn"><img src="../Images/432bdb8240e42b3f668d679402f6baee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ijETM8w3vYNwcUZEZDbcsQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae jr" href="https://www.pexels.com/@sugacoatit?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Jodie Louise</a> from <a class="ae jr" href="https://www.pexels.com/photo/red-cruiser-bike-parked-on-metal-bike-stand-805303/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><h1 id="32c4" class="kn ko hh bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">1.数据清理和探索性数据分析(EDA)</h1><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es ms"><img src="../Images/20240a7b6cb275c3ff690ef093164ee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wIDrpd-_rqqkiujddDDpjw.png"/></div></figure><p id="860b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我喜欢任何没有任何缺失值的数据集！</p><p id="3285" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">将“日期”对象转换为正确的日期时间格式，然后将其拆分成多个片段，以便我们可以深入到每小时和季节信息。</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="61ec" class="my ko hh mu b fi mz na l nb nc"><em class="nd"># Let's extract new columns (day of the week, day of the month, hour, month, season, year etc.) by using new index.</em><br/>df['Date'] <strong class="mu hi">=</strong> pd<strong class="mu hi">.</strong>to_datetime(df['Date'])<br/>df['Year'] <strong class="mu hi">=</strong> df['Date']<strong class="mu hi">.</strong>dt<strong class="mu hi">.</strong>year<br/>df['Month'] <strong class="mu hi">=</strong> df['Date']<strong class="mu hi">.</strong>dt<strong class="mu hi">.</strong>month<br/>df['Day'] <strong class="mu hi">=</strong> df['Date']<strong class="mu hi">.</strong>dt<strong class="mu hi">.</strong>day<br/>df<strong class="mu hi">.</strong>tail()</span></pre><p id="81ef" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">除了冬季，自行车数量全年都相当稳定。</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="c054" class="my ko hh mu b fi mz na l nb nc">Month <strong class="mu hi">=</strong> df<strong class="mu hi">.</strong>groupby("Month")<strong class="mu hi">.</strong>sum()<strong class="mu hi">.</strong>reset_index()<br/>plt<strong class="mu hi">.</strong>figure(figsize<strong class="mu hi">=</strong>(16,4), dpi<strong class="mu hi">=</strong>150)<br/>sns<strong class="mu hi">.</strong>barplot(x<strong class="mu hi">=</strong>"Month", y<strong class="mu hi">=</strong>"Rented Bike Count", data<strong class="mu hi">=</strong>Month)<br/>plt<strong class="mu hi">.</strong>xticks(rotation<strong class="mu hi">=</strong>90);</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ne"><img src="../Images/37fa32c03ba26159019626455b8e27f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KbKCD9JA6O3p1yXiilf8oQ.png"/></div></div></figure><p id="b2e1" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这可能没什么意义，但稍后这可能会给我们一个月中天数分布的概念，所以我在这里分享它；</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="6abd" class="my ko hh mu b fi mz na l nb nc">Day <strong class="mu hi">=</strong> df<strong class="mu hi">.</strong>groupby("Day")<strong class="mu hi">.</strong>sum()<strong class="mu hi">.</strong>reset_index()<br/>plt<strong class="mu hi">.</strong>figure(figsize<strong class="mu hi">=</strong>(16,4), dpi<strong class="mu hi">=</strong>150)<br/>sns<strong class="mu hi">.</strong>barplot(x<strong class="mu hi">=</strong>"Day", y<strong class="mu hi">=</strong>"Rented Bike Count", data<strong class="mu hi">=</strong>Day)<br/>plt<strong class="mu hi">.</strong>xticks(rotation<strong class="mu hi">=</strong>90);</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nf"><img src="../Images/02c4c2eec910728eff8d2528756e2b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sUz__oRmzXgNEEQ0wH6TTQ.png"/></div></div></figure><p id="3fff" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">不知何故，上面的图表描绘了一幅有趣的图画。每个月的头几天，也就是第12天，是真正缺乏需求的时候。进一步深究，会引出这样的问题:</p><p id="dd4e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">一个月中有没有什么特殊的日子对自行车进行检查？或者在首尔，这些日子有什么特殊的文化意义吗？</p><p id="bd1a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">最后，如预期的季节性…</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="3497" class="my ko hh mu b fi mz na l nb nc">Season <strong class="mu hi">=</strong> df<strong class="mu hi">.</strong>groupby("Seasons")<strong class="mu hi">.</strong>sum()<strong class="mu hi">.</strong>reset_index()<br/>plt<strong class="mu hi">.</strong>figure(figsize<strong class="mu hi">=</strong>(16,4), dpi<strong class="mu hi">=</strong>150)<br/>sns<strong class="mu hi">.</strong>barplot(x<strong class="mu hi">=</strong>"Seasons", y<strong class="mu hi">=</strong>"Rented Bike Count", data<strong class="mu hi">=</strong>Season)<br/>plt<strong class="mu hi">.</strong>xticks(rotation<strong class="mu hi">=</strong>90);</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ng"><img src="../Images/49547666777394339445eddf1ea8289a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hb0298RvFEkGsSQG2Y-D2Q.png"/></div></div></figure><p id="5963" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">从这里，我想得到的是一年四季中每天的时间分布。人们似乎大多在高峰时间使用自行车，尤其是在每个季节的晚上！我认为这是一个非常好的迹象，尤其是当世界正在向零排放迈进的时候！</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="e14d" class="my ko hh mu b fi mz na l nb nc">plt<strong class="mu hi">.</strong>figure(figsize<strong class="mu hi">=</strong>(12,4), dpi<strong class="mu hi">=</strong>100)<br/>graph <strong class="mu hi">=</strong> sns<strong class="mu hi">.</strong>lineplot(data<strong class="mu hi">=</strong>df, x<strong class="mu hi">=</strong>"Hour", y<strong class="mu hi">=</strong>"Rented Bike Count", hue<strong class="mu hi">=</strong>"Seasons")</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nh"><img src="../Images/251fb001cbc858bbcd4976ac4573981e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rTV93ymPA4JiistGEFQOsQ.png"/></div></div></figure><p id="0e9e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">进入数据处理之前的最后一步是显示热图，以显示“租赁自行车数量”和其他变量之间的关系。“小时”和“温度”出现了，因为这两个变量与自行车总数变量密切相关。</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="eef8" class="my ko hh mu b fi mz na l nb nc">plt<strong class="mu hi">.</strong>figure(figsize<strong class="mu hi">=</strong>(2,4), dpi<strong class="mu hi">=</strong>150)<br/>sns<strong class="mu hi">.</strong>heatmap(df<strong class="mu hi">.</strong>corr()[["Rented Bike Count"]]<strong class="mu hi">.</strong>sort_values<br/>            (by<strong class="mu hi">=</strong>"Rented Bike Count", ascending<strong class="mu hi">=False</strong>)[1:],annot<strong class="mu hi">=True</strong>)</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ni"><img src="../Images/1ca833cc69227284c083fea6f1e355eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YKyQpa9hh8FoQwm7jXA0mw.png"/></div></div></figure></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><h1 id="5995" class="kn ko hh bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">1a)数据处理和准备</h1><p id="411c" class="pw-post-body-paragraph it iu hh iv b iw ll iy iz ja lm jc jd je ln jg jh ji lo jk jl jm lp jo jp jq ha bi translated">为了更直观，让我们用日期名称代替数字。</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="fe0e" class="my ko hh mu b fi mz na l nb nc">mapping_dictDay<strong class="mu hi">=</strong>{'Monday':1,'Tuesday':2,'Wednesday':3,'Thursday':4,'Friday':5,'Saturday':6,'Sunday':7}<br/><br/>df['WeekDayEncoding']<strong class="mu hi">=</strong>df['WeekDay']<strong class="mu hi">.</strong>map(mapping_dictDay)<br/>df<strong class="mu hi">.</strong>head()</span></pre><p id="fb78" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">获取虚拟模型和一次性编码</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="e9c4" class="my ko hh mu b fi mz na l nb nc">df_one_hot_coded <strong class="mu hi">=</strong> pd<strong class="mu hi">.</strong>get_dummies(df,columns<strong class="mu hi">=</strong>['seasons','holiday', ],prefix<strong class="mu hi">=</strong>'C')</span><span id="8eb3" class="my ko hh mu b fi nj na l nb nc">df_one_hot_coded <strong class="mu hi">=</strong> df_one_hot_coded<strong class="mu hi">.</strong>rename(columns<strong class="mu hi">=</strong>{'C_No Holiday': 'C_No_Holiday'})<br/>df_one_hot_coded<strong class="mu hi">.</strong>head()</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es nk"><img src="../Images/809446a759c5d3c337bb0d14db41bbe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*U4XWDH6ptYvy_5ht_NV18w.png"/></div></figure></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><h1 id="51bc" class="kn ko hh bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">2)简单线性回归</h1><p id="f6ea" class="pw-post-body-paragraph it iu hh iv b iw ll iy iz ja lm jc jd je ln jg jh ji lo jk jl jm lp jo jp jq ha bi translated">设置X、y轴并分割数据</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="ff2b" class="my ko hh mu b fi mz na l nb nc"><em class="nd">#features &amp; target</em><br/>X <strong class="mu hi">=</strong> df_one_hot_coded<strong class="mu hi">.</strong>drop(columns<strong class="mu hi">=</strong>['rented_bike_count'],axis<strong class="mu hi">=</strong>1)<br/>y <strong class="mu hi">=</strong> df_one_hot_coded['rented_bike_count']</span><span id="ff11" class="my ko hh mu b fi nj na l nb nc">X_train, X_test, y_train, y_test <strong class="mu hi">=</strong> train_test_split(X, y, test_size<strong class="mu hi">=</strong>0.2, random_state<strong class="mu hi">=</strong>42)</span></pre><p id="b4d1" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">y _测试和预测比较；</p><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es nl"><img src="../Images/be0438ece524d3f4c5a199e00060133c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*X5QO7_AGoLwlwNZPLooAjA.png"/></div></figure><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="7d1f" class="my ko hh mu b fi mz na l nb nc">print("MAE: ", metrics<strong class="mu hi">.</strong>mean_absolute_error(y_test, predictions))<br/>print("MSE: ",metrics<strong class="mu hi">.</strong>mean_squared_error(y_test, predictions))<br/>print("RMSE: ", np<strong class="mu hi">.</strong>sqrt(metrics<strong class="mu hi">.</strong>mean_squared_error(y_test, predictions)))<br/>print("R^2: {}"<strong class="mu hi">.</strong>format(model<strong class="mu hi">.</strong>score(X_test, y_test)))</span><span id="1e7f" class="my ko hh mu b fi nj na l nb nc">R^2: 0.5343183750523306</span></pre><p id="0b17" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">让我们尝试通过应用套索和山脊正则化来提高模型测试分数。</p></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><h1 id="5116" class="kn ko hh bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">3)套索和脊正则化</h1><p id="8764" class="pw-post-body-paragraph it iu hh iv b iw ll iy iz ja lm jc jd je ln jg jh ji lo jk jl jm lp jo jp jq ha bi translated">阿尔法值为0.5的套索</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="7c7b" class="my ko hh mu b fi mz na l nb nc">plt<strong class="mu hi">.</strong>scatter(test_set_pred, y_test, alpha<strong class="mu hi">=</strong>.5)<br/>plt<strong class="mu hi">.</strong>plot(np<strong class="mu hi">.</strong>linspace(10,<strong class="mu hi">-</strong>2,100));</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es nm"><img src="../Images/883028d3844d1ac0227fff6ffba22456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*uXAWWSf0IAny6HjSTp2qLg.png"/></div></figure><p id="c904" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">模型分数没有一点提高</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="b72a" class="my ko hh mu b fi mz na l nb nc">lassoReg<strong class="mu hi">.</strong>score(X_test,y_test)</span><span id="5007" class="my ko hh mu b fi nj na l nb nc">0.5259229915556245</span></pre><p id="e1b2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">通过在alpha为0.05时应用脊</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="fd7a" class="my ko hh mu b fi mz na l nb nc">ridgeReg <strong class="mu hi">=</strong> Ridge(alpha<strong class="mu hi">=</strong>0.05, normalize<strong class="mu hi">=True</strong>)<br/><br/>ridgeReg<strong class="mu hi">.</strong>fit(X_train,y_train)<br/><br/>pred <strong class="mu hi">=</strong> ridgeReg<strong class="mu hi">.</strong>predict(X_test)<br/></span><span id="2981" class="my ko hh mu b fi nj na l nb nc">print("MAE: ", metrics<strong class="mu hi">.</strong>mean_absolute_error(y_test, pred))<br/>print("MSE: ",metrics<strong class="mu hi">.</strong>mean_squared_error(y_test, pred))<br/>print("RMSE: ", np<strong class="mu hi">.</strong>sqrt(metrics<strong class="mu hi">.</strong>mean_squared_error(y_test, pred)))<br/>print("R^2: {}"<strong class="mu hi">.</strong>format(model<strong class="mu hi">.</strong>score(X_test, y_test)))</span><span id="31d9" class="my ko hh mu b fi nj na l nb nc">MAE:  323.3309122601071<br/>MSE:  182862.18183393966<br/>RMSE:  427.62387893327434<br/>R^2: 0.5343183750523306</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es nn"><img src="../Images/d69f674e12b2dcfae9d92ef72d08db7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*imbtZRKVgbuzahxczZu74A.png"/></div></figure><p id="0122" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">阿尔法值为0.5</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="2ab0" class="my ko hh mu b fi mz na l nb nc">ridgeReg <strong class="mu hi">=</strong> Ridge(alpha<strong class="mu hi">=</strong>0.5, normalize<strong class="mu hi">=True</strong>)<br/><br/>ridgeReg<strong class="mu hi">.</strong>fit(X_train,y_train)<br/><br/>pred <strong class="mu hi">=</strong> ridgeReg<strong class="mu hi">.</strong>predict(X_test)</span><span id="1118" class="my ko hh mu b fi nj na l nb nc">print("RMSE: ", np<strong class="mu hi">.</strong>sqrt(metrics<strong class="mu hi">.</strong>mean_squared_error(y_test, pred)))<br/>print("MSE: ",metrics<strong class="mu hi">.</strong>mean_squared_error(y_test, pred))</span><span id="8c4c" class="my ko hh mu b fi nj na l nb nc">RMSE:  442.2031481156279<br/>MSE:  195543.624203372</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es nn"><img src="../Images/b64d425efe08377dc9068a18c44ee9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*i9fMfWiC3p7r1a2hP7gJTA.png"/></div></figure><p id="f90e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">阿尔法在5</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="da58" class="my ko hh mu b fi mz na l nb nc">ridgeReg <strong class="mu hi">=</strong> Ridge(alpha<strong class="mu hi">=</strong>5, normalize<strong class="mu hi">=True</strong>)<br/><br/>ridgeReg<strong class="mu hi">.</strong>fit(X_train,y_train)<br/><br/>pred <strong class="mu hi">=</strong> ridgeReg<strong class="mu hi">.</strong>predict(X_test)</span><span id="d77b" class="my ko hh mu b fi nj na l nb nc">print("RMSE: ", np<strong class="mu hi">.</strong>sqrt(metrics<strong class="mu hi">.</strong>mean_squared_error(y_test, pred)))<br/>print("MSE: ",metrics<strong class="mu hi">.</strong>mean_squared_error(y_test, pred))</span><span id="0274" class="my ko hh mu b fi nj na l nb nc">RMSE:  545.559063745746<br/>MSE:  297634.692035135</span></pre><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es no"><img src="../Images/fa74265537304e166b18ce67fc994889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*KWsH4ob8VNUF97oLFLYsJA.png"/></div></figure><p id="1afd" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">套索</strong>:</p><p id="0dbf" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi"> Pro </strong>:非常适合修剪特征和集中解释几个关键特征</p><p id="8a52" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">弊</strong>:丢弃实际有用的功能的风险</p><p id="3e72" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">山脊</strong>:</p><p id="c2c5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi"> Pro </strong>:非常适合平滑处理多重共线性，在处理稀疏要素时非常好</p><p id="387a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">缺点</strong>:永远不会完全放弃功能</p></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><p id="dc62" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">将模型保存为pickle文件，以便我们可以使用它进行部署。</p><pre class="mo mp mq mr fd mt mu mv mw aw mx bi"><span id="6e5f" class="my ko hh mu b fi mz na l nb nc"><em class="nd"># saving the model </em><br/><strong class="mu hi">import</strong> pickle <br/>pickle_out <strong class="mu hi">=</strong> open("rf_model", mode <strong class="mu hi">=</strong> "wb") <br/>pickle<strong class="mu hi">.</strong>dump(rf_model, pickle_out) <br/>pickle_out<strong class="mu hi">.</strong>close()</span></pre></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><h1 id="49f5" class="kn ko hh bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">4)部署</h1><p id="676c" class="pw-post-body-paragraph it iu hh iv b iw ll iy iz ja lm jc jd je ln jg jh ji lo jk jl jm lp jo jp jq ha bi translated">Streamlit有非常详细的文档，可以在<a class="ae jr" href="https://docs.streamlit.io/streamlit-cloud/get-started/deploy-an-app" rel="noopener ugc nofollow" target="_blank">这里</a>找到。让我们从文件夹结构开始。</p><p id="97c7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">文件夹结构</strong></p><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es no"><img src="../Images/a5ff4c2627151a7b77cc0a4463ba949e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*MX5e0eteTJKIGSaYt650Vg.png"/></div></figure><p id="e517" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">确保您选择了您喜欢的应用程序名称。你可以从下面的截图中看到你的应用程序的网址是什么样子的。</p><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es np"><img src="../Images/37b9c24864f0e4f2ff34c06c98112056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*xGRUhVKkZpwLo1fD1xSI9Q.png"/></div></figure><p id="043e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为Python依赖关系添加一个<a class="ae jr" href="https://docs.streamlit.io/streamlit-cloud/get-started/deploy-an-app/app-dependencies#add-python-dependencies" rel="noopener ugc nofollow" target="_blank">需求文件</a>。您可以使用下面的命令将<strong class="iv hi">环境的当前</strong>包列表添加到需求中。</p><blockquote class="nq"><p id="bea4" class="nr ns hh bd nt nu nv nw nx ny nz jq dx translated">pip冻结&gt;要求。文本文件（textfile）</p></blockquote><p id="ba12" class="pw-post-body-paragraph it iu hh iv b iw oa iy iz ja ob jc jd je oc jg jh ji od jk jl jm oe jo jp jq ha bi translated">Procfile用于首先执行<strong class="iv hi"> setup.sh </strong>，然后调用streamlit run运行应用程序。</p><p id="c3f2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">而rf_model是’。包含我们的模型的“pkl”文件。</p><p id="156c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">但是如何部署呢？</strong></p><p id="beb1" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">去<a class="ae jr" href="https://share.streamlit.io/" rel="noopener ugc nofollow" target="_blank">https://share.streamlit.io/</a>用你的GitHub账户注册。我说过你的代码必须托管在Github仓库里吗？请告知！</p><p id="c063" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">从下面的截图可以看出，你必须用你的GitHub和你的主帐户登录，才能继续部署。</p><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es of"><img src="../Images/018cf27b9c102e257aa2eff0fbec7423.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*6vVdLzKdk_e4Rf952w62oA.png"/></div></figure><p id="fc35" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">点击<strong class="iv hi">新应用</strong>，然后点击<strong class="iv hi">从现有回购</strong></p><figure class="mo mp mq mr fd ii er es paragraph-image"><div class="er es og"><img src="../Images/99c9d51a4bff8cca7ff793f562afad44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*E2auRSjNvvGnQIFlEoEasw.png"/></div></figure><p id="23a3" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">然后进入<strong class="iv hi">库扩展</strong>，点击<strong class="iv hi">部署</strong>。你可以走了！</p><figure class="mo mp mq mr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oh"><img src="../Images/c7e93f49c4ea4adf3203ebc835c76641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f547uW9F0UhDliSb7Zc70g.png"/></div></div></figure><p id="2e1a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">定价呢？</strong></p><p id="436b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如你所见，这太棒了！与Heroku不同的是，在社区计划中，您可以自由使用该服务，次数不限。</p><figure class="mo mp mq mr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oi"><img src="../Images/9be5629c08a24617e2e55a45d1c73c09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-LV0182N9cciqLb382YOg.png"/></div></div></figure></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><p id="03f6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">感谢您在机器学习的探索之旅中支持我！请提供任何可能帮助我提高写作水平的反馈，最重要的是我的项目方法！</p><div class="lq lr ez fb ls lt"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lu ab dw"><div class="lv ab lw cl cj lx"><h2 class="bd hi fi z dy ly ea eb lz ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ma l"><h3 class="bd b fi z dy ly ea eb lz ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mb l"><p class="bd b fp z dy ly ea eb lz ed ef dx translated">medium.com</p></div></div><div class="mc l"><div class="oj l me mf mg mc mh in lt"/></div></div></a></div></div></div>    
</body>
</html>