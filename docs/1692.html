<html>
<head>
<title>Stream live crypto data from binance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">来自币安的实时加密数据流</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/how-to-get-live-crypto-data-from-binance-7a5e5ec10de4?source=collection_archive---------0-----------------------#2022-01-20">https://medium.com/mlearning-ai/how-to-get-live-crypto-data-from-binance-7a5e5ec10de4?source=collection_archive---------0-----------------------#2022-01-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/dd264b27613cb6900f92782c903fc520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TKTpW-8zHBfpJjKp"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@jjying?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JJ Ying</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="da76" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要制定交易策略，你需要大量的数据。黄牛和日交易者使用高粒度数据，所以REST API的性能不足以获取实时数据。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="f219" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">秘密在于传输高精度数据的websocket通信。例如，在websocket数据流上，我们可以获得实时交易的数据、Klines(参见:<a class="ae it" rel="noopener" href="/@gabriele.deri/how-to-download-trading-data-from-binance-with-python-21634af30195">https://medium . com/@ Gabriele . deri/how-to-download-trading-data-from-币安-with-python-21634af30195 </a>)甚至特定符号的订单簿。</p><p id="920f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将使用python和websocket客户端来连接币安Websocket流。这同样适用于其他加密交换，只需更改端点和消息有效负载值。</p><p id="ed25" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你可以在这里阅读交易所文档现货、期货或保证金的websocket端点:<a class="ae it" href="https://binance-docs.github.io/apidocs/spot/en/#websocket-market-streams" rel="noopener ugc nofollow" target="_blank">https://币安-docs . github . io/API docs/spot/en/# web socket-market-streams</a></p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="cd6d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先让我们用pip安装websocket客户端</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="3a53" class="ki kj hh ke b fi kk kl l km kn">pip3 install websocket-client</span></pre><p id="ed8b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，我们将从文档中获取websocket端点，并检索某个符号的已执行交易的数据。在这个例子中，我将使用ETHUSDT贸易流。请记住，交易符号必须以小写形式插入websocket路径，而不是像REST请求那样以大写形式插入。</p><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="ko kp l"/></div></figure><p id="f01c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">像普通函数一样调用ws_trade()函数，wsapp.run_forever()将处理所有来自币安的消息，并显示消息。</p><p id="94b6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我还创建了一个函数handle_trades()来将收到的json转换成可读性更好的消息。所接收的对象中的每个键的含义在公开的币安文档上是可读的。该函数还将纪元转换为日期。在这里，我将从我的终端放一个示例png</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es kq"><img src="../Images/bd981a328225b4b5cb7fa043b6ee0ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*IKXVfQtd0EAbyc3cswfYSg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">handle_trades()</figcaption></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kr"><img src="../Images/1ffb042cf7dca5c55787dd5eca46332a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1yZMtT8uHhAoaT6ZtT2nw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Raw websocket message</figcaption></figure><p id="12f8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我希望这篇文章在某些方面有所帮助。如果需要的话，请随时询问进一步的信息，并为将来要发表的文章留下建议！</p><div class="ks kt ez fb ku kv"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kw ab dw"><div class="kx ab ky cl cj kz"><h2 class="bd hi fi z dy la ea eb lb ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lc l"><h3 class="bd b fi z dy la ea eb lb ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ld l"><p class="bd b fp z dy la ea eb lb ed ef dx translated">medium.com</p></div></div><div class="le l"><div class="lf l lg lh li le lj in kv"/></div></div></a></div></div></div>    
</body>
</html>