<html>
<head>
<title>Stroke prediction: Logistic Regression with Julia🚑</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卒中预测:Julia的逻辑回归分析🚑</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/stroke-prediction-logistic-regression-with-julia-523f90eb5ae?source=collection_archive---------3-----------------------#2022-03-18">https://medium.com/mlearning-ai/stroke-prediction-logistic-regression-with-julia-523f90eb5ae?source=collection_archive---------3-----------------------#2022-03-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/4097bedff0d7eb38f20cf08524951d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4pUuse0FTUKBSC6nP7WoaQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by DS stories: <a class="ae it" href="https://www.pexels.com/photo/photograph-of-pink-brains-on-a-blue-surface-9228390/" rel="noopener ugc nofollow" target="_blank">https://www.pexels.com/photo/photograph-of-pink-brains-on-a-blue-surface-9228390/</a></figcaption></figure><p id="a35f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本文旨在用<em class="js">茱莉亚语言</em>展示如何使用<em class="js">逻辑回归</em>预测中风。</p><p id="9b55" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我选择了来自Kaggle的<a class="ae it" href="https://www.kaggle.com/fedesoriano/stroke-prediction-dataset" rel="noopener ugc nofollow" target="_blank">中风预测数据集</a>。</p><p id="1562" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">那么，我们会在这里看到什么？</p><ul class=""><li id="3c14" class="jt ju hh iw b ix iy jb jc jf jv jj jw jn jx jr jy jz ka kb bi translated">数据导入</li><li id="c169" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">不适用，用平均值代替</li><li id="6a62" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">字符串到浮点64转换</li><li id="3921" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">删除列</li><li id="2c0a" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">标签编码</li><li id="c68f" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">Smote技术平衡我们的数据</li><li id="c043" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">训练/测试分割</li><li id="cb25" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">逻辑回归模型</li><li id="9ac8" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">混淆矩阵</li><li id="391f" class="jt ju hh iw b ix kc jb kd jf ke jj kf jn kg jr jy jz ka kb bi translated">❗Bonus:如何处理朱丽亚·❗️的一个具体错误</li></ul></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="7352" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先，我<strong class="iw hi">导入必要的包:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="dec9" class="kx ky hh kt b fi kz la l lb lc">using Pkg<br/>using DataFrames<br/>using CSV<br/>using StatsBase<br/>using GLM<br/>using Lathe<br/>using MLBase<br/>using ClassImbalance<br/>using ScikitLearn</span></pre><p id="e455" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我想<strong class="iw hi">启用1000列</strong>的打印，这样我就可以看到数据框的所有列:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="11f9" class="kx ky hh kt b fi kz la l lb lc">ENV["COLUMNS"] = 1000</span></pre><p id="45ed" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们<strong class="iw hi">加载数据并打印数据帧的前5行</strong>:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="3a8c" class="kx ky hh kt b fi kz la l lb lc">df=CSV.read("C:\\Users\\olgak\\Documents\\df.csv", DataFrame)#write your own path<br/>first(df,5)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ld"><img src="../Images/35b138e52780d2b494d856b8e17d5111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HeadkxIStkPWsAFaI-b8tQ.png"/></div></div></figure><p id="2c4e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要查看<strong class="iw hi">变量的名称:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="e8d5" class="kx ky hh kt b fi kz la l lb lc">names(df)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es le"><img src="../Images/da63f51840ede9fb9ef01771638dd175.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*OVZnDeA6pK39JLc3mkIcJg.png"/></div></div></figure><p id="1944" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如我们所见，我们有12个变量。</p><p id="9b94" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">检查<strong class="iw hi">变量的类型:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="7028" class="kx ky hh kt b fi kz la l lb lc">eltype.(eachcol(df))</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/c48ced000e4d11690cfc3fce71b6a623.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*Ihqi5hCt5G00H6oerlSbOQ.png"/></div></figure><p id="669a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">bmi是字符串变量吗？不，它是一个浮点数64，因为bmi是一个数字(连续变量)。</p><p id="8752" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们是否有任何<strong class="iw hi">缺失值</strong>？</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9792" class="kx ky hh kt b fi kz la l lb lc">[count(ismissing,col) for col in eachcol(df)]</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/ae9bc796d6c352ac24fefb11a8baf0a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Bfk2ffi8n3Yx-aOoUz1aGg.png"/></div></figure><p id="5b1c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们没有像“缺失”或空单元格这样的缺失值，但我们在bmi变量的某些单元格中有N/A。N/A也是我们的bmi变量是字符串的原因。</p><p id="c374" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的目的是移除N/A值并将bmi变量转换为Float64。(如果我们不把bmi转换成Float64，我们就有问题了。)</p><p id="b796" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我选择用0代替N/A(BMI仍然是字符串)。N/A是一个字符，所以我们也选择写0作为一个字符。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="eac9" class="kx ky hh kt b fi kz la l lb lc">bmi=replace(df.bmi, "N/A" =&gt; "0")</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/8f5b162b3b0d3d62babcad5fa5f598c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*1nBN8z9deqW9NYTZbwXkog.png"/></div></figure><p id="8076" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们到处都有数字，所以我们可以简单地将所有这些数字转换成浮点T21，没有任何问题。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="2d4f" class="kx ky hh kt b fi kz la l lb lc">df.bmi=parse.(Float64, bmi)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es li"><img src="../Images/946dcb40d336ed83ff0fbd1b8eb4b63f.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*DoU9dGl7OhkRPlqZaLwarw.png"/></div></figure><p id="0d2e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将bmi转换为Float64，但是对于零值我们需要做什么呢？删除它们(结果我们删除了数据，留下的数据更少)？</p><p id="7cdd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我更喜欢用bmi的平均值代替零值(缺失数据)。</p><p id="e010" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请注意，如果我们按原样计算bmi的平均值，我们将得到错误的结果，因为我们的bmi值为0。bmi为0并不是一个真实值。</p><p id="8d75" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，我们需要删除零值，计算平均值，最后，用我们找到的平均值替换零值。</p><p id="bc12" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我创建了一个名为“nm”的新变量(我不想破坏我新的漂亮的bmi变量😎).此变量不包含零值。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9b7a" class="kx ky hh kt b fi kz la l lb lc">nm=deleteat!(bmi, findall(bmi-&gt;bmi==0.0,df.bmi))</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es lj"><img src="../Images/928eb3c10580384e856dbde26ffdc79e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*ZkMZ1L3uNlmMcZSGJQ9Qww.png"/></div></figure><p id="1c9f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我不能计算字符串变量的平均值。</p><p id="f75f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我再次创建了一个新变量(与Float64相同):</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="76db" class="kx ky hh kt b fi kz la l lb lc">nmm=parse.(Float64, nm)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lk"><img src="../Images/a11fb4811eefeea3a91d2e1d60f2097e.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*Dha9SwKIy4yNoyiZBSSdVw.png"/></div></div></figure><p id="bf5b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，我创建了包含平均值的变量:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="c746" class="kx ky hh kt b fi kz la l lb lc">m=mean(nmm)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es ll"><img src="../Images/2ec7e4d594be2ab42e9d73d59c289b6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*XrSL6cBdH8fWOD7C2RGGEA.png"/></div></figure><p id="55c7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">bmi变量保持不变(Float64用零值代替N/A)。让我们确认一下:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="1ace" class="kx ky hh kt b fi kz la l lb lc">df</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lm"><img src="../Images/15e14252d7e506e905af3ffe3e26250a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*On5blydeFPFjRnycd3N88w.png"/></div></div></figure><p id="4c6f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，我将<strong class="iw hi">用平均值代替零:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="9628" class="kx ky hh kt b fi kz la l lb lc">df.bmi=replace(df.bmi, 0.0 =&gt; m)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ln"><img src="../Images/c22d22c0003005f781683bc3c58ec5d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WGSHL7o7o-U550_Q63UOfA.png"/></div></div></figure><p id="b10a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">准备好了。</p><figure class="ko kp kq kr fd ii"><div class="bz dy l di"><div class="lo lp l"/></div></figure><p id="508f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">是时候对我们的分类变量应用标签编码器了。</p><p id="ad4a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我想将<strong class="iw hi">标签编码器</strong>应用于以下各列:</p><p id="e138" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2(性别)、6(曾经结过婚)、7(工作类型)、8(居住类型)、11(吸烟状况)</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="0ace" class="kx ky hh kt b fi kz la l lb lc"><a class="ae it" href="http://twitter.com/sk_import" rel="noopener ugc nofollow" target="_blank">@sk_import</a> preprocessing: LabelEncoder</span><span id="2d4c" class="kx ky hh kt b fi lq la l lb lc">labelencoder = LabelEncoder() <br/>categories = [2 6 7 8 11] <br/>for col in categories <br/>     df[col] = fit_transform!(labelencoder, df[col]) <br/>end</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lr"><img src="../Images/b1d435636e50fbf4601a14e0ad0afe64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqjSGkP1DXiJWu18LiI_5w.png"/></div></div></figure><p id="2e3a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">但是，我们需要id <strong class="iw hi">列</strong>吗？不。让我们把<strong class="iw hi">删掉</strong>吧！</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="671e" class="kx ky hh kt b fi kz la l lb lc">deletecols!(df, 1)</span></pre><p id="ecd8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，我将<strong class="iw hi">检查不平衡:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="0a88" class="kx ky hh kt b fi kz la l lb lc">countmap(df.stroke)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/9223569343956debe901a747b28e6eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*3VzxzfpPpW66Ngl01_CMnw.png"/></div></figure><p id="6f84" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们有不平衡的数据，我们需要处理它。</p><p id="2662" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将使用<strong class="iw hi"> smote </strong>技术来处理职业不平衡。</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="1878" class="kx ky hh kt b fi kz la l lb lc">X2, y2 =smote(df[!,[:gender,:age ,:hypertension, :heart_disease, :ever_married, :work_type, :Residence_type, :avg_glucose_level, :bmi , :smoking_status]], df.stroke, k = 5, pct_under = 150, pct_over = 200)</span><span id="b20c" class="kx ky hh kt b fi lq la l lb lc">df_balanced = X2</span><span id="358a" class="kx ky hh kt b fi lq la l lb lc">df_balanced.stroke = y2</span></pre><p id="6aa1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们看看我们的平衡数据:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="2668" class="kx ky hh kt b fi kz la l lb lc">df = df_balanced</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lt"><img src="../Images/c0648de98bc1132cc3439e692a20ced8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5micP5QsTTZdeRG84z9-bw.png"/></div></div></figure><p id="913e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">再次计算类别:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="278d" class="kx ky hh kt b fi kz la l lb lc">countmap(df.stroke)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es lu"><img src="../Images/96dd41375366e02d6c306a8bfed6d5b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*jmgRrdHqaAPEbk5ffHZrbQ.png"/></div></figure><p id="a92e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们现在没事了！</p><p id="04c4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们将<strong class="iw hi">拆分为</strong>进行训练和测试:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="3ea4" class="kx ky hh kt b fi kz la l lb lc">using Lathe.preprocess: TrainTestSplit<br/>train, test = TrainTestSplit(df,.70)</span></pre><p id="142f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">并训练<strong class="iw hi">逻辑回归模型:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="5fa6" class="kx ky hh kt b fi kz la l lb lc">fm = <a class="ae it" href="http://twitter.com/formula" rel="noopener ugc nofollow" target="_blank">@formula</a>(stroke ~ gender+age+hypertension+heart_disease+ever_married+work_type+Residence_type+avg_glucose_level+bmi+smoking_status)</span><span id="24c4" class="kx ky hh kt b fi lq la l lb lc">logit = glm(fm, train, Binomial(), ProbitLink())</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lv"><img src="../Images/ef06578fd0a20e61c5090c20fa0ccfc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S41w884aLX3l-tIKVPPTYQ.png"/></div></div></figure><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="8288" class="kx ky hh kt b fi kz la l lb lc">using MLBase: predict #look at the end of the article if you want to avoid headache</span><span id="2e47" class="kx ky hh kt b fi lq la l lb lc">prediction=predict(logit,test)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es lw"><img src="../Images/37b2b062c23d70b944891aad89ad8941.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*9JgbMLhAu4ScqDDBqh0EVg.png"/></div></figure><p id="f3e7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将<strong class="iw hi">将概率分数转换为类:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="ff2c" class="kx ky hh kt b fi kz la l lb lc">prediction_class = [if x &lt; 0.5 0 else 1 end for x in prediction]</span><span id="a28b" class="kx ky hh kt b fi lq la l lb lc">prediction_df = DataFrame(y_actual = test.stroke, y_predicted = prediction_class, prob_predicted = prediction)</span><span id="8c44" class="kx ky hh kt b fi lq la l lb lc">prediction_df.correctly_classified = prediction_df.y_actual .== prediction_df.y_predicted</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/eda81ddab9d1f8c6f1eb4bee97bd4b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*3WhAGPG-12rKPfLY0LEyXw.png"/></div></figure><p id="ebf4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">还有……我们的<strong class="iw hi">准确率得分</strong>？</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="bf6c" class="kx ky hh kt b fi kz la l lb lc">accuracy = mean(prediction_df.correctly_classified)<br/>print("Accuracy of the model is : ",accuracy)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/eec4ec3cfeb513f5f220067b92d64365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*gWKqKBPGn45ERX1mnCDVrg.png"/></div></figure><p id="694c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">还不错！</p><figure class="ko kp kq kr fd ii"><div class="bz dy l di"><div class="lz lp l"/></div></figure><p id="9f98" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，让我们创建<strong class="iw hi">混淆矩阵:</strong></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="0146" class="kx ky hh kt b fi kz la l lb lc">confusion_matrix = MLBase.roc(prediction_df.y_actual, prediction_df.y_predicted)</span></pre><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/b12834db4c058c5dee0393d6876ffb97.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*gltmTnnWw92Hx4HsQCVIkg.png"/></div></figure></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="1c9e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">❗️It's写下了极其重要的代码:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="7906" class="kx ky hh kt b fi kz la l lb lc">using MLBase: predict</span></pre><p id="550d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你不写这个，你可能要处理这个错误:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="d157" class="kx ky hh kt b fi kz la l lb lc">UndefVarError: predict not defined</span></pre><p id="d589" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是因为我们加载了另一个导出预测的包(在我们的例子中是GLM包),它与MLBase的预测相冲突。所以我们需要指定从哪里使用predict。</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="a978" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">查看我的笔记本<a class="ae it" href="https://github.com/OlgaEle/My_Notebooks/blob/main/Julia/JuliaStrokePredictionLogisticRegression.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="8c30" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">收尾</strong></p><p id="5277" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在本文中，我们看到了如何在Julia中训练逻辑回归模型！</p><p id="432d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当然，我们的分析还可以更好。</p><p id="6d70" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">敬请关注更新！</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="05d5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">感谢您的阅读！🤗</p><div class="mb mc ez fb md me"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hi fi z dy mj ea eb mk ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">medium.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms in me"/></div></div></a></div></div></div>    
</body>
</html>