<html>
<head>
<title>Create Fake Customer Calls For NLP With Hugging Face Transformers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用拥抱面部变形器为NLP创建虚假的客户呼叫</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/create-fake-customer-calls-for-nlp-with-hugging-face-transformers-f1ee2a9e7890?source=collection_archive---------3-----------------------#2021-10-30">https://medium.com/mlearning-ai/create-fake-customer-calls-for-nlp-with-hugging-face-transformers-f1ee2a9e7890?source=collection_archive---------3-----------------------#2021-10-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/497f2231588a2415b179437363f245a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m-GMgs9oUpLm3Y9FNxJuRQ.jpeg"/></div></div></figure><p id="9a47" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">众所周知，你的AI/ML自然语言处理只和你的训练数据集一样好。理想情况下，您希望收集一个相当完整的大型标注数据集。它应该包含足够数量的你想要分类的所有案例的例子。不幸的是，事情很少会变成那样。</p><p id="61ff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">例如，想想呼叫中心的录音。客户通常会打电话来解决常见问题。但也有其他情况很少发生。因此，您的录音数据集不足以让您的模型学会对其进行分类。</p><p id="be5a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">那么您可能会尝试对该数据进行过采样；基本上复制/粘贴它多次，所以你有更多的数据。但这通常不是个好主意。您的模型可能会过度拟合克隆的数据。这意味着它不会识别现实生活中的这种情况，除非它们恰好与训练数据中的完全一样。这时候你就需要有点创造力了。</p><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jn"><img src="../Images/1a2bf2408af53fe38e356b6902a5b69b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1U8_UQAAmkMa5a1rAQXraA.png"/></div></div></figure><p id="9cc1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这个有趣的练习中，我们将学习如何根据真实电话制作模拟客户电话。我们将使用流行的<strong class="ir hi">拥抱脸</strong>变形金刚，从根本上构建原始呼叫的变体。然后，我们将使用文本到语音合成技术将这些虚假的代理-客户对话重新制作成全新的录音。这是扩充数据集的更好方法吗？</p><h1 id="472a" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">今天我能为你做些什么？</h1><p id="8138" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">第一段录音是“原始的”代理-客户交流。对于这个练习，我从头开始创建了一个，以避免隐私或版权问题。这是我的python代码用来创建下面所有模拟录音的录音。该代码还添加了背景噪音和侧面对话，以更加真实。</p><figure class="jo jp jq jr fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="4057" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">代码能够以其他语言输出模拟录音，如上所示。转述的英语对话被翻译，然后相应地发声。这可能有助于创建不同语言的初学者培训数据集。</p><h1 id="cfb1" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">处理概述</h1><p id="3548" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">我的python脚本通过以下步骤生成了一个模拟的代理-客户交换。变化是随机产生的。</p><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kx"><img src="../Images/8119c4fb1b2e34c09062fb889442632b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tx-T8dRwLzuWSpARQVI8OQ.png"/></div></div></figure><h1 id="6285" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">音频转录</h1><p id="0742" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">代码做的第一件事是安排一个转录作业，用<strong class="ir hi"> AWS转录</strong>原始音频文件。我们在作业请求中明确指定录音包含两个扬声器，每个声道一个。这样文字记录会清楚地告诉我们谁说了什么。</p><h1 id="3a20" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">处理记录</h1><p id="8379" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">一旦有了抄本，我们需要从中摘录每个发言者所说的所有句子。这是一个JSON转录单词列表，每个发言者一个列表。每个单词都有一个置信度和它在音频中的时间位置，见下文。列表中的标点符号表示一个句子的结束和一个新句子的开始。</p><pre class="jo jp jq jr fd ky kz la lb aw lc bi"><span id="a54c" class="ld jt hh kz b fi le lf l lg lh">{<br/>  "start_time": "13.58",<br/>  "end_time": "14.01",<br/>  "alternatives": [<br/>    {<br/>      "confidence": "1.0",<br/>      "content": "magic"<br/>    }<br/>  ],<br/>  "type": "pronunciation"<br/>}</span></pre><p id="1d88" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对话的时间线被构建来保存交流的流程和原因。这在以后拼接新的模拟音频时非常重要。</p><h1 id="bba1" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">拥抱脸变换</h1><p id="f121" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated"><a class="ae li" href="https://huggingface.co/" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">抱脸</strong> </a>中的<a class="ae li" href="https://huggingface.co/tuner007/pegasus_paraphrase" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">飞马</strong> </a>变形金刚用来意译句子。</p><p id="67f3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">拥抱脸是NLP最近的宠儿，它的使命是将变形金刚的最新进展民主化。变压器结合了编码器模型的分析能力和解码器模型的生成能力。</p><p id="0ad4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">飞马用它的编码器分析我们给它的原句。然后，它的生成解码器产生一个用不同方式表达相同事物的释义句子。</p><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/5de62ad4c3ac2a4105394cedb62c66e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cx2zRUBPV8u_Z-JncrBAYw.png"/></div></div></figure><p id="f8f7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了更好地衡量，代码插入了没有分类值的随机填充句子，以改变对话流。更进一步，考虑使用GPT家族的文本生成器。</p><p id="0f48" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此外，打电话的顾客通常会以较低的音量与附近的人进行闲聊，比如孩子、出租车司机和食品摊贩。代码中给出了几个例子。较低的体积被指定用于使用该SSML标签进行渲染。稍后会详细介绍。</p><pre class="jo jp jq jr fd ky kz la lb aw lc bi"><span id="24db" class="ld jt hh kz b fi le lf l lg lh">&lt;prosody volume="-13dB"&gt; {} &lt;/prosody&gt;</span></pre><p id="d1fe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这对于我们的演示目的来说已经足够好了。但是可以尝试更多的技术。尝试将句子拼凑在一起，或者用行业中常用的同义词替换特定领域的单词。对可用数据进行主题分析，以构建更大的可互换对话结构。最后，考虑用你自己的数据微调Pegasus模型，以便更好地解释。</p><h1 id="4662" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">文本到语音合成</h1><p id="0fec" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">一旦转述对话准备就绪，我们就可以使用<strong class="ir hi"> AWS Polly </strong>开始文本到语音的合成。</p><p id="fef5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">波利可以接受纯文本或SSML格式的文本。SSML是一种标记语言，使您能够指定文本的声音表达。例如，它可以是小声的或者变得更大声、更快或更慢，等等。在电码中，SSML用来控制语速。请随意尝试。</p><pre class="jo jp jq jr fd ky kz la lb aw lc bi"><span id="85ce" class="ld jt hh kz b fi le lf l lg lh">&lt;speak&gt;&lt;prosody rate="fast"&gt; This text is spoken fast &lt;/prosody&gt;&lt;/speak&gt;</span></pre><p id="e192" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Polly通常会被要求将渲染后的音频文件放入s3存储桶中。但它也可以在响应中直接提供原始音频。音频数据将为16位PCM格式，频率为16，000 Hz。这是我在代码中使用的内存处理方法。但是如果你在它前面加上一个WAV文件头，你可以把它保存为一个可播放的文件。</p><p id="536d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该代码为每个说话者随机选择一个不同的合成声音。声音有两种味道:神经的或标准的。神经听起来更自然，但不像标准那样可用。它也有一些SSML限制。</p><p id="b25c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们之前构建的时间线然后被迭代。每个句子都单独以音频形式呈现。将返回音频的持续时间与原始句子的持续时间进行比较。如果更长，那么时间表必须相应调整。</p><h1 id="2036" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">音频组件</h1><p id="29a5" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">整个音频在内存中由16位带符号短路阵列构成。音频阵列最初被归零以使它们静音。然后，每个句子PCM音频数据根据其在时间线中的开始时间写入。Polly很好，可以产生无声开始和结束的音频。所以没有剪辑和硬弹出来担心。</p><p id="7a49" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一旦完成，数组将被保存为正确的音频文件。使用方便的<a class="ae li" href="https://docs.python.org/3/library/wave.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi"> <em class="lk">波</em></strong>T5】python库将文件格式化成标准的WAV格式。</a></p><p id="0158" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了进一步挑战你的转录技术，考虑做更多的音频处理。你可以随意改变扬声器的音量，做一些带通滤波。甚至对音频进行随机下采样和抽取，以再现偶尔过度的手机压缩。</p><h1 id="a400" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">关于作者</h1><p id="8a3f" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated"><em class="lk"> Pierre是一家大型云提供商的深度学习架构师。他的工作日职责是确保客户在使用和部署人工智能和机器学习技术方面非常成功。</em></p></div></div>    
</body>
</html>