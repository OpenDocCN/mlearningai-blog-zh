<html>
<head>
<title>Stereo Vision: Making a Depth Map from scratch!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">立体视觉:从零开始制作深度图！</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/stereo-vision-making-a-depth-map-from-scratch-6cd25c82897a?source=collection_archive---------0-----------------------#2021-03-23">https://medium.com/mlearning-ai/stereo-vision-making-a-depth-map-from-scratch-6cd25c82897a?source=collection_archive---------0-----------------------#2021-03-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/56d31a6a559279e6ada985d13be2bc20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XexYkok9OoLjOkKXiRS3Zg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">End product!</figcaption></figure><p id="4df5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">欢迎阅读本系列的第2部分！现在我们理解了立体视觉的<a class="ae jr" href="https://aryanvij02.medium.com/stereo-vision-how-do-terminators-see-the-world-5a70f3a1f4d1" rel="noopener">概念(第一部分)</a>，让我们最终继续创建我们的深度图。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="9f35" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">让我们启动这台相机吧！</h1><p id="7562" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">我们将在本教程中使用的所有脚本都是用Python编写的。</p><p id="dd7b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">首先，克隆我的<a class="ae jr" href="https://github.com/aryanvij02/StereoVision.git" rel="noopener ugc nofollow" target="_blank"> <strong class="iv hi">立体视觉</strong>库</a>。</p><h1 id="2fb8" class="jz ka hh bd kb kc lc ke kf kg ld ki kj kk le km kn ko lf kq kr ks lg ku kv kw bi translated">要求</h1><p id="9fa3" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">如果您尚未设置您的Jetson Nano，请访问<a class="ae jr" href="https://developer.nvidia.com/embedded/learn/get-started-jetson-nano-devkit" rel="noopener ugc nofollow" target="_blank">该网站</a>。</p><p id="2f48" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">假设您已经安装并运行了Jetson Nano，让我们安装这个项目的所有需求。</p><p id="9e65" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">因为我们将在Python3.6上工作，所以让我们安装</p><p id="3912" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">Python3的pip:<code class="du lh li lj lk b">sudo apt-get install python3-pip</code></p><p id="b239" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">Python3.6开发包:<code class="du lh li lj lk b">sudo apt-get install libpython3-dev</code></p><p id="31aa" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">然后安装</strong>所有其他要求:<code class="du lh li lj lk b">pip3 install -r requirements.txt</code></p><p id="c46f" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="ll">如果您希望手动安装需求，您可以键入:</em></p><pre class="lm ln lo lp fd lq lk lr ls aw lt bi"><span id="210d" class="lu ka hh lk b fi lv lw l lx ly"><strong class="lk hi">Install cython: </strong>pip3 install cython<strong class="lk hi"><br/>Install numpy: </strong>pip3 install numpy<strong class="lk hi"><br/>Install StereoVision library:</strong> pip3 install StereoVision</span></pre><blockquote class="lz ma mb"><p id="da27" class="it iu ll iv b iw ix iy iz ja jb jc jd mc jf jg jh md jj jk jl me jn jo jp jq ha bi translated">旁注:如果你在这个项目中遇到任何错误，请前往我的回购的<a class="ae jr" href="https://github.com/aryanvij02/StereoVision/blob/master/TROUBLESHOOT.md" rel="noopener ugc nofollow" target="_blank"> <strong class="iv hi">故障排除</strong>部分。</a></p></blockquote></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="5e9c" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">测试摄像机</h1><p id="6cd9" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">在为我们的立体摄像机创建合适的外壳或临时支架之前，让我们测试一下摄像机是否打开。</p><p id="408c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在，您可以插入两个Raspberry Pi摄像机，并测试它们在输入以下终端命令后是否运行:</p><pre class="lm ln lo lp fd lq lk lr ls aw lt bi"><span id="dcc8" class="lu ka hh lk b fi lv lw l lx ly"># sensor_id selects the camera: 0 or 1 on Jetson Nano B01<br/>$ gst-launch-1.0 nvarguscamerasrc sensor_id=0 ! nvoverlaysink</span></pre><p id="256d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">对sensor_id= 0和1尝试此操作，以测试两台摄像机是否都工作。</p><p id="f009" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果您遇到这样的GStreamer错误:</p><figure class="lm ln lo lp fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/ae7bb2af36919f4dd4731d78e74c2d03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wDPIHC_TUR_v0YpFkXXBrA.png"/></div></div></figure><p id="e54c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在您的终端中键入<code class="du lh li lj lk b">sudo service nvargus-daemon restart</code>，然后重试。</p><blockquote class="lz ma mb"><p id="76a0" class="it iu ll iv b iw ix iy iz ja jb jc jd mc jf jg jh md jj jk jl me jn jo jp jq ha bi translated">有时，在退出程序时，Gstreamer管道可能没有正确关闭。因此，这个命令非常方便(你应该记住)<em class="hh">😃</em>！</p></blockquote><p id="39c7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果问题仍然存在，请确保摄像机已正确插入，并重新启动Jetson Nano。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="cbe4" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">修复粉色色调</h1><p id="f021" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">如果你意识到你的相机有轻微的粉红色，请遵循谢霆锋的这些步骤。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="1bd3" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">准备好硬件设置</h1><p id="e573" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">在我们进一步移动之前，我们必须有一个稳定的立体相机，两个树莓Pi镜头相隔固定距离放置(这是<strong class="iv hi">基线</strong>)。</p><blockquote class="lz ma mb"><p id="4932" class="it iu ll iv b iw ix iy iz ja jb jc jd mc jf jg jh md jj jk jl me jn jo jp jq ha bi translated">始终保持基线固定是很重要的。<strong class="iv hi">我发现5厘米的基线是最佳的</strong>，但你可以尝试不同的分隔距离，并对你的结果发表评论！</p></blockquote><p id="6274" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">有很多方法可以做到这一点，所以发挥你的想象力吧！</p><figure class="lm ln lo lp fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/10bee324b3b70606e4dc8c6eb77b0583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JkMDoDyLSP1dSpeDNJC1HQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">My enclosure — Before and After</figcaption></figure><p id="1fd8" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">最初，我使用BluTac将相机贴在一部旧iPhone和Jetson Nano盒子上。</p><p id="b449" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我决定使用onShape设计一个简单的3D CAD模型。然后，我用激光切割机从丙烯酸树脂上切下碎片，产生了你在右边看到的像狗一样的外壳😜！</p><p id="53c5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">有兴趣看模型的可以查看我的<a class="ae jr" href="https://cad.onshape.com/documents/7aeddf5889fd6bfdc7079b51/w/1a42e3836ac1d3923a56fadd/e/36f50dd4d2464144682a21eb" rel="noopener ugc nofollow" target="_blank"> CAD设计</a>！</p><p id="5736" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果你想设计自己的CAD模型，你可以从<a class="ae jr" href="https://developer.nvidia.com/jetson-nano-developer-kit-b01-3d-cad-step-model" rel="noopener ugc nofollow" target="_blank">这里</a>下载3D STEP模型。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="1bb6" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">启动摄像机</h1><p id="ba1b" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">既然我们已经确保摄像机连接正确，让我们开始吧。</p><p id="34ec" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要运行Python脚本，请在终端中导航到<code class="du lh li lj lk b">/StereoVision/main_scripts/</code>目录。</p><p id="49a8" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">运行<strong class="iv hi">start _ camera . py</strong>脚本:<code class="du lh li lj lk b">python3 start_cameras.py</code></p><p id="8761" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">您应该可以同时看到两台摄像机的实时视频。</p><blockquote class="lz ma mb"><p id="0e1b" class="it iu ll iv b iw ix iy iz ja jb jc jd mc jf jg jh md jj jk jl me jn jo jp jq ha bi translated">如果您在启动相机时遇到任何错误，<a class="ae jr" href="https://github.com/aryanvij02/StereoVision/blob/master/TROUBLESHOOT.md" rel="noopener ugc nofollow" target="_blank">请访问此页面</a>。</p></blockquote></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="d2be" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">让我们准备好棋盘！</h1><p id="2b17" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">我将为这个项目使用6x9(行x列)棋盘。你可以从我的<a class="ae jr" href="https://github.com/aryanvij02/StereoVision" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中获得图像，或者如果你已经克隆了它，那么你就有了文件！</p><figure class="lm ln lo lp fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mh"><img src="../Images/40be20f9b0a3cd9b8f36676954d7630e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2SYhBf8QOBbf0qy5i7oQw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Chessboard. Source: OpenCV</figcaption></figure><p id="cd1d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">打印出图片(确保不适合页面或改变缩放比例)并将图像粘贴到坚硬的表面上(如剪贴板或盒子)。</p><p id="8eba" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">最简单的方法是使用我提供的这张棋盘图片。但是，如果您希望使用自己的棋盘，请更改第16行和第19行的<strong class="iv hi"> 3_calibration.py </strong>。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="5261" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">拍照</h1><p id="dcd6" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">我们将每隔5秒拍摄30张照片。</p><h2 id="9657" class="lu ka hh bd kb mi mj mk kf ml mm mn kj je mo mp kn ji mq mr kr jm ms mt kv mu bi translated">建议</h2><ol class=""><li id="aafe" class="mv mw hh iv b iw kx ja ky je mx ji my jm mz jq na nb nc nd bi translated">不要站得太远。确保棋盘覆盖了相机框架的大部分。</li><li id="6940" class="mv mw hh iv b iw ne ja nf je ng ji nh jm ni jq na nb nc nd bi translated">确保盖住框架的所有角落。</li><li id="6fe7" class="mv mw hh iv b iw ne ja nf je ng ji nh jm ni jq na nb nc nd bi translated">确保在图像之间移动和旋转棋盘，以获得不同角度的图片。</li></ol><p id="86f2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在每张图片之间稍微移动棋盘，但确保不要切掉图像的一部分。来自两台相机的图像将被拼接在一起，并保存为一个文件。</p><p id="00e6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要拍照，输入<code class="du lh li lj lk b">python3 1_taking_pictures.py</code></p><blockquote class="lz ma mb"><p id="386e" class="it iu ll iv b iw ix iy iz ja jb jc jd mc jf jg jh md jj jk jl me jn jo jp jq ha bi translated"><strong class="iv hi">如果您在尝试启动摄像机时遇到错误</strong>，提示:<strong class="iv hi"> <em class="hh">未能加载模块“Canberra-GTK-module”…</em></strong></p><p id="db80" class="it iu ll iv b iw ix iy iz ja jb jc jd mc jf jg jh md jj jk jl me jn jo jp jq ha bi translated">试试这个:<code class="du lh li lj lk b">sudo apt-get install libcanberra-gtk-module</code></p></blockquote><p id="6b3c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果您希望增加图片之间的<strong class="iv hi">时间间隔</strong>或拍摄的<strong class="iv hi">图片总数</strong>，请修改1_taking_pictures.py脚本。拍照预设就在顶部。</p><figure class="lm ln lo lp fd ii"><div class="bz dy l di"><div class="nj nk l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Modify this!</figcaption></figure><blockquote class="nl"><p id="46ee" class="nm nn hh bd no np nq nr ns nt nu jq dx translated"><strong class="ak">如果您想停止本系列中的任何Python程序，请按键盘上的Q。</strong></p></blockquote><p id="5a77" class="pw-post-body-paragraph it iu hh iv b iw nv iy iz ja nw jc jd je nx jg jh ji ny jk jl jm nz jo jp jq ha bi translated">你现在应该有一个名为“图像”的新文件夹，里面保存了你刚刚拍摄的所有照片！</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="a425" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">接受/拒绝和分割图片。</h1><p id="68e1" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">确保我们不使用质量差的图像(棋盘的缺失部分，模糊等)。)为了校准，我们将仔细检查拍摄的每张照片，并接受或拒绝它。</p><p id="1ddf" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为此，让我们运行<code class="du lh li lj lk b">python3 2_image_selection.py</code></p><p id="f6dd" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">浏览所有图像。按'<strong class="iv hi"> Y </strong>保存图像，按'<strong class="iv hi"> N </strong>跳过。</p><p id="f340" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在，左摄像机和右摄像机图像将分别保存在名为“<strong class="iv hi">对</strong>的文件夹中。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="35e6" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">校准时间！</h1><p id="fff6" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">这是这一系列中极其重要的一步。对于我们来说，校正和校准我们的相机以获得理想的视差图是必不可少的。</p><blockquote class="lz ma mb"><p id="024a" class="it iu ll iv b iw ix iy iz ja jb jc jd mc jf jg jh md jj jk jl me jn jo jp jq ha bi translated"><a class="ae jr" href="https://en.wikipedia.org/wiki/Image_rectification" rel="noopener ugc nofollow" target="_blank">阅读更多关于相机矫正的内容。</a></p></blockquote><p id="eeb8" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">多亏了李仁港的<a class="ae jr" href="https://github.com/erget/StereoVision" rel="noopener ugc nofollow" target="_blank">立体视觉库</a>，我们在代码方面不用做太多！</p><p id="cd5d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为了进行校准，我们将遍历您在上一步中保存的所有棋盘图像，并计算校正矩阵。</p><p id="b03a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">该计划将做点匹配过程，并试图找到棋盘的角落。如果你觉得结果不准确，试着重新拍照。</p><figure class="lm ln lo lp fd ii er es paragraph-image"><div class="ab fe cl oa"><img src="../Images/8c0d077592f5f9c3de21607984d6a24a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*QczwjWn554D5v94FxWd2Lw.jpeg"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Point-Matching process</figcaption></figure><p id="b3d0" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为此，让我们运行:<code class="du lh li lj lk b">python3 calibration.py</code></p><p id="6734" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">运行完所有图像对后，给程序一些时间来校准结果(大约1-2分钟)。</p><p id="504b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">一旦完成，您将看到校准结果——校正后的<strong class="iv hi">图像</strong>和<strong class="iv hi">图像</strong>。</p><div class="lm ln lo lp fd ab cb"><figure class="ob ii oc od oe of og paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/ebe80b1319294ab2f608bd946249fe44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ZrV5VmwSLi6iU4MarYILjg.jpeg"/></div></figure><figure class="ob ii oc od oe of og paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/c82e279a1e781cdcf8ce3aa120d2003a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*TJKo_qhQm5bRrfzadj9TrQ.jpeg"/></div><figcaption class="ip iq et er es ir is bd b be z dx oh di oi oj">rectified_left.png &amp; rectified_right.png</figcaption></figure></div><p id="63e9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果您的校准结果看起来有点不可靠(如上)，您可以尝试重复步骤1-3。</p><p id="62fc" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">你整改后的图像永远不会看起来完美，所以不要害怕结果，继续下一步！</p><p id="0795" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">你随时可以回来！</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="fd44" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">调整视差图！</h1><figure class="lm ln lo lp fd ii er es paragraph-image"><div class="er es ok"><img src="../Images/c389a1324b39a1a1eea0f95aed846893.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*vklYvfwckoGptzs_vRlRMA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Tuning GUI</figcaption></figure><p id="2ff5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在我们的相机已经准备好了，让我们开始<strong class="iv hi">调整</strong>视差图本身！</p><p id="5f82" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">运行<strong class="iv hi">4 _ tuning _ depth map . py:</strong><code class="du lh li lj lk b">python3 4_tuning_depthmap.py</code></p><p id="3caf" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要了解这些变量，请查看我的<a class="ae jr" href="https://github.com/aryanvij02/StereoVision.git" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>上的自述文件。</p><p id="c1e9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">调谐杆上的范围可能与说明中列出的范围略有不同。这是因为由于OpenCV的轨迹栏的限制，我不得不修改GUI上显示的参数。</p><p id="e5c6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">通过调整窗口，您还可以看到左右两侧经过调整的灰度图像。这是让你比较你的深度图，知道会发生什么。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="c68b" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">最后…深度图！</h1><p id="21ed" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">所有步骤都完成了！</p><p id="3314" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们终于可以运行<strong class="iv hi"> 5_depthmap.py </strong> : <code class="du lh li lj lk b">python3 5_depthmap.py</code></p><figure class="lm ln lo lp fd ii"><div class="bz dy l di"><div class="ol nk l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Depth map!</figcaption></figure><p id="a388" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在我们有了它，一个我们从头开始创建的全功能深度图！</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="aba8" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">确定与物体的实际距离</h1><p id="e48f" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">你在上面的(<strong class="iv hi"> 5_depthmap.py </strong>)中看到的深度图是一个二维矩阵。所以为什么不从中获取实际的深度信息呢！</p><p id="5a7c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要确定到框架中特定对象的距离，点击它以<strong class="iv hi">厘米</strong>打印到终端的相对距离。通过这样做，您实际上是在确定特定像素离相机有多远。</p><h2 id="b32f" class="lu ka hh bd kb mi mj mk kf ml mm mn kj je mo mp kn ji mq mr kr jm ms mt kv mu bi translated"><em class="om">这个距离到底意味着什么</em></h2><p id="2440" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">现在需要理解的一件事是，测量的距离不是从相机系统中心到系统的精确距离，而是从Z轴到系统的距离。</p><figure class="lm ln lo lp fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es on"><img src="../Images/de14cf16249e3c184266121e4d80fc0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FMGVeniG72dl5fBW1nVnyA.png"/></div></div></figure><p id="c3a4" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">因此，我们实际测量的距离是<strong class="iv hi"> <em class="ll"> y </em> </strong>而不是<strong class="iv hi"><em class="ll"/></strong></p><h1 id="a415" class="jz ka hh bd kb kc lc ke kf kg ld ki kj kk le km kn ko lf kq kr ks lg ku kv kw bi translated">这还没有结束</h1><p id="950f" class="pw-post-body-paragraph it iu hh iv b iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq ha bi translated">深度图很酷。但是终结者也需要能够在攻击人之前发现他们。</p><p id="f540" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">查看<a class="ae jr" href="https://aryanvij02.medium.com/stereo-vision-adding-object-detection-to-our-depth-map-2bce3b45181d" rel="noopener">第3部分</a>为该深度图添加物体检测功能，允许我们确定一个人与相机的相对距离！</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="e4d2" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">来源和参考</h1><ol class=""><li id="2648" class="mv mw hh iv b iw kx ja ky je mx ji my jm mz jq na nb nc nd bi translated"><a class="ae jr" href="https://stereopi.com/blog/opencv-and-depth-map-stereopi-tutorial" rel="noopener ugc nofollow" target="_blank"> StereoPi制作深度图教程。</a></li><li id="9659" class="mv mw hh iv b iw ne ja nf je ng ji nh jm ni jq na nb nc nd bi translated"><a class="ae jr" href="https://www.jetsonhacks.com/2020/04/08/jetson-nano-b01-dual-raspberry-pi-cameras/" rel="noopener ugc nofollow" target="_blank"> JetsonHacks启动树莓Pi相机教程。</a></li></ol></div></div>    
</body>
</html>