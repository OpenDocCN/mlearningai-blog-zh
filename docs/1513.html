<html>
<head>
<title>Wavelet Feature Engineering for EEG Seizure Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">小波特征工程在脑电发作预测中的应用</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/simple-feature-engineering-for-eeg-seizure-prediction-42a7e0ba579?source=collection_archive---------2-----------------------#2021-12-28">https://medium.com/mlearning-ai/simple-feature-engineering-for-eeg-seizure-prediction-42a7e0ba579?source=collection_archive---------2-----------------------#2021-12-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="00d5" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">基于小波分解的脑电活动癫痫发作前状态分类</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/b8d1f9f58da1154b162765f63876b7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3-PxSGSDFhSHlSx_"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@moritz_photography?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Moritz Kindler</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4d81" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">首先:你如何预测癫痫发作？如果你曾经看过Tiktok上那些流行的视频，视频中的狗提醒它们的主人即将到来的癫痫发作，那么你知道这些狗肯定察觉到了一些事情:它们可以用它们的超级感官能力察觉到一些变化。</p><p id="7670" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这个项目的目标是利用注意到这种变化的能力。使用测量大脑中电活动的脑电图(EEG)信号来识别即将发作活动(发作前)和基线大脑活动(发作间期)之间的差异。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kk"><img src="../Images/81d28ee9857489fdcadd98aa7cc4e7f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RV96hnE7DY275VNt"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@richardbrutyo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Richard Brutyo</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="acba" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这个想法是，如果狗能做到，我们也应该能做到。</p><p id="4d41" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这样做的原因不仅仅是求知欲或与我们的犬类同伴的友好竞争:如果我们能够可靠地预测何时癫痫即将发作，我们就可以创造出可穿戴技术，在癫痫患者失去认知或运动控制之前向他们发出警报<em class="kj">。</em></p><p id="d923" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这将是一项改变生活的服务，不仅是对癫痫患者，也是对与他们分享生活的朋友、家人和爱人。患有癫痫症的人可以获得一个安全的空间来应对即将到来的癫痫发作，而患有癫痫症的儿童的父母可以更好地准备支持他们的孩子，而不会措手不及。</p><p id="a31e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这项技术不能治愈，但它是一个有用的工具，可以让癫痫患者的生活变得更容易管理。</p><p id="1003" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">对于肉眼来说，当与发作前(发作前)状态相比时，来自基线(发作间期，或“发作间期”)期间的EEG信号看起来不同。癫痫发作前的脑电图数据看起来更紧，更紧，并且具有密集的波形；相比之下，基线数据看起来更松散，差别更大。但真正的问题是，我们能否训练一种算法，利用从这些信号中得出的数学特征，在数千个信号中看出这种差异。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kl"><img src="../Images/36f47ccd3723679b9985eb7b4cae44c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rPNmKv7XStZ5uihT"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">image by author</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kl"><img src="../Images/e52dfc68d49e83637da2a40979ab06aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5MwAOi6jHRrw2Eqh"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">image by author</figcaption></figure><p id="7e30" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">虽然您可以从数据中获得数百个特征来分类您的模型正在查看的信号是基线还是发作前，但我发现仅21个特征的组合就可以在分类模型上为您提供. 841的AUC分数，并显著减少计算时间(1小时处理超过45gb的记录文件！).</p><p id="f22d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">数据来自Kaggle 上的<a class="ae jm" href="https://www.kaggle.com/c/seizure-prediction/overview" rel="noopener ugc nofollow" target="_blank">美国癫痫协会癫痫发作预测挑战，由分别在400和5000 mHz下记录的5只犬和2名癫痫患者的数千个10分钟EEG读数组成。我使用ROC AUC作为衡量我的模型功效的指标，因为我对以下现象感兴趣:<em class="kj">真实阳性率</em>，或我可以肯定识别为癫痫发作前的信号的百分比。</a></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es km"><img src="../Images/984600de676a58967f8c2b81879be885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y45m8hf7-or7dwWM97FsQQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">image by author</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kn"><img src="../Images/942a61b5958e7f6075f90eb1370098fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2GRp3RtlRqPr-0WtYicI6g.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">image by author</figcaption></figure><p id="9287" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">小波变换包括将信号分解成一组小波，或类似波的振荡。我们基本上是在计算信号中有多少某种类型的小波或形状。</p><p id="1077" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">虽然傅立叶变换是信号分解的传统方法，但小波变换可能在时间是一个因素的领域中证明是有用的，例如癫痫发作之前的时间段。其原因是傅立叶变换受时间限制:使用傅立叶方法，我们可以知道精确的频率分量，但不知道它发生在哪个时间点。</p><p id="c5fe" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">通过小波变换，我们可以得到两者，尽管精度稍低:每个小波分解层都可以提供信号的频率成分和时间范围的信息。</p><p id="da82" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这种分解方法为波变换的每个级别生成一个数组，加上一个近似系数，它基本上是原始信号的低通或“粗糙”表示。</p><p id="97c8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">为了分解10分钟的脑电图记录，我使用了用于Python的<a class="ae jm" href="https://pywavelets.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">py wavelet开源包</a>。<a class="ae jm" href="http://wavelets.pybytes.com/wavelet/db3/" rel="noopener ugc nofollow" target="_blank"> Daubechies 3小波</a>被证明可以产生最好的分类结果，我用它将每个记录的单个通道读数转换为6级小波分解。在分解之前，每10分钟的片段被下采样到256 mHz，以便在变换之前在所有记录中具有相同的分辨率。</p><p id="2dbf" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果你想更详细地了解小波变换，请点击查看这篇来自《走向数据科学》<a class="ae jm" href="https://towardsdatascience.com/the-wavelet-transform-e9cfa85d7b34" rel="noopener" target="_blank">的精彩且内容丰富的文章。</a></p><p id="bd4d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">然后，我计算了六个分解层次中每一层次产生的能量，加上剩余的近似系数中的能量。这是我的7个能量特征。</p><p id="8eac" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">之后，我生成了第一个电极与信号中其他15个电极的相关系数，并移除了该电极与其自身的相关性(为1.0)。这是我的14个相关特征。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ko"><img src="../Images/532a508ccdc72e67b04ebc8424c7bba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N1-bjuwqoXtabtVMHxAjpw.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ko"><img src="../Images/9140760e4701615fbc0bc7bebb17dbcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X1VnuqDUO_W64XASro-dew.png"/></div></div></figure><p id="8d41" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">因为这些功能相对简单，数量也很少，我可以在不到一个小时的时间内分析并生成超过45gb的数据，这比我最初几次尝试建模节省了大量时间。我(不)深情地记得在墨西哥度假时，让我的MacBook Pro运行了16个多小时，生成了数百个功能。</p><p id="f08f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">最后，我必须解决数据集中的类不平衡问题。即使在使用手头的近4000个脑电图记录为我的模型生成训练和测试集时，训练集中仍然只有256个发作前或癫痫发作前信号。这意味着在3，983份记录中，6%为癫痫发作前，94%为基线。这是一个巨大的阶级不平衡。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ko"><img src="../Images/d25f6bf0e0e63ffd30ee4c9d620decd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*avEmk5tRct-Lju7ENv87cg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">image by author</figcaption></figure><p id="5dc6" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果保持原样，与癫痫发作前的信号相比，我的模型会看到15倍多的基线信号，并且会倾向于将<em class="kj">所有事物</em>标记为基线，因为这样做已经产生了高准确度分数(约94%)。一个非常好的统计模型，但对于实际应用来说却是一个非常无用的模型。我感兴趣的是识别那些罕见的癫痫发作前信号，并有足够的时间警告用户，而不是寻找一种数学策略来获得高准确度分数。</p><p id="4edc" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">为了解决这个问题，我选择随机对我的数据进行欠采样，或者使用训练集中的所有癫痫发作前信号，同时随机选择相同数量的基线信号进行匹配。这样，我的模型期望看到相同数量的基线和癫痫发作前信号，并密切关注它们之间的差异。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kp"><img src="../Images/11e0f6b9083d25473c2c7fde6fdfc518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYm4PqblN4VoURB49rO8sw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">image by author</figcaption></figure><p id="11aa" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">训练和验证阶段显示，XGBoost分类器对训练数据集的效果最好，与Logistic回归相比，ROC得分为0 . 859。627，勉强击败了Random Forest得分0 . 851。</p><p id="f9f8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">最后一步是组合训练和验证数据，并在看不见的数据上测试XGBoost。最终模型可根据未见过的数据正确识别基线和癫痫发作前信号之间的差异，所有患者的ROC评分为0.841，无超参数调整。只是简单的搭配。</p><p id="187c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这意味着在未见过的EEG数据中的所有癫痫发作前信号中，我的模型可以正确识别出84.1%为癫痫发作前。</p><p id="0a07" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">一个小时的工作还不错。</p><p id="22f5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">你可以在我的<a class="ae jm" href="https://github.com/CeliaSagas/EEG-Classification" rel="noopener ugc nofollow" target="_blank"> Github </a>上查看这个项目的完整代码，而2014年的数据集和原创比赛可以在Kaggle <a class="ae jm" href="https://www.kaggle.com/c/seizure-prediction/overview" rel="noopener ugc nofollow" target="_blank">上找到。</a></p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="276d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><em class="kj">原为发表于</em><a class="ae jm" href="https://celiasagastume.com/myproject/elementor-691/" rel="noopener ugc nofollow" target="_blank"><em class="kj">https://celiasagastume.com</em></a><em class="kj">。</em></p><div class="kx ky ez fb kz la"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hi fi z dy lf ea eb lg ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">如何成为移动人工智能的作者</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">medium.com</p></div></div><div class="lj l"><div class="lk l ll lm ln lj lo jg la"/></div></div></a></div></div></div>    
</body>
</html>