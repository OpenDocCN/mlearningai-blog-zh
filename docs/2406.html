<html>
<head>
<title>Document Image Transformer: Introduction, Usage and Deployment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文档图像转换器:介绍、使用和部署</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/document-image-transformer-introduction-usage-and-deployment-f8b007600b18?source=collection_archive---------5-----------------------#2022-04-28">https://medium.com/mlearning-ai/document-image-transformer-introduction-usage-and-deployment-f8b007600b18?source=collection_archive---------5-----------------------#2022-04-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="e353" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">文档图像转换器</h1><p id="3941" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">文档图像转换器(DiT)是一种转换器，它可以根据文档的图片对文档进行分类。</p><p id="ca8e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">例如，您有一个如下所示的图像，将该图像提供给模型，模型将告诉您它是哪种类型的文档:</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kf"><img src="../Images/ec933cf765d8fab84d8abe27b4bdc815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XOq6MjTLNt66-IPNFmXyZg.jpeg"/></div></div></figure><h1 id="eaf0" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">工具</h1><p id="168f" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们将使用huggingface和pinferencia</p><p id="1e52" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><a class="ae kr" href="https://github.com/underneathall/pinferencia" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi"> Pinferencia </strong> </a>只需<strong class="je hi">三条</strong>额外线路，即可轻松为任何模特服务。<br/><a class="ae kr" href="https://huggingface.co/" rel="noopener ugc nofollow" target="_blank"><strong class="je hi">hugging face</strong></a>只需几行就能轻松使用预先训练好的模型。</p><h1 id="b2f1" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">安装依赖项</h1><h2 id="0d44" class="ks if hh bd ig kt ku kv ik kw kx ky io jn kz la is jr lb lc iw jv ld le ja lf bi translated">拥抱脸</h2><p id="8803" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><code class="du lg lh li lj b">pip install "transformers[pytorch]"</code></p><p id="767f" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如果不起作用，请访问<a class="ae kr" href="https://huggingface.co/docs/transformers/installation" rel="noopener ugc nofollow" target="_blank">安装(huggingface.co)</a>并检查他们的官方文件。</p><h2 id="4867" class="ks if hh bd ig kt ku kv ik kw kx ky io jn kz la is jr lb lc iw jv ld le ja lf bi translated">平费伦西亚</h2><p id="ccd1" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><code class="du lg lh li lj b">pip install "pinferencia[uvicorn]"</code></p><p id="b5ea" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如果不行，请访问<a class="ae kr" href="https://pinferencia.underneathall.app/install/" rel="noopener ugc nofollow" target="_blank">Install—Pinferencia(under neat hall . app)</a>查看他们的官方文档。</p><h1 id="e2b3" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">模型的使用示例</h1><pre class="kg kh ki kj fd lk lj ll lm aw ln bi"><span id="b7b1" class="ks if hh lj b fi lo lp l lq lr">import base64<br/>from io import BytesIO</span><span id="d897" class="ks if hh lj b fi ls lp l lq lr">from PIL import Image<br/>from transformers import pipeline</span><span id="e06a" class="ks if hh lj b fi ls lp l lq lr">classifier = pipeline(model="microsoft/dit-base-finetuned-rvlcdip")</span><span id="7ffc" class="ks if hh lj b fi ls lp l lq lr">def classify(image_base64_str):<br/>    image = Image.open(BytesIO(base64.b64decode(image_base64_str)))<br/>    return classifier(images=image)</span></pre><p id="b646" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我们可以从:<a class="ae kr" href="https://codebeautify.org/image-to-base64-converter" rel="noopener ugc nofollow" target="_blank"> Image to base64 converter获取图像的Base64编码字符串，将图像转换为Base64字符串。(codebeautify.org)</a></p><pre class="kg kh ki kj fd lk lj ll lm aw ln bi"><span id="7fe6" class="ks if hh lj b fi lo lp l lq lr">classify("/9j/4AAQSkZJRgABAQAASABIAAD/4QB...........")</span></pre><p id="1bc5" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">输出是:</p><pre class="kg kh ki kj fd lk lj ll lm aw ln bi"><span id="7e47" class="ks if hh lj b fi lo lp l lq lr">[{'score': 0.8400426506996155, 'label': 'presentation'},<br/> {'score': 0.043046072125434875, 'label': 'advertisement'},<br/> {'score': 0.024246374145150185, 'label': 'questionnaire'},<br/> {'score': 0.014194409362971783, 'label': 'form'},<br/> {'score': 0.013648252934217453, 'label': 'news article'}]</span></pre><p id="01b5" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">所以，它认为我们的图像很可能是一个演示。</p><h1 id="b048" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">部署模型</h1><p id="6508" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">创建一个文件app.py:</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="8685" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">运行:</p><pre class="kg kh ki kj fd lk lj ll lm aw ln bi"><span id="45c9" class="ks if hh lj b fi lo lp l lq lr">uvicorn app:service --reload</span></pre><p id="02de" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">等待模型被下载。完成后，您会看到:</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lv"><img src="../Images/20c6543456b947d4d3d7e2980c0c650b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TwnU43Q3Y2OnoTXR.png"/></div></div></figure><h1 id="d2de" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">呼叫服务</h1><p id="f6bb" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">你可以使用T2或者芬兰的T3。</p><h2 id="18a0" class="ks if hh bd ig kt ku kv ik kw kx ky io jn kz la is jr lb lc iw jv ld le ja lf bi translated">交互式API页面</h2><p id="25dc" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">打开你的浏览器，访问<a class="ae kr" href="http://127.0.0.1:8000" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:8000 </a>，使用下面的api进行预测。</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lw"><img src="../Images/b05b47ac1bb1b3c57b35b2ed0e6d95c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kx2CP2b1KtLnfdJb4wm1Fg.png"/></div></div></figure><p id="bc35" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">结果是</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lx"><img src="../Images/73d684eeb309b37a67f397a3348c5404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qv3xMQW4_TZAeOpLjIYtTw.png"/></div></div></figure><h1 id="ba11" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">平费伦西亚</h1><p id="3a5d" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">如果想了解更多关于Pinferencia的内容，请访问:<a class="ae kr" href="https://github.com/underneathall/pinferencia" rel="noopener ugc nofollow" target="_blank">under neat hall/Pinferencia:Python+Inference—Python中的模型部署库。史上最简单的模型推理服务器。(github.com)</a></p><div class="ly lz ez fb ma mb"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mc ab dw"><div class="md ab me cl cj mf"><h2 class="bd hi fi z dy mg ea eb mh ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mi l"><h3 class="bd b fi z dy mg ea eb mh ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mj l"><p class="bd b fp z dy mg ea eb mh ed ef dx translated">medium.com</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp kp mb"/></div></div></a></div></div></div>    
</body>
</html>