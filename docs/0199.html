<html>
<head>
<title>Developing the first Neural Network with TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用TensorFlow开发第一个神经网络</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/developing-the-first-neural-network-with-tensorflow-5fade1a23395?source=collection_archive---------5-----------------------#2021-03-02">https://medium.com/mlearning-ai/developing-the-first-neural-network-with-tensorflow-5fade1a23395?source=collection_archive---------5-----------------------#2021-03-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="680f" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">介绍</h1><p id="6b34" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在本文中，我将解释什么是神经网络，以及如何通过Google Colab使用TensorFlow库实现它。</p><h2 id="2057" class="ka if hh bd ig kb kc kd ik ke kf kg io jn kh ki is jr kj kk iw jv kl km ja kn bi translated">你需要知道的是</h2><p id="5a38" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">为了能够理解这篇文章，如果你有一些Python (Numpy库)和机器学习方面的知识会更好。</p><h1 id="a85a" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">机器学习</h1><blockquote class="ko kp kq"><p id="9fca" class="jc jd kr je b jf ks jh ji jj kt jl jm ku kv jp jq kw kx jt ju ky kz jx jy jz ha bi translated"><em class="hh">机器学习是一个研究领域，它赋予计算机自动学习和根据经验改进的能力，而无需显式编程</em>。</p></blockquote><p id="cea5" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated"><strong class="je hi">换句话说，人工智能的这个分支</strong> <strong class="je hi">用数据来回答问题。</strong>过去，我们一直手动分析由人、计算机、电话和其他设备生成的数据，但近年来，数据量呈指数级增长，传统方法难以处理。</p><p id="3779" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated">这就是机器学习发挥作用的地方，它可以用来自动从这些数据中学习，这样我们就可以从这些海量的信息中理解。</p><h1 id="4dc3" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">神经网络</h1><p id="7d53" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">神经网络是一种可以被训练来识别模式的模型。它由层组成，包括输入层和输出层，以及至少一个隐层，其中<strong class="je hi">深度神经网络</strong>包含一个以上的隐层。每一层中的神经元学习越来越抽象的数据表示和特征，使得对数据进行分类成为可能。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es la"><img src="../Images/ad24ed8a42adfadf6e18da74e987243c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*2HkciUumHDoVj-GEV9FdGQ.png"/></div></figure><h2 id="3116" class="ka if hh bd ig kb kc kd ik ke kf kg io jn kh ki is jr kj kk iw jv kl km ja kn bi translated">训练神经网络</h2><p id="e881" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">通过<strong class="je hi">梯度下降</strong>训练神经网络。每一层中的权重从随机值开始，随着时间的推移，这些权重被迭代地改进，以使网络更加精确。一个<strong class="je hi">损失函数</strong>用于量化网络有多不准确，一个称为<strong class="je hi">反向传播</strong>的程序用于确定是否应该增加或减少每个权重以减少损失。</p><h2 id="5439" class="ka if hh bd ig kb kc kd ik ke kf kg io jn kh ki is jr kj kk iw jv kl km ja kn bi translated">开发神经网络</h2><p id="f07e" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><strong class="je hi"> Python </strong>是创建机器学习算法最流行的编程语言之一。今天，神经网络可以在不精确知道训练如何工作的情况下使用。事实上，大多数现代机器学习库已经极大地自动化了训练过程。我要介绍的使用的库是Google 的<strong class="je hi"> TensorFlow。</strong></p><h1 id="e886" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">张量流</h1><p id="977a" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">TensorFlow是Google开发的一个开源库，主要用于机器学习应用程序，可以轻松构建和部署ML模型。</p><blockquote class="ko kp kq"><p id="804a" class="jc jd kr je b jf ks jh ji jj kt jl jm ku kv jp jq kw kx jt ju ky kz jx jy jz ha bi translated"><strong class="je hi">张量流</strong>这个名字来源于这种神经网络对多维数据阵列执行的操作，这些数据阵列被称为<strong class="je hi">张量</strong>，在处理大量数据时非常方便。</p></blockquote><h1 id="1256" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">科拉布</h1><p id="2d76" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Colaboratory是Google的产品，类似于Jupyter notebook，允许通过浏览器编写和执行python代码。它非常适合机器学习，因为它提供了对包括GPU在内的计算资源的免费访问。</p><p id="f474" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated">正常情况下<strong class="je hi"> TensorFlow库</strong>需要安装并导入才能使用，但是<strong class="je hi">在Google Colab上是“随时可用”的，我们只需要导入它</strong>！</p><pre class="lb lc ld le fd li lj lk ll aw lm bi"><span id="c735" class="ka if hh lj b fi ln lo l lp lq"># Import TensorFlow<br/>import tensorflow as tf</span></pre><h2 id="3982" class="ka if hh bd ig kb kc kd ik ke kf kg io jn kh ki is jr kj kk iw jv kl km ja kn bi translated">模型定义</h2><p id="94b2" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们将开发的第一个模型将会非常简单，但理解如何<strong class="je hi">创建、配置、训练模型并最终用它来给我们一个预测将会非常有用。</strong></p><p id="f769" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated">假设我们有以下几组数字。我们想创建一个神经网络来理解它们之间的关系。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es lr"><img src="../Images/804cf736caedba7f1c4a19141514e1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*WlFAI6pVrrLX4-FJnYNXEg.png"/></div></figure><p id="eec2" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated">你可能已经注意到，关系是由下面的函数定义的:y=3x-7。</p><p id="e7d0" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated">对于每个机器学习应用程序，第一步是<strong class="je hi">收集数据</strong>:所以让我们将x和y的值保存在两个不同的<strong class="je hi"> numpy数组</strong>中。</p><pre class="lb lc ld le fd li lj lk ll aw lm bi"><span id="37a7" class="ka if hh lj b fi ln lo l lp lq"># Import numpy<br/>import numpy as np</span><span id="1761" class="ka if hh lj b fi ls lo l lp lq"># y = 3x -7<br/>x = np.array([-1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0], dtype=float)<br/>y = np.array([-10.0, -7.0, -4.0, -1.0, 2.0, 5.0, 7.0], dtype=float)</span></pre><h2 id="8272" class="ka if hh bd ig kb kc kd ik ke kf kg io jn kh ki is jr kj kk iw jv kl km ja kn bi translated"><strong class="ak">创建最简单的神经网络:</strong></h2><p id="7309" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们可以创建的最简单的神经网络只有一个输入、一个输出和一个只有一个节点的隐藏层。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es lt"><img src="../Images/1a4f5552440846b339ed66c47c873522.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*E7Lyo97UC24cXAid8poDdw.png"/></div></figure><p id="0b9a" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated">为了使用TensorFlow创建这样的模型，我们首先将神经网络定义为顺序的，这意味着它将具有一系列层，然后我们只需向它添加一个密集层，它将代表我们的隐藏层</p><pre class="lb lc ld le fd li lj lk ll aw lm bi"><span id="4d1f" class="ka if hh lj b fi ln lo l lp lq">from tensorflow.keras.layers import Dense</span><span id="e280" class="ka if hh lj b fi ls lo l lp lq">model = tf.keras.Sequential([Dense(units=1, input_shape=[1])])</span></pre><p id="462a" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated">一旦<strong class="je hi">创建了</strong>模型，就可以用<strong class="je hi"> model.compile()，</strong>配置损失和指标，可以用<strong class="je hi"> model.fit()，</strong>用<strong class="je hi"> model.evaluate() </strong>对模型进行训练，用<strong class="je hi"> model.predict()进行预测。</strong></p><pre class="lb lc ld le fd li lj lk ll aw lm bi"><span id="d641" class="ka if hh lj b fi ln lo l lp lq">model.compile(optimizer='sgd', loss='mean_squared_error')<br/>model.fit(x, y, epochs=500)<br/>print(model.predict([25.0]))</span></pre><p id="a511" class="pw-post-body-paragraph jc jd hh je b jf ks jh ji jj kt jl jm jn kv jp jq jr kx jt ju jv kz jx jy jz ha bi translated">打印出来的数值不是68而是67.997734，为什么会这样？因为神经网络处理概率，给定输入到模型中的7个点，它理解x和y之间的关系是y =3x-7，具有很高的概率，但是7个点不足以确定，所以它预测点25非常接近68，但是不一定是68。</p><h2 id="9004" class="ka if hh bd ig kb kc kd ik ke kf kg io jn kh ki is jr kj kk iw jv kl km ja kn bi translated">完整代码</h2><p id="b283" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在这里你可以看到完整的代码或者通过Google Colab试试看:</p><figure class="lb lc ld le fd lf"><div class="bz dy l di"><div class="lu lv l"/></div></figure><h2 id="3166" class="ka if hh bd ig kb kc kd ik ke kf kg io jn kh ki is jr kj kk iw jv kl km ja kn bi translated">下一步是什么？</h2><p id="3dc1" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在下一篇文章中，我将展示如何为图像分类开发一个更复杂的神经网络，以及如何使用Google Colab来加速训练过程。</p></div></div>    
</body>
</html>