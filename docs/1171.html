<html>
<head>
<title>Implementing a Naive Bayes Classifier from scratch in python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用python从头开始实现朴素贝叶斯分类器</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/implementing-a-naive-bayes-classifier-from-scratch-in-python-51b6db9955ce?source=collection_archive---------4-----------------------#2021-10-17">https://medium.com/mlearning-ai/implementing-a-naive-bayes-classifier-from-scratch-in-python-51b6db9955ce?source=collection_archive---------4-----------------------#2021-10-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c3c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我在深入机器学习领域时经常遇到的一个话题是朴素贝叶斯；这个等式并不幼稚。</p><p id="ea25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本文试图简化多项式朴素贝叶斯背后的数学。</p><p id="ce83" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本文的完整代码可以在<a class="ae jc" href="https://github.com/cleopatra27/Naive-bayes-classifier" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="1ea3" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">什么是朴素贝叶斯？</h1><p id="e7c3" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">朴素贝叶斯是一种概率分类器，这意味着这种方法使用概率和/或频率来分类。</p><p id="3064" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个典型的例子(我们将测试)是垃圾邮件/垃圾邮件分类，分类器查看我们标记的垃圾邮件和垃圾邮件，并根据之前观察到的单词频率对它们进行分类。</p><p id="fb6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个场景中，这个“幼稚”的分类器有点模仿我们人类；我如何知道一封电子邮件是垃圾邮件；来自之前的邮件！根据之前与该电子邮件的互动或知识，我知道来自我的人力资源的电子邮件是“hr@company.com ”,因此看到来自“hr1@company.com”的电子邮件可能会引起怀疑。</p><p id="03e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面的等式表示朴素贝叶斯:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kg"><img src="../Images/caceb82dc235c426e26ed789ab119ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/0*P1ray5_VKbegVKr-"/></div></figure><p id="2028" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分解上面的等式，它表示找到先验的日志和我们的电子邮件的可能性的日志之和的<strong class="ig hi"> argmax </strong>。</p><h1 id="f881" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">平滑。</h1><p id="205b" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">现在，我们理解了朴素贝叶斯分类器是如何工作的；但是仔细观察，我们发现当我们看到这个例子时，分类器只能对新邮件起作用，但我们将来需要对电子邮件中的所有其他单词都这样做。</p><p id="39a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一种方法(我们将实现)是使用平滑，这种平滑背后的想法是为我们的电子邮件中的看不见的单词增加一个值。这是假设我们至少见过这个词一次。</p><h2 id="d96a" class="ko je hh bd jf kp kq kr jj ks kt ku jn ip kv kw jr it kx ky jv ix kz la jz lb bi translated">在先的；在前的</h2><p id="13c1" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">这是在收集新数据之前事件发生的概率。我们之前的代码如下:</p><pre class="kh ki kj kk fd lc ld le lf aw lg bi"><span id="6c51" class="ko je hh ld b fi lh li l lj lk">def cal_prior_prob(self):<br/>    total_count = len(self.spam_emails) + len(self.ham_emails)<br/>    return log(len(self.spam_emails) / total_count),    log(len(self.ham_emails) / total_count)</span></pre><h2 id="5d09" class="ko je hh bd jf kp kq kr jj ks kt ku jn ip kv kw jr it kx ky jv ix kz la jz lb bi translated"><strong class="ak">可能性</strong></h2><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ll"><img src="../Images/46b2141f3ce295dc692d00d453262e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*qXNWlLHytwTIrzWwqoKLPA.png"/></div></figure><p id="ea7b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">顾名思义，这是电子邮件中的单词可能支持垃圾邮件或垃圾邮件的可能性。它测量数据为参数的每个可能值提供的支持。</p><p id="4fb3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们比较两个参数点的似然函数，发现L(θ1|x) &gt; L(θ2|x)，那么我们实际观察到的样本在θ = θ1时比θ = θ2时更有可能出现。这可以解释为θ1是比θ2更合理的θ值。</p><p id="a51b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要分解上面的公式:</p><pre class="kh ki kj kk fd lc ld le lf aw lg bi"><span id="dddf" class="ko je hh ld b fi lh li l lj lk">spam_likelihood = word_frequency / (total_spam + vocabulary)</span></pre><p id="cd08" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的<strong class="ig hi">词汇表</strong>将是我们电子邮件中唯一的总字数。</p><p id="3511" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了处理看不见的单词的用例，我们将添加一个alpha值来平滑，我们的等式变成:</p><pre class="kh ki kj kk fd lc ld le lf aw lg bi"><span id="921f" class="ko je hh ld b fi lh li l lj lk">(word_frequency + alpha) / (total_spam + alpha * vocabulary)</span></pre><p id="745f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的可能性函数变成:</p><pre class="kh ki kj kk fd lc ld le lf aw lg bi"><span id="7d55" class="ko je hh ld b fi lh li l lj lk">def find_dict_ham_likelihood(key):<br/>    word_frequency = 0  # counter<br/>    for word in spam_bag_words():<br/>        word_frequency += 1<br/>        total_spam = len(ham_word_list)<br/>        ham_likelihood = (word_frequency + alpha) / (total_spam + alpha * vocabulary)<br/>        dict_ham_likelihood[word.lower()] = ham_likelihood<br/>    return dict_ham_likelihood[key]</span></pre><h2 id="4f86" class="ko je hh bd jf kp kq kr jj ks kt ku jn ip kv kw jr it kx ky jv ix kz la jz lb bi translated">Argmax</h2><p id="3559" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">这是一个从目标函数中寻找给出最大值的参数的操作。Argmax在机器学习中最常用于查找预测概率最大的类。我们将使用if语句来实现这一点:</p><pre class="kh ki kj kk fd lc ld le lf aw lg bi"><span id="99d1" class="ko je hh ld b fi lh li l lj lk">if ham_probabilty &gt;= spam_probabilty:<br/>    return "ham"<br/>else:<br/>    return "spam"</span></pre><h1 id="3036" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">密码</h1><p id="b2d5" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">让我们试着把上面的解释编写成代码。我们将把一组电子邮件分类为垃圾邮件；我们的训练集有1000封垃圾邮件和火腿邮件，平均分配。</p><p id="b000" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将首先检索我们的数据，删除数字、重复项，并形成我们的<strong class="ig hi">垃圾邮件和单词的火腿袋</strong>(注意，我在本地有我的文件，您可以使用nltk语料库并进一步清理您的数据):</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="688d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们将计算我们的可能性:</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="d3f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们计算我们的先验:</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="83cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们应用贝叶斯规则:</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="4e0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以通过调用Bayes函数，用一封示例电子邮件来测试我们的代码，参见下面的示例:</p><pre class="kh ki kj kk fd lc ld le lf aw lg bi"><span id="fdb9" class="ko je hh ld b fi lh li l lj lk">print(bayes("Good day, awaiting your response on the budget"))</span></pre><p id="c269" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们已经测试了我们的Bayes函数，到目前为止，它的效果和预期的一样。恭喜你，我们已经建立了一个贝叶斯朴素函数。下面的工作是你可以采取的额外步骤。</p><p id="2264" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我有几封电子邮件(垃圾邮件和火腿)，想真正看看我们的功能是好是坏，我们将针对我们的服务运行99个新的测试电子邮件，并将计算数量:<strong class="ig hi">真阳性(TP)，真阴性(TN)，假阳性(FP)假阴性(FN)</strong>；以及以下度量:<strong class="ig hi">精度、召回率、F值</strong></p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lm ln l"/></div></figure><p id="6101" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的代码上面还打印了一个真值表，见下图:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lo"><img src="../Images/d6837654293e5974807f73fcabdfbeb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*fWn3tuwfaIbddXFsewCx-A.png"/></div></figure></div></div>    
</body>
</html>