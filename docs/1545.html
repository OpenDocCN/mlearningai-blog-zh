<html>
<head>
<title>Emotion Detector using Keras — with source code— Easiest Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Keras的情绪检测器——带源代码——最简单的方法</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/emotion-detector-using-keras-with-source-code-easiest-way-easy-implementation-6f62ad9e2528?source=collection_archive---------5-----------------------#2022-01-03">https://medium.com/mlearning-ai/emotion-detector-using-keras-with-source-code-easiest-way-easy-implementation-6f62ad9e2528?source=collection_archive---------5-----------------------#2022-01-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="612d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以在今天的博客中，我们将使用卷积神经网络在Keras中构建一个情绪检测器模型。这是我最喜欢的项目之一，这就是为什么我很兴奋开始它，所以没有任何进一步的原因。</p><p id="9c5e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在这里阅读带源代码的整篇文章—</strong><a class="ae jc" href="https://machinelearningprojects.net/emotion-detector-using-keras/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/emotion-detector-using-keras/</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/e0adc9f2521551c52d1eb5703fafcf26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*kcO2Odho5azQstm0Gfkjvg.gif"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Emotion detector</figcaption></figure><h1 id="f7ad" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">让我们开始吧…</h1><h2 id="f95c" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤1-导入情感检测器所需的库。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="0ce1" class="kn jq hh lc b fi lg lh l li lj">from keras.preprocessing.image import ImageDataGenerator<br/>from keras.layers import Dense,Dropout,Activation,Conv2D,MaxPooling2D,BatchNormalization,Flatten<br/>from keras.models import Sequential<br/>from keras.optimizers import rmsprop_v2<br/>from keras.callbacks import EarlyStopping,ReduceLROnPlateau,ModelCheckpoint<br/>from keras.models import load_model<br/>import cv2<br/>from PIL import Image<br/>import numpy as np<br/>import pandas as pd<br/>import os<br/>from keras.utils.np_utils import to_categorical<br/>import seaborn as sns</span></pre><h2 id="5a88" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤2-读取所有图像，并将它们存储在数据帧中。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="811e" class="kn jq hh lc b fi lg lh l li lj">int2emotions = {0:'Angry',1:'Fear',2:'Happy',3:'Neutral',4:'Sad',5:'Surprise'}<br/>emotions2int = {'Angry':0,'Fear':1,'Happy':2,'Neutral':3,'Sad':4,'Surprise':5}<br/><br/>dic = {'images':[], 'labels':[], 'purpose':[]}<br/>    <br/>for d in os.listdir('fer2013/'):<br/>    print(d)<br/>    for emotion in os.listdir(f'fer2013/{d}'):<br/>        print(emotion)<br/>        for i in os.listdir(f'fer2013/{d}/{emotion}'):<br/>            img = cv2.imread(f'fer2013/{d}/{emotion}/{i}',0)<br/>            img = img.reshape(48,48,1)<br/>            <br/>            dic['images'].append(img)<br/>            dic['labels'].append(emotion)<br/>            <br/>            if d=='train':<br/>                dic['purpose'].append('T')<br/>            else:<br/>                dic['purpose'].append('V')<br/><br/>df = pd.DataFrame(dic)<br/>df.head()</span></pre><ul class=""><li id="e2b9" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">在这里，我们只是读取我们的数据，并将其存储在一个熊猫数据帧中。</li><li id="e9bb" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">图像包含形状为48X48X1的图像。</li><li id="bbc5" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">标签描述了图像的情感。</li><li id="fa59" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">目的有两个值T和V，T用于训练，V用于验证。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ly"><img src="../Images/89658fbca1a42f7ee9747a31003d9c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/0*xTk1uK11xD7g_NlU.png"/></div></figure><h2 id="24dc" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤3 —提取训练数据和验证数据。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="02b8" class="kn jq hh lc b fi lg lh l li lj">train_data = df[df['purpose']=='T']<br/>val_data = df[df['purpose']=='V']</span></pre><ul class=""><li id="c117" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">创建2个不同的数据框。</li><li id="564f" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">第一次用于训练，第二次用于验证。</li></ul><p id="a267" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查负责人的培训数据。</p><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="d501" class="kn jq hh lc b fi lg lh l li lj">train_data.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/d24e03a59afce87646db07c63be3d11c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/0*-EZ6C_VV1Ox2CSX1.png"/></div></figure><p id="1dcf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查验证数据的标题。</p><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="4d36" class="kn jq hh lc b fi lg lh l li lj">val_data.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/94c6f44d2f161760e6d0df9d28bc116a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/0*B5lp9h_mYrMQIdOS.png"/></div></figure><h2 id="0a56" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤4-检查训练数据的标签列中的值。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="2eec" class="kn jq hh lc b fi lg lh l li lj">train_data[‘labels’].value_counts()</span></pre><ul class=""><li id="6914" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">正如我们在下图中看到的，标签在训练数据中非常不平衡，因此我们将在下一步中平衡它们。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/61d4c02d262b78a02c11d98dd6e84897.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/0*lMARebSSSf0ySsEk.png"/></div></figure><h2 id="de48" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤5——获取所有类的相同实例。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="ca51" class="kn jq hh lc b fi lg lh l li lj">happy_df = train_data[train_data['labels']=='Happy'].sample(n=3171)<br/>neutral_df = train_data[train_data['labels']=='Neutral'].sample(n=3171)<br/>sad_df = train_data[train_data['labels']=='Sad'].sample(n=3171)<br/>fear_df = train_data[train_data['labels']=='Fear'].sample(n=3171)<br/>angry_df = train_data[train_data['labels']=='Angry'].sample(n=3171)<br/>surprise_df = train_data[train_data['labels']=='Surprise'].sample(n=3171)<br/><br/>train_data = pd.concat([happy_df,neutral_df,sad_df,fear_df,angry_df,surprise_df])<br/><br/>train_data = train_data.sample(frac=1)<br/>train_data.reset_index(inplace=True)<br/>train_data.drop('index',inplace=True,axis=1)<br/><br/>train_data.head()</span></pre><ul class=""><li id="4dad" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">在这里，我们选取了3171个每种情感广告的实例，并与它们联系起来，形成一个最终的数据框架。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/4d1b0dfc5242fa669f39ea0beb715f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/0*g1wLDVSPAe2ChApX.png"/></div></figure><h2 id="1b40" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤6-再次检查列车数据标签列中的值。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="4ee1" class="kn jq hh lc b fi lg lh l li lj">train_data[‘labels’].value_counts()</span></pre><ul class=""><li id="15b7" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">现在再次检查计数，现在我们可以看到所有的类都是平衡的。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/dc78037e8dd2bc477edb6e09308af112.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/0*MrGXWcNqo0M9mc_t.png"/></div></figure><p id="79ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">绘制列。</p><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="5bbf" class="kn jq hh lc b fi lg lh l li lj">sns.countplot(train_data[‘labels’])</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/c707d4a3ae09a644590511a011ea0aa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/0*ZTe57tI0OVLso_-q.png"/></div></figure><h2 id="086c" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤7-声明一些常量。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="5571" class="kn jq hh lc b fi lg lh l li lj">batch_size= 32<br/>classes = 6<br/>rows,columns=48,48</span></pre><h2 id="4998" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">第8步——以正确的形式获取情绪检测器模型的数据。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="5f4b" class="kn jq hh lc b fi lg lh l li lj">train_labels = list(train_data['labels'].replace(emotions2int))<br/>train_labels = to_categorical(train_labels)<br/><br/>val_labels = list(val_data['labels'].replace(emotions2int))<br/>val_labels = to_categorical(val_labels)<br/><br/>train_data = list(train_data['images'])<br/>train_data = np.array(train_data)<br/><br/>val_data = list(val_data['images'])<br/>val_data = np.array(val_data)</span></pre><ul class=""><li id="2671" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">第1–2行—将情绪转换为整数，如愤怒转换为0，恐惧转换为1，等等，然后使用to _ categorical将这些数字转换为one-hot编码。这是用于训练数据的。</li><li id="64cf" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">第4–5行—对验证数据执行与上述相同的操作。</li><li id="ebd2" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">第7–8行—出于训练目的，将图像列转换为列表，然后转换为NumPy数组，因为我们不会将dataframe列用于训练目的，因此我们将它们转换为数组。</li><li id="b743" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">第10–11行—对验证数据执行与上述相同的操作。</li></ul><p id="eee3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查训练数据形状。</p><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="5a65" class="kn jq hh lc b fi lg lh l li lj">train_data.shape</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/2c59989756c53ec10e464012c95a37ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/0*2sN78FDP_3V4LNvI.png"/></div></figure><p id="987e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查验证数据形状。</p><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="22b5" class="kn jq hh lc b fi lg lh l li lj">val_data.shape</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mg"><img src="../Images/381322fbe963bb596ad2ab208bc9e872.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/0*vuqLA5029YKCqfA_.png"/></div></figure><h2 id="0b8d" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤9——创建情绪检测器模型。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="1e3c" class="kn jq hh lc b fi lg lh l li lj">model = Sequential()<br/><br/># First Block<br/>model.add(Conv2D(64,(3,3),activation='elu',input_shape=(rows,columns,1),kernel_initializer='he_normal',padding='same'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(64,(3,3),activation='elu',input_shape=(rows,columns,1),kernel_initializer='he_normal',padding='same'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2,2)))<br/>model.add(Dropout(0.2))<br/><br/># Second Block<br/>model.add(Conv2D(128,(3,3),activation='elu',kernel_initializer='he_normal',padding='same'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(128,(3,3),activation='elu',kernel_initializer='he_normal',padding='same'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2,2)))<br/>model.add(Dropout(0.2))<br/><br/># Third Block<br/>model.add(Conv2D(256,(3,3),activation='elu',kernel_initializer='he_normal',padding='same'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(256,(3,3),activation='elu',kernel_initializer='he_normal',padding='same'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2,2)))<br/>model.add(Dropout(0.2))<br/><br/># Fourth Block<br/>model.add(Conv2D(512,(3,3),activation='elu',kernel_initializer='he_normal',padding='same'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(512,(3,3),activation='elu',kernel_initializer='he_normal',padding='same'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2,2)))<br/>model.add(Dropout(0.2))<br/><br/># Fifth Block<br/>model.add(Flatten())<br/>model.add(Dense(256,activation='elu',kernel_initializer='he_normal'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.5))<br/><br/># Sixth Block<br/>model.add(Dense(128,activation='elu',kernel_initializer='he_normal'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.5))<br/><br/># Seventh Block<br/>model.add(Dense(64,activation='elu',kernel_initializer='he_normal'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.5))<br/><br/># Eighth Block<br/>model.add(Dense(classes,activation='softmax',kernel_initializer='he_normal'))<br/><br/>print(model.summary())</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/320567450889e836b6f83cce61c363fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/0*XtwFF8bWxPfVE3Le.png"/></div></figure><ul class=""><li id="d0a0" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">创建我们的卷积神经网络模型。</li><li id="d76f" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">创建4块<a class="ae jc" href="https://keras.io/api/layers/convolution_layers/convolution2d/" rel="noopener ugc nofollow" target="_blank">【Conv2D】</a>—<a class="ae jc" href="https://keras.io/api/layers/normalization_layers/batch_normalization/" rel="noopener ugc nofollow" target="_blank">—</a>—<a class="ae jc" href="https://keras.io/api/layers/convolution_layers/convolution2d/" rel="noopener ugc nofollow" target="_blank">Conv2D</a>—<a class="ae jc" href="https://keras.io/api/layers/normalization_layers/batch_normalization/" rel="noopener ugc nofollow" target="_blank">batch normalization</a>—<a class="ae jc" href="https://keras.io/api/layers/pooling_layers/max_pooling2d/" rel="noopener ugc nofollow" target="_blank">maxpooli2d</a>—<a class="ae jc" href="https://keras.io/api/layers/regularization_layers/dropout/" rel="noopener ugc nofollow" target="_blank">Dropout</a>层。</li><li id="b837" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">创建3块<a class="ae jc" href="https://keras.io/api/layers/core_layers/dense/" rel="noopener ugc nofollow" target="_blank">密集</a>——批量——剔除层，最终创建1个具有6个神经元/节点的密集层。</li></ul><h2 id="42d7" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤10-声明回调。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="bd04" class="kn jq hh lc b fi lg lh l li lj">checkpoint = ModelCheckpoint('model\\6_class_emotion_detector_V2.h5',<br/>                             save_best_only=True,<br/>                             mode='min',<br/>                             monitor='val_loss',<br/>                             verbose=1)<br/><br/>earlystopping = EarlyStopping(patience=10,<br/>                             verbose=1,<br/>                             min_delta=0,<br/>                             monitor='val_loss',<br/>                             restore_best_weights=True)<br/><br/><br/>callbacks = [checkpoint, earlystopping]<br/><br/>model.compile(metrics=['accuracy'],<br/>             optimizer='rmsprop',<br/>             loss='categorical_crossentropy')</span></pre><ul class=""><li id="751a" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">创建<a class="ae jc" href="https://keras.io/api/callbacks/early_stopping/" rel="noopener ugc nofollow" target="_blank">提前停止</a>和<a class="ae jc" href="https://keras.io/api/callbacks/model_checkpoint/" rel="noopener ugc nofollow" target="_blank">检查点</a>回调。</li></ul><h2 id="aac6" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">步骤11 —训练模型。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="47c0" class="kn jq hh lc b fi lg lh l li lj">train_samples = 28273<br/>validation_samples = 3534<br/>batch_size = 64<br/>epochs=30<br/><br/>history = model.fit(train_data,<br/>                    train_labels,<br/>                    epochs=epochs,<br/>                    steps_per_epoch=train_samples//batch_size,<br/>                    validation_data=(val_data,val_labels),<br/>                    validation_steps=validation_samples//batch_size,<br/>                    callbacks=callbacks)</span></pre><ul class=""><li id="68ef" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">最后训练模型。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="er es mi"><img src="../Images/67838304b6e7089708b0d53465fc800b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XHxSpX6c5sQ-KrHK.png"/></div></div></figure><h2 id="afb3" class="kn jq hh bd jr ko kp kq jv kr ks kt jz ip ku kv kd it kw kx kh ix ky kz kl la bi translated">第12步—实时预测。</h2><pre class="je jf jg jh fd lb lc ld le aw lf bi"><span id="ae43" class="kn jq hh lc b fi lg lh l li lj">import cv2<br/>from keras.models import load_model<br/>import numpy as np<br/><br/>int2emotions = {0:'Angry',1:'Fear',2:'Happy',3:'Neutral',4:'Sad',5:'Surprise'}<br/>model = load_model('model\\6_class_emotion_detector_V2.h5')<br/>cap = cv2.VideoCapture(0)<br/><br/>classifier = cv2.CascadeClassifier('Haarcascades\\haarcascade_frontalface_default.xml')<br/><br/>def detect_face(frame):<br/>    faces=classifier.detectMultiScale(frame,1.3,4)<br/>    if faces==():<br/>        return frame<br/>    for x,y,w,h in faces:<br/>        cv2.rectangle(frame,(x,y),(x+w,y+h),(172,42,251),2)<br/>        face = frame[y:y+h,x:x+w]<br/>        face = cv2.cvtColor(face,cv2.COLOR_BGR2GRAY)<br/>        face = cv2.resize(face,(48,48))<br/>        face = face.reshape(1,48,48,1)<br/>        cv2.putText(frame,text=int2emotions[np.argmax(model.predict(face))],<br/>                    org=(x,y-15),fontFace=cv2.FONT_HERSHEY_SIMPLEX,fontScale=1,color=(106,40,243),thickness=2)<br/>    return frame<br/><br/>while 1:<br/>    ret,frame= cap.read()<br/>    if ret==True:<br/>        cv2.imshow('emotion_detector',detect_face(frame))<br/>        if cv2.waitKey(1)==27:<br/>            break<br/>cap.release()<br/>cv2.destroyAllWindows()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/e0adc9f2521551c52d1eb5703fafcf26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*kcO2Odho5azQstm0Gfkjvg.gif"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Emotion detector</figcaption></figure><p id="0236" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果对情绪检测器有任何疑问，请通过电子邮件或LinkedIn联系我。</p><p id="22e1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mn">探索更多机器学习、深度学习、计算机视觉、NLP、Flask项目访问我的博客— </em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="mn">机器学习项目</em> </strong> </a></p><p id="2ee7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如需进一步的代码解释和源代码，请访问此处—</strong><a class="ae jc" href="https://machinelearningprojects.net/emotion-detector-using-keras/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/emotion-detector-using-keras/</a></p><p id="7d4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是我写给这个博客的所有内容，感谢你的阅读，我希望你在阅读完这篇文章后，能有所收获，直到下次👋… </p><p id="267c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mn">看我以前的帖子:</em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/monkey-breed-classification/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="mn">猴子品种分类利用迁移学习</em> </strong> </a></p><div class="mo mp ez fb mq mr"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ms ab dw"><div class="mt ab mu cl cj mv"><h2 class="bd hi fi z dy mw ea eb mx ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="my l"><h3 class="bd b fi z dy mw ea eb mx ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mz l"><p class="bd b fp z dy mw ea eb mx ed ef dx translated">medium.com</p></div></div><div class="na l"><div class="nb l nc nd ne na nf jj mr"/></div></div></a></div></div></div>    
</body>
</html>