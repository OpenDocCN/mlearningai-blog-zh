<html>
<head>
<title>How to create an AWS Lambda using AWS ECR Docker container image in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Python中使用AWS ECR Docker容器映像创建AWS Lambda</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/how-to-create-an-aws-lambda-using-aws-ecr-docker-container-image-in-python-76203a2c11e2?source=collection_archive---------1-----------------------#2022-01-25">https://medium.com/mlearning-ai/how-to-create-an-aws-lambda-using-aws-ecr-docker-container-image-in-python-76203a2c11e2?source=collection_archive---------1-----------------------#2022-01-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5a2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博客中，我们将看到如何使用Python中的AWS ECR Docker映像创建一个<a class="ae jc" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS </a> Lambda。如果您是第一次使用容器映像创建Lambda函数，那么它会非常复杂。我自己在做这件事的时候，我没有找到任何相关的博客或文章来教你这些。</p><p id="dda7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是为什么以后再也不会有人掉进这个坑了，我写这篇博客是为了那些和我两三个月前处境相同的人，因为我知道这有多令人沮丧。所以没有任何进一步的原因，让我们做吧。</p><p id="9541" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">点击此处阅读全文—</strong><a class="ae jc" href="https://machinelearningprojects.net/create-an-aws-lambda-using-aws-ecr/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/create-an-AWS-lambda-using-AWS-ECR/</a></p><h1 id="228e" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤1-创建一个新文件夹，并将您的py文件添加到其中。</h1><ul class=""><li id="4816" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">只需创建一个文件夹，并将您的代码文件添加到其中。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div class="er es km"><img src="../Images/76001f32b3c84be6251146ab0d348f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/0*ZNrSnIiX0WARoaGo.png"/></div></figure><h1 id="bb1b" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤2 —在文件夹中创建docker文件并编辑它。</h1><ul class=""><li id="8e07" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">创建如下所示的docker文件，并根据您的方便编辑它。</li><li id="c5a3" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">在第1行中，根据您的需求更改python版本。请记住，在下一步中，这应该与您的conda环境相同。</li><li id="be1d" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">在第5行中，将test.py更改为您的文件名。</li><li id="47f5" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">在第6行中，将测试更改为您的python文件名。比如我的文件名是test.py，它包含函数处理程序，所以对我来说它是<strong class="ig hi"> test.handler </strong>。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div class="er es kz"><img src="../Images/d18b8c6a3ab3594bc53787f587402712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/0*HuN79q7p5R_isFyy.png"/></div></figure><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es la"><img src="../Images/6957e73936af02c16843b5895b078a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sGNmuFrVOFFK2CXZ.png"/></div></div></figure><h1 id="c2c8" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">第三步——创造康达环境。</h1><ul class=""><li id="7d78" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">使用命令<strong class="ig hi">conda create-n&lt;env name&gt;python =&lt;version&gt;</strong>命令。</li><li id="d565" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">它将安装一些基本的库。出现提示时，点击<strong class="ig hi">‘y’</strong>和<strong class="ig hi">，输入</strong>。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/5020ee18230e70b6f02b06e6c8c53efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bY_gG6c41BPeTGA4.png"/></div></div></figure><h1 id="b82b" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤4-激活Conda环境。</h1><ul class=""><li id="dc89" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">使用<strong class="ig hi">conda activate&lt;env name&gt;</strong>命令激活conda环境。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div class="er es lg"><img src="../Images/43776b3731121c44d6294c9048f3744e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/0*bDn_7sROT3yfpuqs.png"/></div></figure><h1 id="b562" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤5 —在conda环境中安装所需的库。</h1><ul class=""><li id="2107" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">在conda环境中安装所需的包/库。</li><li id="87c3" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">使用命令<strong class="ig hi"> pip install &lt;空格分隔软件包名称&gt;T17】在环境中安装软件包。</strong></li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/67e8b062245ef1d53b0e3ca4942e4242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Stmufxk2RkBL84in.png"/></div></div></figure><h1 id="15a5" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤6——生成requirements.txt文件。</h1><ul class=""><li id="eb96" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">我们需要一个requirements.txt文件来创建docker容器。</li><li id="e8ba" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">我们将使用<strong class="ig hi">pip free&gt;requirements . txt</strong>命令将conda环境中的所有包存储在<strong class="ig hi"> requirements.txt </strong>文件中。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lh"><img src="../Images/da7838740059a79e439c0e15d164440d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EQptiZZayM5Dr3Qk.png"/></div></div></figure><figure class="kn ko kp kq fd kr er es paragraph-image"><div class="er es li"><img src="../Images/730c89652f021e9909245584458124b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/0*SEQIHur88YVmTU50.png"/></div></figure><h1 id="c714" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤7-在AWS上创建一个新的ECR对象。</h1><ul class=""><li id="d3fc" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">在搜索栏中搜索ECR，然后单击弹性容器注册表。</li><li id="db4f" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">然后点击创建存储库。</li><li id="18ee" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">在下一个屏幕上，只需为您的ECR容器命名。我把它命名为<strong class="ig hi"> test-ecr </strong>。</li><li id="9d31" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">成功创建后，在ECR主屏幕上搜索并点击它。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lj"><img src="../Images/672ba90b8c3634f368da3d1d1af19154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QKcEzjlGzEn0lG26.png"/></div></div></figure><h1 id="197d" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤8-打开推送命令。</h1><ul class=""><li id="e9af" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">打开后会是这样的。</li><li id="7666" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">如您所见，目前这里没有图像。</li><li id="4e92" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">单击查看推送命令按钮。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/868a5880601be8ebdd57be92e81db75f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nsFw1wt0zWsydRP-.png"/></div></div></figure><h1 id="c55c" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤9-执行推送命令。</h1><ul class=""><li id="fea2" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">下面是您需要在终端中执行的4个push命令。</li><li id="95dc" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">确保您的conda env已激活。</li><li id="c3db" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">第一个命令帮助您登录AWS。(确保您的Windows/Linux上安装了aws-cli，并且您的PC上设置了凭据)</li><li id="0632" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">第一次在PC上运行登录时，它会要求您提供凭据。您可以在IAM &gt;用户&gt;安全凭据&gt;创建访问密钥中获取它们。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lk"><img src="../Images/69acb7ac40461f62688a0301e2dedc5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f9V2Z5aYvIvn1QTs.png"/></div></div></figure><ul class=""><li id="2fe1" class="kb kc hh ig b ih ii il im ip ll it lm ix ln jb ki kj kk kl bi translated">第二步有助于建立形象。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/669713fbd8a0aef726054a837c75fb1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F0NbVKliUCoplbPb.png"/></div></div></figure><ul class=""><li id="c973" class="kb kc hh ig b ih ii il im ip ll it lm ix ln jb ki kj kk kl bi translated">第三步标记图像。</li><li id="c64b" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">第四步有助于将映像从本地推送到ECR。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/0acabbc21071808756cfde185f5290e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VlXDLe8C2GXV6Os7.png"/></div></div></figure><ul class=""><li id="e91b" class="kb kc hh ig b ih ii il im ip ll it lm ix ln jb ki kj kk kl bi translated">如果所有4个命令都被正确执行，您的ECR将显示一个名为<strong class="ig hi"><em class="lo">‘最新’</em></strong>的条目。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/fa2fd351fe5d7cf9cb2d9626ff95a9d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*v3kufXuK5axvDFrI.png"/></div></div></figure><h1 id="89f9" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">步骤10-创建一个新的Lambda函数。</h1><ul class=""><li id="5656" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">在主搜索栏中搜索Lambda。</li><li id="635e" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">点击<strong class="ig hi">创建功能</strong>按钮。</li><li id="bc3c" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">它将显示一个如下所示的窗口。</li><li id="f131" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">单击容器图像。</li><li id="b140" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">给你的Lambda函数一个名字，并选择你想使用的容器图像。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/5f8ce7f12fec7fb939675988b0161712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*79R2s4sU2rzRx7t7.png"/></div></div></figure><ul class=""><li id="9443" class="kb kc hh ig b ih ii il im ip ll it lm ix ln jb ki kj kk kl bi translated">这将使用您选择的ECR映像成功创建您的lambda。</li><li id="df97" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">你的Lambda将看起来像下图。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/b5f460535f3961aedb53f43ef62e4428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MRIDOnjKjgX9Fzlq.png"/></div></div></figure><h1 id="2431" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">第10步——测试一切是否正常。</h1><ul class=""><li id="dc67" class="kb kc hh ig b ih kd il ke ip kf it kg ix kh jb ki kj kk kl bi translated">我的lambda只接受2个数字并返回它们的和。</li><li id="3b94" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">所以我提供了两个数字，我的lambda只返回它们的和。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/2fbfaf023b9d04df05eb03d6f041076d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HSs_3rj3f6xTc17a.png"/></div></div></figure><ul class=""><li id="b269" class="kb kc hh ig b ih ii il im ip ll it lm ix ln jb ki kj kk kl bi translated">如果到目前为止您所做的一切都是正确的，测试结果将显示一个绿色提示，并带有“成功”消息。</li><li id="4adc" class="kb kc hh ig b ih ku il kv ip kw it kx ix ky jb ki kj kk kl bi translated">你可以看到结果是9。</li></ul><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/c0a51d28ac93a31bd60528b1cd206626.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RWtNF_OfeFa4i-Q2.png"/></div></div></figure><p id="e95f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">注意— Lambda仅提供3秒的超时。这意味着如果你的Lambda运行超过3秒，它将不会工作。进入配置&gt;通用配置，并根据您的需要进行更改。请记住，您最多可以设置15分钟。</strong></p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lf"><img src="../Images/4ca7d6135b9db4eecbc7e0c80aeca25a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4r8X3dQ7ZVCdqf1E.png"/></div></div></figure><p id="ce5e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lo">这就是我写给这个博客的所有内容，感谢你阅读它，我希望你在阅读完这篇文章后和下次阅读前能有所收获👋… </em></p><p id="0918" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">有关详细解释，请访问— </strong> <a class="ae jc" href="https://machinelearningprojects.net/create-an-aws-lambda-using-aws-ecr/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">如何使用PYTHON中的AWS ECR DOCKER容器映像创建AWS LAMBDA</strong></a></p><p id="d52e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">查看我的其他</strong> <a class="ae jc" href="https://machinelearningprojects.net/machine-learning-projects/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">机器学习项目</strong></a><strong class="ig hi"/><a class="ae jc" href="https://machinelearningprojects.net/deep-learning-projects/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">深度学习项目</strong></a><strong class="ig hi"/><a class="ae jc" href="https://machinelearningprojects.net/opencv-projects/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">计算机视觉项目</strong></a><strong class="ig hi"/><a class="ae jc" href="https://machinelearningprojects.net/nlp-projects/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">NLP项目</strong></a><strong class="ig hi"/><a class="ae jc" href="https://machinelearningprojects.net/flask-projects/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">烧瓶项目</strong> </a> <strong class="ig hi"> at </strong> <a class="ae jc" href="https://machinelearningprojects.net/" rel="noopener ugc nofollow" target="_blank"/></p><div class="lp lq ez fb lr ls"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">medium.com</p></div></div><div class="mb l"><div class="mc l md me mf mb mg ks ls"/></div></div></a></div></div></div>    
</body>
</html>