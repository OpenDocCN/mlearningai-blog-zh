<html>
<head>
<title>Deposit Predictive Model: A case study of imbalanced learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">存款预测模型:不平衡学习的案例研究</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/deposit-predictive-model-a-case-study-of-imbalanced-learning-3e408507c3ef?source=collection_archive---------3-----------------------#2020-08-27">https://medium.com/mlearning-ai/deposit-predictive-model-a-case-study-of-imbalanced-learning-3e408507c3ef?source=collection_archive---------3-----------------------#2020-08-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e5bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不平衡数据集建模</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/d008d14cfd2bbb41b60fe73af09acd05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TByqjZU1-kuazRpU"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@ikukevk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kevin Ku</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5433" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用不平衡数据训练机器学习算法的主要问题之一是该算法将倾向于预测多数类。此外，通过总是选择多数，可以错误地假设算法已经正确地模拟了数据。在本文中，我将通过一个银行业问题的例子来分享一些处理此类数据的方法。</p><p id="df7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大多数企业的主要目标之一是在保持现有客户的同时寻找新客户。在竞争激烈的银行业，维护老客户可能有点困难，因为有很多可供选择的客户</p><p id="d07e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在大多数银行中，投资和投资组合部门都希望确定哪些客户有可能认购他们的定期存款。因此，大多数营销经理对仔细调整他们的直接营销活动以严格选择联系人有了更高的兴趣；我们的目标是找到一个模型，可以预测哪些未来客户将订阅定期存款。拥有这样一个有效的预测模型有助于提高活动效率。这将有可能确定客户谁将订阅定期存款和直接营销的努力。</p><p id="e82e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这种提高的效率将有助于管理银行资源，如人力、电话和时间。因此，该银行收集了大量的数据，包括必须订阅定期存款和没有订阅定期存款的客户资料。我们的目标是开发一个稳健的预测模型，帮助识别未来会或不会认购其定期存款的客户。获得了包含以下特征的数据。</p><h1 id="ba7f" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据描述</h1><p id="c46c" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">1 —年龄(数字)</p><p id="313c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2-作业:作业类型(分类:“管理。”、“蓝领”、“企业家”、“女佣”、“管理人员”、“退休人员”、“个体户”、“服务人员”、“学生”、“技术人员”、“失业人员”、“未知人员”)</p><p id="1079" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3-婚姻:婚姻状况(分类:“离婚”、“已婚”、“单身”、“未知”)；注意:“离婚”是指离婚或丧偶)</p><p id="4c4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4 —教育(分类):“基础. 4y”、“基础. 6y”、“基础. 9y”、“高”。学校的”，“文盲的”，“专业的”。课程'，'大学。程度'，'未知')</p><p id="bfd4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5 —违约:有信用违约？(分类:“否”、“是”、“未知”)</p><p id="5e06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6 —住房:有住房贷款？(分类:“否”、“是”、“未知”)</p><p id="68b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7 —贷款:有个人贷款？(分类:“否”、“是”、“未知”)#与当前活动的最后一个联系人相关:</p><p id="1525" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">8-联系人:联系人通信类型(分类:“手机”、“电话”)</p><p id="3cc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">9-月:一年中的最后一个联系月(分类:“一月”、“二月”、“三月”、“十一月”、“十二月”)</p><p id="ad9f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">10-星期几:一周的最后一个联系日(分类:“星期一”、“星期二”、“星期三”、“星期四”、“Fri”)</p><p id="cab5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">11-持续时间:最后一次联系的持续时间，以秒为单位(数字)。重要注意事项:该属性对输出目标有很大影响(例如，如果duration=0，则y='no ')。然而，在执行呼叫之前，持续时间是未知的。同样，结束呼叫后‘y’显然是已知的。因此，该输入应仅用于基准测试目的，如果目的是获得现实的预测模型，则应丢弃。</p><p id="cd0b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">其他属性</strong></p><p id="09de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">12-活动:在此活动期间为此客户执行的联系次数(数字，包括最后一次联系)</p><p id="c986" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">13-pdays:从上一个活动中最后一次联系客户后经过的天数(数字；999表示之前没有联系过客户)</p><p id="cca5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">14-previous:在此活动之前为此客户执行的联系次数(数字)</p><p id="efca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">15-pout come:之前营销活动的结果(分类:“失败”、“不存在”、“成功”)</p><p id="67cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">社会经济背景属性</strong></p><p id="f93a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">16 —电磁脉冲。var.rate:雇佣变动率-季度指标(数字)</p><p id="e01d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">17 — cons.price.idx:消费者价格指数—月度指标(数字)</p><p id="ff70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">18 — cons.conf.idx:消费者信心指数—月度指标(数字)</p><p id="f9a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">19 — euribor3m: Euribor 3个月利率—每日指标(数字)</p><p id="0b7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">20 — nr。就业人数:雇员人数——季度指标(数字)</p><p id="0f47" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">输出变量(期望目标):</strong></p><p id="1c62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">21 — y —客户是否订阅了定期存款？(二进制:“是”，“否”)</p><h1 id="ed60" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">预处理</strong></h1><p id="9ba7" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">由于数据中分类特征的数量以及数据的不平衡性质，预处理的某些阶段对于获得良好的模型是必不可少的。</p><p id="4e4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对y列中不同值的快速计数显示出不均匀的分布。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kw"><img src="../Images/4ddd4382c7d27cfb904ca7f842668664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*MFxhzeMdOsvhOevSnyipCg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">y_value_counts</figcaption></figure><p id="c6b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过用一个热编码器处理分类列来预处理数据。使用如下所示的四分位值移除异常值。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kx"><img src="../Images/978b05a1c298d8b6670a365fe60e962c.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*40tX2wE46Gss-nzsSMUsDg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Outlier function</figcaption></figure><p id="0efc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MinMaxScaler用于缩放数据，使PCA算法能够有效地分解数据。</p><p id="8cd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后使用PCA分析来降低数据的高维度，这样做是为了使算法能够适当地拟合模型。PCA分析的代码可以在<a class="ae js" href="https://github.com/instabaines/Deposit_Predictive_Model" rel="noopener ugc nofollow" target="_blank"> repo </a>库中找到。分解后保留了约95%的方差。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ky"><img src="../Images/9eae8a0138d11413e03215ea7adc0f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TBdxzy3HnY2qkd1vANHjlw.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">PCA ANALYSIS</figcaption></figure><h1 id="939e" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">建模和性能评估</strong></h1><blockquote class="kz la lb"><p id="f804" class="ie if lc ig b ih ii ij ik il im in io ld iq ir is le iu iv iw lf iy iz ja jb ha bi translated">如前所述，数据是一个不平衡的数据。这个问题可以通过过采样或欠采样使用imblearning库来解决。在这方面有两种算法值得一提:SMOTE和TomekLinks算法。</p></blockquote><p id="9ce3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> Tomek链接</strong></p><p id="8e18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Tomek链接算法从具有Tomek链接的多数类中移除数据。tomek链接被定义为彼此最近邻的不同类别的数据。这是一种欠采样技术。</p><p id="0ec4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">重击</strong></p><p id="77e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">合成少数过采样技术(SMOTE)通过用直线完全连接少数类中的所有点来为少数类生成新点。然后，对于每个现有的数据点，SMOTE确定这些互连上的一个点，以基于有多少最近的邻居被考虑用于合成来制作新点。这是一种过采样技术。</p><p id="29dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这项研究中，SMOTE算法产生了更好的性能。这是可以预料的，因为欠采样往往会丢失一些重要的信息。</p><p id="e096" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">采用的机器学习算法有LogisticRegression、MLPClassifier、XGBoost。特别有用的模型是这种性质的分类问题。K-fold和分层K-fold用于分割数据以提高性能。</p><p id="a3a0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，使用其中任何一种方法时，性能都没有显著差异。这可以归因于SMOTE算法对数据执行的操作。RandomizedSearchCV和GridSearchCV分别用于调整MLPClassifier和Logistic回归的超参数。</p><p id="153a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用f1分数来估计算法的性能。它考虑了精确度和召回。在不平衡的二进制分类数据上，它可以是比准确度更好的度量。</p><p id="abd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">算法的精度给出如下。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lg"><img src="../Images/ce7e2f29cf097f7a1bcaf718345ac70e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*jy_f6ReykiRP12hhzfbMJg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">F1 score for the algorithm</figcaption></figure><p id="31dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">XGBoost算法的F1值最高</p><p id="ff33" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个项目的代码和数据可以在<a class="ae js" href="https://github.com/instabaines/Deposit_Predictive_Model" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>