<html>
<head>
<title>Stroke prediction using machine learning Regression with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的机器学习回归进行中风预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/stroke-prediction-using-machine-learning-regression-with-python-c0bc8ad5f8b8?source=collection_archive---------4-----------------------#2022-09-15">https://medium.com/mlearning-ai/stroke-prediction-using-machine-learning-regression-with-python-c0bc8ad5f8b8?source=collection_archive---------4-----------------------#2022-09-15</a></blockquote><div><div class="dt gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e861" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">中风是世界上最严重的医学问题之一，每年导致数百万人死亡，并被世界卫生组织(世卫组织)强调为严重的医学问题。</p><h1 id="8ed9" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">介绍</h1><p id="07dd" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">当我们冒险需要数据时，我们首先必须考虑患者保密原则，因为我们不能透露患者的某些细节，即使他们的姓名被隐藏，包括家族史和遗传学。</p><p id="f76d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于使用python sklearn库演示建模框架的数据在Kaggle上是公开可用的，并且用于学习，因此在ka ggle上不存在这种性质的问题。</p><figure class="kh ki kj kk fe kl es et paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="es et kg"><img src="../Images/3f949379fa5fcb44be6c66654da27833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ywA6Qx6Fp7c7kVtv"/></div></div><figcaption class="ks kt eu es et ku kv bd b be z dy">Photo by <a class="ae kw" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Winkler</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="7efa" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">数据理解</h1><p id="b8f5" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在将数据建模为业务解决方案之前，我们必须了解数据以及它能产生什么。根据公开数据集，我们可以理解数据中的以下特征意味着:</p><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="3f22" class="lc je hi ky b fj ld le l lf lg">id                   The patient's identification tag assigned.<br/>gender               The Biological sex of the patient.<br/>age                  The patient's age at admittance.<br/>hypertension         The patient's blood pressure intensity.<br/>heart_disease        The patient is/not with the heart diesease.                    <br/>ever_married         Status of Marriage of the patient.<br/>work_type            Patient's employment classification.<br/>Residence_type       Patient's residence classification.<br/>avg_glucose_level    Patient's average level of sugar.<br/>bmi                  patient's total body mass.<br/>smoking_status       patient's does/does not smoke.<br/>stroke               patient's did/didnt have a stroke.</span></pre><h1 id="bdb0" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">建模方法</h1><p id="6bfd" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我们必须首先识别和理解数据及其所有特征，因为我们可能会发现更多有价值的特征，这些特征可以让我们对数据有更深入的了解，并做出更有价值的预测。</p><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="5060" class="lc je hi ky b fj ld le l lf lg"># Import basic libraries<br/>import pandas as pd<br/>import numpy as np<br/>%matplotlib inline<br/>import seaborn as sns<br/>import missingno as mn</span></pre><h2 id="51c5" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">1.文件介绍</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="0559" class="lc je hi ky b fj ld le l lf lg"># Enter kaggle link in pandas and set file name as 'df'</span><span id="10d3" class="lc je hi ky b fj lu le l lf lg">df =  pd.read_csv(r'/kaggle/input/stroke-prediction-dataset/healthcare-dataset-stroke-data.csv')</span><span id="8eb5" class="lc je hi ky b fj lu le l lf lg"># view first five rows</span><span id="2ce8" class="lc je hi ky b fj lu le l lf lg">df.head(5)</span></pre><h2 id="25d3" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">2.检查变量的所有统计数据</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="694f" class="lc je hi ky b fj ld le l lf lg"><em class="lv"># lets check all stats</em><br/>df.describe()</span></pre><figure class="kh ki kj kk fe kl es et paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="es et lw"><img src="../Images/6169e0cf09d15fa2a1b42f7139e97275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nEqxZdKNgPpW62zT7ndbMg.png"/></div></div><figcaption class="ks kt eu es et ku kv bd b be z dy">Authors Visualization</figcaption></figure><h2 id="0c27" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">3.检查缺少的值</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="2421" class="lc je hi ky b fj ld le l lf lg"><em class="lv"># lets check for null values </em><br/>df<strong class="ky hj">.</strong>isnull()<strong class="ky hj">.</strong>sum()</span><span id="6560" class="lc je hi ky b fj lu le l lf lg">OUTPUT:</span><span id="56ba" class="lc je hi ky b fj lu le l lf lg">id                     0<br/>gender                 0<br/>age                    0<br/>hypertension           0<br/>heart_disease          0<br/>ever_married           0<br/>work_type              0<br/>Residence_type         0<br/>avg_glucose_level      0<br/>bmi                  201<br/>smoking_status         0<br/>stroke                 0<br/>dtype: int64</span><span id="34ab" class="lc je hi ky b fj lu le l lf lg"># we can see that bmi has 201 missing values</span></pre><h2 id="8580" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">4.检查缺失的值关系</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="19ac" class="lc je hi ky b fj ld le l lf lg"><em class="lv"># we need to first examine connections of missing values </em><br/>mn<strong class="ky hj">.</strong>matrix(df)<br/># Based on the output below we can see values are missing at random </span></pre><figure class="kh ki kj kk fe kl es et paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="es et lx"><img src="../Images/25310128ccbbbdee9c4f49522c871354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWdAY4qRPmiK4ZarOYreHQ.png"/></div></div><figcaption class="ks kt eu es et ku kv bd b be z dy">Authors Visualization</figcaption></figure><h2 id="86ad" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">5.我们形象化了缺失值连接的树状图</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="8a05" class="lc je hi ky b fj ld le l lf lg">mn.dendrogram(df)</span></pre><figure class="kh ki kj kk fe kl es et paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="es et ly"><img src="../Images/678dec9bfcb12325c2823388b71b8f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JqpOYr1NSVAiWFQT_x8bPA.png"/></div></div><figcaption class="ks kt eu es et ku kv bd b be z dy">Authors visualization</figcaption></figure><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="e5f2" class="lc je hi ky b fj ld le l lf lg"><em class="lv"># so we can fill bmi's missing values with smoking_status values as we can see the connection from the dendrogram</em></span><span id="3d38" class="lc je hi ky b fj lu le l lf lg">df[df['bmi'].isnull()]['smoking_status'].value_counts()</span><span id="0683" class="lc je hi ky b fj lu le l lf lg">OUTPUT:</span><span id="b2bb" class="lc je hi ky b fj lu le l lf lg">Unknown            61<br/>smokes             52<br/>formerly smoked    48<br/>never smoked       40<br/>Name: smoking_status, dtype: int64</span></pre><h2 id="5366" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">6.我们通过计数检查患者体内记录的身体质量指数水平。</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="e6f8" class="lc je hi ky b fj ld le l lf lg">from matplotlib import pyplot as plt<br/>plt.hist(df['bmi'])</span></pre><figure class="kh ki kj kk fe kl es et paragraph-image"><div class="es et lz"><img src="../Images/0b6dcd6abf65f74838fa479002c6c1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*FgfSUrPBICAqAsHE-vBvSA.png"/></div><figcaption class="ks kt eu es et ku kv bd b be z dy">Authors visualization</figcaption></figure><h2 id="b7d2" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">7.小心警戒！</h2><p id="9f75" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">由于上述身体质量指数水平的数据过于外推，仅使用一个类别来填充剩余的缺失值是不安全的</p><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="9eee" class="lc je hi ky b fj ld le l lf lg"><em class="lv"># instead we shall use interpolation to fetch the nearest form of data to fill the missing values</em></span><span id="f990" class="lc je hi ky b fj lu le l lf lg">df['bmi'] = df['bmi'].interpolate(method ='linear', limit_direction='forward')</span><span id="2963" class="lc je hi ky b fj lu le l lf lg"><em class="lv"># lets check if that worked </em><br/>df.isnull().sum()</span><span id="b6c6" class="lc je hi ky b fj lu le l lf lg">OUTPUT:</span><span id="4d1f" class="lc je hi ky b fj lu le l lf lg">id                   0<br/>gender               0<br/>age                  0<br/>hypertension         0<br/>heart_disease        0<br/>ever_married         0<br/>work_type            0<br/>Residence_type       0<br/>avg_glucose_level    0<br/>bmi                  0<br/>smoking_status       0<br/>stroke               0<br/>dtype: int64</span></pre><p id="a3fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们现在已经填充了所有缺失的值，如上所示。</p><h2 id="e442" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">8.我们按卒中对平均血糖水平进行分类，以观察卒中原因是否取决于患者计数的平均血糖水平。</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="bf62" class="lc je hi ky b fj ld le l lf lg"># check by first 20 rows and place in a object called 'measure'</span><span id="90fc" class="lc je hi ky b fj lu le l lf lg">measure = df[['avg_glucose_level','stroke']].head(20)</span></pre><figure class="kh ki kj kk fe kl es et paragraph-image"><div class="es et ma"><img src="../Images/c1c97e531cdde4223b1a74b58d974b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*r8StCMJNrGQQLR582wfT0A.png"/></div><figcaption class="ks kt eu es et ku kv bd b be z dy">Authors visualization</figcaption></figure><h2 id="1ed8" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">9.在散点图中检查中风患者的平均血糖水平</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="e611" class="lc je hi ky b fj ld le l lf lg"><em class="lv"># lets check the relationship throughout all given datapoints in both attributes</em><br/>df.plot.scatter('avg_glucose_level','stroke')</span></pre><figure class="kh ki kj kk fe kl es et paragraph-image"><div class="es et mb"><img src="../Images/6e8489c17df67f5d787341d132738907.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*315PL-wP5263alVXWd94wg.png"/></div><figcaption class="ks kt eu es et ku kv bd b be z dy">Authors Visualization</figcaption></figure><p id="9a58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显示出葡萄糖水平是随机变量，并且在中风患者和非中风患者中是高的。</p><h1 id="7eb1" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">机器学习建模</h1><p id="fff5" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">在基于监督回归的机器学习算法中使用线性回归进行预测。</p><h2 id="1329" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">10.<em class="mc">让我们删除不必要的分类列</em></h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="62fe" class="lc je hi ky b fj ld le l lf lg">df.drop(['gender'], axis=1, inplace=True)</span><span id="08a8" class="lc je hi ky b fj lu le l lf lg">df.drop(['smoking_status'], axis=1, inplace=True)</span><span id="5192" class="lc je hi ky b fj lu le l lf lg">df.drop(['ever_married'], axis=1, inplace=True)</span><span id="e35d" class="lc je hi ky b fj lu le l lf lg">df.drop(['work_type'], axis=1, inplace=True)</span><span id="2ad5" class="lc je hi ky b fj lu le l lf lg">df.drop(['Residence_type'], axis=1, inplace=True)</span></pre><h2 id="0c79" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">11.我们设置x和y变量，通过将x作为中风，将y作为中风相对于x的预测数据，来预测中风。</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="f071" class="lc je hi ky b fj ld le l lf lg">x = df.drop(['stroke'], axis=1)<br/>y = df['stroke']</span></pre><h2 id="8192" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">12.机器学习的导入算法。</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="1f6b" class="lc je hi ky b fj ld le l lf lg">from sklearn.linear_model import LinearRegression<br/>from sklearn.model_selection import train_test_split as ttl</span></pre><h2 id="dc61" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">13.分割数据，拟合和测试模型</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="628e" class="lc je hi ky b fj ld le l lf lg"><em class="lv"># lets split the training and testing data </em><br/># tx,ty are training data and tey and tex are testing data</span><span id="d8f8" class="lc je hi ky b fj lu le l lf lg">tx, tex, ty, tey = ttl(x, y, test_size=0.3, random_state=0)</span><span id="2591" class="lc je hi ky b fj lu le l lf lg"># Create Regression<br/>Model_str = LinearRegression()<br/></span><span id="8727" class="lc je hi ky b fj lu le l lf lg"><em class="lv"># now lets fit the training data </em><br/>Model_str = Model_str.fit(tx,ty)</span><span id="c8d6" class="lc je hi ky b fj lu le l lf lg">#<em class="lv"> Now to predict with the test data </em><br/>Model_str.predict(tex)</span><span id="59ce" class="lc je hi ky b fj lu le l lf lg"># Place predicted outputs in a variable<br/>prediction = Model_str.predict(tex)</span></pre><h2 id="2bee" class="lc je hi bd jf lh li lj jj lk ll lm jn iq ln lo jr iu lp lq jv iy lr ls jz lt bi translated">14.检查模型结果并保存模型</h2><pre class="kh ki kj kk fe kx ky kz la aw lb bi"><span id="0dea" class="lc je hi ky b fj ld le l lf lg"># CHECK MODEL INTERCEPT<br/>Model_str.intercept_</span><span id="de33" class="lc je hi ky b fj lu le l lf lg">OUTPUT:<br/>-0.039604964329334226</span><span id="8848" class="lc je hi ky b fj lu le l lf lg"># CHECK MODEL COEFFICIENT<br/>Model_str.coef_</span><span id="892f" class="lc je hi ky b fj lu le l lf lg">OUTPUT:</span><span id="fd1a" class="lc je hi ky b fj lu le l lf lg">array([ 3.47715041e-08,  2.04813204e-03,  3.34073078e-02,  9.02350420e-02,2.48261512e-04, -1.26123592e-03])</span><span id="111d" class="lc je hi ky b fj lu le l lf lg"># Save your model for future use on another machine with the same data</span><span id="22b4" class="lc je hi ky b fj lu le l lf lg">model<strong class="ky hj">.</strong>save('Stroke Regression Model by Ammar')</span></pre><h1 id="cafe" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">结论</h1><p id="8b70" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">因此，虽然我们的模型可以工作，但在使用之前需要进行改进，因为该指标还没有显示其部署就绪！</p><p id="fe20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，这是一个很好的概念证明，证明了我们如何使用回归来预测中风。</p><h1 id="8fcb" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">作者指出</h1><p id="ca3a" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我希望这对你在工作场所或学术机构的医疗保健领域的机器学习项目有所帮助。</p><p id="1e36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我期待您对我工作的改进提出反馈和建议。</p><h1 id="e0cb" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">我是谁</h1><figure class="kh ki kj kk fe kl es et paragraph-image"><div class="es et md"><img src="../Images/d118fc6146789c1380ad8af6bbc25826.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/0*s0ZmEMWEgCLJxfQb.jpeg"/></div></figure><p id="a953" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嘿，伙计们，我目前正在伦敦大学攻读数据科学硕士学位，并作为一名自由职业者在Upwork上从事分析工作。如果您对任何基于分析/数据科学/机器学习的项目有任何评论、批评或任何建议需求。请随时在LinkedIn上联系我。您可以使用我的Github/ka ggle python代码模板库和已经制作的可视化和机器学习模型来实现或参考。</p><blockquote class="me mf mg"><p id="dd82" class="if ig lv ih b ii ij ik il im in io ip mh ir is it mi iv iw ix mj iz ja jb jc hb bi translated"><em class="hi">领英:</em><a class="ae kw" href="https://www.linkedin.com/in/goto-resumemuhammad-ammar-jamshed-029280145/" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://www . LinkedIn . com/in/goto-resumemuhammad-ammar-jamshed-029280145/</em></a></p><p id="855a" class="if ig lv ih b ii ij ik il im in io ip mh ir is it mi iv iw ix mj iz ja jb jc hb bi translated"><em class="hi">GitHub:</em>T10<em class="hi">https://github.com/AmmarJamshed</em>T13】</p><p id="ff17" class="if ig lv ih b ii ij ik il im in io ip mh ir is it mi iv iw ix mj iz ja jb jc hb bi translated"><em class="hi">卡格尔:</em><a class="ae kw" href="https://www.kaggle.com/muhammadammarjamshed" rel="noopener ugc nofollow" target="_blank"><em class="hi">https://www.kaggle.com/muhammadammarjamshed</em></a></p></blockquote><div class="mk ml fa fc mm mn"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mo ab dx"><div class="mp ab mq cl cj mr"><h2 class="bd hj fj z dz ms eb ec mt ee eg hh bi translated">Mlearning.ai提交建议</h2><div class="mu l"><h3 class="bd b fj z dz ms eb ec mt ee eg dy translated">如何成为Mlearning.ai上的作家</h3></div><div class="mv l"><p class="bd b fq z dz ms eb ec mt ee eg dy translated">medium.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb kq mn"/></div></div></a></div></div></div>    
</body>
</html>