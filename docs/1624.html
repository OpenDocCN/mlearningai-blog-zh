<html>
<head>
<title>AutoML with Successive Halfing and Hyperband</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有连续半调和超带的AutoML</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/automl-with-successive-halfing-and-hyperband-e130a05dded9?source=collection_archive---------3-----------------------#2022-01-13">https://medium.com/mlearning-ai/automl-with-successive-halfing-and-hyperband-e130a05dded9?source=collection_archive---------3-----------------------#2022-01-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/c89a94ce9c7b7d67a1c43559e7ce2546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XMmiIBR_ivlGZxmpP-DNVw.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx"><a class="ae hu" href="https://pixabay.com/de/vectors/sch%c3%a4del-kopf-mensch-m%c3%a4nnlich-mann-2099083/" rel="noopener ugc nofollow" target="_blank">pixabay.com</a></figcaption></figure><div class=""/><p id="d2fa" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我的上两篇中型文章(参见<a class="ae hu" rel="noopener" href="/mlearning-ai/automated-machine-learning-and-hyperparameter-optimisation-f33be5eb6901">自动机器学习和超参数优化</a>和<a class="ae hu" rel="noopener" href="/@sabrinaherbst/blackbox-and-bayesian-optimisation-d651295199de">黑盒和贝叶斯优化</a>)中对自动机器学习(AutoML)进行了简短介绍后，我想继续讨论由李等人[1]开发并于2017年发表的超波段算法。</p><p id="229f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据他们的说法，高效的自动化机器学习可以通过两个主要目标来实现:</p><ol class=""><li id="13f4" class="js jt hx iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated"><strong class="iw hy">配置选择</strong>。在配置选择方法中，我们试图通过找到一种在非常早期阶段预测配置的估计性能的方法来加速AutoML算法，并投资于测试更有希望的配置(与例如网格搜索相反，在网格搜索中测试所有配置)。配置选择方法的一个非常常见的例子是贝叶斯优化。</li><li id="98fa" class="js jt hx iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated"><strong class="iw hy">配置评测</strong>。在配置评估方法中，为模型评估分配了一定量的资源。因此，更多的资源将被给予有希望的解决方案，而不太有希望的解决方案将只能获得更少的资源，并将尽快被删除。连续半化[2]和超带算法[1]就是这种方法的例子。</li></ol><h1 id="c8d8" class="kg kh hx bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">连续半减</h1><p id="2338" class="pw-post-body-paragraph iu iv hx iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">连续半化是由Jamieson等人[2]在2016年提出的。该算法代表了用于调整超参数的相对简单和鲁棒的方法。下面的信息摘自各自的论文，要了解关于连续半化的更多信息，我会将您重定向到该论文。</p><p id="14c3" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在连续半化中，一定量的资源被给予一组模型配置。然后对这些进行训练和评估，最差的一半(因此，连续的<em class="lj">半化</em>)被丢弃。在下一轮中，分配更多的资源来训练和评估剩余的模型。重复这一过程，直到只剩下一个配置。</p><p id="e3bd" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作者用类似的超参数优化方法测试了他们的方法，包括统一分配策略(例如网格搜索)。尽管统一分配策略训练的模型只有连续半化的一半，但他们能够证明连续半化在更短的时间内返回可比较的结果。</p><h2 id="f951" class="lk kh hx bd ki ll lm ln km lo lp lq kq jf lr ls ku jj lt lu ky jn lv lw lc lx bi translated">改进的潜力</h2><p id="8a0e" class="pw-post-body-paragraph iu iv hx iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">虽然连续的半化已经产生了好的结果，但是仍然有一些改进的空间。</p><p id="35a6" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据给定的最大似然问题(以及所使用的算法)，应该考虑测试哪一个更好</p><ul class=""><li id="0334" class="js jt hx iw b ix iy jb jc jf ju jj jv jn jw jr ly jy jz ka bi translated"><em class="lj">更多的配置，花费更少的资源来培训它们</em>或者</li><li id="e57c" class="js jt hx iw b ix kb jb kc jf kd jj ke jn kf jr ly jy jz ka bi translated"><em class="lj">更少的配置，但在培训模型上花费更多的资源</em> [1]。</li></ul><p id="782f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这就是超波段算法试图解决的问题。</p><h1 id="8138" class="kg kh hx bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">超波段</h1><p id="9753" class="pw-post-body-paragraph iu iv hx iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">超波段算法是一种相对容易理解和简单的算法。它类似于随机搜索的更高级版本。以下资料可在李等[1]中找到。</p><p id="f08a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面的截图显示了Hyperband算法的伪代码。</p><figure class="ma mb mc md fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lz"><img src="../Images/e49dd6e6ac980bc95913c3eda775bb46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MwR_1wJmGAjDxZNw2ViSQA.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Screenshot taken from Li et al. [1], p.8</figcaption></figure><p id="4580" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该算法采用以下两个输入，并返回单个(到目前为止)最佳配置。</p><ul class=""><li id="250a" class="js jt hx iw b ix iy jb jc jf ju jj jv jn jw jr ly jy jz ka bi translated"><strong class="iw hy"> R </strong>是用于一个单一配置的最大资源量</li><li id="d5cc" class="js jt hx iw b ix kb jb kc jf kd jj ke jn kf jr ly jy jz ka bi translated"><strong class="iw hy"> η </strong>控制在每一轮连续半化中将移除多少模型(作者建议使用3或4，因此<em class="lj">半化</em>在这里不一定适用)</li></ul><p id="d8a0" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">可以看出，该算法由两个嵌套的for循环组成。<strong class="iw hy">内</strong>执行连续半模。在Hyperband中，连续半化算法基本上作为一个子程序调用，除了在每一轮中丢弃的配置数量之外，没有重大调整。</p><p id="9af0" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">外层</strong>迭代不同值的<strong class="iw hy"> n </strong>(每轮连续半化中评估的配置数量)和<strong class="iw hy"> r </strong>(用于训练模型的资源数量)。这正是解决在连续对半中描述的问题，即在用很少的资源训练许多模型之间找到平衡，反之亦然。</p><p id="5d30" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，可以看出，该算法实现了三个附加功能。</p><ul class=""><li id="a954" class="js jt hx iw b ix iy jb jc jf ju jj jv jn jw jr ly jy jz ka bi translated"><strong class="iw hy">get _ hyperparameter _ configuration s</strong>:返回<em class="lj"> n </em>模型和超参数配置(可以随机选择，也可以遵循一定的分布)。</li><li id="05e3" class="js jt hx iw b ix kb jb kc jf kd jj ke jn kf jr ly jy jz ka bi translated"><strong class="iw hy">run _ then _ return _ val _ loss</strong>:使用一些训练数据训练给定的模型，并在验证集上评估模型的性能。然后返回验证损失(一些任意的性能度量)。</li><li id="f073" class="js jt hx iw b ix kb jb kc jf kd jj ke jn kf jr ly jy jz ka bi translated"><strong class="iw hy"> top_k </strong>:根据验证损失返回给定配置集的前<em class="lj"> k </em>个配置。</li></ul><p id="7984" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">可以观察到的是，hyperband的优势之一是停止将资源投入到没有前景的配置中，而是使用它们来探索更有前景的配置。因此，Hyperband实现了一种提前停止的方法，从而提高了性能。</p><p id="d0ed" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">李等人[1]进行了一些实验，并观察到，当将Hyperband与流行的贝叶斯优化技术进行比较时，Hyperband通常快5到30倍。这些观察是对深度学习和基于内核的技术进行的。</p><p id="6c64" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">很容易看出，该算法可以并行运行，因为不同配置的训练和评估可以彼此独立地进行。</p><p id="a796" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，除了随机抽样，还可以采用有利于更有希望的解决方案的技术。例如，这包括元学习。元学习试图通过例如比较数据集的属性来整合关于以前的数据集及其高性能解决方案的信息，以“热启动”对最佳模型和超参数的搜索。</p></div><div class="ab cl me mf go mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ha hb hc hd he"><p id="92dc" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[1]李等<a class="ae hu" href="https://dl.acm.org/doi/abs/10.5555/3122009.3242042" rel="noopener ugc nofollow" target="_blank"> Hyperband:一种新的基于bandit的超参数优化方法。</a> <em class="lj"> J .马赫。学习。18，1:6765–6816。2017.</em></p><p id="9895" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[2] Jamieson等<a class="ae hu" href="https://proceedings.mlr.press/v51/jamieson16.html" rel="noopener ugc nofollow" target="_blank">非随机最佳臂识别和超参数优化。</a> <em class="lj">第19届人工智能与统计国际会议论文集</em>，PMLR 51:240–248，2016。</p><div class="hg hh ez fb hi ml"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mm ab dw"><div class="mn ab mo cl cj mp"><h2 class="bd hy fi z dy mq ea eb mr ed ef hw bi translated">Mlearning.ai提交建议</h2><div class="ms l"><h3 class="bd b fi z dy mq ea eb mr ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mt l"><p class="bd b fp z dy mq ea eb mr ed ef dx translated">medium.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz ho ml"/></div></div></a></div></div></div>    
</body>
</html>