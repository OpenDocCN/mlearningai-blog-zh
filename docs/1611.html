<html>
<head>
<title>Fake News Classifier using LSTM â€” with source code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨LSTMçš„å‡æ–°é—»åˆ†ç±»å™¨â€”â€”å¸¦æºä»£ç </h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/fake-news-classifier-using-lstm-with-source-code-fun-project-4f0845e73c6a?source=collection_archive---------6-----------------------#2022-01-11">https://medium.com/mlearning-ai/fake-news-classifier-using-lstm-with-source-code-fun-project-4f0845e73c6a?source=collection_archive---------6-----------------------#2022-01-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2c96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æ‰€ä»¥åœ¨è¿™ä¸ªåšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨LSTMå®ç°ä¸€ä¸ªå‡æ–°é—»åˆ†ç±»å™¨ã€‚æ‰€ä»¥æ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„åŸå› ã€‚</p><p id="8f3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">åœ¨è¿™é‡Œé˜…è¯»å¸¦æºä»£ç çš„å…¨æ–‡â€”</strong><a class="ae jc" href="https://machinelearningprojects.net/fake-news-classifier-using-lstm/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/fake-news-classifier-using-lstm/</a></p><p id="e69b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹è§†é¢‘â€”ã€https://youtu.be/XcHtSSKE6PI T4ã€‘</p><h1 id="4261" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">è®©æˆ‘ä»¬å¼€å§‹å§â€¦</h1><h2 id="6f31" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤1-å¯¼å…¥å‡æ–°é—»åˆ†ç±»å™¨æ‰€éœ€çš„åº“ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="3e07" class="kb je hh ku b fi ky kz l la lb">import re<br/>import nltk<br/>import numpy as np<br/>import pandas as pd<br/>import tensorflow as tf<br/>from nltk.corpus import stopwords<br/>from nltk.stem.porter import PorterStemmer<br/>from tensorflow.keras.models import Sequential<br/>from sklearn.model_selection import train_test_split<br/>from tensorflow.keras.preprocessing.text import one_hot<br/>from sklearn.metrics import confusion_matrix,accuracy_score<br/>from tensorflow.keras.preprocessing.sequence import pad_sequences<br/>from tensorflow.keras.layers import Embedding,LSTM,Dense,Dropout<br/><br/>nltk.download('stopwords')</span></pre><h2 id="070a" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤2 â€”è¯»å–è¾“å…¥æ•°æ®ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="3d72" class="kb je hh ku b fi ky kz l la lb">df = pd.read_csv('train.csv')<br/>df.dropna(inplace=True)<br/>df.reset_index(inplace=True)<br/>df.head(10)</span></pre><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lc"><img src="../Images/a4bbb20083513265173fdc14d5ca6839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*P3Y7L7ALmFr9v4gb.png"/></div></div></figure><h2 id="3a51" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤3-åˆ›å»ºXå’Œyæ•°æ®ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="58a0" class="kb je hh ku b fi ky kz l la lb">X = df['title']<br/>y = df['label']</span></pre><ul class=""><li id="2c10" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">å¯¹äºXï¼Œæˆ‘ä»¬åªå–æ ‡é¢˜åˆ—ã€‚</li><li id="273c" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">å¯¹äºyï¼Œæˆ‘ä»¬åªå–æ ‡ç­¾åˆ—ã€‚</li></ul><h2 id="a0a5" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤4-æ¸…ç†è¾“å…¥æ•°æ®ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="9465" class="kb je hh ku b fi ky kz l la lb">ps = PorterStemmer()<br/>corpus = []<br/><br/>for i in range(len(X)):<br/>    text = X[i]<br/>    text = re.sub('[^a-zA-Z]',' ',text)<br/>    text = text.lower()<br/>    text = text.split()<br/>    text = [ps.stem(t) for t in text if t not in stopwords.words('english')]<br/>    corpus.append(' '.join(text))</span></pre><ul class=""><li id="2891" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éå†Xï¼Œç„¶åç®€å•åœ°ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥æ¸…ç†æˆ‘ä»¬çš„æ•°æ®ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨è¯­æ–™åº“åˆ—è¡¨ä¸­ã€‚</li><li id="3dca" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬åªæ˜¯æŠŠæ‰€æœ‰ä¸æ˜¯å­—æ¯è¡¨çš„ä¸œè¥¿éƒ½æ¢æˆäº†ç©ºæ ¼ã€‚</li><li id="bfb7" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">ç„¶åæˆ‘ä»¬æŠŠå®ƒå°å†™å¹¶æ‹†åˆ†ã€‚</li><li id="4559" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">ç„¶åæˆ‘ä»¬æ£€æŸ¥å•è¯æ˜¯å¦ä¸åœ¨åœç”¨è¯ä¸­ï¼Œç„¶åé˜»æ­¢å®ƒã€‚</li><li id="bc93" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">åªéœ€å°†è¿™äº›ç»“æœè¿æ¥èµ·æ¥ï¼Œç”¨å®ƒä»¬é€ ä¸€ä¸ªå¥å­ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°è¯­æ–™åº“åˆ—è¡¨ä¸­ã€‚</li></ul><h2 id="78c8" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤5 â€”ç¼–ç è¾“å…¥æ•°æ®ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="404e" class="kb je hh ku b fi ky kz l la lb">vocab_size = 5000<br/>sent_len = 20<br/><br/>one_hot_encoded = [one_hot(x,vocab_size) for x in corpus]<br/>one_hot_encoded = pad_sequences(one_hot_encoded,maxlen=sent_len)<br/>one_hot_encoded[0]</span></pre><ul class=""><li id="6d79" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<a class="ae jc" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/text/one_hot" rel="noopener ugc nofollow" target="_blank"> one_hot </a>å°†æ–‡æœ¬æ•°æ®ç¼–ç æˆæ•°å­—æ•°æ®ã€‚</li><li id="3de5" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">è®°ä½è¿™ä¸ªçƒ­ç‚¹ä¸æ˜¯0å’Œ1ã€‚åœ¨è¿™ç§ä¸€æ¬¡æ€§ç¼–ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•£åˆ—æ³•ç»™å•è¯åˆ†é…ä¸€ä¸ªéšæœºæ•°ã€‚éšæœºå­—ä»0-vocab_sizeçš„èŒƒå›´ä¸­é€‰æ‹©ã€‚</li><li id="fc09" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">ç„¶åæˆ‘ä»¬ç”¨0å¡«å……åºåˆ—ï¼Œä½¿æ¯ä¸€è¡Œé•¿åº¦ç›¸åŒã€‚</li><li id="a69c" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">ç„¶åæˆ‘ä»¬ç®€å•åœ°æ£€æŸ¥è¿™ä¸¤ä¸ªæ“ä½œä¹‹åï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå¥å­æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚</li></ul><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ly"><img src="../Images/74857e3d1cc2b7ed9bc17a8fb2b95e27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*E3BPHAX4ZtW7y9BD.png"/></div></div></figure><h2 id="512c" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤6 â€”å¤„ç†Xå’Œyæ•°æ®ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="9e47" class="kb je hh ku b fi ky kz l la lb">X = np.array(one_hot_encoded)<br/>y = np.array(y)<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)</span></pre><ul class=""><li id="ed20" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">å°†Xå’Œyè½¬æ¢ä¸ºNumPyæ•°ç»„ï¼Œå¹¶ä½¿ç”¨<a class="ae jc" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"> traintestsplit </a>ç®€å•æ‹†åˆ†æ•°æ®ã€‚</li></ul><h2 id="5584" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤7 â€”åˆ›å»ºæ¨¡å‹ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="840e" class="kb je hh ku b fi ky kz l la lb">no_of_output_features = 40<br/><br/>model = Sequential()<br/><br/>model.add(Embedding(vocab_size,no_of_output_features,input_length=sent_len))<br/>model.add(Dropout(0.5))<br/>model.add(LSTM(100))<br/>model.add(Dropout(0.5))<br/>model.add(Dense(1))<br/><br/>model.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])<br/><br/>model.summary()</span></pre><ul class=""><li id="1c03" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨åˆ›å»ºæˆ‘ä»¬çš„æ¨¡å‹ã€‚</li><li id="306f" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">æˆ‘ä»¬çš„æ¨¡å‹åªæœ‰4å±‚ã€‚</li><li id="716c" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">ç¬¬ä¸€å±‚æ˜¯åµŒå…¥å±‚ï¼Œå®ƒå°†æŠŠæˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„æ•°å­—æ•°ç»„è½¬æ¢æˆä¸€ä¸ª40ç»´çš„å‘é‡ï¼Œåé¢æ˜¯ä¸€ä¸ª<a class="ae jc" href="https://keras.io/api/layers/regularization_layers/dropout/" rel="noopener ugc nofollow" target="_blank"> Dropout </a>å±‚ã€‚</li><li id="f8a1" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">ç„¶åæˆ‘ä»¬æœ‰ä¸€ä¸ªæœ‰100ä¸ªèŠ‚ç‚¹çš„<a class="ae jc" href="https://keras.io/api/layers/recurrent_layers/lstm/" rel="noopener ugc nofollow" target="_blank"> LSTM </a>å±‚ï¼Œåé¢æ˜¯ä¸€ä¸ªä¸¢å¼ƒå±‚ã€‚</li><li id="6187" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">è„±è½å±‚ç”¨äºé˜²æ­¢è¿‡åº¦è´´åˆã€‚</li></ul><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lz"><img src="../Images/5f8ed029c45458444f8c22bcc8e18591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bmLb9Et5ROneMWYi.png"/></div></div></figure><h2 id="3fe9" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤8-è®­ç»ƒå‡æ–°é—»åˆ†ç±»å™¨æ¨¡å‹ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="d2a3" class="kb je hh ku b fi ky kz l la lb">model.fit(X_train,y_train,validation_data=(X_test,y_test),batch_size=64,epochs=40)</span></pre><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lc"><img src="../Images/9a1c645ca7e797ab21d9d08191d7a28c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hgIdVA1M1oybT9jf.png"/></div></div></figure><h2 id="3eec" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤9â€”â€”æ£€æŸ¥æ¨¡å‹çš„æŒ‡æ ‡ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="a6e2" class="kb je hh ku b fi ky kz l la lb">pred = model.predict_classes(X_test)<br/>confusion_matrix(y_test,pred)</span></pre><ul class=""><li id="533b" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬åªæ˜¯æ‰“å°<a class="ae jc" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html" rel="noopener ugc nofollow" target="_blank">æ··æ·†çŸ©é˜µ</a>æ¥æ£€æŸ¥æˆ‘ä»¬æ¨¡å‹çš„æ€§èƒ½ã€‚</li></ul><figure class="kp kq kr ks fd ld er es paragraph-image"><div class="er es ma"><img src="../Images/20874c4ba64f0d476d32084d34598bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/0*pAfZsI88qZZogPee.png"/></div></figure><h2 id="ebe5" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">æ­¥éª¤10-æ£€æŸ¥å‡æ–°é—»åˆ†ç±»å™¨æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="8087" class="kb je hh ku b fi ky kz l la lb">accuracy_score(y_test,pred)</span></pre><figure class="kp kq kr ks fd ld er es paragraph-image"><div class="er es mb"><img src="../Images/6854777167ace86cc1e2754ca418606b.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/0*V-Ik1h4u2nobWEIO.png"/></div></figure><p id="06f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å¦‚æœå¯¹è¿™ä¸ªè¯é¢˜æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·é€šè¿‡ç”µå­é‚®ä»¶æˆ–LinkedInè”ç³»æˆ‘ã€‚æˆ‘å·²ç»å°½åŠ›è§£é‡Šè¿™ä¸ªä»£ç äº†ã€‚</p><p id="2f2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mc">æ¢ç´¢æ›´å¤šæœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€è®¡ç®—æœºè§†è§‰ã€NLPã€Flaské¡¹ç›®è®¿é—®æˆ‘çš„åšå®¢â€” </em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="mc">æœºå™¨å­¦ä¹ é¡¹ç›®</em> </strong> </a></p><p id="15a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">å¦‚éœ€è¿›ä¸€æ­¥çš„ä»£ç è§£é‡Šå’Œæºä»£ç ï¼Œè¯·è®¿é—®æ­¤å¤„</strong>â€”<a class="ae jc" href="https://machinelearningprojects.net/fake-news-classifier-using-lstm/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/fake-news-classifier-using-lstm/</a></p><p id="b1b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mc">æ‰€ä»¥è¿™å°±æ˜¯æˆ‘å†™ç»™è¿™ä¸ªåšå®¢çš„æ‰€æœ‰å†…å®¹ï¼Œæ„Ÿè°¢ä½ é˜…è¯»å®ƒï¼Œæˆ‘å¸Œæœ›ä½ åœ¨é˜…è¯»å®Œè¿™ç¯‡æ–‡ç« åä¼šæœ‰æ‰€æ”¶è·ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡ğŸ‘‹â€¦ </em></p><p id="510e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mc">çœ‹æˆ‘ä»¥å‰çš„å¸–å­:</em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/singular-value-decomposition/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="mc">å¥‡å¼‚å€¼åˆ†è§£</em> </strong> </a></p><div class="md me ez fb mf mg"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hi fi z dy ml ea eb mm ed ef hg bi translated">Mlearning.aiæäº¤å»ºè®®</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">å¦‚ä½•æˆä¸ºMlearning.aiä¸Šçš„ä½œå®¶</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">medium.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu li mg"/></div></div></a></div></div></div>    
</body>
</html>