<html>
<head>
<title>Fake News Classifier using LSTM — with source code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用LSTM的假新闻分类器——带源代码</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/fake-news-classifier-using-lstm-with-source-code-fun-project-4f0845e73c6a?source=collection_archive---------6-----------------------#2022-01-11">https://medium.com/mlearning-ai/fake-news-classifier-using-lstm-with-source-code-fun-project-4f0845e73c6a?source=collection_archive---------6-----------------------#2022-01-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2c96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以在这个博客中，我们将使用LSTM实现一个假新闻分类器。所以没有任何进一步的原因。</p><p id="8f3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在这里阅读带源代码的全文—</strong><a class="ae jc" href="https://machinelearningprojects.net/fake-news-classifier-using-lstm/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/fake-news-classifier-using-lstm/</a></p><p id="e69b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">点击此处查看视频—【https://youtu.be/XcHtSSKE6PI T4】</p><h1 id="4261" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">让我们开始吧…</h1><h2 id="6f31" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤1-导入假新闻分类器所需的库。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="3e07" class="kb je hh ku b fi ky kz l la lb">import re<br/>import nltk<br/>import numpy as np<br/>import pandas as pd<br/>import tensorflow as tf<br/>from nltk.corpus import stopwords<br/>from nltk.stem.porter import PorterStemmer<br/>from tensorflow.keras.models import Sequential<br/>from sklearn.model_selection import train_test_split<br/>from tensorflow.keras.preprocessing.text import one_hot<br/>from sklearn.metrics import confusion_matrix,accuracy_score<br/>from tensorflow.keras.preprocessing.sequence import pad_sequences<br/>from tensorflow.keras.layers import Embedding,LSTM,Dense,Dropout<br/><br/>nltk.download('stopwords')</span></pre><h2 id="070a" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤2 —读取输入数据。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="3d72" class="kb je hh ku b fi ky kz l la lb">df = pd.read_csv('train.csv')<br/>df.dropna(inplace=True)<br/>df.reset_index(inplace=True)<br/>df.head(10)</span></pre><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lc"><img src="../Images/a4bbb20083513265173fdc14d5ca6839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*P3Y7L7ALmFr9v4gb.png"/></div></div></figure><h2 id="3a51" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤3-创建X和y数据。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="58a0" class="kb je hh ku b fi ky kz l la lb">X = df['title']<br/>y = df['label']</span></pre><ul class=""><li id="2c10" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">对于X，我们只取标题列。</li><li id="273c" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">对于y，我们只取标签列。</li></ul><h2 id="a0a5" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤4-清理输入数据。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="9465" class="kb je hh ku b fi ky kz l la lb">ps = PorterStemmer()<br/>corpus = []<br/><br/>for i in range(len(X)):<br/>    text = X[i]<br/>    text = re.sub('[^a-zA-Z]',' ',text)<br/>    text = text.lower()<br/>    text = text.split()<br/>    text = [ps.stem(t) for t in text if t not in stopwords.words('english')]<br/>    corpus.append(' '.join(text))</span></pre><ul class=""><li id="2891" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">在这里，我们遍历X，然后简单地使用正则表达式来清理我们的数据，并将其存储在语料库列表中。</li><li id="3dca" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">首先，我们只是把所有不是字母表的东西都换成了空格。</li><li id="bfb7" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">然后我们把它小写并拆分。</li><li id="4559" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">然后我们检查单词是否不在停用词中，然后阻止它。</li><li id="bc93" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">只需将这些结果连接起来，用它们造一个句子，并将其添加到语料库列表中。</li></ul><h2 id="78c8" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤5 —编码输入数据。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="404e" class="kb je hh ku b fi ky kz l la lb">vocab_size = 5000<br/>sent_len = 20<br/><br/>one_hot_encoded = [one_hot(x,vocab_size) for x in corpus]<br/>one_hot_encoded = pad_sequences(one_hot_encoded,maxlen=sent_len)<br/>one_hot_encoded[0]</span></pre><ul class=""><li id="6d79" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">这里我们使用<a class="ae jc" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/text/one_hot" rel="noopener ugc nofollow" target="_blank"> one_hot </a>将文本数据编码成数字数据。</li><li id="3de5" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">记住这个热点不是0和1。在这种一次性编码中，我们使用散列法给单词分配一个随机数。随机字从0-vocab_size的范围中选择。</li><li id="fc09" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">然后我们用0填充序列，使每一行长度相同。</li><li id="a69c" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">然后我们简单地检查这两个操作之后，我们的第一个句子是什么样子的。</li></ul><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ly"><img src="../Images/74857e3d1cc2b7ed9bc17a8fb2b95e27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*E3BPHAX4ZtW7y9BD.png"/></div></div></figure><h2 id="512c" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤6 —处理X和y数据。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="9e47" class="kb je hh ku b fi ky kz l la lb">X = np.array(one_hot_encoded)<br/>y = np.array(y)<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)</span></pre><ul class=""><li id="ed20" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">将X和y转换为NumPy数组，并使用<a class="ae jc" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank"> traintestsplit </a>简单拆分数据。</li></ul><h2 id="5584" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤7 —创建模型。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="840e" class="kb je hh ku b fi ky kz l la lb">no_of_output_features = 40<br/><br/>model = Sequential()<br/><br/>model.add(Embedding(vocab_size,no_of_output_features,input_length=sent_len))<br/>model.add(Dropout(0.5))<br/>model.add(LSTM(100))<br/>model.add(Dropout(0.5))<br/>model.add(Dense(1))<br/><br/>model.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])<br/><br/>model.summary()</span></pre><ul class=""><li id="1c03" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">在这里，我们正在创建我们的模型。</li><li id="306f" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">我们的模型只有4层。</li><li id="716c" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">第一层是嵌入层，它将把我们上面看到的数字数组转换成一个40维的向量，后面是一个<a class="ae jc" href="https://keras.io/api/layers/regularization_layers/dropout/" rel="noopener ugc nofollow" target="_blank"> Dropout </a>层。</li><li id="f8a1" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">然后我们有一个有100个节点的<a class="ae jc" href="https://keras.io/api/layers/recurrent_layers/lstm/" rel="noopener ugc nofollow" target="_blank"> LSTM </a>层，后面是一个丢弃层。</li><li id="6187" class="lk ll hh ig b ih lt il lu ip lv it lw ix lx jb lp lq lr ls bi translated">脱落层用于防止过度贴合。</li></ul><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lz"><img src="../Images/5f8ed029c45458444f8c22bcc8e18591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*bmLb9Et5ROneMWYi.png"/></div></div></figure><h2 id="3fe9" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤8-训练假新闻分类器模型。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="d2a3" class="kb je hh ku b fi ky kz l la lb">model.fit(X_train,y_train,validation_data=(X_test,y_test),batch_size=64,epochs=40)</span></pre><figure class="kp kq kr ks fd ld er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es lc"><img src="../Images/9a1c645ca7e797ab21d9d08191d7a28c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hgIdVA1M1oybT9jf.png"/></div></div></figure><h2 id="3eec" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤9——检查模型的指标。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="a6e2" class="kb je hh ku b fi ky kz l la lb">pred = model.predict_classes(X_test)<br/>confusion_matrix(y_test,pred)</span></pre><ul class=""><li id="533b" class="lk ll hh ig b ih ii il im ip lm it ln ix lo jb lp lq lr ls bi translated">在这一步，我们只是打印<a class="ae jc" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html" rel="noopener ugc nofollow" target="_blank">混淆矩阵</a>来检查我们模型的性能。</li></ul><figure class="kp kq kr ks fd ld er es paragraph-image"><div class="er es ma"><img src="../Images/20874c4ba64f0d476d32084d34598bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/0*pAfZsI88qZZogPee.png"/></div></figure><h2 id="ebe5" class="kb je hh bd jf kc kd ke jj kf kg kh jn ip ki kj jr it kk kl jv ix km kn jz ko bi translated">步骤10-检查假新闻分类器模型的准确性。</h2><pre class="kp kq kr ks fd kt ku kv kw aw kx bi"><span id="8087" class="kb je hh ku b fi ky kz l la lb">accuracy_score(y_test,pred)</span></pre><figure class="kp kq kr ks fd ld er es paragraph-image"><div class="er es mb"><img src="../Images/6854777167ace86cc1e2754ca418606b.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/0*V-Ik1h4u2nobWEIO.png"/></div></figure><p id="06f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果对这个话题有任何疑问，请通过电子邮件或LinkedIn联系我。我已经尽力解释这个代码了。</p><p id="2f2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mc">探索更多机器学习、深度学习、计算机视觉、NLP、Flask项目访问我的博客— </em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="mc">机器学习项目</em> </strong> </a></p><p id="15a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如需进一步的代码解释和源代码，请访问此处</strong>—<a class="ae jc" href="https://machinelearningprojects.net/fake-news-classifier-using-lstm/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/fake-news-classifier-using-lstm/</a></p><p id="b1b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mc">所以这就是我写给这个博客的所有内容，感谢你阅读它，我希望你在阅读完这篇文章后会有所收获，直到下一次👋… </em></p><p id="510e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mc">看我以前的帖子:</em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/singular-value-decomposition/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="mc">奇异值分解</em> </strong> </a></p><div class="md me ez fb mf mg"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hi fi z dy ml ea eb mm ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">medium.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu li mg"/></div></div></a></div></div></div>    
</body>
</html>