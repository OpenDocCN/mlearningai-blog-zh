<html>
<head>
<title>Find the best data preparation method and model using a pipeline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ç®¡é“æ‰¾åˆ°æœ€ä½³çš„æ•°æ®å‡†å¤‡æ–¹æ³•å’Œæ¨¡å‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/find-the-best-data-preparation-method-and-model-using-a-pipeline-9677f68c35e9?source=collection_archive---------2-----------------------#2022-05-25">https://medium.com/mlearning-ai/find-the-best-data-preparation-method-and-model-using-a-pipeline-9677f68c35e9?source=collection_archive---------2-----------------------#2022-05-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/ed2b883b22379e26dace9a154d19e433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SmDKu5ahjD8QQIWZNSQgQg.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Source: <a class="ae it" href="https://unsplash.com/photos/xNdPWGJ6UCQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditShareLink" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/xNdPWGJ6UCQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditShareLink</a></figcaption></figure><p id="c4cb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å†™äº†æœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒç®¡é“çš„ç®€å•å®ç°ï¼Œå®ƒå¯ä»¥ä½¿æ‚¨çš„ä»£ç æ›´åŠ æ•´æ´ã€‚ä½ å¯ä»¥é€šè¿‡ä¸‹é¢çš„é“¾æ¥é˜…è¯»ã€‚</p><div class="js jt ez fb ju jv"><a href="https://yannawut.medium.com/neat-data-preprocessing-with-pipeline-and-columntransformer-2a0468865b6b" rel="noopener follow" target="_blank"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hi fi z dy ka ea eb kb ed ef hg bi translated">ä½¿ç”¨ç®¡é“å’ŒColumnTransformerè¿›è¡Œæ•´æ´çš„æ•°æ®é¢„å¤„ç†</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­è¾“å…¥ä»»ä½•æ•°æ®ï¼Œè¿™äº›æ•°æ®å°†åœ¨è®­ç»ƒæœºå™¨å­¦ä¹ ä¹‹å‰è¿›è¡Œè½¬æ¢â€¦</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">yannawut.medium.com</p></div></div><div class="ke l"><div class="kf l kg kh ki ke kj in jv"/></div></div></a></div><p id="88ae" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç®¡é“ä¸ä»…ä½¿æ‚¨çš„ä»£ç æ›´æ•´æ´ï¼Œå®ƒè¿˜å¯ä»¥å¸®åŠ©è¶…å‚æ•°è°ƒä¼˜å’Œæ•°æ®å‡†å¤‡è¿‡ç¨‹ã€‚</p><h1 id="0c97" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">ğŸ“”æœ¬æ–‡å†…å®¹</h1><ul class=""><li id="d2c0" class="li lj hh iw b ix lk jb ll jf lm jj ln jn lo jr lp lq lr ls bi translated">æ‰¾å‡ºå¯å˜çš„ç®¡çº¿å‚æ•°</li><li id="0f51" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">å¯»æ‰¾æœ€ä½³è¶…å‚æ•°é›†:åœ¨ç½‘æ ¼æœç´¢ä¸­æ·»åŠ ç®¡é“</li><li id="6539" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">æ‰¾åˆ°æœ€ä½³çš„æ•°æ®å‡†å¤‡æ–¹æ³•:è·³è¿‡ç®¡é“ä¸­çš„ä¸€ä¸ªæ­¥éª¤</li><li id="ce0b" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">æ‰¾åˆ°æœ€ä½³è¶…å‚æ•°é›†å’Œæœ€ä½³æ•°æ®å‡†å¤‡æ–¹æ³•</li></ul><h1 id="b9ae" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">ğŸ›£ï¸ç®¡é“</h1><p id="36db" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">å‚è€ƒä¸Šä¸€ç¯‡æ–‡ç« ï¼Œè¿™æ˜¯ç®¡é“ã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="74bf" class="mk kl hh mg b fi ml mm l mn mo"># sets of columns to be transformed in different ways</span><span id="09c8" class="mk kl hh mg b fi mp mm l mn mo">num_cols = ['city_development_index','relevent_experience', 'experience','last_new_job', 'training_hours']<br/>cat_cols = ['gender', 'enrolled_university', 'education_level', 'major_discipline', 'company_size', 'company_type']</span><span id="66be" class="mk kl hh mg b fi mp mm l mn mo"># Create pipelines for numerical and categorical features</span><span id="3c2a" class="mk kl hh mg b fi mp mm l mn mo">from sklearn.impute import SimpleImputer<br/>from sklearn.preprocessing import OneHotEncoder, MinMaxScaler<br/>from sklearn.pipeline import Pipeline</span><span id="a0cd" class="mk kl hh mg b fi mp mm l mn mo">num_pipeline = Pipeline(steps=[<br/>    ('impute', SimpleImputer(strategy='mean')),<br/>    ('scale',MinMaxScaler())<br/>])</span><span id="3723" class="mk kl hh mg b fi mp mm l mn mo">cat_pipeline = Pipeline(steps=[<br/>    ('impute', SimpleImputer(strategy='most_frequent')),<br/>    ('one-hot',OneHotEncoder(handle_unknown='ignore', sparse=False))<br/>])</span><span id="dcac" class="mk kl hh mg b fi mp mm l mn mo"># Create ColumnTransformer to apply pipeline for each column type</span><span id="3945" class="mk kl hh mg b fi mp mm l mn mo">from sklearn.compose import ColumnTransformer</span><span id="5abb" class="mk kl hh mg b fi mp mm l mn mo">col_trans = ColumnTransformer(transformers=[<br/>    ('num_pipeline',num_pipeline,num_cols),<br/>    ('cat_pipeline',cat_pipeline,cat_cols)<br/>    ],<br/>    remainder='drop',<br/>    n_jobs=-1)</span><span id="ac37" class="mk kl hh mg b fi mp mm l mn mo"># Add a model to a final pipeline, clf_pipeline</span><span id="5f6d" class="mk kl hh mg b fi mp mm l mn mo">from sklearn.linear_model import LogisticRegression</span><span id="3c1a" class="mk kl hh mg b fi mp mm l mn mo">clf = LogisticRegression(random_state=0)</span><span id="b1ab" class="mk kl hh mg b fi mp mm l mn mo">clf_pipeline = Pipeline(steps=[<br/>    ('col_trans', col_trans),<br/>    ('model', clf)<br/>])</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es mq"><img src="../Images/5295b0d933747e054f477ae9c7060376.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/0*HXfm8Upd1eFSZaLa.png"/></div></figure><p id="bede" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨æ­¤ç®¡é“ä¸­ï¼Œclf_pipeline(æœ€ç»ˆç®¡é“)åŒ…å«col_trans (ColumnTransformer)å’Œä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹ã€‚</p><p id="1991" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨col_tranä¸­ï¼Œæœ‰num_pipelineå’Œcat_pipelineã€‚è¿™äº›ç®¡é“å°†åˆ†åˆ«è½¬æ¢æ•°å­—ç‰¹å¾å’Œåˆ†ç±»ç‰¹å¾ã€‚</p><h1 id="93ea" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">ğŸ”æ‰¾å‡ºå¯å˜çš„ç®¡çº¿å‚æ•°</h1><p id="69b4" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å¯ä»¥è°ƒæ•´çš„å‚æ•°åˆ—è¡¨ã€‚<br/> <strong class="iw hi">è¯­æ³•:</strong>ç®¡é“_åç§°.è·å–_å‚æ•°()</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="95cf" class="mk kl hh mg b fi ml mm l mn mo">clf_pipeline.get_params()</span></pre><p id="4f03" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç»“æœå¯èƒ½ä¼šå¾ˆé•¿ã€‚æ·±å‘¼å¸ï¼Œç»§ç»­è¯»ä¸‹å»ã€‚</p><p id="20c4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç¬¬ä¸€éƒ¨åˆ†åªæ˜¯å…³äºç®¡é“çš„æ­¥éª¤ã€‚</p><figure class="mb mc md me fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mr"><img src="../Images/2bec521f1707e35d64711cb983ce75ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JWw_1l68o9z_D9ptmvIIMA.png"/></div></div></figure><p id="448a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç¬¬ä¸€éƒ¨åˆ†ä¸‹é¢æ˜¯æˆ‘ä»¬æ„Ÿå…´è¶£çš„ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´çš„å‚æ•°åˆ—è¡¨ã€‚</p><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es ms"><img src="../Images/c08311fa2a2053a5ac91b46f2f8e02a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*NCkmLiyit676K3M-HfEbnw.png"/></div></figure><p id="dffe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ ¼å¼ä¸º<strong class="iw hi"> step1_step2_â€¦_parameter </strong>ã€‚</p><p id="a257" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¾‹å¦‚<strong class="iw hi">col _ trans</strong>_<strong class="iw hi">cat _ pipeline</strong>_<strong class="iw hi">one-hot</strong>_<strong class="iw hi">sparse</strong>è¡¨ç¤ºone-hotæ­¥éª¤çš„å‚æ•°ç¨€ç–ã€‚</p><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es mt"><img src="../Images/6ecd837e212170cb3b00541907e1d245.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*ZITc6M2sB8Qxzr5BCnBMHQ.png"/></div></figure><p id="833b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‚¨å¯ä»¥ä½¿ç”¨set_paramç›´æ¥æ›´æ”¹å‚æ•°ã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="7304" class="mk kl hh mg b fi ml mm l mn mo">clf_pipeline.set_params(model_C = 10)</span></pre><h1 id="e610" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">â•å¯»æ‰¾æœ€ä½³è¶…å‚æ•°é›†:æ·»åŠ ç½‘æ ¼æœç´¢ç®¡é“</h1><p id="2b8b" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">ç½‘æ ¼æœç´¢æ˜¯ä¸€ç§ç”¨äºæ‰§è¡Œè¶…å‚æ•°è°ƒæ•´çš„æ–¹æ³•ï¼Œå¯ä»¥æ‰¾åˆ°äº§ç”Ÿæœ€é«˜æ¨¡å‹ç²¾åº¦çš„æœ€ä½³å‚æ•°é›†ã€‚</p><p id="6eb5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 1ã€‚è®¾ç½®è°ƒè°å‚æ•°åŠå…¶èŒƒå›´ã€‚</strong></p><p id="276a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åˆ›å»ºè°ƒæ•´å‚æ•°(è¶…å‚æ•°)å­—å…¸</p><p id="181e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">{ 'è°ƒæ•´å‚æ•°':'å¯èƒ½å€¼'ï¼Œâ€¦ }</p><p id="14dd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æƒ³æ‰¾åˆ°ä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹çš„æœ€ä½³æƒ©ç½šç±»å‹å’ŒCã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="9b03" class="mk kl hh mg b fi ml mm l mn mo">grid_params = {'model__penalty' : ['none', 'l2'],<br/>               'model__C' : np.logspace(-4, 4, 20)}</span></pre><p id="8bd9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 2ã€‚å°†ç®¡é“æ·»åŠ åˆ°ç½‘æ ¼æœç´¢ä¸­</strong></p><p id="3f40" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">è¯­æ³•:</strong> GridSearchCV(æ¨¡å‹ï¼Œè°ƒä¼˜å‚æ•°ï¼Œâ€¦)</p><p id="9845" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬çš„ç®¡é“æœ‰ä¸€ä¸ªæ¨¡å‹æ­¥éª¤ä½œä¸ºæœ€åä¸€æ­¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†ç®¡é“ç›´æ¥è¾“å…¥åˆ°GridSearchCVå‡½æ•°ä¸­ã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="d12f" class="mk kl hh mg b fi ml mm l mn mo">from sklearn.model_selection import GridSearchCV</span><span id="df72" class="mk kl hh mg b fi mp mm l mn mo">gs = GridSearchCV(clf_pipeline, grid_params, cv=5, scoring='accuracy')<br/>gs.fit(X_train, y_train)</span><span id="0b07" class="mk kl hh mg b fi mp mm l mn mo">print("Best Score of train set: "+str(gs.best_score_))<br/>print("Best parameter set: "+str(gs.best_params_))<br/>print("Test Score: "+str(gs.score(X_test,y_test)))</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es mu"><img src="../Images/075d061e60364397be39e26bc945040e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*JP64DvryL62BV2Z8ctyVXw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Result of Grid Search</figcaption></figure><p id="4273" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®¾ç½®ç½‘æ ¼æœç´¢åï¼Œæ‚¨å¯ä»¥ç”¨æ•°æ®æ‹Ÿåˆç½‘æ ¼æœç´¢å¹¶æŸ¥çœ‹ç»“æœã€‚</p><ul class=""><li id="8822" class="li lj hh iw b ix iy jb jc jf mv jj mw jn mx jr lp lq lr ls bi translated">ã€‚æ‹Ÿåˆ:æ‹Ÿåˆæ¨¡å‹å¹¶å°è¯•è°ƒæ•´å‚æ•°å­—å…¸ä¸­çš„æ‰€æœ‰å‚æ•°é›†</li><li id="d2f7" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">ã€‚best_score_:æ‰€æœ‰å‚æ•°é›†çš„æœ€é«˜ç²¾ç¡®åº¦</li><li id="8898" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">ã€‚best_params_:äº§ç”Ÿæœ€ä½³åˆ†æ•°çš„ä¸€ç»„å‚æ•°</li><li id="e106" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">ã€‚score(X_testï¼Œy_test):ç”¨æµ‹è¯•é›†å°è¯•æœ€ä½³æ¨¡å‹æ—¶çš„åˆ†æ•°ã€‚</li></ul><p id="0274" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½ å¯ä»¥åœ¨æ–‡æ¡£<a class="ae it" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="noopener ugc nofollow" target="_blank">ä¸­é˜…è¯»æ›´å¤šå…³äºGridSearchCVçš„å†…å®¹ã€‚</a></p><h1 id="508f" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">â©æ‰¾åˆ°æœ€ä½³çš„æ•°æ®å‡†å¤‡æ–¹æ³•:è·³è¿‡ç®¡é“ä¸­çš„ä¸€ä¸ªæ­¥éª¤</h1><p id="bf9b" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">å¦‚æœæ²¡æœ‰ç®¡é“ï¼Œæ‰¾åˆ°æœ€ä½³çš„æ•°æ®å‡†å¤‡æ–¹æ³•å¯èƒ½ä¼šå¾ˆå›°éš¾ï¼Œå› ä¸ºæ‚¨å¿…é¡»ä¸ºè®¸å¤šæ•°æ®è½¬æ¢æ¡ˆä¾‹åˆ›å»ºå¦‚æ­¤å¤šçš„å˜é‡ã€‚</p><p id="6e3e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é€šè¿‡ç®¡é“ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç®¡é“ä¸­åˆ›å»ºæ•°æ®è½¬æ¢æ­¥éª¤ï¼Œå¹¶æ‰§è¡Œç½‘æ ¼æœç´¢æ¥æ‰¾åˆ°æœ€ä½³æ­¥éª¤ã€‚ç½‘æ ¼æœç´¢å°†é€‰æ‹©è·³è¿‡å“ªä¸ªæ­¥éª¤ï¼Œå¹¶æ¯”è¾ƒæ¯ä¸ªæ¡ˆä¾‹çš„ç»“æœã€‚</p><p id="ea82" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">ç¨å¾®è°ƒæ•´ä¸€ä¸‹å½“å‰ç®¡çº¿</strong></p><p id="f576" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘æƒ³çŸ¥é“åœ¨MinMaxScalerå’ŒStandardScalerä¹‹é—´ï¼Œå“ªç§ç¼©æ”¾æ–¹æ³•æœ€é€‚åˆæˆ‘çš„æ•°æ®ã€‚</p><p id="3811" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘åœ¨num_pipelineä¸­æ·»åŠ äº†ä¸€ä¸ªstep StandardScalerã€‚å…¶ä½™æ²¡æœ‰å˜åŒ–ã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="31bc" class="mk kl hh mg b fi ml mm l mn mo">from sklearn.preprocessing import StandardScaler</span><span id="a5f8" class="mk kl hh mg b fi mp mm l mn mo">num_pipeline2 = Pipeline(steps=[<br/>    ('impute', SimpleImputer(strategy='mean')),<br/>    ('minmax_scale', MinMaxScaler()),<br/>    ('std_scale', StandardScaler()),<br/>])</span><span id="5d8d" class="mk kl hh mg b fi mp mm l mn mo">col_trans2 = ColumnTransformer(transformers=[<br/>    ('num_pipeline',num_pipeline2,num_cols),<br/>    ('cat_pipeline',cat_pipeline,cat_cols)<br/>    ],<br/>    remainder='drop',<br/>    n_jobs=-1)</span><span id="538f" class="mk kl hh mg b fi mp mm l mn mo">clf_pipeline2 = Pipeline(steps=[<br/>    ('col_trans', col_trans2),<br/>    ('model', clf)<br/>])</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es my"><img src="../Images/06a58e770090800a5b6de5bc70c5ec28.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*K1pdg8EFtGLIhNSEUQ0DsA.png"/></div></figure><p id="a3b1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">ç½‘æ ¼æœç´¢</strong></p><p id="98ca" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨ç½‘æ ¼æœç´¢å‚æ•°ä¸­ï¼ŒæŒ‡å®šè¦è·³è¿‡çš„æ­¥éª¤ï¼Œå¹¶å°†å®ƒä»¬çš„å€¼è®¾ç½®ä¸º<strong class="iw hi">é€šè¿‡</strong>ã€‚</p><p id="a210" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç”±äºMinMaxScalerå’ŒStandardScalerä¸åº”è¯¥åŒæ—¶æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘å°†ä½¿ç”¨<strong class="iw hi">å­—å…¸åˆ—è¡¨</strong>ä½œä¸ºç½‘æ ¼æœç´¢å‚æ•°ã€‚</p><p id="e3be" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[{æ¡ˆä¾‹1}ï¼Œ{æ¡ˆä¾‹2}]</p><p id="9866" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¦‚æœä½¿ç”¨å­—å…¸åˆ—è¡¨ï¼Œç½‘æ ¼æœç´¢å°†æ‰§è¡Œæƒ…å†µ1ä¸­æ¯ä¸ªå‚æ•°çš„ç»„åˆï¼Œç›´åˆ°å®Œæˆã€‚ç„¶åï¼Œå®ƒå°†æ‰§è¡Œæƒ…å†µ2ä¸­æ¯ä¸ªå‚æ•°çš„ç»„åˆã€‚æ‰€ä»¥ä¸å­˜åœ¨MinMaxScalerå’ŒStandardScalerä¸€èµ·ä½¿ç”¨çš„æƒ…å†µã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="7d57" class="mk kl hh mg b fi ml mm l mn mo">grid_step_params = [{'col_trans__num_pipeline__minmax_scale': ['passthrough']},<br/>                    {'col_trans__num_pipeline__std_scale': ['passthrough']}]</span></pre><p id="0a1a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‰§è¡Œç½‘æ ¼æœç´¢å¹¶æ‰“å°ç»“æœ(åƒæ™®é€šç½‘æ ¼æœç´¢ä¸€æ ·)ã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="9c94" class="mk kl hh mg b fi ml mm l mn mo">gs2 = GridSearchCV(clf_pipeline2, grid_step_params, scoring='accuracy')<br/>gs2.fit(X_train, y_train)</span><span id="8a5f" class="mk kl hh mg b fi mp mm l mn mo">print("Best Score of train set: "+str(gs2.best_score_))<br/>print("Best parameter set: "+str(gs2.best_params_))<br/>print("Test Score: "+str(gs2.score(X_test,y_test)))</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/d016fbf7c7344087c209418aa7adb7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*u-TK9RhHn0eSIRbtEUdWsQ.png"/></div></figure><p id="a490" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æœ€å¥½çš„æƒ…å†µæ˜¯minmax_scale : 'passthrough 'ï¼Œå› æ­¤StandardScaleræ˜¯æ­¤æ•°æ®çš„æœ€ä½³ç¼©æ”¾æ–¹æ³•ã€‚</p><h1 id="fcf7" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">ğŸ’¥æ‰¾åˆ°æœ€ä½³è¶…å‚æ•°é›†å’Œæœ€ä½³æ•°æ®å‡†å¤‡æ–¹æ³•</h1><p id="5068" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">é€šè¿‡å°†è°ƒæ•´å‚æ•°æ·»åŠ åˆ°æ•°æ®å‡†å¤‡æ–¹æ³•çš„æ¯ç§æƒ…å†µçš„å­—å…¸ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°æœ€ä½³çš„è¶…å‚æ•°é›†å’Œæœ€ä½³çš„æ•°æ®å‡†å¤‡æ–¹æ³•ã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="bdc7" class="mk kl hh mg b fi ml mm l mn mo">grid_params = {'model__penalty' : ['none', 'l2'],<br/>               'model__C' : np.logspace(-4, 4, 20)}</span><span id="93f2" class="mk kl hh mg b fi mp mm l mn mo">grid_step_params = [{**{'col_trans__num_pipeline__minmax_scale': ['passthrough']}, **grid_params},<br/>                    {**{'col_trans__num_pipeline__std_scale': ['passthrough']}, **grid_params}]</span></pre><p id="b79f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">grid_paramså°†è¢«æ·»åŠ åˆ°æƒ…å†µ1(è·³è¿‡MinMaxScaler)å’Œæƒ…å†µ2(è·³è¿‡StandardScalerand)ä¸­ã€‚</p><p id="e2c8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•åˆå¹¶å­—å…¸ã€‚<br/> merge_dict = {**dict_1ï¼Œ**dict_2}</p><p id="5918" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‰§è¡Œç½‘æ ¼æœç´¢å¹¶æ‰“å°ç»“æœ(åƒæ™®é€šç½‘æ ¼æœç´¢ä¸€æ ·)ã€‚</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="d54f" class="mk kl hh mg b fi ml mm l mn mo">gs3 = GridSearchCV(clf_pipeline2, grid_step_params2, scoring='accuracy')<br/>gs3.fit(X_train, y_train)</span><span id="a036" class="mk kl hh mg b fi mp mm l mn mo">print("Best Score of train set: "+str(gs3.best_score_))<br/>print("Best parameter set: "+str(gs3.best_params_))<br/>print("Test Score: "+str(gs3.score(X_test,y_test)))</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es na"><img src="../Images/cbf1d343b0320d28e6d602617888f32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fLcVD6j9m2QcdkkYpoJOjA.png"/></div></div></figure><p id="7722" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‚¨å¯ä»¥ä½¿ç”¨æ‰¾åˆ°æœ€ä½³å‚æ•°é›†ã€‚best_params_ã€‚ç”±äºminmax_scale : 'passthrough 'ï¼Œæ‰€ä»¥StandardScaleræ˜¯æ­¤æ•°æ®çš„æœ€ä½³ç¼©æ”¾æ–¹æ³•ã€‚</p><p id="f689" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‰€æœ‰ç½‘æ ¼æœç´¢æ¡ˆä¾‹éƒ½å¯ä»¥ä½¿ç”¨ã€‚cv _ç»“æœ_</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="0f83" class="mk kl hh mg b fi ml mm l mn mo">pd.DataFrame(gs3.cv_results_)</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nb"><img src="../Images/0a5a9fa050c7c3f7fa84ea31f21cf997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ddwx3CZ1k3kfEXYG2pGkMw.png"/></div></div></figure><p id="1b5c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¿™ä¸ªä¾‹å­æœ‰80ä¸ªæ¡ˆä¾‹ã€‚ä½ éœ€è¦è€ƒè™‘æ¯ç§æƒ…å†µçš„è¿è¡Œæ—¶é—´å’Œç²¾ç¡®åº¦ï¼Œå› ä¸ºæœ‰æ—¶æˆ‘ä»¬å¯èƒ½ä¼šé€‰æ‹©ç²¾ç¡®åº¦å¯æ¥å—çš„æœ€å¿«æ¨¡å‹ï¼Œè€Œä¸æ˜¯ç²¾ç¡®åº¦æœ€é«˜çš„æ¨¡å‹ã€‚</p><h1 id="3cb6" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">ç»“è®º</h1><p id="90d9" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">æµæ°´çº¿å¯ä»¥ç®€åŒ–è¶…å‚æ•°è°ƒæ•´å’Œæ•°æ®å‡†å¤‡è¿‡ç¨‹ã€‚é€šè¿‡ä½¿ç”¨å¸¦æœ‰ç½‘æ ¼æœç´¢çš„ç®¡é“ï¼Œæ‚¨å¯ä»¥å®šä¹‰ç½‘æ ¼æœç´¢å‚æ•°æ¥æ¢ç´¢æ‰€æœ‰å¯ç”¨çš„æ¡ˆä¾‹å¹¶æ‰¾åˆ°æœ€ä½³æ¡ˆä¾‹ã€‚</p><h1 id="1fd8" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ</h1><p id="bc51" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">å¯»æ‰¾æœ€ä½³çš„æœºå™¨å­¦ä¹ æ¨¡å‹éœ€è¦ä¸€ä¸ªè‡ªå®šä¹‰çš„è½¬æ¢å‡½æ•°ï¼Œæˆ‘å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å†™ã€‚å†è§ã€‚</p><div class="js jt ez fb ju jv"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hi fi z dy ka ea eb kb ed ef hg bi translated">Mlearning.aiæäº¤å»ºè®®</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">å¦‚ä½•æˆä¸ºMlearning.aiä¸Šçš„ä½œå®¶</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">medium.com</p></div></div><div class="ke l"><div class="nc l kg kh ki ke kj in jv"/></div></div></a></div></div></div>    
</body>
</html>