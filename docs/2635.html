<html>
<head>
<title>Find the best data preparation method and model using a pipeline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用管道找到最佳的数据准备方法和模型</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/find-the-best-data-preparation-method-and-model-using-a-pipeline-9677f68c35e9?source=collection_archive---------2-----------------------#2022-05-25">https://medium.com/mlearning-ai/find-the-best-data-preparation-method-and-model-using-a-pipeline-9677f68c35e9?source=collection_archive---------2-----------------------#2022-05-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/ed2b883b22379e26dace9a154d19e433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SmDKu5ahjD8QQIWZNSQgQg.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Source: <a class="ae it" href="https://unsplash.com/photos/xNdPWGJ6UCQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditShareLink" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/xNdPWGJ6UCQ?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditShareLink</a></figcaption></figure><p id="c4cb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在上一篇文章中，我写了机器学习模型训练管道的简单实现，它可以使您的代码更加整洁。你可以通过下面的链接阅读。</p><div class="js jt ez fb ju jv"><a href="https://yannawut.medium.com/neat-data-preprocessing-with-pipeline-and-columntransformer-2a0468865b6b" rel="noopener follow" target="_blank"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hi fi z dy ka ea eb kb ed ef hg bi translated">使用管道和ColumnTransformer进行整洁的数据预处理</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">创建一个管道，您可以在其中输入任何数据，这些数据将在训练机器学习之前进行转换…</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">yannawut.medium.com</p></div></div><div class="ke l"><div class="kf l kg kh ki ke kj in jv"/></div></div></a></div><p id="88ae" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">管道不仅使您的代码更整洁，它还可以帮助超参数调优和数据准备过程。</p><h1 id="0c97" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">📔本文内容</h1><ul class=""><li id="d2c0" class="li lj hh iw b ix lk jb ll jf lm jj ln jn lo jr lp lq lr ls bi translated">找出可变的管线参数</li><li id="0f51" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">寻找最佳超参数集:在网格搜索中添加管道</li><li id="6539" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">找到最佳的数据准备方法:跳过管道中的一个步骤</li><li id="ce0b" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">找到最佳超参数集和最佳数据准备方法</li></ul><h1 id="b9ae" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">🛣️管道</h1><p id="36db" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">参考上一篇文章，这是管道。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="74bf" class="mk kl hh mg b fi ml mm l mn mo"># sets of columns to be transformed in different ways</span><span id="09c8" class="mk kl hh mg b fi mp mm l mn mo">num_cols = ['city_development_index','relevent_experience', 'experience','last_new_job', 'training_hours']<br/>cat_cols = ['gender', 'enrolled_university', 'education_level', 'major_discipline', 'company_size', 'company_type']</span><span id="66be" class="mk kl hh mg b fi mp mm l mn mo"># Create pipelines for numerical and categorical features</span><span id="3c2a" class="mk kl hh mg b fi mp mm l mn mo">from sklearn.impute import SimpleImputer<br/>from sklearn.preprocessing import OneHotEncoder, MinMaxScaler<br/>from sklearn.pipeline import Pipeline</span><span id="a0cd" class="mk kl hh mg b fi mp mm l mn mo">num_pipeline = Pipeline(steps=[<br/>    ('impute', SimpleImputer(strategy='mean')),<br/>    ('scale',MinMaxScaler())<br/>])</span><span id="3723" class="mk kl hh mg b fi mp mm l mn mo">cat_pipeline = Pipeline(steps=[<br/>    ('impute', SimpleImputer(strategy='most_frequent')),<br/>    ('one-hot',OneHotEncoder(handle_unknown='ignore', sparse=False))<br/>])</span><span id="dcac" class="mk kl hh mg b fi mp mm l mn mo"># Create ColumnTransformer to apply pipeline for each column type</span><span id="3945" class="mk kl hh mg b fi mp mm l mn mo">from sklearn.compose import ColumnTransformer</span><span id="5abb" class="mk kl hh mg b fi mp mm l mn mo">col_trans = ColumnTransformer(transformers=[<br/>    ('num_pipeline',num_pipeline,num_cols),<br/>    ('cat_pipeline',cat_pipeline,cat_cols)<br/>    ],<br/>    remainder='drop',<br/>    n_jobs=-1)</span><span id="ac37" class="mk kl hh mg b fi mp mm l mn mo"># Add a model to a final pipeline, clf_pipeline</span><span id="5f6d" class="mk kl hh mg b fi mp mm l mn mo">from sklearn.linear_model import LogisticRegression</span><span id="3c1a" class="mk kl hh mg b fi mp mm l mn mo">clf = LogisticRegression(random_state=0)</span><span id="b1ab" class="mk kl hh mg b fi mp mm l mn mo">clf_pipeline = Pipeline(steps=[<br/>    ('col_trans', col_trans),<br/>    ('model', clf)<br/>])</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es mq"><img src="../Images/5295b0d933747e054f477ae9c7060376.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/0*HXfm8Upd1eFSZaLa.png"/></div></figure><p id="bede" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在此管道中，clf_pipeline(最终管道)包含col_trans (ColumnTransformer)和一个逻辑回归模型。</p><p id="1991" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在col_tran中，有num_pipeline和cat_pipeline。这些管道将分别转换数字特征和分类特征。</p><h1 id="93ea" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">🔍找出可变的管线参数</h1><p id="69b4" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">首先，我们来看看可以调整的参数列表。<br/> <strong class="iw hi">语法:</strong>管道_名称.获取_参数()</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="95cf" class="mk kl hh mg b fi ml mm l mn mo">clf_pipeline.get_params()</span></pre><p id="4f03" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">结果可能会很长。深呼吸，继续读下去。</p><p id="20c4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第一部分只是关于管道的步骤。</p><figure class="mb mc md me fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mr"><img src="../Images/2bec521f1707e35d64711cb983ce75ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JWw_1l68o9z_D9ptmvIIMA.png"/></div></div></figure><p id="448a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第一部分下面是我们感兴趣的，我们可以调整的参数列表。</p><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es ms"><img src="../Images/c08311fa2a2053a5ac91b46f2f8e02a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*NCkmLiyit676K3M-HfEbnw.png"/></div></figure><p id="dffe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">格式为<strong class="iw hi"> step1_step2_…_parameter </strong>。</p><p id="a257" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">例如<strong class="iw hi">col _ trans</strong>_<strong class="iw hi">cat _ pipeline</strong>_<strong class="iw hi">one-hot</strong>_<strong class="iw hi">sparse</strong>表示one-hot步骤的参数稀疏。</p><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es mt"><img src="../Images/6ecd837e212170cb3b00541907e1d245.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*ZITc6M2sB8Qxzr5BCnBMHQ.png"/></div></figure><p id="833b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您可以使用set_param直接更改参数。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="7304" class="mk kl hh mg b fi ml mm l mn mo">clf_pipeline.set_params(model_C = 10)</span></pre><h1 id="e610" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">➕寻找最佳超参数集:添加网格搜索管道</h1><p id="2b8b" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">网格搜索是一种用于执行超参数调整的方法，可以找到产生最高模型精度的最佳参数集。</p><p id="6eb5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 1。设置调谐参数及其范围。</strong></p><p id="276a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">创建调整参数(超参数)字典</p><p id="181e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">{ '调整参数':'可能值'，… }</p><p id="14dd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这个例子中，我想找到一个逻辑回归模型的最佳惩罚类型和C。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="9b03" class="mk kl hh mg b fi ml mm l mn mo">grid_params = {'model__penalty' : ['none', 'l2'],<br/>               'model__C' : np.logspace(-4, 4, 20)}</span></pre><p id="8bd9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 2。将管道添加到网格搜索中</strong></p><p id="3f40" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">语法:</strong> GridSearchCV(模型，调优参数，…)</p><p id="9845" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的管道有一个模型步骤作为最后一步，所以我们可以将管道直接输入到GridSearchCV函数中。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="d12f" class="mk kl hh mg b fi ml mm l mn mo">from sklearn.model_selection import GridSearchCV</span><span id="df72" class="mk kl hh mg b fi mp mm l mn mo">gs = GridSearchCV(clf_pipeline, grid_params, cv=5, scoring='accuracy')<br/>gs.fit(X_train, y_train)</span><span id="0b07" class="mk kl hh mg b fi mp mm l mn mo">print("Best Score of train set: "+str(gs.best_score_))<br/>print("Best parameter set: "+str(gs.best_params_))<br/>print("Test Score: "+str(gs.score(X_test,y_test)))</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es mu"><img src="../Images/075d061e60364397be39e26bc945040e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*JP64DvryL62BV2Z8ctyVXw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Result of Grid Search</figcaption></figure><p id="4273" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">设置网格搜索后，您可以用数据拟合网格搜索并查看结果。</p><ul class=""><li id="8822" class="li lj hh iw b ix iy jb jc jf mv jj mw jn mx jr lp lq lr ls bi translated">。拟合:拟合模型并尝试调整参数字典中的所有参数集</li><li id="d2f7" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">。best_score_:所有参数集的最高精确度</li><li id="8898" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">。best_params_:产生最佳分数的一组参数</li><li id="e106" class="li lj hh iw b ix lt jb lu jf lv jj lw jn lx jr lp lq lr ls bi translated">。score(X_test，y_test):用测试集尝试最佳模型时的分数。</li></ul><p id="0274" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你可以在文档<a class="ae it" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="noopener ugc nofollow" target="_blank">中阅读更多关于GridSearchCV的内容。</a></p><h1 id="508f" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">⏩找到最佳的数据准备方法:跳过管道中的一个步骤</h1><p id="bf9b" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">如果没有管道，找到最佳的数据准备方法可能会很困难，因为您必须为许多数据转换案例创建如此多的变量。</p><p id="6e3e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通过管道，我们可以在管道中创建数据转换步骤，并执行网格搜索来找到最佳步骤。网格搜索将选择跳过哪个步骤，并比较每个案例的结果。</p><p id="ea82" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">稍微调整一下当前管线</strong></p><p id="f576" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我想知道在MinMaxScaler和StandardScaler之间，哪种缩放方法最适合我的数据。</p><p id="3811" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我在num_pipeline中添加了一个step StandardScaler。其余没有变化。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="31bc" class="mk kl hh mg b fi ml mm l mn mo">from sklearn.preprocessing import StandardScaler</span><span id="a5f8" class="mk kl hh mg b fi mp mm l mn mo">num_pipeline2 = Pipeline(steps=[<br/>    ('impute', SimpleImputer(strategy='mean')),<br/>    ('minmax_scale', MinMaxScaler()),<br/>    ('std_scale', StandardScaler()),<br/>])</span><span id="5d8d" class="mk kl hh mg b fi mp mm l mn mo">col_trans2 = ColumnTransformer(transformers=[<br/>    ('num_pipeline',num_pipeline2,num_cols),<br/>    ('cat_pipeline',cat_pipeline,cat_cols)<br/>    ],<br/>    remainder='drop',<br/>    n_jobs=-1)</span><span id="538f" class="mk kl hh mg b fi mp mm l mn mo">clf_pipeline2 = Pipeline(steps=[<br/>    ('col_trans', col_trans2),<br/>    ('model', clf)<br/>])</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es my"><img src="../Images/06a58e770090800a5b6de5bc70c5ec28.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*K1pdg8EFtGLIhNSEUQ0DsA.png"/></div></figure><p id="a3b1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">网格搜索</strong></p><p id="98ca" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在网格搜索参数中，指定要跳过的步骤，并将它们的值设置为<strong class="iw hi">通过</strong>。</p><p id="a210" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于MinMaxScaler和StandardScaler不应该同时执行，所以我将使用<strong class="iw hi">字典列表</strong>作为网格搜索参数。</p><p id="e3be" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[{案例1}，{案例2}]</p><p id="9866" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果使用字典列表，网格搜索将执行情况1中每个参数的组合，直到完成。然后，它将执行情况2中每个参数的组合。所以不存在MinMaxScaler和StandardScaler一起使用的情况。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="7d57" class="mk kl hh mg b fi ml mm l mn mo">grid_step_params = [{'col_trans__num_pipeline__minmax_scale': ['passthrough']},<br/>                    {'col_trans__num_pipeline__std_scale': ['passthrough']}]</span></pre><p id="0a1a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">执行网格搜索并打印结果(像普通网格搜索一样)。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="9c94" class="mk kl hh mg b fi ml mm l mn mo">gs2 = GridSearchCV(clf_pipeline2, grid_step_params, scoring='accuracy')<br/>gs2.fit(X_train, y_train)</span><span id="8a5f" class="mk kl hh mg b fi mp mm l mn mo">print("Best Score of train set: "+str(gs2.best_score_))<br/>print("Best parameter set: "+str(gs2.best_params_))<br/>print("Test Score: "+str(gs2.score(X_test,y_test)))</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/d016fbf7c7344087c209418aa7adb7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*u-TK9RhHn0eSIRbtEUdWsQ.png"/></div></figure><p id="a490" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最好的情况是minmax_scale : 'passthrough '，因此StandardScaler是此数据的最佳缩放方法。</p><h1 id="fcf7" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">💥找到最佳超参数集和最佳数据准备方法</h1><p id="5068" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">通过将调整参数添加到数据准备方法的每种情况的字典中，可以找到最佳的超参数集和最佳的数据准备方法。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="bdc7" class="mk kl hh mg b fi ml mm l mn mo">grid_params = {'model__penalty' : ['none', 'l2'],<br/>               'model__C' : np.logspace(-4, 4, 20)}</span><span id="93f2" class="mk kl hh mg b fi mp mm l mn mo">grid_step_params = [{**{'col_trans__num_pipeline__minmax_scale': ['passthrough']}, **grid_params},<br/>                    {**{'col_trans__num_pipeline__std_scale': ['passthrough']}, **grid_params}]</span></pre><p id="b79f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">grid_params将被添加到情况1(跳过MinMaxScaler)和情况2(跳过StandardScalerand)中。</p><p id="e2c8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您可以使用下面的语法合并字典。<br/> merge_dict = {**dict_1，**dict_2}</p><p id="5918" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">执行网格搜索并打印结果(像普通网格搜索一样)。</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="d54f" class="mk kl hh mg b fi ml mm l mn mo">gs3 = GridSearchCV(clf_pipeline2, grid_step_params2, scoring='accuracy')<br/>gs3.fit(X_train, y_train)</span><span id="a036" class="mk kl hh mg b fi mp mm l mn mo">print("Best Score of train set: "+str(gs3.best_score_))<br/>print("Best parameter set: "+str(gs3.best_params_))<br/>print("Test Score: "+str(gs3.score(X_test,y_test)))</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es na"><img src="../Images/cbf1d343b0320d28e6d602617888f32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fLcVD6j9m2QcdkkYpoJOjA.png"/></div></div></figure><p id="7722" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您可以使用找到最佳参数集。best_params_。由于minmax_scale : 'passthrough '，所以StandardScaler是此数据的最佳缩放方法。</p><p id="f689" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所有网格搜索案例都可以使用。cv _结果_</p><pre class="mb mc md me fd mf mg mh mi aw mj bi"><span id="0f83" class="mk kl hh mg b fi ml mm l mn mo">pd.DataFrame(gs3.cv_results_)</span></pre><figure class="mb mc md me fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nb"><img src="../Images/0a5a9fa050c7c3f7fa84ea31f21cf997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ddwx3CZ1k3kfEXYG2pGkMw.png"/></div></div></figure><p id="1b5c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个例子有80个案例。你需要考虑每种情况的运行时间和精确度，因为有时我们可能会选择精确度可接受的最快模型，而不是精确度最高的模型。</p><h1 id="3cb6" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">结论</h1><p id="90d9" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">流水线可以简化超参数调整和数据准备过程。通过使用带有网格搜索的管道，您可以定义网格搜索参数来探索所有可用的案例并找到最佳案例。</p><h1 id="1fd8" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">下一步是什么？</h1><p id="bc51" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf ly jh ji jj lz jl jm jn ma jp jq jr ha bi translated">寻找最佳的机器学习模型需要一个自定义的转换函数，我将在下一篇文章中写。再见。</p><div class="js jt ez fb ju jv"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hi fi z dy ka ea eb kb ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">medium.com</p></div></div><div class="ke l"><div class="nc l kg kh ki ke kj in jv"/></div></div></a></div></div></div>    
</body>
</html>