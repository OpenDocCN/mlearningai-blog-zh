<html>
<head>
<title>Python in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python在Power BI中的应用</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/python-in-power-bi-66a80590ecc0?source=collection_archive---------0-----------------------#2022-06-16">https://medium.com/mlearning-ai/python-in-power-bi-66a80590ecc0?source=collection_archive---------0-----------------------#2022-06-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/85a179f4cbe124c473e29b44bd1ec04e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*WKuKH8zQwHJlCc_qVMKkbw.png"/></div></figure><h1 id="dbad" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">❓为什么用巨蟒发电匕？</h1><p id="5036" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi kh translated"><span class="l ki kj kk bm kl km kn ko kp di"> M </span>微软动力BI支持两种不同的语言，M语言和DAX(数据分析表达式)。</p><p id="9c8d" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">然而，有时使用Python进行数据准备更方便，因为Python有Python库，这是一组有用的函数，无需从头开始编写代码。此外，熟悉Python的数据分析师可以很容易地将Python应用到Power BI中，用于web抓取或EDA(探索性数据分析)过程。</p><h1 id="2993" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">本文内容</h1><ul class=""><li id="0308" class="kv kw hh jl b jm jn jq jr ju kx jy ky kc kz kg la lb lc ld bi translated">安装Python</li><li id="a363" class="kv kw hh jl b jm le jq lf ju lg jy lh kc li kg la lb lc ld bi translated">Power BI中的Python设置</li><li id="6393" class="kv kw hh jl b jm le jq lf ju lg jy lh kc li kg la lb lc ld bi translated">使用Python获取数据</li><li id="a7c2" class="kv kw hh jl b jm le jq lf ju lg jy lh kc li kg la lb lc ld bi translated">在转换中使用Python</li><li id="272f" class="kv kw hh jl b jm le jq lf ju lg jy lh kc li kg la lb lc ld bi translated">使用Python可视化</li></ul><h1 id="ba62" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">📥安装Python</h1><p id="e0bf" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">在Power BI中使用Python之前，必须先安装Python。我推荐安装Anaconda，因为它易于管理Python库和环境。</p><ol class=""><li id="bb30" class="kv kw hh jl b jm kq jq kr ju lj jy lk kc ll kg lm lb lc ld bi translated">安装Anaconda</li></ol><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es ln"><img src="../Images/979a0e6d3209e6061266260f9d7fac23.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/0*RtgaJAvEKcJc6mLi.png"/></div></figure><p id="9892" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">去https://www.anaconda.com/products/distribution的<a class="ae ls" href="https://www.anaconda.com/products/distribution" rel="noopener ugc nofollow" target="_blank"/>。在你的电脑上下载并安装Anaconda。</p><p id="42c2" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">2.打开Anaconda提示符</p><p id="4ef8" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">搜索Anaconda提示符，点击打开。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/19cb4d6ade8112009a93b25fdec9e47d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*1s9Qobi-Nwj5FHxDwbSV7A.png"/></div></figure><p id="c728" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">你会看到一个黑屏弹出。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lu"><img src="../Images/76f21ac9d3e70753f63509ede8fa47da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9di4tqkz_q4-o0TSuZspCQ.png"/></div></div></figure><p id="f3a0" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">3.创建Python 3.6环境</p><p id="0f68" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">Power BI在使用高版本Python时可能会有问题(在我撰写本文时，最新的Python版本是3.9)。为了避免技术问题，我创建了一个新的Python 3.6环境，我尝试了一下，没有遇到任何问题。</p><p id="2680" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">您可以直接降级您的Python版本，但不建议这样做，因为它可能会影响其他项目。您可以将Anaconda环境想象成一个包含特定Python包集合的工作箱。在这种环境下工作，不会影响其他项目。</p><p id="fecf" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">在Anaconda提示符下，通过键入… <br/>创建一个新环境(将<strong class="jl hi"> &lt; env_name &gt; </strong>替换为您的环境名称，比如python36)</p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="9332" class="me im hh ma b fi mf mg l mh mi">conda create --name &lt;env_name&gt; python=3.6</span></pre><p id="fc2e" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">然后，当您看到Proceed ([y]/n)？，键入y并回车。</p><p id="bd5d" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">等待运行完成。</p><p id="78f3" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">键入以下命令，检查是否成功创建了新环境</p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="ef52" class="me im hh ma b fi mf mg l mh mi">conda env list</span></pre><p id="f3ed" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">您将看到Anaconda环境的列表。如果你看到一个新的环境，你就可以进入下一步了。</p><p id="b06f" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">4.安装有用的Python库</p><p id="7c1b" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">在安装Python包之前，通过在Anaconda提示符下键入以下命令，确保您处于刚刚创建的环境中。</p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="07eb" class="me im hh ma b fi mf mg l mh mi">conda activate &lt;env_name&gt;</span></pre><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es mj"><img src="../Images/6d0a6c3b89aa4c4c69a3ec53366c7b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*FTNCzoWgzrBH16KPDGgZvw.png"/></div></figure><p id="c735" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">然后，您将在括号中观察到环境名称的变化。</p><p id="e2d4" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">您可以通过键入以下命令来安装将要在Power BI中使用的Python库/包。<br/>(将<strong class="jl hi"> &lt; package_name &gt; </strong>替换为您要安装的包的名称，如pandas、numpy、matplotlib)</p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="2f9c" class="me im hh ma b fi mf mg l mh mi">pip install &lt;package_name&gt;</span></pre><h1 id="eb68" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">Power BI中的⚙️ Python设置</h1><p id="7bb8" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">Python安装完成后，就是Power BI的时候了！！</p><ol class=""><li id="ef1b" class="kv kw hh jl b jm kq jq kr ju lj jy lk kc ll kg lm lb lc ld bi translated">打开电源BI。</li><li id="7ee9" class="kv kw hh jl b jm le jq lf ju lg jy lh kc li kg lm lb lc ld bi translated">点击右上角的文件。</li></ol><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es mk"><img src="../Images/a2750eda7dbe8becaa6ffc3de4124bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*esKVnqBARa3YlO0yrSjUIw.png"/></div></figure><p id="3dd1" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">3.单击选项和设置。单击选项。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es ml"><img src="../Images/29c51004170fb8bf1e00a215ed0de640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*hwDcZt2wUU6vyPz9CHOyIw.png"/></div></figure><p id="3509" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">4.单击Python脚本</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es mm"><img src="../Images/617b191aef7d2b6f8e1501884d39b7b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*YNW0nKmMCuHr1MbViYYL1A.png"/></div></figure><p id="dbbc" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">5.将检测到的Python主目录更改为Other，并浏览在步骤1中创建的Python环境。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es mn"><img src="../Images/fdfb4f80d1c7e574b5e25dc7f549d422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ln3Br-azhCm5sWeEuc-QJA.png"/></div></div></figure><p id="6897" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated"><strong class="jl hi">提示:</strong>查找环境目录。</p><ul class=""><li id="9ca5" class="kv kw hh jl b jm kq jq kr ju lj jy lk kc ll kg la lb lc ld bi translated">打开Anaconda提示符</li><li id="e39a" class="kv kw hh jl b jm le jq lf ju lg jy lh kc li kg la lb lc ld bi translated">键入下面的代码(用您的环境名称替换<strong class="jl hi"> &lt; env_name &gt; </strong>)</li></ul><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="a24b" class="me im hh ma b fi mf mg l mh mi">conda activate &lt;env_name&gt;</span></pre><ul class=""><li id="eb13" class="kv kw hh jl b jm kq jq kr ju lj jy lk kc ll kg la lb lc ld bi translated">键入以下代码以显示此环境的python位置。</li></ul><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="32cb" class="me im hh ma b fi mf mg l mh mi">where python</span></pre><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/7f5c277a027ffda395557a716553b03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*CZ7Ks55RrDMLLW2KS8h14A.png"/></div></figure><p id="6a3b" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">复制python.exe之前的路径</p></div><div class="ab cl mp mq go mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ha hb hc hd he"><blockquote class="mw"><p id="39b1" class="mx my hh bd mz na nb nc nd ne nf kg dx translated"><strong class="ak">现在，你可以在Power BI </strong>中使用Python了</p></blockquote><blockquote class="ng nh ni"><p id="f736" class="jj jk nj jl b jm nk jo jp jq nl js jt nm nn jw jx no np ka kb nq nr ke kf kg ha bi translated">Python至少可以在3个步骤中应用:获取数据、转换和可视化</p></blockquote><p id="2918" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">如果你想了解这篇文章，你可以从<a class="ae ls" href="https://www.kaggle.com/datasets/datatattle/covid-19-nlp-text-classification/download" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/datasets/datatattle/新冠肺炎-NLP-text-classification/download</a>下载数据</p><h1 id="9761" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">🧺使用Python来获取数据</h1><p id="3345" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">Python可以用来获取数据。这有助于网络抓取(从网站获取数据)。</p><p id="e971" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">在这个例子中，我将创建一个Python文件来从两个源获取数据:一个csv文件和一个创建的dataframe(一个包含行和列的表)。</p><p id="57f4" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">1.单击获取数据</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es ns"><img src="../Images/75f5372eca7e8c4ee4c1b0d2fb89e6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*xLA3Hnw6D_-kWt2K6c3Izg.png"/></div></figure><p id="009f" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">2.搜索Python脚本，然后单击打开新的编码窗口。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es nt"><img src="../Images/ed0480a956566d0b831fde65b796a930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9VXfmbfGTq6eL1v4BtBilw.png"/></div></div></figure><p id="5f88" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">3.键入下面的代码，然后单击确定。</p><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="5879" class="me im hh ma b fi mf mg l mh mi">import pandas as pd</span><span id="70bd" class="me im hh ma b fi nu mg l mh mi">df1 = pd.read_csv("C:/Corona_NLP_train.csv", encoding = "ISO-8859-1")<br/>df2 = pd.DataFrame({'A': [1, 3, 6, 8],'B': [10, 30, 50, 90]})</span></pre><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es nv"><img src="../Images/0735a7d2dc627052100e2a15f4412fec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ou7ipAi1Xiyb_wgNA1dbQ.png"/></div></div></figure><p id="5193" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">4.您将看到一个显示数据的导航器(类似于其他get data方法)。).选择要加载的数据。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es nw"><img src="../Images/f2d56fd7b54b8bce88c50b38e1fcab2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*1g9SOW9p2lpyCOMxyXsdtA.png"/></div></figure><h1 id="d596" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">🔄在转换中使用Python</h1><p id="e1e2" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">Python也可以用于数据转换步骤。大多数情况下，我将它用于正则表达式，从另一列中提取匹配定义模式的子字符串，比如从Twitter文本中获取标签。</p><p id="4c20" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">在这个例子中，我将使用Python中的len()函数来查找文本长度。</p><ol class=""><li id="b2ae" class="kv kw hh jl b jm kq jq kr ju lj jy lk kc ll kg lm lb lc ld bi translated">单击转换数据</li></ol><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es nx"><img src="../Images/fcb4e17fa63f0341cd3437d059db0618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*pqIBHqhq8D7-a8slrRCWHw.png"/></div></figure><p id="7448" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">2.选择要转换的查询</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es ny"><img src="../Images/cae5706e7f38e3792c20dbc1a31a5b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*SnEeLWC8XtY4zW1-EAdzzg.png"/></div></figure><p id="4bff" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">3.在变换选项卡中，单击运行Python脚本</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es nz"><img src="../Images/ee63bc9d0fd400372fd89bef059ece47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QjUQNCtrx65gpCVe55pcJA.png"/></div></div></figure><p id="953d" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">4.您将看到一个新的运行Python脚本窗口。在此处编写代码，然后单击“确定”。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es oa"><img src="../Images/f3d522d41f6b8c6c365b745197f19d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z3bmM2-6A8nXt0ygFiLsKA.png"/></div></div></figure><p id="5042" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated"><strong class="jl hi">关键概念</strong>:数据将是一个“数据集”数据帧，所以你可以用pandas函数来操作它。</p><p id="bf52" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">6.结果将是一个表格。单击以展开表格。确保未选中“使用原始列名作为前缀”。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es ob"><img src="../Images/4f90dfe4e9cec1b90c9996133d8d7fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*HrPdkjR6tSkRFhVW9N9zOA.png"/></div></figure><p id="9544" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">7.您将看到数据转换的结果，这些步骤被添加到应用步骤中。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es oc"><img src="../Images/134f514a40fda033e18f6101b2645c87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WJz-9MHtWHHsK0dPSiqyUQ.png"/></div></div></figure><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es od"><img src="../Images/1a3a85b8aa144845862316113cad1cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*oPXJxVTHbWRy-KGxINZC0w.png"/></div></figure><h1 id="3a70" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">📊使用Python可视化</h1><p id="61cf" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">仅使用Power BI的可视化功能创建图可能会有一些限制，有些图在Power BI中可能不可用。</p><p id="77ff" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">Python将会派上用场，因为Python中有许多库可以按照您的意愿生成任何可视化。</p><p id="e6d1" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">目前常用的数据可视化Python库包括Matplotlib、Plotly、Seaborn和GGplot。</p><p id="127a" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">虽然用Python写代码创建一个情节可能比Power BI的拖放概念更困难，但是有更多的情节定制和代码示例(可供复制)。</p><ol class=""><li id="5924" class="kv kw hh jl b jm kq jq kr ju lj jy lk kc ll kg lm lb lc ld bi translated">在可视化平面中，单击Py图标(Python的缩写)。</li></ol><figure class="lo lp lq lr fd ii er es paragraph-image"><div class="er es oe"><img src="../Images/b59ef2a354219f7756dfd3d4f335bed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*8Zez8pt1qniWOh_SFeu7lA.png"/></div></figure><p id="a80f" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">2.您将看到一个空的Python脚本编辑器区域。选择要可视化的列。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es of"><img src="../Images/68e2c22216928e08efb379c22da50fde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TsZDJIjlxVJK1Zm5MuiaqA.png"/></div></div></figure><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es og"><img src="../Images/cb45fc3fb45ffd5d32e9e89f3f7f56fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MBuBIuIJ0vyhtsbmYFKggw.png"/></div></div></figure><p id="f83f" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">3.你会看到一个空的编码区。编写代码(不要忘记plt.show()来显示图形)并单击run图标，然后等待结果。搞定了。！</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es oh"><img src="../Images/1f4e94be983063fbc3a6dd31163457ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U0s7yPbBx6RGkyiojtN0Yw.png"/></div></div></figure><pre class="lo lp lq lr fd lz ma mb mc aw md bi"><span id="9348" class="me im hh ma b fi mf mg l mh mi">import seaborn as sns</span><span id="6162" class="me im hh ma b fi nu mg l mh mi">import matplotlib.pyplot as plt</span><span id="ab21" class="me im hh ma b fi nu mg l mh mi">import re</span><span id="4848" class="me im hh ma b fi nu mg l mh mi">def find_hash(text):</span><span id="ee82" class="me im hh ma b fi nu mg l mh mi">line=re.findall(r'(?&lt;=#)\w+',text)</span><span id="a24f" class="me im hh ma b fi nu mg l mh mi">return " ".join(line)</span><span id="b824" class="me im hh ma b fi nu mg l mh mi">dataset['hash']=dataset['OriginalTweet'].apply(lambda x:find_hash(x))</span><span id="a506" class="me im hh ma b fi nu mg l mh mi">temp=dataset['hash'].value_counts()[:][1:11]</span><span id="cf8a" class="me im hh ma b fi nu mg l mh mi">temp= temp.to_frame().reset_index().rename(columns={'index':'Hashtag','hash':'count'})</span><span id="aa50" class="me im hh ma b fi nu mg l mh mi">plt.figure(figsize=(20, 15))</span><span id="0b16" class="me im hh ma b fi nu mg l mh mi">sns.barplot(x="Hashtag",y="count", data = temp)</span><span id="5feb" class="me im hh ma b fi nu mg l mh mi">plt.show()</span></pre><p id="983c" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated"><strong class="jl hi">注意:</strong>如果运行代码后显示错误，深呼吸，阅读错误信息。</p><h1 id="b995" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated"><strong class="ak">结论</strong></h1><p id="6fae" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">本文将一步步展示如何在Power BI中应用Python，这样您就可以同时获得Power BI交互式仪表板和Python灵活性的优势。您可以以多种方式应用Python代码，包括数据获取、转换和可视化。</p><p id="1dca" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">希望你对在Power BI中使用Python有所了解。</p><p id="24f0" class="pw-post-body-paragraph jj jk hh jl b jm kq jo jp jq kr js jt ju ks jw jx jy kt ka kb kc ku ke kf kg ha bi translated">如果您想阅读更多数据分析内容，请关注我。</p><div class="oi oj ez fb ok ol"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="om ab dw"><div class="on ab oo cl cj op"><h2 class="bd hi fi z dy oq ea eb or ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="os l"><h3 class="bd b fi z dy oq ea eb or ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ot l"><p class="bd b fp z dy oq ea eb or ed ef dx translated">medium.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ij ol"/></div></div></a></div></div></div>    
</body>
</html>