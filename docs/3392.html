<html>
<head>
<title>Pytorch &amp; C++ #2: Creating models and datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pytorch &amp; C++ #2:创建模型和数据集</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/pytorch-c-2-creating-models-and-datasets-bf8c58ee40b1?source=collection_archive---------3-----------------------#2022-08-28">https://medium.com/mlearning-ai/pytorch-c-2-creating-models-and-datasets-bf8c58ee40b1?source=collection_archive---------3-----------------------#2022-08-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/2df193ef8fcb85dc3308b62b246c4add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CCzSulsaZvXvQktwYMRTPw.png"/></div></div></figure><h1 id="58ff" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">介绍</h1><p id="3d7d" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在本系列中，我将尝试用Pytorch c++ API提供示例/实践/项目。如果您是初次接触这个系列，潜水前您可以查看第一个博客。在这个故事中，我们将在cpp中练习神经网络模块。所有代码均可在本Github repo 的<a class="ae kl" href="https://github.com/EmreOzkose/pytorch_cpp" rel="noopener ugc nofollow" target="_blank">中找到。</a></p><h1 id="a881" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">内容</h1><ol class=""><li id="e47a" class="km kn hh jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">创建模型</li><li id="7f2d" class="km kn hh jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">创建自定义数据集(用于<a class="ae kl" href="https://www.kaggle.com/competitions/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank">房价数据集</a>)</li></ol><h1 id="77f6" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">创建模型</h1><p id="2366" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">我们可以定义一个基本的线性层堆栈，如下所示。<code class="du la lb lc ld b">Struct</code>用于构建模型类。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="f6e2" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">我们还可以定义一个卷积神经网络。我们应该给层定义一个选项对象，它与Python不同。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="9b00" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">在编写了一个自定义模型之后，我们也可以定义如下。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="1d7a" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">让我们为CNN运行一个随机输入的基本推断。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="f636" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">模型也可以用预定义的函数初始化。让我们用泽维尔初始化来初始化我们的CNN模型。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="7612" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">这很容易，就像在python中一样。让我们为房价数据集创建一个自定义数据集，并使用模型(尚未训练)对其进行测试。</p><h1 id="0804" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">创建自定义数据集</h1><p id="c7fb" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">我们将使用<a class="ae kl" href="https://www.kaggle.com/competitions/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank">房价数据集</a>的一个子集，其中仅使用了<em class="lp">地段面积</em>和<em class="lp">建成年份</em>特征。当然，以<em class="lp"> sales_price </em>列为目标。我创建了一个CSV文件，它只包含上面提到的3列，没有标题。此文件看起来像:</p><pre class="le lf lg lh fd lq ld lr ls aw lt bi"><span id="0065" class="lu iq hh ld b fi lv lw l lx ly">8450,2003,208500<br/>9600,1976,181500<br/>11250,2001,223500<br/>9550,1915,140000<br/>14260,2000,250000<br/>14115,1993,143000<br/>...</span></pre><p id="d867" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">其中第一栏为<em class="lp">地段_面积</em>，第二栏为<em class="lp">建成_年</em>，第三栏为<em class="lp">销售_价格</em>。样本数量是1460。让我们阅读CSV文件。这不是本教程目标的重要部分，但我们应该阅读它:。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="a62b" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">读取数据集后，我们获得一个包含要素行的矢量对象。我们可以使用以下方式打印所有样本:</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="deb5" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">现在，我们可以定义如下的自定义数据集。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="d372" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">现在，让我们用我们的CNN模型(还没有经过训练)来测试这些定制数据。</p><figure class="le lf lg lh fd ii"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="6f94" class="pw-post-body-paragraph jn jo hh jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ha bi translated">预测值3351.2444与目标值208500相差甚远，但正如我所说，CNN模型还没有经过训练。我们将在下面的博客中训练一个房价预测模型，并用JIT进行测试。</p><h1 id="f2b0" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">结论</h1><p id="fefc" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在这个博客中，我们用Pytorch cpp API练习了nn模块。所有代码都可以在<a class="ae kl" href="https://github.com/EmreOzkose/pytorch_cpp" rel="noopener ugc nofollow" target="_blank">这个Github Repo </a>中找到。我们将在本系列的以下博客中继续torch::nn。</p><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hi fi z dy mh ea eb mi ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq in mc"/></div></div></a></div></div></div>    
</body>
</html>