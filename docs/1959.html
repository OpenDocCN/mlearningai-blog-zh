<html>
<head>
<title>Proportions Z-tests statistics in numerical experiment for Monty Hall problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Monty Hall问题数值实验中的比例Z-检验统计量</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/proportions-z-tests-statistics-in-numerical-experiment-for-monty-hall-problem-d3d9c50a345b?source=collection_archive---------8-----------------------#2022-02-15">https://medium.com/mlearning-ai/proportions-z-tests-statistics-in-numerical-experiment-for-monty-hall-problem-d3d9c50a345b?source=collection_archive---------8-----------------------#2022-02-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/caf52c7d0dda44171391490796a030e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fK0CHoFjeClO4oI3dDZw3w.jpeg"/></div></div></figure><blockquote class="ip iq ir"><p id="baf1" class="is it iu iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">欲了解完整解决方案，请访问我的<a class="ae jr" href="https://github.com/NataliaTarasovaNatoshir/NataliaTarasovaNatoshir/blob/main/Monty_Hall_z_stat_for_shares.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHib </a></p></blockquote><p id="8c4d" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated"><a class="ae jr" href="https://en.wikipedia.org/wiki/Monty_Hall_problem" rel="noopener ugc nofollow" target="_blank">天魔堂问题</a>是一个概率难题，也被称为“三门问题”。它以其反直觉的解决方案而闻名，这听起来可能很荒谬，但却是真实的。</p><blockquote class="ip iq ir"><p id="cabc" class="is it iu iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="hh">假设你在参加一个游戏节目，你有三扇门可供选择:一扇门后是一辆汽车；在其他人后面，山羊。你选了一扇门，比如说№1，知道门后是什么的主人打开了另一扇门，比如说№3，里面有一只山羊。然后他对你说，“你想选2号门吗？”改变你的选择对你有利吗？</em></p></blockquote><p id="3011" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated"><strong class="iv hi">这篇文章有两个目标:</strong></p><ul class=""><li id="0a67" class="jv jw hh iv b iw ix ja jb js jx jt jy ju jz jq ka kb kc kd bi translated">展示统计学在处理0和1的有限样本中的比例的应用(<a class="ae jr" href="https://en.wikipedia.org/wiki/Bernoulli_distribution" rel="noopener ugc nofollow" target="_blank">伯努利分布</a>)。该任务的经典示例包括:<br/> -定义新的广告横幅是否比旧的横幅吸引更多的点击<br/> -估计提供统计显著性结论所需的A/B实验的长度<br/> -检查具有来自两个类别的对象的样本是否具有显著偏斜的类别分布</li><li id="c26f" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">运行数值实验来支持蒙蒂霍尔问题的反直觉解决方案</li></ul><h1 id="7521" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">解析</h1><p id="bd18" class="pw-post-body-paragraph is it hh iv b iw lh iy iz ja li jc jd js lj jg jh jt lk jk jl ju ll jo jp jq ha bi translated">史蒂夫·塞尔文在1975年描述了正确的解决方案。答案是参赛者应该<strong class="iv hi">换到另一扇门。</strong></p><p id="732c" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">切换策略有2/3的概率赢得汽车，而保持最初选择的策略只有1/3的概率。</p><p id="1325" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">理解解决方案的方法之一是将最初未被选择的两扇门放在一起考虑。塞西尔·亚当斯说:“蒙蒂实际上是在说:你可以保留你的一扇门，也可以拥有另外两扇门。”找到汽车的2/3的机会并没有因为打开其中一扇门而改变，因为蒙蒂知道汽车的位置，肯定会发现一只山羊。因此，在主持人打开一扇门后，玩家的选择与主持人向玩家提供从最初选择的门切换到其余两扇门的选项没有什么不同。这种情况下的切换显然给了玩家2/3的概率选择汽车。</p><h1 id="0ba1" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">数值实验</h1><p id="59f4" class="pw-post-body-paragraph is it hh iv b iw lh iy iz ja li jc jd js lj jg jh jt lk jk jl ju ll jo jp jq ha bi translated">看看有没有可能用数值实验来确认解析解！</p><p id="e25c" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">首先，我们必须定义一个充当节目主持人的函数:</p><ul class=""><li id="3f93" class="jv jw hh iv b iw ix ja jb js jx jt jy ju jz jq ka kb kc kd bi translated">随机选择后面有汽车的门(门名为0、1或2)</li><li id="e088" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">通过“策略”选门</li><li id="5bef" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">主人打开另一扇门，门后有一只山羊</li><li id="da0e" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">“战略”做了最后的猜测</li><li id="362e" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">主持人揭示这个最终猜测是正确的(返回1)还是错误的(返回0)</li></ul><p id="cb2e" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">我们分析的第一个策略是“等待门”策略，在另一扇门打开后，它不会改变它的第一个猜测</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="bb34" class="lv kk hh lr b fi lw lx l ly lz"><strong class="lr hi">def</strong> hold_strategy(first_guess<strong class="lr hi">=-</strong>1, empty_door_num<strong class="lr hi">=None</strong>):<br/>  <strong class="lr hi">if</strong> first_guess <strong class="lr hi">&gt;=</strong> 0:<br/>    <strong class="lr hi">return</strong> first_guess<br/>  <strong class="lr hi">else</strong>:<br/>    <strong class="lr hi">return</strong> random<strong class="lr hi">.</strong>randint(0, 2)</span></pre><p id="70ae" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">另一种策略是“换门”策略，它总是在另一扇门打开后改变它的第一次猜测</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="90f4" class="lv kk hh lr b fi lw lx l ly lz"><strong class="lr hi">def</strong> change_strategy(first_guess<strong class="lr hi">=-</strong>1, empty_door_num<strong class="lr hi">=None</strong>):<br/>  <strong class="lr hi">if</strong> first_guess <strong class="lr hi">&gt;=</strong> 0:<br/>    s <strong class="lr hi">=</strong> {0, 1, 2} <strong class="lr hi">-</strong> {first_guess} <strong class="lr hi">-</strong> {empty_door_num}<br/>    <strong class="lr hi">return</strong> s<strong class="lr hi">.</strong>pop()<br/>  <strong class="lr hi">else</strong>:<br/>    <strong class="lr hi">return</strong> random<strong class="lr hi">.</strong>randint(0, 2)</span></pre><h1 id="9835" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">获胜概率的置信区间</h1><p id="8b02" class="pw-post-body-paragraph is it hh iv b iw lh iy iz ja li jc jd js lj jg jh jt lk jk jl ju ll jo jp jq ha bi translated">当我们运行一系列游戏时，我们获得了该策略的<strong class="iv hi">样本获胜份额</strong>。这只是对真实获胜概率的估计。我们可以用一个固定的α值来定义这个估计的置信区间。这意味着真正的获胜概率在这个区间之外的概率小于α。我们玩的游戏越多，置信区间就越小，我们对真实获胜概率值的估计就越精确。</p><p id="36fb" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">计算二项比例置信区间的有效方法之一是<a class="ae jr" href="https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval" rel="noopener ugc nofollow" target="_blank">威尔逊评分</a>法。</p><p id="bda4" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">让我们用威尔逊评分法来衡量“换门”策略</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="5605" class="lv kk hh lr b fi lw lx l ly lz"><strong class="lr hi">import</strong> scipy<br/><strong class="lr hi">from</strong> statsmodels.stats.weightstats <strong class="lr hi">import</strong> <strong class="lr hi">*</strong><br/><strong class="lr hi">from</strong> statsmodels.stats.proportion <strong class="lr hi">import</strong> proportion_confint</span><span id="30e8" class="lv kk hh lr b fi ma lx l ly lz">conf_interval_change <strong class="lr hi">=</strong> proportion_confint(sum(res_change), len(res_change), method <strong class="lr hi">=</strong> 'wilson')<br/><br/>print("Change door strategy:\n95% confidence interval for win probability = [{0:.2f}, {1:.2f}]"<strong class="lr hi">.</strong>format(<br/>    conf_interval_change[0], conf_interval_change[1]))</span><span id="b581" class="lv kk hh lr b fi ma lx l ly lz">Change door strategy:<br/>95% confidence interval for win probability = [0.31, 0.83]</span></pre><p id="4623" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">我们比较的两个策略(“守住门”-策略和“改变门”-策略)是互斥的。意思是在一种策略输掉比赛的情况下，另一种策略会赢得比赛。如果我们要支持一个假设，即“换门”——策略优于“守住门”——策略，我们需要比较“换门”——策略的获胜概率，取值为0.5。</p><p id="6d10" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">请注意，在上面的示例中，当“改变门”策略的成功率超过50%时，置信区间包括0.5的值。对于这种策略的10场比赛还不足以得出结论，即“换门”策略比另一种“守门”策略更好。</p><h1 id="a77b" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">概率得分的z统计</h1><p id="09ae" class="pw-post-body-paragraph is it hh iv b iw lh iy iz ja li jc jd js lj jg jh jt lk jk jl ju ll jo jp jq ha bi translated">当主人打开一扇门，山羊在门后，我们有两扇门(一扇门后面有一辆汽车，另一扇门是一只山羊),因此猜出正确门的概率是0.5，这听起来可能是合理的。</p><p id="eeb8" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">让我们应用一个统计标准来比较固定概率为0.5的“换门”策略的样本成功份额</p><figure class="lm ln lo lp fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/d3f24f596d5ac71397f95d9a0db32e29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GQqn8-7mfLCFGy8HmKoK7A.png"/></div></div></figure><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="342f" class="lv kk hh lr b fi lw lx l ly lz"><strong class="lr hi">def</strong> share_z_stat(sample, p_0):<br/>    n <strong class="lr hi">=</strong> len(sample)<br/>    p <strong class="lr hi">=</strong> float(sum(sample)) <strong class="lr hi">/</strong> n<br/>    <br/>    <strong class="lr hi">return</strong> (p <strong class="lr hi">-</strong> p_0) <strong class="lr hi">/</strong> np<strong class="lr hi">.</strong>sqrt((p_0 <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> p_0)) <strong class="lr hi">/</strong> n)</span><span id="7eb5" class="lv kk hh lr b fi ma lx l ly lz"><strong class="lr hi">def</strong> share_p_value(z_stat, alternative <strong class="lr hi">=</strong> 'two-sided'):<br/>    <strong class="lr hi">if</strong> alternative <strong class="lr hi">not</strong> <strong class="lr hi">in</strong> ('two-sided', 'less', 'greater'):<br/>        <strong class="lr hi">raise</strong> ValueError("Invalid alternative\n"<br/>                         "Possible options: 'two-sided', 'less' or 'greater'")<br/>    <br/>    <strong class="lr hi">if</strong> alternative <strong class="lr hi">==</strong> 'two-sided':<br/>        <strong class="lr hi">return</strong> 2 <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> scipy<strong class="lr hi">.</strong>stats<strong class="lr hi">.</strong>norm<strong class="lr hi">.</strong>cdf(np<strong class="lr hi">.</strong>abs(z_stat)))<br/>    <br/>    <strong class="lr hi">if</strong> alternative <strong class="lr hi">==</strong> 'less':<br/>        <strong class="lr hi">return</strong> scipy<strong class="lr hi">.</strong>stats<strong class="lr hi">.</strong>norm<strong class="lr hi">.</strong>cdf(z_stat)<br/><br/>    <strong class="lr hi">if</strong> alternative <strong class="lr hi">==</strong> 'greater':<br/>        <strong class="lr hi">return</strong> 1 <strong class="lr hi">-</strong> scipy<strong class="lr hi">.</strong>stats<strong class="lr hi">.</strong>norm<strong class="lr hi">.</strong>cdf(z_stat)</span><span id="4547" class="lv kk hh lr b fi ma lx l ly lz"><strong class="lr hi">def</strong> shares_diff_confint_ind(sample, p_0, alpha <strong class="lr hi">=</strong> 0.05):    <br/>    z <strong class="lr hi">=</strong> scipy<strong class="lr hi">.</strong>stats<strong class="lr hi">.</strong>norm<strong class="lr hi">.</strong>ppf(1 <strong class="lr hi">-</strong> alpha <strong class="lr hi">/</strong> 2.)<br/>    <br/>    p <strong class="lr hi">=</strong> float(sum(sample)) <strong class="lr hi">/</strong> len(sample)<br/>    <br/>    left_boundary <strong class="lr hi">=</strong> p_0 <strong class="lr hi">-</strong> z <strong class="lr hi">*</strong> np<strong class="lr hi">.</strong>sqrt(p_0 <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> p_0)<strong class="lr hi">/</strong> len(sample))<br/>    right_boundary <strong class="lr hi">=</strong> p_0 <strong class="lr hi">+</strong> z <strong class="lr hi">*</strong> np<strong class="lr hi">.</strong>sqrt(p_0 <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> p_0)<strong class="lr hi">/</strong> len(sample))<br/>    <br/>    <strong class="lr hi">return</strong> (left_boundary, right_boundary)</span></pre><p id="7662" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">让我们用50个游戏进行实验，并计算统计数据:</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="67f4" class="lv kk hh lr b fi lw lx l ly lz">Started series of 50 experiments<br/>Experiment finished<br/>31 wins out of 50 trials. Success share = 62.00%<br/><br/>Z-statistics = 1.70<br/><br/>H_0 hypothesis: Win probability = 0.5<br/><br/>H_1 hypothesis: Win probability != 0.5<br/>p-value for two-sided test = 0.0897<br/>Meaning: possibility to obtain in an experiment this sample win share while true win probability = 0.5 is equal to 8.97%<br/><br/>Use the suggestion that 'change door'-strategy is more effective than 0.5<br/>H_1 hypothesis: Win probability &gt; 0.5<br/>p-value for right-sided test = 0.0448<br/>Meaning: possibility to obtain in an experiment this or greater win share while true win probability = 0.5 is less than 4.48%</span></pre><h1 id="93ab" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">评估A/B测试的长度</h1><p id="a60c" class="pw-post-body-paragraph is it hh iv b iw lh iy iz ja li jc jd js lj jg jh jt lk jk jl ju ll jo jp jq ha bi translated">在A/B测试之前，我们经常需要估计这个测试需要多长时间。在我们的例子中，问题是:“在我们可以说“改变门”策略的获胜概率高于0.5之前，应该玩多少游戏？”</p><p id="3b7f" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">例如，我们可以如下进行:</p><ol class=""><li id="496f" class="jv jw hh iv b iw ix ja jb js jx jt jy ju jz jq mc kb kc kd bi translated">使用我们对这种策略的真实获胜概率的假设，计算选定游戏数N的置信区间</li><li id="180b" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq mc kb kc kd bi translated">假设我们得到了“最坏的情况”——我们得到了置信区间的左边缘作为样本获胜概率估计</li><li id="9c2d" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq mc kb kc kd bi translated">使用“最坏情况”样本赢得份额估计H1假设的p值</li><li id="b1b8" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq mc kb kc kd bi translated">检查估计的p值是否低于目标p值，这意味着建议的游戏数N是足够的</li></ol><p id="a74e" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">N=10场比赛是不够的，因为在我们的样本中，我们可能会获得小于0.5的获胜份额:</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="b250" class="lv kk hh lr b fi lw lx l ly lz">estimate_p_value(p_true<strong class="lr hi">=</strong>2<strong class="lr hi">/</strong>3, p_0<strong class="lr hi">=</strong>1<strong class="lr hi">/</strong>2, N<strong class="lr hi">=</strong>10, alternative <strong class="lr hi">=</strong> 'two-sided', p_value_goal<strong class="lr hi">=</strong>0.05)</span><span id="2f84" class="lv kk hh lr b fi ma lx l ly lz">Confidence interval includes 0.5. Try a bigger number of trials</span></pre><p id="1a39" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">N=50场比赛更好，但在最坏的情况下，我们将达不到统计显著性:</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="d20d" class="lv kk hh lr b fi lw lx l ly lz">estimate_p_value(p_true<strong class="lr hi">=</strong>2<strong class="lr hi">/</strong>3, p_0<strong class="lr hi">=</strong>1<strong class="lr hi">/</strong>2, N<strong class="lr hi">=</strong>50, alternative <strong class="lr hi">=</strong> 'two-sided', p_value_goal<strong class="lr hi">=</strong>0.05)</span><span id="6072" class="lv kk hh lr b fi ma lx l ly lz">Using the worst case scenario:<br/>    p = 0.52</span><span id="3eab" class="lv kk hh lr b fi ma lx l ly lz">Estimated p-value for 50 trials = 0.7607<br/>Goal p-value 0.0500 is smaller that estimated p-value 0.7607<br/>Try a bigger number of trials</span></pre><p id="3e33" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">N=150应该足够了</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="4289" class="lv kk hh lr b fi lw lx l ly lz">estimate_p_value(p_true<strong class="lr hi">=</strong>2<strong class="lr hi">/</strong>3, p_0<strong class="lr hi">=</strong>1<strong class="lr hi">/</strong>2, N<strong class="lr hi">=</strong>150, alternative <strong class="lr hi">=</strong> 'two-sided', p_value_goal<strong class="lr hi">=</strong>0.05)</span><span id="aa73" class="lv kk hh lr b fi ma lx l ly lz">Using the worst case scenario:<br/>    p = 0.59</span><span id="b09c" class="lv kk hh lr b fi ma lx l ly lz">Estimated p-value for 150 trials = 0.0313<br/>Goal p-value 0.0500 is greater that estimated p-value 0.0313<br/>Number of trials should be enough to test the hypothesis that win probability is higher than 1/2</span></pre><p id="f754" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">让我们运行一个上面选择的N=150的实验，并且看到我们成功地达到了目标p值&lt; 0.05的统计显著性</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="3305" class="lv kk hh lr b fi lw lx l ly lz">Started series of 150 experiments<br/>Experiment finished<br/>90 wins out of 150 trials. Success share = 60.00%</span><span id="1328" class="lv kk hh lr b fi ma lx l ly lz">Experiments result:<br/>Z-statistics for win share compared with 0.5 = 2.45</span><span id="5e5e" class="lv kk hh lr b fi ma lx l ly lz">p-value for two-sided test = 0.0143<br/>Meaning: possibility to obtain in an experiment this or greater absolute win share (while true win probability = 0.5) equals 1.43%</span></pre><h1 id="5a25" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">评估策略的成功概率</h1><p id="a9f4" class="pw-post-body-paragraph is it hh iv b iw lh iy iz ja li jc jd js lj jg jh jt lk jk jl ju ll jo jp jq ha bi translated">那么，我们能精确估计一个选择的策略获胜的概率吗？</p><p id="a28c" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">我们所能做的是获得足够的样本，以便有一个我们认为足够小的置信区间</p><p id="ed63" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">当我们获得样本份额= 0.5时，威尔逊得分区间最宽(见下图)</p><figure class="lm ln lo lp fd ii er es paragraph-image"><div class="er es md"><img src="../Images/8ce13e9184b3c9ae6f2f9bd972a51724.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*jWMJhlSJj6GAaAkFpaTx5g.png"/></div></figure><p id="5d44" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">这意味着我们可以首先定义获得小于所选宽度的置信区间所需的样本数N</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="a99a" class="lv kk hh lr b fi lw lx l ly lz"><strong class="lr hi">def</strong> max_wilson_conf_interval_width(N, alpha<strong class="lr hi">=</strong>0.05):<br/>  conf_interval <strong class="lr hi">=</strong> proportion_confint(int(0.5<strong class="lr hi">*</strong>N), N, method <strong class="lr hi">=</strong> 'wilson', alpha<strong class="lr hi">=</strong>alpha)<br/>  <strong class="lr hi">return</strong> conf_interval[1] <strong class="lr hi">-</strong> conf_interval[0]</span><span id="9459" class="lv kk hh lr b fi ma lx l ly lz"><strong class="lr hi">def</strong> estimate_wilson_conf_interval(N, goal_width<strong class="lr hi">=</strong>0.2, alpha<strong class="lr hi">=</strong>0.05):<br/>  max_width <strong class="lr hi">=</strong> max_wilson_conf_interval_width(N, alpha<strong class="lr hi">=</strong>alpha)<br/>  print("Maximum Wilson score interval width for N={0} is {1:.2f}"<strong class="lr hi">.</strong>format(N, max_width))<br/>  <strong class="lr hi">if</strong> max_width <strong class="lr hi">&gt;</strong> goal_width:<br/>    print("Wilson score interval may be wider than goal width {}\nTry a bigger N"<strong class="lr hi">.</strong>format(goal_width))<br/>  <strong class="lr hi">else</strong>:<br/>    print("Wilson score interval is smaller than goal width {}\nN is sufficient"<strong class="lr hi">.</strong>format(goal_width))</span></pre><p id="abdd" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">N=100可能不足以获得足够小的置信区间:</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="7a79" class="lv kk hh lr b fi lw lx l ly lz">estimate_wilson_conf_interval(N<strong class="lr hi">=</strong>100, goal_width<strong class="lr hi">=</strong>0.1, alpha<strong class="lr hi">=</strong>0.05)</span><span id="a991" class="lv kk hh lr b fi ma lx l ly lz">Maximum Wilson score interval width for N=100 is 0.19<br/>Wilson score interval may be wider than goal width 0.1<br/>Try a bigger N</span></pre><p id="c962" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">N=400似乎足以得到小于0.1的置信区间:</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="4a60" class="lv kk hh lr b fi lw lx l ly lz">estimate_wilson_conf_interval(N<strong class="lr hi">=</strong>400, goal_width<strong class="lr hi">=</strong>0.1, alpha<strong class="lr hi">=</strong>0.05)</span><span id="4412" class="lv kk hh lr b fi ma lx l ly lz">Maximum Wilson score interval width for N=400 is 0.10<br/>Wilson score interval is smaller than goal width 0.1<br/>N is sufficient</span></pre><p id="281b" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">让我们对“换门”策略进行N=400次试验，并检查我们是否确实获得了期望宽度的置信区间:</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="f80d" class="lv kk hh lr b fi lw lx l ly lz">Started series of 400 experiments<br/>Experiment finished<br/>279 wins out of 400 trials. Success share = 69.75%</span><span id="afab" class="lv kk hh lr b fi ma lx l ly lz">Change door strategy:<br/>95% confident interval for win probability = [0.65, 0.74]<br/>Interval width = 0.09</span></pre><h1 id="e224" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">份额差异的z统计</h1><p id="3abc" class="pw-post-body-paragraph is it hh iv b iw lh iy iz ja li jc jd js lj jg jh jt lk jk jl ju ll jo jp jq ha bi translated">“改变之门”策略和“保持之门”策略是相互排斥的:当一个策略失败了，就意味着另一个策略赢了。在这种情况下，为了比较这些策略，将这些策略之一的获胜概率与0.5进行比较就足够了。</p><p id="e37b" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">但是如果我们有两种不同的独立策略呢？如何检查两个策略是否有不同的获胜概率？我们可以对独立样本使用Z标准:</p><figure class="lm ln lo lp fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/4c99b9c3fa226f882eac5f232003d942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8VtsCoXwGg4GWYD3ko7tPA.png"/></div></div></figure><p id="6914" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">考虑另一种策略，坚持最初的猜测或随机改变主意(概率相等):</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="6204" class="lv kk hh lr b fi lw lx l ly lz"><strong class="lr hi">def</strong> random_switch_strategy(first_guess<strong class="lr hi">=-</strong>1, empty_door_num<strong class="lr hi">=None</strong>):<br/>  <strong class="lr hi">if</strong> first_guess <strong class="lr hi">&gt;=</strong> 0:<br/>    s <strong class="lr hi">=</strong> random<strong class="lr hi">.</strong>choice(list({0, 1, 2} <strong class="lr hi">-</strong> {empty_door_num}))<br/>    <strong class="lr hi">return</strong> s<br/>  <strong class="lr hi">else</strong>:<br/>    <strong class="lr hi">return</strong> random<strong class="lr hi">.</strong>randint(0, 2)</span></pre><p id="311b" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">定义函数来计算独立样本之间比例差异的Z统计量和置信区间:</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="07d8" class="lv kk hh lr b fi lw lx l ly lz"><strong class="lr hi">def</strong> shares_diff_z_stat(sample1, sample2):<br/>    n1 <strong class="lr hi">=</strong> len(sample1)<br/>    n2 <strong class="lr hi">=</strong> len(sample2)<br/>    <br/>    p1 <strong class="lr hi">=</strong> float(sum(sample1)) <strong class="lr hi">/</strong> n1<br/>    p2 <strong class="lr hi">=</strong> float(sum(sample2)) <strong class="lr hi">/</strong> n2 <br/>    P <strong class="lr hi">=</strong> float(p1<strong class="lr hi">*</strong>n1 <strong class="lr hi">+</strong> p2<strong class="lr hi">*</strong>n2) <strong class="lr hi">/</strong> (n1 <strong class="lr hi">+</strong> n2)<br/>    <br/>    <strong class="lr hi">return</strong> (p1 <strong class="lr hi">-</strong> p2) <strong class="lr hi">/</strong> np<strong class="lr hi">.</strong>sqrt(P <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> P) <strong class="lr hi">*</strong> (1. <strong class="lr hi">/</strong> n1 <strong class="lr hi">+</strong> 1. <strong class="lr hi">/</strong> n2))</span><span id="5aa6" class="lv kk hh lr b fi ma lx l ly lz"><strong class="lr hi">def</strong> shares_diff_confint_ind(sample1, sample2, alpha <strong class="lr hi">=</strong> 0.05):    <br/>    z <strong class="lr hi">=</strong> scipy<strong class="lr hi">.</strong>stats<strong class="lr hi">.</strong>norm<strong class="lr hi">.</strong>ppf(1 <strong class="lr hi">-</strong> alpha <strong class="lr hi">/</strong> 2.)<br/>    <br/>    p1 <strong class="lr hi">=</strong> float(sum(sample1)) <strong class="lr hi">/</strong> len(sample1)<br/>    p2 <strong class="lr hi">=</strong> float(sum(sample2)) <strong class="lr hi">/</strong> len(sample2)<br/>    <br/>    left_boundary <strong class="lr hi">=</strong> (p1 <strong class="lr hi">-</strong> p2) <strong class="lr hi">-</strong> z <strong class="lr hi">*</strong> np<strong class="lr hi">.</strong>sqrt(p1 <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> p1)<strong class="lr hi">/</strong> len(sample1) <strong class="lr hi">+</strong> p2 <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> p2)<strong class="lr hi">/</strong> len(sample2))<br/>    right_boundary <strong class="lr hi">=</strong> (p1 <strong class="lr hi">-</strong> p2) <strong class="lr hi">+</strong> z <strong class="lr hi">*</strong> np<strong class="lr hi">.</strong>sqrt(p1 <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> p1)<strong class="lr hi">/</strong> len(sample1) <strong class="lr hi">+</strong> p2 <strong class="lr hi">*</strong> (1 <strong class="lr hi">-</strong> p2)<strong class="lr hi">/</strong> len(sample2))<br/>    <br/>    <strong class="lr hi">return</strong> (left_boundary, right_boundary)</span></pre><p id="0cd0" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">为每种策略运行两个系列的100场游戏，并评估结果:</p><pre class="lm ln lo lp fd lq lr ls lt aw lu bi"><span id="90a5" class="lv kk hh lr b fi lw lx l ly lz">Started series of 100 experiments<br/>Experiment finished<br/>44 wins out of 100 trials. Success share = 44.00%<br/>Started series of 100 experiments<br/>Experiment finished<br/>60 wins out of 100 trials. Success share = 60.00%<br/><br/>Number of trials for each strategy: 100<br/><br/>Random switch win share = 44.00%<br/>Change strategy win share = 60.00%<br/>Win shares difference = -0.16<br/>95% confident interval for strategies win probability difference = [-0.30, -0.02]<br/>Z-statistics for win shares difference = -2.26<br/><br/>p-value for two-sided test = 0.0235<br/>Meaning: possibility to obtain in an experiment this or greater absolute difference in win shares while true win probabilities are equal is less than 2.35%<br/><br/>Use the suggestion that 'change door'-strategy is more effective than 'random switch'-strategy<br/>p-value for left-sided test = 0.0118<br/>Meaning: possibility to obtain in an experiment this or more negative difference in win shares while true win probabilities are equal is less than 1.18%</span></pre><p id="0fe9" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">该测试表明，“改变门”策略在统计上明显比“随机切换”策略更有效。请注意，不能保证该测试长度的统计显著性。</p><h1 id="99dc" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">结论</h1><p id="37cb" class="pw-post-body-paragraph is it hh iv b iw lh iy iz ja li jc jd js lj jg jh jt lk jk jl ju ll jo jp jq ha bi translated">为了支持Monty Hall问题的反直觉分析解决方案，我们成功地使用了:</p><ol class=""><li id="b9d5" class="jv jw hh iv b iw ix ja jb js jx jt jy ju jz jq mc kb kc kd bi translated">模拟不同策略的长系列博弈的数值实验</li><li id="1b2b" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq mc kb kc kd bi translated">统计仪器来评估这些发现的统计意义</li><li id="d3fd" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq mc kb kc kd bi translated">调查相关任务，如</li></ol><ul class=""><li id="f470" class="jv jw hh iv b iw ix ja jb js jx jt jy ju jz jq ka kb kc kd bi translated">a/B-达到统计显著性的测试长度估计</li><li id="73df" class="jv jw hh iv b iw ke ja kf js kg jt kh ju ki jq ka kb kc kd bi translated">比较0和1的独立样本份额的统计标准</li></ul><div class="mf mg ez fb mh mi"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">medium.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw in mi"/></div></div></a></div><p id="56c6" class="pw-post-body-paragraph is it hh iv b iw ix iy iz ja jb jc jd js jf jg jh jt jj jk jl ju jn jo jp jq ha bi translated">🔵<a class="ae jr" rel="noopener" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"> <strong class="iv hi">成为作家</strong> </a></p></div></div>    
</body>
</html>