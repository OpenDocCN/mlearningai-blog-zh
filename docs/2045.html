<html>
<head>
<title>Trying to connect dots in a fish study</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">试图在鱼类研究中把点联系起来</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/trying-to-connect-dots-in-a-fish-study-c9813e187c28?source=collection_archive---------4-----------------------#2022-02-26">https://medium.com/mlearning-ai/trying-to-connect-dots-in-a-fish-study-c9813e187c28?source=collection_archive---------4-----------------------#2022-02-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="a53f" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">为什么真实数据从来没有你看到的技术例子那么干净</h2></div><p id="0b3d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这篇文章中，我想向你介绍我是如何分析鱼类领域的一个特定数据集的。这来自一家商业公司的R&amp;D工厂，所以我不能与你分享数据，但至少你可以看到我是如何处理的。</p><p id="036a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">每当我写博客的时候，我再次清楚地意识到，我分析的数据集与图书馆文档中使用的数据集有着本质的不同。它们不太清晰、不太直观，而且通常你只能从这些数据集中得到一小部分。好了，这就是你的数据分析。它不干净。这并不简单，分析一个数据集意味着在想法、启示和碰壁之间来回穿梭，并意识到你想看到或相信你能看到的东西并不在那个特定的数据集中。也许它不会出现在随后的任何数据集中，但是由于研究很少被重复，所以你只能使用那个特定的数据集。</p><p id="42f5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以，我们又来了，向你们展示我如何分析一个商业数据集。很肯定，无论是谁读了这篇文章，都会发现更多可能已经走过的路，可能已经接近的技术，但可惜我不能与你分享这些数据。然后，它可以帮助你获得一些创造性的果汁去振兴你自己的项目。如果是这样的话，这篇博文就成功了。</p><p id="2e37" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们开始吧！</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="2a39" class="kb kc hh jx b fi kd ke l kf kg">remove(list = ls())</span><span id="4def" class="kb kc hh jx b fi kh ke l kf kg">#### LIBRARIES #####<br/>library(dplyr)<br/>library(skimr)<br/>library(DataExplorer)<br/>library(ggpubr)<br/>library(lsmeans)<br/>library(multcomp)<br/>library(car)<br/>library(emmeans)<br/>library(afex)<br/>library(lme4)<br/>library(lmerTest)<br/>library(caret)<br/>library(mltools)<br/>library(data.table)<br/>library(corrplot)<br/>library(tidyverse)<br/>library(drc)<br/>library(rsm)<br/>library(mice)<br/>library(VIM)</span><span id="9967" class="kb kc hh jx b fi kh ke l kf kg">#### DATA WRANGLING ####<br/>## the combine file is saved as /pores_2ndRUN<br/>MCT_all &lt;- read.delim("PORE_run2")<br/>MCT_all</span><span id="872d" class="kb kc hh jx b fi kh ke l kf kg">#convert to factors<br/>mydata_all &lt;- as.data.frame(MCT_all)<br/>str (mydata_all)<br/>attach(mydata_all)</span><span id="91b2" class="kb kc hh jx b fi kh ke l kf kg">## Sumarize the info<br/>group_by(mydata_all, GROUP) %&gt;%<br/>  summarise (<br/>    mean = mean (TV, na.rm = TRUE),<br/>    sd = sd(TV, na.rm=TRUE),<br/>    median = median (TV, na.rm = TRUE),<br/>    IQR = IQR (TV,na.rm = TRUE)<br/>  )</span><span id="6836" class="kb kc hh jx b fi kh ke l kf kg">glimpse (mydata_all)<br/>glimpse (MCT_all)<br/>skim(MCT_all)</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ki"><img src="../Images/33f7377ecc7f78705b9241ef4a72fd98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K5OnBpNPaHZgOdSUKcGOgg.jpeg"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">A glimpse of the data.</figcaption></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="72fb" class="kb kc hh jx b fi kd ke l kf kg">mydata_all_B&lt;-mydata_all%&gt;%<br/>  dplyr::select(-c("Number", "Dataset"))%&gt;%<br/>group_by(GROUP) %&gt;% <br/>  summarise_at(vars(TV:SD.St.Sp.), mean, na.rm = TRUE)<br/>mydata_all$ID &lt;- seq.int(nrow(mydata_all))<br/>mydata_all_B$ID &lt;- seq.int(nrow(mydata_all_B))</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ku"><img src="../Images/41cfe4c53607da2efee7819bafd9bd2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXmIERjgGpTgl2DXtcRAmg.jpeg"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">And the data much cleaner. There should be enough information included.</figcaption></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="dfff" class="kb kc hh jx b fi kd ke l kf kg">plot_intro(mydata_all_B)<br/>plot_missing(mydata_all_B)<br/>plot_boxplot(mydata_all_B, by="GROUP")<br/>plot_correlation(mydata_all_B)<br/>plot_density(mydata_all_B, geom_density_args = list("fill" = "black", "alpha" = 0.6))<br/>plot_histogram(mydata_all_B)<br/>plot_qq(mydata_all_B)<br/>plot_qq(mydata_all_B,by="GROUP")<br/>plot_scatterplot(mydata_all_B,by="GROUP")<br/>plot_scatterplot(mydata_all_B,by="TV")</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj kw kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/ba2311299276c5ee7b0a1bb8f7af0682.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*KoQZjjMI21wcdqAUb4_MRQ.png"/></div></figure><figure class="kv kj lb kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/bf531e9d830d8330b1c34565177ed3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*8WvrR4oR6Psmg_6dzEv3VA.png"/></div></figure><figure class="kv kj lc kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/21a929605077dee90431f5c069518893.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*T09zF1tMlS002AYSVypp4g.png"/></div></figure></div><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ld"><img src="../Images/7ff13fa90b8f1fac1f83d4ecb2256d9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cutgsZtPnr3jy4WBbR_E0Q.png"/></div></div></figure><div class="js jt ju jv fd ab cb"><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/dbcef8de852865bf1ba1c2e3658d6871.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*dWq4AKhGAUWW-m7RGSpmUg.png"/></div></figure><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/981b7909f21d6ed76dcca6d1eb4c6157.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*N52U4EVpr7t_VjTtQZtqTA.png"/></div></figure><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/c8df05c82d67191e477c08dc2d21f0d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ETednAd4uuL8IkalbilRvw.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx lf di lg lh">The <a class="ae li" href="https://cran.r-project.org/web/packages/DataExplorer/vignettes/dataexplorer-intro.html" rel="noopener ugc nofollow" target="_blank"><strong class="bd lj">DataExplorer </strong></a>library is a gem when it comes to exploring data.</figcaption></figure></div><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="dc03" class="kb kc hh jx b fi kd ke l kf kg">bc &lt;- preProcess(as.data.frame(mydata_all_B), method="BoxCox")<br/>BoxCoxData &lt;- predict(bc, as.data.frame(mydata_all_B))<br/>skim(mydata_all_B)<br/>skim(BoxCoxData)<br/>plot_density(BoxCoxData, <br/>             geom_density_args = list("fill" = "black", "alpha" = 0.6))</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ld"><img src="../Images/c1db1e4ff573ba00d920c26e14db72af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1KmCWnm18OjB4MqdKWXPKQ.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">From the original glimpse made of the dataset you could already see that the variables are not normally distributed. They do not have to be! However, applying <a class="ae li" href="https://www.statology.org/box-cox-transformation-in-r/" rel="noopener ugc nofollow" target="_blank">Box-Cox transformations</a> does make life easier when trying to converge models. However, I would always prefer to run a GLM model, since the transformations are done inside the model, via the link function, and so the back-transformation is much more straightforward.</figcaption></figure><p id="0a5c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们运行第一个模型，这是一个线性回归，但可以作为方差分析。它们是同一枚硬币的两面。在这里，我正在寻找作为治疗函数的感兴趣的结果之间的差异。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="af11" class="kb kc hh jx b fi kd ke l kf kg">model1 &lt;- lm(TV~GROUP, <br/>             data = mydata_all)<br/>summary(model1)<br/>par(mfrow = c(2, 2))<br/>plot(model1)<br/>anova(model1)<br/>aov.model1&lt;-aov(TV ~GROUP, data = mydata_all)<br/>aov.model1<br/>coef(aov.model1)<br/>fit_emmeans &lt;- emmeans(model1, "GROUP")<br/>cld(fit_emmeans, Letter="abcdefg")<br/>plot(cld(fit_emmeans, Letter="abcdefg"))</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj lk kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/f8accc04596a3a27b62d5c87c04b7b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*X7eIwlW7W0AkDZhTPUjgdg.jpeg"/></div></figure><figure class="kv kj ll kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/4d96f4a93f7e6714f3362fb565394555.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*E7D8dEvQ8QEgPL1z4IXeFg.jpeg"/></div></figure><figure class="kv kj lm kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/374f97b1ff9540415a84a7c84fec2c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*Nju4QvHFPRRLwFvOzUCpzw.png"/></div></figure></div><div class="ab cb"><figure class="kv kj ln kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/b42c71a9cb9e88e27c72af9849f3fe3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*sAovMCKyXSfau-GXycM3QA.jpeg"/></div></figure><figure class="kv kj lo kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/3db17dc980b5058127b7bef51598596b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*pu_6ZZMzYXpuaIi45R2nCQ.png"/></div></figure></div><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ld"><img src="../Images/c78d3a5204f21635ddda46c92aadfdb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0bc4irPrx31iRE-9bVWlQ.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">The most important plot. Differences of which the confidence interval does not include zero are significant differences. The great number of comparisons made warrant the application of a multiple-testing safeguard. Otherwise, the family type-2 error rate will no longer be 0.05 (<a class="ae li" rel="noopener" href="/mlearning-ai/inference-estimates-p-values-and-confidence-limits-a-frequentist-approach-acdd45d94bd5">and that is saying that we actually like to approach data in such a way, since it is riddles with issues</a>).</figcaption></figure><p id="609c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们还可以在测试和训练数据集中拆分数据，添加虚拟变量，并进行交叉验证，以赋予模型更多的外部有效性(通过使用内部有效性)。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="9976" class="kb kc hh jx b fi kd ke l kf kg">inTraining &lt;- createDataPartition(mydata_all$GROUP, p = .75, list = FALSE)<br/>training &lt;- mydata_all_B[ inTraining,]<br/>testing  &lt;- mydata_all_B[-inTraining,]<br/>skim(training)<br/>## One Hot Encoding<br/>training &lt;- one_hot(as.data.table(training))<br/>testing &lt;- one_hot(as.data.table(testing))<br/># Control Resampling Methods <br/>tr &lt;- trainControl(method = "repeatedcv",<br/>                   number = 20,<br/>                   repeats = 10)<br/>tr1 &lt;- trainControl(method = "boot632",<br/>                    number =1000)</span><span id="0719" class="kb kc hh jx b fi kh ke l kf kg"># Regression Model with all predictors included - high multcollinearity<br/>set.seed(1123)<br/>lm1 &lt;- train(TV~. -ID -Obj.N - Obj.V -Obj.V.1 -Obj.V.TV -Obj.S.TV -Obj.S.Obj.V -Obj.Dm -GROUP -Po.V.tot., <br/>             data=training,<br/>             preProcess=c("center", "scale"),<br/>             method = "BstLm",<br/>             trControl=tr1, <br/>             na.action = na.omit)<br/>lm1<br/>summary(lm1)<br/>plot(lm1)<br/>lm1$finalModel <br/>model1 &lt;- lm(TV ~GROUP + i.S + T.Ar + Po.V.cl.,SD.St.Sp., data = mydata_all)<br/>summary(model1)<br/>fit_emmeans &lt;- emmeans(model1, "GROUP")<br/>cld(fit_emmeans, Letter="abcdefg") # including confounders changes the ANOVA<br/>comp1&lt;-glht(model1, mcp(GROUP="Tukey")) # Comparison of diets<br/>summary(comp1)<br/>plot(comp1)</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj lp kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/93b8aabf64eaf7f68bd19e671c540006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*2NfhEyhtPrEFX7gjwxh7UA.jpeg"/></div></figure><figure class="kv kj lq kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/add6183529094d14e9407e405114919f.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*vePuQV6QOy2UDmVi15W-qA.jpeg"/></div><figcaption class="kq kr et er es ks kt bd b be z dx lr di ls lh">The type of model used here (<strong class="bd lj">BstLm </strong>which stands for Boosted Linear Model)will set the coefficient of non-important variables to zero.</figcaption></figure></div><p id="78f9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我可以使用上面的选择来运行一个新模型，然后寻找<em class="lt">组</em>的差异，包括一些协变量。</p><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es lu"><img src="../Images/b6d4a07c7bd9ccafa1852fce8bc83222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J7iD5XxveczeHMevhwg3-w.jpeg"/></div></div></figure><div class="js jt ju jv fd ab cb"><figure class="kv kj lv kx ky kz la paragraph-image"><img src="../Images/2ebd0b0f4f91e0d22b19f0a95f7a9cda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*7ls60VkMq_wRZqhJ0Kr9iw.png"/></figure><figure class="kv kj lw kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/c363ebdf4a6a2b2edc3c563069ac9ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*nC8ppWqHak3Vg3tkWUrNTA.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx lx di ly lh">Model information to the left. To the right, we have the differences between treatments. None of the differences are now significant. I guess that including some covariances made it a bit more difficult. This is good, since you do not want to make false inferences. The side of the confidence intervals is saying something as well. They are huge! That gives you something to ponder about the model itself and its usability.</figcaption></figure></div><p id="d9e9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以尝试和做的是将我们的分析集中在特定的饮食上，从而针对特定的人群。对于任何统计分析，您不需要这样做。事实上，分析数据的最好方法是尽可能全面地分析数据。但是，让我们来看看。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="197d" class="kb kc hh jx b fi kd ke l kf kg">## Extruded vs pelleting<br/>My_list2 &lt;- split(mydata_all, f = list(mydata_all$GROUP))  <br/>analysis1 &lt;- rbind(My_list2$Diet_F, My_list2$Diet_J)<br/>model1 &lt;- lm(TV ~GROUP, data = analysis1)<br/>summary(model1)<br/>par(mfrow = c(2, 2))<br/>plot(model1)<br/>fit_emmeans &lt;- emmeans(model1, "GROUP")<br/>cld(fit_emmeans, Letter="ab") # not different in univariate analysis <br/>comp1&lt;-glht(model1, mcp(GROUP="Tukey")) # Comparison of diets<br/>summary(comp1)<br/>plot(comp1)</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es lz"><img src="../Images/ef866fcb5c0869a9bda7027f2b2875e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*scbEO_Es0gwR4odbk8iLXg.jpeg"/></div></div></figure><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ma"><img src="../Images/8e07b6364ee999567b26eb6fdda8653c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HlkpZ-jSLuBxOQpvpx4NaA.jpeg"/></div></div></figure><div class="js jt ju jv fd ab cb"><figure class="kv kj lw kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/ce615502a69674e5e68dd44bfc7cf98d.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*Tk3hJczzc9kSZkgc-F60hw.png"/></div></figure><figure class="kv kj lv kx ky kz la paragraph-image"><img src="../Images/02d762eeb1353ae853138cda60c84ad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*bOQ0Qkujf8_IIJA1LLqD6Q.png"/><figcaption class="kq kr et er es ks kt bd b be z dx mb di mc lh">Model does really have a lot of datapoints, and although the difference is significant, I would not attach to much meaning to it. Who knows what a new dataset could bring to the table?</figcaption></figure></div><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="5dee" class="kb kc hh jx b fi kd ke l kf kg">model1 &lt;- lm(Obj.V/TV ~GROUP, data = analysis1)<br/>summary(model1)<br/>par(mfrow = c(2, 2))<br/>plot(model1)<br/>fit_emmeans &lt;- emmeans(model1, "GROUP")<br/>cld(fit_emmeans, Letter="ab") # not different in univariate analysis <br/>comp1&lt;-glht(model1, mcp(GROUP="Tukey")) # Comparison of diets<br/>summary(comp1)<br/>plot(comp1)</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div class="er es md"><img src="../Images/eb98f3f57c4ade78ab7a82042d3f0a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*SovBWjLaHbXozxMsZi3SPw.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx">As a ratio, the difference between groups is still significant, but the differences is starting to approach zero. Whenever you find a significant difference, you always need to ask yourself how clinically relevant that difference is. It may be significant according to frequentist theory, but economically, or clinically, it does not add anything to the table. Thats why power calculations, and pre-experiment simulations are so important.</figcaption></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="50a7" class="kb kc hh jx b fi kd ke l kf kg">analysis5 &lt;- rbind(My_list2$Diet_F, My_list2$Diet_G,My_list2$Diet_H, My_list2$Diet_D )<br/>anova1 &lt;- aov(TV ~ GROUP, data = analysis5)<br/>summary(anova1)<br/>par(mfrow=c(2,2))<br/>plot (anova1)<br/>model1 &lt;- lm(TV ~GROUP, data = analysis5)<br/>summary(model1)<br/>fit_emmeans &lt;- emmeans(model1, "GROUP")<br/>cld(fit_emmeans, Letter="abcd") <br/>comp1&lt;-glht(model1, mcp(GROUP="Tukey")) # Comparison of diets<br/>summary(comp1)<br/>dev.off()<br/>plot(comp1)</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj me kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/659df56a5a56155a700f7560adb7a814.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*wP1hzb2hjgVWF2XxUwM9Pg.jpeg"/></div></figure><figure class="kv kj mf kx ky kz la paragraph-image"><img src="../Images/c3764510778d1e016ee7c9cd6a4caf94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*oz1Ukg9IQE0UWKXv4NYOQA.png"/><figcaption class="kq kr et er es ks kt bd b be z dx mg di mh lh">And the same again, as above, but now more data included. For some reason, the plot function does not show the treatment comparisons as a whole, which is annoying, but the plot to the right is the graphical depiction of the stats to the left.</figcaption></figure></div><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="fa64" class="kb kc hh jx b fi kd ke l kf kg">c1 &lt;- TukeyHSD(anova1)<br/>c1a &lt;- as.data.frame(TukeyHSD(anova1)$GROUP)<br/>c1a$pair = rownames (c1a)</span><span id="d1ec" class="kb kc hh jx b fi kh ke l kf kg">c1b &lt;- ggplot (c1a, aes(colour=cut (`p adj`, c(0,0.001, 0.01, 1),<br/>                                   label= c("p&lt;0.001", "p&lt;0.01", "non-Sig"))))+<br/>  geom_hline(yintercept=0, lty="11", colour= "grey30") +<br/>  geom_errorbar(aes(pair, ymin=lwr, ymax=upr), width=0.2) +<br/>  geom_point(aes(pair, diff)) +<br/>  labs (x= " ", y= " ")+<br/>  labs(colour="")+<br/>  ggtitle("TV")+<br/>  theme_bw()</span><span id="9d4e" class="kb kc hh jx b fi kh ke l kf kg">c1b</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es mi"><img src="../Images/5b5db15cc363d839d16e59b65bfeda33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AD3yg8OFHa8lHH1qZ3VbDQ.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">A much more beatiful way of showing the differences between the treatments for the outcome TV (NOT television ;-) ).</figcaption></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="88cf" class="kb kc hh jx b fi kd ke l kf kg">par(mfrow=c(1,3))<br/>pelExt_control &lt;- rbind (My_list2$Diet_F, My_list2$Diet_J)</span><span id="353a" class="kb kc hh jx b fi kh ke l kf kg">p1 &lt;- ggplot(pelExt_control, aes(x = GROUP, y = Po.Dm, fill = GROUP))+<br/>  geom_boxplot(outlier.shape = NA, colour = "black") + <br/>  scale_fill_manual(values = c("#F8766D","#00BFC4"))+<br/>  geom_signif(comparisons = list(c("Diet_F", "Diet_J")), step_increase = 0.1)+<br/>  theme(legend.position = "")+<br/>  labs (x= " ", y= "Pore diammeter (nm3)")+<br/>  scale_x_discrete(labels = c("Extruded", "Pelleted"))+<br/>  ylim(10,50)+<br/>  theme(axis.title.y = element_text(size = 12, face = "bold"))+theme_bw()</span><span id="df8c" class="kb kc hh jx b fi kh ke l kf kg">p2 &lt;- ggplot(pelExt_control, aes(x = GROUP, y = Po.tot., fill = GROUP))+<br/>  geom_boxplot(outlier.shape = NA, colour = "black") + <br/>  scale_fill_manual(values = c("#F8766D","#00BFC4"))+<br/>  geom_signif(comparisons = list(c("Diet_F", "Diet_J")), step_increase = 0.1)+<br/>  theme(legend.position = "none")+<br/>  labs (x= " ", y= "Total porosity (%)")+<br/>  scale_x_discrete(labels = c("Extruded", "Pelleted"))+<br/>  ylim(3,20)+<br/>  theme(axis.title.y = element_text(size = 12, face = "bold"))+theme_bw()</span><span id="9c85" class="kb kc hh jx b fi kh ke l kf kg">p3 &lt;- ggplot(pelExt_control, aes(x = GROUP, y = Po.op., fill = GROUP))+<br/>  geom_boxplot(outlier.shape = NA, colour = "black") + <br/>  scale_fill_manual(values = c("#F8766D","#00BFC4"))+<br/>  geom_signif(comparisons = list(c("Diet_F", "Diet_J")), step_increase = 0.5)+<br/>  theme(legend.position = "none")+<br/>  labs (x= " ", y= "Open porosity (%)")+<br/>  scale_x_discrete(labels = c("Extruded", "Pelleted"))+<br/>  ylim(0,20)+<br/>  theme(axis.title.y = element_text(size = 12, face = "bold"))+theme_bw()</span><span id="7147" class="kb kc hh jx b fi kh ke l kf kg">p4 &lt;- ggplot(pelExt_control, aes(x = GROUP, y = Po.cl., fill = GROUP))+<br/>  geom_boxplot(outlier.shape = NA, colour = "black") + <br/>  scale_fill_manual(values = c("#F8766D","#00BFC4"))+<br/>  geom_signif(comparisons = list(c("Diet_F", "Diet_J")), step_increase = 0.1)+<br/>  theme(legend.position = "none")+<br/>  labs (x= " ", y= "Close porosity (%)")+<br/>  scale_x_discrete(labels = c("Extruded", "Pelleted"))+<br/>  ylim(0,8)+<br/>  theme(axis.title.y = element_text(size = 12, face = "bold"))+theme_bw()</span><span id="7057" class="kb kc hh jx b fi kh ke l kf kg">tt1 &lt;- ggarrange(p1,p2,p3,p4, ncol=2, nrow=2)<br/>tt1</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ld"><img src="../Images/58ee63c22eef2632b31fb0771131977b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n5xTj4yHmETt94HLRtP72w.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">And another beautiful way of plotting differences. I take no credit for these codes btw. They were included in the dataset that I analized and augmented. It is always great to learn from somebody else, and of course so do I.</figcaption></figure><p id="5a2d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">顺便说一句，你在下面看到的是使用线性模型进行多元分析的一种巧妙方式。通过使用<em class="lt"> cbind </em>选项，您可以让R对多个结果进行分组比较。这叫做马诺娃。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="988a" class="kb kc hh jx b fi kd ke l kf kg">model1&lt;-lm(cbind(Po.Dm,Po.tot.,Po.op.,Po.cl.)~GROUP,data=pelExt_control)<br/>summary(model1)<br/>vcov(model1)<br/>Anova(model1) #MANOVA TEST STATISTIC<br/>fit_emmeans &lt;- emmeans(model1, "GROUP")<br/>plot(cld(fit_emmeans, Letter="abcd")) +theme_bw()</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj mj kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/ea7a64e44bd8ef0805157aa940b60ee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*gEsetsX6ejVK3nkWiH-4RA.jpeg"/></div></figure><figure class="kv kj mk kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/c3d8fc05a447767c4eb7b9dc92442a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*BOrV9T5l3rNXWRJs1CZg8A.png"/></div></figure></div><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="142a" class="kb kc hh jx b fi kd ke l kf kg">MCT_all<br/>My_list2</span><span id="dff5" class="kb kc hh jx b fi kh ke l kf kg">zeolite &lt;- rbind (My_list2$Diet_A, My_list2$Diet_B, My_list2$Diet_C, My_list2$Diet_D,My_list2$Diet_E,My_list2$Diet_F )<br/>valid.names &lt;- names(zeolite)[names(zeolite) != "GROUP" &amp; names(zeolite)!="Dataset" &amp; names(zeolite)!="Number"]<br/>zeolite$GROUP&lt;-as.character(zeolite$GROUP)</span><span id="30a0" class="kb kc hh jx b fi kh ke l kf kg">mapping &lt;- c("Diet_A" = 10, <br/>             "Diet_B" = 8, <br/>             "Diet_C" = 6, <br/>             "Diet_D" = 4,<br/>             "Diet_E" = 2,<br/>             "Diet_F" = 0)<br/>zeolite$concentration &lt;- mapping[zeolite$GROUP]</span><span id="e872" class="kb kc hh jx b fi kh ke l kf kg">ggplot(zeolite,aes(x=Conn,y=TV,colour=GROUP)) + <br/>  geom_point() +<br/>  geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +<br/>  theme_bw()</span><span id="1d2e" class="kb kc hh jx b fi kh ke l kf kg">ggplot(zeolite,aes(x=concentration,y=TV,colour=GROUP)) + <br/>  geom_point() +<br/>  geom_smooth(method = lm, formula = y ~ splines::bs(x, 3), se = FALSE) +<br/>  theme_bw()</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj ml kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/e258e9b403488a8b41dd85d9acc7c505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*JLKXyVJ3JXxfy8XE7KWyYA.png"/></div></figure><figure class="kv kj ml kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/3aa8c58a4c7d9795c9ac1cb7e5a8b0f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BfOG3nSBy63anxTOcl77EA.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx mm di mn lh">I cannot say the graph to the left is helping. Splines have a tendency to connect points, no matter what, building trajectories that make no sense whatsoever.</figcaption></figure></div><p id="f410" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面是一个聪明简单的方法，根据你的数据运行一个剂量反应模型。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="fe5c" class="kb kc hh jx b fi kd ke l kf kg">model&lt;- drm(TV~concentration, data=zeolite,<br/>            fct=LL.4(names = c("Slope", "Lower Limit", "Upper Limit", "ED50")))<br/>plot(model, type="all")<br/>summary(model)</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj mo kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/34e9fa9f4e2fdba0a04d8a86dbe4513a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*ecDnCPQ5c-xpwV2-nOBulg.jpeg"/></div></figure><figure class="kv kj mp kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/11c18955d23c5bd4dfc1fa3ce16f374c.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*YMN9zC-YKnERAc7b6c1U2A.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx mq di mr lh">Looks like this, which looks good to me.</figcaption></figure></div><p id="c919" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">和一个<a class="ae li" rel="noopener" href="/mlearning-ai/surface-analysis-of-feed-data-in-fish-5e426464d2f4">响应面模型</a>，运行单阶连接。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="9354" class="kb kc hh jx b fi kd ke l kf kg">model1&lt;-rsm(TV~SO(concentration), data=zeolite)<br/>plot(model)<br/>summary(model1)</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ms"><img src="../Images/6fa72b5b45eb1b096554777482f6e5de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WaUZMyrDnq0jdyj6fNTZow.jpeg"/></div></div></figure><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="9611" class="kb kc hh jx b fi kd ke l kf kg">model2&lt;-rsm(TV~SO(concentration, TS, Po.Dm), data=zeolite)<br/>summary(model2)<br/>par(mfrow = c(1, 3))<br/>contour(model2, ~concentration+TS+Po.Dm, image=TRUE)</span><span id="2a9f" class="kb kc hh jx b fi kh ke l kf kg">model3&lt;-rsm(TV~SO(concentration, TS, Po.Dm, T.Ar), data=zeolite)<br/>summary(model3)<br/>par(mfrow = c(3, 1))<br/>contour(model3, ~concentration+TS+Po.Dm, image=TRUE)</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj mt kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/8f6061dc819ec5236f8cf6c8fd8c0c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1498/format:webp/1*4HAAO5TiuRq75LNzFPbt6g.png"/></div></figure><figure class="kv kj mu kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/5945d478b4211505fcaeb9fa24418d67.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*r48CQ1XOZqYpebGE_v6ZTQ.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx mv di mw lh">Actually looks very interesting. Not sure if the design of the study was intended to fit a response surface, but I really like what I see. A clear maximum to the left. But, also a clear sadle, and a funny looking connection which I wonder if it is not an artefact.</figcaption></figure></div><p id="d365" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面是一个不同的数据集，仍然来自fish，展示了一个输入数据的尝试。现在，数据插补本身就是一项完整的建模工作，插补本身有很大的影响。这不是你能做的事！你做的方式会影响后续的分析。因此，尽管意在减少不确定性，你还是通过测试和整合新的假设来尝试。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="d9f9" class="kb kc hh jx b fi kd ke l kf kg">library(readxl)<br/>trial&lt;- read_excel("50194 - Statistical analysis_FFA.xlsx", sheet = "Data2")<br/>trial&lt;-as.data.frame(trial)<br/>trial &lt;- trial %&gt;% mutate(imp = if_else(is.na(tank) == TRUE, 'yes', 'no'))  <br/>trial$imp&lt;-as.factor(trial$imp)<br/>## DATA EXPLORATION<br/>plot_intro(trial)<br/>plot_missing(trial)<br/>plot_boxplot(trial, by="DIET")<br/>plot_correlation(trial)<br/>plot_density(trial, geom_density_args = list("fill" = "black", "alpha" = 0.6))<br/>plot_histogram(trial)<br/>plot_qq(trial)<br/>plot_scatterplot(trial,by="DIET")<br/>plot_scatterplot(trial,by="tank")</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj mx kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/ba9975851aff5e1874523cfbb390477d.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*aFqc3YwgnO7h3YmOtgYq4g.png"/></div></figure><figure class="kv kj my kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/ec53bb99e6d3d0524d2fd65273a9486c.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*spCS7Rd_rQKoNvPnPvit9w.png"/></div></figure><figure class="kv kj my kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/f6d9e7af7dcb6936a2687ddcca51128d.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*AeJ0YvdsXGaaEf537wx4ng.png"/></div></figure></div><div class="ab cb"><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/3726bce9b205bef0296a272e6cadb512.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*iXYPezL3xpule43AALqewQ.png"/></div></figure><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/cda299a859f60e471d8287ddd9ce2614.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*cssz2CeQpiusvQ6jp6rUcw.png"/></div></figure><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/b9319755f6c6e89cf19912a32a11ec9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*2S5b1lHojQ8coNQQ30oC7A.png"/></div></figure></div><div class="ab cb"><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/80a3dd149de9769952d85b3c7e34b5bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*nRmSezTDWx-wfbVAnMtNhg.png"/></div></figure><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/4a8040657f6e1601a9529fffadd4a774.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*JrGGMkgpXejL9VZzrd_G6Q.png"/></div></figure><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/0d81c467ce80996e9fad8664c7c926b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*9utwRb3BOMA96jswP6hHIw.png"/></div></figure></div><div class="ab cb"><figure class="kv kj mz kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/78b91a090dbaccc9d76b301b55c2c95f.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*EMLE1mDc5-G6cAAfEGwJVQ.png"/></div></figure><figure class="kv kj na kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/2b5c35a3bd937aa3c33d7b053b6a5da2.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*bo3Gm3gMD4nXoYgJdymNzw.png"/></div></figure><figure class="kv kj nb kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/19b196d552917b3a2eab7f5db2b58c06.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*0S6ouZphuNbXYOYa-pkdbw.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx nc di nd lh">Again, explore your data!</figcaption></figure></div><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="2794" class="kb kc hh jx b fi kd ke l kf kg">fit&lt;-lmer(FCR1~oPorosity + (1|TRT), data=trial) # I estimate different variances per Treatment <br/>summary(fit)<br/>anova(fit)<br/>coef(fit)<br/>plot(fit) # here is where you check assumptions of normality and homogenity of variance <br/>require("sjPlot");plot_model(fit, type="diag")</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj ne kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/d1c81a12e21b59b349edec7654377119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*8JCPEShjAyiwl-MkymM70g.jpeg"/></div></figure><figure class="kv kj nf kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/6c78b1e4c9395cb95a3df14162b302cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*1IE2TlVYwego13GfRxQS7g.jpeg"/></div></figure></div><div class="ab cb"><figure class="kv kj ml kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/b0f6d6e2aa5dc6cd0f65f8ce86950de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*tHrnd1oaJFnH27tpyrIXTA.png"/></div></figure><figure class="kv kj ml kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/f20239ab29b9d748047482e2e5255f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*qFypG-bCSF16vhGkVQACmw.png"/></div></figure></div><div class="ab cb"><figure class="kv kj ml kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/a1199006a366b0c6b2d6808b1af86062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*kYpPpfdF60-bFOoIcrgi-g.png"/></div></figure><figure class="kv kj ml kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/6e35d51da0eb3b8fb91ca0b6a9b03a5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BVnn-WYwU8rCozJAym4c6Q.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx mm di mn lh">Mixed Models looks good given the sparse data included.</figcaption></figure></div><p id="b511" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有两个主要的包装，可以用来填补空白。一个是<a class="ae li" href="https://topepo.github.io/caret/" rel="noopener ugc nofollow" target="_blank"> <strong class="iy hi">脱字符</strong> </a> <strong class="iy hi">包</strong>这是一个构建预测模型的标准。下面你可以看到一个我的例子，包括一个K-最近邻插补算法，然后检查它是否有意义。似乎是这样的，但是，使之有意义并不是插补模型的最大目标。这实际上是危险的，因为你试图去填充那些你永远无法证实它是否真实发生过的东西。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="18e0" class="kb kc hh jx b fi kd ke l kf kg">fit2&lt;-lm(FCR1~oPorosity, data=trial) <br/>summary(fit2)<br/>require("jtools");plot_summs(fit, fit2, scale = TRUE, plot.distributions = TRUE)<br/>## Quick way to do imputation<br/>knn_imp &lt;- preProcess(trial, method="knnImpute", k=2)<br/>trial_imp &lt;- predict(knn_imp, trial)<br/>skim(trial)<br/>skim(trial_imp)<br/>plot_boxplot(trial_imp,by="imp") # check imputation<br/>ggplot(trial_imp, aes(x=FCR1, y=FCR2, colour=imp))+<br/>  geom_point()+<br/>  facet_grid(cols = vars(TRT))+<br/>  theme_bw()</span></pre><div class="js jt ju jv fd ab cb"><figure class="kv kj ng kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/cefd6d08a80bef23eb67a132b6ad9155.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*nij4TXihwBSDds0n2hQlBQ.png"/></div></figure><figure class="kv kj nh kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/1ced85e0d710ddbb25058300bda8361f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*2zqZF-gyvANmpiUculZA1A.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx ni di nj lh">To the left, you can see the difference of a mixed model and a standard linear model. The mixed model is much less uncertain, probably because including a variance component reduced the residual component. To the right, you see the imputations per group for the outcomes of interest. Looks good! BUT, as a said, looking good does not automatically mean it is good.</figcaption></figure></div><p id="040d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，就多重插补而言，我所知道的最大的软件包是<a class="ae li" href="https://cran.r-project.org/web/packages/mice/mice.pdf" rel="noopener ugc nofollow" target="_blank">鼠标软件包</a>。它已经存在很多年了，但是它很坚固。这里的例子是一个非常小的例子，我可以花至少10篇博客文章在鼠标上。</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="bcb3" class="kb kc hh jx b fi kd ke l kf kg">md.pattern(trial)<br/>aggr_plot &lt;- aggr(trial, col=c('navyblue','red'), <br/>                  numbers=TRUE, sortVars=TRUE, labels=names(data), cex.axis=.7, <br/>                  gap=3, ylab=c("Histogram of missing data","Pattern"))<br/>marginplot(trial[c(40,41)]) # Not informative because they have missing at the same place <br/>histogram(~ oPorosity | is.na(FCR2), data=trial) # oPorosity for missing and non-missing FCR2<br/>histogram(~ cPorosity | is.na(FCR2), data=trial) <br/>histogram(~ tPorosity | is.na(FCR2), data=trial)</span><span id="7f48" class="kb kc hh jx b fi kh ke l kf kg"># impute the data - once again, all missing on the same place <br/>trialMICE &lt;- mice(trial,<br/>                 m=5,<br/>                 maxit=50,<br/>                 meth='pmm',<br/>                 seed=500) #pmm is a fast good approximation for sparse data<br/>summary(trialMICE)<br/>plot(trialMICE)<br/>trialMICE$meth <br/>xyplot(trialMICE,<br/>       oPorosity ~ FCR1+FBW+SGR+WG,<br/>       pch=18,cex=1,<br/>       na.group = imp)<br/>densityplot(trialMICE, ~FAT1 |.imp)<br/>stripplot(trialMICE, FAT1 + ASH1 + MOISTURE1 ~ .imp, layout = c(3, 1))<br/>completedData &lt;- complete(trialMICE,1)<br/>ggplot(completedData , aes(x=FCR1, y=FCR2, colour=imp))+ # makes the same mistakes as knnIMpute<br/>  geom_point()+<br/>  facet_grid(cols = vars(TRT))+<br/>  theme_bw()</span></pre><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es nk"><img src="../Images/feed2d34ad18c12a8aff836adbf6f56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVj_iQhkA905_U4rzmfSCw.jpeg"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">What I ask MICE to do is to fill in the missing data by looking, just like KNN, at datapoints nearest to the missing data. Since MICE uses all the viable information available, it will look at the specific column of interest and neighbour columns. That is also why it uses chains, like Bayesian Analysis, to find a solution. It needs to constantly shift between a past, present, and future state.</figcaption></figure><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es ld"><img src="../Images/b8c1247d1514fe8ec16c6f6b39b33e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vs3YEedKeRkhHIuvLBrIJA.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">Missing data pattern.</figcaption></figure><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es nl"><img src="../Images/214347c13a1abc594b92c2b75341ad5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3tYe7T7bKH71aDza4gWRNA.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">Looking at points missing for one of the outcomes of interest. Often, when trying to connect dots between two or more variables, you see a difference in one variable if the other one is missing and vice versa. If that IS the case, that variable becomes important information to imputing the missing data at the other variable.</figcaption></figure><div class="js jt ju jv fd ab cb"><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/5a5ec574fad4f363c09432e0443cc2f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*_1jLqOSB6UiKqwYkfKFatQ.png"/></div></figure><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/6ad70f5904234b4b79c49a9ec3d2da7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*BmEeq6Qu-UThUBn4npnjlQ.png"/></div></figure><figure class="kv kj le kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/a4fd17bfe49e985d5bf6a2661347cd82.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*lGi-kPWLXwoy46OMZk6Ncg.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx lf di lg lh">The same as above.</figcaption></figure></div><figure class="js jt ju jv fd kj er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es nm"><img src="../Images/50a13dabcaf6e7efbb4864fbb7bf8352.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PkUxGUpbIW6dNN2GVlDNQw.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx">Observed and imputed data. Only really visible for WG, since they have a slightly lower color.</figcaption></figure><div class="js jt ju jv fd ab cb"><figure class="kv kj nn kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/6d517550adba4d85b39ed0ff05b4238b.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dR8yFiDdkTDLKfiyzFKm5w.png"/></div></figure><figure class="kv kj no kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/9bffc51ff6ee695da238fceb3d30ea20.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*yQJ53dwPdAwLvP9W_66vSg.png"/></div></figure><figure class="kv kj np kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/4521e03ba2fe7e841b7193be35ed29b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*HaAaRHZOtoYeVBUiqSqLeg.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx nq di nr lh">Convergence of the chains. Like always with chains you want to see NO pattern.</figcaption></figure></div><div class="ab cb"><figure class="kv kj ns kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/69a2a4a0020ec1430cf0cbb6c3231a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*sC-_yKFdgZXVATgC885UCw.png"/></div></figure><figure class="kv kj nt kx ky kz la paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/5b21ea3d66d30b6460d148159e6ab3be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*UKcOda-txNPfZ6T6u4QPxg.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx nu di nv lh">Distribution of observed and imputed datapoints. When using PMM (Predictive Mean Matching), you will always end up with datapoints that are close in proximity to other datapoints. This is what makes it a swift algorithm to use, with components that seem to make sense, but which is not always the best approach. It could very well be that your missing points come from a completely different procedure, which you actively need to model.</figcaption></figure></div><p id="2556" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以，这就是我这篇博文的结尾。就像我说的，没有确定的答案，更多的是尝试处理数据集的不同方法的集合。可以做的，或者应该做的要多得多，但这意味着要写得更多。我相信，作为一名数据分析师，你理解有时放手的痛苦。改天再来。</p><p id="819a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">再说一次，如果有什么不对劲，请让我知道！</p><div class="nw nx ez fb ny nz"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="oa ab dw"><div class="ob ab oc cl cj od"><h2 class="bd hi fi z dy oe ea eb of ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="og l"><h3 class="bd b fi z dy oe ea eb of ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="oh l"><p class="bd b fp z dy oe ea eb of ed ef dx translated">medium.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ko nz"/></div></div></a></div></div></div>    
</body>
</html>