# 预测银行营销成功的数据驱动方法

> 原文：<https://medium.com/mlearning-ai/data-driven-approach-to-predict-success-of-bank-marketing-31791cad8f81?source=collection_archive---------0----------------------->

![](img/d6141f50bc079d7323afdb10aa5fa56a.png)

**简介**:旧的营销方式对银行业务的增长贡献甚微。由于内部竞争和金融危机，欧洲银行面临着增加金融资产的压力。他们使用直接营销策略向人们提供利率良好的长期存款，但联系许多人需要很多时间，成功率也较低。因此，他们希望借助这项技术提出一种解决方案，通过减少呼叫次数来提高效率，同时提高成功率。葡萄牙银行机构提供了与接管电话营销活动相关的数据。

**目录**

一、业务问题

二。机器学习问题

三。数据集概述

四。绩效指标

动词 （verb 的缩写）探索性数据分析

不及物动词预处理

七。数据建模

八。模型比较

九。模型部署

x.进一步的改进

xi。参考

**业务问题:**找出帮助银行使客户成功认购存款的特征，这有助于有效地增加活动并选择高价值客户。

**机器学习问题:**目标是建立机器学习模型，学习未知模式、地图和几个输入特征，对客户是否会认购长期存款进行分类。

**数据集概述:**

该数据与一家葡萄牙银行机构的直接营销活动相关。营销活动以电话为基础。通常，同一客户需要多个联系人，以便了解产品(银行定期存款)是(“是”)还是(“否”)。

[数据集](https://archive.ics.uci.edu/ml/datasets/Bank+Marketing)取自 UCI 机器学习知识库:

1)包含所有示例的 bank-additional-full . CSV(41188)，
2)包含 10%示例的 bank-additional . CSV(4119)。

**属性信息:**

**输入变量:**
**#银行客户数据:**
1 — **年龄**(数字)
2 — **职务**:职务类型(分类:‘行政。’、'蓝领'、'企业家'、'女佣'、'管理'、'退休'、'自雇'、'服务'、'学生'、'技术员'、'失业'、'未知')
3 — **婚姻**:婚姻状况(分类:'离婚'、'已婚'、'单身'、'未知')；注:'离异'指离婚或丧偶)
4 — **学历**(分类:' basic.4y '，' basic.6y '，' basic.9y '，'高中'，'文盲'，'专业.课程'，'大学.学位'，'不详')
5 — **默认**:有信用违约？(分类:'否'，'是'，'未知')
6 — **住房**:有住房贷款？(分类:'否'，'是'，'未知')
7 — **贷款**:有个人贷款？(分类:'否'，'是'，'未知')
#与当前活动的最后一个联系人相关:
8 — **联系人**:联系人通信类型(分类:'手机'，'电话')
9 — **月**:一年中的最后一个联系人月份(分类:'一月'，'二月'，，…，'十一月'，'十二月')
10 — **一周中的某一天**:一周的最后一个联系人日期(分类:'星期一'，'星期二'，'星期三'，'星期四)

**重要提示:该属性对输出目标有很大影响(例如，如果持续时间=0，则 y= '否')。然而，在执行呼叫之前，持续时间是未知的。还有，结束通话后 y 显然是已知的。因此，该输入应仅用于基准测试目的，如果目的是获得现实的预测模型，则应丢弃。**

**#其他属性:**
12 — **活动**:该活动期间针对该客户执行的联系次数(数字，包括最后一次联系)
13 — **pdays** :自上次活动联系该客户后经过的天数(数字；999 表示以前没有联系过客户)
14 — **以前**:在此活动之前为该客户进行的联系次数(数字)
15 — **poutcome** :以前营销活动的结果(分类:“失败”、“不存在”、“成功”)

**#社会经济背景属性**
16 — **emp.var.rate** :就业变动率—季度指标(数字)
17 — **cons.price.idx** :消费者价格指数—月度指标(数字)
18 — **cons.conf.idx** :消费者信心指数—月度指标(数字)
19—**euribor 3m**:euribor 3 个月率—每日指标

**输出变量(期望目标):**
21 — **y** —客户是否已办理定期存款？ (二进制:“是”、“否”)

**绩效指标:**

不同的性能指标被用来评估机器学习模型。基于我们的任务，我们可以选择我们的性能指标。既然我们的任务是分类，那也是二元分类，不管客户会不会认购存款。

**主要绩效指标**

这里我们将使用 AUC ROC 曲线。

**什么是 ROC？**

ROC 也称为接收器操作特性，显示了二元类分类器在所有可能的阈值范围内的性能，绘制在真阳性率和 1-假阳性率之间

**什么是 AUC-ROC？**

AUC 测量两个给定随机点的可能性，一个来自阳性，一个来自阴性，分类器将阳性点排列在阴性点之上。AUC-ROC 是流行的分类度量，其优点是独立于假阳性或假阴性点。

**理想的 AUC-ROC 评分为 1。随机分类器的 AUC-ROC 评分为 0.5。**

**二级绩效指标**

**宏观 F1 评分:** F1 评分是精度和召回率之间的调和平均值。宏 F1 分数用于了解我们的模型在整个数据集中如何工作。

**混淆矩阵**:该矩阵给出了真阴性、真阳性、假阳性和假阴性数据点的计数。

**EDA:**

**在继续之前，让我们先了解一下什么是 EDA？**

EDA 是一种解释、总结和可视化数据集信息的方法。它可以帮助我们找出可能不被理解或不可见的模式和关系。这是数据科学生命周期中最重要的事情之一。

让我们检查数据集中缺失的值。

![](img/d69046906be20f5a27aaed12b9e42178.png)

正如我们所看到的，数据集中没有缺失值。我们不需要估算任何缺失值。

让我们看看我们的目标变量，即 y 分布是什么样的。

![](img/7aa109ea9ee29ab8089c4191057c2a5d.png)

从上面的图中，我们可以观察到我们的数据集非常不平衡。大多数数据点不属于任何类别。没有课和有课的比例是 8:1。

让我们开始对数据点的其余列进行 EDA。

1.职位

![](img/a9e4cb73c57151d5c047751304b02cf7.png)

从上面的图中，我们可以观察到银行更多地联系了从事管理工作的人。工作不明的人很少。让我们检查一下乔布斯向哪些人认购了存款。

![](img/8d141aff07db8b61f8015be9d0d76c2e.png)

从上面的图中，我们可以观察到从事管理工作的人比其他职业的人认购了更多的存款。

2.婚姻的

![](img/0354548c1a669fa4bd4ab8e80441b3c4.png)

结了婚的人，银行联系的比较多。大约 0.2%的人的婚姻状况银行不知道

![](img/55f3ed5bc37c169a068171732cdc7ead.png)

已婚的人比其他婚姻状况的人有更多的存款。他们也是拒绝银行存款最多的人。

3.接触

![](img/1dc351e337b6cfa7509af1ab46b7ed2f.png)

大多数人更多的是通过手机联系，而不是电话。

![](img/858d0b797aee4c8d1c828e2360144694.png)

银行通过手机联系的人比通过电话联系的人更多地认购了银行提供的存款。

4.教育

![](img/be9fe670bb4d1ca6e9cb801393cea8d1.png)

银行接触的以大学学位为学历的人比任何其他学历的人都多。银行没有接触过文盲。

让我们来看看有多少具有这种教育资格的人在数量上更多，他们是否认购了存款。

![](img/724d831529d1f0bd8631f64d3db4500a.png)

具有大学学历的人是存款的最大认购者。也是没有认购存款最多的。

5.默认

![](img/88b760606c6c54b30295e0143f55acd9.png)

我们可以清楚地看到，默认状态为“否”的人是银行联系存款最多的人。银行根本没有联系过默认状态为“是”的人。而银行联系的违约情况不明的人很少。

![](img/fd934dab8c9def6ffb96efb482dd45c0.png)

默认状态为“否”的人是拥有和没有订阅银行存款的最多的人。

6.房屋

![](img/d4d824be016f0ea730e3648c68d34a02.png)

银行联系最多的是有住房贷款的人，其次是没有住房贷款的人。极少有住房贷款状况不明的人在场。

![](img/a0aa89b654b3187c9ad2c3e1b6ba38be.png)

有住房贷款的人是认购存款最多的人。他们也是没有认购存款的最多的人。极少有住房贷款状况不明的人认购了银行提供的存款。

7.个人贷款

![](img/7ad3815f1a368a3da014b299e9fae05b.png)

没有个人贷款的人是银行联系存款最多的人。银行很少联系有个人贷款的人要存款。

![](img/8fdc8c1b9ad9571ae7f0fdbd059dbe1c.png)

没有个人贷款的人是最没有认购银行提供的存款的人。没有个人贷款的人也是认购存款最多的人。极少有个人贷款不明的人认购了存款。

8.月

![](img/0c8ac0c7f0e9f2cce3233cf3c63f043a.png)

人们在五月接触的次数更多，其次是七月、八月、六月。12 月份联系的人很少。一月和二月都没有联系到人。让我们检查一次。

![](img/a89e425611bdf5fe403e3dc86904115b.png)

一月和二月都没有联系到人。

![](img/5a6b51ec3ad8e3c4d992095017f35d9f.png)

联系的人可能有更大的机会认购长期存款，但也有更大的机会不认购长期存款。在 12 月、3 月、9 月、10 月联系的人很少，他们认购或不认购存款的机会几乎相等。

9.星期几

![](img/a04edb547d3579d85a64e1aa037e3025.png)

周六周日一直没联系人。整天休息，银行联系的人数几乎一样。

![](img/6bbccff026c2591002c97e5ced1b06d0.png)

在所有的日子里，他们都有同等的机会认购和不认购定期存款。星期几可能对预测客户是否会认购长期存款没有太大帮助。

10.先前营销策略的结果(Poutcome)

![](img/f1cf04820a1a290e4c65eb2b2ec77368.png)

从上面的情节可以明显看出，前一场战役的大部分结果是不存在的。很少有人从以前的营销策略中获得存款。

![](img/2a46ebda5c78dda38f8b3351c7145630.png)

从上面的情节来看，先前结果不存在的人实际上比属于先前结果的任何其他组的人订阅得更多。在先前结果为成功的一组人中，人们实际上比没有认购存款的人认购了更多的存款。

对于数值数据，我们将绘制 kdplot、带有色调的 violinplot 和带有色调的 kdplot。

11.年龄

![](img/c76075379b6fb2f8791e6dd4a0380e1d.png)

从上面的图来看，这是一个右偏曲线图，而且在 60 岁以后，可能会出现异常值。

![](img/5d0af5675bd2685965f36a28b30eb534.png)

从上面可以清楚地看到，这两个类都存在异常值。在无类中，异常值出现在 70 岁以上，在有类中，异常值出现在 75 岁以上。没有等级的中位数是 40 左右，有等级的中位数也是 40 左右。此外，可以看出 IQR 范围几乎重叠，因此年龄可能对预测分类标签没有太大帮助。

![](img/36d11e6cba1ee59afa28119ab1656135.png)

用色调绘制 kdeplot 作为类别更清楚的是，年龄可能对类别标签的预测没有太大帮助，因为有太多的重叠。60 岁以后可能是我们的异常值，没有太多的重叠。

12.持续时间

![](img/975c5783832c78ceb187dcbb3cd8d7c8.png)

从上面的图可以清楚地看出，从大约 1500 年的持续时间开始，出现了异常值，这是一个右偏数据。

![](img/81dcbdd262c211ed518c4f33ee893cd1.png)

类别标签为“否”的任何呼叫持续时间超过 1000 将被视为异常值，而类别标签为“是”的呼叫持续时间超过 1500 将被视为异常值。

![](img/a0cc74e8b5a2cf261bcbec7177a2c6ab.png)

从以上 3 个图可以明显看出，持续时间特征在预测类别标签方面非常有帮助。研究论文中也提到了这一点，但要制作现实的预测模型，我们不必使用该列。与未认购长期存款的人的通话持续时间大多在 0-1000 英镑之间，与已认购的人的通话持续时间在 0-2000 英镑之间。

13.运动

![](img/9623b487afe10de98e9038534cbd0ce2.png)

从上面的图来看，异常值可能出现在活动数 10 之后。

![](img/f9eb7e0d38fdf53e10dc56e60300aa21.png)

当活动数量超过 10 个时，不管任何类别标签，都存在异常值。

![](img/651379be882cc739e75125cb100df72b.png)

从上面的图中可以看出，虽然存在异常值，但是有很多重叠

14.银行在之前的活动中最后一次联系客户后经过的天数(Pdays)

![](img/6931c468810479c76fdde0bd5ad0fc60.png)

从上图可以看出，大多数 pdays 值是 999，这意味着银行还没有联系大多数客户。

![](img/b7ff2d077eadd7d91a49219461d1d6b1.png)

从上面的图中可以看出，不管阶级标签如何，大多数人都没有与银行联系过。银行已经联系了很多人，上一次活动过去的天数在 0-100 天之间。这意味着我们要么计算 pdays，要么删除 pdays，这取决于值的百分比。

![](img/cda5d4597aaab039c43c39644189be48.png)

Pdays 只能在值介于 0–200 或 999 之间时用于预测分类标签。

15.上一次(在此活动之前为特定客户联系的人数)

![](img/3d095f729ec5e714681e8a9546701c24.png)

从上面的图中可以看出，在数字 4 之后可能存在异常值。让我们检查小提琴的情节。

![](img/174f40bad0ec25a2fde4e42a08179577.png)

根据上面的 violin 图，对于任何类别标签，大于 4 的前一个都是异常值。

![](img/6af87770b047c79bef6473270232753d.png)

从上图可以看出，前面的数字 0 可能有助于预测客户是否会认购存款。

16.电磁脉冲。变化率

![](img/9fafc5e276742d1fd2932aaf94557c7d.png)

从上面的图中可以看出，不存在异常值。用小提琴剧情来确认一下吧。

![](img/e62bcefafe0ae8b77563d0edea6bf30f.png)

不存在异常值

![](img/d95d4371ee285fe662bdb8efd430cfeb.png)

正如我们所看到的，emp.var.rate 将非常有助于预测类别标签。

17.缺点。Price.Idx

![](img/3ba2ceca09de162db2f42962a0d2aeca.png)

从上面的图中我们可以看到，没有异常值存在。让我们策划小提琴阴谋

![](img/820677499a2ae1874a84c2c45b75780a.png)![](img/f66676858dd1711cc492e732bcef9080.png)

Cons.price.idx 将有助于预测类别标签，并且不存在异常值。

18.Euribor3m

![](img/96b668ae8dc34771f0faed73f2792958.png)![](img/52c8a34de74e72ab621cb2aa1d0ef335.png)![](img/db0927d091517b3d238871f941c1f806.png)

从上图可以看出，Euribor3m 有助于预测类别标签，并且不存在异常值。

19.近被雇用的

![](img/c811a1fbd5ac53a15c30e865028716e6.png)![](img/4e17aac2e14ad39525c4497083d9e759.png)![](img/5d4a3b235ffe1fb90e25eba71b11f024.png)

从上图中可以看出，不存在异常值，该特征也有助于预测分类标签。

20.缺点。会议 Idx

![](img/27a4b358fba629da2496810862dc1810.png)

从上面的图来看，可能存在异常值的情况。我们去找小提琴手

![](img/820677499a2ae1874a84c2c45b75780a.png)

对于无类，值大于-30 的 cons.conf.idx 可能是异常值。

![](img/4b00b691e00644f6a124edec4acbd765.png)

从上面的图中可以看出，该特征有助于预测分类标签。

让我们检查数字特征之间的相关性

![](img/e90d148ca744b7d8c7875b552abdaf9f.png)

就业率、euribor3m、就业人数和物价指数具有很高的相关性。 **Euribor3m** 与 **nr.employed** 和 **emp.var.rate** 与 **nr.employed** 与**相关性最高**与超过 **0.9** 的值。

## **特征工程及其 EDA:**

特征工程是将数据转换为特征的过程，可在未知数据中改进模型的预测和性能。

1.将年龄转换为年龄组

这里我把我的年龄从数字转换成年龄组(分类数据。)

在这里，我创建了从最小年龄 10 岁到最大年龄 100 岁的 9 个组。创建后，将年龄组插入数据框并从数据框中删除年龄列。

让我们绘制图表

![](img/652df96881a380e318d64dc43c94e2af.png)

银行接触的大多数人年龄在 30-39 岁之间，其次是 40-49 岁。

![](img/dae97e2f2d1dd203d4a9116cc3bd9c0b.png)

30-39 岁的年龄组是没有认购存款的大多数人。他们也是认购存款最多的人。

其他与 age_group 相关的 eda，请翻阅笔记本。

2.创建 I_loan

此功能将涉及个人或住房贷款或两者都没有。

**步骤-1** 。如果某人有住房贷款或个人贷款- > I_loan=Yes

如果人员没有个人贷款或住房贷款-> I _ loan =否

如果个人住房贷款和个人贷款状态未知->I_loan=Unknown

**步骤-2** 将 I_loan 插入数据帧

**步骤 3** 从数据框中删除住房和贷款列。

![](img/4bc34ff481d17eb5b4c354a81e353b05.png)

从上面的图中我们可以看到，有贷款的人更多，其次是没有贷款的人，很少有人贷款情况不明。

![](img/7f34a550e5735d3c4bdf7272fa81ab53.png)

有贷款的人大多数是认购存款的人。他们也是没有认购存款的人。

其他与 i_loan 相关的 eda，请翻阅笔记本。

**预处理:**

让我们检查数据中是否有重复的值。

![](img/c7b3f9534ec49de04cdb1595abdd9020.png)

有 27 个数据是重复的。现在在参数中，我们给 keep=last，原因是，我们希望在数据中有最近记录。应删除较旧的重复数据。

删除重复数据

![](img/4fdf5d99973ee1798d5dc17037f4c9c3.png)

删除重复值后，我们的数据形状为(41161，20)

现在，我们将把我们的目标值“是”映射为 1,“否”映射为 0。

![](img/4c92dcbdec7c35134b983f5ef9d316ce.png)

让我们将目标变量从数据框中分离出来，并删除目标变量

![](img/f493075349bc9ec3b353ec8abbf0cfe7.png)

将数据集分成训练、交叉验证和测试

![](img/c3c120e7a3b49f620272918623e193e4.png)

数字特征的特征缩放

进行对数转换的原因是，我们的大多数数据集是右偏的。对于对数转换，我们需要添加一些常数，以避免在特性中获得 NAN 值。这里我添加了 100，因为值小于 100，Euribo3m 特性得到了 NAN 值。

分类特征的编码

1.  一个热编码:一个热编码为每个类别创建列，并检查该类别是否出现在该行中。如果类别存在，它将被标记为 1，否则为 0。

2.响应编码:特征的响应编码所涉及的步骤。

1.我们将通过传递训练、目标标签来拟合我们的训练数据集。

2.我们将尝试为训练数据集的每一列获取类别。

3.基于类别，我们将进行迭代，并尝试获得每个目标标签的概率，并返回每个类别的概率得分字典

4.为了转换交叉验证和测试数据集，我们将传递类别标签字典。

5.我们将检查字典中是否存在该类别。如果存在，我们将传递字典中存在的值。如果不是，我们将放 0.5 值并返回转换数据集的字典。

6.基于字典中的值映射数据帧中的值

7.对于每一列，我们将有 2 个基于类标签的列，其中类标签为 1 的列有不同的计数，类标签为 0 的列有不同的计数。

**数据建模:**

在这里，我们将使用不同的机器学习模型，并检查哪些模型表现更好。让我用步骤给你解释一下。

1.由于 pdays 有大约 70%的数据被破坏并标记为 999 个值，我们可以估算这些值或删除此列。我删除了 pdays 列，并检查了我的模型的性能

2.持续时间功能将仅用于基线模型。因为为了使我们的模型更真实，我们将删除其他机器学习模型的列。

3.模型的超调已经完成，使用校准的分类器，其中交叉验证数据集用于获得最佳超参数。

4.在获得最佳超参数后，使用训练和测试数据集来评估模型性能

5.数字数据的特征缩放仅适用于线性模型。基于树的模型不需要特征缩放，并且对异常值也是鲁棒的。

6.对于分类数据的每种编码，我们都使用模型来比较哪种编码效果更好。

7.由于我们的数据集是高度不平衡的，我使用 class_weight='balanced '作为参数在内部平衡数据集。

**需要校准分类器**

非线性模型如(KNN，基于树的模型)预测未校准的概率。虽然模型预测概率，但它们可能与训练中观察到的概率不同。它需要调整，这是通过校准来完成的。

**带持续时间的基线模型。**

对于基线模型，我们将使用虚拟分类器

1.  一个热编码。

![](img/4bb283d917286e5d782db177badb8df5.png)![](img/44123ee2aeda2188ce093d6bdac0b901.png)

Strategy with Stratified has the best AUC score among other strategies.

![](img/19dbd736fa021480a9340908ff010b41.png)

2.响应编码

![](img/b3f6a7e784e85e3730197aff2c7c5de8.png)![](img/9bdb494b0e16dc42c50fecb978e80b0f.png)

我们其他不考虑编码的机器学习模型应该比我们的基线模型表现得更好。

**模型评估**

使用随机搜索交叉验证对所有模型进行超调。

1.  一个热编码。

一. KNN:

![](img/4ae986487fbd95028f67dfbd4572cc9b.png)![](img/e99845bfed5291e989a5021020a4483a.png)

二。逻辑回归:

![](img/da28bf4d663904dc6a025de048c1ddd2.png)![](img/2ae2f716c5c9a55b928a4c7f3fa4ff7f.png)

三。带 Logloss 的 SGD

![](img/e93209a038aba12aa4d8cae46b9072e1.png)![](img/e7b5418c8c39a71dea109db2cf0f3e01.png)

四。带铰链损耗的 SGD

![](img/7fbed4d3385392abc8900b3975f894e7.png)![](img/9ba676bd10eeabead190db23810a4408.png)

动词 （verb 的缩写）随机森林

![](img/03aa8004c76d675f2e61b220ed8f0be2.png)![](img/27c3707401c7d5ccc3986476b2c38a39.png)

不及物动词 XGBoost

![](img/197b32eeb373fd4e9f336e21d2a659f9.png)![](img/171f3a1ecc5880eb086eef563682fda8.png)

七。adaboost 算法

![](img/956e3ff4424854ed133b27942c5922b4.png)![](img/d7dd6b2b6b53c41ac9ec09a3026eb81d.png)

2.响应编码

一. KNN

![](img/3701f711c736d68e769ba85f8b26b475.png)![](img/dc947c9cc0759877b511c12ec4944f27.png)

二。逻辑回归

![](img/345a4663262d7aa3ed5a9623dc87b4f8.png)![](img/c689234fc4e56cc113a1a4655df39aae.png)

三。日志丢失的 SGD

![](img/2f19bd9d541ad4c2934f591e481c1235.png)![](img/4fc7c3c3887503f7c5c7c21490cdaea4.png)

四。带铰链损耗的 SGD

![](img/c419c9fcbc9034f7e189786f247d03af.png)![](img/dfbfd017f285ca1191d10c8d8910190e.png)

动词 （verb 的缩写）随机森林

![](img/eae4e4eec39dfc2cb8e67910306b7411.png)![](img/1297ca5c6de1db12af5e9a69a4fbecf7.png)

不及物动词 XGboost

![](img/e2ae301fe2aeadb0b843e5706f3a448a.png)![](img/bd23392a5311e89cb081a7ddaeb8d058.png)

七。adaboost 算法

![](img/142e9fcde872fe63de5c7912102e9820.png)![](img/7d4c190c8a6f821c3dfca79144aae990.png)

现在，我们将使用响应编码构建自定义堆栈。

自定义堆叠。

构建自定义堆栈涉及的步骤。

1.以 80:20 的比例将数据集分成训练和测试

2.以 50:50 的比例将训练数据集分成数据集 1 和数据集 2

3.数据集 1 将用于训练我们的基础学习者。这里我们的基础学习者是决策树。对于 n 个基础学习者，将使用带有替换的采样来创建 n 个采样数据集。

4.经过训练的基础学习者的对象将被存储到列表中。

5.现在数据集 2 将用于预测 n 个预测。

6.在从基本学习器获得 n 个预测后，它将被堆叠并用于训练我们的元分类器。

7.在这里，我们的元分类器是逻辑回归，这是超调。

现在，我们的测试数据集将用于从元分类器获得最终预测

自定义堆叠的布局:

![](img/1467bea49f95959546dee5f4c0fbd52c.png)

image source: [https://www.geeksforgeeks.org/stacking-in-machine-learning-2/](https://www.geeksforgeeks.org/stacking-in-machine-learning-2/)

在这里，我使用了 200 个决策树作为我们的基础学习器来获得预测。

![](img/1f2aacf71765fd36d41183085b3cc272.png)![](img/a5b23aa3bd9d415e7575c11a679fd92a.png)

**型号对比**

让我们比较一下我们的模型，并检查哪种模型应该用于部署。

![](img/4bca791f9c40754468293d10eefcf315.png)

从上面我们可以看到，在其他模型中，带有 XGBoost 和响应编码的模型具有最好的 AUC。我们将使用 joblib 库保存 xgboost 来预测数据。

![](img/d969501c8c1c137d30af3eee81cd1c8f.png)

**模型部署**

该函数将数据点作为输入，并返回预测值。我已经在本地系统上部署了我的模型。

这是我的模型部署的 YouTube 视频。

**进一步改进**

1.我们可以通过使用不同的插补方法来插补约 70%的值为 999 的 pdays。

2.为了平衡数据集，我们使用了 class_weight='balanced '。我们可以使用不同的采样技术来平衡数据集，这可能会进一步提高我们的 AUC 分数。

3.我们在非常有限的数据集上训练了我们的模型。为了提高我们的 AUC 分数，我们可以使用深度学习技术，这需要更多的数据集来进行训练。

**参考文献:**

1.  将年龄转换为分类年龄:[*https://www . absent data . com/pandas/pandas-cut-continuous-to-categorical/*](https://www.absentdata.com/pandas/pandas-cut-continuous-to-categorical/)
2.  模型超调:[https://towards data science . com/machine-learning-case-study-a-data-driven-approach-to-predict-the-success-of-bank-tele marketing-20 e 37d 46 c 31 c](https://towardsdatascience.com/machine-learning-case-study-a-data-driven-approach-to-predict-the-success-of-bank-telemarketing-20e37d46c31c)
3.  模型部署:[https://www . applieddaicourse . com/lecture/11/applied-machine-learning-online-course/4148/hands-on-live-session-deploy-an-ml-model-using-flask-APIs-on-AWS/5/module-5-feature-engineering-production ization-and-Deployment-of-ml-models](https://www.appliedaicourse.com/lecture/11/applied-machine-learning-online-course/4148/hands-on-live-session-deploy-an-ml-model-using-flask-apis-on-aws/5/module-5-feature-engineering-productionization-and-deployment-of-ml-models)

**Github 库:**【https://github.com/Nipun-1997/Bank-Marketing】T4

希望你喜欢这个博客。详情请通过 LinkedIn 联系我

**领英简介:**[https://www.linkedin.com/in/nipun-agrawal-200597110](https://www.linkedin.com/in/nipun-agrawal-200597110)