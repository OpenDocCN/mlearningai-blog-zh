<html>
<head>
<title>On generalization capability of randomly initialized vs pre-trained weights</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机初始化与预训练权值的泛化能力</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/do-randomly-initialized-network-parameters-generalize-better-than-pre-trained-ones-80a649a23cd9?source=collection_archive---------4-----------------------#2022-02-11">https://medium.com/mlearning-ai/do-randomly-initialized-network-parameters-generalize-better-than-pre-trained-ones-80a649a23cd9?source=collection_archive---------4-----------------------#2022-02-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="ac23" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">TLDR；问:“用随机初始化的权重训练神经网络比用预训练的权重训练神经网络能产生更好的泛化能力吗？”答:可以。然而，了解培训的动态可以帮助弥合差距。</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/35a51884e13613354cece9503de10fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*0yiNAftg_CCUsVo83pGLZw.jpeg"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Image Source: Unsplash</figcaption></figure><p id="e003" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">众所周知，用预训练模型的参数来初始化神经网络参数，可以找到凸优化问题和非凸优化问题的有效解决方案。然而，最近的工作表明，这种神经网络训练的热启动可能导致性能落后于从随机初始化的参数训练的性能。在这篇博客文章中，我打算在研究一些缓解这种滞后的措施的同时，沿着这条工作路线复制最近的论文的结果。</p><h2 id="d794" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">热启动训练导致概括能力下降</h2><p id="921f" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">Ash &amp; Adams (2020)的基础工作显示了热启动如何损害深度神经网络中的泛化，而不损害训练精度。在我称为<em class="jc"> A+B </em>的训练设置中，他们在训练数据的前50%<em class="jc">即</em>A上预训练他们的模型，并使用它来热启动训练，也称为<em class="jc">在100%的训练数据上调整</em>，<em class="jc">即</em>，B。下面的图再现了这种热启动训练对CIFAR-10和SVHN数据集的影响，并将它们与训练随机初始化的模型进行对比</p><p id="3b6c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于诸如任务增量连续学习之类的领域，其中大多数设置依赖于用从先前时间步长任务的优化中获得的参数来初始化主干网络的参数，这种泛化能力的下降尤其糟糕，因为它会对可行性能造成上限。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kp"><img src="../Images/5593168b3425cfc91809e798bb13d56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kNBDT6fGBBMDVR7YauRQ0Q.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx">The training and test accuracy (averaged over 3 runs) of pre-trained (first 200 epochs), warm-started (Blue), and randomly initialized (Orange) ResNet18 models (200–400 epochs) on CIFAR-10 and SVHN datasets. Training setting uses SGD optimizer with zero weight decay, an initial LR of 0.001 without scheduling and no data augmentation.</figcaption></figure><h2 id="c6e6" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">补救措施</h2><p id="d809" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">Ash &amp; Adams (2020)提出了收缩、扰动和重复(SPR)初始化算法，作为使用从预训练模型初始化的参数在每轮对新的、看不见的数据进行训练时产生的梯度不平衡的补救措施。即如果<em class="jc">θ_i^t</em>是第<em class="jc"> t </em>训练轮的第<em class="jc"> i </em>个训练参数，那么SPR初始化可以表述为:<em class="jc">θ_i^t</em>=<em class="jc">θ_i^(t-1)</em>+<em class="jc">p^t</em>，<em class="jc">即</em>， 在前一轮训练中找到的参数值首先通过因子<em class="jc">λ</em><strong class="ig hi"><em class="jc">∈</em></strong><em class="jc">(0，1) </em>向零收缩，然后通过添加从均值零和标准偏差<em class="jc"/><strong class="ig hi"><em class="jc">∈</em></strong><em class="jc">【0，1】</em>的分布中提取的噪声<em class="jc"> p^t </em>来扰动。 下图显示了在CIFAR-10和SVHN测试集上SPR优于随机初始化的结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es kp"><img src="../Images/f9971fcf39e563a9d5a14d02fb24beea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rF5bbr0dC2nShHSsi8WRmA.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx">Figures showing the effect of SPR technique when initializing the warm-start training of neural networks (Blue) in contrast to random initialization (Orange).</figcaption></figure><h2 id="5c5a" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">理解泛化差距</h2><p id="9471" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">最近，Berariu <em class="jc">等人</em> (2021)提出在调谐期间将学习速率提高一个数量级，作为上述设置中SPR的替代方案。为了理解这背后的动机，让我们首先调查为什么热启动训练的推广滞后。</p><p id="7302" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在他们的论文中，Berariu <em class="jc">等人</em> (2021)使用Ash &amp; Adams (2020)的设置来研究热启动泛化差距的发生。特别是，他们的推理基于神经网络学习的两个阶段:(a)<em class="jc">探索</em>阶段有助于参数找到损耗最小值的吸引盆地，这些盆地足够宽以捕获优化，(b)<em class="jc">细化</em>阶段然后有助于参数在基于梯度流的盆地中收敛到临界点。作者推测，预训练阶段主要通过减少梯度中的噪音量来影响学习的探索阶段，这些噪音是搜索更广泛的吸引区域所必需的。这反过来增加了收敛到更窄的最小值的机会，从而导致更差的泛化能力。在调谐期间增加学习速率可以被视为等同于在参数更新期间重新引入噪声。</p><p id="ba9a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">具有较高学习速率的调谐的有效性也可以从到达条件良好的损失表面区域的角度来解释。Jastrzebski <em class="jc">等人</em> (2020)表明，在神经网络的早期优化轨迹中存在盈亏平衡点，超过该点，梯度下降沿曲率最大的损失面方向振荡。因此，在达到这样的盈亏平衡点之前使用较大的学习率导致小批量梯度的方差减小，这又改善了它们的协方差以及损失面的调节。</p><h2 id="38d3" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">通过检查先前看到的数据的重放来弥补归纳差距</h2><p id="2f10" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">从前面提到的<em class="jc">两阶段学习</em>机制中汲取灵感，我尝试将看到的例子稳定地重新引入模型的训练数据<em class="jc">，而不是立刻从100%的训练数据开始</em>。</p><p id="9365" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">形式上，调整阶段现在开始于在第一个<em class="jc"> N个</em>时期的不可见的<em class="jc">(剩余的50%) </em>数据上训练模型，随后在每个<em class="jc"> n个</em>时期将可见的示例的<em class="jc"> k% </em>(从第一个<em class="jc"> 50% </em>开始无替换地采样)混合到训练数据中。这里的假设是，这种在训练期间部分但稳定地重新引入已见过的例子可以帮助延长模型的探索阶段。尽管培训受到相同的资源预算，但这可以提供更多的机会来发现更广泛的吸引力。</p><p id="020d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上述设置要求从一开始就将在所有可用训练数据上训练的模型标记为原始基线，而使用参数的随机初始化获得的性能作为上限。下面的结果表明，如此稳定地重新引入已看过的训练示例确实有助于实现超过基线的优异表现。</p><p id="77fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，精度根据<em class="jc"> k. </em>的值而变化。即使对于相同的<em class="jc">k</em>,<em class="jc">n</em>的值也会进一步影响性能。一般来说，当模型在看到下一批新的重放数据之前获得充足的训练时期时，相对于基线的性能增益提高。然而，将<em class="jc"> n </em>增加到更大的值会对性能产生负面影响。对此的一种可能解释是，较大的<em class="jc"> n </em>值允许训练很好地进展到<em class="jc">细化</em>阶段，因此在两个阶段之间反复切换导致随着时间的推移有效勘探所需的噪声衰减。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="er es ku"><img src="../Images/2330bcd3f7e19a1a039a0a88cf0757f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CE8ygNAbAs1FtjLK-GVivw.png"/></div></div></figure><h2 id="9292" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">我们是否应该超越弥合概括差距？</h2><p id="9978" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">由于来自随机初始化的训练可能导致参数学习较慢，检查热启动训练性能的另一种方式可以是优先考虑<em class="jc">收敛速度</em>而不是<em class="jc">性能</em>。我研究了使用一些这样的技术来达到更快收敛的最终目标。</p><p id="c076" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中第一个是由Maennel <em class="jc">等人</em> (2020)提出的，它基于使用随机标签的预训练，以便于在调整期间更快地收敛，而不是从头开始训练。他们将网络参数和数据的主要成分之间的一致性归因于观察到的速度提高背后的主要原因。第二种方法使用由Zhu <em class="jc">等人</em> (2021)提出的GradInit技术，该技术找到用于缩放每个网络层的范数的调整乘数因子。这是通过在训练开始之前在训练数据上添加具有指定超参数的单个SGD步骤的最小开销来实现的。</p><p id="9560" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面的线图显示了上述SPR初始化替代方案的效率比较。为了更好地描述模型的收敛速度，我选择绘制调优迭代与精度的关系图。很明显，从零开始的初始化导致了最慢的收敛(也在马内尔<em class="jc">等人</em> 2020中报道)。这里的要点在于决定正确的度量来评估热启动训练的效率:有效的初始参数空间不仅应该以获得更好的泛化能力为目标，还应该更快地获得它。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/5d12b5d6c19e1cd1025c23f634c83fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*niY6_leDHFzhX7e_QAs7Ww.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Figure showing the effect of various parameter initialization techniques on the convergence speed of the model during tuning. Warm-started models (even when pre-trained with random labels) tend to converge faster.</figcaption></figure><h2 id="e941" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">摘要</h2><p id="7617" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">作为读者，您应该已经了解，在训练之前用预训练模型的参数进行初始化时，是什么对模型的泛化能力施加了限制。我试图通过更好地利用以前看到的数据来调查热启动训练的局限性。最后，虽然与使用随机初始化参数训练的神经网络相比，神经网络训练的简单热启动可能提供次优的泛化能力，但是它们确实导致更快的训练收敛。问题在于根据手头的问题决定什么是更好的评估标准。</p><h2 id="8fd6" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">参考</h2><p id="734f" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">乔丹·阿什和瑞安·P·亚当斯。热启动神经网络训练研究。在2020年。</p><p id="8870" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Tudor Berariu、Wojciech Czarnecki、Soham De、Jorg Bornschein、Samuel Smith、Razvan Pas-canu和Claudia Clopath。神经网络的可塑性研究。<em class="jc"> arXiv </em>，2021。</p><p id="b7cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">斯坦尼斯劳·亚斯特日布斯基、马切伊·申扎克、斯坦尼斯拉夫·福特、德万什·阿尔皮特、亚采克·塔博尔、京云朝和克日什托夫·革剌斯。深度神经网络优化轨迹上的平衡点。在<em class="jc"> ICLR </em>，2020年。</p><p id="0540" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Justin Gilmer、Behrooz Ghorbani、Ankush Garg、Sneha Kudugunta、Behnam Neyshabur、David Car-doze、George Dahl、Zachary Nado和Orhan Firat。深度学习中训练不稳定性的损失曲率视角。<em class="jc"> arXiv </em>，2021年。</p><p id="4f6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Hartmut Maennel、Ibrahim Alabdulmohsin、Ilya Tolstikhin、Robert JN .鲍多克、Olivier Bousquet、Sylvain Gelly和Daniel Keysers。神经网络在用随机标签训练时会学到什么？<em class="jc"> arXiv </em>，2020年。</p><p id="e484" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">、倪仁坤、、孔克志、黄伟龙尼和汤姆·戈尔茨坦。Gradinit:学习初始化神经网络以进行稳定高效的训练。<em class="jc"> arXiv </em>，2021年</p><h2 id="bccd" class="jp jq hh bd jr js jt ju jv jw jx jy jz ip ka kb kc it kd ke kf ix kg kh ki kj bi translated">确认</h2><p id="7a96" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">巴塞罗那自治大学<a class="ae kw" href="http://www.cvc.uab.es/LAMP/" rel="noopener ugc nofollow" target="_blank">学习和机器感知团队</a>完成的工作。</p><div class="kx ky ez fb kz la"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lb ab dw"><div class="lc ab ld cl cj le"><h2 class="bd hi fi z dy lf ea eb lg ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lh l"><h3 class="bd b fi z dy lf ea eb lg ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="li l"><p class="bd b fp z dy lf ea eb lg ed ef dx translated">medium.com</p></div></div><div class="lj l"><div class="lk l ll lm ln lj lo jj la"/></div></div></a></div><p id="b05b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">🟠成为一名<a class="ae kw" rel="noopener" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"> <strong class="ig hi">作家</strong></a></p></div></div>    
</body>
</html>