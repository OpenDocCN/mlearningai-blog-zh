<html>
<head>
<title>Amazon Fashion Discovery Engine (Content-Based Recommendation)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊时尚发现引擎(基于内容的推荐)</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/amazon-fashion-discovery-engine-content-based-recommendation-19d63563ef01?source=collection_archive---------1-----------------------#2021-07-26">https://medium.com/mlearning-ai/amazon-fashion-discovery-engine-content-based-recommendation-19d63563ef01?source=collection_archive---------1-----------------------#2021-07-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c350d14af7009fbbf48914d0ef95f62c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b2xFg82CZUjI75sqv0MV5A.jpeg"/></div></div></figure></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><blockquote class="iw ix iy"><p id="76ce" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated">R <strong class="jc hi"> <em class="hh">现实世界问题</em> </strong></p></blockquote><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jy"><img src="../Images/327acf47dc22d973f1701f43253c6e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oupaM9r2KfMCDRW0VvMzNw.png"/></div></div></figure><ul class=""><li id="e02d" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">每当我们访问Amazon.com，这是我们的<strong class="jc hi">产品形象</strong>。我们有同一产品的多个图像。</li><li id="9ee7" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">“Krave”是<strong class="jc hi">的品牌名称</strong>。</li><li id="7728" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">“KRAVE女式圆点常规合身上衣”是<strong class="jc hi">题</strong>。标题中有很多有趣而重要的信息。</li><li id="cf14" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">在标题下面，我们有<strong class="jc hi">的价格、尺寸、颜色，然后是产品描述。</strong></li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ku"><img src="../Images/b31f155d97280e6cc1bd4da30595e043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phSn9LWyg1jIZSP_Zeflxw.png"/></div></div></figure><ul class=""><li id="5794" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">然后根据我们的搜索显示相关/相似的产品。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ku"><img src="../Images/1538b95941a0edd8aa4401913f9e862c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-nNN0vZsBnesFncv6frZjw.png"/></div></div></figure><ul class=""><li id="3882" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">它还向我们展示了“客户也购买了”产品，这些产品也是推荐产品。</li><li id="607a" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated"><strong class="jc hi">为什么关心产品推荐？</strong> <br/>据估计，亚马逊大约35%的收入来自产品推荐。由于产品推荐栏，如上所示，用户最终会购买一两件产品。</li><li id="108b" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">亚马逊内部使用两种类型的推荐系统:<br/> 1) <strong class="jc hi">基于内容的推荐:</strong> <em class="jb">当我们搜索关于圆点衫的时候，它使用文字和图片来推荐类似的商品</em>。<br/> 2) <strong class="jc hi">基于协同过滤的推荐:<br/> </strong> <em class="jb">想象一下，用户U1浏览了i1、i2、i3的产品<br/>用户U2浏览了i1、i3、i4的产品<br/>那么我可以推荐用户U3，当他在i1页面时的产品i3。因此，这被称为基于协同过滤的推荐。可惜我们没有这个数据。</em></li><li id="4610" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">因此，在我们的案例研究中，我们将使用基于内容的推荐。</li></ul><blockquote class="iw ix iy"><p id="44a1" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">攻击计划</em> </strong></p></blockquote><ul class=""><li id="338f" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">设置python</li><li id="f1c1" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">数据采集</li><li id="dd6a" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">数据清理</li><li id="02bb" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">文本预处理</li><li id="4f67" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">线性代数</li><li id="25b0" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">基于文本的产品推荐<br/>-BoW<br/>-word 2 vec<br/>-Tf-IDF</li><li id="f976" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">基于图像的产品推荐</li><li id="ceac" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">A|B测试</li></ul><blockquote class="iw ix iy"><p id="2b2a" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">亚马逊产品广告API </em> </strong></p></blockquote><p id="4aa7" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">我实际上使用了亚马逊自己的产品广告API，因为我们需要以符合政策的方式使用我们选择的任何编程语言从Amazon.com获得数据。</p><p id="0dbf" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">我获得了女性上衣和衬衫的数据，得到了大约183000种产品的数据。我们得到的数据包括图片URL、标题、价格、产品描述等。所以我们将主要关注女性上衣的数据。</p><blockquote class="iw ix iy"><p id="097f" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">数据和术语概述</em> </strong></p></blockquote><ul class=""><li id="e1fb" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">数据集是一组数据点。</li><li id="e3bf" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">这里的一行代表该数据集中的一个产品，也称为数据点。</li><li id="ed39" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">每一列代表给定产品的一个变量/特征。例如:它可以有一个价格，标题，图像等。</li><li id="924c" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">数据点/产品数量:183138</li><li id="ff45" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">特征/变量数量:19</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kv"><img src="../Images/4dccbeb5d0a3e6f575e123584d66dc68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oSfKuve4IWKcuBTpDhK06Q.png"/></div></div></figure><ul class=""><li id="e6c3" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">在本次研讨会中，我将只使用这19项功能中的6项。<br/> — 1。asin(亚马逊标准识别号)-在Amazon.com给每个产品一个唯一的编号。<br/> — 2。品牌(产品所属的品牌)<br/> — 3。颜色(服装的颜色信息，它可以包含多种颜色作为一个值，例如:黑色和蓝色条纹)<br/> — 4。产品类型名称(服装的类型，例如:衬衫/t恤)<br/> — 5。medium_image_url(图像的URL)<br/>—6。标题(产品的标题)<br/> — 7。formatted_price(产品价格)</li><li id="a20b" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我有意不使用描述，因为它很长，需要更长的时间来处理。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/696540e3eca8aa2b51fda97127c4fb62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xwAbXEU1tTV-ZAYUTnAzXA.png"/></div></div></figure><ul class=""><li id="4796" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">嗯，特性下降的一部分来自各种EDA技术，一部分来自领域专业知识。有时候也很直观。</li></ul><blockquote class="iw ix iy"><p id="be28" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">数据清理&amp;理解</em> </strong></p></blockquote><p id="d235" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">这是机器学习中极其重要的一步，但却常常被忽视。我们越了解我们的数据，我们就能建立越好的模型。如果我们不想让我们的模特受苦，那就集中精力。</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/696540e3eca8aa2b51fda97127c4fb62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xwAbXEU1tTV-ZAYUTnAzXA.png"/></div></div></figure><p id="429c" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">在这里，我们可以注意到，有一些单元格缺少数据或者没有数据。那么让我们来理解我们的数据。</p><ol class=""><li id="bf15" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kx km kn ko bi translated"><strong class="jc hi">功能的基本统计:产品类型名称</strong></li></ol><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/9cdce700539ac548d4200ead370f6a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*G5jPrqG0tZLygrYMopsbGw.png"/></div></figure><ul class=""><li id="5ac6" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">在183138种产品中，有72种产品是独一无二的。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/71430bf87650b6e65c5fe546f7c42410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*33m_EA7PHPyiMbHT15fU8w.png"/></div></figure><ul class=""><li id="a639" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">最常见的产品类型是“衬衫”，在183138件产品中有167794件，约占91%。</li><li id="de69" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">10个最常用的product _ type _ names:</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es la"><img src="../Images/b56be24f2bcea63d0f9aa9082f2f3731.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*i6KTY3uVU1zOMLRkBHPZkA.png"/></div></figure><p id="c790" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated"><strong class="jc hi"> 2。功能基本统计:品牌</strong></p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/d58260480cdbf62410231cb70a04e98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*Ia3xnWCi30VphCvrB7OZ6g.png"/></div></figure><ul class=""><li id="93d1" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">如数据所示，在183138种产品中，只有182987种产品给出了品牌名称。所以缺少151个值。</li><li id="f091" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">有10577个独特的品牌。</li><li id="69b1" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">最上面的品牌是“扎戈”,有223排。</li><li id="340c" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">十大品牌是:</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es lc"><img src="../Images/c74e6bb6c8f6c670f64d4235f9c3d824.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*OS0DemZjlyxYpz76N9LJ0g.png"/></div></figure><p id="199f" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated"><strong class="jc hi"> 3。特征的基本统计:颜色</strong></p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es ld"><img src="../Images/5572da3eec86597826e9ac360b7ed28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*mKRCiTX7RtLh58j5zt_Kjg.png"/></div></figure><ul class=""><li id="5778" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">183138种产品中有64956种产品有颜色信息。这大约是35.4%。</li><li id="ceea" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">有7380种独特的颜色。</li><li id="a804" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">最上面的颜色是黑色，在13207件产品中发现，占产品的7.28%。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es le"><img src="../Images/a5a891dbe5cd5ff167ca0682bed67b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*zj_w485BStSJdcsd6EGStQ.png"/></div></figure><ul class=""><li id="bcf4" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">对于118182产品，完全不指定颜色。</li></ul><p id="d3f7" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated"><strong class="jc hi"> 4。功能基本统计:formatted_price </strong></p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/a89cbf4a3fbb1c79ea6cb5cc56b29e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*O8Z6qHGr3Et9GoJxD9PyQQ.png"/></div></figure><ul class=""><li id="c29a" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">183K中只有28395个产品有关于价格的信息，大概是15.5%左右。</li><li id="bf66" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">有3135个独特的价格点。</li><li id="fd18" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">最高价位是19.99美元，适用于945种产品。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/f0cd0ed16fb61e2c77b3f01fa9ca31e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/1*PvFYYwxM-L07HqqQpVUo5w.png"/></div></figure><ul class=""><li id="09fb" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">因此，许多产品和其他看起来合理的产品都缺少价格价值。</li></ul><p id="08e0" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated"><strong class="jc hi"> 5。特性的基本统计:标题</strong></p><ul class=""><li id="ef4a" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">标题简短，信息丰富。</li><li id="a9b5" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">它们是最重要的特性之一，我们将广泛使用它。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/dc9d3b80d72e9fe413edb23619510a62.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*MAffYTf4tADPRcKE_BzdhQ.png"/></div></figure><ul class=""><li id="ff16" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">它们大多存在于每个产品中，这使得它成为最好的特性。</li></ul><h2 id="91ac" class="li lj hh bd lk ll lm ln lo lp lq lr ls kf lt lu lv kh lw lx ly kj lz ma mb mc bi translated">因此，我不是对183，000个数据点进行操作，而是通过删除一些数据为空的行来对数据点的子集进行操作。由于在183K数据集上操作计算量很大并且很耗时，所以我们将在它的子集上操作。</h2><p id="a976" class="pw-post-body-paragraph iz ja hh jc b jd md jf jg jh me jj jk kf mf jn jo kh mg jr js kj mh jv jw jx ha bi translated"><strong class="jc hi"> 6。删除formatted_price为空的行</strong></p><p id="91c0" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">我删除了数据集中那些formatted_price为空或者没有给出价格信息的行。我在这里使用逻辑not操作来查找所有不为空的formatted_price字段，并将它们存储在数据中。</p><pre class="jz ka kb kc fd mi mj mk ml aw mm bi"><span id="6a03" class="li lj hh mj b fi mn mo l mp mq"><strong class="mj hi">data = data.loc[~data['formatted_price'].isnull()]<br/>print('Number of data points After eliminating price=NULL :', data.shape[0])</strong></span><span id="2ba4" class="li lj hh mj b fi mr mo l mp mq">Number of data points After eliminating price=NULL : 28395</span></pre><p id="6ce6" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated"><strong class="jc hi"> 7。移除颜色为空的行</strong></p><p id="7e60" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">以类似的方式，我删除了数据集中的那些行，其中color为空或者没有给出任何关于产品颜色的信息。我在这里使用了逻辑not运算来查找所有不为空的颜色字段，并将它们存储在数据中。</p><pre class="jz ka kb kc fd mi mj mk ml aw mm bi"><span id="05b5" class="li lj hh mj b fi mn mo l mp mq"><strong class="mj hi">data =data.loc[~data['color'].isnull()]<br/>print('Number of data points After eliminating color=NULL :', data.shape[0])</strong></span><span id="f2ca" class="li lj hh mj b fi mr mo l mp mq">Number of data points After eliminating color=NULL : 28385</span></pre><h2 id="2c53" class="li lj hh bd lk ll lm ln lo lp lq lr ls kf lt lu lv kh lw lx ly kj lz ma mb mc bi translated">我们将数据点的数量从183K减少到28K。那些有时间并且没有计算问题的人，请随意在183K数据集上运行这个案例研究。</h2><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ms"><img src="../Images/b6caab3ab7fb48daecfcafa055589a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9c5CSOoP2a1UWQuYvTx7qA.png"/></div></div></figure><p id="5802" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">您可以使用下面的代码下载所有这些28K图像。你不需要运行这段代码，除非你也想下载图片。我已经在我的代码中注释了这段代码。</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es mt"><img src="../Images/21158b8f646e2d65b199319e97f66c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*EapnOybf5l8U9JysulPSzw.png"/></div></figure><ul class=""><li id="1274" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated"><strong class="jc hi">我们如何处理太多的空值，这些空值很难进行插补，而且像价格这样的列非常重要，不能删除？</strong> <br/>在这种情况下，我们将把所有没有价格=null的行作为训练数据。price=null的行被视为测试数据。因此，我们使用训练数据训练模型，并预测测试数据的价格，因为它的价格为零。现在，我们可以用预测值代替插补值。还有一种简单的方法，用“0”填充所有的空值。</li></ul><h2 id="277e" class="li lj hh bd lk ll lm ln lo lp lq lr ls kf lt lu lv kh lw lx ly kj lz ma mb mc bi translated">移除重复的项目/产品</h2><blockquote class="iw ix iy"><p id="ba58" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">删除重复:第一部分</em> </strong></p></blockquote><ul class=""><li id="e820" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">目前我们大约有28K产品。</li><li id="c209" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我们需要找到标题重复或完全相同的产品的数量。众所周知，标题是最重要的特征之一，它短小精悍，信息丰富。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es mu"><img src="../Images/602962cb0f0c43966c99a3adf3721981.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*seX_o5qbpeJdcPIkHEjvOA.png"/></div></figure><ul class=""><li id="975e" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">所以28K个产品中有2325个产品有重复的标题。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es mv"><img src="../Images/33749098936ffaad8eb654a5ddc05f23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*_VVuUHS_JGoZ0mRlE8aUpA.png"/></div></figure><ul class=""><li id="7f81" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">在这里，我们可以看到这些产品/衬衫的颜色完全相同，只是尺寸可能不同(S、M、L、XL)。比方说，第一个图像是查询产品，我们必须找到类似的产品。如果我们向客户推荐这些确切的衬衫作为只是不同尺寸的查询产品，那么它会导致糟糕的客户体验，因为标题完全相同。</li><li id="fb42" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">因此，为了避免糟糕的客户体验，我们将删除重复的。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es mw"><img src="../Images/7aafececd972ccb553f6312e50a45c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*IqlUkLYn2NXHcjOSTd43lw.png"/></div></figure><ul class=""><li id="5b5d" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">我们甚至可以有重复的例子，产品完全相同，但颜色不同。当这些图片之一是查询产品时，推荐同一产品的不同颜色产品并不总是最好的。</li><li id="b7a0" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">因此，在我们的数据中有许多类似上述示例的重复产品，我们需要对它们进行重复数据删除以获得更好的结果。</li></ul><blockquote class="iw ix iy"><p id="5784" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">删除重复:第二部分</em> </strong></p></blockquote><ul class=""><li id="b05a" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">我会删除标题中很少几个字的所有产品。所以如果标题长度大于5，那么我会考虑，否则我会去掉。</li></ul><pre class="jz ka kb kc fd mi mj mk ml aw mm bi"><span id="575c" class="li lj hh mj b fi mn mo l mp mq">After removal of products with short description: 27949</span></pre><ul class=""><li id="65d7" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">现在，我将根据标题(标题的字母顺序)按降序对整个数据进行排序。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es mx"><img src="../Images/82abb769b4b89dcb8f82cc620c1d2c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*nzsllTKwhP8oKU1uVsjcvw.png"/></div></figure><ul class=""><li id="f7df" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">一些仅在最后几个单词/后缀不同的重复标题的例子。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es my"><img src="../Images/92b9471d36cfb9a9004a167d298f3840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*obzqCRAUeYEp75xpH-ioYw.png"/></div></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/cb927d8a53cdde4427d0e5bfca66e91e.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*nIjpV-ZMSHjIy5sXJy9Seg.png"/></div></figure><p id="e880" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">由于这些标题是按字母顺序排列的，我们可以得到这些相似的标题，只是最后几个单词不同而已。所以我们将这个逻辑。</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es na"><img src="../Images/68fc3baf8be07db002d2e024572679f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*UefRbDSY5HzK_Eh5Cq2sPQ.png"/></div></figure><p id="d1f6" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">假设我在这里有变量“I ”,在(i+1)这里有变量“j”。既然已经排序了，我就比较一下我的第I个标题和第j个标题相差多少字。我可以这样做，我可以把T1的所有单词和T2的所有单词放在一个集合中，然后在它们之间进行集合差分。如果差异小于2，那么我们将认为这两个标题是相似的，并删除仅在结尾不同的重复。因此，我们将删除T2，然后增加“j ”,并继续这样做。一旦我们把T1和其他所有东西进行比较。然后，我再次将我的“I”增加到T3，将“j”增加到(i+1)位。我们将一直这样做，直到for循环结束。</p><pre class="jz ka kb kc fd mi mj mk ml aw mm bi"><span id="79b7" class="li lj hh mj b fi mn mo l mp mq">Number of data points after removing the duplicates which differ only at the end :  17592</span></pre><blockquote class="iw ix iy"><p id="0fe1" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">删除重复:第三部</em> </strong></p></blockquote><p id="c9d5" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">以前，我们按照标题的字母顺序对整个数据进行排序。然后，我们删除标题是相邻的和非常相似的标题。</p><p id="e702" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">但是有一些产品的标题并不相邻但是非常相似。</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/8678a22c6ab5e273edfe2fded0989032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*fEimI1qOayrNLpfru5M8-A.png"/></div></figure><p id="d398" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">这些标题是完全相同的，除了一个单词不同，不能解决按字母顺序排序。那么我们如何移除它们呢？<br/> i: 1 → n <br/> j: 1 → n <br/>对于每一对(I，j):我们会发现它们在单词上有多少不同。<br/>如果(Title i，Title j)中的单词差≤ K个单词(比方说)，那么我们就去掉Title j。</p><p id="46e2" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">我们知道，现在n = 17K的产品，那么我现在可以形成多少对呢？<br/>→nC2 = n(n-1)/2<br/>→17kc 2 = 17592(17592–1)/2 = 154730436 = 1.54亿<br/>所以，我们需要进行1.54亿个标题对比对。</p><pre class="jz ka kb kc fd mi mj mk ml aw mm bi"><span id="4ca4" class="li lj hh mj b fi mn mo l mp mq">Number of data points after stage two of dedupe:  16042</span></pre><blockquote class="iw ix iy"><p id="ffeb" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">文本预处理:分词和停用词去除</em> </strong></p></blockquote><ul class=""><li id="7ad8" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">停用词去除是自然语言处理中的一个文本预处理阶段。</li><li id="4f8f" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">停用词是一种语言中的一组常用词。英语中停用词的例子有<strong class="jc hi">“a”、“the”、“is”、“are”等</strong>。停用词通常用在文本挖掘和自然语言处理(NLP)中，以消除那些太常用而携带很少有用信息的词。</li><li id="af15" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我使用了从nltk lib下载的停用词列表。</li><li id="2577" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我删除了标题中所有的特殊字符，如“#$@！%^&amp;*()_+-~?&gt;&lt; etc.</li><li id="2ac6" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">I converted all letters to lower case.</li><li id="cc91" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">I removed stop words from the titles.</li><li id="67da" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">In my system, it took me around 3.5 seconds to remove stop words from all the titles from the data.</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nc"><img src="../Images/ee73dcbed21f212040ad292644ff0f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*7FW77hZ11pSYN7o95153nQ.png"/></div></div></figure><blockquote class="iw ix iy"><p id="04c9" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">文本预处理:词干</em> </strong></p></blockquote><ul class=""><li id="7b03" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">简而言之，词干化就是去除单词的一部分，或者将单词简化为在字典中可能没有意义的词干或词根。</li><li id="1a6e" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">假设我们有一组单词:fishing，fisher，fished <br/>它的词根是fish。同样地，这组词的词根是argu。</li><li id="9708" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我试着用波特词干分析器对我们的标题进行词干分析，但是效果不太好。归根结底，这都是实验。</li></ul><h2 id="e7f7" class="li lj hh bd lk ll lm ln lo lp lq lr ls kf lt lu lv kh lw lx ly kj lz ma mb mc bi translated">所以在预处理步骤的最后:</h2><ul class=""><li id="2527" class="kd ke hh jc b jd md jh me kf nd kh ne kj nf jx kl km kn ko bi translated">重复数据删除</li><li id="b896" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">删除停用词</li></ul><h2 id="b1d0" class="li lj hh bd lk ll lm ln lo lp lq lr ls kf lt lu lv kh lw lx ly kj lz ma mb mc bi translated">我剩下大约16K个产品作为我的数据集。</h2><p id="35e2" class="pw-post-body-paragraph iz ja hh jc b jd md jf jg jh me jj jk kf mf jn jo kh mg jr js kj mh jv jw jx ha bi translated">现在，让我们建立基于标题文本的产品相似性系统。</p></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><h1 id="346e" class="ng lj hh bd lk nh ni nj lo nk nl nm ls nn no np lv nq nr ns ly nt nu nv mb nw bi translated"><strong class="ak"> <em class="nx">基于文本的产品相似度</em> </strong></h1><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es ny"><img src="../Images/a0a5cbc0533c34caec986581328d02df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*A1u7WQBqgLHU8mWDOgPc7Q.png"/></div></figure><ul class=""><li id="5b52" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">对于每种产品，我们都有一个标题。</li><li id="0610" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated"><strong class="jc hi">给定一个标题，如何将其转换成d维点？</strong> <br/>有多种方法可以将一个文本转换成三维点。</li><li id="fb4b" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">给定标题的d维表示，我们可以使用相似性度量来查找相似的产品。</li></ul><blockquote class="iw ix iy"><p id="bb76" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">将文本转换为n-D向量:单词包(BoW) </em> </strong></p></blockquote><ol class=""><li id="bb42" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kx km kn ko bi translated">S =出现在任何标题(T1，T2，T3，…)中的单词集。，Tn)。<br/>假设这个集合S的大小为“d”，或者d是S中唯一单词的大小。</li><li id="9aa1" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kx km kn ko bi translated">现在，我将为每个标题创建一个d维向量。假设词汇/集合中的单词1在标题1中出现了0次，因此我们将值作为“0”放入向量中。类似地，单词4在标题1中出现了2次，所以我们将值设为向量中的“2”。</li></ol><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nz"><img src="../Images/45577dfaa7498245388f6515fbaeb4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6PkuDqSXLxZxB1eXRjtyRA.png"/></div></div></figure><p id="ae6f" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">所以在单词袋中，我排除了文本的序列或序列信息。这是一个极其简单而强大的技术。</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es oa"><img src="../Images/39518c35e9e18a08fa4ec9bad33fa819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*X0aBe-XJ8d7HMx8jn9VX3g.png"/></div></figure><p id="c2f5" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">通过执行这3行代码，我们得到了一个16042行和12609列的矩阵。对于任何标题Ti，它在12609个唯一字中最多可以有20个字，因此矩阵中的大多数单元将是“0”。因此，在我们的例子中，因为它们中的大多数都是零，所以存储16K x 12K单元的存储位置是没有用的。因此，我们将它们存储在稀疏矩阵中，而不是二维数组中，以解决存储问题。在上面的代码中，fit_transform返回稀疏矩阵。</p><blockquote class="iw ix iy"><p id="772c" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">基于产品相似度</em> </strong></p></blockquote><ul class=""><li id="cfe7" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">我们的函数bag_of_words_model将标题id和您希望它推荐的类似产品的数量作为参数。</li><li id="8024" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">pairwise_dist将存储从给定输入服装到所有剩余服装的距离。我在这里使用的度量标准是欧几里德距离来衡量一个标题到另一个标题之间的距离。</li><li id="0032" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">np.argsort将返回标题要素的最小距离的索引。</li><li id="6e3f" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">p列表将存储标题要素的最小距离。</li><li id="8d00" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">数据帧索引也存储最小距离的索引。</li><li id="5bcf" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我们会通过<br/> 1。doc_id <br/> 2。title1 <br/> 3。title2 <br/> 4。get_result函数的URL <br/> 5.model。</li><li id="e0a1" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">现在，我们将调用一个产品的词袋模型来获得类似的产品。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ob"><img src="../Images/3163613870eb7bb8896cb5d00e8990e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nv_mhD6rJ83pZ-8SlDsGGA.png"/></div></div></figure><ul class=""><li id="1457" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">让我们来理解可视化:热图<br/>这里说，单词pink在查询中不存在，这就是为什么它是“0”。【tiger这个词出现在查询中，所以是“1”。<br/>类似地，所有其他单词都出现在查询中。<br/>粉红色越多或非零值越多，两个标题越接近或重叠越多。颜色表示与查询/输入标题的交集。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oc"><img src="../Images/87376b385053037eea26657336cb7bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jc1bosEaQY0CImvTRbFsyA.png"/></div></div></figure><blockquote class="iw ix iy"><p id="970c" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh"> TF-IDF:基于单词重要性特征化文本</em> </strong></p></blockquote><ul class=""><li id="d18e" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">每个标题被称为文档，文档集合被称为文档语料库。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es od"><img src="../Images/a36c8c4fcfd2c30e72a3f7da6cf397e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ucvjXsFyUe47JAFO2WoJw.jpeg"/></div></div></figure><ul class=""><li id="1d15" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">术语频率是指术语或词在文档/标题中出现的频率。如果wj在一个标题中出现多次，那么术语频率也会增加。</li><li id="034d" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">IDF(逆文档频率):给定一个文档语料库和单词j，它通过包含单词Wj的语料库中的文档数量给出语料库中的文档数量的自然对数。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oe"><img src="../Images/018d737bd06cc1fab704bcbb7806165e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lA3rid2BsdIqhlwFfUucvw.jpeg"/></div></div></figure><ul class=""><li id="b612" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">如果Wj在文档语料库中很少，IDF(Wj)会增加。分母越小，比值越大，整个函数的对数越大。</li><li id="542f" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">因此，Tf-IDF现在测量和评估一个单词与文档/语料库集合中的文档的相关程度。TF-IDF是词频和逆文档频的乘积。因此，如果一个单词在一个文档中出现多次，但很少在语料库的所有标题中出现。那么IDF就会高。这就是我们如何计算标题Ti的TF-IDF向量。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es od"><img src="../Images/cbd64be5921360bcd885d882e138966c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t_24GqBB5DMDSBzYUd6eGg.jpeg"/></div></div></figure><blockquote class="iw ix iy"><p id="9856" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">基于TF-IDF的产品相似度</em> </strong></p></blockquote><ul class=""><li id="d4b0" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">我们的函数tfidf_model将标题id和您希望它推荐的类似产品的数量作为参数。</li><li id="8e99" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">pairwise_dist将存储从给定输入服装到所有剩余服装的距离。我在这里使用的度量标准是欧几里德距离，用来衡量一个标题到另一个标题之间的距离。</li><li id="9db5" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">np.argsort将返回标题要素的最小距离的索引。</li><li id="ee52" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">p列表将存储标题要素的最小距离。</li><li id="c9aa" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">数据帧索引也存储最小距离的索引。</li><li id="1493" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我们会通过<br/> 1。doc_id <br/> 2。标题1 <br/> 3。title2 <br/> 4。get_result函数的URL <br/> 5.model。</li><li id="7336" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">现在，我们将为一个产品调用tfidf_model来获取类似的产品。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es of"><img src="../Images/9d4abec64db83e039615d2485a76404a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*iy5BZCCYQogmstuMjsOgig.png"/></div></figure><ul class=""><li id="0e6b" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">例如:“burned”是一个罕见的词，burned的tf-idf值很高，因为burned属于查询标题，所以标题中包含“burned”的其他产品将与我们的查询图像相似。现在，这两个标题将是相似的，因为，burnt word是一个罕见的词，所以IDF很高，这导致tfidf值很高。这里，相似性是基于tfidf值计算的。</li><li id="7e9e" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">现在，像“烧焦”和“棕色”这样的罕见词会有非常相似的tfidf值，比如分别为0.2和0.3。在这种情况下，他们之间的距离将会更小，从而有更多的机会被推荐。</li><li id="0a7a" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">因此，相比基于单词包的相似度，我们有更好的机会获得更好的推荐。</li><li id="8747" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">因为“烧焦”有更高的tfidf值，所以我们最终也得到了这样的烧焦颜色顶级推荐。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es og"><img src="../Images/5c6210eddd89d43c97cc0d53bb273b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AB3OCfx_vlX_T3YJzCfJOQ.png"/></div></div></figure><ul class=""><li id="084a" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">所以单词袋只是使用单词的频率，而tfidf使用单词的稀有性和重要性，这是一种非常好的推荐技术。</li></ul><blockquote class="iw ix iy"><p id="f811" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">基于IDF的产品相似度</em> </strong></p></blockquote><p id="d015" class="pw-post-body-paragraph iz ja hh jc b jd je jf jg jh ji jj jk kf jm jn jo kh jq jr js kj ju jv jw jx ha bi translated">在本案例研究中，如果我们观察标题:</p><ul class=""><li id="f724" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">话不经常重复。</li><li id="d357" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">标题也有变化，有长有短。</li><li id="879c" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">较短标题的术语频率(TF)较高。在这种情况下，tfidf会选择较短的标题。</li><li id="873a" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">所以在我们的例子中，如果Ti是一个网页或一个长文档，那么词频是有意义的，因为出现频率越高的词就越重要。这里每个标题几乎没有15或20个单词，所以最好去掉词频，只使用IDF(逆文档频率)。我们可以试验一下，看看结果是否比tfidf更好。</li><li id="b018" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">为了仅使用IDF属性并忽略TF值，我们使用CountVectorizer拟合数据，并定义了我们自己的IDF函数。</li><li id="f79f" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">在我们的案例中，效果并不理想。</li></ul><blockquote class="iw ix iy"><p id="97c3" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">基于文本语义的产品相似度:Word2Vec </em> </strong></p></blockquote><ul class=""><li id="61af" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">单词袋和tfidf不考虑语义。两者都是基于频率的技术，用于返回稀疏向量。</li><li id="589e" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">给定标题，我们希望它转换成d维数组，并使用欧几里德距离寻找相似性。但是我们能找到语义相似吗？</li><li id="d9d0" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">一种非常流行的技术是Word2Vec。它返回给我一个密集的数组或者大部分单元格都不为零。Word2Vec算法将观察我们的数据语料库中的模式，并给我们一个d维向量。Word2Vec通常需要非常大的数据语料库。</li><li id="5423" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">google已经在Google新闻语料库上训练了Word2Vec，对于该语料库中的每个单词，我们都获得了300维向量。谷歌免费为我们提供了这个模型。所以我们会用谷歌新闻word2vec。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es oh"><img src="../Images/0b7540089233abaa7d5fc951125ef13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*BOVqfygkXA9nTKn3ggyPrA.png"/></div></figure><ul class=""><li id="0d8f" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">假设我们的title Ti中有k个单词。为了得到Ti的word2vec，我们取所有单词的所有第一个分量的和，类似地继续将所有单元的分量相加，直到300维，并得到一个新的向量。然后，我会将新向量的所有分量除以k。这就是所谓的任何句子的平均word2Vec。</li></ul><blockquote class="iw ix iy"><p id="4229" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">平均Word2Vec产品相似度</em> </strong></p></blockquote><ul class=""><li id="2f4e" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">我们甚至可以使用自己的文本数据构建一个自定义的Word2Vec。由于我们没有像google那样的大型语料库，所以我们将只使用google的Word2Vec。作为参考你可以通过这个代码。如果您有足够的数据，那么构建您自己的定制word2vec模型是非常容易的。您需要为各种参数设置值，例如词向量维数、最小字数、并行运行的线程数量、上下文窗口大小等。然后你可以简单地初始化和训练你的模型。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es oi"><img src="../Images/a794a325d4b30fa277bfa804d2853260.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*8rXMwJ-cbFxDiIerS0CIzg.png"/></div></figure><ul class=""><li id="0fa8" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">现在，如果你有一个RAM ≥ 12GB，那么你可以成功地使用谷歌矢量文件，因为你会有数百万字的矢量，这将需要很多时间。如果我们回想一下，我们有大约12，609个独特的单词。因此，与其存储数百万个单词的所有数据，为什么我们不能创建一个简单的字典，在那里我们可以只存储/采样我们的12，609个单词及其相应的向量。所以这会节省很多内存，我把它放到了一个pickle文件中。</li><li id="dd35" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我们可以写下一些实用函数来获得word2vec，用于计算距离和我们的热图函数，以及一个用于计算所有标题的平均Word2Vec的函数，如使用build_avg_vec函数之前所解释的。</li><li id="f416" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">现在，我们可以像其他模型一样构建avg_w2v_model，在这里我们可以找到成对的距离，排序并找到最近的点。</li><li id="5d74" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我们会通过<br/> 1。doc_id <br/> 2。标题1 <br/> 3。title2 <br/> 4。URL <br/> 5.model到get_result函数并调用某个产品的avg_w2v_model来获取类似的产品。让我们看看，w2v如何给出不同的结果。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oj"><img src="../Images/926454d54736662ef7566d257bbff127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FjMJ1yl6XWv6F77voC7pSw.png"/></div></div></figure><ul class=""><li id="3592" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">这里随便挑一个值，比如说3.6，就是斑马的word2vec和老虎的word2vec之间的欧氏距离。该值越低，这两个术语越相关。只需查看xxl和xxl之间的欧几里德距离，因为它们相同，所以它们的值为“0”。因此，较暗的值是标度中较小的值。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ok"><img src="../Images/f7e4482e406c65c3900b885cafe380e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_azVldsil0vt1g9AVBzaw.png"/></div></div></figure><ul class=""><li id="fc3e" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">所以word2vec给了我们语义相似度。我建议你必须通过代码和所有的可视化来理解语义相似性，这是单词包tfidf所不能理解的。</li></ul><blockquote class="iw ix iy"><p id="39a4" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">基于TF-IDF加权Word2Vec的产品相似度</em> </strong></p></blockquote><ul class=""><li id="bd52" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">在TF-IDF中，我们使用单词重要性。现在，如果我们利用tfidf概念与word2vec相结合，那么我们就有了单词重要性以及语义相似性的潜力。这就是所谓的TF-IDF加权Word2Vec。</li><li id="4359" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我有一个标题为D = {T1，T2，T3，…，TN} <br/>的文档语料库，假设Ti有5个单词，k = 5，Ti的Wi是300维向量。我已经在语料库D的标题Ti中找到了这个单词Wi的TF-IDF(Wi，Ti，D)，现在，无论我得到TF-IDF的什么值，我都将其乘以Wi的300维数组的每个分量。类似地，我用Ti的所有单词和它们各自的TF-IDF来执行这个过程。然后我会发现N = Ti中所有单词的所有TF-IDF值之和。</li><li id="3350" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我们取所有单词的所有第一个分量的总和，类似地继续将所有单元的分量相加，直到300维，并且得到类似于平均单词2vec的新向量。然后，我会将新向量的所有分量除以n。这就是任何句子的TF-IDF加权Word2Vec。</li></ul><blockquote class="iw ix iy"><p id="4c5c" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">基于IDF加权Word2Vec的产品相似度</em> </strong></p></blockquote><ul class=""><li id="f78a" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">而不是计算TF-IDF，只能计算IDF加权Word2Vec。IDF还为我们提供了语料库中单词的重要性，因为如果一个单词出现几次，那么它将被赋予更高的重要性，而word2vec为我们提供了语义相似度。我没有在我的代码中使用带有word2vec的术语频率，因为标题很小，大多数单词只出现一次。</li><li id="fd36" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">代码与我们之前所做的非常相似。这样你就可以浏览我的github repo的代码了。我们找到成对的距离，传递一些参数，并找到相似的产品。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ol"><img src="../Images/c3e0192b4dc5f4d4f49e99f1c963388b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*0oFh3cfXqmbaEjgLusf0HQ.png"/></div></div></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es om"><img src="../Images/dd24da1b659c5b03351e890748aeadb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*xr7s7SmKM-oPGTQ20NUYNw.png"/></div></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es on"><img src="../Images/f97fe3a9b8f5e794898e683cc9af38ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*42-de3r3wVeOx6KQ1g-TYg.png"/></div></figure><ul class=""><li id="e125" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">我们成功地基于其他模型没有给出的查询得到了一些真正有趣的类似产品。IDF加权Word2Vec给了我们惊人的结果。</li><li id="2368" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">到目前为止，我们已经看到了不同的技术，如弓，TF-IDF，avgw2v，IDF加权w2v，每种技术都有一个公平的结果。但是从商业角度和影响来看，如何决定，哪种模式是最好的？为了达到这个目的，我们将理解A|B测试。</li></ul><blockquote class="iw ix iy"><p id="0907" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">加权相似度使用品牌&amp;颜色</em> </strong></p></blockquote><ul class=""><li id="4b0f" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">到目前为止，我们只是用标题来表示产品的相似性。我们还没有使用品牌和颜色。这些是我们可以利用的额外变量。</li><li id="de18" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">对于每个产品Pi，我们已经得到了标题向量。类似地，对于每个产品Pi，我们将得到品牌向量和颜色向量。一旦我们得到这三个向量，我们将连接这些向量。</li><li id="6d15" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">比方说，我有m个品牌。我们假设，产品bi有品牌bi，我怎么把它写成向量？</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es oo"><img src="../Images/0d37de0c1528521554918f74b4f55834.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*MzgYYHvoABS4KD8pbcDpKQ.png"/></div></figure><ul class=""><li id="d0ab" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">所以这将是一个m维向量。与品牌的单元格相对应的值是指数值。向量中只有第I个索引值将为“1”，其余所有单元格的值都将为“0”。这种编码被称为一个热编码。</li><li id="38b1" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">同样，我们也将对颜色进行一次热编码。</li><li id="74c8" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">现在，在连接之后，我有了一个向量，向量的一部分代表标题，向量的一部分代表品牌，向量的一部分代表颜色。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es op"><img src="../Images/5c7043fa2cd2d1978d4a946376ef0b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*VIm_kZL91Bs2hGInTiXiFQ.png"/></div></figure><ul class=""><li id="6f7e" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">给定两个乘积，pi和pj，我可以简单地用这个全向量求出pi和pj之间的欧氏距离。</li><li id="34ef" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">让我们假设，我们希望向客户展示相同品牌或相同颜色的产品。那么，我可以修改我的欧几里得距离来以某种方式纳入这种偏好吗？<br/>我们要做的就是取加权欧氏距离。我们必须构建三个权重:标题权重(Wt)，品牌权重(Wb)，颜色权重(Wc)。然后用Wt乘以title向量的每个元素，用Wb乘以brand向量的每个元素，用Wc乘以color向量的每个元素。相乘后，你只需要取欧几里德距离</li><li id="79c6" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">举个例子:如果Wt = 1，Wb = 5，Wc = 1，因为我们给了品牌更多的权重，所以我们最终更喜欢相同品牌的产品。重量越大，偏好越多。</li><li id="d54f" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">权重的选择在很大程度上取决于领域知识，数据科学家的职责是调整权重值，看看什么更有效。</li><li id="0ac8" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">让我们来看看结果:</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es oq"><img src="../Images/7a7f6fc1db7f0333924c4daa8a548cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*GmSXK1cSD5AykES55wl3Cw.png"/></div><figcaption class="or os et er es ot ou bd b be z dx">Here, brand and color are completely different from the query, still it pops up because we gave same weight of 5 and 5 to brand and color.</figcaption></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ov"><img src="../Images/22efbcab331469b0949e190d5885d26d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FLrF9WcZPwg7pajOKHdmqA.png"/></div></div></figure><ul class=""><li id="7e99" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">在这里，我们更加重视品牌和颜色。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es ow"><img src="../Images/7b9ab4b1fe3118da1ced48ac3ed5d80f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*KkGwBRQtffp6sygehBV2ag.png"/></div><figcaption class="or os et er es ot ou bd b be z dx">We can observe here, that as the brand changes, but the color stays brown. Even if one changes, the other one compensates because we have given equal weight of 50 to brand and color.</figcaption></figure><ul class=""><li id="7c51" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">这些就是我们可以在推荐系统中采用的策略。</li></ul><blockquote class="iw ix iy"><p id="a70b" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">构建真实世界解决方案</em> </strong></p></blockquote><ul class=""><li id="63de" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">我们致力于基于单词包的产品相似性模型。<br/>我们研究了基于TF-IDF的产品相似性模型。<br/>我们致力于基于IDF的产品相似性模型。我们致力于基于Word2Vec的产品相似性模型。<br/>我们致力于基于平均Word2Vec的产品相似性模型。<br/>我们研究了基于TF-IDF加权Word2Vec的产品相似性模型。<br/>我们致力于基于IDF加权Word2Vec的产品相似性模型。<br/>我们使用基于品牌和颜色的产品相似性模型来研究加权相似性。</li><li id="0054" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">所以，我们研究了多种技术。但是，现实世界的解决方案/系统是如何构建的呢？大多数公司使用多种技术。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es od"><img src="../Images/e245a9d48dc17c24380aa908ea6cc6c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mN9PPjkxcM9OYfjeVjx1AA.jpeg"/></div></div></figure><ul class=""><li id="63ab" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">所有这些结果都被考虑在内，我们将所有这些结果组合起来。因为产品“1”出现了很多次，即使我使用了不同的算法，同样的结果还是会出现。可能这个结果非常重要。所以，我会应用商业规则。</li><li id="4ce5" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">商业规则可以是:<br/>——不要展示相同品牌的产品超过两次或三次。<br/> -产品经理可以制定更多类似的规则，最终我们会得到最终的产品列表。<br/> -这些业务规则测试结果的质量。</li><li id="9a1a" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我得到的最终列表将显示给客户。</li><li id="6aa7" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">现在，我们如何知道我们的解决方案是好的呢？为此，有一个|B测试，也称为现场测试或桶测试。</li></ul></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><h1 id="17f3" class="ng lj hh bd lk nh ni nj lo nk nl nm ls nn no np lv nq nr ns ly nt nu nv mb nw bi translated">基于深度学习的视觉产品相似度</h1><blockquote class="iw ix iy"><p id="aba3" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh"> ConvNets:如何特征化图像:边缘、形状、部分</em> </strong></p></blockquote><ul class=""><li id="d26f" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">对于每个产品Pi，我都有一个图像的URL。从这个网址，我可以下载产品图片。现在我如何将我的图像转换成一个d维向量？</li><li id="72a4" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我们可以从图像中提取各种特征，如边缘、形状、颜色、斑马纹、豹纹等。如果给定一幅图像我们可以构造一个向量。向量的一部分是关于颜色的，向量的一部分是关于形状的，向量的一部分是关于图案或边缘的。现在我可以用欧几里德距离来计算两个向量之间的距离。</li><li id="467d" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">因此，给定一张图像，我将使用像VGG-16这样的卷积神经网络来将我的图像转换为密集向量。如果两幅图像非常相似，那么图像1的向量1和图像2的向量2之间的欧几里德距离将非常小。</li><li id="ef6f" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我们将使用一些现有的CNN的VGG-16为我们的任务建立基于图像的产品相似性。VGG-16拍摄一幅图像，并将其转换成25，088维的密集矢量。</li><li id="863b" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我所有的图像长度都是(224，224)并且我有大约16，042个样本。</li><li id="7996" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">重要功能<strong class="jc hi"> save_bottlebeck_features </strong>有3部分。第一部分主要是建立VGG-16网络。生成器部分获取我的每张图像，并通过VGG-16网络运行，然后返回给我25，088个维度特征。我还为我的每件产品收集别名。最后，我做了一个numpy保存，我把我转换成CNN矢量特征的16K图像保存到。npy文件以及asin名称。</li><li id="d137" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">记住，这里我们包括top = false，所以它不包括最后完全连接的层，因此输出不会是1000。VGG 16中的最后一个conv层给出了形状为512 x 7 x7的输出。展平这个输出，我们将得到25，088长度的向量。</li><li id="dcce" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">现在我们将使用欧几里德距离来寻找相似性。我将简单地加载16K图像的图像特性及其相应的asins名称。我将加载原始的16K数据集，其中有每个产品的标题、品牌、颜色、URL和类型。现在，我们将使用VGG 16的CNN功能获得类似的产品。</li><li id="9826" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">我定义了函数“get_similar_products_cnn ”,并为我想要的查询传递了参数，比如图像id和相似结果的数量。就像我们以前的任何模型一样，我找到了我的成对距离，也找到了最近的点。我会直接调用函数，得到类似的产品。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es ox"><img src="../Images/a9d81035341802c5f9a721586b75b860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Mi4Hz9bQW5GVlguYr5gRpg.png"/></div><figcaption class="or os et er es ot ou bd b be z dx">This is the query image.</figcaption></figure><ul class=""><li id="0c58" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">在这里，它将只使用图像来查找类似的产品。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es oy"><img src="../Images/626a448546868831a5f2096213c7d5f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*-e5jUA_pHf_rG0ZzOkyAiA.png"/></div></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es oz"><img src="../Images/22d5512a05f734726b5dcb7024f612ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*WXYBcBaJ4O4PN0oHgtyH9g.png"/></div></figure><ul class=""><li id="59d2" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">如果你观察的话，这些产品非常相似。根据查询图像，该模型更关注老虎纹和斑马纹。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es pa"><img src="../Images/9dc6599dd88b129482fb7e2c96579571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*sadeTDB1BxwzMB0dv-Uh5w.png"/></div></figure><ul class=""><li id="c049" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">该产品以前根本没有相同的查询标题。所以，我们得到了一些新的相似的建议。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es pb"><img src="../Images/10e0700eccc2966cacd051273f608889.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*ZUUTT7Lp3yoLs7EdIegXUg.png"/></div></figure><ul class=""><li id="2bd7" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">我只是用图像来寻找相似性，但我仍然得到了非常好的结果。在上面的产品推荐中，我们得到了猎豹图像以及斑马条纹，这是一个相当不错的无标题推荐。我们没有在任何基于文本相似性的方法中得到这个产品。</li></ul><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/fe9502cb53dd94b9cc2fe459846f2660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*7E4Zc0A4Pj671AikQYKc1g.png"/></div></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es mv"><img src="../Images/0b619842c5e153b5bc0f98c153e6cef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*3tsC4BkWqgI1DRrCHJqxGA.png"/></div></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es pc"><img src="../Images/99803c1587a52699613c738706175d55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*LlpVZV-Bb1EVu9icv93yWw.png"/></div></figure><ul class=""><li id="50e7" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">所以，我们从深度学习中得到了一些非常有趣的结果。在现实世界中，我们结合了多种方法的解决方案。</li></ul><blockquote class="iw ix iy"><p id="b23e" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">测量我们解决方案的优度:A|B测试</em> </strong></p></blockquote><ul class=""><li id="15e4" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">在整个博客中，我一直在根据单个不正确的查询来评估我们的方法。但是在现实世界中，我们将会处理数以百万计的图片、标题或产品。那么，如何评价方案一和方案二呢？</li><li id="2e97" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">让我们假设椭圆是访问<strong class="jc hi">Amazon.com的所有用户的集合。每天都有数百万用户访问Amazon.com。我只是将我的用户随机分成两个不重叠的组:比如说U1和U2。对于集合U1中的用户，我将向他们展示解决方案1的结果，向集合U2的用户展示解决方案2的结果。它们是大致相似的集合。现在，我在集合1上测量我的销售额，在集合2上测量我的销售额。如果销售(U1) &gt;销售(U2)，那么用户倾向于更喜欢方案1而不是方案2。因此，公司更倾向于方案1。</strong></li><li id="9d35" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">因此，为了进行评估，我们必须进行A|B测试，通过检查销售额来衡量我们解决方案的优劣。</li><li id="7abd" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">有一天，我在看一个亚马逊工程师的视频，他说模型投入生产后，通常需要一个月才能获得模型性能的所有反馈。</li></ul><blockquote class="iw ix iy"><p id="e375" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">结论</em> </strong></p></blockquote><ul class=""><li id="089e" class="kd ke hh jc b jd je jh ji kf kg kh ki kj kk jx kl km kn ko bi translated">推荐系统可以帮助用户找到合适的产品。</li><li id="6a8a" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">它增加了用户的参与度。</li><li id="48b3" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">在亚马逊，35%的产品因推荐而售出。</li><li id="fa9a" class="kd ke hh jc b jd kp jh kq kf kr kh ks kj kt jx kl km kn ko bi translated">这有助于使内容更加个性化。</li></ul><blockquote class="iw ix iy"><p id="5ed9" class="iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ha bi translated"><strong class="jc hi"> <em class="hh">实现在我的GitHub页面:</em> </strong></p></blockquote><div class="pd pe ez fb pf pg"><a href="https://github.com/Swetadas-1718/Amazon-Fashion-Discovery-Engine-content-based-recommendation" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab dw"><div class="pi ab pj cl cj pk"><h2 class="bd hi fi z dy pl ea eb pm ed ef hg bi translated">GitHub-Swetadas-1718/亚马逊-时尚-发现-引擎-基于内容-推荐</h2><div class="pn l"><h3 class="bd b fi z dy pl ea eb pm ed ef dx translated">据估计，亚马逊大约35%的收入来自产品推荐。由于…</h3></div><div class="po l"><p class="bd b fp z dy pl ea eb pm ed ef dx translated">github.com</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu in pg"/></div></div></a></div></div></div>    
</body>
</html>