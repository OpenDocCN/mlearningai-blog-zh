<html>
<head>
<title>Scraping Walmart Product Reviews using Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Selenium抓取沃尔玛产品评论</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/scraping-walmart-product-reviews-using-selenium-a8c22ca37479?source=collection_archive---------1-----------------------#2021-08-15">https://medium.com/mlearning-ai/scraping-walmart-product-reviews-using-selenium-a8c22ca37479?source=collection_archive---------1-----------------------#2021-08-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/aa75cb3e4cb5d460cf173d8fa1489675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PLty8pelrPBXsxQT"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Photo by <a class="ae hu" href="https://unsplash.com/@markuswinkler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Winkler</a> on <a class="ae hu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><div class=""><h2 id="f4bf" class="pw-subtitle-paragraph iu hw hx bd b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl dx translated">二手熊猫，美丽心灵&amp;硒网络驱动</h2></div><p id="d44a" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">本文将着重于构建一个web scraper，它模拟了在沃尔玛上抓取产品评论所必需的一组浏览器动作。<a class="ae hu" href="https://www.browserstack.com/selenium" rel="noopener ugc nofollow" target="_blank"> Selenium </a>提供了一些很棒的功能，帮助我们自动测试网页。对于我们的用例，我们将使用其中一些功能来自动化我们的刮刀，而不是让它需要人力。该数据可进一步用于<a class="ae hu" href="https://en.wikipedia.org/wiki/BERT_(language_model)" rel="noopener ugc nofollow" target="_blank"> BERT </a>分析和其他NLP用例。</p><div class="hg hh ez fb hi ki"><a href="https://www.browserstack.com/selenium" rel="noopener  ugc nofollow" target="_blank"><div class="kj ab dw"><div class="kk ab kl cl cj km"><h2 class="bd hy fi z dy kn ea eb ko ed ef hw bi translated">硒:定义，如何工作，为什么你需要它</h2><div class="kp l"><h3 class="bd b fi z dy kn ea eb ko ed ef dx translated">Selenium实现了web浏览器的自动化。它最著名的是支持快速、可重复的网络应用测试，这允许…</h3></div><div class="kq l"><p class="bd b fp z dy kn ea eb ko ed ef dx translated">www.browserstack.com</p></div></div></div></a></div><p id="8386" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">Web抓取是以自动方式收集结构化web数据的过程。web抓取的一些主要使用案例包括价格监控、价格情报、新闻监控、潜在客户挖掘、市场调研等等。如果你曾经从一个网站上复制并粘贴信息，你已经完成了与任何网页抓取器相同的功能，只是在微观的手动范围内。</p><p id="da97" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">在<code class="du kr ks kt ku b"><a class="ae hu" href="https://pypi.org/project/requests/" rel="noopener ugc nofollow" target="_blank">requests</a></code>库上工作的网页抓取器是半自动的，通常是针对特定问题的硬编码。另一方面，机器人用于有T2的大型网站，模拟浏览器行为。对于本文，我们将使用chromedriver来集成我们的浏览器和脚本。试着想象一下，雇佣一个人来完成从沃尔玛1000多页中获取对你产品的评论的任务。</p><p id="de4a" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">你可以<strong class="jo hy">下载</strong>脚本并<strong class="jo hy">对任何产品执行</strong>这里:<a class="ae hu" href="https://github.com/preetshah7/walmart_scarper" rel="noopener ugc nofollow" target="_blank">https://github.com/preetshah7/walmart_scarper</a></p><p id="653a" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">下面是我们的web scraper的一步一步的概要:</p><ol class=""><li id="2f6c" class="kv kw hx jo b jp jq js jt jv kx jz ky kd kz kh la lb lc ld bi translated">设置Selenium驱动程序并在浏览器上获取产品URL</li><li id="81cf" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh la lb lc ld bi translated">通过定位点击标签获得评论页面</li><li id="49d0" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh la lb lc ld bi translated">循环浏览审核所需的页数</li><li id="684b" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh la lb lc ld bi translated">用所有评审属性清理数据并呈现输出</li></ol><h1 id="69f8" class="lj lk hx bd ll lm ln lo lp lq lr ls lt jd lu je lv jg lw jh lx jj ly jk lz ma bi translated">设置Selenium驱动程序并在浏览器上获取产品URL</h1><p id="23b7" class="pw-post-body-paragraph jm jn hx jo b jp mb iy jr js mc jb ju jv md jx jy jz me kb kc kd mf kf kg kh ha bi translated">首先，我们将安装这个刮刀所需的库。</p><pre class="mg mh mi mj fd mk ku ml mm aw mn bi"><span id="fbc9" class="mo lk hx ku b fi mp mq l mr ms">pip install selenium<br/>pip install beautifulsoup4</span></pre><p id="460c" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">在这里获取selenium的驱动程序:<a class="ae hu" href="https://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank">chromedriver.chromium.org/downloads</a></p><p id="f9fc" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">现在，通过将我们先前下载的驱动程序路径配置到selenium webdriver中来创建<code class="du kr ks kt ku b">browser</code>对象。使用<code class="du kr ks kt ku b">get</code>属性打开我们的产品URL。</p><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div></figure><p id="f83c" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">我们已经成功地在Selenium上设置并运行了一个基本操作。</p><div class="hg hh ez fb hi ki"><a href="https://pypi.org/project/beautifulsoup4/" rel="noopener  ugc nofollow" target="_blank"><div class="kj ab dw"><div class="kk ab kl cl cj km"><h2 class="bd hy fi z dy kn ea eb ko ed ef hw bi translated">beautifulsoup4</h2><div class="kp l"><h3 class="bd b fi z dy kn ea eb ko ed ef dx translated">美汤是一个库，可以很容易的从网页上抓取信息。它位于HTML或XML之上…</h3></div><div class="kq l"><p class="bd b fp z dy kn ea eb ko ed ef dx translated">pypi.org</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ho ki"/></div></div></a></div><h1 id="83f4" class="lj lk hx bd ll lm ln lo lp lq lr ls lt jd lu je lv jg lw jh lx jj ly jk lz ma bi translated">通过定位点击标签获得评论页面</h1><h2 id="2722" class="mo lk hx bd ll nb nc nd lp ne nf ng lt jv nh ni lv jz nj nk lx kd nl nm lz nn bi translated">转到“查看所有评论”页面</h2><figure class="mg mh mi mj fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es no"><img src="../Images/9f6d7c2ef9a6cf98d9f3e1d3cadcbbec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cIosGmdXZ7jnMeGSrI3P6w.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Inspect the elements and copy the Xpath</figcaption></figure><p id="30ff" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">为了执行所有的点击动作，我们使用Selenium的<a class="ae hu" href="https://www.selenium.dev/selenium/docs/api/py/webdriver/selenium.webdriver.common.action_chains.html" rel="noopener ugc nofollow" target="_blank">动作链</a>。</p><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div></figure><p id="06f5" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">使用隐式等待命令让网页在出错前加载&amp;从URL获取产品id。</p><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div></figure><h2 id="3b40" class="mo lk hx bd ll nb nc nd lp ne nf ng lt jv nh ni lv jz nj nk lx kd nl nm lz nn bi translated">从下拉列表中选择“从最新到最早”</h2><figure class="mg mh mi mj fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es np"><img src="../Images/35c4c1e2c68b8ea66d0e04c39e9d1026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V0eRDxMV155FYur6FP-tOg.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">The Dropdown list</figcaption></figure><p id="027b" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">找到下拉列表的Xpath并使用<code class="du kr ks kt ku b">Select</code>，它模拟了从列表中选择元素的手动操作。</p><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div></figure><p id="86a7" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">我们已经自动执行了进入评论页面的操作。</p><h1 id="86f0" class="lj lk hx bd ll lm ln lo lp lq lr ls lt jd lu je lv jg lw jh lx jj ly jk lz ma bi translated">循环浏览审核所需的页数</h1><figure class="mg mh mi mj fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es nq"><img src="../Images/ab0304e187ef50236faf37d5bb558809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OIGFCaBhpOItT-IlZ4CgOw.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Tags for the different review attributes</figcaption></figure><p id="871c" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">我们的审查需要5个属性:审查日期，审查人姓名，审查标题，审查机构和评级。我们可以很容易地找到每个标签。</p><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div></figure><blockquote class="nr ns nt"><p id="ef8d" class="jm jn nu jo b jp jq iy jr js jt jb ju nv jw jx jy nw ka kb kc nx ke kf kg kh ha bi translated">评论的标题是一项艰巨的任务，因为有遗漏的价值。我尝试了很多东西，但最后，我使用了包含评论标题下标题标签的列表长度作为布尔值，以决定是否通过标题或nan值追加我们的平铺列表。</p></blockquote><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div></figure><figure class="mg mh mi mj fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ny"><img src="../Images/eeeec440c28e06ef67a8238b61fede1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hmunf2WO9wwQt7cIfizAzg.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Reviews without a title</figcaption></figure><p id="be22" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">此外，我们实施以下步骤:</p><ul class=""><li id="71b3" class="kv kw hx jo b jp jq js jt jv kx jz ky kd kz kh nz lb lc ld bi translated">使用<code class="du kr ks kt ku b">browser</code>对象在所需范围内循环查看页面。我们可以设置循环浏览的页数。</li><li id="6f28" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh nz lb lc ld bi translated">使用<code class="du kr ks kt ku b">browser</code>的<code class="du kr ks kt ku b">page_source</code>属性创建一个BeautifulSoup对象。</li><li id="f421" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh nz lb lc ld bi translated">初始化循环中所有审核属性的列表。通过使用<code class="du kr ks kt ku b">soup.findAll.</code>找到属性标签，在列表理解中添加列表</li><li id="bb90" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh nz lb lc ld bi translated">为我们的列表创建一个字典，最后通过这个字典添加我们之前生成的熊猫数据帧。设置<code class="du kr ks kt ku b">ignore_index=True.</code></li></ul><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">We have successfully made a DataFrame of the reviews</figcaption></figure><blockquote class="nr ns nt"><p id="d0f3" class="jm jn nu jo b jp jq iy jr js jt jb ju nv jw jx jy nw ka kb kc nx ke kf kg kh ha bi translated">我得到一个大小不匹配的错误，因为“评论”列表的大小不匹配。我注意到该页面的评论评级比评论数量(平均评级等)多。我在父类上实现了一个匹配，以获得实际的评分值。</p></blockquote><h1 id="baa0" class="lj lk hx bd ll lm ln lo lp lq lr ls lt jd lu je lv jg lw jh lx jj ly jk lz ma bi translated">用所有评审属性清理数据并呈现输出</h1><p id="4488" class="pw-post-body-paragraph jm jn hx jo b jp mb iy jr js mc jb ju jv md jx jy jz me kb kc kd mf kf kg kh ha bi translated">数据帧看起来不干净，也不容易查询。这里一个聪明的做法是将“日期”列转换成日期时间索引。我查询过2010年12月<strong class="jo hy">以后的数据，比如</strong>。方法从我们的数据中删除不需要的子字符串。</p><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div></figure><p id="8b4b" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">这样，我们就有了最终的输出。我们已经成功地创建了一个全自动的网页抓取器来抓取产品评论。输出:</p><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">Final Output</figcaption></figure><p id="a795" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">查看此视频，更好地了解铲运机的运行方式:</p><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="oa mu l"/></div></figure><blockquote class="nr ns nt"><p id="fbba" class="jm jn nu jo b jp jq iy jr js jt jb ju nv jw jx jy nw ka kb kc nx ke kf kg kh ha bi translated">提示:如果你是新手，我建议你使用以下任何一种浏览器——Chrome、Edge、Firefox或Safari。我浪费了相当长的时间用chromedriver运行Brave，因为它们具有相同的架构，所以我将二进制文件设置为Brave，后来意识到同一网站的标签在上面的命名不同。</p></blockquote><ul class=""><li id="e265" class="kv kw hx jo b jp jq js jt jv kx jz ky kd kz kh nz lb lc ld bi translated">如果你还想在Brave上试试，你可以这样开始:</li></ul><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="ob mu l"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">Credits: Stackoverflow</figcaption></figure><ul class=""><li id="e270" class="kv kw hx jo b jp jq js jt jv kx jz ky kd kz kh nz lb lc ld bi translated">有时，隐式等待方法被证明是低效的。因此，您可以使用waits方法显式显示一个元素，当加载该元素时，脚本会进一步执行。方法如下:</li></ul><figure class="mg mh mi mj fd hj"><div class="bz dy l di"><div class="mt mu l"/></div></figure><h1 id="a6ba" class="lj lk hx bd ll lm ln lo lp lq lr ls lt jd lu je lv jg lw jh lx jj ly jk lz ma bi translated">摘要</h1><p id="e164" class="pw-post-body-paragraph jm jn hx jo b jp mb iy jr js mc jb ju jv md jx jy jz me kb kc kd mf kf kg kh ha bi translated">以下是我们构建web scraper所遵循的一步一步步骤的总结:</p><ol class=""><li id="47dc" class="kv kw hx jo b jp jq js jt jv kx jz ky kd kz kh la lb lc ld bi translated">设置Selenium驱动程序并在浏览器上获得产品URL</li><li id="860b" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh la lb lc ld bi translated">通过定位点击标签获得评论页面</li><li id="7fba" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh la lb lc ld bi translated">循环浏览审核所需的页数</li><li id="c26b" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh la lb lc ld bi translated">用所有的评审属性清理数据并呈现输出</li></ol><h1 id="fcd8" class="lj lk hx bd ll lm ln lo lp lq lr ls lt jd lu je lv jg lw jh lx jj ly jk lz ma bi translated">未来的工作</h1><ul class=""><li id="0b2d" class="kv kw hx jo b jp mb js mc jv oc jz od kd oe kh nz lb lc ld bi translated">我们可以整合多个网购平台。</li><li id="3eaf" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh nz lb lc ld bi translated">对于其他平台，按钮的标签和类名会有所不同。因此，我们可以将它们添加到脚本中，并通过查询URL的字符串来使它们工作。</li><li id="19e6" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh nz lb lc ld bi translated">我们可以传递产品名称并创建一个动作链，在搜索栏中键入它，而不是解析网站。</li></ul><h1 id="1868" class="lj lk hx bd ll lm ln lo lp lq lr ls lt jd lu je lv jg lw jh lx jj ly jk lz ma bi translated">参考</h1><ul class=""><li id="663f" class="kv kw hx jo b jp mb js mc jv oc jz od kd oe kh nz lb lc ld bi translated"><a class="ae hu" href="https://www.selenium.dev/selenium/docs/api/py/webdriver/selenium.webdriver.common.action_chains.html" rel="noopener ugc nofollow" target="_blank"> Selenium ActionChains文档</a></li><li id="1516" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh nz lb lc ld bi translated"><a class="ae hu" href="https://beautiful-soup-4.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">https://beautiful-soup-4.readthedocs.io/en/latest/</a></li><li id="9606" class="kv kw hx jo b jp le js lf jv lg jz lh kd li kh nz lb lc ld bi translated"><a class="ae hu" href="https://www.youtube.com/watch?v=SuV3uvzr6lI" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=SuV3uvzr6lI</a></li></ul></div></div>    
</body>
</html>