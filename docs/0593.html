<html>
<head>
<title>TidyTuesday : Horror Movie Profits</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">今天:恐怖电影利润</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/tidytuesday-horror-movie-profits-13643797ce89?source=collection_archive---------3-----------------------#2021-05-22">https://medium.com/mlearning-ai/tidytuesday-horror-movie-profits-13643797ce89?source=collection_archive---------3-----------------------#2021-05-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="3c05" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">使用Python分析恐怖电影利润</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/98590edc530b4ed8ee1131e184f5cc76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hRglqkeJdfhvPzmr"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@stefanopollio?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Stefano Pollio</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4666" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这是第二部分<strong class="jp hi"> <em class="kj">整理星期二</em> </strong>数据集在Python系列中的实现。你可以在这里找到第一部<a class="ae jm" rel="noopener" href="/mlearning-ai/tidy-tuesday-economic-guide-to-picking-a-college-major-9b2fd5275d9b">。</a></p><h1 id="a5b6" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">获取数据</h1><p id="3e46" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">这个项目的数据可以从Tidy Tuesday的Github库<a class="ae jm" href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2018/2018-10-23" rel="noopener ugc nofollow" target="_blank">中获取。这是一个维护得非常好的存储库，还包括原始数据集以及非常需要的数据字典。</a></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lh"><img src="../Images/4ba8ce030af6436eb9e5bb9ce9e11514.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*uiZOzkaj5C5JgUpwDy2kgA.jpeg"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><p id="a147" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在，您可以使用<code class="du li lj lk ll b">read_csv()</code>方法将CSV文件读入Pandas中的数据帧。数据导入后，您就可以开始分析数据了。</p><h1 id="38a7" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">数据清理和预处理</h1><p id="011d" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">数据清理和预处理是一个来回的过程。您清理数据并创建一些新列，分析数据，然后回来进一步预处理。因此，不要按顺序阅读jupyter笔记本，而是要理解这个过程。</p><h2 id="aa63" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">清理和过滤数据集</h2><p id="402d" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated"><em class="kj"> release_date </em>列应该是datetime，所以将其转换为datetime对象。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="e692" class="lm kl hh ll b fi me mf l mg mh">df['release_date'] = pd.to_datetime(df['release_date'])</span></pre><p id="8e31" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">此外，该数据集是2018年制作的，包含2018年以后的电影。这样的电影对国内和全球的票房没有价值。因此，只过滤并保留<em class="kj">上映日期</em> &lt; 2018年和<em class="kj">全球票房</em> &gt; 0的电影。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="11f0" class="lm kl hh ll b fi me mf l mg mh">movie_profit = df[(df['release_date'] &lt; '2018') &amp; (df['worldwide_gross'] &gt; 0)]</span></pre><p id="0501" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在，只有一个重复的电影可以丢弃。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="7c6d" class="lm kl hh ll b fi me mf l mg mh">movie_profit['movie'].value_counts()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mi"><img src="../Images/b7942c8805bac49d82ed3663d99b7a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*Hjp9ksuuvQFiHmSSDfPYZg.jpeg"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="08ac" class="lm kl hh ll b fi me mf l mg mh">movie_profit = movie_profit.drop_duplicates(subset=['movie'], keep = 'last')</span></pre><h2 id="b4a3" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">数据预处理</h2><p id="a7fe" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">我现在将创建两个专栏，帮助我了解一段时间内的趋势。一个是<em class="kj">十年</em>栏，另一个是<em class="kj">利润率</em>栏，是全球总利润除以生产预算。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="6bf3" class="lm kl hh ll b fi me mf l mg mh">movie_profit[‘decade’] = (movie_profit[‘release_date’].dt.year//10) * 10</span><span id="812a" class="lm kl hh ll b fi mj mf l mg mh">movie_profit['profit_ratio'] = movie_profit['worldwide_gross'] / movie_profit['production_budget']</span></pre><p id="f9b4" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在查看生产预算直方图时，我想到只保留前5名分销商，而不是所有183名分销商。因此，我将其余的转换为<em class="kj">其他</em>类别。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="99a5" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">数据分析和可视化</h1><p id="288f" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">这组数据是基于一篇《T21》的文章，这篇文章关注的是恐怖电影及其在过去几十年中的利润率。</p><h2 id="a531" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">各经销商的生产预算分配是怎样的？</h2><p id="f632" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">生产预算变化很大，因为有独立的大经销商。因此，最好以对数尺度来看所有的数字变量。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="ffed" class="lm kl hh ll b fi me mf l mg mh">(<br/>    ggplot(movie_profit, aes(x = 'distributor', y = 'production_budget', fill = 'distributor'))<br/>    + geom_boxplot()<br/>    + scale_x_discrete(limits = budget_per_distributor.sort_values('production_budget', ascending=False)['distributor'].to_list()[::-1])<br/>    + scale_y_log10(labels = currency_format('$', big_mark=','))<br/>    + coord_flip()<br/>    + theme(legend_position='none', figure_size=(12, 8))<br/>)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mm"><img src="../Images/58a8eccafa9286d3865581da6c0d8692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVPtXyOPV4cmjdlMjijVyA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><p id="44aa" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这是有道理的，因为大经销商公司可以投入大量资金，而许多独立经销商往往花费少得多。</p><h2 id="e7b6" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">各分销商的全球销售总额分布情况如何？</h2><p id="251a" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">同样，我们可以查看每个分销商的全球总收入。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="d841" class="lm kl hh ll b fi me mf l mg mh">(<br/>ggplot(movie_profit, aes(x = 'distributor', y = 'worldwide_gross', fill = 'distributor'))<br/>    + geom_boxplot()<br/>    + scale_x_discrete(limits = budget_per_distributor.sort_values('worldwide_gross', ascending=False)['distributor'].to_list()[::-1])<br/>    + scale_y_log10(labels = currency_format('$', big_mark=','))<br/>    + coord_flip()<br/>    + theme(legend_position='none', figure_size=(12, 8))<br/>    + labs(x = '', y = 'Worldwide Gross', title = 'What is the distribution of worldwide gross by each distributor?')<br/>)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mn"><img src="../Images/31d72b58683f43f2e4a170c5d70d327e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Is2nggurVIsg_BxxddLqbw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><h2 id="39f7" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">各流派的制作预算分配如何？</h2><p id="cf02" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">文章的关键谈了为什么恐怖片是最好的投资。这篇文章声称，许多恐怖电影的预算很低，但最终却在全球范围内取得了巨大的成功。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="9c5d" class="lm kl hh ll b fi me mf l mg mh">( <br/>    ggplot(movie_profit, aes(x = 'genre', y = 'production_budget', fill = 'genre'))<br/>    + geom_boxplot() <br/>    + scale_x_discrete(limits = budget_per_genre.sort_values('production_budget', ascending=False)['genre'].to_list()[::-1])<br/>    + scale_y_log10(labels = currency_format('$', big_mark=','))<br/>    + coord_flip() <br/>    + theme(legend_position='none', figure_size=(12, 8))<br/>    + labs(x = "", y = 'Production Budget', title = 'What is the distribution of production budget by each genre?')<br/>)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mo"><img src="../Images/344bbace2dcbb1acfec02fdaa090419b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M4rG8jlKbMXo7NDFvegSwA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><p id="0c48" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在这里，显然恐怖电影的预算中值是最少的。</p><h2 id="c31e" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">各流派的全球总收入分布情况如何？</h2><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="2c04" class="lm kl hh ll b fi me mf l mg mh">(<br/>    ggplot(movie_profit, aes(x = 'genre', y = 'worldwide_gross', fill = 'genre'))<br/>    + geom_boxplot()<br/>    + scale_x_discrete(limits = budget_per_genre.sort_values('worldwide_gross', ascending=False)['genre'].to_list()[::-1]) <br/>    + scale_y_log10(labels = currency_format('$', big_mark=','))<br/>    + coord_flip()<br/>    + theme(legend_position='none', figure_size=(12, 8))<br/>    + labs(x = "", y = 'Worldwide Gross', title = 'What is the distribution of worldwide gross by each genre?')<br/>)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mp"><img src="../Images/6d75323de243255f934ced9e34691eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50pN887EdOuEzVCpaI2GOQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><p id="c71f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">显然，恐怖电影的预算最少，但最终却在全球总收入中赚得盆满钵满。</p><h2 id="b48f" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">哪些流派的派息率最大？</h2><p id="df44" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">再一次，通过查看支付比率的条形图，我们可以了解哪些类型赚了最多的钱。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="9cad" class="lm kl hh ll b fi me mf l mg mh">(<br/>ggplot(median_profit_ratio, aes(x = 'genre', y = 'profit_ratio', fill = 'genre'))<br/>    + geom_col() <br/>    + coord_flip()<br/>    + scale_x_discrete(limits = median_profit_ratio['genre'].to_list()[::-1])<br/>    + scale_y_continuous(labels = custom_format('{:n}X'))<br/>    + theme(legend_position='none', figure_size=(12, 8))<br/>    + labs(x = "", y = 'Profit Ratio', title = 'What genre makes the most money back?')<br/>)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mo"><img src="../Images/514c98fb63ddcfc0fa5797911b506b11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hP_VOv6xjnoqBTPt4B7Yfw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><p id="5994" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">显然，中等水平的恐怖电影赚了最多的钱。</p><h2 id="85ad" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">哪些恐怖电影的票房收入超过了他们的预算？</h2><p id="45ba" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">既然，文章说的是恐怖片，那就按盈利比例来看看排名靠前的恐怖片就好了。</p><pre class="ix iy iz ja fd ma ll mb mc aw md bi"><span id="4f92" class="lm kl hh ll b fi me mf l mg mh">(<br/>ggplot(horror_movies.sort_values('profit_ratio', ascending=False).head(10), aes(x = 'movie', y = 'profit_ratio'))<br/>    + geom_col(fill = 'orange')<br/>    + coord_flip()<br/>    + scale_x_discrete(limits = horror_movies.sort_values('profit_ratio', ascending=False).head(10)['movie'].to_list()[::-1])<br/>    + scale_y_continuous(labels = custom_format('{:n}X'))<br/>    + labs(x = "", y = 'Ratio of worldwide gross to production budget', title = 'What horror movies have most outgrossed their budget?')<br/>    + theme(figure_size= (12, 8))<br/>)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mq"><img src="../Images/67a4a85d85acd839b62006a6ae5d6e6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I-V0zfchTMWkLm1uuh2r_A.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><p id="3f7f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这很有趣，因为灵异活动和布莱尔女巫项目最终的预算超过了400倍。这两部电影的预算都很少，因为它们是纪录片，但最终却赚回了数百万美元。</p><h2 id="e5b4" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">有哪些电影赚回来的钱最多？</h2><p id="ee36" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">同样，我们可以看所有的电影，而不仅仅是恐怖片。我们看到在利润比排名前15的电影中，大部分都是恐怖片。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mr"><img src="../Images/f490c0012d62fe3d10e6c5855281d1bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-B4iNeouNTvp53scl6paJA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><h2 id="204d" class="lm kl hh bd km ln lo lp kq lq lr ls ku jw lt lu kw ka lv lw ky ke lx ly la lz bi translated">近年来体裁的总趋势是什么？</h2><p id="0d6e" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">看看近年来流派的趋势是如何变化的会很有趣。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ms"><img src="../Images/674c5aee6b8a0b9a2717eb9a9149d5bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-fFbD3bQwzOqmisGrJIZw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Source : Image by Author</figcaption></figure><p id="788c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们看到2010年后中值利润率突然上升。这表明很多恐怖电影为他们的发行商赚了很多钱。</p><h1 id="d247" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">结论</h1><p id="8537" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">因此，我们可以看到，恐怖电影往往是分销商的最佳投资，并最终赚了很多钱，特别是在过去的二十年里。</p><p id="2142" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">你可以在我的Github上找到完整的代码:<a class="ae jm" href="https://github.com/hemantrattey/TidyTuesday" rel="noopener ugc nofollow" target="_blank">https://github.com/hemantrattey/TidyTuesday</a></p><p id="8787" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">请随时给我同样的反馈。</p><p id="adcc" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">感谢你的阅读，我希望它能激励你继续前进，做你自己的分析。我真的建议你去看一下<a class="ae jm" href="https://www.youtube.com/user/safe4democracy" rel="noopener ugc nofollow" target="_blank"><strong class="jp hi"/></a><strong class="jp hi">的截屏。</strong></p><p id="2367" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我将在下周发布另一份来自Tidy Tuesday数据集的分析。</p><p id="5785" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">过来打个招呼。在推特<a class="ae jm" href="https://twitter.com/hemantrattey" rel="noopener ugc nofollow" target="_blank">和Linkedin </a>上告诉我，这样你就不会错过分析。</p></div></div>    
</body>
</html>