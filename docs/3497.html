<html>
<head>
<title>Data Cleaning Titanic Dataset in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的数据清理技术</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/data-cleaning-in-python-2655bc42bb52?source=collection_archive---------6-----------------------#2022-09-11">https://medium.com/mlearning-ai/data-cleaning-in-python-2655bc42bb52?source=collection_archive---------6-----------------------#2022-09-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/af8061cb3858b459b454cd542cd72c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wV0ZQqz_-rBw3ewFebFBtQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@kmuza" rel="noopener ugc nofollow" target="_blank">Carlos Muza </a>on <a class="ae it" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0ad6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">数据清理是数据管道中的一个重要部分，因为您产生的见解和结果取决于您拥有的数据。脏数据会导致错误的预测。大多数机器学习算法只有在你的数据被适当清理并适合建模时才起作用。</p><p id="0af4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在本文中，我将处理泰坦尼克号数据集。我们将首先使用pandas函数研究数据集及其列。然后我们将应用清理技术来处理空值。</p><p id="0a6b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我希望这篇文章对你的学习或工作有用。</p><p id="5375" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在让我们开始吧！</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="1267" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">导入库</h1><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="7c8a" class="lg ka hh lc b fi lh li l lj lk"><strong class="lc hi">import</strong> pandas <strong class="lc hi">as</strong> pd</span></pre><h1 id="0e65" class="jz ka hh bd kb kc ll ke kf kg lm ki kj kk ln km kn ko lo kq kr ks lp ku kv kw bi translated">加载数据</h1><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="0cba" class="lg ka hh lc b fi lh li l lj lk">data <strong class="lc hi">=</strong> pd<strong class="lc hi">.</strong>read_csv('titanic-data.csv')</span></pre><h1 id="6a7a" class="jz ka hh bd kb kc ll ke kf kg lm ki kj kk ln km kn ko lo kq kr ks lp ku kv kw bi translated">探索性数据分析</h1><p id="7e78" class="pw-post-body-paragraph iu iv hh iw b ix lq iz ja jb lr jd je jf ls jh ji jj lt jl jm jn lu jp jq jr ha bi translated">给我们数据集的前几行。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="41d5" class="lg ka hh lc b fi lh li l lj lk">data<strong class="lc hi">.</strong>head()</span></pre><p id="f68f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du lv lw lx lc b">dtypes</code>返回数据帧中的数据类型。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="de58" class="lg ka hh lc b fi lh li l lj lk">data<strong class="lc hi">.</strong>dtypes</span></pre><p id="60f2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du lv lw lx lc b">columns</code>返回数据集中所有列的名称</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="71cd" class="lg ka hh lc b fi lh li l lj lk">data<strong class="lc hi">.</strong>columns</span></pre><p id="29fe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du lv lw lx lc b">info()</code> will会告诉我们大量关于数据框的信息，如形状(行、列)、要素的数据类型以及内存使用情况。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="4487" class="lg ka hh lc b fi lh li l lj lk">data<strong class="lc hi">.</strong>info()</span></pre><p id="65df" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们对数据集有了一些概念，我们可以继续挖掘列和它包含的数据</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="d5d0" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">浏览各列</h1><blockquote class="ly lz ma"><p id="ef50" class="iu iv mb iw b ix iy iz ja jb jc jd je mc jg jh ji md jk jl jm me jo jp jq jr ha bi translated"><em class="hh">幸存与未幸存的乘客</em></p></blockquote><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="34d2" class="lg ka hh lc b fi lh li l lj lk">data['Survived']<strong class="lc hi">.</strong>value_counts()</span></pre><p id="2859" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du lv lw lx lc b">value_counts</code>返回包含唯一值计数的序列。结果将按降序排列，因此第一个元素是出现频率最高的元素。<strong class="iw hi">默认排除NA值。</strong></p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="7509" class="lg ka hh lc b fi lh li l lj lk">print('Total number of passangers in the training data...', len(data))</span><span id="fd8a" class="lg ka hh lc b fi mf li l lj lk">print('Number of passangers  who survived...', len(data[data['Survived'] <strong class="lc hi">==</strong> 1]))</span><span id="da2d" class="lg ka hh lc b fi mf li l lj lk">print("Number of passangers  who didn't survived...", len(data[data['Survived'] <strong class="lc hi">==</strong> 0]))</span></pre><blockquote class="ly lz ma"><p id="69e7" class="iu iv mb iw b ix iy iz ja jb jc jd je mc jg jh ji md jk jl jm me jo jp jq jr ha bi translated">幸存的男女比例是多少？</p></blockquote><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="844e" class="lg ka hh lc b fi lh li l lj lk">print(data['Sex']<strong class="lc hi">.</strong>value_counts())</span><span id="9f1b" class="lg ka hh lc b fi mf li l lj lk">print('% of male who survived', 100<strong class="lc hi">*</strong>np<strong class="lc hi">.</strong>mean(data['Survived'][data['Sex']<strong class="lc hi">==</strong>'male']))<br/>print('% of female who survived', 100<strong class="lc hi">*</strong>np<strong class="lc hi">.</strong>mean(data['Survived'][data['Sex']<strong class="lc hi">==</strong>'female']))</span></pre><blockquote class="ly lz ma"><p id="2531" class="iu iv mb iw b ix iy iz ja jb jc jd je mc jg jh ji md jk jl jm me jo jp jq jr ha bi translated"><em class="hh">按等级和年龄列的幸存乘客</em></p></blockquote><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="e5c5" class="lg ka hh lc b fi lh li l lj lk">print(data['Pclass']<strong class="lc hi">.</strong>value_counts())</span><span id="eb3e" class="lg ka hh lc b fi mf li l lj lk">print('% of passengers who survived in first class', 100<strong class="lc hi">*</strong>np<strong class="lc hi">.</strong>mean(data['Survived'][data['Pclass'] <strong class="lc hi">==</strong> 1]))</span><span id="a996" class="lg ka hh lc b fi mf li l lj lk">print('% of passengers who survived in second class', 100<strong class="lc hi">*</strong>np<strong class="lc hi">.</strong>mean(data['Survived'][data['Pclass'] <strong class="lc hi">==</strong> 2]))</span><span id="5c1c" class="lg ka hh lc b fi mf li l lj lk">print('% of passengers who survived in third class', 100<strong class="lc hi">*</strong>np<strong class="lc hi">.</strong>mean(data['Survived'][data['Pclass'] <strong class="lc hi">==</strong> 3]))</span><span id="ace1" class="lg ka hh lc b fi mf li l lj lk">print(data[["Pclass", "Survived"]]<strong class="lc hi">.</strong>groupby(['Pclass'])<strong class="lc hi">.</strong>mean())</span></pre></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="7c90" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">处理缺失值</h1><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="65be" class="lg ka hh lc b fi lh li l lj lk">df2 <strong class="lc hi">=</strong> data<strong class="lc hi">.</strong>copy() <em class="mb">#dataframe copy</em><br/><br/>df2<strong class="lc hi">.</strong>isnull()<strong class="lc hi">.</strong>sum()</span></pre><p id="3f4a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用<code class="du lv lw lx lc b">copy</code>制作数据帧的副本，以便原始数据保持原样。</p><p id="1854" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du lv lw lx lc b">isnull().sum()</code>将告诉我们每一列中空值的数量。</p><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es mg"><img src="../Images/febe8dfe42a4a1123f9af3ca71313d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*YngMj8p6yn59lj-yIues4A.png"/></div></figure><p id="aa94" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以清楚地看到哪些列包含空值，所以我们将一个接一个地挑选它们，并更新那些列。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="2b80" class="lg ka hh lc b fi lh li l lj lk">int(data['Age']<strong class="lc hi">.</strong>mean())<br/>#using this we can replace null values with the mean of age column</span></pre><p id="5779" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要替换数值，使用<code class="du lv lw lx lc b">fillna</code>功能。您在键中定义您想要替换的值，并在值<br/> <code class="du lv lw lx lc b">{column_name: replacement_for_NA}</code>中定义替代值</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="18a9" class="lg ka hh lc b fi lh li l lj lk">df2['Age'] <strong class="lc hi">=</strong> df2['Age']<strong class="lc hi">.</strong>fillna(np<strong class="lc hi">.</strong>mean(df2['Age']))</span><span id="66de" class="lg ka hh lc b fi mf li l lj lk">df2<strong class="lc hi">.</strong>isnull()<strong class="lc hi">.</strong>sum().<br/>#all null values of Age column replace with the mean of the column</span></pre><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es mh"><img src="../Images/4b47bbdb68ff57b00f629cc8a567fc1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*SpyA2vxvjRi9shoT8rA2tQ.png"/></div></figure><p id="41f6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们现在将处理已装载的列，因为它只有2个空值，我们要么删除这些行，要么替换为列的<em class="mb">模式</em>，因为它是一个<em class="mb">对象</em>列。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="01e2" class="lg ka hh lc b fi lh li l lj lk">#solution 1<br/>emabark <strong class="lc hi">=</strong> df2['Embarked']<strong class="lc hi">.</strong>dropna()</span><span id="ee2e" class="lg ka hh lc b fi mf li l lj lk">print(df2[df2['Embarked']<strong class="lc hi">.</strong>isnull()])</span><span id="1908" class="lg ka hh lc b fi mf li l lj lk">df2['Embarked']<strong class="lc hi">.</strong>fillna(df2['Embarked']<strong class="lc hi">.</strong>mode()[0], inplace<strong class="lc hi">=True</strong>)<br/>#inplace will do changes in dataframe directly</span><span id="2569" class="lg ka hh lc b fi mf li l lj lk">print(df2<strong class="lc hi">.</strong>isnull()<strong class="lc hi">.</strong>sum())</span></pre><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es mi"><img src="../Images/3f1bf5e708368353b17ec3e450a6d0f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*H4WmsRSUyqOyDMQ0gcE4kA.png"/></div></figure><p id="3b77" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在在最后我们将处理客舱列</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="b27b" class="lg ka hh lc b fi lh li l lj lk">df2['Cabin']<strong class="lc hi">.</strong>value_counts()</span><span id="8aed" class="lg ka hh lc b fi mf li l lj lk">df2['Cabin']<strong class="lc hi">.</strong>mode()</span></pre><p id="c0cc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当我们打印该列的<em class="mb">模式</em>时，它将显示3个值，我们可以选择任何值并用<em class="mb"> nan </em>值替换。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="5598" class="lg ka hh lc b fi lh li l lj lk">df2['Cabin']<strong class="lc hi">.</strong>fillna(df2['Cabin']<strong class="lc hi">.</strong>mode()[0], inplace<strong class="lc hi">=True</strong>)<br/>df2<strong class="lc hi">.</strong>isnull()<strong class="lc hi">.</strong>sum()</span></pre><figure class="kx ky kz la fd ii er es paragraph-image"><div class="er es mj"><img src="../Images/5978ea25de415f338b9dc478127a1201.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*SS-3vTRjwQ2S86CGX5VJwg.png"/></div></figure><p id="b9bd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，我们清理了数据集，这些数据现在可以用于进一步的分析和处理。</p><p id="f1f8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你可以在这里找到我在这篇文章中使用的代码所在的笔记本。<br/>我建议你下载那本笔记本，亲自体验一下，这样你就可以亲自动手写这篇文章了。</p><p id="7228" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> <em class="mb">这篇文章就到此为止，谢谢你的阅读，希望你能从中学到新的东西！</em> </strong></p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="d407" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">资源</h1><figure class="kx ky kz la fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><div class="mm mn ez fb mo mp"><a rel="noopener follow" target="_blank" href="/bitgrit-data-science-publication/data-cleaning-with-python-f6bc3da64e45"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hi fi z dy mu ea eb mv ed ef hg bi translated">用Python清理数据</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">使用Airbnb NY数据集进行数据清理的指南</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">medium.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd in mp"/></div></div></a></div><p id="ff45" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们来连线:</p><ul class=""><li id="c107" class="ne nf hh iw b ix iy jb jc jf ng jj nh jn ni jr nj nk nl nm bi translated"><a class="ae it" href="https://www.linkedin.com/in/uzair-adamjee-28768a102/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a></li><li id="c4b8" class="ne nf hh iw b ix nn jb no jf np jj nq jn nr jr nj nk nl nm bi translated"><a class="ae it" href="https://www.instagram.com/uzairadamjee/" rel="noopener ugc nofollow" target="_blank"> Instagram </a></li><li id="24a8" class="ne nf hh iw b ix nn jb no jf np jj nq jn nr jr nj nk nl nm bi translated"><a class="ae it" href="https://twitter.com/UzairAdamjee" rel="noopener ugc nofollow" target="_blank">推特</a></li></ul><div class="mm mn ez fb mo mp"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hi fi z dy mu ea eb mv ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">medium.com</p></div></div><div class="my l"><div class="ns l na nb nc my nd in mp"/></div></div></a></div></div></div>    
</body>
</html>