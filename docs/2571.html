<html>
<head>
<title>Using Deep Learning modeling to predict Electricity consumption — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习建模来预测电力消耗—第1部分</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/using-deep-learning-modelling-to-predict-electricity-consumption-part-1-20e05101c1f4?source=collection_archive---------8-----------------------#2022-05-19">https://medium.com/mlearning-ai/using-deep-learning-modelling-to-predict-electricity-consumption-part-1-20e05101c1f4?source=collection_archive---------8-----------------------#2022-05-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="c5bc" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">与以前的机器学习模型相比，展示了时间序列中使用的深度学习模型的威力</h2></div><p id="16ac" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi js translated">当科学预测基于历史时间戳数据时，可以进行时间序列预测。这包括通过历史分析建立模型，并使用它们进行观察和推动未来的战略决策。</p><p id="257b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们生活在这样一个时代，节约能源和使用可再生能源是当前全球都在解决的问题。居民家庭的节能措施可以极大地改变环境质量，也可以为消费者带来更多的储蓄。大多数用户能够从他们的提供商那里收集历史能源使用情况，但是只有一些用户能够根据他们的消费需求做出预测。许多管理机构如<a class="ae kb" href="https://www.ccacoalition.org/en/initiatives/household-energy" rel="noopener ugc nofollow" target="_blank">气候&amp;清洁空气联盟(CCAC) </a>旨在保护气候和改善空气质量，家庭能源是其关注的领域之一。使用神经网络预测电力消耗可以改变我们的习惯。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es kc"><img src="../Images/35429d532939e763ceaa8504d49e6ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*uUu5JmPvu5bdy8V77tjFCA.jpeg"/></div><figcaption class="kk kl et er es km kn bd b be z dx">Climate and Clean Air Coalition Org.</figcaption></figure><h1 id="c46b" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">介绍</h1><p id="fa0d" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi js translated">内容:<span class="l jt ju jv bm jw jx jy jz ka di"> C </span>首先将研究预测模型，指数平滑法，其目的是对序列中确定性的部分进行建模。ARIMA模型将允许走得更远，也模拟了该系列的随机组成部分。最后，将研究一些更先进的模型:神经网络、动态回归模型和分组时间序列模型。</p><p id="1092" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于本文的内容较多，本文将分为两部分，第一部分将深入预测随时间变化的电力消耗，第二部分将室外温度作为预测电力消耗的附加变量。</p><h2 id="9731" class="ll kp hh bd kq lm ln lo ku lp lq lr ky jf ls lt la jj lu lv lc jn lw lx le ly bi translated">主题和数据集</h2><p id="d1cf" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> T </span>数据集由3列组成，时间戳、功率(kW)和室外温度(摄氏度),来自欧洲冬季的典型家庭消费。时间戳长度为4604行，从2022年1月1日到2月16日。从1:15到23:45，每隔15分钟测量一次时间戳。这种情况下的目标是预测2022年2月17日的用电量，使用和不使用室外温度(作为一个因素)。大部分工作都是用R/Python (Jupyter笔记本格式)完成的。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es lz"><img src="../Images/b19c7baeb160d1ac1735ee501b53e979.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*h7prxcfgJFK2LkNBLwZgag.jpeg"/></div><figcaption class="kk kl et er es km kn bd b be z dx">Statistics info about the dataset</figcaption></figure><h2 id="2e1a" class="ll kp hh bd kq lm ln lo ku lp lq lr ky jf ls lt la jj lu lv lc jn lw lx le ly bi translated">数据清理</h2><p id="c62c" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">因为观察是每15分钟一次，所以我把它转换成一个小时(60/15=4 ),得到一个每小时一次的频率，这样可以更好地显示图表。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es ma"><img src="../Images/db98d51f75168548fe0c226e097575f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*MIE7pMlgfalW98_eHLWc7A.jpeg"/></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 1: Consumption (Kw) vs Time (hrs) over time</figcaption></figure><h1 id="54c7" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">方法</h1><p id="f07f" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> M </span>取两组数据，训练数据集(80%)和测试数据集(20%),以便运行适当的时间序列预测来适当地评估模型，因为使用了新数据集，这将意味着900行作为训练，227行作为测试。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mb"><img src="../Images/4dac242a491cfd47b60aed11585289aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*utPpbNbc95N1gB1BnCYZiA.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 2: Train and Test Split of Dataset</figcaption></figure><h2 id="aa8b" class="ll kp hh bd kq lm ln lo ku lp lq lr ky jf ls lt la jj lu lv lc jn lw lx le ly bi translated">在不同型号上测试</h2><p id="331b" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">用<a class="ae kb" href="https://machinelearningmastery.com/exponential-smoothing-for-time-series-forecasting-in-python/#:~:text=Single%20Exponential%20Smoothing%2C%20SES%20for,smoothing%20factor%20or%20smoothing%20coefficient." rel="noopener ugc nofollow" target="_blank">简单指数平滑</a> (SES)开始预测，在alpha中没有平滑参数(指数平滑是一种单变量数据的时间序列预测方法)。SES是一个简单的模型，与季节性无关。均方根误差(RMSE)将被用作评估时间序列性能的度量。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mg"><img src="../Images/1d604ae06b915eef02cd262df8837499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Q8OdQe7SSEu-T_tiaX_MA.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 3: SES Model</figcaption></figure><p id="67c2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个模型的RMSE是60.764。虽然RMSE很低，但在这种情况下，从视觉上看，SES是一个糟糕的预测工具。所以我开始用更复杂的模型和更多的参数。</p><h2 id="2c4a" class="ll kp hh bd kq lm ln lo ku lp lq lr ky jf ls lt la jj lu lv lc jn lw lx le ly bi translated">霍尔特-温特斯</h2><p id="710b" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">比如<a class="ae kb" href="https://orangematter.solarwinds.com/2019/12/15/holt-winters-forecasting-simplified/#:~:text=What%20Is%20the%20Holt%2DWinters,cyclical%20repeating%20pattern%20(seasonality)." rel="noopener ugc nofollow" target="_blank">霍尔特-温特斯模型</a>的用法。在这种特殊情况下，可加季节性HW、阻尼可加季节性HW和对阻尼可加季节性HW的Box-Cox变换(这可能是有效的)。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mh"><img src="../Images/0f1c0d417ad55d5beef0638b3f45869c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ISp--AnHc3gvCdSYNE6yw.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 4: Using Holt Winters Models on the Dataset</figcaption></figure><p id="f586" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">每个模型的RMSE，加性季节性HW (73.46)，阻尼加性季节性HW (60.91)，以及带Box-Cox的阻尼加性季节性HW(60.84)。比较所有不同类型的霍尔特-温特斯模型的RMSE误差没有太大差异，正如所观察到的，阻尼HW和具有Box-Cox的阻尼HW的误差与指数平滑保持相同。此外，加性季节性硬件误差表现更差，这可能是因为它们是线性模型。还有一点要注意，正如Box-Cox所看到的，Lambda被自动设置为，而不是被选择，这可能是它性能很差的原因。</p><h2 id="5415" class="ll kp hh bd kq lm ln lo ku lp lq lr ky jf ls lt la jj lu lv lc jn lw lx le ly bi translated">ARIMA</h2><p id="db3d" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">我继续用<a class="ae kb" href="https://www.machinelearningplus.com/time-series/arima-model-time-series-forecasting-python/" rel="noopener ugc nofollow" target="_blank"> ARIMA模型</a>进行预测，看看是否与以前的模型有什么不同</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mi"><img src="../Images/56b3285bb59bc6048e9a29e2b90b1e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IGHjDoks833hwHJSq0RUlQ.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 5: ARIMA Model</figcaption></figure><p id="1c36" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从视觉上看，ARIMA对测试集的预测优于之前观察到的模型。在检查RMSE误差(56.39)时，尽管它比以前的模型低，但它仍然不能做好预测，因为该模型能够在非常小的显著性下进行预测，然后它收敛到零，因为ARIMA通常用于静态数据集中。一个<a class="ae kb" href="https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test" rel="noopener ugc nofollow" target="_blank">增强的Dicker Fuller测试</a>，可以证明这个数据集确实是稳定的，因为P值小于0 . 05，拒绝零假设，换句话说，它具有一些依赖于时间的结构，并且没有随时间的恒定变化</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mj"><img src="../Images/5fbf506fe2929fdd2d3f07ff8f90ebe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUiWM9BTUnjygmY6WHGDgA.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 6: Train dataset ADF Test</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mk"><img src="../Images/73807ec86fba2488877109a9748e908e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKkDLxTVuZhn5rAFXdmpUw.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 7: Test dataset ADF Test</figcaption></figure><h2 id="0170" class="ll kp hh bd kq lm ln lo ku lp lq lr ky jf ls lt la jj lu lv lc jn lw lx le ly bi translated">相关图</h2><p id="7b81" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di">继续</span>，相关性测试可用于使用<a class="ae kb" href="https://towardsdatascience.com/significance-of-acf-and-pacf-plots-in-time-series-analysis-2fa11a5d10a8" rel="noopener" target="_blank">自相关图和部分自相关图</a>识别模式。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es ml"><img src="../Images/a4298c8a20778440ce1754a6642abc9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WpYmoVf6lLBu6GhCPL-LpA.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 8: ACF of Train Dataset</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mm"><img src="../Images/98ebae72ec1b68803b620cf1c0fc0aa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VYflfyQBEhdHmrMv0mmngw.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 9: PACF of Train Dataset</figcaption></figure><p id="cd85" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">理论上，自相关是时间序列中两个值之间的相关性，滞后代表数据集中的时间点。正如所观察到的，滞后位于95%置信区间之外，这可能意味着滞后之间可能相互关联。自相关函数迅速下降到接近零，这是非平稳性的一个属性，它将影响几种预测模型的效率。在这种情况下，ACF和PACF证明了这一点。也有可能该数据是周期性的，而不是季节性的，如果是这种情况，它不能用线性模型建模。</p><h2 id="6703" class="ll kp hh bd kq lm ln lo ku lp lq lr ky jf ls lt la jj lu lv lc jn lw lx le ly bi translated">自回归神经网络</h2><p id="b71f" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> L </span>很快，可以使用<a class="ae kb" href="https://machinelearningmastery.com/deep-learning-for-time-series-forecasting/" rel="noopener ugc nofollow" target="_blank">神经网络</a>对测试数据集进行更好的预测(NN具有学习从输入到输出的复杂映射的能力)。在该模型中，参数p和k由算法自动选择。神经网络由20个网络组成，网络组成为35–18–1，权重为667。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mg"><img src="../Images/078997443e51bcac83b38ce6b4d7f250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dgKr_oC9L0IORBKDNhf5hg.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 10: Neural Network model on Dataset</figcaption></figure><p id="b0c5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从视觉上看，与以前的预测模型相比，这个模型可能是最好的模型。与以前的模型相比，计算RMSE的错误率最高(80.05%)。这是可以接受的，因为它做了更好的预测。</p><p id="2b4f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如先前在先前模型中使用的那样，向数据集添加Box-Cox变换可以稳定NN中的方差。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es mn"><img src="../Images/05acd90ad8dd60fd9f307e2c87336929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*RbnDmGlnAaq-avdDBCHDuw.jpeg"/></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 11: Neural network with added Box-Cox Transformation</figcaption></figure><p id="d2b5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这种情况下，RMSE较低(70.82)，从视觉上看，与所有之前的模型相比，这是预测电力消耗的更好模型。</p><p id="aa24" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了更好地观察来自神经网络的预测，这里根据测试数据集预测神经网络。它并不特别擅长建模，但与以前的模型相比，它更占优势。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es mo"><img src="../Images/b351ebe0321f8f2f5d6372123031d24f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*f2QEG2gAQKl8vFhE2ZjmVA.jpeg"/></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 12: Neural Network on Test Dataset</figcaption></figure><p id="1ad9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，我们用这个神经网络来预测未来。代表全天24小时的96次观察。对2022年2月17日第二天的消耗量进行了预测。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mp"><img src="../Images/a739d82263c7b4a07bcd213e9c435026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wVXUVJnBCtonKHdXFJAykQ.jpeg"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Figure 13: Neural Network future predictions</figcaption></figure><h1 id="4f26" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">第二部分</h1><p id="bdf4" class="pw-post-body-paragraph iw ix hh iy b iz lg ii jb jc lh il je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi js translated">将在未来几周发布的下一篇文章将探索室外温度的附加变量以及使用动态回归的神经网络。</p><p id="3e8a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">敬请期待:)</p><div class="mq mr ez fb ms mt"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hi fi z dy my ea eb mz ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ki mt"/></div></div></a></div></div></div>    
</body>
</html>