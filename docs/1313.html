<html>
<head>
<title>Deploying your ML models on the web, sharing them, and making the awesome web interface part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在web上部署您的ML模型，共享它们，制作令人惊叹的web界面第2部分</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/deploying-your-ml-models-on-the-web-sharing-them-and-making-the-awesome-web-interface-part-2-1db472b1ca0b?source=collection_archive---------1-----------------------#2021-11-19">https://medium.com/mlearning-ai/deploying-your-ml-models-on-the-web-sharing-them-and-making-the-awesome-web-interface-part-2-1db472b1ca0b?source=collection_archive---------1-----------------------#2021-11-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/9200bd18bbd2c5a1768deef126e1d4e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5Wu96RJ_-iWMS5Ys"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@goshua13?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joshua Aragon</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="db3c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在前一部分中，我们已经设计了app.py主界面，在这一部分中，我们将重点关注应用程序的功能。</p><blockquote class="js jt ju"><p id="ecd6" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">前一部分的链接</p></blockquote><div class="jz ka ez fb kb kc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/deploying-your-ml-models-on-the-web-sharing-them-and-making-the-awesome-web-interface-part-1-1b70c6579d71"><div class="kd ab dw"><div class="ke ab kf cl cj kg"><h2 class="bd hi fi z dy kh ea eb ki ed ef hg bi translated">在web上部署您的ML模型，共享它们，制作令人惊叹的web界面第1部分</h2><div class="kj l"><h3 class="bd b fi z dy kh ea eb ki ed ef dx translated">在对某个问题建立了机器学习模型后，你可能想与其他朋友分享，让他们看看…</h3></div><div class="kk l"><p class="bd b fp z dy kh ea eb ki ed ef dx translated">medium.com</p></div></div><div class="kl l"><div class="km l kn ko kp kl kq in kc"/></div></div></a></div><p id="5168" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在继续之前，让我们确保您已经在系统中安装了所有需要的库</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="9bb2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">确保您已经安装了上述库，以便安装这些库。您可以使用导航到上述文件来安装这些库(确保您将此文件保存在项目目录中，我们将需要它来在云计算机上安装库)</p><pre class="kr ks kt ku fd kx ky kz la aw lb bi"><span id="79c8" class="lc ld hh ky b fi le lf l lg lh">pip install -r requirements.txt</span></pre><h2 id="0553" class="lc ld hh bd li lj lk ll lm ln lo lp lq jf lr ls lt jj lu lv lw jn lx ly lz ma bi translated">最后一次编辑app.py</h2><p id="5bcc" class="pw-post-body-paragraph iu iv hh iw b ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn mf jp jq jr ha bi translated">我们将取消对上一部分if-else阶梯的注释，并以<code class="du mg mh mi ky b">streamlit run app.py</code>开始我们的应用程序</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><h2 id="2e1e" class="lc ld hh bd li lj lk ll lm ln lo lp lq jf lr ls lt jj lu lv lw jn lx ly lz ma bi translated">编辑功能. py</h2><p id="8ccc" class="pw-post-body-paragraph iu iv hh iw b ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn mf jp jq jr ha bi translated">在这一部分，我们将编写应用程序的功能</p><p id="0f31" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在创建应用程序的功能之前，我们将确保我们的模型为此做好准备。我发现drive是存储模型的最佳平台，因为在GitHub上，我们可以存储高达20 MB的模型。</p><p id="1cf2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">确保您的模型是<code class="du mg mh mi ky b">h5</code>格式的，并上传到驱动器上</p><p id="1c3e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这里，我已经上传了模型，你可以使用这个或者上传你自己的模型，并确保你设置的文件对每个人都可见</p><pre class="kr ks kt ku fd kx ky kz la aw lb bi"><span id="2dc3" class="lc ld hh ky b fi le lf l lg lh"><a class="ae it" href="https://drive.google.com/uc?id=1--eULExMNhEKGiY4zZmdSB7dvMwh0nOX" rel="noopener ugc nofollow" target="_blank">https://drive.google.com/uc?id=1--eULExMNhEKGiY4zZmdSB7dvMwh0nOX</a></span></pre><p id="2a52" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们导入所有需要的库和URL</p><pre class="kr ks kt ku fd kx ky kz la aw lb bi"><span id="c060" class="lc ld hh ky b fi le lf l lg lh"><em class="jv">import</em> json<br/><em class="jv">import</em> streamlit <em class="jv">as</em> st<br/><em class="jv">import</em> tensorflow_text <em class="jv">as</em> text<br/><em class="jv">import</em> tensorflow_hub <em class="jv">as</em> hub<br/><em class="jv">import</em> tensorflow <em class="jv">as</em> tf<br/><em class="jv">import</em> gdown<br/><em class="jv">import</em> os</span><span id="0162" class="lc ld hh ky b fi mj lf l lg lh">model_url = "https://drive.google.com/uc?id=1--eULExMNhEKGiY4zZmdSB7dvMwh0nOX"<br/>model_path = './Best_model_emotion.h5'</span></pre><p id="cbc0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们为主要功能编写run_app函数，它将作为我们</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="55a9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这个函数中，我们使用<code class="du mg mh mi ky b">st.text_area</code>函数输入用户文本，这将在应用程序的屏幕上创建一个文本区域</p><p id="bea6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我尝试使用firebase python API在firebase数据集上存储我的预测，但这不是一个必要的步骤，我们现在将忽略存储预测</p><p id="92e5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">之后，我们调用load_model函数，我们将在获得模型后编写该函数，我们使用<code class="du mg mh mi ky b">model.predict</code>函数进行预测</p><p id="e0ab" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后我们可以用<code class="du mg mh mi ky b">st.title</code>功能将预测显示在屏幕上</p><h2 id="6c40" class="lc ld hh bd li lj lk ll lm ln lo lp lq jf lr ls lt jj lu lv lw jn lx ly lz ma bi translated">创建load_model函数</h2><p id="75be" class="pw-post-body-paragraph iu iv hh iw b ix mb iz ja jb mc jd je jf md jh ji jj me jl jm jn mf jp jq jr ha bi translated">我们将在<code class="du mg mh mi ky b">functionality.py</code>中创建这个函数</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="4628" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个模型负责从驱动器下载我们保存的模型，并确保它正确加载到我们的云机器中</p><p id="6de9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了验证模型是否存在，避免一次又一次地下载模型，每次加载时，我们都必须验证模型是否存在于我们的模型路径中，以及它是否工作正常</p><p id="0251" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了下载模型，我们使用了<code class="du mg mh mi ky b">gdown</code>库，这个库帮助我们从驱动器下载文件</p><p id="4f98" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你得到一个模块没有找到的错误，然后在你的终端运行<code class="du mg mh mi ky b">pip install gdown</code></p><p id="57ff" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我们的例子中，模型是使用TensorFlow构建的，我们使用USE作为特征提取的基础模型。</p><p id="eb0f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们使用Keras <code class="du mg mh mi ky b">load_model</code>函数加载模型，并返回它以便对该模型进行预测。</p><h2 id="d987" class="lc ld hh bd li lj lk ll lm ln lo lp lq jf lr ls lt jj lu lv lw jn lx ly lz ma bi translated">完整的functionality.py文件</h2><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kv kw l"/></div></figure><p id="8fa8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，确保提交并推送至GitHub库。如果你想学习如何在GitHub上推送文件，请参考<a class="mk ml ge" href="https://medium.com/u/9ca3204a0400?source=post_page-----1db472b1ca0b--------------------------------" rel="noopener" target="_blank">杰耶什·贾因</a>的博客</p><div class="jz ka ez fb kb kc"><a rel="noopener follow" target="_blank" href="/@jayeshjain_246/github-for-beginners-8ff6b072539b"><div class="kd ab dw"><div class="ke ab kf cl cj kg"><h2 class="bd hi fi z dy kh ea eb ki ed ef hg bi translated">适合初学者的GitHub</h2><div class="kj l"><h3 class="bd b fi z dy kh ea eb ki ed ef dx translated">在这篇博客中，我试图用一种非常初学者友好的方式来解释GitHub及其用法，这样他们就有了一个清晰的视角</h3></div><div class="kk l"><p class="bd b fp z dy kh ea eb ki ed ef dx translated">medium.com</p></div></div><div class="kl l"><div class="mm l kn ko kp kl kq in kc"/></div></div></a></div><p id="c258" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果您在运行并导航到<code class="du mg mh mi ky b">run_app</code>栏后正确完成了所有步骤</p><pre class="kr ks kt ku fd kx ky kz la aw lb bi"><span id="5665" class="lc ld hh ky b fi le lf l lg lh"> streamlit run app.py</span></pre><p id="c0b5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你应该有一些类似的屏幕</p><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mn"><img src="../Images/aa81554d8db0124eae03914ca6180fb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w-EO1ndNcAk7UTuK4YYOzQ.png"/></div></div></figure><p id="76cb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，您几乎处于部署的最后阶段，您只需要设置一个云机器，然后您就可以与您的朋友分享您的模型了😃</p><p id="ccc8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将在本教程的下一部分讨论在Streamlit.cloud上设置云机器并共享我们的应用程序</p><blockquote class="js jt ju"><p id="e411" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">感谢你阅读我的博客:)关注更多，在评论中向我问好，这给了我写更多博客的鼓励:)祝你有美好的一天:)</p></blockquote><div class="jz ka ez fb kb kc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kd ab dw"><div class="ke ab kf cl cj kg"><h2 class="bd hi fi z dy kh ea eb ki ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kj l"><h3 class="bd b fi z dy kh ea eb ki ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kk l"><p class="bd b fp z dy kh ea eb ki ed ef dx translated">medium.com</p></div></div><div class="kl l"><div class="mo l kn ko kp kl kq in kc"/></div></div></a></div></div></div>    
</body>
</html>