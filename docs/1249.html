<html>
<head>
<title>Significance Testing and Confidence Intervals in Python with non-normal data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中非正态数据的显著性检验和置信区间</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/significance-testing-and-confidence-intervals-in-python-with-non-normal-data-e169d7302cc?source=collection_archive---------4-----------------------#2021-11-05">https://medium.com/mlearning-ai/significance-testing-and-confidence-intervals-in-python-with-non-normal-data-e169d7302cc?source=collection_archive---------4-----------------------#2021-11-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/ef6c984501e2750e75bb32b93a6cdc07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IdqpL867Ab9yNa28"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Photo by <a class="ae hu" href="https://unsplash.com/@mangofantasy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tim Johnson</a> on <a class="ae hu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="64d7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作为我职责的一部分，我必须定期对我们一直在进行的A/B测试的结果进行显著性测试。现在，这些结果不是正态分布的，如果有的话，它们是向轴倾斜的，有一个长尾巴。因此，使用t检验是不可能的。</p><p id="10af" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">曼恩-惠特尼U检验<br/> </strong>在这种情况下，我求助于曼恩-惠特尼U检验<br/>下面是来自<a class="ae hu" href="https://www.statstutor.ac.uk/resources/uploaded/mannwhitney.pdf" rel="noopener ugc nofollow" target="_blank">的一个优雅的定义https://www . stats tutor . AC . uk/resources/uploaded/mannwhitney . pdf</a></p><blockquote class="js jt ju"><p id="e0c5" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">Mann-Whitney U检验是一种非参数检验，可用于替代不成对t检验。它用于检验两个样本来自同一总体(即具有相同的中位数)的零假设，或者检验一个样本中的观察值是否倾向于大于另一个样本中的观察值。</p></blockquote><p id="2786" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">我们如何在Python中使用它？下面是我用Python做显著性测试的脚本。我有一个示例数据集的链接，您可以从github访问它</strong></p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="0988" class="ki kj hx ke b fi kk kl l km kn">import pandas as pd<br/>import numpy as np<br/>import scipy.stats as stats</span><span id="256a" class="ki kj hx ke b fi ko kl l km kn">df=pd.read_csv(‘<a class="ae hu" href="https://raw.githubusercontent.com/bilalmussa/st_sig_testing/main/test_control_data.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/bilalmussa/st_sig_testing/main/test_control_data.csv'</a>)</span><span id="6dda" class="ki kj hx ke b fi ko kl l km kn">group1 = df[df[‘AnalysisFlag’]==’Test’][‘DP’].to_list()<br/>group2 = df[df[‘AnalysisFlag’]==’Control’][‘DP’].to_list()</span><span id="6399" class="ki kj hx ke b fi ko kl l km kn">s, p = stats.mannwhitneyu(group1, group2, alternative=’two-sided’)</span><span id="e572" class="ki kj hx ke b fi ko kl l km kn">print(“Statistc: “,s)<br/>print(“P Value: “,p)<br/>#Statistc: 6966579.5<br/>#P Value: 0.6559138409860421<br/>#In this case, there is no significance at any conventional level</span></pre><p id="d2e9" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">就是这样，这将告诉我们，测试和控制之间是否有显著差异。</p><p id="ec2d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">置信区间<br/> </strong>下一步是使用自举创建置信区间。本质上，我们要从我们的数据集中采样N次。在此过程中，它将基于我们的重复次数(我们想要重新采样的次数)和alpha值(总体参数位于置信区间之外的可能性)来构建置信区间</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="d17e" class="ki kj hx ke b fi kk kl l km kn">def bootstrap_ci(df, variable, classes, repetitions = 1000, alpha = 0.05, random_state=None): <br/> df = df[[variable, classes]]<br/> bootstrap_sample_size = len(df) <br/> <br/> mean_diffs = []<br/> for i in range(repetitions):<br/> bootstrap_sample = df.sample(n = bootstrap_sample_size, replace = True, random_state = random_state)<br/> mean_diff = bootstrap_sample.groupby(classes).mean().iloc[1,0] — bootstrap_sample.groupby(classes).mean().iloc[0,0]<br/> mean_diffs.append(mean_diff)<br/> # confidence interval<br/> left = np.percentile(mean_diffs, alpha/2*100)<br/> right = np.percentile(mean_diffs, 100-alpha/2*100)<br/> # point estimate<br/> point_est = df.groupby(classes).mean().iloc[1,0] — df.groupby(classes).mean().iloc[0,0]<br/> print(‘Point estimate of difference between means:’, round(point_est,2))<br/> print((1-alpha)*100,’%’,’confidence interval for the difference between means:’, (round(left,2), round(right,2)),’ this is base on ‘,repetitions, ‘ repetitions’)<br/> <br/>#run the function using the below <br/>bootstrap_ci(df,’DP’,’AnalysisFlag’,100,0.1)<br/>#Point estimate of difference between means: 0.01<br/>#90.0 % confidence interval for the difference between means: (-0.0, #0.03) this is base on 100 repetitions</span></pre><p id="9e7d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">仅此而已。请随意留下您的任何反馈，祝显著性测试愉快！</p><div class="hg hh ez fb hi kp"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kq ab dw"><div class="kr ab ks cl cj kt"><h2 class="bd hy fi z dy ku ea eb kv ed ef hw bi translated">Mlearning.ai提交建议</h2><div class="kw l"><h3 class="bd b fi z dy ku ea eb kv ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kx l"><p class="bd b fp z dy ku ea eb kv ed ef dx translated">medium.com</p></div></div><div class="ky l"><div class="kz l la lb lc ky ld ho kp"/></div></div></a></div></div></div>    
</body>
</html>