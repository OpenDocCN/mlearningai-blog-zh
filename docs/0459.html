<html>
<head>
<title>Load pre-trained GloVe embeddings in torch.nn.Embedding layer… in under 2 minutes! 🏎🔥</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将预先训练好的手套嵌入物装入torch.nn.Embedding layer…不到两分钟！🏎🔥</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/load-pre-trained-glove-embeddings-in-torch-nn-embedding-layer-in-under-2-minutes-f5af8f57416a?source=collection_archive---------0-----------------------#2021-04-25">https://medium.com/mlearning-ai/load-pre-trained-glove-embeddings-in-torch-nn-embedding-layer-in-under-2-minutes-f5af8f57416a?source=collection_archive---------0-----------------------#2021-04-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="edb5" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">一个直接从<a class="ae ja" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">其官方项目页面</a>获取的将预先训练好的手套单词嵌入到<code class="du iw ix iy iz b">torch.nn.Embedding</code>层的实用教程</h2></div><figure class="jc jd je jf fd jg er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es jb"><img src="../Images/19895d9a062b02fa5e18309df84c22eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cag2urrpAcDUmDYFc1Lxhw.jpeg"/></div></div><figcaption class="jn jo et er es jp jq bd b be z dx">Photo by <a class="ae ja" href="https://unsplash.com/@traf?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Traf</a> on <a class="ae ja" href="https://unsplash.com/s/photos/fast?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b079" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hi">步骤1: </strong>下载嵌入</p><p id="fb0c" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">选择适合您的嵌入。我选择<a class="ae ja" href="http://nlp.stanford.edu/data/glove.6B.zip" rel="noopener ugc nofollow" target="_blank">维基百科2014 + Gigaword 5 </a>变种。</p><figure class="jc jd je jf fd jg"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="0cad" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">您可以在Jupyter环境(例如Google Colab)中执行这些代码。如果不可用，请在shell中单独执行这些操作。</p><p id="903a" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hi">步骤2: </strong>解析词汇表和嵌入</p><p id="8c3f" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">我将加载50维嵌入。您也可以从100、200或300维选项中选择。</p><figure class="jc jd je jf fd jg"><div class="bz dy l di"><div class="kn ko l"/></div></figure><ol class=""><li id="8973" class="kp kq hh jt b ju jv jx jy ka kr ke ks ki kt km ku kv kw kx bi translated"><code class="du iw ix iy iz b">vocab</code>:单词列表，将在文本到令牌id转换步骤中有用</li><li id="523a" class="kp kq hh jt b ju ky jx kz ka la ke lb ki lc km ku kv kw kx bi translated"><code class="du iw ix iy iz b">embeddings</code>:嵌入列表，这将用于初始化嵌入层</li></ol><p id="cf52" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hi">步骤3: </strong>将词汇表和嵌入转换成numpy数组</p><figure class="jc jd je jf fd jg"><div class="bz dy l di"><div class="kn ko l"/></div></figure><ol class=""><li id="d489" class="kp kq hh jt b ju jv jx jy ka kr ke ks ki kt km ku kv kw kx bi translated"><code class="du iw ix iy iz b">vocab_npa</code>:numpy形状数组(vocab大小，)</li><li id="296a" class="kp kq hh jt b ju ky jx kz ka la ke lb ki lc km ku kv kw kx bi translated"><code class="du iw ix iy iz b">embs_npa</code>:形状的numpy数组(vocab大小，嵌入维数)</li></ol><p id="2571" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hi">步骤4: </strong>将<em class="ld">填充</em>和<em class="ld">未知</em>令牌添加到<code class="du iw ix iy iz b">vocab</code>和<code class="du iw ix iy iz b">embeddings</code>数组中</p><figure class="jc jd je jf fd jg"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="3a25" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">我选择了:(1)填充符标记嵌入为零，以及(2)未知的<em class="ld">标记嵌入作为所有其他嵌入的平均值。</em></p><p id="c298" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hi">步骤5: </strong>使用下载的嵌入初始化嵌入层</p><figure class="jc jd je jf fd jg"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="2629" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hi">第六步(可选):</strong>保存<code class="du iw ix iy iz b">vocab_npa</code>和<code class="du iw ix iy iz b">embs_npa</code>数组，以后可以轻松加载。</p><figure class="jc jd je jf fd jg"><div class="bz dy l di"><div class="kn ko l"/></div></figure><h2 id="c092" class="le lf hh bd lg lh li lj lk ll lm ln lo ka lp lq lr ke ls lt lu ki lv lw lx ly bi translated"><strong class="ak">下一步</strong></h2><p id="1215" class="pw-post-body-paragraph jr js hh jt b ju lz ii jw jx ma il jz ka mb kc kd ke mc kg kh ki md kk kl km ha bi translated">太好了！现在你知道如何使用手套嵌入的任何变体来初始化你的嵌入层。</p><p id="9ea4" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">通常，在接下来的步骤中，您需要:</p><ol class=""><li id="3dff" class="kp kq hh jt b ju jv jx jy ka kr ke ks ki kt km ku kv kw kx bi translated">定义一个<code class="du iw ix iy iz b">torch.nn.Module</code>来设计自己的模型。该模型将包含本教程中初始化的<code class="du iw ix iy iz b">torch.nn.Embedding</code>层。</li><li id="b291" class="kp kq hh jt b ju ky jx kz ka la ke lb ki lc km ku kv kw kx bi translated">定义一个接受文本样本的<code class="du iw ix iy iz b">torch.utils.data.Dataset</code>,并将其转换成<code class="du iw ix iy iz b">torch.nn.Embedding</code>层可以理解的形式。</li></ol><p id="5454" class="pw-post-body-paragraph jr js hh jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">我将在接下来的文章中介绍这两个步骤！我还在我的一个github项目的笔记本中讲述了这些步骤。请随意查看！</p></div></div>    
</body>
</html>