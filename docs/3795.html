<html>
<head>
<title>Data Wrangling using Pyspark in Data bricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在数据砖中使用Pyspark进行数据辩论</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/data-wrangling-using-pyspark-in-data-bricks-75cf25bfb4ef?source=collection_archive---------6-----------------------#2022-10-22">https://medium.com/mlearning-ai/data-wrangling-using-pyspark-in-data-bricks-75cf25bfb4ef?source=collection_archive---------6-----------------------#2022-10-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/42ae49155130084270aa08717882fdd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cKaFKmxLVIfoNJTT"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@purzlbaum?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Claudio Schwarz</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e9f9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">嘿伙计们，</p><p id="2be9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Databricks <strong class="iw hi">为您的所有数据</strong>提供了一个统一、开放的平台。它为数据科学家、数据工程师和数据分析师提供了一个简单的协作环境，让他们能够运行交互式的预定数据分析工作负载。你可以得到你自己的一块馅饼来做实验。它让你能够用少数几种编程语言进行分析。</p><p id="4234" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这篇文章中，我将带您完成一个使用pyspark在数据块上清理数据的简单练习，所以让我们深入研究一下。</p><p id="4c33" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先，我们需要一个数据砖环境，社区版是一个很好的起点。点击这里，查看我关于如何建立自己的社区版<a class="ae it" rel="noopener" href="/mlearning-ai/how-to-use-data-bricks-community-edition-9b899a2c0f40">的帖子。</a></p><p id="93df" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们从导入库开始。</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="f267" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们检查形状(数据集的行数和列数)</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="e1a7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">数据集很大，为了保持实验简单，我们删除一些列。</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="73d6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">select()方法有助于只选择列表中指定的列，此外，由于pyspark数据帧是不可变的，所以在进行任何类型的转换时，我们都必须定义一个新的数据帧。另外，Cache()方法提供了一种优化机制，我们在其中存储Spark数据帧的中间计算，以便可以在后续操作中重用它。</p><p id="7147" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">快速浏览一下数据帧，我们看到price列前面有“$”值，也将这些列的数据类型更改为“double”。</p><figure class="js jt ju jv fd ii er es paragraph-image"><div class="er es jy"><img src="../Images/85a18701db4c38b69dffad28469d3e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/format:webp/1*kkUmWAHu66xZeQG6mGFiWA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx"><em class="jz">Screenshot for Price Column</em></figcaption></figure><p id="c33c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这里，我们将使用withColumn()方法来修改现有的price列，首先使用translate函数，该函数通过已经给定的replace字符串来翻译与列中给定的匹配字符串匹配的任何字符。</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="jw jx l"/></div></figure><figure class="js jt ju jv fd ii er es paragraph-image"><div class="er es ka"><img src="../Images/5cd842b4e1c14a1ecbfc0ff7924b871a.png" data-original-src="https://miro.medium.com/v2/resize:fit:228/format:webp/1*lCTqzxg9d5UVvLQziFes1Q.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Price Column post transformation</figcaption></figure><p id="d9aa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">分析数据时的下一个动作是汇总统计数据，现在可以通过3种方式来完成..</p><ol class=""><li id="a33c" class="kb kc hh iw b ix iy jb jc jf kd jj ke jn kf jr kg kh ki kj bi translated">描述:计数、平均值、标准差、最小值、最大值</li></ol><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kk"><img src="../Images/4bf8fc859994dc10f0b72248b376815d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2b2F76auoAP31DcSQOnFA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Sample output for Describe Method</figcaption></figure><p id="7248" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2.汇总:描述+四分位数间距(IQR)</p><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kl"><img src="../Images/e55ed284957239a4e8a984feb5037694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jhi8mGJ4hYod7Mv5TIpJlg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Sample Output for Summary Method</figcaption></figure><p id="456e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.dbutils . data . summary:这将生成表格格式的结果和分布。</p><figure class="js jt ju jv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es km"><img src="../Images/c0870714e1924a6815e10fc35ff16555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qFck3K3O28hTMeOsx4xlcg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Sample output for dbutils.data.summarize</figcaption></figure><p id="e39b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这三个命令的语法如下:</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="7e23" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">敬请关注更多此类内容！下一集再见！！快乐学习！</p><div class="kn ko ez fb kp kq"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hi fi z dy kv ea eb kw ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">medium.com</p></div></div><div class="kz l"><div class="la l lb lc ld kz le in kq"/></div></div></a></div></div></div>    
</body>
</html>