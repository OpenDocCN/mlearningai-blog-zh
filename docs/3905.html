<html>
<head>
<title>Chest X-Ray Image Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">胸部x光图像分类</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/chest-x-ray-image-classification-a555c6d242c?source=collection_archive---------8-----------------------#2022-11-08">https://medium.com/mlearning-ai/chest-x-ray-image-classification-a555c6d242c?source=collection_archive---------8-----------------------#2022-11-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/6a3ca1390ca96f752847df63fc733665.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*rYKXplBv4WccSCX05-caqg.png"/></div><figcaption class="il im et er es in io bd b be z dx">Source Mendeley Data</figcaption></figure><p id="68ff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi jn translated">他的文章详细介绍了一种图像分类器，将胸部x光图像分为肺炎和正常。为此，在Kaggle中找到了一个数据集，使用此处的链接<a class="ae jw" href="https://data.mendeley.com/datasets/rscbjbr9sj/2" rel="noopener ugc nofollow" target="_blank"/>。代码可以在<a class="ae jw" href="https://github.com/thiagolimaop/chest-x-ray-classifier" rel="noopener ugc nofollow" target="_blank">我的GitHub </a>上找到。</p><p id="84e9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">肺炎<em class="jx">胸部x光片</em>显示一个或两个肺部异常浑浊，正常胸部x光片显示肺部清晰，图像中没有任何异常浑浊区域。正如<a class="ae jw" href="https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中所解释的，数据集中的每幅图像都由两位专家医师进行分级。</p><p id="9b64" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">用于处理该数据集(1GB)的策略是将其放入Google Drive，并使用Google Collab和TensorFlow和Keras。</p><h1 id="84f2" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">数据理解</h1><p id="5e53" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">将从数据集存储库下载的压缩文件插入Google Drive文件夹后，下面的步骤是解压缩文件图像，如下所示:</p><figure class="lb lc ld le fd ii"><div class="bz dy l di"><div class="lf lg l"/></div><figcaption class="il im et er es in io bd b be z dx">Unzipping the image files</figcaption></figure><p id="ddbc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">看一下目录，没有找到验证目录，这对于帮助我们理解学习曲线和获得一些见解是必不可少的。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/447fbfc98268a634da87ec598f4eb6f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*W6TpJP9tvappKzaMGwz2Xg.png"/></div><figcaption class="il im et er es in io bd b be z dx">Directory tree of the unzipped files</figcaption></figure><p id="90ba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据的分布描述如下:</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es li"><img src="../Images/e6fc30ccf1b0cf7756ef0ffbdd66e6b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*uY5DUSspBluMQxIz-YL3ow.png"/></div></div></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es ln"><img src="../Images/31a564fb7b419c63e2561f3d01e06629.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*osrTJYBzIiGQsbt0XkYfZw.png"/></div><figcaption class="il im et er es in io bd b be z dx">Distribution of the data</figcaption></figure><p id="1815" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">考虑到吴恩达教授(斯坦福)提出的引入交叉验证的比例(60%的数据用于训练，20%用于验证，20%用于测试)，让我们产生数据集的一些统计数据，以在ower数据集上实现这些比例:</p><ul class=""><li id="a4b8" class="lo lp hh ir b is it iw ix ja lq je lr ji ls jm lt lu lv lw bi translated">胸部x光照片总数(训练集+测试集):5，857</li><li id="dfc1" class="lo lp hh ir b is lx iw ly ja lz je ma ji mb jm lt lu lv lw bi translated">胸部x光照片总数的20 %: 1171张</li><li id="41f8" class="lo lp hh ir b is lx iw ly ja lz je ma ji mb jm lt lu lv lw bi translated"><strong class="ir hi">肺炎</strong>验证<strong class="ir hi">所需胸片总数</strong>套:869张</li><li id="05d1" class="lo lp hh ir b is lx iw ly ja lz je ma ji mb jm lt lu lv lw bi translated"><strong class="ir hi">验证</strong>组需要的<strong class="ir hi">正常</strong>胸部x光片总数:302张</li><li id="fc09" class="lo lp hh ir b is lx iw ly ja lz je ma ji mb jm lt lu lv lw bi translated">总计<strong class="ir hi">肺炎</strong>胸部x光片<strong class="ir hi">测试</strong>需要:479</li><li id="0b45" class="lo lp hh ir b is lx iw ly ja lz je ma ji mb jm lt lu lv lw bi translated"><strong class="ir hi">测试</strong>组需要的<strong class="ir hi">正常</strong>胸部x光片总数:68张</li></ul><p id="f7fa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">由于测试集有624幅图像，我们从训练集中得到一个精简的图像集，以获得正确的比例。为了实现这些比例，我们创建了一个函数，从一个文件夹中获取随机图像，并将它们移动到另一个文件夹中。</p><figure class="lb lc ld le fd ii"><div class="bz dy l di"><div class="lf lg l"/></div><figcaption class="il im et er es in io bd b be z dx">Code to transfer a set of random images from a source to a destiny</figcaption></figure><h1 id="7142" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">数据准备</h1><p id="b59e" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">本质上，这一步包括从磁盘中读取数据，并在数据上设置所需的准备来训练它们。我们需要知道的第一件事是，神经元网络需要一个固定大小的输入。由于我们的图像没有模式宽度和高度，我们需要将所有图像调整到相同的大小。选择的尺寸是150×150像素。我们还将像素值归一化到从0到1的范围内。</p><p id="fb32" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这一步可能是任何项目中的游戏规则改变者，因为在这里我们实现了一些增强来防止过度拟合。但是不是任何增强在任何数据集中都能很好地工作。增强需要对数据集有意义，以产生与数据集中已经存在的图像相似的图像。</p><p id="e6a8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下面我们可以看到数据集中一些“远离平均值”的图像示例。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es mc"><img src="../Images/b3332d79c013085c10c41bd642b0ed78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AyCXEJ0NfEJ5UwO7nFALBg.png"/></div></div><figcaption class="il im et er es in io bd b be z dx">Rotate images</figcaption></figure><p id="596b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上图中，我们可以看到前四幅图像显示了15°到20°之间的胸部旋转。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="er es md"><img src="../Images/22b052921fcd7c5982bab5e3ff5f10fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zw5_5EelrsdXdYKoh0xQrg.png"/></div></div><figcaption class="il im et er es in io bd b be z dx">Zoom images</figcaption></figure><p id="4b3e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面可以看到更接近视图的图像(前四幅图像),就好像这些图像被放大了一样。</p><p id="a379" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后使用的增强是旋转20度和缩放30度。这些增强可以帮助我们防止过度拟合。</p><figure class="lb lc ld le fd ii"><div class="bz dy l di"><div class="lf lg l"/></div><figcaption class="il im et er es in io bd b be z dx">Appling zoom and rotation augmentations</figcaption></figure><h1 id="e221" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">模型架构</h1><p id="9bd3" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">该项目将使用CNN(卷积神经网络)架构来创建模型。该模型由四个卷积块组成，每个卷积块中有一个最大池层。我们还使用了漏失层，这是另一种帮助我们防止过度拟合的技术。这项技术包括在数据经过这些时期时随机关闭一些神经元，迫使其他神经元完成所有工作。该模型将在最后一个图层中使用softmax输出两个类别(正常或肺炎)的类别概率。模型训练也使用Adam的优化器。</p><figure class="lb lc ld le fd ii"><div class="bz dy l di"><div class="lf lg l"/></div></figure><h1 id="8da3" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">训练实验和结果</h1><p id="9719" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">使用相同的模型架构进行了五个训练实验。</p><h2 id="63ff" class="me jz hh bd ka mf mg mh ke mi mj mk ki ja ml mm km je mn mo kq ji mp mq ku mr bi translated">实验一</h2><p id="8b39" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">在第一个实验中，使用了没有增强的训练集。了解初始精度和学习曲线。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es ms"><img src="../Images/dc0d740d1b482c1182f0b6a528c6bc15.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*c4gypIyDEe1caCNE-IcNgQ.png"/></div><figcaption class="il im et er es in io bd b be z dx">Learning curve — Experiment I</figcaption></figure><p id="f1a7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">正如我们从图中看到的，验证损失随着时间的推移而增加，这表明过度拟合。本实验的测试准确率为87.11%。</p><h2 id="7d98" class="me jz hh bd ka mf mg mh ke mi mj mk ki ja ml mm km je mn mo kq ji mp mq ku mr bi translated">实验二</h2><p id="7f4d" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">第二个实验是验证在训练数据集上应用20的旋转增量的想法，并看看这一步是否有助于我们防止过拟合并提高准确性。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es mt"><img src="../Images/0ce45a966380caf99e34a8bb3854e798.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*hTDpZKzJgPg6xh_HJOUXqQ.png"/></div><figcaption class="il im et er es in io bd b be z dx">Learning curve — Experiment II</figcaption></figure><p id="7d6a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个实验的测试准确率为90%(比第一个实验高出近3%)。</p><h2 id="c204" class="me jz hh bd ka mf mg mh ke mi mj mk ki ja ml mm km je mn mo kq ji mp mq ku mr bi translated">实验三</h2><p id="2abb" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">第三个实验是验证在训练数据集上应用30%的缩放增强的想法，并看看这一步是否有助于我们防止过度拟合并提高准确性。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es mu"><img src="../Images/cfac8fa0e5814dbf054569814bc6a988.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*Sgub8Lf7j-GJc9EXzaTyqg.png"/></div><figcaption class="il im et er es in io bd b be z dx">Learning curve — Experiment III</figcaption></figure><p id="3648" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个实验的测试精度是93.94%(比第一个实验高7%)。</p><h2 id="ee43" class="me jz hh bd ka mf mg mh ke mi mj mk ki ja ml mm km je mn mo kq ji mp mq ku mr bi translated">实验四</h2><p id="cd67" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">在这个实验中，为了增加精确度，探索了亮度增强。这一线索是在名为《公共科学图书馆·综合》(Plos One)(专门从事科学和医学)的期刊上的一篇<a class="ae jw" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0265949" rel="noopener ugc nofollow" target="_blank">文章</a>中发现的。该文章展示了降低/增加亮度的良好效果。该实验尝试在70%到130%的范围内调节亮度。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es mt"><img src="../Images/c4bb9b1d31dc782ef56a1c9ec7adcbce.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*uTbgexL9bmveGRyHUwWdvg.png"/></div><figcaption class="il im et er es in io bd b be z dx">Learning curve — Experiment IV</figcaption></figure><p id="a35e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">学习曲线是过度拟合的明显标志。本实验的测试准确率为87.79%。与第一次实验相比，精确度的提高非常小。</p><h2 id="2b3d" class="me jz hh bd ka mf mg mh ke mi mj mk ki ja ml mm km je mn mo kq ji mp mq ku mr bi translated">实验五</h2><p id="bba4" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">实验II和III因其准确性而脱颖而出，帮助我们防止过度拟合。在两个实验中使用了50个时期，这被证明是不够的。因此，在这个实验中，我们使用与之前相同的配置，使用缩放和旋转增强来尝试80个历元。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es mv"><img src="../Images/d239801b86330fbe67d342956b137b18.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*_MiHqxh0P4M5yIoaJD4Acw.png"/></div><figcaption class="il im et er es in io bd b be z dx">Learning curve — Experiment V</figcaption></figure><p id="a42f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个实验的测试精度是95%(与第一个实验相比，几乎高了8%)。</p><h1 id="80c4" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">讨论</h1><p id="487f" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">最后一个实验展示了更好的结果。但是加入上一个亮度增强的实验是个好主意。即使实验四没有展示出很好的结果，它的学习曲线的可变性更小，我们在准确性上也略有提高。也可以探索其他的增强。</p><p id="c432" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你发现这篇文章中有任何不一致的地方，请随时通过这里或我的<a class="ae jw" href="https://www.linkedin.com/in/thiago-lima-3b0370111/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。如果您没有发现任何不一致之处，只是想谈谈数据科学，也可以随时联系我。感谢您读到这里！</p><div class="mw mx ez fb my mz"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="na ab dw"><div class="nb ab nc cl cj nd"><h2 class="bd hi fi z dy ne ea eb nf ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ng l"><h3 class="bd b fi z dy ne ea eb nf ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nh l"><p class="bd b fp z dy ne ea eb nf ed ef dx translated">medium.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn ij mz"/></div></div></a></div></div></div>    
</body>
</html>