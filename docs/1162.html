<html>
<head>
<title>Journeying through Fastai: Building an Image Classifier using Kaggle Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">穿越Fastai:使用Kaggle数据构建图像分类器</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/journeying-through-fastai-building-an-image-classifier-using-kaggle-data-9bc5762fe676?source=collection_archive---------0-----------------------#2021-10-15">https://medium.com/mlearning-ai/journeying-through-fastai-building-an-image-classifier-using-kaggle-data-9bc5762fe676?source=collection_archive---------0-----------------------#2021-10-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2b41" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">选择的悖论。</p><p id="2f6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为深度学习领域的热情初学者，我被分散在互联网上的大量资源淹没了，每个资源都声称是“最好的”。</p><ul class=""><li id="c055" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">PyTorch vs TensorFlow？</li><li id="7d99" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">数学vs编码？</li><li id="20f9" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">Coursera vs Udemy？</li></ul><p id="904b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你像我一样是个新手，我想在你旅程的某个阶段，你一定也经历过类似的经历——不知道从哪里开始，没有任何进展。感受到这种烦恼后，我最终决定选择我找到的一门课程，并坚持下去直到完成。</p><p id="74a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这门课叫做Fastai，由出色的杰瑞米·霍华德教授。</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="d38e" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">Fastai是什么？</h1><p id="1bb8" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">Fastai是一个构建在PyTorch之上的库，它提供了高级和低级功能，简化了最先进的神经网络的构建和训练。Fastai旨在让越来越多的人能够接触到深度学习，并鼓励他们以聪明、创造性的方式利用这项技术。</p><p id="0494" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将了解使用这个库并为个人项目构建深度学习模型是多么容易。</p><div class="lb lc ez fb ld le"><a href="https://course.fast.ai/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hi fi z dy lj ea eb lk ed ef hg bi translated">面向编码人员的实用深度学习</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">如果你现在就准备好投入进去，下面是开始的方法。如果你想更多地了解本课程，请阅读…</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">course.fast.ai</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls lt le"/></div></div></a></div></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="305c" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">项目范围和动机</h1><p id="7975" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">我们的项目的目的是建立一个图像分类器，使用预先训练的卷积神经网络。该网络应该通过提取每一类图像中最重要的特征来区分不同类的图像。</p><p id="b634" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了更容易理解，我们将把这个过程分解成容易理解的部分。</p><p id="509a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，这篇博客的目的不是教卷积神经网络如何工作，或者数据增强如何帮助改进我们的模型，有许多帖子已经在这方面做了很好的工作。相反，这里的目标是向您展示fastai的实际应用，以及实现这些应用的容易程度，并激发您(读者)尽情发挥您的想法。</p><p id="03ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们开始我们的项目吧。</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es lu"><img src="../Images/585a243660df0794689016e401422663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OIbsa7QY1oYegOvYw1vEUg.jpeg"/></div></div></figure><h1 id="3c84" class="jy jz hh bd ka kb mf kd ke kf mg kh ki kj mh kl km kn mi kp kq kr mj kt ku kv bi translated">数据收集</h1><p id="6480" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">数据收集和清理是深度学习管道中最基本的，但却经常被忽视的一部分。有多种方法来管理你的自定义数据集，fastai甚至提供了<a class="ae mk" href="https://course.fast.ai/images" rel="noopener ugc nofollow" target="_blank">下载图像</a>的方法。</p><p id="2958" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了这个项目，我使用Kaggle找到了一个相关且有趣的数据集:美国手语字母表图像数据集。</p><div class="lb lc ez fb ld le"><a href="https://www.kaggle.com/grassknoted/asl-alphabet" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hi fi z dy lj ea eb lk ed ef hg bi translated">美国手语字母</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">美国手语字母的图像数据集</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">www.kaggle.com</p></div></div><div class="ln l"><div class="ml l lp lq lr ln ls lt le"/></div></div></a></div><p id="2822" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如数据集描述中所述:</p><blockquote class="mm mn mo"><p id="6f25" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated">训练数据集包含87，000幅200x200像素的图像。共有29个类，其中26个类用于字母A-Z，3个类用于空格、删除和无。</p><p id="b3b1" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated">测试数据集仅包含28幅图像，以鼓励使用真实世界的测试图像。</p></blockquote><p id="8a6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我以zip文件的形式下载了数据，然后上传到Google Drive，以便在我的模型应用程序中使用。</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="fd0d" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">平台</h1><p id="7117" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">深度学习项目需要GPU来处理大量数据。对于初级项目，我强烈推荐使用<a class="ae mk" href="https://research.google.com/colaboratory/" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>来达到这个目的。</p><p id="09d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Fastai提供了一个在Colab <a class="ae mk" href="https://course.fast.ai/start_colab" rel="noopener ugc nofollow" target="_blank">这里</a>建立他们的库的教程。只要确保连接后把你的硬件加速器换成GPU就行了。这可以通过点击运行时→更改运行时类型→硬件加速器→ GPU来完成。</p><p id="5627" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你对Colab不熟悉，可以通过他们的<a class="ae mk" href="https://colab.research.google.com/notebooks/basic_features_overview.ipynb" rel="noopener ugc nofollow" target="_blank">官方教程</a>了解一下它的特性。</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="ad6a" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">密码</h1><p id="c98a" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">现在我们进入了项目的核心。</p><h2 id="44e2" class="ms jz hh bd ka mt mu mv ke mw mx my ki ip mz na km it nb nc kq ix nd ne ku nf bi translated">准备数据</h2><p id="c77e" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">首先，我们需要将Google Drive链接到我们的Colab笔记本，以使用我们下载的数据集。</p><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="56d6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当您运行这段代码时，Google会要求您验证您的登录，以便将Google Drive安装到Colab上。</p><p id="0ed6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦我们安装了驱动器，我们就可以安装和导入所需的库，并解压缩之前上传的数据集。</p><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="3b09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于数据集相当大，我选择在Colab磁盘上解压缩图像，而不是在我的Google Drive存储上。尽管以这种方式解压缩要快得多，但这意味着每次我想运行我的模型时，我都必须重复这个过程。</p><p id="4fab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在另一方面，您可以通过附加如下命令，选择将图像解压缩到驱动器上您选择的目录中:</p><pre class="lv lw lx ly fd ni nj nk nl aw nm bi"><span id="81d3" class="ms jz hh nj b fi nn no l np nq">!unzip &lt;your zip file directory&gt; -d &lt;target directory&gt;</span></pre><p id="104e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您遵循与我相同的步骤，您应该注意到添加到您的磁盘/自定义目录中的test和train映像文件夹:</p><figure class="lv lw lx ly fd lz er es paragraph-image"><div class="er es nr"><img src="../Images/c96b9fbc5ec26c8d1ab21d832ffd892e.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*b-bHFLtJhIoQ8lmXfKCEYA.png"/></div><figcaption class="ns nt et er es nu nv bd b be z dx">train-test image directories</figcaption></figure><p id="3e6e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个目录的结构至关重要。请注意train文件夹(和test文件夹)如何包含子文件夹，每个子文件夹都根据类标签进行了适当的命名，并包含相关的图像。强烈建议遵循这样的目录结构，这样可以更容易地处理我们的数据。</p><h2 id="fc83" class="ms jz hh bd ka mt mu mv ke mw mx my ki ip mz na km it nb nc kq ix nd ne ku nf bi translated">数据块和数据加载器</h2><p id="569b" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">一个<code class="du nw nx ny nj b">DataBlock</code>本质上是一个装配你的数据的管道——描述所有需要应用于数据的过程，以使它准备好“加载”。它用于指定我们希望我们的数据如何被结构化。</p><p id="3e58" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">另一方面，<code class="du nw nx ny nj b">DataLoader</code>是在训练机器学习模型的背景下实际加载和处理数据的东西。这包括分配批处理大小、应用在<code class="du nw nx ny nj b">DataBlock</code>中定义的所有进程、分配内存等等。</p><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="bd91" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据块中使用了多个参数:</p><blockquote class="mm mn mo"><p id="8523" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated">这是你定义你的模型将使用的不同类型的数据的地方。通常，在元组中传递输入和输出数据类型。因为我们的输入是图像，输出是类，所以我们的“块”分别是ImageBlock和CategoryBlocks。</p><p id="f875" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated"><code class="du nw nx ny nj b">get_items</code>:该功能用于在需要时从指定路径实际拾取图像。</p><p id="9c8c" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated"><code class="du nw nx ny nj b">splitter</code>:定义数据需要如何拆分为训练和验证。RandomSplitter只是一种特定类型的拆分器方法。您可以定义保留多少数据用于验证目的(在我的例子中是20%)。可以为可复制性指定种子值。</p><p id="2770" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated"><code class="du nw nx ny nj b">get_y</code>:定义如何从数据中提取目标标签。因为我们所有的图像都在它们各自的类文件夹中，所以我们使用parent_label方法来指定每个图像的目标变量就是它各自的父文件夹名。这也是为什么将数据存储在前面定义的结构化文件中如此重要。</p><p id="eb3c" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated"><code class="du nw nx ny nj b">item_tfms</code> : item transforms是一个可选参数，用于指定当我们传递数据时，需要对每个图像执行的任何附加处理。关于具体转换的细节可以在官方文档<a class="ae mk" href="https://fastai1.fast.ai/vision.transform.html" rel="noopener ugc nofollow" target="_blank">中阅读，这里是</a>。</p><p id="c71e" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated"><code class="du nw nx ny nj b">batch_tfms</code>:使用fast.ai的aug_transforms方法对每批数据应用各种图像变换。这就是所谓的数据扩充，用于生成更多种类的训练数据，并帮助我们的模型变得更具普遍性。</p></blockquote><p id="b3f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在定义了结构化、分类和处理数据的规范之后，我们通过将它传递到我们的训练图像的路径和32个批处理大小，将它输入到我们的<code class="du nw nx ny nj b">DataLoader</code>。</p><h2 id="ead4" class="ms jz hh bd ka mt mu mv ke mw mx my ki ip mz na km it nb nc kq ix nd ne ku nf bi translated">数据可视化</h2><p id="0a97" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">一旦我们加载了数据，我们就可以开始想象它是什么样子了。</p><p id="3de4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们查看我们的类的分布——特别是在我们的验证集中。</p><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es nz"><img src="../Images/9dd7641a0d36e1ba89da36cca13eb279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOWiT1HOW_hSuSaLZLFkcg.png"/></div></div></figure><p id="2b93" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，图像在验证数据集中的分布相当均衡。这是我们模型训练管道中的一个关键点，因为不平衡的数据集可能会导致模型训练和验证中的重大问题。</p><blockquote class="mm mn mo"><p id="f120" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated">提示:path是Python的<code class="du nw nx ny nj b"><em class="hh">pathlib</em></code>类的一个对象，它提供了处理文件系统路径的方便方法。</p></blockquote><p id="657c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，我们还可以通过在dataloader对象上调用fast.ai的便捷的<code class="du nw nx ny nj b">show_batch</code>方法来查看训练图像的样本。</p><pre class="lv lw lx ly fd ni nj nk nl aw nm bi"><span id="1b5e" class="ms jz hh nj b fi nn no l np nq">dls.show_batch(max_n=9)</span></pre><figure class="lv lw lx ly fd lz er es paragraph-image"><div class="er es oa"><img src="../Images/6e2bd81f4cf2b32f42abaa47cd51bad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*2xSFD5WzRituGsGnf8hR1Q.png"/></div></figure><p id="8932" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到上面定义的数据扩充步骤(在batch_tfms参数中)是如何转换数据的。</p><h2 id="57da" class="ms jz hh bd ka mt mu mv ke mw mx my ki ip mz na km it nb nc kq ix nd ne ku nf bi translated">模特培训</h2><p id="f780" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">现在，我们将建立和训练我们的神经网络来分类这些图像。在fast.ai的领域中，被训练的模型被称为“学习者”。出于我们的目的，我们将使用一个cnn_learner，以ResNet34架构为模型。</p><blockquote class="mm mn mo"><p id="4e78" class="ie if jq ig b ih ii ij ik il im in io mp iq ir is mq iu iv iw mr iy iz ja jb ha bi translated">ResNet34是一个预训练模型，在流行的<a class="ae mk" href="https://www.image-net.org/" rel="noopener ugc nofollow" target="_blank"> ImageNet </a>数据集上进行训练。我们将对我们的数据应用该模型，利用该模型已经学习的参数，并对它们进行微调以适应我们的数据集。这种方法被称为<strong class="ig hi"> <em class="hh">迁移学习</em> </strong>，它是fast.ai模型构建方法的核心。</p></blockquote><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><figure class="lv lw lx ly fd lz er es paragraph-image"><div class="er es ob"><img src="../Images/91907461b196b93b39c177615a22e561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*QEBqRTo1wNMViJqcmyzXSw.png"/></div></figure><p id="0d74" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">调用<code class="du nw nx ny nj b">fit_one_cycle()</code>方法在我们的数据集上训练4个时期的模型(根据指定)。输出显示了训练和验证损失以及上面指定为我们选择的度量的<code class="du nw nx ny nj b">accuracy</code>。</p><p id="43db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，请注意，仅通过四个时期的训练，我们的模型就能够达到接近完美的99.9%的准确率！在验证数据集上。这种准确性的轻松实现是fast.ai的关键卖点之一。</p><p id="d248" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些结果中明显的另一个有趣的事情是损失值。乍一看，验证损失远低于训练损失似乎很奇怪，即使模型是在训练图像上训练的，并且是专门设计来减少这些图像上的损失的。</p><p id="1560" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，这是一些洞察力发挥作用的地方。默认情况下，fast.ai将我们指定的图像转换(而不是RandomResizedCrop)应用于训练数据，而不是验证数据。这意味着训练数据集中的图像远比验证数据中的图像更复杂和多样，这使得模型更难对它们进行分类。</p><p id="c531" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以通过查看验证图像的样本来查看这种差异。</p><pre class="lv lw lx ly fd ni nj nk nl aw nm bi"><span id="d074" class="ms jz hh nj b fi nn no l np nq">dls.valid.show_batch(max_n=8, nrows=2)</span></pre><figure class="lv lw lx ly fd lz er es paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="er es oc"><img src="../Images/a8c87ab6d5a4848d4ae1487ab45f700b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*QD-o4t9UL5Q00C4w5n1yLQ.png"/></div></div></figure><p id="f14f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些图像与原始数据集中提供的图像完全相同，只是应用了RandomResizedCrop变换，使其中一些图像看起来更加“放大”。然而，这些图像比之前描述的那些图像要简单得多，那些图像经过了多次批量转换。</p><p id="6c4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以在下面的参考资料中了解更多细节:</p><div class="lb lc ez fb ld le"><a href="https://www.pyimagesearch.com/2019/10/14/why-is-my-validation-loss-lower-than-my-training-loss/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hi fi z dy lj ea eb lk ed ef hg bi translated">为什么我的验证损失低于培训损失？-图片搜索</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">有没有想过为什么你的验证损失低于你的培训损失？在本教程中，您将学习三个…</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">www.pyimagesearch.com</p></div></div><div class="ln l"><div class="od l lp lq lr ln ls lt le"/></div></div></a></div><p id="b3dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，一旦我们对模型进行了训练，并对其结果感到满意，我们就可以将它的元数据导出为. pkl文件，然后在需要时加载它进行推理。这意味着我们不必在每次想要做出推论的时候训练我们的模型。</p><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><h2 id="4209" class="ms jz hh bd ka mt mu mv ke mw mx my ki ip mz na km it nb nc kq ix nd ne ku nf bi translated">预测和结果</h2><p id="ee10" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">我们现在可以根据一直放在一边的测试数据来测试我们的模型的能力了。</p><p id="6157" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了对我们的测试数据进行预测，我们指定了测试图像的路径，并使用<code class="du nw nx ny nj b">get_preds</code>方法来生成我们的模型对这些图像的预测。</p><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="639c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">回想一下，在我们的示例中，测试数据集仅包含28幅图像，每幅图像属于A-Z类，另外两幅图像对应于“无”和“空间”。这与我们的<code class="du nw nx ny nj b">preds</code>张量总共有28行有关。此外，每行有29个值。这是因为我们的模型是在29个类上训练的，因此特定行中的每个值代表我们的模型认为图像属于该特定类的概率。</p><p id="6b6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，<code class="du nw nx ny nj b">preds</code>第五行中的第四个值显示了模型认为图像属于类别‘D’的概率，而实际上它属于类别‘E’。</p><p id="9cef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于<code class="du nw nx ny nj b">preds</code>只包含与每个类别相关联的概率，我们想找出哪个类别对于每个测试图像具有最高的概率。我们通过使用fast.ai提供的<code class="du nw nx ny nj b">o2i</code>方法来做到这一点，该方法将对象的类与其索引进行映射。因为我们有索引，所以我们需要利用反向映射。</p><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="352c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在可以将我们的预测与实际的测试标签进行比较。由于<code class="du nw nx ny nj b">get_images_sorted</code>返回每个图像的路径，我们将不得不手动提取每个图像的标签。</p><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="6950" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我们的比较列表的总和返回28，这意味着我们的模型在测试集上达到了<strong class="ig hi"> 100% </strong>的准确性。完美。</p><p id="f1c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，因为测试集中只有28幅图像，所以我们可以创建自己的测试图像，并使用我们的模型来预测它们。我们可以使用python <code class="du nw nx ny nj b">widgets</code>的魔力来实现这一点。</p><p id="da0c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以创建一个简单的上传按钮来加载您自己的图像。A</p><figure class="lv lw lx ly fd lz er es paragraph-image"><div class="er es oe"><img src="../Images/3d37bc2564b9177d2a15666f34d76565.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*EL1B0cm9RckkYRVLMIpn8Q.png"/></div><figcaption class="ns nt et er es nu nv bd b be z dx">Widget for uploading custom image</figcaption></figure><figure class="lv lw lx ly fd lz"><div class="bz dy l di"><div class="ng nh l"/></div></figure><p id="60d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du nw nx ny nj b">predict</code>方法将返回一个元组，其中包含模型的实际类预测以及与每个类相关联的概率张量——这对分析和改进模型非常有用。</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="1766" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">回顾与展望</h1><p id="1303" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">这篇文章的目的是让你看到任何人都可以轻松地使用fast.ai构建深度学习模型。该库以其高水平和低水平的使用为初学者和高级用户提供了一个强大的工具。</p><p id="ec14" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们看了一个特殊的用例，将图像分类到它们对应的美国手语字母中。我们研究了数据的结构化和可视化，使用迁移学习的模型训练，以及在提供的和定制的测试集上的推理，同时实现了最先进的结果。</p><p id="6c7c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">展望未来，我们将讨论如何改进现实世界应用的模型。尽管我们的模型完美地预测了所提供的测试数据集的类别，但是它在定制图像上犯了一些错误。因此，我们可以通过微调更多的模型参数，寻找更好的学习率，或者在我们的情况下，使用更多不同的数据进行模型训练，来改进我们的模型。</p><p id="8bfe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">深度学习是一个令人兴奋的领域，我们所有人都有机会对它进行更多的了解，并产生创造性的有用的应用程序。我希望我的文章能启发你这么做。</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="1876" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">参考</h1><p id="8774" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">您可以在我的github上查看完整的代码和注释:</p><div class="lb lc ez fb ld le"><a href="https://github.com/qasimr17/fastai/tree/main/asl" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hi fi z dy lj ea eb lk ed ef hg bi translated">主qasimr17/fastai的fastai/asl</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">这个库包含了我使用fastai库——fastai/ASL在main qasimr17/fastai上构建的个人项目</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">github.com</p></div></div><div class="ln l"><div class="of l lp lq lr ln ls lt le"/></div></div></a></div><div class="lb lc ez fb ld le"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lf ab dw"><div class="lg ab lh cl cj li"><h2 class="bd hi fi z dy lj ea eb lk ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ll l"><h3 class="bd b fi z dy lj ea eb lk ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lm l"><p class="bd b fp z dy lj ea eb lk ed ef dx translated">medium.com</p></div></div><div class="ln l"><div class="og l lp lq lr ln ls lt le"/></div></div></a></div></div></div>    
</body>
</html>