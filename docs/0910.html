<html>
<head>
<title>Compare 29 Different ML Classifiers with a single line of code — Lazypredict</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用一行代码比较29个不同的ML分类器— Lazypredict</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/compare-29-different-ml-classifiers-with-a-single-line-of-code-lazypredict-53b7a7a1a036?source=collection_archive---------2-----------------------#2021-08-20">https://medium.com/mlearning-ai/compare-29-different-ml-classifiers-with-a-single-line-of-code-lazypredict-53b7a7a1a036?source=collection_archive---------2-----------------------#2021-08-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie if ig"><p id="92d9" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">比较来自29个不同ML分类器的不同分类度量的快速方法</p></blockquote><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/c53a732eaaf1e55ecd8b714ae571917d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vBCYdKmgqH3wWdsQvxtXZA.png"/></div></div></figure><h1 id="673e" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">介绍</h1><p id="846b" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">在这篇博客中，我们将用一行代码评估29个不同的ML数据分类器的分类度量。我们将使用Lazypredict python库来完成这项任务，稍后将可视化我们的结果。</p><h1 id="2f21" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">导入库</h1><p id="6ad1" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">我们将首先在我们的环境中安装Lazypredict库。这可以在pip包安装程序的帮助下完成。</p><pre class="jh ji jj jk fd ky kz la lb aw lc bi"><span id="fbc2" class="ld jt hh kz b fi le lf l lg lh">pip install lazypredict </span></pre><p id="082e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">接下来，我们将导入数据处理和可视化所需的库。</p><pre class="jh ji jj jk fd ky kz la lb aw lc bi"><span id="3285" class="ld jt hh kz b fi le lf l lg lh">import lazypredict <br/>from lazypredict import Supervised <br/>from lazypredict.Supervised import LazyClassifier<br/>import matplotlib.pyplot as plt <br/>from sklearn.model_selection import train_test_split</span><span id="52db" class="ld jt hh kz b fi li lf l lg lh">plt.style.use('fivethirtyeight')<br/>plt.rcParams["figure.figsize"] = (10,5)</span></pre><h1 id="7032" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">资料组</h1><p id="3686" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">我们将使用sklearn.datasets库中的乳腺癌分类数据集。数据集有2个分类标签，分别为恶性、良性癌症的1和0。然后，我们将把数据分成测试集和训练集。</p><pre class="jh ji jj jk fd ky kz la lb aw lc bi"><span id="aaf1" class="ld jt hh kz b fi le lf l lg lh">from sklearn.datasets import load_breast_cancer<br/>data = load_breast_cancer()</span><span id="d5b2" class="ld jt hh kz b fi li lf l lg lh">X = data.data<br/>y = data.target</span><span id="1b61" class="ld jt hh kz b fi li lf l lg lh">X_train, X_valid, y_train, y_valid = train_test_split(X, y,test_size=.5,random_state =12)</span></pre><h1 id="2d51" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">列出所有可用的分类器</strong></h1><p id="069a" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">现在，我们将列出lazypredict库中所有可用的分类器。</p><pre class="jh ji jj jk fd ky kz la lb aw lc bi"><span id="9c41" class="ld jt hh kz b fi le lf l lg lh">for i in range(29):<br/>    print(i+1, lazypredict.Supervised.CLASSIFIERS[i][0])</span></pre><p id="571e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">我们得到以下29个分类器:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es lj"><img src="../Images/417ec9f4f7896d56ef1801343c75ccf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*EyvzRvgpP6ehaXomvdHv7Q.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx">List of available classifiers</figcaption></figure><h1 id="b925" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">训练和拟合模型</h1><p id="ff21" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">现在，我们将创建之前导入的LazyClassifier模型，并将我们的训练和验证数据放入该模型中</p><pre class="jh ji jj jk fd ky kz la lb aw lc bi"><span id="f141" class="ld jt hh kz b fi le lf l lg lh">clf = LazyClassifier(verbose=0,<br/>                     ignore_warnings=True,<br/>                     custom_metric=None,<br/>                     random_state=12,<br/>                     classifiers='all',<br/>                    )<br/>models,predictions = clf.fit(X_train, X_valid, y_train, y_valid)</span></pre><p id="8197" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">训练在1.78秒内完成，所有指标都存储在<em class="ij">模型</em>数据框架中。数据框架包含模型的名称、各种分类指标，如准确度、平衡准确度、ROC AUC分数、F1分数和训练所用的时间。</p><h1 id="efd1" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">前5名分类器</h1><p id="d12b" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">我们现在将看到前5个分类器和所有分类指标。对于数据帧的前5行，我们将调用models.head(5)</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div class="er es lo"><img src="../Images/2ee59ab45d7cd6dd4e816887666d897b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*PiSsaSG22K9YSogLudFEgg.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx">Top 5 Classifiers</figcaption></figure><h1 id="7d6f" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">可视化结果</h1><p id="6ffe" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">现在，我们将绘制一个图表，用于可视化所有模型的准确性和ROC AUC得分。</p><pre class="jh ji jj jk fd ky kz la lb aw lc bi"><span id="7a7a" class="ld jt hh kz b fi le lf l lg lh">idx = [i for i in range(1,28)]<br/>plt.plot(idx, models["Accuracy"]  ,marker='o' , label = "Accuracy" )<br/>plt.plot(idx , models["ROC AUC"] , marker ='o' , label = "ROC AUC")</span><span id="a149" class="ld jt hh kz b fi li lf l lg lh">plt.annotate(models.index[1] , <br/>             (1,models["Accuracy"][1]) , <br/>             xytext  =(0.3, 00.7),<br/>             arrowprops = dict(<br/>                               arrowstyle = "simple"<br/>                              ))<br/>plt.annotate(models.index[26] , <br/>             (27 , models["Accuracy"][26]) , <br/>             xytext  =(15, models["Accuracy"][26]),<br/>             arrowprops = dict(<br/>                               arrowstyle = "simple"<br/>                              ))<br/>plt.xlabel("Models")<br/>plt.ylabel("Metrics")<br/>plt.title("Comparison of 29 Different Classifiers")<br/>plt.legend()<br/>plt.show()</span></pre><p id="8b22" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">我们得到下面的图表:</p><figure class="jh ji jj jk fd jl er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jg"><img src="../Images/c53a732eaaf1e55ecd8b714ae571917d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vBCYdKmgqH3wWdsQvxtXZA.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">Accuracy / ROC AUC score vs Classifiers</figcaption></figure><h1 id="3f5a" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="cd67" class="pw-post-body-paragraph ih ii hh ik b il kq in io ip kr ir is ks kt iv iw ku kv iz ja kw kx jd je jf ha bi translated">我们已经用一行代码成功地评估了29个不同的分类器。所选模型的超参数调整可以进一步改善结果。</p><p id="c06a" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">我希望你喜欢它。</p><p id="670e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is ks iu iv iw ku iy iz ja kw jc jd je jf ha bi translated">这个博客的代码和训练模型可以在这里获得——<a class="ae lp" href="https://github.com/sanskar-hasija/lazypredict/blob/main/Classification/LazyPredict%20Classification.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/sanskar-hasi ja/lazy predict/blob/main/Classification/lazy predict % 20 Classification . ipynb</a></p></div></div>    
</body>
</html>