<html>
<head>
<title>Diamonds pricing Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习的钻石定价</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/diamonds-pricing-using-machine-learning-9e97064e6353?source=collection_archive---------2-----------------------#2021-04-08">https://medium.com/mlearning-ai/diamonds-pricing-using-machine-learning-9e97064e6353?source=collection_archive---------2-----------------------#2021-04-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/14220ba9eb2cb2be50dc36eab7864a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*rHU3X3HFLZsRvDKDhXBgUw.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx">photo by <a class="ae ip" href="https://unsplash.com/@edgardo1987" rel="noopener ugc nofollow" target="_blank">Edgar Soto</a> unsplash</figcaption></figure><h1 id="2529" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">正在导入所需的库。</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="821e" class="jx ir hh jt b fi jy jz l ka kb">from sklearn.ensemble import RandomForestRegressor, AdaBoostRegressor, ExtraTreesRegressor, GradientBoostingRegressor<br/>from sklearn.metrics import mean_squared_error, r2_score,mean_absolute_error <br/>from sklearn.model_selection import cross_val_score<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.linear_model import LinearRegression<br/>import matplotlib.pyplot as plt<br/>from sklearn import ensemble<br/>import sklearn.naive_bayes<br/>import seaborn as sns<br/>import pandas as pd<br/>import sklearn</span></pre><h1 id="e4ab" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">加载数据集</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="9098" class="jx ir hh jt b fi jy jz l ka kb">data_path= 'datasets/diamonds.csv'<br/>diamonds_org = pd.read_csv(data_path)<br/>diamonds_org.head()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kc"><img src="../Images/62ab6a829c503088e2c4448ac804e76f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cZlV4QYdxUEU0FkGy2DLig.png"/></div></div></figure><h1 id="8de1" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">检查Nan值</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="7a1e" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org.isnull().sum()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kh"><img src="../Images/fec5583de1bb26ba57b1afa5c655e1fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*tcXEN_i54WCQNGEzR-Mm7Q.png"/></div></figure><h1 id="3c9c" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">检查每列中的唯一值</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="9b41" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org[‘carat’].unique()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es ki"><img src="../Images/74685c9ebf3ea41b84a555394768d350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYmJbQkOk_GTGdqaPeCYZA.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c06f" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org[‘clarity’].unique()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kj"><img src="../Images/5e81764275b7214749f2312f7406449c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xYuHsc7IkzBZDhnPnwqPBg.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="4001" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org['cut'].unique()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kk"><img src="../Images/92e021e2d1952120d0553bf98a4f1146.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AEVMu5kDynhNW_QZe0JHJQ.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1a33" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org['depth'].unique()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kl"><img src="../Images/5b7c11d844e3b5b5bef223cae0014125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzoVItw90D2Q9INdnUG3cw.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="240d" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org['table'].unique()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kl"><img src="../Images/3dad3ab472a83e77ec1bd75be1f44bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ILUT2T21kqkR2vmWLg7jJw.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e63b" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org.loc[(diamonds_org[‘x’]&lt;=0) | (diamonds_org[‘y’]&lt;=0) | (diamonds_org[‘z’]&lt;=0)]</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es km"><img src="../Images/785f344617b7e8d0effc8d793da10eb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lxGIoGzodI1qaFlY7-X2Hg.png"/></div></div></figure><p id="7188" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">长度、宽度或高度中的任何一个为零都没有任何意义。但是我们可以看到有些行的值为“0”。因此，让我们从数据框中移除这些行。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c7d3" class="jx ir hh jt b fi jy jz l ka kb">len(diamonds_org[(diamonds_org['x']&lt;=0) | (diamonds_org['y']&lt;=0) | (diamonds_org['z']&lt;=0)])</span></pre><p id="1c8c" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">产量:20</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="2450" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org = diamonds_org[(diamonds_org[[‘x’,’y’,’z’]] != 0).all(axis=1)]</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ll"><img src="../Images/3a5dd4fe497a72d8deb6bba7006d79bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*fOXDjvo49F5uEJWQlRldDA.png"/></div></figure><p id="719b" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">从上面的数据帧中，我们可以看到它包含以下特征:</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="701a" class="jx ir hh jt b fi jy jz l ka kb">1. carat<br/>2. cut<br/>3. color<br/>4. depth <br/>5. table <br/>6. price <br/>7. x (length in mm) <br/>8. y (width in mm) <br/>9. z (height in mm)</span></pre><p id="a31d" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">7，8，9个属性并合并成单个属性为volume，为volume = x <em class="lm"> y </em> z，做法如下。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="281e" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org[‘volume’] = diamonds_org[‘x’]*diamonds_org[‘y’]*diamonds_org[‘z’]<br/>diamonds_org[:5]</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es ln"><img src="../Images/24bdf8ccd9a4f57ef96d20340e8413d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EcTyZvf1KXgcVpT1dM1rwQ.png"/></div></div></figure><p id="39f3" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">现在不需要x、y、z，因为它们被合并到单个柱体积中。所以我们要删除这些列。</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d376" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org = diamonds_org.drop(['x', 'y', 'z'], axis=1)<br/>diamonds_org[:5]</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es lo"><img src="../Images/91178e3f861ae739cdb40abdc5e7eadd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*rdXZ2amCC_6IL35lHKXCeA.png"/></div></figure><h1 id="0987" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">特征之间的相关性</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="87a6" class="jx ir hh jt b fi jy jz l ka kb">sns.set(rc={'figure.figsize':(6,6)})<br/>corr = diamonds_org.corr()<br/>sns.heatmap(data=corr, square=True , annot=True, cbar=True, cmap="YlGnBu")</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es lp"><img src="../Images/13d7e113727af8c954fb467131dd658a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*3cvzIyEhYJZUZxnhhuVOhg.png"/></div></figure><p id="9535" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">从上图得出的结论:</p><ol class=""><li id="d6ac" class="lq lr hh kp b kq kr ku kv ky ls lc lt lg lu lk lv lw lx ly bi translated">深度与价格成反比。</li><li id="333f" class="lq lr hh kp b kq lz ku ma ky mb lc mc lg md lk lv lw lx ly bi translated">钻石的价格与克拉及其尺寸密切相关。</li><li id="69a1" class="lq lr hh kp b kq lz ku ma ky mb lc mc lg md lk lv lw lx ly bi translated">钻石的重量(克拉)对其价格影响最大。</li><li id="0029" class="lq lr hh kp b kq lz ku ma ky mb lc mc lg md lk lv lw lx ly bi translated">成交量似乎与价格甚至彼此高度相关。</li><li id="d69c" class="lq lr hh kp b kq lz ku ma ky mb lc mc lg md lk lv lw lx ly bi translated">自我关系。一个特性的值是1。</li><li id="f938" class="lq lr hh kp b kq lz ku ma ky mb lc mc lg md lk lv lw lx ly bi translated">还可以得出其他一些推论。</li></ol><h1 id="fea8" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">所有功能的可视化</h1><h1 id="3d0b" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">克拉</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e8b1" class="jx ir hh jt b fi jy jz l ka kb">sns.kdeplot(diamonds_org['carat'], shade=True , color='r')</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es me"><img src="../Images/bd8e072112aa00317970299c47851078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*QunNHgOwZNY7wPD7r6FsKw.png"/></div></figure><h1 id="7e9d" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">克拉与价格</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1055" class="jx ir hh jt b fi jy jz l ka kb">sns.lineplot(diamonds_org[‘carat’], diamonds_org[‘price’], color=’blue’)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mf"><img src="../Images/b17859af70432477ee748b93f690a23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*4kbDCxHLe8MzW65niYWwNg.png"/></div></figure><h1 id="a618" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">切口</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="53bf" class="jx ir hh jt b fi jy jz l ka kb">sns.factorplot(x='cut', data=diamonds_org , kind='count',aspect=2.5 )</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es mg"><img src="../Images/8ecfd460feaeb66b0fda778a4c9ecb37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-KAxwkg2T2GH9aiiPD3Mw.png"/></div></div></figure><h1 id="d0fd" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">削减与价格</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="3caa" class="jx ir hh jt b fi jy jz l ka kb">sns.lineplot(diamonds_org['cut'], diamonds_org['price'], color='orange')</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mh"><img src="../Images/e3d118acab6ac0dfa0b5ce8c07e78833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*_XFePvn1Z8J03xBhRpW24g.png"/></div></figure><h1 id="01c6" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">颜色</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c8e2" class="jx ir hh jt b fi jy jz l ka kb">sns.factorplot(x=’color’, data=diamonds_org , kind=’count’,aspect=2.5 )</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es mi"><img src="../Images/76fa12ea0a1b46aaaf6158aa246fccad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5-5cze5tXe9jZSjb4W-HAw.png"/></div></div></figure><h1 id="f122" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">颜色与价格</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="90b5" class="jx ir hh jt b fi jy jz l ka kb">sns.lineplot(diamonds_org['color'], diamonds_org['price'], color='gray')</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mj"><img src="../Images/346fe7b7658f6b52fa6910de4e634fe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D46lIssJd8LwV1jljXf3TQ.png"/></div></figure><h1 id="3b8c" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">清楚</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="6e15" class="jx ir hh jt b fi jy jz l ka kb">sns.factorplot(x='clarity', data=diamonds_org , kind='count',aspect=2.5 )</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es mk"><img src="../Images/912c19b1611e5ee2175bfb88a43357c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6AXHA8R7cWnG-7UO4Y-w9w.png"/></div></div></figure><h1 id="09fd" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">透明度与价格</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c8d6" class="jx ir hh jt b fi jy jz l ka kb">sns.lineplot(diamonds_org['clarity'], diamonds_org['price'], color='yellow')</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ml"><img src="../Images/64988112bc8acde5599a97baadb68341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*fBSwSfmTBHnPr9oBvIozxw.png"/></div></figure><h1 id="89b2" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">深度</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b49c" class="jx ir hh jt b fi jy jz l ka kb">plt.hist('depth' , data=diamonds_org , bins=25)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es mm"><img src="../Images/b88b3900b067bf8aa656e6f480d729ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ykgk2dhXbsKaYUyZCfSug.png"/></div></div></figure><h1 id="ef42" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">深度与价格</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="7bcd" class="jx ir hh jt b fi jy jz l ka kb">sns.lineplot(diamonds_org['depth'], diamonds_org['price'], color='red')</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mn"><img src="../Images/ede9d697d78d070606663831b785b17a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*FlbVgy_IwPUQxzAKeibVyQ.png"/></div></figure><h1 id="de73" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">桌子</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c32c" class="jx ir hh jt b fi jy jz l ka kb">sns.kdeplot(diamonds_org[‘table’] ,shade=True , color=’orange’)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/f76128a4e010639c406bb24d74c48be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*hwTFhfJG1CU4pc0862LAWA.png"/></div></figure><h1 id="ab0e" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">桌子与价格</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="25dc" class="jx ir hh jt b fi jy jz l ka kb">sns.lineplot(diamonds_org['table'], diamonds_org['price'], color='green')</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mp"><img src="../Images/aed9bc5ddec985ea022ba2f865c7259e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*5bp10dmcHiYX97tdBbnZgQ.png"/></div></figure><h1 id="8460" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">卷</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="2504" class="jx ir hh jt b fi jy jz l ka kb">plt.figure(figsize=(5,5))<br/>plt.hist( x=diamonds_org['volume'] , bins=30)<br/>plt.xlim(0,800)<br/>plt.ylim(0,50000)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mq"><img src="../Images/c62126363024407603d0c0962302d8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*5N8a2ZmKLtT-qS6uTWXkMQ.png"/></div></figure><h1 id="9073" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">数量与价格</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5a42" class="jx ir hh jt b fi jy jz l ka kb">sns.lineplot(diamonds_org[‘volume’], diamonds_org[‘price’])</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mr"><img src="../Images/f802002441c2dd5c10a695d2722123b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*EXMVBoDgSnGkBUtm9hK3ww.png"/></div></figure><h1 id="46b4" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">特征编码</h1><p id="2151" class="pw-post-body-paragraph kn ko hh kp b kq ms ks kt ku mt kw kx ky mu la lb lc mv le lf lg mw li lj lk ha bi translated">检查要素的数据类型</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="f008" class="jx ir hh jt b fi jy jz l ka kb">diamonds_org.dtypes</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mx"><img src="../Images/365dfed8f32ff3dc8d7e7a18b5c4b93f.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*TpUDOOu7VubkzsxxRuE5IA.png"/></div></figure><p id="e3d8" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">“剪切”的一键编码</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c5d8" class="jx ir hh jt b fi jy jz l ka kb">dummy_cut = pd.get_dummies(diamonds_org['cut'], prefix = 'cut' , drop_first = True)<br/>dummy_cut.head()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es my"><img src="../Images/119f03203dc2a77fac2243f0e3395c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*g2_WDI96Iz43gAmY-xgTWQ.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1ca4" class="jx ir hh jt b fi jy jz l ka kb">print(diamonds_org.shape)<br/>print(dummy_cut.shape)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/f73bdd511659663794082abb8fd84962.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*-9WgVRFbkNdpG4iRMUtdlA.png"/></div></figure><p id="dec8" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">连接dummy_cut和diamonds_org数据框</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="06eb" class="jx ir hh jt b fi jy jz l ka kb">X = pd.concat([diamonds_org, dummy_cut], axis=1)<br/>print(X.shape)<br/>print(X[:3])</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es na"><img src="../Images/00830562e3bd1cd252e7175f6b862bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7UQ1XFEi7GWDeYqC4Q0j-g.png"/></div></div></figure><p id="0bb6" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">删除已编码的剪切列</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="084a" class="jx ir hh jt b fi jy jz l ka kb">X = X.drop([‘cut’], axis=1)<br/>print(X.shape)<br/>X[:3]</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es na"><img src="../Images/00830562e3bd1cd252e7175f6b862bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7UQ1XFEi7GWDeYqC4Q0j-g.png"/></div></div></figure><p id="9ea0" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">彩色一键编码</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c6ca" class="jx ir hh jt b fi jy jz l ka kb">dummy_color = pd.get_dummies(X['color'], prefix = 'color' , drop_first = True)</span><span id="c8ad" class="jx ir hh jt b fi nb jz l ka kb">print(dummy_color.shape)<br/>print(X.shape)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es nc"><img src="../Images/a3a229ab45d8f1778608322f80577af9.png" data-original-src="https://miro.medium.com/v2/resize:fit:326/format:webp/1*NQyqOjsaBUe768MVhOE_jw.png"/></div></figure><p id="9176" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">连接X和dummy_color数据帧，并删除颜色列</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="ce48" class="jx ir hh jt b fi jy jz l ka kb">X = pd.concat([X, dummy_color], axis=1)<br/>X = X.drop(['color'], axis=1)<br/>print(X.shape)</span><span id="82d7" class="jx ir hh jt b fi nb jz l ka kb">X[:3]</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es nd"><img src="../Images/680de45e1570773633d0ca2dc35c65c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*guhmPn_Om5FVN5sujeq5RQ.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="84c0" class="jx ir hh jt b fi jy jz l ka kb">dummy_clarity = pd.get_dummies(X[‘clarity’], prefix = ‘clarity’ , <br/> drop_first = True)<br/>print(dummy_clarity.shape)<br/>print(X.shape)</span><span id="79a2" class="jx ir hh jt b fi nb jz l ka kb">X = pd.concat([X, dummy_clarity], axis=1)<br/>X = X.drop([‘clarity’], axis=1)<br/>X[:5]</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es ne"><img src="../Images/881cd52adece64918c7ec38e3c379551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXKnXqSybj9Hy_iEYveYKw.png"/></div></div></figure><h1 id="99d2" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">特征缩放</h1><p id="098e" class="pw-post-body-paragraph kn ko hh kp b kq ms ks kt ku mt kw kx ky mu la lb lc mv le lf lg mw li lj lk ha bi translated">将数据分成X，y</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="baf8" class="jx ir hh jt b fi jy jz l ka kb">y = X['price']<br/>X = X.drop(['price'], axis=1)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es nf"><img src="../Images/e8ce1166f73790f8b1579ecd4df0bfab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z1XNWBYEph0UOjW7q5cPbA.png"/></div></div></figure><p id="aa44" class="pw-post-body-paragraph kn ko hh kp b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ha bi translated">将数据分为训练和测试数据</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1b7b" class="jx ir hh jt b fi jy jz l ka kb">X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2, random_state=66)</span></pre><h1 id="b774" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">建模算法</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b48f" class="jx ir hh jt b fi jy jz l ka kb">models = [‘RandomForestRegressor’, ‘AdaBoostRegressor’, ‘ExtraTreesRegressor’, ‘GradientBoostingRegressor’, ‘LinearRegression’]<br/>r2_scores = []</span></pre><h1 id="fb8a" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">随机森林回归量</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="cf6a" class="jx ir hh jt b fi jy jz l ka kb">model_RF =  RandomForestRegressor()<br/>model_RF.fit(X_train , y_train)</span><span id="5a09" class="jx ir hh jt b fi nb jz l ka kb">y_pred = model_RF.predict(X_test)<br/>accuracies = cross_val_score(estimator = model_RF, X = X_train, y = y_train, cv = 5,verbose = 1)<br/>print('')<br/>print('###### RandomForestRegressor ######')<br/>print('Score : %.4f' % model_RF.score(X_test, y_test))<br/>print(accuracies)</span><span id="3567" class="jx ir hh jt b fi nb jz l ka kb">mse = mean_squared_error(y_test, y_pred)<br/>mae = mean_absolute_error(y_test, y_pred)<br/>r2 = r2_score(y_test, y_pred)</span><span id="5a38" class="jx ir hh jt b fi nb jz l ka kb">print('')<br/>print('MSE    : %0.2f ' % mse)<br/>print('MAE    : %0.2f ' % mae)<br/>print('R2     : %0.2f ' % r2)<br/>r2_scores.append(r2)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ng"><img src="../Images/af3a462f8f0135337866fcd2c4a53722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*ayrGJbDGKvoOCHUUfWeV9w.png"/></div></figure><h1 id="fe95" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">AdaBoostRegressor</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="6f69" class="jx ir hh jt b fi jy jz l ka kb">model_ABR =  AdaBoostRegressor()<br/>model_ABR.fit(X_train , y_train)</span><span id="9472" class="jx ir hh jt b fi nb jz l ka kb">y_pred = model_ABR.predict(X_test)<br/>accuracies = cross_val_score(estimator = model_ABR, X = X_train, y = y_train, cv = 5,verbose = 1)<br/>print('')<br/>print('###### AdaBoostRegressor ######')<br/>print('Score : %.4f' % model_ABR.score(X_test, y_test))<br/>print(accuracies)</span><span id="ad60" class="jx ir hh jt b fi nb jz l ka kb">mse = mean_squared_error(y_test, y_pred)<br/>mae = mean_absolute_error(y_test, y_pred)<br/>r2 = r2_score(y_test, y_pred)</span><span id="a1e8" class="jx ir hh jt b fi nb jz l ka kb">print('')<br/>print('MSE    : %0.2f ' % mse)<br/>print('MAE    : %0.2f ' % mae)<br/>print('R2     : %0.2f ' % r2)<br/>r2_scores.append(r2)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es nh"><img src="../Images/27963246431b35f70d7113de807097ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*wVAWkVvF6Zex4MoZ3smbvw.png"/></div></figure><h1 id="af59" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">树外回归因子</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="7b19" class="jx ir hh jt b fi jy jz l ka kb">model_ETR =  ExtraTreesRegressor()<br/>model_ETR.fit(X_train , y_train)</span><span id="e899" class="jx ir hh jt b fi nb jz l ka kb">y_pred = model_ETR.predict(X_test)<br/>accuracies = cross_val_score(estimator = model_ETR, X = X_train, y = y_train, cv = 5,verbose = 1)<br/>print('')<br/>print('###### ExtraTreesRegressor ######')<br/>print('Score : %.4f' % model_ETR.score(X_test, y_test))<br/>print(accuracies)</span><span id="3657" class="jx ir hh jt b fi nb jz l ka kb">mse = mean_squared_error(y_test, y_pred)<br/>mae = mean_absolute_error(y_test, y_pred)<br/>r2 = r2_score(y_test, y_pred)</span><span id="a2e5" class="jx ir hh jt b fi nb jz l ka kb">print('')<br/>print('MSE    : %0.2f ' % mse)<br/>print('MAE    : %0.2f ' % mae)<br/>print('R2     : %0.2f ' % r2)<br/>r2_scores.append(r2)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ni"><img src="../Images/ee2abb0e7e565dbe3d1e6fbccbfe5816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*qliZip9SLmbay4KXMyw9mw.png"/></div></figure><h1 id="c705" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">梯度推进回归器</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="46d3" class="jx ir hh jt b fi jy jz l ka kb">model_GBR =  GradientBoostingRegressor()<br/>model_GBR.fit(X_train , y_train)</span><span id="49e2" class="jx ir hh jt b fi nb jz l ka kb">y_pred = model_GBR.predict(X_test)<br/>accuracies = cross_val_score(estimator = model_GBR, X = X_train, y = y_train, cv = 5,verbose = 1)<br/>print('')<br/>print('###### GradientBoostingRegressor ######')<br/>print('Score : %.4f' % model_GBR.score(X_test, y_test))<br/>print(accuracies)</span><span id="cb2e" class="jx ir hh jt b fi nb jz l ka kb">mse = mean_squared_error(y_test, y_pred)<br/>mae = mean_absolute_error(y_test, y_pred)<br/>r2 = r2_score(y_test, y_pred)</span><span id="0e1c" class="jx ir hh jt b fi nb jz l ka kb">print('')<br/>print('MSE    : %0.2f ' % mse)<br/>print('MAE    : %0.2f ' % mae)<br/>print('R2     : %0.2f ' % r2)<br/>r2_scores.append(r2)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/22a82651596a5d0dd2e8321a13bef371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*lDXPbbrfKV8cMPEJ8L10Cg.png"/></div></figure><h1 id="82b3" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">线性回归</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="2042" class="jx ir hh jt b fi jy jz l ka kb">model_LR =  LinearRegression()<br/>model_LR.fit(X_train , y_train)</span><span id="1bbe" class="jx ir hh jt b fi nb jz l ka kb">y_pred = model_LR.predict(X_test)<br/>accuracies = cross_val_score(estimator = model_LR, X = X_train, y = y_train, cv = 5,verbose = 1)<br/>print('')<br/>print('###### LinearRegression ######')<br/>print('Score : %.4f' % model_LR.score(X_test, y_test))<br/>print(accuracies)</span><span id="9ab3" class="jx ir hh jt b fi nb jz l ka kb">mse = mean_squared_error(y_test, y_pred)<br/>mae = mean_absolute_error(y_test, y_pred)<br/>r2 = r2_score(y_test, y_pred)</span><span id="868e" class="jx ir hh jt b fi nb jz l ka kb">print('')<br/>print('MSE    : %0.2f ' % mse)<br/>print('MAE    : %0.2f ' % mae)<br/>print('R2     : %0.2f ' % r2)<br/>r2_scores.append(r2)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es nk"><img src="../Images/3745973db046a9ff236e5a71239f2097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*lw9aABLnLX4W2evDaEgHFw.png"/></div></figure><h1 id="5ca0" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">可视化算法的R2分数</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="924d" class="jx ir hh jt b fi jy jz l ka kb">compare = pd.DataFrame({‘Algorithms’ : models , ‘R2-Scores’ : r2_scores})<br/>compare.sort_values(by=’R2-Scores’ ,ascending=False)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es nl"><img src="../Images/d7289a974bcac31c63ebbc99bc35b3f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*DJO1_lkBckP27R7t0V9LRA.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="8aa6" class="jx ir hh jt b fi jy jz l ka kb">plt.plot(compare['Algorithms'], compare['R2-Scores'], label = "R2-Score")</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es nm"><img src="../Images/b828f6fec50e989b2cf96078b05ffe54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SCdOBQicFyTi68WlkoB5cw.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5657" class="jx ir hh jt b fi jy jz l ka kb">sns.barplot(x='R2-Scores' , y='Algorithms' , data=compare)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es na"><img src="../Images/57347675de475dbe4f1c6a81aeace97a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i87puQqS4W7QavWfQ4EDOA.png"/></div></div></figure><h1 id="5dda" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">额外的树回归，因为它具有最高的r2分数(98%)</h1></div></div>    
</body>
</html>