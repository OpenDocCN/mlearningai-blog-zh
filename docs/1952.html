<html>
<head>
<title>IPL Score Prediction Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习的IPL分数预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/ipl-score-prediction-using-machine-learning-f6587e353532?source=collection_archive---------1-----------------------#2022-02-15">https://medium.com/mlearning-ai/ipl-score-prediction-using-machine-learning-f6587e353532?source=collection_archive---------1-----------------------#2022-02-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/867d71b33a427c4d4b1531973d2fff06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mU5v1Krl9xcHTHNUAtrIOQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://keepingupwithdatascience.wordpress.com/2022/02/14/ipl-score-predictions/" rel="noopener ugc nofollow" target="_blank"><strong class="bd iu">SOURCE</strong></a></figcaption></figure><h1 id="face" class="iv iw hh bd iu ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">介绍</h1><p id="b398" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">随着IPL赛季的到来(对于那些不熟悉IPL的人来说，这是印度和所有板球国家的欧洲板球联赛或NBA)，我想分享数据科学在板球中的用例。数据科学和分析正在体育领域得到广泛应用。你可以在<a class="ae it" href="https://www.analyticsinsight.net/the-role-of-ai-iot-and-data-analysis-in-cricket/" rel="noopener ugc nofollow" target="_blank">这里</a>阅读更多关于数据科学和体育分析的信息。</p><p id="b302" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">在这篇<a class="ae it" href="https://keepingupwithdatascience.wordpress.com/" rel="noopener ugc nofollow" target="_blank">博客</a>的帖子中，我将带你浏览一个叫做IPL分数预测器的数据科学用例。在开始这个项目之前，我想向那些不了解板球的人解释一下板球运动。如果你知道这个游戏，请随意跳过它，进入代码部分。</p><h1 id="d929" class="iv iw hh bd iu ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">板球是什么？</h1><p id="f272" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">板球有两个队，每队11人。每个队轮流击球和比赛，就像在棒球中一样。在板球运动中，击球手是击球手，投手是投球手。投球手试图击倒三柱门的栏杆。击球手试图通过击球来阻止投球手击中三柱门。两名击球手同时在球场上。</p><p id="bcaf" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">我希望你已经了解了游戏的基本知识。现在，让我们深入问题陈述。</p><h1 id="fa9e" class="iv iw hh bd iu ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">IPL分数预测器</h1><h1 id="531f" class="iv iw hh bd iu ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">问题陈述</h1><p id="a8f5" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">问题陈述指出，</p><blockquote class="kv kw kx"><p id="dfbe" class="js jt ky ju b jv kq jx jy jz kr kb kc kz ks kf kg la kt kj kk lb ku kn ko kp ha bi translated"><em class="hh">使用IPL数据集，预测你最喜欢的球队的得分。</em></p></blockquote><p id="3356" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">让我们阅读数据文件，并初步看看数据。您可以通过<a class="ae it" href="https://github.com/Chitwan54/IPL-Score-Prediction" rel="noopener ugc nofollow" target="_blank">链接</a>访问数据。</p><h1 id="5a54" class="iv iw hh bd iu ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">数据分析和数据预处理</h1><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="c360" class="ll iw hh lh b fi lm ln l lo lp"># Load the data<br/>ipl_data = pd.read_csv("/content/ipl_data.csv")<br/>ipl_data.head()</span></pre><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/cf304ff66292aea80790104678a470e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MI2HCFkub9gPC4qo"/></div></div></figure><p id="b05b" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">现在我们知道数据是什么样子了。下一步包括分析基本指标，如数据的形状、空值的数量、每个变量的数据类型等。所有这些都可以通过使用pandas info()函数轻松完成。下面的代码单元格演示了同样的情况。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="8f5c" class="ll iw hh lh b fi lm ln l lo lp">ipl_data.info()</span></pre><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lr"><img src="../Images/f0e8df73e9f993e782af2cb6688eb88d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I7ybIZ-z6wzzlevK"/></div></div></figure><p id="5284" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">从上面的输出可以清楚地看出，我们的数据集中有大约76014个非空条目和总共14个变量/特征。我们数据分析和预处理的下一步包括找出变量之间的关系/依赖性，删除不必要的列，对分类列进行编码等。</p><p id="ffd7" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">接下来，我们删除一些不必要的变量，并进行进一步的预处理。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="199e" class="ll iw hh lh b fi lm ln l lo lp"># Drop the unnecessary cols like mid, striker and non striker</span><span id="357e" class="ll iw hh lh b fi ls ln l lo lp">columns_to_drop = ['mid', 'striker', 'non-striker']<br/>ipl_data.drop(columns_to_drop, axis = 1, inplace = True)</span></pre><p id="9b0b" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">去掉不必要的变量后，我们检查数据集中的团队。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="6c79" class="ll iw hh lh b fi lm ln l lo lp"># Print all the teams<br/>print(np.unique(ipl_data['bat_team']))</span></pre><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lt"><img src="../Images/8ae2477732f4bb28f0f5a83217385294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zQFrXypS4-pj9ldh"/></div></div></figure><p id="645a" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">那些板球爱好者和IPL的追随者必须意识到，上面输出中显示的一些球队要么已经完全退出，要么已经改变了他们的名字。因此，在下一步中，我将放弃那些与IPL无关的队伍，只考虑当前的队伍。例如，Gujarat Lions不再比赛，因此，所有与之相关的数据点都将被删除。</p><pre class="lc ld le lf fd lg lh li lj aw lk bi"><span id="26de" class="ll iw hh lh b fi lm ln l lo lp"># We don't want the teams which are not playing rn</span><span id="1e84" class="ll iw hh lh b fi ls ln l lo lp">all_teams = np.unique(ipl_data['bat_team'])<br/>old_teams = ['Deccan Chargers', 'Kochi Tuskers Kerala', 'Gujarat Lions', 'Kochi Tuskers Kerala', 'Rising Pune Supergiant', 'Pune Warriors', 'Rising Pune Supergiants']<br/>current_teams = [teams for teams in all_teams if teams not in old_teams] </span><span id="38ab" class="ll iw hh lh b fi ls ln l lo lp"># Use the rows which have current_teams</span><span id="b7f3" class="ll iw hh lh b fi ls ln l lo lp">ipl_data = ipl_data[ipl_data['bat_team'].isin(current_teams) &amp; ipl_data['bowl_team'].isin(current_teams)]</span></pre><p id="e767" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">去除旧团队后，我们检查变量之间的相关性。相关性是一个统计术语，描述两个变量相互协调移动的程度。这可以在Python中使用熊猫来完成。DataFrame.corr()函数。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/2578953ca3572995f2a1bfa0ca339b63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j6lXaSq3l4IRlY1x"/></div></div></figure><p id="9085" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">runs和overs以及runs和runs_last_5之间似乎有很高的相关性。这是有道理的，而且跑的次数似乎也增加了。</p><p id="984f" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">数据预处理的下一步包括分类变量的编码。因此，分类变量可以有两种类型:序数和名词性。有序分类变量包括那些具有潜在顺序的变量。比如好，更好，最好或者高，中，低。另一种类型是没有任何潜在顺序的名义分类变量。比如性别。</p><p id="33fd" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">我将使用sklearn的LabelEncoder处理顺序变量，使用pandas get_dummies()处理名义变量。对分类变量进行编码后，数据看起来像这样。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/e252d9f11d9d26fbbe0c92528857f5c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-QUOkDQPjhd1WypN"/></div></div></figure><p id="ae73" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">下一步是将所有变量放在同一个尺度上，这就是所谓的特征缩放。因此，这一步非常重要，如果你要建立一个线性回归模型或KNN模型，特征缩放可以帮助提高这些模型的性能。我将使用sklearn的StandardScaler类来缩放变量。它将所有变量的平均值降至0，标准差降至1。</p><p id="7fa7" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">缩放后的数据看起来像这样，</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/c458412df3fee9f66e47f1993f77d36a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Wa6hHmpj1-HQBPh-"/></div></div></figure><p id="2591" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">在所有的预处理步骤之后，我们就可以进行机器学习建模了。</p><h1 id="4e61" class="iv iw hh bd iu ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">机器学习建模</h1><p id="4205" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">接下来的步骤包括，建立一个机器学习模型，预测比赛中的总得分。一种体面的方法可以是从简单的模型开始，然后逐步过渡到复杂的模型。一旦我们测试了相当数量的模型，我们就可以列出表现最好的模型，并开始调整超参数以进一步改善结果。我按照给定的顺序选择了以下型号。</p><ol class=""><li id="2312" class="lv lw hh ju b jv kq jz kr kd lx kh ly kl lz kp ma mb mc md bi translated">KNN回归量</li><li id="d5d0" class="lv lw hh ju b jv me jz mf kd mg kh mh kl mi kp ma mb mc md bi translated">线性回归</li><li id="7cc8" class="lv lw hh ju b jv me jz mf kd mg kh mh kl mi kp ma mb mc md bi translated">决策树回归器</li><li id="5cd2" class="lv lw hh ju b jv me jz mf kd mg kh mh kl mi kp ma mb mc md bi translated">随机森林回归量</li><li id="407e" class="lv lw hh ju b jv me jz mf kd mg kh mh kl mi kp ma mb mc md bi translated">XGBoost回归器</li></ol><p id="59e5" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">下表基于各种回归性能指标对这些模型进行了比较。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mj"><img src="../Images/be2635d26c35ba228bdcc95e5f382461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/0*wvf1kx5vnSo4_AX7.png"/></div></div></figure><p id="bf17" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">从上表可以清楚地看出，与其他所有模型相比，XGBoost模型的性能最好。线性回归的不良表现可归因于变量之间的多重共线性。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/c59f69daf1602efffba03a78b441f5a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_WKlmKoOzEAymwn2"/></div></div></figure><h1 id="edbc" class="iv iw hh bd iu ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">结论</h1><p id="e899" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">这是数据科学在体育领域的一个用例。你可以在这里访问整个代码库<a class="ae it" href="https://github.com/Chitwan54/IPL-Score-Prediction" rel="noopener ugc nofollow" target="_blank">。我希望你觉得这篇博文内容丰富。请与其他学习者分享，并帮助社区共同成长。请在评论中告诉我你的反馈。你也可以在我的博客</a><a class="ae it" href="https://keepingupwithdatascience.wordpress.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hi">了解更多，跟上数据科学</strong> </a>。我每周都在这里发帖。快乐学习。🙂</p><div class="mk ml ez fb mm mn"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hi fi z dy ms ea eb mt ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">medium.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb in mn"/></div></div></a></div><p id="6d4d" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">🔵<a class="ae it" rel="noopener" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"> <strong class="ju hi">成为作家</strong> </a></p></div></div>    
</body>
</html>