<html>
<head>
<title>Credit Card Fraud Detection Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习的信用卡欺诈检测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/credit-card-fraud-detection-using-machine-learning-399e400f0600?source=collection_archive---------3-----------------------#2021-03-04">https://medium.com/mlearning-ai/credit-card-fraud-detection-using-machine-learning-399e400f0600?source=collection_archive---------3-----------------------#2021-03-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6df5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在这里找到完整的代码</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/77f4aafc08cb9d491183873d04e8a75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhHcxo1r1D-OfG-qbPCS2Q.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Source:<a class="ae jc" href="https://www.paymentsjournal.com/credit-card-fraud-stories-cant-make-stuff-up/" rel="noopener ugc nofollow" target="_blank"> https://giphy.com/gifs/glitch-money-shopping-d3mmdNnW5hkoUxTG</a></figcaption></figure><p id="dc88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jt translated"><span class="l ju jv jw bm jx jy jz ka kb di">在</span>这个快节奏的数字世界里，我们融入了数字交易社会。预计在未来几年，非现金交易将稳步增长。随着这种数字交易每年不断增加，信用卡欺诈的数量也在不断增加。根据最近的一项研究，仅在2016年，美国就有1540万人遭遇信用欺诈。</p><p id="6830" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有几种方法可以阻止这些欺诈活动，但我将在这里向您介绍我的机器学习方法。</p><h1 id="e712" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">收集数据</strong></h1><p id="ef1b" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">我使用了包含284807个事务的Kaggle数据集。该数据集显示了两天内发生的交易，其中284，807笔交易中有492笔欺诈。数据集高度不平衡，正类(欺诈)占所有交易的0.172%。</p><h1 id="9be4" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">探索性数据分析</h1><p id="3bc3" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">最初，我想探索时间、数量和类数据列</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lf"><img src="../Images/e2955b7cc9135eb0a664755dfb485376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fTvdXCGThhAO4qIxm4rHFA.png"/></div></div></figure><p id="8f5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">时间以秒为单位记录，数据集包括两天内记录的所有交易。大多数交易发生在白天。绝大多数交易相对较小，只有极小一部分来自甚至接近最大值的交易。大多数日常事务并不是非常昂贵(大多数是</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lg"><img src="../Images/ff0321ea4b3cffc42f9c73869f1db0f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j67p3uS6GdiOWYihyydD3w.png"/></div></div></figure><p id="b25f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">In the long tail, fraud transactions happened more frequently. It seems It would be hard to differentiate fraud from normal transactions by transaction amount alone. Hour “zero” corresponds to the hour the first transaction happened and not necessarily 12–1 am. Given the heavy decrease in normal transactions from hours 1 to 8 and again roughly at hours 24 to 32, it seems fraud tends to occur at higher rates during the night. Statistical tests could be used to give evidence for this fact.</p><p id="ca0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Looking at the class distribution we can see there are only 492 fraudulent transactions. That’s only 0.173% of all of the transactions in this dataset!</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lh"><img src="../Images/77c61e131a8ad6aca169af8a17a09c9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODE0Ch6HZG_kuRs_JikEwQ.png"/></div></div></figure><h1 id="a604" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">功能扩展</strong></h1><p id="4128" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">正如我们从数据集中了解到的，V1-V28的特征已经通过PCA进行了转换，并且已经进行了缩放。而特征“时间”和“数量”没有。考虑到我们将与其他V1 v 28一起分析这两个特征，在我们使用各种算法训练我们的模型之前，它们应该被更好地缩放。我们应该使用哪种缩放方法？不推荐使用<strong class="ig hi">标准定标器</strong>，因为“时间”和“数量”特征不是正态分布的。不推荐使用<strong class="ig hi">最小-最大缩放器</strong>，因为在特征“数量”中有明显的异常值。<strong class="ig hi">稳健定标器</strong>对异常值稳健:<strong class="ig hi">(Xi-Q1(x))/(Q3(x)-Q1(x))</strong>(Q1和Q3分别代表25%和75%的四分位数)。所以我们选择<strong class="ig hi">鲁棒缩放器</strong>来缩放这两个特征。</p><h1 id="6d9b" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">相关矩阵</h1><p id="c6cb" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">相关矩阵是理解我们数据的本质。我们想知道是否有特征对特定交易是否是欺诈有重大影响。我使用热图来了解数据中是否存在强烈的共线性</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es li"><img src="../Images/458689e38c60061b1bab04b56984a39d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKPX3oM9aVXYdErNRZ2njg.png"/></div></div></figure><h1 id="0e6d" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">建筑模型</strong></h1><p id="a0c2" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">在创建任何模型之前，我将数据集分成70%-30%用于训练和测试。另一个需要解决的问题是高度不平衡的数据集。评价和解决不平衡问题的方法有很多种。合成少数过采样技术(SMOTE)是解决这一问题的过采样方法之一。在SMOTE方法的基础上，我使用了borderline-SMOTE方法来处理数据集的不平衡。有了这个设置，我现在可以在一些模型中运行数据了。在使用逻辑回归、DecisionTreeClassifier和RandomForestClassifier这三个模型之前，我使用了<a class="ae jc" rel="noopener" href="/vickdata/a-simple-guide-to-scikit-learn-pipelines-4ac0d974bdcf">管道</a>方法来简化我的工作流程。</p><h1 id="51b6" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">三个模型的总结结果:</h1><p id="a660" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">使用逻辑回归模型，我们在测试数据集中捕获了147个欺诈案例中的129个，1501个交易被错误地标记为欺诈。当你在没有确认你的旅行的情况下在州外旅行，并且你在你买东西之后得到一个通知的时候，想想这个假阳性的场景。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/7cd9bd01de4b6660a74567527f37c051.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*l02Tt4MQtC38wLhgoBS8Ng.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Confusion Matrix: Logistic Regression</figcaption></figure><p id="0ed7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用决策树分类器，测试数据集中的147个欺诈案例中有104个被检测到，但它表现非常好，显示出大约81个交易的假阳性较少。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/b76d28eb79ec01b633448687b0fff302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*vv8UO6c1dCU2iGKtClLW-A.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Confusion Matrix: DecisionTreeClassifier</figcaption></figure><p id="ca4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">RandomForestClassifier捕获了147个欺诈案例中的117个，只有13个错误地将正常交易检测为欺诈交易</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/6879e5eca6833d8d59268967eb0b9eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*zH76q2hUaib_yz5sWRQ6Bg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Confusion Matrix: RandomForestClassifier</figcaption></figure><h1 id="1f75" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">张量流Keras模型</strong></h1><p id="3de7" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">我用深度学习模型对诈骗案例进行了分类，并与我之前的三个模型进行了对比。</p><p id="9241" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用Relu激活函数对所有层进行编码，使用sigmoid激活函数对输出进行解码。然后用Adam optimizer训练Keras模型。使用binary_crossenttropy作为损失函数，并且在100个时期上训练模型，批量大小等于256。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lk"><img src="../Images/75d77fd4179dc13aea31558d15b443a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2NvlvRogkOhS1dl6Uvh9Bw.jpeg"/></div></div></figure><h1 id="f8f1" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">模型评估</strong></h1><p id="eb96" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">我使用受试者操作特征(ROC)和混淆矩阵来评估模型。ROC是在各种阈值下对分类问题的性能测量。它本质上是一条概率曲线，曲线下面积(AUC)得分越高，该模型预测欺诈性/非欺诈性交易的能力就越强。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/2bb35d7a46f41b1cc4394f5f45b255a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1rRaodza2FOxs4TV5LQwag.png"/></div></div></figure><p id="691e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在85334个验证交易的训练结束时，我们能够正确识别82个欺诈交易，并错过其中的26个。我们错误地标记了1552个合法交易。</p><p id="4a5f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在现实世界中，人们会给第1类赋予更高的权重，以反映出假阴性比假阳性的代价更大。下次你的信用卡在网上购物时被拒绝，这就是原因。</p><h1 id="b508" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated"><strong class="ak">结论</strong></h1><p id="f195" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">信用卡欺诈检测一直是机器学习中的一个重要领域。这主要是由于欺诈模式的不断变化。</p><p id="c635" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有很多方法可以检测你信用卡上的欺诈行为，看到公司如何在日常生活中处理这种情况真的很酷。我们的机器学习模型显示，即使基于高度匿名化数据训练的简单逻辑回归模型也能够预测非欺诈交易。</p></div></div>    
</body>
</html>