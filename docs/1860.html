<html>
<head>
<title>Predicting the Income Level of Countries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测各国的收入水平</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/predicting-the-income-level-of-countries-a829e43459c?source=collection_archive---------4-----------------------#2022-02-05">https://medium.com/mlearning-ai/predicting-the-income-level-of-countries-a829e43459c?source=collection_archive---------4-----------------------#2022-02-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="8daa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在写了我过去关于自动机器学习的大部分博客后，我决定将这篇文章献给一个实际的机器学习任务。</p><p id="b847" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这项任务的目标是找出一个国家收入水平的预测属性，因此，试图根据某些属性预测一个国家的收入水平。</p><p id="01b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">原始源代码可以在[1]中找到。</p><h1 id="07f2" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">数据选择</h1><p id="3586" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">开始时，我们必须决定任务要考虑的属性，并找到数据源来为我们提供相关数据。在这里，重要的是要注意可能是低收入国家造成的属性，而不是有助于解释收入水平的属性(例如，保健支出低很可能是低收入国家造成的)。</p><p id="9999" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们决定采用进出口、自然资源、CO₂排放量和工作部门及其对国内生产总值的贡献的数据。</p><p id="3cb4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，我们在选择适当的年份时遇到了一些困难。由于当时并非所有2021年的数据都可用，2020年的数据由COVID主导，这就是为什么数据中可能存在一些异常，我们决定使用2019年的数据。</p><p id="b192" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以从世界银行[2]和我们的世界数据库[3]中下载所有的数据。</p><h1 id="ce3b" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">数据预处理</h1><p id="4d71" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">数据预处理包括加载数据和检查丢失的数据值。如果某个值缺失，我们使用pandas的插值函数来使用前几年的值进行插值。</p><p id="5097" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">两个数据源都包括国家名称和国家代码(三位数代码)。我们使用dataprep库[4]标准化国家名称。之后，使用这些属性合并数据集就很容易了。</p><p id="d7b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">合并后，数据框架由42个属性组成。此外，我们决定删除非Nan值少于20的行。剩余的NaN值用零填充。</p><h1 id="b4d0" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">数据探索</h1><p id="b800" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">在对数据进行预处理之后，我们查看了各自的属性值，并检查了异常值和根本没有意义的值。因此，我们为每个属性绘制了箱线图，并进一步检查了大于<em class="kf"> Q3 + 1.5*IQR </em>的数据点。</p><p id="3a6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们反复核对了高得令人难以置信的数值，并得出结论，大多数数值似乎都有道理(例如，中国的出口比率比其他国家高得多)。</p><p id="a4ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们继续观察变量的分布，发现它们中的许多是非常偏斜的(见下面的例子)。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kg"><img src="../Images/06f6e2555bdff4076aedfbbf804153d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*-P7b_-0M2-u_6haYSUr2Pg.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Distribution of Annual CO2 Emissions from Coal</figcaption></figure><p id="7b8c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们研究了产出变量(GNI——国民总收入——人均),它也非常不准确。我们在现阶段已经计算出，对于高国民总收入值，预测很可能不准确，因为数据点很少。下图显示了分布情况。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ks"><img src="../Images/a57a621c2e59d34bb5c53724f05e19e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*DreaJC5Oxc5GtGfVJGM5TQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Distribution of GNI Per Capita</figcaption></figure><p id="4204" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，我们检查了相关性，并在热图中绘制了相关系数大于0.75的相关性。这导致我们删除了另外两个属性，因为相关性太高，它们不会提供更多的信息。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es kt"><img src="../Images/2e45b44707d28fe684413e5240bd5b98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KG5QDdeTl-81M5A54Qyabw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">Correlation Plot</figcaption></figure><h1 id="60d2" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">机器学习</h1><p id="8074" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">在探索数据之后，我们尝试使用线性回归来预测一个国家的GNI值。不幸的是，数据似乎不是线性可分的，预测值极端地为-80 000。</p><p id="9ac2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们决定实施5重交叉验证，并比较随机森林回归、支持向量回归、Lasso回归和K-NN回归。此外，我们使用最小-最大-缩放器和标准-缩放器来缩放数据，以检查最佳缩放方法。</p><p id="0180" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于每个模型，我们运行网格搜索CV来考虑不同的超参数值并优化它们。根据模型(例如K-NN)，超参数值可能会对特定数据集上的模型性能产生巨大影响。</p><p id="75fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随机森林回归导致最佳结果，下面提供了独立测试集上的最终模型和预测性能的概述。</p><pre class="kh ki kj kk fd ky kz la lb aw lc bi"><span id="274f" class="ld jd hh kz b fi le lf l lg lh">Best Model: Random Forest Regressor<br/>Final Hyper-Parameters: {'criterion': 'absolute_error', 'min_samples_leaf': 3, 'n_estimators': 75}<br/>RMSE: 10473.221551759796<br/>Explained Variance: 0.5597928858095078<br/>Max Error: 34088.66666666667<br/>Mean Absolute Error: 6195.449645390071<br/>Median Absolute Error: 2092.533333333333</span></pre><p id="051e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图显示了最终预测。可以看出，对较低国民总收入值的预测相当准确，而对较高国民总收入值的残差相当大。</p><p id="6b38" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在查看模型的结果时，也可以观察到这一点。RMSE(对高残差的惩罚很大)非常高，最大误差和平均误差也是如此。尽管如此，中值误差还是相当低的。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kg"><img src="../Images/93ec8acc28905ec3dc505f27506870cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*mAMz5wpmIoxZqAtd4rNxlQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Performance of the Final Model</figcaption></figure><h1 id="d26e" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">特征重要性</h1><p id="c9ad" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">由于该任务的一个主要目标是找出哪些属性可以预测GNI值，因此我们使用特征排列来计算特征重要性。</p><p id="3da7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在特征置换中，给定属性的值被混洗(从输出变量解耦),并且计算关于预测误差的结果。如果错误率变化很大，该属性将产生很大的影响，并且对预测很重要，反之亦然。</p><p id="b746" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们提取了最终模型的三个最重要的特征，并将其值与人均国民总收入值进行了对比。可以看出，特别是农业就业和服务业就业值提供了一个国家国民总收入值的大量信息。要获得更全面的分析，我建议您参考[1]中的GitHub库。</p><div class="kh ki kj kk fd ab cb"><figure class="li kl lj lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/d22141e845568592c7a69dee2068a91e.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*uaMWT3B2hCkS8g8zd5UtTw.png"/></div></figure><figure class="li kl lj lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/97ec0cd464413a87d0360bea6bdac750.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*NvT4iC2C6_YspioElMZ6vw.png"/></div></figure><figure class="li kl lj lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/dc44007fbab3ea848897e1e09247d659.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*E6HbDBZ1LXIc6oGqd46HrQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx lo di lp lq">Important Attibutes vs. GNI Per Capita</figcaption></figure></div><p id="f4e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在特征重要性评估期间，我们发现，至少根据我们的数据集，工作部门和CO₂排放量是最具预测性的，并且是与贸易(进口、出口)相关的主导变量。</p><p id="1ba7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">尽管如此，我们相信，通过考虑更大和更多样化的数据集，可以做出更好的预测。然而，重要的是要考虑到哪些变量影响一个国家的收入水平，哪些变量是一个国家收入水平的直接结果，不要在数据中包含任何偏差。</p></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><p id="1df7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[1]<a class="ae ly" href="https://github.com/sabrinaherbst/income_level_country" rel="noopener ugc nofollow" target="_blank">https://github.com/sabrinaherbst/income_level_country</a></p><p id="8cb3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[2]世界银行。世界发展指标。在databank.worldbank.org在线出版。检索自:<a class="ae ly" href="https://databank.worldbank.org/source/world-development-indicators" rel="noopener ugc nofollow" target="_blank">https://databank . world bank . org/source/world-development-indicators</a>。[在线资源]。</p><p id="d1e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[3]汉娜·里奇和马克斯·罗瑟(2020)。CO₂和温室气体排放。在OurWorldInData.org在线出版。检索自:<a class="ae ly" href="https://ourworldindata.org/co2-and-other-greenhouse-gas-emissions" rel="noopener ugc nofollow" target="_blank">https://ourworldindata . org/CO2-和-其他-温室气体-排放</a>【在线资源】。</p><p id="5e2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae ly" href="https://pypi.org/project/dataprep/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/dataprep/</a></p><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hi fi z dy mh ea eb mi ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq km mc"/></div></div></a></div></div></div>    
</body>
</html>