<html>
<head>
<title>Consuming Hugging Face models using AML SDK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AML SDK消费拥抱脸模型</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/consuming-hugging-face-models-using-aml-sdk-e0704de5ef55?source=collection_archive---------5-----------------------#2022-06-04">https://medium.com/mlearning-ai/consuming-hugging-face-models-using-aml-sdk-e0704de5ef55?source=collection_archive---------5-----------------------#2022-06-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/79f524f55fb3812d8e3a155de3e11f02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8Fy1bEY5eUOnHwtg"/></div></div></figure><h1 id="d615" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">如何在python Azure机器学习SDK中消费拥抱人脸模型</h1><h1 id="a454" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">细节</h1><ul class=""><li id="b1fc" class="jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">本教程旨在展示在AML workspace中如何轻松地调用拥抱脸模型并进行消费</li><li id="2d9a" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">还可以看到从拥抱脸下载预训练模型是多么容易</li><li id="2684" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">下载后，我们可以用python代码进行消费</li><li id="3fe2" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">展示如何创建管道来使用模型</li></ul><h1 id="6e59" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">步伐</h1><ul class=""><li id="78a7" class="jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">首先用这个版本更新transformer包</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="471b" class="kt iq hh kp b fi ku kv l kw kx">%pip install transformers==4.17.0</span></pre><ul class=""><li id="96db" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">否则，生成器代码无法找到配置json文件</li><li id="612c" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">现在进口</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="78f0" class="kt iq hh kp b fi ku kv l kw kx">from transformers import GPT2Config, GPT2Tokenizer, GPT2LMHeadModel, pipeline</span></pre><ul class=""><li id="8ad3" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">让我们下载拥抱脸模型</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="ddb2" class="kt iq hh kp b fi ku kv l kw kx">tokenizer = GPT2Tokenizer.from_pretrained("gpt2")<br/>tokenizer.save_pretrained("./model/tokenizer")<br/>model = GPT2LMHeadModel.from_pretrained("gpt2")<br/>model.save_pretrained("./model/weights")<br/>config = GPT2Config.from_pretrained("gpt2")<br/>config.save_pretrained("./model/config")</span></pre><ul class=""><li id="aaf5" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">创建管道</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="fdb8" class="kt iq hh kp b fi ku kv l kw kx">generator = pipeline(<br/>    "text-generation",<br/>    model="./model/weights",<br/>    tokenizer="./model/tokenizer",<br/>    config="./model/config",<br/>)</span></pre><ul class=""><li id="2eca" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">打包一些要发送的文本</li><li id="9771" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">提示是要发送的文本</li><li id="68d9" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">最大长度是生成文本的最大长度</li><li id="e92a" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">num_return_sequences是生成并发回的句子数</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="7ba0" class="kt iq hh kp b fi ku kv l kw kx">prompt = "what is the best place in world"<br/>max_length = 50<br/>num_return_sequences = 3</span></pre><ul class=""><li id="9ca0" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">调用模型推理</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="e26c" class="kt iq hh kp b fi ku kv l kw kx">generator(prompt, max_length=max_length, num_return_sequences=num_return_sequences)</span></pre><ul class=""><li id="6a87" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">输出</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="b1b0" class="kt iq hh kp b fi ku kv l kw kx">[{'generated_text': 'what is the best place in world to learn and be educated about the best fields of life?" he asks. "I believe that what is considered what is considered to be more dangerous is not what the best would do." The question of whether or not'},<br/> {'generated_text': 'what is the best place in world to buy a book so you can make your own? How is it different if the author is not interested in doing a single book or reading a couple of books in advance because they are not sure what a novel is'},<br/> {'generated_text': 'what is the best place in world for young scientists (myself included) to study the environment and to think about our planet and the future in the interest of other people?\n\nIn a world with a lot of different weather events and much more'}]</span></pre><ul class=""><li id="303c" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">完成的</li></ul><h1 id="db4b" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><em class="ld">最初发表于</em><a class="ae le" href="https://github.com/balakreshnan/Samples2022/blob/main/AzureML/hugginfacesdk.md" rel="noopener ugc nofollow" target="_blank"><em class="ld">【https://github.com】</em></a><em class="ld">。</em></h1><div class="lf lg ez fb lh li"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lj ab dw"><div class="lk ab ll cl cj lm"><h2 class="bd hi fi z dy ln ea eb lo ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lp l"><h3 class="bd b fi z dy ln ea eb lo ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lq l"><p class="bd b fp z dy ln ea eb lo ed ef dx translated">medium.com</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw in li"/></div></div></a></div></div></div>    
</body>
</html>