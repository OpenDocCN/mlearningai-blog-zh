<html>
<head>
<title>Working with Categorical Variables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用分类变量</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/working-with-categorical-variables-10d30936e496?source=collection_archive---------6-----------------------#2022-08-09">https://medium.com/mlearning-ai/working-with-categorical-variables-10d30936e496?source=collection_archive---------6-----------------------#2022-08-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/6b53ed5bfdb17f9d08e989e5c9eb0825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gYvP8fWjXY0DQAVo"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@v2osk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">v2osk</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e8cf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">世界分为许多类别，数据也是如此。思考类别是孩子理解世界的第一步。我们教孩子世界的分类。猫、狗、老虎、鹿都是动物。然后我们教猫、狗、羊是家养的，狮子、老虎、羊是野生动物。红色、黄色和蓝色是颜色。当孩子稍微大一点的时候，他/她会被介绍到有序分类的世界——第一、第二、第三以及冷、暖和热的温度。对于我们人类来说，分类对于理解世界非常重要。不幸的是，大多数机器学习算法不能处理分类变量。一些算法可以处理分类数据。<a class="ae it" href="https://en.wikipedia.org/wiki/Decision_tree_learning#Advantages" rel="noopener ugc nofollow" target="_blank">决策树——取决于它的实现——可以直接从分类数据中学习，不需要数据转换。</a></p><p id="4283" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">那么应该怎么做呢？</p><p id="8483" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">机器学习算法理解分类变量的第一步是将它们转换成数值。</p><h2 id="58ae" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">什么是分类变量？</h2><p id="03d5" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">在我们开始将分类变量转换成数值之前，理解各种类型的分类变量是很重要的。在数据科学中，有两种类型的分类变量——名义变量和序数变量。</p><p id="7464" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="ks">名义变量</em>没有特定的顺序，没有办法比较一个值和另一个值。例如，猫、狗、山羊、牛、狮子、老虎(动物)或钢笔、橡皮擦、铅笔(书写工具)或食草动物、食肉动物和杂食动物(基于饮食习惯)。人们无法以任何顺序排列这些值。</p><p id="e7a3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="ks">序数变量</em>有一定的顺序。示例—第一、第二或第三(考试排名)或A+、B、C-(考试成绩)或冷、暖、热(物体温度)。这些值是有顺序的，我们可以按某种顺序排列它们，比如物体的温度冷&lt;暖&lt;热。来自用户的反馈通常也是分类变量(优秀、良好、满意和差或强烈同意、同意、中立、不同意和强烈不同意)。</p><h1 id="2f53" class="kt jt hh bd ju ku kv kw jy kx ky kz kc la lb lc kf ld le lf ki lg lh li kl lj bi translated">编码器</h1><h2 id="9c67" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">为机器学习算法转换数值</h2><figure class="ll lm ln lo fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lk"><img src="../Images/e2bb7b110acb0798027060c4a96d4ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e7x7c2ZclL8PImud"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@jorgedevs?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jorge Ramirez</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="384c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有许多方法可以将分类变量转换为数值。</p><ol class=""><li id="335e" class="lp lq hh iw b ix iy jb jc jf lr jj ls jn lt jr lu lv lw lx bi translated">一键编码</li><li id="8b3e" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">标签编码</li><li id="cbd9" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">顺序编码</li><li id="b3c9" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">赫尔默特编码</li><li id="4d9f" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">二进制编码</li><li id="97f3" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">频率编码</li><li id="2aa8" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">平均编码</li><li id="4ebc" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">证据权重编码</li><li id="9db4" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">概率比编码</li><li id="f4e6" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">哈希编码</li><li id="000c" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">后向差分编码</li><li id="8fd7" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">省略一个编码</li><li id="27e3" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">詹姆斯-斯坦编码</li><li id="74dd" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">m估计编码</li><li id="e0fa" class="lp lq hh iw b ix ly jb lz jf ma jj mb jn mc jr lu lv lw lx bi translated">温度计编码器</li></ol><h1 id="9c94" class="kt jt hh bd ju ku kv kw jy kx ky kz kc la lb lc kf ld le lf ki lg lh li kl lj bi translated">标签编码</h1><p id="b3c7" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">假设数据中的分类变量有<em class="ks"> n </em>种类别(不同的值)。在<a class="ae it" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" rel="noopener ugc nofollow" target="_blank">标签编码</a>中，目标变量用0到<em class="ks"> n-1 </em>之间的值编码。这些作业之间没有关系。标签编码器通常根据字母顺序分配值。</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">sklearn_lbl_encode_1</figcaption></figure><p id="f7f1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些号码是按字母顺序排列的。<em class="ks">冷</em>编码为<em class="ks"> 0 </em>，<em class="ks">热</em>编码为<em class="ks"> 1 </em>，<em class="ks">极热</em>编码为2，以此类推。</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">sklearn_lbl_enc_1_result</figcaption></figure><p id="7475" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果添加了一个新的类别，则根据<em class="ks">字母顺序</em>改变编码。</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">sklearn_lbl_encode_2</figcaption></figure><p id="82bc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">引入了新的编码<em class="ks">微温</em>为<em class="ks"> 2 </em>并且<em class="ks">非常热</em>改为<em class="ks"> 3 </em>。</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">sklearn_lbl_enc_2_result</figcaption></figure><p id="7baf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">熊猫函数<code class="du mf mg mh mi b">factorize</code>也执行标签编码。在这种情况下，根据列中值出现的顺序<em class="ks">进行编码。</em></p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">pandas_factorize_1</figcaption></figure><p id="a2bd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="ks">热</em>被编码为<em class="ks"> 0 </em>，因为它是第一个值，然后是<em class="ks">极热</em>、<em class="ks">暖</em>和<em class="ks">冷</em>。</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">pandas_factorize_results_1</figcaption></figure><p id="b683" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当引入一个新的分类值时，分配的标签会改变。新的分类值<em class="ks">微温</em>被分配给<em class="ks"> 1 </em>。</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">pandas_factorize_2</figcaption></figure><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">pandas_factorize_results_2</figcaption></figure><h1 id="f5aa" class="kt jt hh bd ju ku kv kw jy kx ky kz kc la lb lc kf ld le lf ki lg lh li kl lj bi translated">一键编码</h1><p id="2acf" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">标签编码的缺点之一是，即使这些编码之间没有关系或顺序，机器学习算法也可能以某种顺序或关系来考虑它们。所以ML算法可能会认为<em class="ks">0&lt;1&lt;2&lt;3&lt;4</em>所以<em class="ks">热&lt;微温&lt;很热&lt;暖&lt;冷</em>这可能不是一个正确的关系。这可能会导致较差的性能和意外的结果。</p><p id="cfd2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这种情况下，可以应用<a class="ae it" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html" rel="noopener ugc nofollow" target="_blank">一键编码</a>。这种编码需要将分类数据提供给许多scikit-learn估计器，如线性模型、具有标准内核的支持向量机、神经网络以及聚类算法。事实上，OHE可以用于任何在训练期间同时查看所有特征的机器学习算法。</p><p id="5cda" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在OHE中，每个类别都被转换为一个新列，并为该列赋值0或1。实现如下。</p><h2 id="ac10" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">使用get_dummies()</h2><p id="3dd4" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">在下面的实现中，列<em class="ks">颜色</em>被一键编码。</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="eb55" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在实现中，自动删除列颜色，并为类别的每个不同值创建3个新列。0或1的值基于该观察(行)中的类别值。</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div></figure><h2 id="f640" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">使用sci-kit学习库</h2><p id="af30" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">在sci-kit learn library中使用OHE时，有两个步骤。在步骤1中，对列进行编码，在步骤2中，将编码值添加回dataframe。Python中的实现如下</p><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div></figure><figure class="ll lm ln lo fd ii"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="6bed" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="ks">继续关注此空间，了解与其他编码器相关的详细信息</em></p><div class="mj mk ez fb ml mm"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hi fi z dy mr ea eb ms ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">medium.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na in mm"/></div></div></a></div></div></div>    
</body>
</html>