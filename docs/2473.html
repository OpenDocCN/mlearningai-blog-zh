<html>
<head>
<title>Regression with Python from Scratch — Polynomial Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从零开始使用Python回归—多项式回归</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/regression-with-python-from-scratch-polynomial-regression-3e186198ae0c?source=collection_archive---------0-----------------------#2022-05-07">https://medium.com/mlearning-ai/regression-with-python-from-scratch-polynomial-regression-3e186198ae0c?source=collection_archive---------0-----------------------#2022-05-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0b91" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个故事中，我将我对线性回归的解释归纳为多项式回归。再次从创建带有噪声的随机数据开始，这一次我更多地使用了一种方法，这样我们就可以创建一个回归问题的类。</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><p id="3099" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">多项式回归是线性回归的一种，被称为多元线性回归的特例。它再次仅使用一个独立变量进行预测，但是假设所述独立变量和因变量之间存在n次多项式关系。</p><p id="8f27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的假设也是有效的(就像线性回归一样),即要预测的数据是输入的确定性函数和随机噪声的总和。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jj"><img src="../Images/99fa5e9399918412b97f942b12ac7481.png" data-original-src="https://miro.medium.com/v2/resize:fit:224/format:webp/1*oyu8JmpgfsuA-OrR01AM5g.png"/></div></figure><p id="cd06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中r是因变量，x是自变量，<em class="jr"> 𝜖 </em>是随机噪声。</p><p id="a7c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">概括线性回归中使用的估计量，我们有</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es js"><img src="../Images/cb35a2673e1a60bcf683d85e1ece57d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*cqk-T-yCN6iDvzedH1cjmA.png"/></div></figure><p id="2d2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">也可以写成</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jt"><img src="../Images/ee6e13ab22d36d002f81c21fa5020faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*3Q6haKOH-Io3dquLCkTnJw.png"/></div></figure><p id="60e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从进口说起。</p><pre class="jk jl jm jn fd ju jv jw jx aw jy bi"><span id="621e" class="jz ka hh jv b fi kb kc l kd ke">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="53c8" class="jz ka hh jv b fi kf kc l kd ke">np.random.seed(3)</span></pre><h2 id="85e7" class="jz ka hh bd kg kh ki kj kk kl km kn ko ip kp kq kr it ks kt ku ix kv kw kx ky bi translated">创建带有噪声的随机多项式数据</h2><p id="a2d7" class="pw-post-body-paragraph ie if hh ig b ih kz ij ik il la in io ip lb ir is it lc iv iw ix ld iz ja jb ha bi translated">一般来说，我们的多项式数据函数可以写成类似于我们的估计函数。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es le"><img src="../Images/00b865faa80b47e458d3f44c0ca40a79.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*mnJoFO4Lzh5LCF-VBKfEHQ.png"/></div></figure><p id="ecb5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中<em class="jr"> 𝑐 </em>是函数中每一项的常数，k是多项式函数的次数。</p><p id="33d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">记住</strong>我们在这里写这些只是因为我们正在生成将在本教程中使用的数据。在现实世界中，我们不知道哪种类型的函数最适合我们的数据，而这正是我们的估计函数的目标。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="9d18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们在创建常数时使用<em class="jr"> degree + 1 </em>的原因是，我们还向我们的数据(c_0)添加了一个偏差。</p><p id="1cdc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们绘制数据。</p><pre class="jk jl jm jn fd ju jv jw jx aw jy bi"><span id="85a4" class="jz ka hh jv b fi kb kc l kd ke">plt.scatter(X, y, s = 5)</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lh"><img src="../Images/0fa00f10cad027dd0d7a56c3fdf8eb0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*ExP0VK4YJ0bcEB5tbRRypQ.png"/></div></figure><p id="5df1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以有条理地创建数据部分，以便以后使用。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><h2 id="099b" class="jz ka hh bd kg kh ki kj kk kl km kn ko ip kp kq kr it ks kt ku ix kv kw kx ky bi translated">生成训练集和验证集</h2><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es li"><img src="../Images/b94d3c702fffe94b66c7483c895d73e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*9iHbOBfThL3A10cexDI19w.png"/></div></figure><h1 id="9452" class="lj ka hh bd kg lk ll lm kk ln lo lp ko lq lr ls kr lt lu lv ku lw lx ly kx lz bi translated">模特培训</h1><h2 id="d9f7" class="jz ka hh bd kg kh ki kj kk kl km kn ko ip kp kq kr it ks kt ku ix kv kw kx ky bi translated">权重的随机初始化</h2><p id="524f" class="pw-post-body-paragraph ie if hh ig b ih kz ij ik il la in io ip lb ir is it lc iv iw ix ld iz ja jb ha bi translated">我们再次从随机初始化权重开始。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="492b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们将我们的<em class="jr">尚未训练的</em>估计值与我们的数据进行对比，看看它是如何不符合实际的。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es ma"><img src="../Images/702080163e64ae15932ede98aba4d034.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*SIHzXHlARfcbHJrBEKYUyw.png"/></div></figure><h2 id="619f" class="jz ka hh bd kg kh ki kj kk kl km kn ko ip kp kq kr it ks kt ku ix kv kw kx ky bi translated">更新权重</h2><p id="1423" class="pw-post-body-paragraph ie if hh ig b ih kz ij ik il la in io ip lb ir is it lc iv iw ix ld iz ja jb ha bi translated">为了更新我们的权重，我们将使用以下等式</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es mb"><img src="../Images/66f9e828a3e04c8df3e6833a4f81b6fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*QQLf638orf5t205ESa6cEw.png"/></div></figure><p id="0fd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这与用于线性回归的相同。不过现在，我们可以将这些矩阵归纳如下。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es mc"><img src="../Images/4695b13ce58aeaa616c420330685696b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*UjH2nST_UmTym6RpaOOL6g.png"/></div></figure><p id="dd25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意，N也是总和，但是是x的0次方。</p><p id="1fbd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以如下实现这个矩阵点积。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="c144" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们再一次创造我们的情节，看看这一次，我们的预测是否符合。让我们绘制两个图，一个用于查看预测的每个训练数据，另一个用于验证数据。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es md"><img src="../Images/cd8d2401b8e563dec033bebb8bbfd106.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*B6trt4-aGLwQs_k4abxXtA.png"/></div></figure><h1 id="0bcb" class="lj ka hh bd kg lk ll lm kk ln lo lp ko lq lr ls kr lt lu lv ku lw lx ly kx lz bi translated">误差和决定系数</h1><p id="d80d" class="pw-post-body-paragraph ie if hh ig b ih kz ij ik il la in io ip lb ir is it lc iv iw ix ld iz ja jb ha bi translated">我们将使用与线性回归中相同的误差，即相对平方误差。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es me"><img src="../Images/9f090475c1210b98c4bdcb5accff876d.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*EZOYN9-2lblYKQZ-oGzA7A.png"/></div></figure><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es mf"><img src="../Images/db586ce9039eee412b62f9ca88d922d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*yjDLze9hid1L4WLKrVGMmg.png"/></div></figure><h2 id="a10d" class="jz ka hh bd kg kh ki kj kk kl km kn ko ip kp kq kr it ks kt ku ix kv kw kx ky bi translated">使用更高或更低次数的多项式预测器进行预测</h2><p id="29bc" class="pw-post-body-paragraph ie if hh ig b ih kz ij ik il la in io ip lb ir is it lc iv iw ix ld iz ja jb ha bi translated">现在让我们更进一步，看看假设我们的数据点和它们相应的值之间存在二阶关系会怎么样。我们可以用W平方项的权重来计算我们的新回归量(记住python range函数在上端是开放的，这意味着它不包括上端)。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="ec98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这给了我们情节</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es md"><img src="../Images/81bda7ac470a7b8a9e74fd72c102e4bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*MUnqsLN2ubfQDO2LxvZvzA.png"/></div></figure><p id="310b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">很明显，我们会有更大的误差，因为这种拟合在预测我们生成的值方面表现平平。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es mg"><img src="../Images/e3c6bd3189abbc99841f7b9cf35c0d37.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*22B480fEzj9SHEfrsnRxxw.png"/></div></figure><p id="7c28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">或</strong> …</p><p id="8a8b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以反其道而行之，使用更高程度的估计量进行预测。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="85ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不过这一次，我们希望能很好地拟合我们的数据，因为我们希望更高程度的权重接近于零。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es md"><img src="../Images/0b88c925bbc6ffeea789f41cbd6ef59d.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*BsbwWwrAd2hSLun-btQqog.png"/></div></figure><p id="8ea5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们看看高次权重是否真的接近于零。打印W变量，我们有</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es mh"><img src="../Images/f36605f0eee0edf7746ad34e113a8678.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*P_w83ZNl9xkYzKdDnpO_Pw.png"/></div></figure><p id="bc03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不出所料。</p><h2 id="69b7" class="jz ka hh bd kg kh ki kj kk kl km kn ko ip kp kq kr it ks kt ku ix kv kw kx ky bi translated"><strong class="ak">模型使用Numpy </strong></h2><p id="3c72" class="pw-post-body-paragraph ie if hh ig b ih kz ij ik il la in io ip lb ir is it lc iv iw ix ld iz ja jb ha bi translated">Numpy太方便了，不能不使用，它有一个计算拟合线的方法。仅使用一行代码(当然是在生成我们的数据之后)，我们就可以为数据创建一条拟合线。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lh"><img src="../Images/70c04292bb362536a135d03b5a4e81a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*CvgdwlvO-b87z7Olqe8H5g.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx">Fit line using numpy</figcaption></figure><p id="c7fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以看出，我们还可以通过将输入数据传递给模型来进行预测。</p><h1 id="2ab4" class="lj ka hh bd kg lk ll lm kk ln lo lp ko lq lr ls kr lt lu lv ku lw lx ly kx lz bi translated">参考</h1><ul class=""><li id="8d40" class="mm mn hh ig b ih kz il la ip mo it mp ix mq jb mr ms mt mu bi translated">埃塞姆·阿尔帕丁山。2010.机器学习导论(第二版。由…编辑).麻省理工学院出版社。</li></ul></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h1 id="8b5f" class="lj ka hh bd kg lk mv lm kk ln mw lp ko lq mx ls kr lt my lv ku lw mz ly kx lz bi translated">附录</h1><p id="e5ad" class="pw-post-body-paragraph ie if hh ig b ih kz ij ik il la in io ip lb ir is it lc iv iw ix ld iz ja jb ha bi translated">让我们把这些方法放入一个类中。我写这个类只是为了这个目的，并不是为了做一个库，所以请注意，这当然不是写这个类的最好方法；因为没有错误处理或优化等。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="c363" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们可以一个接一个地调用我们的方法，看看我们的回归过程在起作用。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lh"><img src="../Images/8cb636f018fbef37bf8e91fea3381248.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*FcbQtfbD9ZUCgxehIwfcAw.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx">Generated data</figcaption></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es lh"><img src="../Images/700a8de85a0f989cec91f0e73e65b8d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*DDuPrYRV644xtDnz8u_7Hw.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx">Validation predictions fits validation data perfectly</figcaption></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es na"><img src="../Images/a168ae64fce1eb7e31cdde886a9bcdd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:204/format:webp/1*Elu7QgeOdxUEed9vFOq-4w.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx">RSE Error</figcaption></figure><p id="5a79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当然，我们也可以重复上一部分，其中我们对数据使用了不同程度的预测。有了我们的新班级，这很容易做到；我们仅在创建随机数据时改变<em class="jr">度</em>参数。</p><figure class="jk jl jm jn fd jo"><div class="bz dy l di"><div class="lf lg l"/></div></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es nb"><img src="../Images/5832935c3ee2dafe2ece3bb04270ef7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*EjIiu2NlhoEE2VAeoZ9d9g.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx">As expected, predictions fit validation data worse</figcaption></figure><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es nc"><img src="../Images/d63d1c58b891780ff652a1aa482fd451.png" data-original-src="https://miro.medium.com/v2/resize:fit:202/format:webp/1*2bx6GZ9u5B-Zi1VPkGPuyQ.png"/></div><figcaption class="mi mj et er es mk ml bd b be z dx">Error also has increased</figcaption></figure><div class="nd ne ez fb nf ng"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="nh ab dw"><div class="ni ab nj cl cj nk"><h2 class="bd hi fi z dy nl ea eb nm ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nn l"><h3 class="bd b fi z dy nl ea eb nm ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="no l"><p class="bd b fp z dy nl ea eb nm ed ef dx translated">medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu jp ng"/></div></div></a></div></div></div>    
</body>
</html>