<html>
<head>
<title>7 Steps to Build a Machine Learning Model with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python构建机器学习模型的7个步骤</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/machine-learning-project-with-linear-regression-algorithm-b433d770fefd?source=collection_archive---------0-----------------------#2022-01-29">https://medium.com/mlearning-ai/machine-learning-project-with-linear-regression-algorithm-b433d770fefd?source=collection_archive---------0-----------------------#2022-01-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><h2 id="6a06" class="hf hg hh bd b fp hi hj hk hl hm hn dx ho translated" aria-label="kicker paragraph">机器学习教程</h2><div class=""/><div class=""><h2 id="aaec" class="pw-subtitle-paragraph in hq hh bd b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je dx translated">使用医疗费用个人数据集构建线性回归模型的指南</h2></div><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/20202b5df7649ed14ba9f7620ed642c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H92bJ1dosKsAVf3D"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">Photo by <a class="ae jv" href="https://unsplash.com/@kobuagency?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">KOBU Agency</a> on <a class="ae jv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a999" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">机器学习是人工智能的一个子集，它为机器提供了根据经验自动学习的能力，而无需显式编程。机器学习是一个伟大的领域。它在许多领域都有应用。要成为机器学习领域的专家，必须做很多项目。</p><p id="beaa" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">在这篇文章中，我将逐步展示如何建立一个机器学习模型。我将讨论以下主题:</p><ol class=""><li id="011a" class="ks kt hh jy b jz ka kc kd kf ku kj kv kn kw kr kx ky kz la bi translated">加载数据集</li><li id="1af3" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">了解数据集</li><li id="9c9a" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">数据预处理</li><li id="0fd2" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">数据可视化</li><li id="c976" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">构建回归模型</li><li id="5569" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">模型评估</li><li id="01ab" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">模型预测法</li></ol><p id="00f6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">在开始之前，请不要忘记订阅<a class="ae jv" href="https://youtube.com/c/tirendazacademy" rel="noopener ugc nofollow" target="_blank">我的youtube频道</a>，在那里我创建了关于人工智能、数据科学、机器学习和深度学习的内容。</p><p id="fa5d" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们开始吧！</p><h1 id="6b44" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">1.加载数据</h1><p id="db84" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated"><a class="ae jv" href="https://www.kaggle.com/mirichoi0218/insurance" rel="noopener ugc nofollow" target="_blank">我将要使用的数据集</a>包括来自病人的费用。我强烈推荐你下载这个数据集，和我一起写你的代码。你可以从<a class="ae jv" href="https://github.com/TirendazAcademy/MACHINE-LEARNING-TUTORIAL/blob/main/29-INTRODUCTION%20MACHINE%20LEARNING.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>获取我的密码。首先，让我们导入数据集。我将使用熊猫加载数据集。我先说进口熊猫。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="55db" class="mi lh hh me b fi mj mk l ml mm">import pandas as pd</span></pre><p id="f33f" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">Pandas是一个优秀的数据加载和数据预处理库。现在，让我用read_csv方法加载数据集。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="52ae" class="mi lh hh me b fi mj mk l ml mm">data = pd.read_csv("insurance.csv")</span></pre><p id="c20d" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">现在，让我们看看数据集的前几行。为此，我将使用head方法。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="fb13" class="mi lh hh me b fi mj mk l ml mm">data.head()</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mn"><img src="../Images/5d3b6e8d78ac8dd05a76b7727566e1a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_oVnB-NR1PQ-b2UZfZSJbQ.png"/></div></div></figure><p id="546a" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">正如你所看到的，有7列，如年龄，性别，体重指数，子女人数，吸烟，地区和收费。</p><h1 id="bf06" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">2.了解数据集</h1><p id="2ccd" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">在建立机器学习模型之前，理解数据非常重要。例如，让我们看看数据集的行数和列数。我将使用shape属性来完成这项工作。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="b9dd" class="mi lh hh me b fi mj mk l ml mm">data.shape</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mo"><img src="../Images/1f392579795834989baf64371850dcce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMmfzSV1OyQ_Ucov1A5IQA.png"/></div></div></figure><p id="b0e6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如您所见，数据集有1338行和7列。现在，我将使用info方法来获取有关数据集的更多信息。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="a481" class="mi lh hh me b fi mj mk l ml mm">data.info()</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mp"><img src="../Images/e34a12e22e93e87ee3e10a49ae349c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*8yaTuH3q54Nkcy2NMCsFUw.png"/></div></figure><p id="c344" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">数据集中没有缺失的数据。还可以使用isnull方法来查看缺失的数据。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="4d85" class="mi lh hh me b fi mj mk l ml mm">data.isnull()</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mq"><img src="../Images/bd413151ab236d8507bebb073be11d19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cmsYoK7QZZ7UT9t_EmaLQQ.png"/></div></div></figure><p id="87f2" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我使用sum方法来查看缺失数据的总和。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="bcfc" class="mi lh hh me b fi mj mk l ml mm">data.isnull().sum()</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mr"><img src="../Images/4c9778a34fec10954cee838c1be00137.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*9pgbCobU-LCNKi5lc_NDbw.png"/></div></figure><p id="3a0c" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如您所见，数据集中没有丢失数据。了解列类型对于构建机器学习模型非常重要。现在，让我们来看看列的类型。为此，我将使用dtypes属性。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="4b7f" class="mi lh hh me b fi mj mk l ml mm">data.dtypes</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ms"><img src="../Images/7093eeeb48a3c2851eca04665adfc6df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1D4uRq8T1qoth9WMtOWESw.png"/></div></div></figure><h1 id="e455" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">3.数据预处理</h1><p id="a1e4" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">让我们将对象类型转换为类别类型。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="33c2" class="mi lh hh me b fi mj mk l ml mm">data['sex'] = data['sex'].astype('category')<br/>data['region'] = data['region'].astype('category')<br/>data['smoker'] = data['smoker'].astype('category')</span></pre><p id="f262" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们再来看看数据类型。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="5770" class="mi lh hh me b fi mj mk l ml mm">data.dtypes</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mt"><img src="../Images/9c291cdbb1743024220cc15c10db3702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*sAeQ7gksK3Z2WMbrtnc3Sg.png"/></div></figure><p id="f468" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">现在，让我们用describe方法来看看数值变量的统计数据。如果我们使用数据集的转置，您可以更好地看到统计数据。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="ebdc" class="mi lh hh me b fi mj mk l ml mm">data.describe().T</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mu"><img src="../Images/94be090814cd6ac860e2110c927baeb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3E7cNEYL2bL6wX4eBqY9Pg.png"/></div></div></figure><p id="ca39" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">现在，让我们看看吸烟者和不吸烟者的平均费用。为此，让我们首先用groupby方法进行分组。我将使用round方法只看到逗号后面的两个数字。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="3e9b" class="mi lh hh me b fi mj mk l ml mm">smoke_data = data.groupby("smoker").mean().round(2)</span></pre><p id="8ac8" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们看看烟雾数据。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="13af" class="mi lh hh me b fi mj mk l ml mm">smoke_data</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es mv"><img src="../Images/e237618eb01a4e07584b94fef10f79b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OkF_WncXXj3lVfJuxwBRTQ.png"/></div></div></figure><p id="e782" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如你所见，吸烟者比不吸烟者付出更多。</p><h1 id="ce4d" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">4.数据可视化</h1><p id="22d5" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">通过数据可视化，您可以更好地理解数据集。现在，让我们用seaborn来看看数字变量之间的关系。首先，让我导入seaborn。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="94b2" class="mi lh hh me b fi mj mk l ml mm">import seaborn as sns</span></pre><p id="effd" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">Seaborn是一个基于matplotlib构建的库，特别用于统计绘图。现在，我们来选择剧情风格。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="c470" class="mi lh hh me b fi mj mk l ml mm">sns.set_style("whitegrid")</span></pre><p id="560a" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">我将使用pairplot方法来查看数值变量之间的关系。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="ca63" class="mi lh hh me b fi mj mk l ml mm">sns.pairplot(<br/>    data[["age", "bmi", "charges", "smoker"]],<br/>    hue = "smoker",<br/>    height = 3,<br/>    palette = "Set1")</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mw"><img src="../Images/ebb5e46ebe00c24d8cb49a46989cf3ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*ZkavuWvJu4k_zYZLCQfFnQ.png"/></div></figure><p id="2645" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">例如，当年龄变量增加时，吸烟者和不吸烟者都支付更多。现在，让我们看看变量之间的相关性。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="04d4" class="mi lh hh me b fi mj mk l ml mm">sns.heatmap(data.corr(), annot= True)</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es mx"><img src="../Images/9e437197d2167c4822a4fba7aec75678.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*FmKdZQd9Vb14O6cswxQXZQ.png"/></div></figure><p id="cb57" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">请注意，电荷和其他变量之间有关系。</p><h2 id="0956" class="mi lh hh bd li my mz na lm nb nc nd lq kf ne nf ls kj ng nh lu kn ni nj lw hn bi translated">一键编码</h2><p id="5293" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">现在，我将对数据集中的分类变量进行一次性编码。这对熊猫来说很容易做到。您可以使用Pandas中的get_dummies方法自动将分类数据转换为一键编码。让我们将分类数据转换成一次性编码。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="8a9c" class="mi lh hh me b fi mj mk l ml mm">data = pd.get_dummies(data)</span></pre><p id="0f82" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">因此，只有分类数据被转换为一次性编码。现在让我们看看数据集的列。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="4fa2" class="mi lh hh me b fi mj mk l ml mm">data.columns</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nk"><img src="../Images/753bc00e3ea01cf3ca5205ae8754adaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1E9QFUY8gGHUZeRPCPaRsw.png"/></div></div></figure><p id="c9be" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如您所见，已经为每个子类别创建了新列。使用熊猫非常容易。谢谢，熊猫们！因此，数据集已准备好构建模型。让我们继续建立一个回归模型。</p><h1 id="4012" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">5.构建回归模型</h1><p id="0f98" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">建立模型时，应该从最简单的模型开始。如果没有得到很好的精度，可以尝试更复杂的模型。我将建立一个线性回归模型，因为输出可变费用是数字类型。</p><p id="cdcb" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">在建立机器学习模型之前，我们需要确定输入和输出变量。输入变量是特征。在统计学中，这些被称为独立变量。输出变量是目标变量。在统计学中，这个变量称为因变量。让我们把目标可变费用赋给变量y。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="7a8f" class="mi lh hh me b fi mj mk l ml mm">y = data["charges"]</span></pre><p id="3ca0" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如果我们去掉目标变量，剩下的就是特征。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="7c2d" class="mi lh hh me b fi mj mk l ml mm">X = data.drop("charges", axis = 1)</span></pre><p id="ef15" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">在建立模型之前，数据集被分为训练和测试两部分。用训练数据建立模型，用测试数据评估模型。您可以使用scikit-learn中的train_test_split方法将数据集拆分为训练和测试。使用这种方法，您可以轻松地拆分数据集。首先，我们来导入这个方法。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="2e36" class="mi lh hh me b fi mj mk l ml mm">from sklearn.model_selection import train_test_split</span></pre><p id="b68b" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们将数据集分成80%的训练和20%的测试。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="a6a4" class="mi lh hh me b fi mj mk l ml mm">X_train,X_test,y_train,y_test=train_test_split(<br/>    X,y, <br/>    train_size = 0.80, <br/>    random_state = 1)</span></pre><p id="cee3" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">现在，让我们建立模型。让我从scikit-learn导入线性回归类。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="c544" class="mi lh hh me b fi mj mk l ml mm">from sklearn.linear_model import LinearRegression</span></pre><p id="f51a" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我创建一个LinearRegression类的实例。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="7e3a" class="mi lh hh me b fi mj mk l ml mm">lr = LinearRegression()</span></pre><p id="4644" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">我将使用训练数据建立模型。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="2dfa" class="mi lh hh me b fi mj mk l ml mm">lr.fit(X_train,y_train)</span></pre><p id="4ba6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">太美了。我们的模型建成了。</p><h1 id="4770" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">6.模型评估</h1><p id="5ec0" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">让我们来看看模型的性能。为此，我将使用决定系数。该值越接近1，模型越好。首先，我们来看看模型在测试数据上的得分。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="a06e" class="mi lh hh me b fi mj mk l ml mm">lr.score(X_test, y_test).round(3)</span><span id="b350" class="mi lh hh me b fi nl mk l ml mm">#Output: <br/>0.762</span></pre><p id="4337" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">测试数据的决定系数大于0.7。我们的模型还不错。当然，如果更接近1就更好了。现在，我们来看看模型在训练数据上的得分。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="737e" class="mi lh hh me b fi mj mk l ml mm">lr.score(X_train, y_train).round(3)</span><span id="104d" class="mi lh hh me b fi nl mk l ml mm">#Output: <br/>0.748</span></pre><p id="e714" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如您所见，模型在训练数据上的性能接近测试数据的性能。如果模型对训练数据的性能很高，则意味着存在过拟合问题。你可能会问怎么解决过拟合问题？要克服过度拟合问题，可以使用正则化。脊或套索模型可用于此。</p><p id="6ce6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">现在，让我们看看另一个指标，均方差，来评估这个模型。为此，我们先用predict方法预测一下测试数据。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="217a" class="mi lh hh me b fi mj mk l ml mm">y_pred = lr.predict(X_test)</span></pre><p id="dedc" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">现在，让我们导入均方误差指标。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="331f" class="mi lh hh me b fi mj mk l ml mm">from sklearn.metrics import mean_squared_error</span></pre><p id="3a82" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">我现在要使用这个指标。首先，让我导入数学模块，因为我要计算这个指标的平方根。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="b6b2" class="mi lh hh me b fi mj mk l ml mm">import math</span></pre><p id="3f27" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">我们来看看均方误差的平方根。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="47be" class="mi lh hh me b fi mj mk l ml mm">math.sqrt(mean_squared_error(y_test, y_pred))</span><span id="5068" class="mi lh hh me b fi nl mk l ml mm">#Output: <br/>5956.45</span></pre><p id="f669" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">该值意味着模型预测的标准偏差为5956.45。</p><h1 id="019a" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">7.模型预测法</h1><p id="81c7" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">现在，我将以预测第一行为例。首先，让我们选择训练数据的第一行。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="adbe" class="mi lh hh me b fi mj mk l ml mm">data_new = X_train[:1]</span></pre><p id="3b91" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我用我们的模型来预测数据。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="9645" class="mi lh hh me b fi mj mk l ml mm">lr.predict(data_new)</span><span id="0b80" class="mi lh hh me b fi nl mk l ml mm">#Output:<br/>10508. 42</span></pre><p id="bdce" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们来看看真正的价值。</p><pre class="jg jh ji jj fd md me mf mg aw mh bi"><span id="4e0f" class="mi lh hh me b fi mj mk l ml mm">y_train[:1]</span><span id="64e1" class="mi lh hh me b fi nl mk l ml mm">#Output:<br/>10355.64</span></pre><p id="17e6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如你所见，我们的模型预测接近真实值。</p><h1 id="193f" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">结束语</h1><p id="648a" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">我展示了一个使用真实数据集的应用程序。如你所见，用Python库建立机器学习模型非常容易。就是这样。我希望你喜欢它。感谢您的阅读。</p><p id="36c7" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">别忘了在YouTube上关注我们</p><div class="nm nn ez fb no np"><a rel="noopener follow" target="_blank" href="/geekculture/8-best-seaborn-visualizations-20143a4b3b2f"><div class="nq ab dw"><div class="nr ab ns cl cj nt"><h2 class="bd hr fi z dy nu ea eb nv ed ef hq bi translated">8个最好的Seaborn可视化</h2><div class="nw l"><h3 class="bd b fi z dy nu ea eb nv ed ef dx translated">使用企鹅数据集与Seaborn一起动手绘制统计图。</h3></div><div class="nx l"><p class="bd b fp z dy nu ea eb nv ed ef dx translated">medium.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od jp np"/></div></div></a></div><div class="nm nn ez fb no np"><a rel="noopener follow" target="_blank" href="/geekculture/6-steps-to-become-a-machine-learning-expert-5a1f155f7207"><div class="nq ab dw"><div class="nr ab ns cl cj nt"><h2 class="bd hr fi z dy nu ea eb nv ed ef hq bi translated">成为机器学习专家的6个步骤</h2><div class="nw l"><h3 class="bd b fi z dy nu ea eb nv ed ef dx translated">成为机器学习专家需要知道的一切。</h3></div><div class="nx l"><p class="bd b fp z dy nu ea eb nv ed ef dx translated">medium.com</p></div></div><div class="ny l"><div class="oe l oa ob oc ny od jp np"/></div></div></a></div><div class="nm nn ez fb no np"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="nq ab dw"><div class="nr ab ns cl cj nt"><h2 class="bd hr fi z dy nu ea eb nv ed ef hq bi translated">Mlearning.ai提交建议</h2><div class="nw l"><h3 class="bd b fi z dy nu ea eb nv ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nx l"><p class="bd b fp z dy nu ea eb nv ed ef dx translated">medium.com</p></div></div><div class="ny l"><div class="of l oa ob oc ny od jp np"/></div></div></a></div><p id="4cc6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如果这篇文章有帮助，请点击拍手👏按钮几下，以示支持👇</p></div></div>    
</body>
</html>