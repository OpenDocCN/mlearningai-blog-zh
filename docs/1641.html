<html>
<head>
<title>How to Construct Portfolio to Track Broad Market with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python构建投资组合追踪广阔市场</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/how-to-construct-portfolio-to-track-broad-market-with-python-8900fcb6541a?source=collection_archive---------2-----------------------#2022-01-15">https://medium.com/mlearning-ai/how-to-construct-portfolio-to-track-broad-market-with-python-8900fcb6541a?source=collection_archive---------2-----------------------#2022-01-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="bea5" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">让我们创建一个指数基金，用整数规划来反映纳斯达克100指数</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/442bc9e27282596fc3cc5a01b040c148.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*agLmbLsTcu7JAO9Ydzdwcw.jpeg"/></div></div></figure><h1 id="c3fb" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak"> <em class="ka">概述</em> </strong></h1><p id="6f60" class="pw-post-body-paragraph kb kc hh kd b ke kf ii kg kh ki il kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">股票资金管理策略主要分为“主动”或“被动”。最常见的被动策略是“指数化”策略，其目标是选择一个反映广泛市场人口或市场指数变动的投资组合。这样的投资组合被称为指数基金。例如，QQQ指数基金跟踪纳斯达克100指数。</p><p id="064f" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">构建一个跟踪特定广泛市场指数的指数基金可以通过简单地购买该指数中的所有n只股票来完成，这些股票具有与该指数相同的权重。然而，这种方法不切实际且昂贵。一只拥有m只股票的指数基金似乎是可取的，其中m远小于目标人群的规模n。</p><p id="7477" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">本博客将向您展示如何通过Gurobi Python API使用整数编程来创建一个尽可能跟踪纳斯达克100指数的指数基金，同时将基金中的成份股数量保持在最低水平。</p><p id="a5a4" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">请注意，本博客仅用于信息和教育目的，并不构成投资或财务建议。</p></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><h1 id="9e0d" class="ji jj hh bd jk jl lk jn jo jp ll jr js in lm io ju iq ln ir jw it lo iu jy jz bi translated">方法</h1><p id="7307" class="pw-post-body-paragraph kb kc hh kd b ke kf ii kg kh ki il kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">这个任务在数学上将被公式化为一个整数优化问题。为了演示我们的方法，我们将使用2019年和2020年纳斯达克100指数成份股的每日价格，计算2019年和2020年成份股和指数的回报，以及股票回报的相关矩阵，然后使用2019年的价格数据获得最优解，并使用2020年的价格数据评估解决方案。</p><p id="575f" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">为了使我们的结果完全可复制，所有相关的源代码和数据集都在我们的<a class="ae lp" href="https://github.com/ping2022/Integer-Programming-for-Portfolio-Construction" rel="noopener ugc nofollow" target="_blank"> github </a>上公开。</p><h1 id="8913" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated">相关矩阵</h1><p id="5cc4" class="pw-post-body-paragraph kb kc hh kd b ke kf ii kg kh ki il kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">我们计算2019年价格文件中股票的回报，使用回报计算股票选择和权重构建的相关矩阵。我们还计算了指数和股票在2020年的每日回报，以评估我们的投资组合在2020年的表现。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="330a" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak"> <em class="ka">模型构建</em> </strong></h1><p id="fdf8" class="pw-post-body-paragraph kb kc hh kd b ke kf ii kg kh ki il kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">该方法包括两个阶段:选股和计算投资组合权重。它旨在选择最能代表其他股票的股票，选择最接近模拟指数整体表现的股票组成，以及最少数量的股票来代表指数。</p><blockquote class="ls lt lu"><p id="06b3" class="kb kc lc kd b ke kx ii kg kh ky il kj lv kz km kn lw la kq kr lx lb ku kv kw ha bi translated"><strong class="kd hi"> <em class="hh">第一阶段:选股</em> </strong></p></blockquote><p id="f95a" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">为了选择最能代表指数中其他股票的股票，我们寻求最大化所选股票和其他股票之间的相关性。阶段1可以表述如下:</p><p id="b13b" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated"><strong class="kd hi"> <em class="lc">决策变量</em> : </strong>二元变量xij，yj</p><p id="526d" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">● xij:对于指数i =1，…，100中的每只股票，二元决策变量xij表示指数j=1，…，100中的哪只股票j是股票I的最佳代表，既然我们有100只成份股，我们就有100*100个xij变量。</p><p id="098d" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">● yj:二元决策变量yj表示基金中存在指数中的哪些股票j。我们会有100个yj变量。</p><p id="357e" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated"><strong class="kd hi"> <em class="lc">目标函数</em> : </strong>最大化xij与其对应相关系数的和积。</p><p id="8e83" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">该模型的目标是最大化基金中n只股票及其代表之间的相似性。</p><p id="9586" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated"><strong class="kd hi"> <em class="lc">约束:</em> </strong></p><p id="ab86" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">1.选择基金中要持有的股票的确切数量</p><p id="c7ea" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">2.每只股票I在指数中正好有一只代表性股票j</p><p id="a8dc" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">3.仅当j在基金中时，保证股票I最好由股票j代表</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lq lr l"/></div></figure><blockquote class="ls lt lu"><p id="39ec" class="kb kc lc kd b ke kx ii kg kh ky il kj lv kz km kn lw la kq kr lx lb ku kv kw ha bi translated"><strong class="kd hi"> <em class="hh">第二阶段:投资组合权重计算</em> </strong></p></blockquote><p id="fe90" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">在这一阶段，我们通过最小化加权股票回报和指数总体回报之间的差异来为所选股票分配最佳权重。为了将这个整数规划转化为绝对值，我们创建了y个变量来方便地求解这个差值最小化问题。我们将线性规划优化公式化如下:</p><p id="56d8" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated"><strong class="kd hi"> <em class="lc">决策变量</em> </strong>:二元变量yi，连续变量wi</p><p id="2254" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">●yi:yi变量象征指数总体回报和加权股票回报之间的差异。因为我们对每只股票和指数都有250个日收益，所以我们有250个易变量。</p><p id="d130" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">● wi:所选股票的权重。我们会有100个wi变量。</p><p id="97bc" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated"><strong class="kd hi"> <em class="lc">目标函数</em> : </strong>最小化易之和</p><p id="7119" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">最小化指数总回报和加权股票回报乘积的绝对值之和。</p><p id="f2a9" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated"><strong class="kd hi"> <em class="lc">约束</em> : </strong></p><p id="f36a" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">1.yi ≥ | index_return —加权股票收益率|，可以翻译为:</p><p id="3c05" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">yi ≥ index_return —加权股票收益率</p><p id="5fed" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">yi ≥加权股票回报—指数回报</p><p id="7566" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">2.wi之和= 1</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="3319" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">样品内/样品外评估</strong></h1><p id="8982" class="pw-post-body-paragraph kb kc hh kd b ke kf ii kg kh ki il kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">在如上建立整数规划模型后，我们将m(投资组合中的股票数量)设置为5、10、20、30、40、50、60、70、80、90和100，通过选择不同数量的股票进行迭代，并使用2019年和2020年的数据评估样本内和样本外的表现。</p><p id="97b9" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">当我们第一次设置m为5时，我们得到样本内误差为78.92%，样本外误差为111.24%。随着我们增加投资组合中包含的股票数量，投资组合的总体回报越来越接近指数总体回报。<strong class="kd hi">样本内误差在4.49%-78.92%之间。样本外误差在36.87%-111.24%之间。</strong></p><h1 id="a364" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated">结果的解释</h1><p id="6c8e" class="pw-post-body-paragraph kb kc hh kd b ke kf ii kg kh ki il kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">我们发现，它与2019年和2020年的数据显示出不同的模式。当使用2020年的数据进行评估时，收益率差在m达到60之前随着波动而下降，当m达到60时表现出显著的增加，然后随着m增加到90而迅速下降到最小值。当使用2019年的数据进行评估时，回报率差异随着小幅波动而下降。<strong class="kd hi">总的来说，这种方法对2019年的数据比对2020年的数据表现更好。</strong></p><p id="28c1" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">我们认为这是因为最优解是使用2019年的数据获得的。在相同的经济环境和财务周期内，指数和投资组合之间的差异随着投资组合规模的增加而减小。而到了2020年，受新冠肺炎和经济变化的影响，股票之间的相关性可能也会发生变化。因此，基于2019年相关性选择的投资组合不能很好地跟踪纳斯达克100指数的走势。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ly"><img src="../Images/ef06a32a3d7d1e4916ccb796e7171384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*oGlzzUhMU2PvcSiPdWvxGA.png"/></div></div></figure><h1 id="697b" class="ji jj hh bd jk jl jm jn jo jp jq jr js in jt io ju iq jv ir jw it jx iu jy jz bi translated"><strong class="ak">结论</strong></h1><p id="3326" class="pw-post-body-paragraph kb kc hh kd b ke kf ii kg kh ki il kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">恭喜你！现在你知道如何应用整数规划技术来建立自己的投资组合。然而，如上所示，尽管所选股票和权重与2019年的数据吻合良好，但应用于2020年的数据时就不那么稳定了。投资决策是对所有内部和外部条件的综合分析，如经济、政治、政府政策、技术、商业战略、客户和供应商以及公司文化等。</p><p id="c99d" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">我希望你喜欢阅读这篇博客，并享受创建你的作品集的乐趣！</p><p id="21fe" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">在<a class="ae lp" href="https://github.com/ping2022/Integer-Programming-for-Portfolio-Construction" rel="noopener ugc nofollow" target="_blank">这个Github repo </a>中，您可以随意使用本文的代码。</p><p id="114f" class="pw-post-body-paragraph kb kc hh kd b ke kx ii kg kh ky il kj kk kz km kn ko la kq kr ks lb ku kv kw ha bi translated">我喜欢写关于数据科学概念的文章，喜欢玩不同的算法和数据科学工具。你可以在LinkedIn上和我联系。</p><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hi fi z dy mh ea eb mi ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq jg mc"/></div></div></a></div></div></div>    
</body>
</html>