<html>
<head>
<title>AI learns to play Flappy Bird Game — fun project— with source code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人工智能学习玩Flappy鸟游戏-有趣的项目-与源代码</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/ai-learns-to-play-flappy-bird-game-fun-project-with-source-code-22250fd4cabf?source=collection_archive---------6-----------------------#2022-01-06">https://medium.com/mlearning-ai/ai-learns-to-play-flappy-bird-game-fun-project-with-source-code-22250fd4cabf?source=collection_archive---------6-----------------------#2022-01-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4b42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，在今天的博客中，我们将实现由人工智能玩的Flappy Bird游戏。我们将通过使用代表<a class="ae jc" href="https://neat-python.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="jd">的<strong class="ig hi">整洁</strong>来实现这一点。</em> </strong>每个机器学习工程师的一大幻想就是做出一个可以自己学习玩的游戏。在今天的博客中，我们将看到我们如何做到这一点。所以不浪费任何时间…</a></p><p id="220b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在这里阅读带源代码的整篇文章—</strong><a class="ae jc" href="https://machinelearningprojects.net/ai-learns-to-play-flappy-bird-game/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/ai-learning-to-play-flappy-bird-game/</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/5de50fc32e853ccf06793fc7d7ff91ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*RLh82-v6YvSXNpnnq7kFCQ.gif"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">AI plays Flappy bird game</figcaption></figure><h1 id="be15" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">让我们开始吧…</h1><p id="e5aa" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">我们将主要需要以下两个库来实现这一点:</p><ul class=""><li id="e919" class="kt ku hh ig b ih ii il im ip kv it kw ix kx jb ky kz la lb bi translated">pygame</li><li id="1a1a" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">整洁的蟒蛇皮</li></ul><h2 id="a2ef" class="lh jr hh bd js li lj lk jw ll lm ln ka ip lo lp ke it lq lr ki ix ls lt km lu bi translated">Flappy Bird游戏的代码…</h2><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="f98f" class="lh jr hh lw b fi ma mb l mc md">import pygame<br/>import neat<br/>import os<br/>import random<br/><br/>pygame.font.init()  # some initialization to use font in pygame<br/><br/>WIN_HEIGHT = 800<br/>WIN_WIDTH = 500<br/>DRAW_LINES = True<br/>GEN = 0  # declaring generation variable<br/><br/>pygame.display.set_caption("Flappy Bird")<br/><br/># importing the images of birds, pipes, background and base<br/>BIRD_IMGS = [pygame.transform.scale2x(pygame.image.load('imgs\\bird1.png')),<br/>             pygame.transform.scale2x(pygame.image.load('imgs\\bird2.png')),<br/>             pygame.transform.scale2x(pygame.image.load('imgs\\bird3.png'))]<br/>BASE_IMG = pygame.transform.scale2x(pygame.image.load('imgs\\base.png'))<br/>BG_IMG = pygame.transform.scale2x(pygame.image.load('imgs\\bg1.png'))<br/>PIPE_IMG = pygame.transform.scale2x(pygame.image.load('imgs\\pipe.png'))<br/><br/># declaring font<br/>STAT_FONT = pygame.font.SysFont('comicsans', 50)<br/><br/><br/># CLASS BIRD<br/>class Bird:<br/>    ROTATION_VEL = 20<br/>    MAX_ROTATION = 25<br/>    ANIMATION_TIME = 5<br/>    IMGS = BIRD_IMGS<br/><br/>    def __init__(self, x, y):  # constructor for class bird<br/>        self.x = x<br/>        self.y = y<br/>        self.height = self.y<br/>        self.frame_count = 0<br/>        self.tilt = 0<br/>        self.vel = 0<br/>        self.img_number = 0  # image in which the bird's wings are upwards<br/>        self.img = self.IMGS[0]  # image in which the bird's wings are upwards<br/><br/>    def jump(self):<br/>        self.vel = -10.5  # negative velocity refers to jump upwards<br/>        self.frame_count = 0  # reset the frames<br/>        self.height = self.y  # reset the height<br/><br/>    def move(self):<br/>        self.frame_count += 1  # update the frames when the bird moves<br/>        # d &gt; 0 means downwards and d&lt;0 means upwards and same for velocity also<br/>        # and also bird is just moving in y direction and not in x direction<br/>        d = self.vel * self.frame_count + 1.5 * self.frame_count ** 2  # frame count also works as time<br/>        if d &gt;= 16: # if the bird is falling and it falls more than 16 pixels then stop falling and face straight moving<br/>            d = 16<br/>        # if d &lt; 0:   # just for tuning so that upward movement is seen clear<br/>        #     d -= 2<br/><br/>        self.y = self.y + d<br/><br/>        if d &lt; 0 or self.y &lt; self.height + 50:  # (d&lt;0) this is the case when when bird is going upward<br/>            if self.tilt &lt; self.MAX_ROTATION:  # so making a tilt angle of max rotation<br/>                self.tilt = self.MAX_ROTATION<br/><br/>        else:<br/>            if self.tilt &gt; -90:  # if the tilt is greater than -90 then keep on reducing it till it reaches -90 to show<br/>                self.tilt -= self.ROTATION_VEL  # the arc like falling<br/><br/>    def draw(self, win):<br/>        self.img_number += 1<br/><br/>        # below work is done to show the flapping of the bird<br/>        # animation time is that for how much time bird should be in one image state<br/>        if self.img_number &lt; self.ANIMATION_TIME:<br/>            self.img = self.IMGS[0]<br/>        elif self.img_number &lt; self.ANIMATION_TIME * 2:<br/>            self.img = self.IMGS[1]<br/>        elif self.img_number &lt; self.ANIMATION_TIME * 3:<br/>            self.img = self.IMGS[2]<br/>        elif self.img_number &lt; self.ANIMATION_TIME * 4:<br/>            self.img = self.IMGS[1]<br/>        elif self.img_number &lt; self.ANIMATION_TIME * 4 + 1:<br/>            self.img = self.IMGS[0]<br/>            self.img_number = 0<br/><br/>        if self.tilt &lt; -80:  # when the bird is nose diving it should not flap its wings<br/>            self.img = self.IMGS[1]<br/>            self.img_number = self.ANIMATION_TIME * 2  # reset the image number so that next image should be IMG[2]<br/><br/>        rotated_image = pygame.transform.rotate(self.img, self.tilt)  # just rotating the image around its center<br/>        new_rect = rotated_image.get_rect(center=self.img.get_rect(topleft=(self.x, self.y)).center)<br/>        win.blit(rotated_image, new_rect)<br/><br/>    def get_mask(self):  # getting the mask of the bird means the contour of bird to check its collision with any pipe<br/>        return pygame.mask.from_surface(self.img)<br/><br/><br/>class Pipe:<br/>    GAP = 200<br/>    VEL = 5<br/><br/>    def __init__(self, x):<br/>        self.x = x<br/>        self.height = 0  # for random purpose<br/>        self.top = 0  # y coordinates of top pipe<br/>        self.bottom = 0  # y coordinates of bottom pipe<br/>        self.TOP_PIPE = pygame.transform.flip(PIPE_IMG, False, True)<br/>        self.BOTTOM_PIPE = PIPE_IMG<br/>        self.passed = False<br/>        self.set_height()<br/><br/>    def set_height(self):  # randomly setting the heights of both pipes<br/>        self.height = random.randrange(50, 450)<br/>        self.bottom = self.height + self.GAP<br/>        self.top = self.height - self.TOP_PIPE.get_height()<br/><br/>    def move(self):<br/>        self.x -= self.VEL<br/><br/>    def draw(self, win):<br/>        win.blit(self.TOP_PIPE, (self.x, self.top))<br/>        win.blit(self.BOTTOM_PIPE, (self.x, self.bottom))<br/><br/>    def collide(self, bird):  # for checking collision of the bird with the pipes<br/>        bird_mask = bird.get_mask()<br/>        top_pipe_mask = pygame.mask.from_surface(self.TOP_PIPE)<br/>        bottom_pipe_mask = pygame.mask.from_surface(self.BOTTOM_PIPE)<br/><br/>        top_offset = (self.x - bird.x, self.top - round(bird.y))<br/>        bottom_offset = (self.x - bird.x, self.bottom - round(bird.y))<br/><br/>        top_overlap = bird_mask.overlap(top_pipe_mask, top_offset)<br/>        bottom_overlap = bird_mask.overlap(bottom_pipe_mask, bottom_offset)<br/><br/>        if top_overlap or bottom_overlap:<br/>            return True<br/>        return False<br/><br/><br/># BASE Class for showing base<br/>class Base:<br/>    VEL = 5<br/>    IMG = BASE_IMG<br/>    WIDTH = BASE_IMG.get_width()<br/><br/>    def __init__(self,<br/>                 y):  # base will be shown moving by taking two images of the same base and putting it one after other<br/>        self.y = y<br/>        self.x1 = 0  # here x1 and x2 are the 2 images where x1 comes first and then x2<br/>        self.x2 = self.WIDTH<br/><br/>    def move(self):<br/>        self.x1 -= self.VEL<br/>        self.x2 -= self.VEL<br/><br/>        if self.x1 &lt; -self.WIDTH:<br/>            self.x1 = self.x2 + self.WIDTH<br/>        if self.x2 &lt; -(self.WIDTH):<br/>            self.x2 = self.x1 + self.WIDTH<br/><br/>    def draw(self, win):<br/>        win.blit(self.IMG, (self.x1, self.y))<br/>        win.blit(self.IMG, (self.x2, self.y))<br/><br/><br/># Our main drawing function<br/>def draw_window(win, birds, pipes, base, score, GEN, pipe_ind):<br/>    global DRAW_LINES<br/>    win.blit(BG_IMG, (0, 0))  # drawing the background<br/>    for pipe in pipes:  # drawing the pipe or pipes as there can be more than one pipes also in one window<br/>        pipe.draw(win)<br/>    base.draw(win)  # drawing the base<br/><br/>    for bird in birds:<br/>        # draw lines from bird to pipe<br/>        if DRAW_LINES:<br/>            try:<br/>                pygame.draw.line(win, (255, 0, 0),<br/>                                 (bird.x + bird.img.get_width() / 2, bird.y + bird.img.get_height() / 2),<br/>                                 (pipes[pipe_ind].x + pipes[pipe_ind].TOP_PIPE.get_width() / 2, pipes[pipe_ind].height),<br/>                                 5)<br/>                pygame.draw.line(win, (255, 0, 0),<br/>                                 (bird.x + bird.img.get_width() / 2, bird.y + bird.img.get_height() / 2), (<br/>                                     pipes[pipe_ind].x + pipes[pipe_ind].BOTTOM_PIPE.get_width() / 2,<br/>                                     pipes[pipe_ind].bottom), 5)<br/>            except:<br/>                pass<br/><br/>        bird.draw(win)<br/><br/>    text = STAT_FONT.render('Score : ' + str(score), 1, (255, 255, 255))  # printing the score on screen<br/>    win.blit(text, (WIN_WIDTH - 10 - text.get_width(), 10))<br/><br/>    text = STAT_FONT.render('Gen : ' + str(GEN), 1, (255, 255, 255))  # printing the generation on screen<br/>    win.blit(text, (10, 10))<br/><br/>    text = STAT_FONT.render('Alive : ' + str(len(birds)), 1, (255, 255, 255))  # printing the alive on screen<br/>    win.blit(text, (10, 50))<br/><br/>    pygame.display.update()<br/><br/><br/>def main(genomes, config):<br/>    global GEN<br/>    GEN += 1<br/>    birds = []<br/>    ge = []<br/>    neural_networks = []<br/><br/>    # everytime new generation comes make new birds and neural networks<br/>    for _, g in genomes:<br/>        net = neat.nn.FeedForwardNetwork.create(g, config)<br/>        neural_networks.append(net)<br/>        birds.append(Bird(230, 350))<br/>        g.fitness = 0<br/>        ge.append(g)<br/><br/>    pipes = [Pipe(500)]  # list of pipe objects<br/>    base_object = Base(630)<br/>    win = pygame.display.set_mode((WIN_WIDTH, WIN_HEIGHT))<br/>    clock = pygame.time.Clock()<br/>    run = True<br/>    score = 0<br/><br/>    # OUR main running loop<br/><br/>    while run:<br/>        clock.tick(30)  # fps<br/>        for event in pygame.event.get():<br/>            if event.type == pygame.QUIT:  # if the user click on the red cross button then quit the game<br/>                run = False<br/>                pygame.quit()<br/>                quit()<br/><br/>        pipe_ind = 0<br/><br/>        # this part is done to check in the case when 2 pipes appear on the screen that which is the pipe we are evaluating on<br/>        if len(birds) &gt; 0:<br/>            if len(pipes) &gt; 1 and birds[0].x &gt; pipes[0].x + pipes[0].TOP_PIPE.get_width():<br/>                pipe_ind = 1<br/><br/>        else:  # if all the birds are dead then exit the loop<br/>            break<br/><br/>        for x, bird in enumerate(birds):  # traversing every bird<br/>            bird.move()<br/>            ge[x].fitness += 0.1  # incrementing little fitness to keep them  moving<br/>            # this is the output list which the nn is giving for all the birds whether to jump or not<br/>            output = neural_networks[x].activate(<br/>                (bird.y, abs(bird.y - pipes[pipe_ind].height), abs(bird.y - pipes[pipe_ind].bottom)))<br/>            if output[0] &gt; 0.5:<br/>                bird.jump()<br/><br/>        for pipe in pipes:<br/>            for x, bird in enumerate(birds):<br/>                # checking if the bird has hit the ground or if the pipe and bird collide or if the bird has touched te top boundary<br/>                if pipe.collide(bird) or (bird.y + bird.img.get_height() &gt;= 630 or bird.y &lt; 0):<br/>                    ge[x].fitness -= 1  # remove all things of that bird from that bird's position<br/>                    birds.pop(x)<br/>                    ge.pop(x)<br/>                    neural_networks.pop(x)<br/><br/>                if not pipe.passed and bird.x &gt; pipe.x:  # if the passed is not set to true and bird has passed the pipe then set it to true<br/>                    pipe.passed = True<br/>                    for g in ge:<br/>                        g.fitness += 5  # adding fitness to birds which passed<br/>                    score += 1<br/>                    pipes.append(Pipe(500))  # add another pipe<br/><br/>            if pipe.x + pipe.TOP_PIPE.get_width() &lt; 0:  # if pipe passed the screen remove it<br/>                pipes.remove(pipe)<br/><br/>            pipe.move()<br/><br/>        base_object.move()<br/>        draw_window(win, birds, pipes, base_object, score, GEN, pipe_ind)<br/><br/><br/>def run(config_path):<br/>    config = neat.config.Config(neat.DefaultGenome, neat.DefaultReproduction,<br/>                                neat.DefaultSpeciesSet, neat.DefaultStagnation, config_path)<br/>    population = neat.Population(config)<br/>    population.add_reporter(neat.StdOutReporter(True))<br/>    stats = neat.StatisticsReporter()<br/>    population.add_reporter(stats)<br/><br/>    winner = population.run(main, 50)<br/>    print('\nBest genome:\n{!s}'.format(winner))<br/><br/><br/>if __name__ == '__main__':<br/>    local_dir = os.path.dirname(__file__)<br/>    config_path = os.path.join(local_dir, 'config-feedforward.txt')<br/>    run(config_path)<br/><br/># This was the code for Flappy Bird Game</span></pre><ul class=""><li id="ef5d" class="kt ku hh ig b ih ii il im ip kv it kw ix kx jb ky kz la lb bi translated">第1–4行—导入Flappy Bird游戏所需的库。</li><li id="cbed" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第8–11行—一些常量。</li><li id="c0d4" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第16–21行—导入鸟、管道、背景和底座的图像。</li><li id="731e" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第28–95行—为Flappy Bird游戏创建鸟类。</li><li id="8d04" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第98–137行—为Flappy Bird游戏创建类管道。</li><li id="96f5" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第141–163行—为Flappy Bird游戏创建类库。</li><li id="860d" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第167–200行——我们的主窗口，我们的游戏将在其中显示。</li><li id="9680" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第203–276行——把所有的碎片放在一起，制作游戏。</li><li id="bf7e" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第279–288行—这个函数将运行整个代码。这个函数还会告诉我们哪一代是最好的。</li><li id="e41a" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">第291–294行——调用上面的run函数并传递配置文件的路径。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es me"><img src="../Images/c21ad1cd1fe807098863867f4716b863.png" data-original-src="https://miro.medium.com/v2/resize:fit:68/format:webp/0*5oCcQFjac_Nih2lB.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">bird in 1st position</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es me"><img src="../Images/f711120695645299bfba5ebeb97bec5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:68/format:webp/0*Ouh3HOxvXLLVFuKq.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">bird in 2nd position</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es me"><img src="../Images/c002b810298041f372d24f51de5b41ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:68/format:webp/0*3tEkFfpytlEE6Co4.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">bird in 3rd position</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mf"><img src="../Images/18635106e7cc1469bc0940af55957a4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:104/format:webp/0*zosifA4Jes2ruuhL.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">pipe</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mg"><img src="../Images/c36bb33aba80dc9e30efd906765bd8ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/0*cgbgKBojh0u5If60.png"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">base</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/5de50fc32e853ccf06793fc7d7ff91ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*RLh82-v6YvSXNpnnq7kFCQ.gif"/></div><figcaption class="jm jn et er es jo jp bd b be z dx">AI plays Flappy bird game</figcaption></figure><p id="c63b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果对Flappy Bird游戏有任何疑问，请通过电子邮件或LinkedIn联系我。你也可以在下面评论任何问题。</p><p id="a422" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jd">探索更多机器学习、深度学习、计算机视觉、NLP、Flask项目访问我的博客— </em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="jd">机器学习项目</em> </strong> </a></p><p id="176f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如需进一步的代码解释和源代码，请访问此处</strong>—<a class="ae jc" href="https://machinelearningprojects.net/ai-learns-to-play-flappy-bird-game/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/ai-learning-to-play-flappy-bird-game/</a></p><p id="8120" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是我写给这个博客的所有内容，感谢你的阅读，我希望你在阅读完这篇文章后，能有所收获，直到下次👋… </p><p id="5b4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jd">阅读我之前的帖子:</em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/fire-and-smoke-detection/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="jd">火灾和烟雾探测使用CNN WITH KERAS </em> </strong> </a></p><div class="mh mi ez fb mj mk"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hi fi z dy mp ea eb mq ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">medium.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my jk mk"/></div></div></a></div></div></div>    
</body>
</html>