<html>
<head>
<title>Aspect Mining Using Zero-Shot Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用零镜头分类的方面挖掘</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/aspect-mining-using-zero-shot-classification-3190e8a89d68?source=collection_archive---------1-----------------------#2022-11-11">https://medium.com/mlearning-ai/aspect-mining-using-zero-shot-classification-3190e8a89d68?source=collection_archive---------1-----------------------#2022-11-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4dc8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">评估零射击学习如何在不使用标记数据的情况下帮助检测评论中的方面</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/a961505d2a52b9de0cb4b924e8a2bc60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UIyx_Te7bz0OBVAd6NZ7Gg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Image Source: <a class="ae js" href="https://www.freepik.com/free-vector/reviews-concept-landing-page_4660575.htm#query=customer%20review&amp;position=13&amp;from_view=search&amp;track=sph" rel="noopener ugc nofollow" target="_blank">Freepik</a></figcaption></figure><p id="3ce9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对任何企业来说，了解客户需求和挑战的主要来源之一是客户评论。虽然简单的情绪分析有助于理解评论是正面还是负面，但它并不能给出评论是关于什么的业务概念。</p><p id="7a46" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于企业来说，解决这个问题的方法之一是手动标记评论，并将它们归类到几个兴趣点。例如，在餐馆设置中，这些类别可以是食物、服务和价格；对于手机来说，这些类别可能是相机质量、电池质量和性价比。这需要一个专门的人来注释数据，并且每次您想要添加新的类别时，都必须重新注释数据并重建模型，这是一项耗时的活动。这对小企业来说是一个挑战。</p><p id="616a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随着Transformer模型的出现，我们能够使用预先训练的模型，并简单地针对我们的任务对它们进行微调，并且在小数据集上也获得了良好的结果。预先训练的模型允许我们利用从许多下游任务(如NER、机器翻译和文本分类)的庞大数据语料库中学习的知识，而不必从头开始构建模型。在零炮分类中使用预训练模型的一个好处是。零镜头分类的主要目标是能够在没有任何标记数据的情况下将文本分类。</p><p id="f19a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将看到零镜头分类如何简化从文本数据中识别方面(兴趣点)的过程。</p><h1 id="3903" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">零炮分类背后的思想</h1><p id="8ed4" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">零镜头分类诞生于一个基于自然语言推理领域的非常简单但非常棒的想法(NLI)。NLI研究一个假设对于一个给定的前提是真的(蕴涵)，假的(矛盾)，还是不确定的(中性)。</p><p id="f2e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在零距离分类中，假设你想将“我爱冰淇淋”这一陈述分为积极类或消极类。那么前提是“我爱冰淇淋”，假设可以是“这是正面的例子”和“这是负面的例子”。现在，任务是预测假设对于给定的前提是否为真。</p><h1 id="971d" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">关于数据</h1><p id="47c7" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">为了理解零镜头分类如何工作来检测方面，让我们考虑已经被标记的餐馆的Yelp数据集。Kaggle数据集可以在这里找到<a class="ae js" href="https://www.kaggle.com/datasets/rafay12/yelp-aspect-based-opinion-mining" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="b15c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该数据集是XML格式的，并且包含关于评论句子所属的类别以及与该类别相关联的情感的信息。它还包含方面术语。对于我们的分析，我们将使用类别信息来验证该模型如何使用零镜头分类来执行。</p><h1 id="a073" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">方法</h1><p id="1696" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">此分析的完整代码可以在<a class="ae js" href="https://www.kaggle.com/code/aiswaryaramachandran/aspect-mining-using-zero-shot-classification" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><div class="kw kx ez fb ky kz"><a href="https://www.kaggle.com/code/aiswaryaramachandran/aspect-mining-using-zero-shot-classification" rel="noopener  ugc nofollow" target="_blank"><div class="la ab dw"><div class="lb ab lc cl cj ld"><h2 class="bd hi fi z dy le ea eb lf ed ef hg bi translated">使用零镜头分类的方面挖掘</h2><div class="lg l"><h3 class="bd b fi z dy le ea eb lf ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用基于Yelp方面的意见挖掘数据</h3></div><div class="lh l"><p class="bd b fp z dy le ea eb lf ed ef dx translated">www.kaggle.com</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jm kz"/></div></div></a></div><p id="1f36" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们读取XML并使用ElementTree解析它以获得方面类别。一个评论文本可以属于多个类别，使其成为一个多标签分类问题。</p><p id="12a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">评论中有5个独特的类别，即氛围、食物、价格、服务、轶事/杂项。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lo"><img src="../Images/e1d72c9cddc42bb0312a3b012e6ddabe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xN2Zutah7xTRNAXEkCfrTA.png"/></div></div></figure><p id="bd3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于这是一个多标签分类问题，我们将为每个类别设置一列，其中1表示文本属于该类别。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lp"><img src="../Images/297760a4b79a067d78f2b36dfceddb3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HwMplv4v6muH8C1l9j6V8A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Sample Data (Image by Author)</figcaption></figure><p id="63fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将使用这5个类别作为零射击分类的标签。我们将为此使用的模型是来自为nli训练的<a class="ae js" href="https://huggingface.co/MoritzLaurer/DeBERTa-v3-base-mnli-fever-anli" rel="noopener ugc nofollow" target="_blank">拥抱脸</a>的“<strong class="ig hi">莫里茨劳勒/德伯塔-v3-base-mnli-fever-anli </strong>”。由于这是一个多标签分类问题，我们将为我们的零镜头分类器设置multi-label=True。</p><p id="8ad5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，零镜头分类的默认假设模板是“这个例子是……”，因为我们使用它来进行方面挖掘，所以我将假设模板设置为“这个评论谈论餐厅的<strong class="ig hi"> {} </strong>方面”，其中{}可以是我们想要将评论分类到的任何类别。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lq lr l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Code for Zero-Shot Classification</figcaption></figure><p id="dbc9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">零炮分类器的输出是JSON格式的，需要进行处理以提取每个类的概率得分。在下面的图像中，我们可以看到，对于句子“但是员工对我们很可怕”，表示“服务”的概率是0.98。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ls"><img src="../Images/2d5ae92904a5739b40996c19bf8f5c25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bc7TKCshNxbxQwFOrxoDjw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Sample output for a text review from Zero shot classifier</figcaption></figure><p id="5244" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下代码提取与标签相关联的分数，并将它们添加到数据框中。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lq lr l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Code to extract scores</figcaption></figure><h1 id="8e89" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">验证模型—使用AUC</h1><p id="b24c" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">因为我们有了基本事实，我们可以计算每个类别的ROC-AUC。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lq lr l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Code for calculating and plotting ROC-AUC Curve for each category</figcaption></figure><p id="e5e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到，除了模型略好于随机猜测(AUC =0.54)的轶事/杂项，模型在检测其他类别或方面(其他类别AUC≥0.89)表现良好。我们看到该模型在AUC=0.99的价格类别中表现非常好。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lt"><img src="../Images/d2a1b98f26fe6f491cfa8f2f2324a48f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Wu9KFSrBH3nFS5NVaU7IQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">ROC-AUC Curve for categories (Image by Author)</figcaption></figure><h1 id="bea9" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">验证模型—使用汉明损失</h1><p id="b6cf" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在多标签分类中，包含实际类别子集的预测应被视为比不包含任何类别的预测更好。这由汉明损失来解决，汉明损失通过在实际和预测标签之间应用XOR，然后在整个数据集上对其求平均来实现。汉明损失衡量被错误预测的标签的比例。这意味着，汉明损失越低，模型性能越好。</p><p id="47a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了应用汉明损失，我们首先设置一个阈值(我认为该阈值为0.9)，对于分数大于该阈值的任何类别，预测值为1。</p><pre class="jd je jf jg fd lu lv lw lx aw ly bi"><span id="4a61" class="lz ju hh lv b fi ma mb l mc md">from sklearn.metrics import hamming_loss</span><span id="060e" class="lz ju hh lv b fi me mb l mc md">Y=np.array(data[zero_shot_classes])<br/>Y_pred=np.array(data[[cat+"_pred" for cat in zero_shot_classes]])<br/>hamming_loss(Y, Y_pred)</span></pre><p id="71e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在计算阈值为0.9的所有5个类别的汉明损失时，我们得到的损失为0.21。</p><p id="fc13" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">掉轶事/杂项类别后的海明损失导致损失0.15。</p><p id="aaa9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到，我们的模型在识别方面表现得非常好。即使从汉明损失，我们可以说，模型表现更好，没有轶事/杂项类别。</p><p id="8865" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我认为轶事/杂项类别失败的一个原因可能是因为它更多的是关于陈述的类型，而不是餐馆的方面。</p><h1 id="c083" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="b84f" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">使用预先训练好的模型是自然语言处理领域的一个变革者。我们已经看到了零镜头分类如何帮助解决一个问题，这个问题在早期需要大量带标签的数据而不使用任何数据注释。有许多关于零镜头分类的拥抱脸模型——除了选择正确的模型，设置正确的假设模板可以帮助改善预测。</p><p id="14a0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">整个分析的代码可以在<a class="ae js" href="https://www.kaggle.com/code/aiswaryaramachandran/aspect-mining-using-zero-shot-classification" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="f162" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mf">希望这篇文章对你有用。一如既往，非常感谢您的任何反馈。请在下面分享你的评论。</em> </strong></p><div class="kw kx ez fb ky kz"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="la ab dw"><div class="lb ab lc cl cj ld"><h2 class="bd hi fi z dy le ea eb lf ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lg l"><h3 class="bd b fi z dy le ea eb lf ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lh l"><p class="bd b fp z dy le ea eb lf ed ef dx translated">medium.com</p></div></div><div class="li l"><div class="mg l lk ll lm li ln jm kz"/></div></div></a></div></div></div>    
</body>
</html>