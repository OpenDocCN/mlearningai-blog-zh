<html>
<head>
<title>Building an AutoML Tool</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建AutoML工具</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/building-an-automl-tool-4a5435be844e?source=collection_archive---------4-----------------------#2021-08-04">https://medium.com/mlearning-ai/building-an-automl-tool-4a5435be844e?source=collection_archive---------4-----------------------#2021-08-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="0c20" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">什么是AutoML工具？</h1><p id="7464" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">这些工具旨在自动化机器学习模型开发的耗时、迭代任务。它允许数据科学家、分析师和开发人员构建具有高规模、高效率和高生产率的ML模型，同时保持模型质量。</p><h1 id="f321" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">为什么我们需要构建自己的AutoML工具？</h1><p id="16fe" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">现有工具有某些缺点:</p><p id="c930" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">1)几乎所有的AutoML工具都是<strong class="je hi">黑盒</strong>。用户根据提供的数据进行预测，但永远无法理解生成的模型或训练和选择最佳模型的过程。用户没有关于模型的信息，因此无法对它们进行微调。</p><p id="86e8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">2)另一套工具<strong class="je hi">需要很高的机器学习专业知识</strong>。这些要求用户选择算法，也选择超参数。超参数的选择是高度劳动密集型的，容易出现人工错误，甚至对计算机科学家来说也是困难的。</p><p id="8b4d" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">您可以构建自己的工具，以最少的努力训练高质量的定制监督机器学习模型，并且可以由任何人使用，不管他们的ML专业知识如何。</p><ul class=""><li id="2962" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">该领域的初学者可以在ML上快速起步，只需点击几下鼠标，就可以生成高效、准确的数据定制模型。</li><li id="3e3b" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">ML专家可以使用他们的数据科学和领域知识，在工具提供的数据可视化的帮助下，手动进行特征选择。生成的代码可以提供给用户，以便他们可以改进模型并对其进行调整，从而改进预测。</li></ul><h1 id="30bf" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">很酷的东西！但是怎么做呢？</h1><p id="8810" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">首先选择实现语言(最好是Python，因为它提供了大量的ML库)。对于数据库，PostgreSQL是首选，因为它是专门为处理大型数据集而设计的领先关系数据库之一。Postgres还支持NoSQL数据，比如XML、JSON和HStore。</p><ul class=""><li id="2215" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">为用户提供上传数据文件和选择目标列的功能。<br/>由于文件会很大，你可以使用亚马逊S3来存储上传的文件，并将其路径存储在你的数据库中。</li><li id="a801" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">为了向用户提供所生成模型的实际工作代码，在进行数据预处理和模型生成的同时，您可以在内存中生成他们的代码，然后保存到<a class="ae kt" href="https://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> <em class="ku"> Jupyter笔记本</em> </a>中。</li><li id="f18c" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">为了决定模型类型(回归或分类)，为目标的唯一值保留一个阈值。</li><li id="8180" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">您还可以提供每个列(输入变量)相对于目标的数据可视化(条形图/饼图/散点图)、数值数据的集中趋势测量、分类数据的计数等，以帮助用户选择<a class="ae kt" href="https://en.wikipedia.org/wiki/Feature_selection#:~:text=In%20machine%20learning%20and%20statistics,for%20use%20in%20model%20construction." rel="noopener ugc nofollow" target="_blank"><em class="ku"/></a><em class="ku">。</em></li><li id="2e9b" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">现在到了有趣的部分，<strong class="je hi">模型生成</strong>:你可以训练、测试和评估多个模型，以确定得分最高的模型，然后将其标记为最终生成的模型。<strong class="je hi">模型生成和超调参数</strong>是该过程中最关键的方面。一些可以帮助你变得更聪明的算法有:</li></ul><blockquote class="kv kw kx"><p id="91d8" class="jc jd ku je b jf ka jh ji jj kb jl jm ky kc jp jq kz kd jt ju la ke jx jy jz ha bi translated">网格搜索:一种优化方法，在超参数空间的指定子集中搜索所有点，以确定最佳解决方案。</p><p id="947b" class="jc jd ku je b jf ka jh ji jj kb jl jm ky kc jp jq kz kd jt ju la ke jx jy jz ha bi translated">随机搜索:这是一种有效的变体，它为超参数的随机组合建立模型，以找到最佳组合。</p><p id="ef7d" class="jc jd ku je b jf ka jh ji jj kb jl jm ky kc jp jq kz kd jt ju la ke jx jy jz ha bi translated">遗传编程:它基于达尔文的进化理论，机器测试简单的算法，最成功的算法在新一代中孕育。</p></blockquote><ul class=""><li id="627c" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">因为模型生成是一个耗时的过程，同时，你可以让用户分析、提炼和摆弄已经生成的模型。</li><li id="5c67" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">一旦完成，你可以将这个<em class="ku">最终模型</em>提供给用户在上面做<strong class="je hi"> <em class="ku">实时预测</em> </strong> <em class="ku"> </em>。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div class="ab fe cl lg"><img src="../Images/de96e462ab4e4fe9c318d1eac4250c03.png" data-original-src="https://miro.medium.com/v2/0*p-n975x6H-Ud0yaB"/></div><figcaption class="lj lk et er es ll lm bd b be z dx">Fig: Data flow diagram of the process</figcaption></figure><h1 id="aaec" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">模型生成的逐步指南</h1><p id="7611" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">对于实际的模型训练，您可以遵循下面提到的步骤，同时将每个步骤的Python代码添加到Jupyter笔记本代码中。</p><ul class=""><li id="caac" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated"><strong class="je hi">第一步:数据预处理</strong>，涉及<a class="ae kt" href="https://en.wikipedia.org/wiki/Feature_scaling" rel="noopener ugc nofollow" target="_blank"> <em class="ku">特征缩放</em> </a>和使用LabelEncoder、MinMaxScaler、One-Hot编码等的变换。</li><li id="14a9" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated"><strong class="je hi">第二步:模型选择和超调参数</strong>数据集可以分为训练和测试数据。根据模型类型(分类或回归)，您可以在训练数据集上训练多个模型，并且可以为测试数据集评估它们的结果度量。<br/>最后，对于分类，在所有被评估的模型中选择具有<strong class="je hi"> <em class="ku">最佳</em> </strong> <em class="ku"> </em> <strong class="je hi"> <em class="ku">精确度</em> </strong>的模型作为最终生成的模型。对于回归，选择所有被评估模型中具有最小<strong class="je hi"><em class="ku"/></strong><em class="ku"/><strong class="je hi"><em class="ku">均方误差</em> </strong>的模型作为最终生成的模型</li></ul><blockquote class="kv kw kx"><p id="6a64" class="jc jd ku je b jf ka jh ji jj kb jl jm ky kc jp jq kz kd jt ju la ke jx jy jz ha bi translated"><strong class="je hi">分类</strong>模型列表:<em class="hh"> KNeighborsClassifier，LogisticRegression，DecisionTreeClassifierEntropy，RandomForestClassifier，MLPClassifier，AdaBoostClassifier，GaussianNB，SGDClassifier，xgboostClassifier </em></p><p id="26ff" class="jc jd ku je b jf ka jh ji jj kb jl jm ky kc jp jq kz kd jt ju la ke jx jy jz ha bi translated"><strong class="je hi">回归</strong>模型列表:<em class="hh"> AdaBoostRegressor、BaggingRegressor、extratereregressor、GradientBoostingRegressor、RandomForestRegressor、GaussianProcessRegressor、HuberRegressor、KNeighborsRegressor、MLPRegressor、DecisionTreeRegressor、extratereregressor</em></p></blockquote><ul class=""><li id="91c0" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated"><strong class="je hi">步骤3: </strong>为所选模型生成完整的代码，并将其附加到Jupyter笔记本中。</li><li id="8037" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated"><strong class="je hi">第四步:将结果保存到数据库</strong>您可以将生成的模型序列化为Pickle文件，并将其上传到S3 bucket。到这个生成的模型的链接和Jupyter笔记本链接可以与模型结果一起保存到数据库中。</li><li id="200c" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated"><strong class="je hi">显示模型结果:</strong>一旦模型生成完成，该工具可以在仪表板中将其标记为已完成，用户可以单击该模型来检查其结果指标。这里可以显示各种指标，如生成的最佳模型的准确度、F1分数、精确度、召回值和混淆矩阵。</li><li id="0870" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated"><strong class="je hi">实时预测:</strong>您可以通过提供实时预测等功能来锦上添花，在这些功能中，用户可以为每个输入变量提供一个测试值，您的工具将根据生成的模型来预测目标值。因此，用户可以验证它自称的准确性。</li><li id="f6e0" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated"><strong class="je hi">提供生成模型的工作代码:</strong>进入最有趣的特性。您可以提供到Jupyter笔记本的链接，该笔记本在仪表板中有<em class="ku">全功能的</em>生成的模型代码，供用户<em class="ku">通过对笔记本上显示的代码进行实验来提炼</em>所做的预测，以改进该工具的预测。</li></ul><h1 id="1936" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">先睹为快一个示例AutoML工具</h1><ul class=""><li id="4c9d" class="kf kg hh je b jf jg jj jk jn ln jr lo jv lp jz kk kl km kn bi translated">仪表板显示用户创建的所有已完成或待完成的ML实验。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/32759799bbed1870a2c0dba0c17b340c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L0Km7o8j5ql5gGur"/></div></div></figure><ul class=""><li id="7381" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">首先，点击<strong class="je hi">“创建模型”</strong>按钮。</li><li id="032e" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">这将带您进入模型详细信息页面，您可以在其中提供数据输入以及模型名称和有意义的描述(以便于以后识别您的模型)。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lv"><img src="../Images/610d1d3e51e93150e626f74f9355997e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JTsOnllAQS3tsp67"/></div></div></figure><ul class=""><li id="cd04" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">点击<strong class="je hi">“上传”</strong>将允许您从笔记本电脑/台式机上传您的csv文件。在这一步，我们将验证文件，并使用警告横幅来指示有效性。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/38961b11bca5d620dc39bc02f825b041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K1Fww-dd-vwtpzwD"/></div></div></figure><ul class=""><li id="1608" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">点击<strong class="je hi">下一步</strong>，开始上传您的数据。我们还在这一步执行数据清理。</li><li id="5eff" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">上传完成后，您可以从数据集中标识的属性列表中选择<strong class="je hi">目标</strong>属性。为了方便用户，还提供了每列中的数据类型。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/6d998612f18e7cd544caae7b3a581da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5JETsG_rHk6bpU_s"/></div></div></figure><ul class=""><li id="f480" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">在下一步中，用户选择目标列预测所依赖的特性。</li><li id="93dd" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">这就是<strong class="je hi">数据可视化</strong>发挥作用的地方。在挑选特征时，该工具提供指示给定列和目标列之间的关联的可视化。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/cbb28b14e0b1263e6ea122630f063044.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VluKY-miEVoGUOR1"/></div></div></figure><ul class=""><li id="023a" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">如果这对于用户来说似乎是一项单调乏味的工作，那么这个工具可以在这里帮上忙。用户只需点击“<strong class="je hi">全选</strong>”，并相信该工具能够找出哪些列是有用的。</li><li id="1a4d" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">单击“<strong class="je hi"> Done </strong>”将使用该工具开始实验，并从一组预定义的方法中学习预测目标列的最佳方法。</li><li id="c8ee" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">一旦模型被创建，用户可以在任何时间点(甚至在他们下次访问时)查看模型。</li><li id="0a3c" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">单击您完成的任何实验，查看模型及其各种指标。</li></ul><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/2fae34308474935f3889dfbe889b6ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4vDWeGrUEyLslk3o"/></div></div></figure><p id="01ed" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">特别感谢<a class="ae kt" href="https://medium.com/u/3f3ab5c97e3d?source=user_profile---------0----------------------------" rel="noopener">马尼什·库马尔</a>的指导。</p></div></div>    
</body>
</html>