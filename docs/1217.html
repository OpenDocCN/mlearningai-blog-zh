<html>
<head>
<title>Sample Size Calculation using the Beta-Binomial Distribution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用β-二项式分布计算样本量</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/sample-size-calculation-using-the-beta-binomial-distribution-7adca91035a9?source=collection_archive---------1-----------------------#2021-10-29">https://medium.com/mlearning-ai/sample-size-calculation-using-the-beta-binomial-distribution-7adca91035a9?source=collection_archive---------1-----------------------#2021-10-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="7bfc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jc translated">下面这篇文章的目的是向你展示我是如何满足一项研究的要求的，在这项研究中，一项干预措施将导致活产小猪增加3%。现在，我在这个项目中遇到的挑战，也是我想与你们分享的，是模拟一群母猪，然后预测出生的小猪数量(活的或静止的)需要一个混合分布。在这种情况下，<a class="ae jl" href="https://en.wikipedia.org/wiki/Beta-binomial_distribution" rel="noopener ugc nofollow" target="_blank">贝塔-二项式</a>。</p><p id="a9a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">贝塔二项分布是由贝塔部分和二项部分组成的。二项式部分是最直接的，因为它用于计算比例和概率。给定一个已知的二项式分布，我们可以从出生的小猪样本中估计出活产婴儿的比例。然而，这种分布在母猪之间是变化的，所以存在差异。为了解释这种差异，我们假设一个贝塔分布。最后，我们将得到一个从贝塔抽样的二项式分布。</p><p id="d809" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们完成这个项目，让我们正确看待以上问题。代码通过SAS提供，但是当然可以通过任何编程语言运行。我不能分享数据集，因为它是商业的。相反，你可以使用下面的<a class="ae jl" href="https://blogs.sas.com/content/iml/2017/11/20/simulate-beta-binomial-sas.html" rel="noopener ugc nofollow" target="_blank">博客文章</a>来模拟贝塔二项分布的数据。正如你所看到的，这是我手头的数据集和项目的一部分。</p><p id="8da1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">需要记住的是，我使用不同的数据集来模拟一个采用新处理方法的新数据集。</p><p id="036b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们开始吧。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">Code to import the data, and run simple distribution graphs.</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es jx"><img src="../Images/72011d02789b638dfa812d6ccfacb212.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KDDERhOIFCGWk_j7ivmI9w.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Per sow we have TG (total born), LG (life birth) and DG (still birth).</figcaption></figure><div class="jm jn jo jp fd ab cb"><figure class="ke jq kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/c572f81edcd28256ca5d88a1f635e1b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*0cRCp75jFVN_xcdpf1C46w.png"/></div></figure><figure class="ke jq kk kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/3e8cd16978a64baf017e5e4e8b7b4cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*q3UAEq-dp2LsZVV18GiA6Q.png"/></div></figure><figure class="ke jq kl kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/d6436295542503acd45d24a8c46ccac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*FpdcWbqpP50JVi37rKGl3w.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx km di kn ko">The distribution of still birth mimics a Poisson distribution whereas both life birth and total born look like they could be modeled using a normal distribution. However, since the values are discrete, a normal distribution can never be appropriate as it will underestimate the standard errors of any estimates provided.</figcaption></figure></div><p id="733b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们看看总出生数、活产数或死产数的比例(这里我用的是平均值)。人们可以看到1/10的小猪仍然出生，不管你如何看待时间上的数据。记住，我们的目标是增加3%的活产婴儿。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/75a45739e4ea511150fb2f151ed2f8ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3CLdOanSEXkSxbjffF-dQw.png"/></div></div></figure><p id="9c3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在去除一些异常值和没有意义的值后，我再看一下这个比例，现在看起来大约是1/11的小猪出生时是静止的。</p><p id="00e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在该数据集中，每次治疗的出生存活比率相差约6%。当然，计算是不合理的，因为我使用的是平均值，而不是实际比例。该数据集中死胎的比例和方差分别为7.5%和0.5%。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es kq"><img src="../Images/5140d842b019caf016f5b914021a30d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*_tex3upySEF6H-Rm85UqWQ.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">Pre-calculations to make some sense of the proportion and variance of each of the important categories necessary for the simulation: born, born alive, and still birth.</figcaption></figure><p id="114c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我知道了出生的、活产的或死产的小猪的平均数，我需要找到一种方法来估计构成β分布的α和β值。SAS有一些内置的公式可以帮助估计。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">Code to use <a class="ae jl" href="https://stats.idre.ucla.edu/sas/output/proc-univariate/" rel="noopener ugc nofollow" target="_blank"><strong class="ak">PROC UNIVARIATE</strong></a><strong class="ak"> </strong>and estimate the fit of a beta distribution for still birth (DG).</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kr"><img src="../Images/a570ee80c893ca01de77ba87993e17fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kn6dqAWqM01sgMqfE8HmkQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Code is quite simple.</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ks"><img src="../Images/a4d32bc9da5f984835939441bc1d4447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHZXFA0lim8hHs34RwCuWg.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">First try did not go as planned. Luckily, SAS also provides us with values that would be more plausible, so lets try it again.</figcaption></figure><div class="jm jn jo jp fd ab cb"><figure class="ke jq kt kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/64b2e6b92166bf8e96ca4135cd764a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*yH8u0uh0fKEY3QpJ20Yqmw.png"/></div></figure><figure class="ke jq ku kg kh ki kj paragraph-image"><img src="../Images/baed4d28fcbacb67eaf93c7cc04d5a4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*Tzadx4_HIqmGBTVB3zPvdQ.png"/><figcaption class="jt ju et er es jv jw bd b be z dx kv di kw ko">Lots of information provided.</figcaption></figure></div><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kx"><img src="../Images/f0defb4c5829fea1d65dc5947b7b0713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o5ysHlJ1w7F8NemDE-zH0Q.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">And a plot of a beta-distribution that does seem to do the trick with alpha and beta at 0.72 and 2.69 respectively. However, I am not completely happy with the curve which ends too soon. This is due to the high number of zero’s in the data I suspect.</figcaption></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">I added a small number to the zero still born group to amplify it and reran the analysis. Now, the tail of the beta distribution is much longer, which is what I want. As a result, the alpha and beta values completely change.</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ky"><img src="../Images/a8f46bd3d966c00b0df47b74a2410202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWK1mlERm9CM6rop8xIOWw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">A curve that is much better as it has a longer tail. Of course, the distribution is not perfect but they never are. They are merely assumptions.</figcaption></figure><p id="0254" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在项目的这一点上，我仍然非常纠结于实际建模的结果。现在，目标是增加3%的活产小猪比例，但这3%实际上是基于平均值。出于某种原因，动物科学中出生的小猪数量是平均的，这很奇怪，因为你不可能有18 1/3只小猪。该值始终是一个整数。此外，出生的小猪数量仍然是一个零和游戏——如果你知道出生的小猪总数和出生时存活的小猪数量，你也知道出生时的小猪数量。因此，除了模拟死产，我还可以选择模拟活产，它有更好的分布。最后，我坚持使用死胎。</p><p id="2bf7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我希望死胎减少3%,我想知道，考虑到母猪死胎比例的自然变化，我需要在两个处理中包括多少头母猪才能发现这3%的差异。</p><p id="2df4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，给定我所拥有的alpha en beta值，它与给定的比例和方差相关，我可以估计出3%增长的alpha和beta值。总之，我所做的是为对照组和干预组创建α和β值，这需要产生3%的差异，同时考虑到我在两组中观察到的变化。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kz"><img src="../Images/5174a07002c019a5987b34197f6cef94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ucfwVoXRV8AxMsFH8b4AMQ.png"/></div></div></figure><p id="06e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，是权力的时候了。您在下面看到的是:</p><ol class=""><li id="5834" class="la lb hh ig b ih ii il im ip lc it ld ix le jb lf lg lh li bi translated">对照组和治疗组的β-二项式分布的α和β值-这将产生每头母猪的SB比例。</li><li id="72e9" class="la lb hh ig b ih lj il lk ip ll it lm ix ln jb lf lg lh li bi translated">模拟每组动物数量的代码</li><li id="af20" class="la lb hh ig b ih lj il lk ip ll it lm ix ln jb lf lg lh li bi translated">模拟的次数</li><li id="5b22" class="la lb hh ig b ih lj il lk ip ll it lm ix ln jb lf lg lh li bi translated">模拟活产小猪数量的泊松分布</li><li id="1112" class="la lb hh ig b ih lj il lk ip ll it lm ix ln jb lf lg lh li bi translated">β-二项式，由出生的小猪比例的β分布组成，作为出生小猪数量的函数。</li></ol><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">The code to simulate a beta-binomial distribution for two treatments with the intent to model the number of still born as a function of total born and sow variation.</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lo"><img src="../Images/345379585c5e0fe0b7aeffbaa61326f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqVnNq2LlYNRTBQAmdoSVQ.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">The dataset obtained — per treatment and per animal we get a number of total born and a number of still born.</figcaption></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">Code to check the simulation and see which model will best mimic the data we simulated to pick up the the 3% difference in still birth we implemented.</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lp"><img src="../Images/8bb8f07c2adb9752340ccd0ddf7f53bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*DFzuS4Z2oFq9QGReLSw0iQ.png"/></div></figure><div class="jm jn jo jp fd ab cb"><figure class="ke jq lq kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/acfdb75f49161ee95eb7bcb6f3f7c71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*n99MTlvhriO6BeCos18CKw.png"/></div></figure><figure class="ke jq lr kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/b06b2f344b012a6cc2a23571f6e2e881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*V3IZ0q6dCskmDA_6nMZNEA.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx ls di lt ko">Mean and Standard Deviation Summarized by Treatment and Number of Animals. As you can see, the difference is always around 3%. Variation does change, as it should, given the nature of the beta-distribution.</figcaption></figure></div><p id="b507" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了寻找估计死产比例差异的最佳模型，我研究了正态分布、准二项分布和负二项分布的可行性。后者表现最好。</p><div class="jm jn jo jp fd ab cb"><figure class="ke jq lu kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/1bb77cb058102ad05b7bd97f531d11f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*dCZHCdvrKuGQ6vPgdDn1kQ.png"/></div></figure><figure class="ke jq lv kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/575fae3e14d97ca61037a80680436b63.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*_Iva093NKWMqzSKK-21TPw.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx lw di lx ko">Results from Negative Binomial and Gaussian Distribution. Quasi-Binomial did not run. As you can see, the difference is 3% between the groups, as envisioned.</figcaption></figure></div><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jr js l"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">Code to run the power calculation.</figcaption></figure><div class="jm jn jo jp fd ab cb"><figure class="ke jq ly kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/697c393a3f443bf76ee01037476a0470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*B4A8djYoCZBnWCyiFSsDlA.png"/></div></figure><figure class="ke jq lz kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><img src="../Images/e14f7cdd80fdda932749b4c5bcdec18c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*eHC4d48zFzmYUnWaiIR_ng.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx ma di mb ko">As you can see, the difference was always around 3%, but the variance decreased as a function of the sample size.</figcaption></figure></div><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mc"><img src="../Images/388f11a6aec8017c89b228625a4a8801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7KUwEwRT75dbKGDwhZkCzw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Number needed per treatment which is quite a lot. This is not surprising given the % increase needed when already working on the boundary of a distribution.</figcaption></figure><p id="b444" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望这个例子显示了通过使用不同的分布将二项分布中的水平2方差包括在内的可能性。和往常一样，<a class="ae jl" rel="noopener" href="/@marc.jacobs012/simulations-in-sas-some-random-stuff-c5bc66303b37">模拟</a>的强度取决于假设。</p><p id="e329" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">享受吧。</p><div class="md me ez fb mf mg"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hi fi z dy ml ea eb mm ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">medium.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu kc mg"/></div></div></a></div></div></div>    
</body>
</html>