<html>
<head>
<title>Vegetable Image Classification using CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于CNN的蔬菜图像分类</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/vegetable-image-classification-using-cnn-6f1d1be75cfb?source=collection_archive---------1-----------------------#2022-01-08">https://medium.com/mlearning-ai/vegetable-image-classification-using-cnn-6f1d1be75cfb?source=collection_archive---------1-----------------------#2022-01-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/e3f0a75ea3764536e91fad5047f5d0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JrS2AbGORGlwsga-l01DbQ.jpeg"/></div></div></figure><ol class=""><li id="0dd9" class="ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg bi translated"><strong class="ir hi">简介</strong></li></ol><p id="e322" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">人脑有专门的视觉、听觉和其他感觉模块。我们想用<strong class="ir hi">人工神经元</strong>来模仿这些专门的模块，并想创造所谓的人工智能。<strong class="ir hi">卷积神经网络</strong>或<strong class="ir hi"> CNN </strong>帮助机器识别<strong class="ir hi">视觉模式、物体、图像等</strong>。</p><p id="43a9" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">CNN源于对大脑视觉皮层的研究，并已被用于各种图像识别任务。在这篇博客中，我们将讨论卷积神经网络，并尝试使用这些CNN解决一个<strong class="ir hi">图像分类任务</strong>。</p></div><div class="ab cl jw jx go jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ha hb hc hd he"><p id="edba" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">2.<strong class="ir hi">对CNN的需求</strong></p><p id="2255" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">在讨论卷积层的概念之前，我想先谈谈为什么我们需要CNN，为什么我们不能使用好的人工神经网络来解决这些图像识别任务。这有<strong class="ir hi"> 2个主要原因</strong>，</p><p id="ff7d" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">a.一个原因是，在人工神经网络中，一层中的每个神经元都与下一层中的每个其他神经元相连。这导致<strong class="ir hi">大量的</strong>模型参数。如果我们的计算能力有限，这可能<strong class="ir hi">很难训练</strong>，而且大参数也可能导致<strong class="ir hi">过拟合</strong>。</p><p id="66ee" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">b.第二个原因是人工神经网络不是不变的。我这么说是什么意思？例如，我的训练集中有一个图像，我在这个训练集中训练ANN模型。现在，在我的验证集中，如果我遇到同一张图像的<strong class="ir hi">旋转/平移/缩放/缩小</strong>版本，我的人工神经网络模型将无法识别它。</p><p id="6071" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">卷积神经网络能够处理人工神经网络或密集神经网络的这两个缺点。让我们在下一节了解CNN。</p></div><div class="ab cl jw jx go jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ha hb hc hd he"><p id="0f60" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">3.<strong class="ir hi">卷积层</strong></p><p id="7777" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">卷积层是CNN最重要的组成部分。卷积层中的神经元<strong class="ir hi">不与下一个卷积层中的所有其他神经元</strong>连接，而是仅与它们<strong class="ir hi">感受域</strong>内的像素连接。</p><blockquote class="kd ke kf"><p id="1427" class="jh ji kg ir b is it jj jk iu iv jl jm kh jn jo jp ki jq jr js kj jt ju jv jc ha bi translated"><strong class="ir hi">局部感受野是一个定义好的分割区域，它被卷积层内的神经元在卷积过程中暴露的输入数据内容所占据。</strong></p></blockquote><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kk"><img src="../Images/78086f8fc0b76e23b963abe25ef101fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P3orNBTAwY1hi_6aXKQABg.jpeg"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">Convolutional Layers with Receptive Fields</figcaption></figure><p id="48e7" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">上图中的小矩形显示了神经元的<strong class="ir hi">局部感受野</strong>。这种架构的另一个优点是，它允许网络关注初始隐藏层中的<strong class="ir hi">小的低级特征</strong>，然后连接到<strong class="ir hi">较大的</strong> <strong class="ir hi">高级特征</strong>。例如，让我们假设我们有一个人体的图像，然后，初始隐藏层将集中在低层次的特征，如线，圆，曲线等。中间的隐藏层将试图识别由低级特征组成的形状。最后，高级特征将识别整个对象，如面部、手臂、腿等。在人体内。这种层次结构可以在真实世界的图像中观察到，如上面的例子所示。因此，细胞神经网络在图像识别任务中表现很好。</p><p id="b350" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">两个矩阵之间的卷积运算可以通过将相应的元素相乘然后将它们相加来计算。在CNN的情况下，在图像和滤波器之间执行卷积操作。过滤器被定义为神经元，表示为感受野大小的小图像。</p><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kt"><img src="../Images/434458dc889c81a38478ac254ae30f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rLnIAZ3_6X9aWYzef59aeg.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">The convolution operation between Image and Filter, <strong class="bd ku">Source</strong>: <a class="ae kv" href="https://bit.ly/3JSnFNT" rel="noopener ugc nofollow" target="_blank">https://bit.ly/3JSnFNT</a></figcaption></figure><p id="380c" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">上图解释了卷积运算。通过隔开滤光器/感受野，可以将较大的输入层与较小的层连接起来。这种间隔可以通过采取更长的<strong class="ir hi">步幅</strong>来实现。</p><p id="dab4" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">理论部分讲得够多了，现在让我们继续讨论卷积神经网络的应用。</p></div><div class="ab cl jw jx go jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ha hb hc hd he"><p id="7979" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">4.<strong class="ir hi">利用CNN进行蔬菜图像分类</strong></p><p id="8d4f" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">这里的问题陈述是，</p><blockquote class="kd ke kf"><p id="a578" class="jh ji kg ir b is it jj jk iu iv jl jm kh jn jo jp ki jq jr js kj jt ju jv jc ha bi translated"><strong class="ir hi">给出15种不同蔬菜的图片。开发一个图像分类模型，正确地检测蔬菜图像并将其分类到相应的标签。</strong></p></blockquote><p id="41ef" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">你可以在这里找到数据集。</p><p id="2b29" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">让我们看看我们的图片和它们的标签。</p><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/2c69cb52c04bedde7ebfe67c0348edfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*buJqZBYB4dVulysxZFnHsQ.png"/></div></div></figure><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kx"><img src="../Images/18ddd541cd7119ecd31c00357ff0b54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*71vin1NdsKnFNRYb3qqpVg.png"/></div></div></figure><p id="bd6b" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">图像和标签看起来都很清晰。建模前的下一步是预处理图像，我已经使用了<a class="ae kv" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank"><strong class="ir hi">keras</strong><strong class="ir hi">imagedata generator</strong></a>。以下代码片段演示了<strong class="ir hi">图像数据生成器</strong>的使用，</p><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ky"><img src="../Images/76ef04c65dca17a3d728d1e79e6da5a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_ri7sP96oPyS2dXIifu8g.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">Keras ImageDataGenerator</figcaption></figure><p id="360c" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">在验证和测试集中，我们在属于<strong class="ir hi"> 15个不同类别</strong>(每个类别<strong class="ir hi"> 1000个</strong>图像)的列车组中有<strong class="ir hi"> 15000个图像</strong>和15个类别<strong class="ir hi"> 3000个图像</strong>(每个类别<strong class="ir hi"> 200个</strong>图像)。接下来，我使用<strong class="ir hi"> Keras API构建了一个定制的CNN模型。</strong></p><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kz"><img src="../Images/3d748d13838814ce228e53838ebcaec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rfPmEwgRifqdJKf3ZWZVng.png"/></div></div></figure><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/d295509e2f3ebebf0f0b4d76d4fa986b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jz2dL_lDfFpYEfKbki47Zw.png"/></div></div></figure><p id="6213" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">上述模型包括以下内容:</p><ol class=""><li id="cf28" class="ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg bi translated">2 <strong class="ir hi">卷积层</strong>分别具有<strong class="ir hi"> 32个大小为<strong class="ir hi"> 3X3 </strong>和<strong class="ir hi"> relu </strong>的滤波器</strong>激活功能和<strong class="ir hi"> 64个大小为<strong class="ir hi"> 3X3 </strong>和<strong class="ir hi"> relu </strong>的滤波器</strong>激活功能。</li><li id="b12b" class="ip iq hh ir b is lb iu lc iw ld iy le ja lf jc jd je jf jg bi translated">2个池大小为2的MaxPoolingLayers 。</li><li id="e515" class="ip iq hh ir b is lb iu lc iw ld iy le ja lf jc jd je jf jg bi translated">1 <strong class="ir hi">展平图层</strong>展平<strong class="ir hi"> 3维</strong>特征体。</li><li id="8b0e" class="ip iq hh ir b is lb iu lc iw ld iy le ja lf jc jd je jf jg bi translated">2 <strong class="ir hi">密集层</strong>(全连接)具有<strong class="ir hi"> 128个神经元</strong>和<strong class="ir hi"> relu </strong>激活功能。</li><li id="df2b" class="ip iq hh ir b is lb iu lc iw ld iy le ja lf jc jd je jf jg bi translated">1 <strong class="ir hi">脱层</strong>，脱层率25%。</li><li id="d6d2" class="ip iq hh ir b is lb iu lc iw ld iy le ja lf jc jd je jf jg bi translated">最终的<strong class="ir hi">输出层</strong>具有<strong class="ir hi"> 15个神经元</strong>和<strong class="ir hi"> softmax </strong>激活函数，输出每个类的概率。</li></ol><p id="51fb" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">你可以在Keras文档中了解所有这些层。该模型用以下超参数编译和训练100个时期。</p><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lg"><img src="../Images/8c3950e72a3eacbbd8f934d7fa8ba135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bkW3HaoPlmsd7D5IKcdEEA.png"/></div></div></figure><p id="e54e" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">在提前停止之前，模型训练14个时期。下图显示了两组的训练和验证损失以及准确性。</p><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lh"><img src="../Images/8cac5ee2a83d95f57feeaadfac38f03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7H_PsCWN5kbAprxWhkuL2w.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx">Model Performance</figcaption></figure><p id="f73b" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">我们能够在测试装置上达到95%的精确度。</p><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es li"><img src="../Images/71d92a0ac29a2097948a882b20556250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wj8U-y1zN4DqkTzreKkG8g.png"/></div></div></figure><p id="9032" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">让我们测试模型的预测。下面的函数从目录和实际标签中获取图像的路径，并显示带有实际标签和预测标签的图像。</p><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/091c3bc48e53cadbe4dd460464bb71e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gwbxaap2s4lxwVFKTHS5A.png"/></div></div></figure><figure class="kl km kn ko fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lk"><img src="../Images/220db5a65b2fea19a74e25df9b5ac13e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7mJSwWLjKqFD-hYWhbqUYA.png"/></div></div></figure><p id="6dda" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">如我们所见，生成的预测是正确的。在我的下一篇博客中，我将在同一个数据集上实现<a class="ae kv" href="https://machinelearningmastery.com/transfer-learning-for-deep-learning/" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">迁移学习</strong> </a> <strong class="ir hi"> </strong>的概念，并比较两个模型的结果。</p></div><div class="ab cl jw jx go jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="ha hb hc hd he"><p id="12e3" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">5.<strong class="ir hi">参考文献</strong></p><ul class=""><li id="2a17" class="ip iq hh ir b is it iu iv iw ix iy iz ja jb jc ll je jf jg bi translated"><a class="ae kv" href="https://keras.io/api/layers/" rel="noopener ugc nofollow" target="_blank">https://keras.io/api/layers/</a></li><li id="7d53" class="ip iq hh ir b is lb iu lc iw ld iy le ja lf jc ll je jf jg bi translated"><a class="ae kv" href="https://blog.xrds.acm.org/2016/06/convolutional-neural-networks-cnns-illustrated-explanation/" rel="noopener ugc nofollow" target="_blank">https://blog . xrds . ACM . org/2016/06/convolutionary-neural-networks-CNN-illustrated-explain/</a></li><li id="7b95" class="ip iq hh ir b is lb iu lc iw ld iy le ja lf jc ll je jf jg bi translated">https://www.kaggle.com/misrakahmed/vegetable-image-dataset<a class="ae kv" href="https://www.kaggle.com/misrakahmed/vegetable-image-dataset" rel="noopener ugc nofollow" target="_blank"/></li><li id="22f7" class="ip iq hh ir b is lb iu lc iw ld iy le ja lf jc ll je jf jg bi translated"><a class="ae kv" href="https://www.kaggle.com/chitwanmanchanda/vegetable-image-classification-using-cnn/edit" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/chitwanmanchanda/vegetable-image-class ification-using-CNN</a></li></ul><p id="ca14" class="pw-post-body-paragraph jh ji hh ir b is it jj jk iu iv jl jm iw jn jo jp iy jq jr js ja jt ju jv jc ha bi translated">我希望你发现这篇文章内容丰富。我一直在<strong class="ir hi">媒体</strong>和<strong class="ir hi"> LinkedIn </strong>上分享<strong class="ir hi">数据科学</strong>内容。可以关注我<a class="ae kv" href="https://www.linkedin.com/in/chitwanmanchanda/" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi"> LinkedIn </strong> </a>。你可以在这里 访问整个代码<a class="ae kv" href="https://www.kaggle.com/chitwanmanchanda/vegetable-image-classification-using-cnn" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">。</strong></a></p><div class="lm ln ez fb lo lp"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lq ab dw"><div class="lr ab ls cl cj lt"><h2 class="bd hi fi z dy lu ea eb lv ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lw l"><h3 class="bd b fi z dy lu ea eb lv ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lx l"><p class="bd b fp z dy lu ea eb lv ed ef dx translated">medium.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md in lp"/></div></div></a></div></div></div>    
</body>
</html>