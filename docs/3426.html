<html>
<head>
<title>Creating Feature Engineering Flow Graphs in Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Keras中创建特征工程流程图</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/creating-feature-engineering-flow-graphs-in-keras-87bb38f0b5cf?source=collection_archive---------5-----------------------#2022-09-02">https://medium.com/mlearning-ai/creating-feature-engineering-flow-graphs-in-keras-87bb38f0b5cf?source=collection_archive---------5-----------------------#2022-09-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d324547e180a0cbd017336237ff3240b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wwnExqe720PPHykHhs5Hqw.png"/></div></div></figure><p id="81c0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这篇博客中，我们将探讨如何在使用Keras层构建我们的特征工程流程图时创建图。在每一步，我们将绘制我们的特征图的状态。最后，我们将有一个信息丰富的图表，显示我们的特征是如何创建的，以及它们是如何相互融合的。我们还将看到特性或步骤的相互依赖性。为了说明的目的，我们将利用Lambda层太容易创建新的功能层。这里的代码类似于<a class="ae jn" rel="noopener" href="/mlearning-ai/feature-engineering-using-keras-lambda-layers-ae0c6d3c904f">这篇博文</a>。对于本文，我们只关注创建信息丰富的特性图。</p><p id="d833" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jo">(点击图表可放大)</em> </strong></p><p id="6d4e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将使用上述文章中使用的相同数据集。</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="f543" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，我们定义一个函数来创建输入层:</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="8abb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了创建我们的特征图，我们需要一个带有输入和输出的Keras模型对象。到目前为止，我们只有输入图层，因此我们的输入和输出都将是要素图层输入:</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jv"><img src="../Images/d67c2b5c6a35a2c2f1210a63d2e58487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hydaKj0sBcxG9dmvSeTjkw.png"/></div></div></figure><h2 id="37df" class="jw jx hh bd jy jz ka kb kc kd ke kf kg ja kh ki kj je kk kl km ji kn ko kp kq bi translated">使用Keras Lambda图层的特征工程</h2><p id="4499" class="pw-post-body-paragraph ip iq hh ir b is kr iu iv iw ks iy iz ja kt jc jd je ku jg jh ji kv jk jl jm ha bi translated">让我们定义特征工程功能:(工程特征仅用于说明目的)</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><h2 id="d3ca" class="jw jx hh bd jy jz ka kb kc kd ke kf kg ja kh ki kj je kk kl km ji kn ko kp kq bi translated">创建自定义特征工程图层</h2><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><h2 id="7a4e" class="jw jx hh bd jy jz ka kb kc kd ke kf kg ja kh ki kj je kk kl km ji kn ko kp kq bi translated">可视化特征工程层</h2><p id="6294" class="pw-post-body-paragraph ip iq hh ir b is kr iu iv iw ks iy iz ja kt jc jd je ku jg jh ji kv jk jl jm ha bi translated">到目前为止，我们有我们的输入层，其中输入馈入不同的Lambda层。下面是我们到目前为止的特征图。请注意，输入图层的某些要素不会馈入任何其他图层。我们将在下一节中添加这一点。我们对网络的输入仍然是我们的特征层输入，但是我们对网络的输出是我们用λ层计算的特征层:</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/50fb5439452d4bc6648d98ed41d0ab71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XUYhSJkC6Hjrg37BbkbFQg.png"/></div></div></figure><h2 id="e755" class="jw jx hh bd jy jz ka kb kc kd ke kf kg ja kh ki kj je kk kl km ji kn ko kp kq bi translated">组合所有要素以创建完整的要素图层:</h2><p id="970c" class="pw-post-body-paragraph ip iq hh ir b is kr iu iv iw ks iy iz ja kt jc jd je ku jg jh ji kv jk jl jm ha bi translated">让我们合并层</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><h2 id="c163" class="jw jx hh bd jy jz ka kb kc kd ke kf kg ja kh ki kj je kk kl km ji kn ko kp kq bi translated">可视化要素图层图表</h2><p id="fcc0" class="pw-post-body-paragraph ip iq hh ir b is kr iu iv iw ks iy iz ja kt jc jd je ku jg jh ji kv jk jl jm ha bi translated">这是我们完整的特征工程流程图。这是查看是否将某些预处理图层(例如批处理规范)应用于正确特征的好方法。最初，我对分类特征进行了批量标准化，这是我在查看特征图时注意到的。在下图中，只有数字是标准化的。并且只有在它们被标准化之后，分类和数字特征才作为我们的完整特征层被加入。</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kx"><img src="../Images/daea316665b4f0213b8bdf35998dfd8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mS-1gXU9KRaIDiKzIOYqYA.png"/></div></div></figure><p id="e37d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了完整起见，我们将训练该模型，以显示一切按预期运行:</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="2632" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">完整的网络图:</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ky"><img src="../Images/581f2aacaf33fc5aa085cada62736727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7ouorun0jy0F7F2Gg1tPw.png"/></div></div></figure><div class="kz la ez fb lb lc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ld ab dw"><div class="le ab lf cl cj lg"><h2 class="bd hi fi z dy lh ea eb li ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lj l"><h3 class="bd b fi z dy lh ea eb li ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lk l"><p class="bd b fp z dy lh ea eb li ed ef dx translated">medium.com</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq in lc"/></div></div></a></div></div></div>    
</body>
</html>