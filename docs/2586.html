<html>
<head>
<title>A Different Introduction to Time Series analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ—¶é—´åºåˆ—åˆ†æçš„ä¸åŒä»‹ç»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/a-different-introduction-to-time-series-analysis-dbe7850b0bea?source=collection_archive---------2-----------------------#2022-05-21">https://medium.com/mlearning-ai/a-different-introduction-to-time-series-analysis-dbe7850b0bea?source=collection_archive---------2-----------------------#2022-05-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="f2a1" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">ç†è§£æ—¶é—´åºåˆ—å’Œé€‰æ‹©æœ€ä½³é¢„æµ‹æ¨¡å‹çš„å…³é”®æ¦‚å¿µ</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/bf361bee8ee608014415a967d66580a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fHDtncFj0mqqel7E"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image from unsplash <a class="ae jm" href="http://twitter.com/tobbes_rd" rel="noopener ugc nofollow" target="_blank">@tobbes_rd</a></figcaption></figure><h1 id="e897" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">ç®€ä»‹-ä»€ä¹ˆæ˜¯æ—¶é—´åºåˆ—ï¼Ÿ</h1><p id="9fa0" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">æ—¶é—´åºåˆ—æ˜¯ä¸€ä¸ªæœ‰åºçš„æµ‹é‡åºåˆ—ï¼Œæ¯ä¸ªæµ‹é‡éƒ½æœ‰ä¸€ä¸ªç›¸å…³çš„æ—¶é—´ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ªKaggle challenge <a class="ae jm" href="https://www.kaggle.com/c/demand-forecasting-kernels-only" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hi">å•†åº—å•†å“éœ€æ±‚é¢„æµ‹</strong> </a>çš„æ•°æ®é›†ã€‚è¯¥æ•°æ®é›†çš„æ—¥å¹³å‡é”€å”®é¢å…·æœ‰ä»¥ä¸‹æ¨¡å¼</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="4f82" class="lg jo hh lc b fi lh li l lj lk">df.set_index('date').plot()<br/>plt.title('Store Item Demand Forecasting')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ll"><img src="../Images/a64e21931975e236fc110cc255ecb011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bm3A4Hyjtn5dQm_dkCzt9g.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Plot of a time serie. The y-axis is always the variable that is measured, while the x-axis are their correspondent times.</figcaption></figure><p id="7fa3" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">å¤„ç†æ—¶é—´åºåˆ—çš„ä¸»è¦ç›®æ ‡ä¹‹ä¸€æ˜¯ä¸ä»…è¦ç†è§£å…¶å†å²è¡Œä¸ºï¼Œè¿˜è¦èƒ½å¤Ÿé¢„æµ‹åºåˆ—çš„æœªæ¥å€¼ã€‚ä¸ºæ­¤ï¼Œæœ‰è®¸å¤šæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå› æ­¤ï¼Œå¯¹äºç»™å®šçš„æ•°æ®é›†ï¼Œä¸å®¹æ˜“çŸ¥é“ä½¿ç”¨å“ªä¸€ä¸ªã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ ¹æ®æ•°æ®çš„æ€§è´¨æ¥ç†è§£è¿™äº›æ¨¡å‹çš„ä¼˜ç¼ºç‚¹ã€‚</p><h1 id="92af" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">1.ç»Ÿè®¡åˆ†æâ€”äº†è§£æ—¶é—´åºåˆ—çš„è¡Œä¸º</h1><p id="5f45" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">æœ‰è®¸å¤šç»Ÿè®¡æ•°æ®å’ŒæŒ‡æ ‡æ¥æè¿°æ—¶é—´åºåˆ—ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å°†æŠŠé‡ç‚¹æ”¾åœ¨é‚£äº›ä¸äº†è§£æˆ‘ä»¬åº”è¯¥ä½¿ç”¨å“ªç§é¢„æµ‹æ¨¡å‹æ¥é¢„æµ‹æœªæ¥æ•°æ®ç›¸å…³çš„é—®é¢˜ä¸Šã€‚</p><h2 id="ed4a" class="lg jo hh bd jp lr ls lt jt lu lv lw jx ko lx ly jz ks lz ma kb kw mb mc kd md bi translated">1.1è¡¨å¾æ—¶é—´åºåˆ—-å¹³ç¨³åˆ†æ</h2><p id="b4f2" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">ä¸€ä¸ªæ—¶é—´åºåˆ—ï¼Œ<em class="me"> Y(t) </em>ï¼Œå¦‚æœå®ƒçš„ç»Ÿè®¡æ€§è´¨ä¸éšæ—¶é—´å˜åŒ–ï¼Œå°±ç§°å®ƒæ˜¯å¹³ç¨³çš„ã€‚è¿™ä¸ªæ¦‚å¿µå¾ˆé‡è¦ï¼Œå› ä¸ºæœªæ¥çš„å€¼ä¼šæœ‰ç›¸åŒçš„è¡Œä¸ºã€‚å‰è€…å¹¶ä¸æ„å‘³ç€æ•°æ®å°†æ˜¯å¯é¢„æµ‹çš„ï¼Œåä¹‹äº¦ç„¶(ä¾‹å¦‚ï¼Œå…·æœ‰è¶‹åŠ¿æˆ–å­£èŠ‚æ€§çš„æ—¶é—´åºåˆ—ä¸æ˜¯ç¨³å®šçš„)ï¼Œä½†åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•ç»™å®šçš„æ—¶é—´ç‚¹ä¼°è®¡å…·æœ‰ä¸€å®šæ–¹å·®çš„æœŸæœ›å€¼ã€‚</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mf"><img src="../Images/1a04830f2da10cf9d37f73a9cb844377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SpLWMmKcFY3BJMMj.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image from the principles of stationarity, Source: <a class="ae jm" href="https://beingdatum.com/time-series-forecasting/" rel="noopener ugc nofollow" target="_blank">BeingDatum</a></figcaption></figure><p id="1b5a" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">å› æ­¤ï¼Œ<strong class="kh hi"> </strong>å•†åº—é¡¹ç›®éœ€æ±‚é¢„æµ‹æ•°æ®é›†Y(t)ä¸æ˜¯å›ºå®šçš„ã€‚å³ä½¿æœ‰æ—¶æ—¶é—´åºåˆ—ä¸æ˜¯å¹³ç¨³çš„ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œä¸€äº›è½¬æ¢å°†å…¶è½¬æ¢ä¸ºå¹³ç¨³çš„ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡ç”¨<strong class="kh hi"> <em class="me"> né˜¶å¾®åˆ†</em> </strong>å»é™¤è¶‹åŠ¿çš„å½±å“ã€‚ç»™å®šä¸€ä¸ªæ•°åˆ—Y(t)ï¼Œné˜¶å¾®åˆ†å®šä¹‰ä¸º</p><blockquote class="mg"><p id="4347" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">Y '(t)= Y(t)â€”Y(t-1)â€”â€”â€”Y(t-n)</p></blockquote><p id="1ae9" class="pw-post-body-paragraph kf kg hh kh b ki mq ii kk kl mr il kn ko ms kq kr ks mt ku kv kw mu ky kz la ha bi translated">åœ¨æˆ‘ä»¬æ•°æ®é›†çš„æœ€åä¸€å¹´è¿›è¡Œä¸€é˜¶å¾®åˆ†ï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹ç»“æœ</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="cd6d" class="lg jo hh lc b fi lh li l lj lk">df.sales=df.sales.diff()<br/>df.plot()<br/>plt.title('Rolling diff Demand')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mv"><img src="../Images/78ad98ac12a4c55946a19dee7f2a4992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwK6Y57szpIUMkRWeC6oHg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: In this image we can see the 1-order differentiation of the original serie from March to December of 2017. As we can see, the mean value is arround 0, while the varienace and range keeps stable from -25 to 7 sales. This means that we can consider this time interval as a stationary time serie.</figcaption></figure><p id="ad7a" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">å°½ç®¡å¦‚æ­¤ï¼Œæœ‰æ—¶ï¼Œæ•°æ®åœ¨né˜¶å¾®åˆ†åä¿æŒä¸ç¨³å®šï¼Œå› ä¸ºå¢é•¿ä¸æ˜¯çº¿æ€§çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬çœ‹åˆ°æ•´ä¸ªæ—¶é—´åºåˆ—Y(t ),è€Œä¸ä»…ä»…æ˜¯å»å¹´ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä¸æ˜¯å¹³ç¨³çš„ã€‚</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mw"><img src="../Images/ed97d267fc47108b5de2734bb30afb77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eYQ5RdQoUSBKf4gx94Gatw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: 1-order differentiation of the whole time serie. We can the that along the entire history, that the variance does not keep stable, but it fluctuates with the past of the time. It means that the time serie is not stationary.</figcaption></figure><p id="a863" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">åœ¨é‚£äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¯•ç€é¢„å…ˆå¯¹Y(t)åšä¸€ä¸ª<strong class="kh hi"> <em class="me">å¯¹æ•°</em> </strong>æˆ–<strong class="kh hi"> <em class="me">æŒ‡æ•°</em> </strong>å˜æ¢ã€‚é€šè¿‡è¿™ç§å˜æ¢ï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ—¶é—´åºåˆ—Y(t)æ˜¯å¹³ç¨³çš„</p><blockquote class="mg"><p id="2536" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">Y'(t) = log(Y(t))</p><p id="7fe3" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">Y'(t) = exp(Y(t))</p></blockquote><pre class="mx my mz na nb lb lc ld le aw lf bi"><span id="cba1" class="lg jo hh lc b fi lh li l lj lk">df.sales=np.log(df.sales).diff()<br/>df.set_index('date').plot()<br/>plt.title('Rolling diff Demand')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/8736199ee07cbe3d677f6defee2c2178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dBVj66WnU_HBW8ax62u_fA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: 1-order differentiation with a logarithmic correction of the values of the time serie. The logarithmic correction is usefull when the time serie follows an exponential growth. Now we are pretty sune that the time serie is stationary.</figcaption></figure><p id="b503" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ•°åˆ—çš„æ–¹å·®å’Œå‡å€¼ä¿æŒä¸å˜ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯å¹³ç¨³çš„ã€‚åœ¨ç‰¹å®šçš„æ—¥å­é‡Œæœ‰ä¸€äº›ç‚¹çš„å€¼åç¦»æ—¶é—´åºåˆ—è¡Œä¸ºï¼Œè¿™ç§å€¼è¢«ç§°ä¸º<strong class="kh hi">æ®‹å·®ã€‚</strong>æ®‹å·®ä¸€èˆ¬æ˜¯ç”±å…·ä½“çš„ä¸´æ—¶åŸå› å¼•èµ·çš„ï¼Œä¸ä¼šæ”¹å˜æ•´ä¸ªæ—¶é—´åºåˆ—çš„æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¿…æ‹…å¿ƒã€‚</p><h2 id="46f4" class="lg jo hh bd jp lr ls lt jt lu lv lw jx ko lx ly jz ks lz ma kb kw mb mc kd md bi translated">1.2è‡ªç›¸å…³å’Œéƒ¨åˆ†è‡ªç›¸å…³(ACF PACF)</h2><p id="25de" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">ä¸ºäº†é¢„æµ‹æœªæ¥å€¼ï¼Œæˆ‘ä»¬ä¸ä»…è¦äº†è§£Y(t)ç»Ÿè®¡ç‰¹æ€§çš„æ—¶é—´æ¼”å˜ï¼Œè¿˜è¦äº†è§£æœªæ¥å€¼ä¸è¿‡å»å€¼çš„ç›¸å…³ç¨‹åº¦ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨ACFå’ŒPACFã€‚</p><p id="ba8e" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated"><strong class="kh hi"> <em class="me"> ACF </em> </strong>æ˜¯æ—¶é—´åºåˆ—Y(t)åœ¨è¯¥åºåˆ—çš„å‰ä¸€æ—¶åˆ»ä¸å…¶è‡ªèº«çš„ç›¸å…³æ€§ã€‚è®¡ç®—ä¸åºåˆ—çš„<em class="me"> k </em>è¿‡å»å€¼çš„ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥<em class="me"> k </em>è¿‡å»å€¼ä¸­çš„å“ªäº›ä¸å½“å‰å€¼ç›¸å…³</p><blockquote class="mg"><p id="5217" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">ACF =ç›¸å…³æ€§(Y(t)ï¼ŒY(t-k))</p></blockquote><pre class="mx my mz na nb lb lc ld le aw lf bi"><span id="b5a0" class="lg jo hh lc b fi lh li l lj lk">from statsmodels.graphics.tsaplots import plot_acf<br/>plot_acf(df.sales)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nd"><img src="../Images/96db91e34d9e7cefd650afd8a32fd617.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6OZHQksGKG4metUCClXJw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Partial autocorrelation. We can see that all of the 33 previous day are correlated with the current value (correlation&gt;0.25). It means that the current value is related with at least, the 33 previous values.</figcaption></figure><p id="8f29" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">ç±»ä¼¼åœ°ï¼Œ<strong class="kh hi"><em class="me"/></strong>æ‰§è¡Œ<em class="me"> Y(t) </em>ä¸è¿‡å»å€¼<em class="me"> Y(t-k) </em>çš„ç›¸å…³è¿ç®—ï¼Œä½†æ˜¯å»é™¤äº†ä¸­é—´å€¼çš„å½±å“:<em class="me"> Y(t-1)ï¼ŒY(t-2)ï¼Œâ€¦ Y(t-k+1): </em></p><blockquote class="mg"><p id="b5cc" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">PACF =ç›¸å…³æ€§(Y(t)ï¼ŒY(t-k) | Y(t-1)ï¼ŒY(t-2)ï¼Œâ€¦ Y(t-k+1))</p></blockquote><pre class="mx my mz na nb lb lc ld le aw lf bi"><span id="79ec" class="lg jo hh lc b fi lh li l lj lk">from statsmodels.graphics.tsaplots import plot_pacf<br/>plot_pacf(df.sales)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ll"><img src="../Images/3a6beeceb6af8a00d6e9e2ee28bf2f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vN1YTvPINNHbVkPn8rJB1w.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Partial Autocorrelation. Hera we can see that the most important days are the last 8 days and peak of correlation each 7 days. It means that the time serie has a recurrence of 7 days.</figcaption></figure><p id="c71e" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">ä¸¤è€…çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼Œ<em class="me"> Y(t-k) </em>çš„ACFä¸ä»…è€ƒè™‘äº†å®ƒå¯¹Y(t)çš„ä¾èµ–æ€§ï¼Œè¿˜é—´æ¥è€ƒè™‘äº†<em class="me"> Y(t) </em>å’Œ<em class="me"> Y(t-k) </em>ä¹‹é—´çš„æ‰€æœ‰ä¸­é—´ç‚¹ã€‚è€Œå¸¦æœ‰<em class="me"> Y(t-k) </em>çš„PACFåªè€ƒè™‘äº†ä¸<em class="me"> Y(t) </em>å’Œ<em class="me"> Y(t-k)çš„å…³ç³»ã€‚</em></p><h2 id="7ebe" class="lg jo hh bd jp lr ls lt jt lu lv lw jx ko lx ly jz ks lz ma kb kw mb mc kd md bi translated">1.3å™ªå£°å’Œæ®‹å·®</h2><p id="338b" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">æœ‰æ—¶æ•°æ®çš„æ–¹å·®å¾ˆå¤§ï¼Œå¾ˆéš¾çœ‹å‡ºä»»ä½•æ¨¡å¼ï¼Œè¿™æ˜¯å¾ˆå¸¸è§çš„ã€‚è¿™ç§æ¨¡å¼å«åš<strong class="kh hi">åµ</strong>é—¹<strong class="kh hi">ç³»åˆ—ã€‚æ²¡æœ‰ç«‹å³è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ã€‚ä¸€ç§å¯èƒ½æ€§æ˜¯åœ¨æ›´é«˜çš„æ•°æ®çº§åˆ«ä¸Šèšé›†æ•°æ®(ä¾‹å¦‚åœ¨å¤©çº§åˆ«ä¸Šè€Œä¸æ˜¯åœ¨å°æ—¶çº§åˆ«ä¸Š)ã€‚å¤„ç†æ•°æ®çš„å¦ä¸€ä¸ªå¸¸è§è§£å†³æ–¹æ¡ˆæ˜¯è®¡ç®—ç³»åˆ—çš„<strong class="kh hi">ç§»åŠ¨</strong> <strong class="kh hi">å¹³å‡å€¼</strong>ã€‚</strong></p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="fc30" class="lg jo hh lc b fi lh li l lj lk">df.rolling(window=7).mean().plot()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ne"><img src="../Images/05b9f4e7ff22442170801df7d0159ee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X0jbhSEtgq_jzo7zabLmBA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Comparison of the original time serie and the window averaged time serie.</figcaption></figure><p id="1b70" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™æ˜¯ä¸éœ€è¦çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨å¤„ç†æ—¥å¸¸æ•°æ®ï¼Œå¹¶å¸Œæœ›é¢„æµ‹æ¯å¤©çš„é”€å”®é¢ã€‚å¦‚æœæˆ‘ä»¬çš„æ•°æ®æ˜¯æ¯å°æ—¶çš„é”€å”®é¢ï¼Œé‚£ä¹ˆå°†å®ƒæ±‡æ€»åˆ°æ¯å¤©çš„æ€»å’Œä¸­ä¼šå¾ˆæœ‰è¶£ã€‚</p><h2 id="815e" class="lg jo hh bd jp lr ls lt jt lu lv lw jx ko lx ly jz ks lz ma kb kw mb mc kd md bi translated">1.4å­£èŠ‚æ€§</h2><p id="4733" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">é€šå¸¸ï¼ŒY(t)çš„å€¼ä¸ä»…ä¸æœ€è¿‘çš„å‰ä¸€ä¸ªå€¼æœ‰å…³ï¼Œè€Œä¸”å¯èƒ½æœ‰å¾ˆé•¿çš„é‡å¤å‘¨æœŸã€‚è¿™ç§è¡Œä¸ºå«åšå­£èŠ‚æ€§ã€‚æ­¤å¤–ï¼Œé€šå¸¸æ•°æ®ä¸åªæœ‰ä¸€ä¸ªå­£èŠ‚æ€§å› ç´ ï¼Œè€Œæ˜¯åŒæ—¶æœ‰è®¸å¤šå­£èŠ‚æ€§å› ç´ (ä¾‹å¦‚å¹´åº¦å­£èŠ‚æ€§ã€æœˆåº¦å­£èŠ‚æ€§ç­‰)ã€‚</p><blockquote class="nf ng nh"><p id="1775" class="kf kg me kh b ki lm ii kk kl ln il kn ni lo kq kr nj lp ku kv nk lq ky kz la ha bi translated">ä¾‹å¦‚ï¼Œé…’åº—å¤å­£çš„é¢„è®¢æ›´å¤šåœ°ä¸å»å¹´å¤å­£çš„é¢„è®¢ç›¸å…³ï¼Œè€Œä¸æ˜¯ä¸Šä¸ªæœˆçš„é¢„è®¢</p></blockquote><p id="ad9c" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">å‡è®¾å­£èŠ‚æ€§æœ‰ä¸€ä¸ªæ’å®šçš„å‘¨æœŸï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨<em class="me">å‚…ç«‹å¶çº§æ•°åˆ†è§£</em> <strong class="kh hi"> <em class="me">æ¥è®¡ç®—å­£èŠ‚æ€§çš„æ¯ä¸ªè´¡çŒ®çš„è¿™äº›å‘¨æœŸã€‚</em> </strong>é¦–å…ˆï¼Œæ–¹ä¾¿çš„æ˜¯<strong class="kh hi"> <em class="me">ä»æ•°æ®ä¸­å»é™¤è¶‹åŠ¿</em> </strong>çš„å½±å“ã€‚å¦‚æœæ•°æ®æœ‰çº¿æ€§è¶‹åŠ¿ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨çº¿æ€§å›å½’æ¥åšã€‚</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="d572" class="lg jo hh lc b fi lh li l lj lk">trend = LinearRegression(<br/>    ).fit(df.index.values.reshape([-1,1]),df.sales<br/>    ).predict(df.index.values.reshape([-1,1]))</span><span id="a577" class="lg jo hh lc b fi nl li l lj lk">df.sales = df.sales-trend</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ne"><img src="../Images/09c5401462ce3fabc9eb7214b3f1bd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OOBVgNvBUQbuAV9x-vg7dQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Removing the trend of the time serie. We use a linear regression because after the log transformation, the trend follows a linear growth.</figcaption></figure><p id="7f09" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">æœ‰äº†Y(t)åºåˆ—ï¼Œæ²¡æœ‰è¶‹åŠ¿ï¼Œæˆ‘ä»¬å¯ä»¥åšå‚…ç«‹å¶åˆ†è§£åˆ†æã€‚é€šè¿‡åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­£èŠ‚æ€§çš„å‘¨æœŸæ€§ã€‚</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="bc9e" class="lg jo hh lc b fi lh li l lj lk">from scipy.fftpack import fft<br/>plt.plot(fft(df.sales.values))</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nm"><img src="../Images/8ec0d2fb993bd27e7b061f04e501ee39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCEEtKV3-FXdpX_XOoh53w.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author</figcaption></figure><h2 id="02f7" class="lg jo hh bd jp lr ls lt jt lu lv lw jx ko lx ly jz ks lz ma kb kw mb mc kd md bi translated">1.5ç»“æœåˆ†æ</h2><p id="2534" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">é€šè¿‡åˆ†ææˆ‘ä»¬çœ‹åˆ°äº†é”€å”®ç³»åˆ—çš„ä»¥ä¸‹ç‰¹æ€§:</p><ul class=""><li id="a1ee" class="nn no hh kh b ki lm kl ln ko np ks nq kw nr la ns nt nu nv bi translated">å¯¹æ•°å¢é•¿ä¸‹çš„å¹³ç¨³è¡Œä¸ºã€‚</li><li id="c5e1" class="nn no hh kh b ki nw kl nx ko ny ks nz kw oa la ns nt nu nv bi translated">å­£èŠ‚æ€§å‘¨æœŸä¸º8.8ä¸ªæœˆã€‚</li><li id="e7e6" class="nn no hh kh b ki nw kl nx ko ny ks nz kw oa la ns nt nu nv bi translated">ä¸Šä¸ªæœˆä¸å½“å‰å€¼é«˜åº¦ç›¸å…³ã€‚</li><li id="0624" class="nn no hh kh b ki nw kl nx ko ny ks nz kw oa la ns nt nu nv bi translated">å¤å‘7å¤©ã€‚</li></ul><h1 id="3886" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">2.é¢„æµ‹æ¨¡å‹â€”é¢„æµ‹æ—¶é—´åºåˆ—çš„æ¼”å˜</h1><p id="22c7" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">ç°åœ¨æˆ‘ä»¬å°†åˆ†æä¸åŒç±»å‹çš„æ¨¡å‹æ¥é¢„æµ‹é”€å”®æ—¶é—´åºåˆ—çš„æœªæ¥ã€‚åœ¨å‰é¢ï¼Œæˆ‘ä»¬å·²ç»åˆ†æäº†é”€å”®æ—¶é—´åºåˆ—çš„å±æ€§ï¼Œæœ‰äº†è¿™äº›å±æ€§ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿé€‰æ‹©æœ€ä½³æ¨¡å‹ã€‚</p><h2 id="7a2c" class="lg jo hh bd jp lr ls lt jt lu lv lw jx ko lx ly jz ks lz ma kb kw mb mc kd md bi translated">2.1è‡ªåŠ¨æ¶¦æ»‘æ¨¡å‹</h2><p id="bc0b" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">è‡ªå›å½’æ¨¡å‹å‡è®¾æœªæ¥å€¼ä¸æ—¶é—´åºåˆ—çš„è¿‡å»å€¼ç›¸å…³ï¼Œå› æ­¤ï¼Œæœªæ¥å€¼çš„æ¨¡å‹ä¸º:</p><blockquote class="mg"><p id="d7fe" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">Y(t)= Y(t-1)* a _ t-1+Y(t-2)* a _ t-2+â€¦Y(t-p)* a _ t-p</p></blockquote><p id="eb09" class="pw-post-body-paragraph kf kg hh kh b ki mq ii kk kl mr il kn ko ms kq kr ks mt ku kv kw mu ky kz la ha bi translated">æœ€è‘—åçš„è‡ªå›å½’æ¨¡å‹ä¹‹ä¸€æ˜¯<strong class="kh hi"> ARIMA </strong>ã€‚è¯¥æ¨¡å‹ä¸ä»…å¯¹åºåˆ—çš„è¿‡å»å€¼è¿›è¡Œ<strong class="kh hi">è‡ªå›å½’</strong>ï¼Œè¿˜é€šè¿‡<strong class="kh hi">ç§»åŠ¨å¹³å‡</strong>è€ƒè™‘äº†è¿‡å»å€¼çš„è¯¯å·®ã€‚</p><blockquote class="mg"><p id="b13c" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">Y(t)= Y(t-1)* a _ t-1+Y(t-2)* a _ t-2+â€¦Y(t-p)* a _ t-p+</p><p id="2025" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">+è¯¯å·®(t-1)*b_t-1 +è¯¯å·®(t-2)*b_t-2 + â€¦ +è¯¯å·®(t-q)*b_t-q</p></blockquote><p id="73b6" class="pw-post-body-paragraph kf kg hh kh b ki mq ii kk kl mr il kn ko ms kq kr ks mt ku kv kw mu ky kz la ha bi translated">å…¶ä¸­è¯¯å·®(t) = Y(t) â€” Y(t-1)ã€‚è¿™ä¸ªæ¨¡å‹éœ€è¦æ—¶é—´åºåˆ—æ˜¯å¹³ç¨³çš„ï¼Œå› æ­¤å®ƒä¼šè‡ªåŠ¨å¯¹åºåˆ—è¿›è¡Œné˜¶<strong class="kh hi">å¾®åˆ†</strong>ä»¥åœ¨éœ€è¦æ—¶å°†åºåˆ—è½¬æ¢ä¸ºå¹³ç¨³(éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒåªåšå¾®åˆ†ï¼Œä¸åšæŒ‡æ•°o logå˜æ¢)ã€‚</p><blockquote class="mg"><p id="2e9b" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">Y(t)= Y(t)â€”Y(t-1)â€”Y(t-2)â€”Y(t-d)</p></blockquote><p id="d5fd" class="pw-post-body-paragraph kf kg hh kh b ki mq ii kk kl mr il kn ko ms kq kr ks mt ku kv kw mu ky kz la ha bi translated">å‰é¢å…¬å¼ä¸­çš„pã€då’Œqå€¼æ˜¯è°ƒæ•´ARIMAæ‰€éœ€çš„å‚æ•°ã€‚på’Œqå¯ä»¥åˆ†åˆ«ä»å…·æœ‰é«˜ç›¸å…³æ€§çš„éƒ¨åˆ†è‡ªç›¸å…³å’Œç›¸å…³çš„æœ€åå€¼ä¸­è·å¾—ã€‚då€¼å°±æ˜¯ä¿æŒæ•°åˆ—ä¸å˜çš„å¾®åˆ†çš„é˜¶ã€‚ç„¶è€Œï¼ŒARIMAä¸èƒ½å¤„ç†å­£èŠ‚æ€§ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå­˜åœ¨ä¸€ä¸ªå«åš<strong class="kh hi"> SARIMA </strong>çš„ç®—æ³•æ‰©å±•ï¼Œå®ƒå¯ä»¥å¤„ç†å­£èŠ‚æ€§</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="55bd" class="lg jo hh lc b fi lh li l lj lk">import statsmodels.api as sm</span><span id="6eb8" class="lg jo hh lc b fi nl li l lj lk">model = sm.tsa.statespace.SARIMAX(df_train.sales,<br/>    trend='t', freq='D', order=(30,1,9)<br/>).fit(disp=False, solver='powell')</span><span id="6f19" class="lg jo hh lc b fi nl li l lj lk">model.predict(365)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ob"><img src="../Images/e000aa3d2e5116c9730ef3f154ab8cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rrZOIAVUQnW6eNqxgeM1uA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Here we can see the predictions of the SARIMA model. We can see that the model perfectly catchs the seasonality, the trend and the variance of the data. This is normal noting that the time serie had a high autocorrelation and partial autocorrelation and the time serie where pretty stationary after the log and 1-order differentiation transformation.</figcaption></figure><h2 id="5a81" class="lg jo hh bd jp lr ls lt jt lu lv lw jx ko lx ly jz ks lz ma kb kw mb mc kd md bi translated">2.2å›å½’æ¨¡å‹</h2><p id="2326" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">æ­£å¦‚æˆ‘ä»¬åœ¨å‰é¢çš„ä¾‹å­ä¸­çœ‹åˆ°çš„ï¼Œå½“ä¸è¿‡å»çš„å€¼æœ‰å¾ˆé«˜çš„ç›¸å…³æ€§å’Œè‡ªç›¸å…³æ€§æ—¶ï¼ŒARIMAæ¨¡å‹åŠå…¶å˜ä½“åœ¨é¢„æµ‹æ—¶é—´åºåˆ—ä¸­çš„æœªæ¥æ–¹é¢éå¸¸å‡ºè‰²ã€‚è¿™åªåœ¨ä¸è¿‡å»å€¼çš„å…³ç³»æ˜¯çº¿æ€§ç›¸å…³æ—¶æœ‰æ•ˆï¼Œå½“å…³ç³»æ˜¯éçº¿æ€§æ—¶æ— æ•ˆã€‚</p><p id="263e" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">å¤„ç†éçº¿æ€§è‡ªå›å½’çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨éçº¿æ€§å›å½’æ¨¡å‹ï¼Œè¯¥æ¨¡å‹èƒ½å¤Ÿå †å ä¸€ä¸ªæ—¶é—´çª—å£çš„å€¼æ¥è¿›è¡Œæœªæ¥é¢„æµ‹ã€‚å…¶ä¸­ä¸€ä¸ªæ¨¡å‹æ˜¯LSTMç½‘ç»œ(ä¸€ç§ç‰¹æ®Šçš„é€’å½’ç¥ç»ç½‘ç»œ)ã€‚æ‚¨å¯ä»¥é€šè¿‡å°†æ—¶é—´åºåˆ—è½¬æ¢ä¸ºå¦‚ä¸‹æ‰€ç¤ºçš„è¡¨æ ¼æ•°æ®é›†æ¥ä¸ºæ•°æ®æ·»åŠ å­£èŠ‚æ•ˆåº”</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="eb05" class="lg jo hh lc b fi lh li l lj lk">weekday_df = pd.get_dummies(<br/>    df.date.dt.dayofweek.to_numpy(), prefix='weekday')</span><span id="004d" class="lg jo hh lc b fi nl li l lj lk">df = pd.merge(weekday_df, df, how='inner', on = 'date')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es oc"><img src="../Images/ec6f36503b3e975b15716c90aa27ca13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uNvhVg02hZF_bn5PxqO2ow.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Reshape of the origial time serie into a tabular structure. We have added the months for each day to let the model learn the seasonality due to each month of the year.</figcaption></figure><p id="3122" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">ä¸ºäº†å°†æœ€è¿‘çš„è¿‡å»å€¼ä½œä¸ºè‡ªå›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å¿…é¡»æ„å»ºä¸€ä¸ªæœ€è¿‘å€¼çš„ç§»åŠ¨çª—å£å †æ ˆã€‚LSTMæ¨¡å‹æ˜¯é€šè¿‡å°†çª—å£å€¼å †å åœ¨ä¸€ä¸ªæ•°ç»„ä¸­æ¥æ„å»ºçš„ï¼Œä½†å…¶ä»–å›å½’æ¨¡å‹(å¦‚RandomForest)çš„æ„å»ºæ–¹å¼æœ‰æ‰€ä¸åŒã€‚</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="a3d6" class="lg jo hh lc b fi lh li l lj lk">x = np.zeros((len(df)-seq_size, seq_size, df.shape[-1]-1))<br/>y = np.zeros((len(df)-seq_size, 1))<br/>    <br/>for i in range(len(df)-seq_size):<br/>    x[i,:,:]=df[i:(i+seq_size),0:-1]<br/>    y[i,:]=df[i+seq_size, -1:]</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es od"><img src="../Images/0e1ffc28bc3d6692daaef7e3bd5c253c.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*l0hn7YRXfOBjINd-h7PZsg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author</figcaption></figure><p id="f23b" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">è¿™ç§æ¨¡å‹çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ä¸éœ€è¦äº‹å…ˆå¯¹æ—¶é—´åºåˆ—è¿›è¡Œæ·±å…¥åˆ†æï¼Œå› ä¸ºå®ƒä»¬èƒ½å¤Ÿè‡ªå·±å¤„ç†éçº¿æ€§å…³ç³»ã€‚</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="4e95" class="lg jo hh lc b fi lh li l lj lk">from keras.models import Sequential<br/>from keras.layers import LSTM, Flatten,Dropout,Dense</span><span id="d5c7" class="lg jo hh lc b fi nl li l lj lk">inputshape = (X_train.shape[1], X_train.shape[2])<br/>model = Sequential()<br/>model.add(LSTM(64, activation='tanh', return_sequences=False))<br/>model.add(Dense(500))<br/>model.add(Dense(1))</span><span id="4fb7" class="lg jo hh lc b fi nl li l lj lk">model.compile(optimizer='adam', loss = 'mse', metrics = ['accuracy'])</span><span id="261b" class="lg jo hh lc b fi nl li l lj lk">model.fit(X_train, y_train, verbose=1, epochs = 10, batch_size = 1,shuffle = False)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es oe"><img src="../Images/abb29ae26fb109ca2c65034c4ab29350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kvW-Z1DdQc_43APqv7kq9A.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Hear we can see the predictions of the LSTM model. we can see that the model capture pretty well the tendency and the variance of the time serie. However, we can see that it fails with the seasonality from half of July to August. This is because we are adding the seasonality to the model with the month number and, as we have seen in the Fourier decomposition, the model follows a strange seasonality of 8.8 which are not entire month. For a more precise result, we should make a finer work of data engineering in the tabular reshape.</figcaption></figure><p id="dd21" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°ä½¿ç”¨è¿‡å»çš„æ•°æ®å€¼æ¥å»ºæ¨¡æ—¶é—´åºåˆ—ï¼Œå› ä¸ºè¿™ä¸ªæ—¶é—´åºåˆ—å¯ä»¥é€šè¿‡è¿‡å»çš„è¡Œä¸ºæ¥è¡¨å¾ã€‚ç„¶è€Œï¼Œæ—¶é—´åºåˆ—çš„æ¼”å˜å–å†³äºå…¶ä»–å€¼ï¼Œç”šè‡³å…¶ä»–æ—¶é—´åºåˆ—ã€‚æ­¤æ¨¡å‹çš„ä¼˜ç‚¹æ˜¯æ‚¨å¯ä»¥åœ¨æ¨¡å‹ä¸­åŒ…å«å…¶ä»–å€¼æ¥é¢„æµ‹æ—¶é—´åºåˆ—çš„æœªæ¥è¡Œä¸ºã€‚</p><h2 id="a4dd" class="lg jo hh bd jp lr ls lt jt lu lv lw jx ko lx ly jz ks lz ma kb kw mb mc kd md bi translated">2.3å‚…ç«‹å¶çº§æ•°æ¨¡å‹</h2><p id="7ac9" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">è‡ªå›å½’æ¨¡å‹æ“…é•¿é¢„æµ‹æœªæ¥å€¼ä¸å‰ä¸€ä¸ªå€¼(ç§»åŠ¨å¹³å‡å€¼)å…·æœ‰ä¸€å®šå‘¨æœŸæ€§çš„æ—¶é—´åºåˆ—ï¼Œå¦‚å‰ä¸€ä¸ªç¤ºä¾‹æ‰€ç¤ºã€‚ç„¶è€Œï¼Œè¿™äº›æ¨¡å‹æ— æ³•é¢„æµ‹æ²¡æœ‰ç§»åŠ¨å¹³å‡è´¡çŒ®å¹¶ä¸”åŒæ—¶å…·æœ‰å¤šä¸ªå­£èŠ‚æ€§(æ¯æ—¥ã€æ¯æœˆã€æ¯ä¸‰ä¸ªæœˆã€æ¯å‘¨â€¦â€¦)çš„æ—¶é—´åºåˆ—ã€‚</p><p id="3d74" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">ç›®å‰æ—¶é—´ç³»åˆ—æœ€å—æ¬¢è¿çš„æ¨¡å‹ä¹‹ä¸€æ˜¯<strong class="kh hi"> Prophet </strong>ã€‚è¯¥æ¨¡å‹çš„ä¸»è¦ä¼˜ç‚¹æ˜¯èƒ½å¤ŸåŒæ—¶æ£€æµ‹å’Œæ‹Ÿåˆ<strong class="kh hi">å¤šä¸ªå­£èŠ‚æ€§</strong>ã€‚åŒæ—¶ï¼Œè¿˜èƒ½å¤ŸåŒæ—¶è°ƒæ•´<strong class="kh hi">ä¸»è¶‹åŠ¿</strong>åŠå…¶æ–­ç‚¹(æŒ‡æ•°å’Œçº¿æ€§è¶‹åŠ¿)ã€‚</p><p id="7336" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">å¯¹äºæˆ‘ä»¬å½“å‰çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é»˜è®¤çš„å­£èŠ‚æ€§(æ¯å¹´å’Œæ¯å‘¨)ï¼Œæˆ‘ä»¬è¿˜å°†æ·»åŠ <strong class="kh hi">æˆ‘ä»¬åœ¨å‚…ç«‹å¶åˆ†æä¸­çœ‹åˆ°çš„8.8ä¸ªæœˆçš„å­£èŠ‚æ€§è¡Œä¸º</strong>ã€‚</p><pre class="ix iy iz ja fd lb lc ld le aw lf bi"><span id="f43b" class="lg jo hh lc b fi lh li l lj lk">from prophet import Prophet</span><span id="d7b8" class="lg jo hh lc b fi nl li l lj lk">model = Prophet(<br/>    seasonality_mode='multiplicative',<br/>    ).add_seasonality(name='monthly', period=260, fourier_order=5<br/>                     ).fit(df_train)</span><span id="9754" class="lg jo hh lc b fi nl li l lj lk">forecast = model.predict(model.make_future_dataframe(periods=365))</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es of"><img src="../Images/97f689b0902e0d772668920fd10e2ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GjTfN3pXcVoeIgjgtwH6zw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Here we can see the predictions of the model Prophet.We can see that it captures very well the seasonality and the trend, but it fails a little with the variance. It may be because the seasonality component in this time serie is abrupt. We could model it better by adding this information to the model through breakpoints.</figcaption></figure><p id="c562" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">æ­£å¦‚æˆ‘ä»¬åœ¨ä»£ç ä¸­çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬å°†å­£èŠ‚æ€§è®¾ç½®ä¸ºâ€œä¹˜æ³•â€ã€‚åœ¨è‡ªå›å½’æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å­£èŠ‚æ€§å¯¹æ—¶é—´åºåˆ—çš„å½±å“</p><blockquote class="mg"><p id="44b6" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">Y(t)= Y _è¶‹åŠ¿(t)+Y _å­£èŠ‚(t)</p></blockquote><p id="2a1b" class="pw-post-body-paragraph kf kg hh kh b ki mq ii kk kl mr il kn ko ms kq kr ks mt ku kv kw mu ky kz la ha bi translated">ç„¶è€Œï¼Œæœ‰æ—¶å­£èŠ‚æ€§çš„å½±å“é€šè¿‡ä¸€ä¸ªå› ç´ è€Œä¸æ˜¯ä¸€ä¸ªåŠ æ³•æ¥æ”¹å˜è¶‹åŠ¿ã€‚å…ˆçŸ¥èƒ½å¤Ÿé€‚åº”è¿™ä¸¤ç§è¡Œä¸º</p><blockquote class="mg"><p id="ff2d" class="mh mi hh bd mj mk ml mm mn mo mp la dx translated">Y(t)= Y _è¶‹åŠ¿(t)* Y _å­£èŠ‚(t)</p></blockquote><p id="9a24" class="pw-post-body-paragraph kf kg hh kh b ki mq ii kk kl mr il kn ko ms kq kr ks mt ku kv kw mu ky kz la ha bi translated">ä½¿ç”¨Prophetï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°åºåˆ—çš„ç»„ä»¶åˆ†è§£ï¼Œå°±åƒæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ—¶é—´åºåˆ—çš„ä¸åŒç»„ä»¶ä¸€æ ·</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es og"><img src="../Images/13e7497cefb5fc11028d7ee24a09f412.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*dcxaOO_eS6RZ8X6qtnEW0g.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Components of the prediction from Prophet</figcaption></figure><h1 id="18c7" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">3.ç»“è®º</h1><p id="46d6" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è§£é‡Šäº†ä¸€äº›ç»Ÿè®¡å·¥å…·æ¥åˆ†æå’Œç†è§£æ—¶é—´åºåˆ—çš„è¡Œä¸ºã€‚ç†è§£è¿™ç§è¡Œä¸ºä¸ä»…å¯¹äºè§£é‡Šè¿‡å»çš„å€¼å¾ˆé‡è¦ï¼Œè€Œä¸”å¯¹äºäº†è§£å¦‚ä½•å»ºç«‹é¢„æµ‹æ¨¡å‹æ¥é¢„æµ‹æ—¶é—´åºåˆ—çš„æœªæ¥å€¼ä¹Ÿå¾ˆé‡è¦ã€‚</p><p id="1eb9" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">åœ¨æ‰€æœ‰çš„é¢„æµ‹æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®å®ƒä»¬çš„è¡Œä¸ºå®šä¹‰äº†3ç§ä¸åŒçš„æ¨¡å‹ã€‚æ²¡æœ‰æœ€ä½³æ¨¡å‹ï¼Œä½†æ ¹æ®æ—¶é—´åºåˆ—çš„æ€§è´¨ï¼Œæˆ‘ä»¬åº”è¯¥é€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„è¡¨æ ¼ï¼Œä»¥äº†è§£æ¯ä¸ªå…ˆå‰æ¨¡å‹çš„åŠŸèƒ½</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es oh"><img src="../Images/9c0fcda56a6545b60888a8b0628268d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYFSkNDFJS8uigMgnuIEAw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by the author: Cheat sheet of the strengths and weakness of each of the models.</figcaption></figure><p id="ad91" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">å¸Œæœ›ä½ å–œæ¬¢:)</p><div class="oi oj ez fb ok ol"><a href="https://mlearning.substack.com" rel="noopener  ugc nofollow" target="_blank"><div class="om ab dw"><div class="on ab oo cl cj op"><h2 class="bd hi fi z dy oq ea eb or ed ef hg bi translated">MLearning.aiè‰ºæœ¯</h2><div class="os l"><h3 class="bd b fi z dy oq ea eb or ed ef dx translated">åˆ›æ„ç»æµçš„äººå·¥æ™ºèƒ½è‰ºæœ¯è§£å†³æ–¹æ¡ˆğŸŸ æœ€å…ˆè¿›çš„æœºå™¨å­¦ä¹ æ¼”ç¤ºï¼Œå¿«é€Ÿæ˜“ç”¨ğŸ”µâ€¦</h3></div><div class="ot l"><p class="bd b fp z dy oq ea eb or ed ef dx translated">mlearning.substack.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz jg ol"/></div></div></a></div></div></div>    
</body>
</html>