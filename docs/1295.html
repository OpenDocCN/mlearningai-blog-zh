<html>
<head>
<title>Hyperparameter Tuning the Weighted Average Ensemble in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中加权平均系综的超参数调整</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/hyperparameter-tuning-the-weighted-average-ensemble-in-python-cff2100f0832?source=collection_archive---------0-----------------------#2021-11-15">https://medium.com/mlearning-ai/hyperparameter-tuning-the-weighted-average-ensemble-in-python-cff2100f0832?source=collection_archive---------0-----------------------#2021-11-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c6175e6fd520b02e896e3df02927fe24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCd8wWo67K2y4OhvE3k01g.png"/></div></div></figure><h1 id="cc42" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">介绍</h1><p id="a205" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在之前的博客“<strong class="jp hi"> <em class="kl">简单加权平均集成|机器学习</em> </strong>”中，我谈到了如何从多个分类器中实现加权平均集成，以捕捉数据的不同信息，从而提高模型性能。在这篇博客中，我将进一步演示如何在python中对系综进行超参数调优。</p><h1 id="e872" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">数据和模型</h1><p id="ef41" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">数据，你可以在这里找到:【https://www.kaggle.com/c/homesite-quote-conversion/data T4】</p><p id="41ff" class="pw-post-body-paragraph jn jo hh jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated">实现集成的代码，你可以在这里找到:<a class="ae km" rel="noopener" href="/analytics-vidhya/simple-weighted-average-ensemble-machine-learning-777824852426">https://medium . com/analytics-vid hya/simple-weighted-average-ensemble-machine-learning-777824852426</a></p><p id="8b5f" class="pw-post-body-paragraph jn jo hh jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated">我们将使用sklearn库中的<strong class="jp hi"><em class="kl">voting classifier</em></strong>来进行超参数调优。你可以在这里找到一切:<a class="ae km" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.VotingClassifier.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . ensemble . voting classifier . html</a></p><h1 id="e3bc" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">密码</h1><h2 id="ee04" class="ks iq hh bd ir kt ku kv iv kw kx ky iz jy kz la jd kc lb lc jh kg ld le jl lf bi translated">第一步</h2><p id="6935" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">首先，让我们从sklearn加载VotingClassifier，然后我们用预训练的分类器拟合模型:决策树、K-最近邻、多层感知器、随机森林和XGBoost。我们忽略参数“权重”来获得基本分数。</p><figure class="lg lh li lj fd ii"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">Step 1</figcaption></figure><p id="9985" class="pw-post-body-paragraph jn jo hh jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated"><em class="kl">平均基础交叉验证得分为</em> 0.9048 (+- 0.0487)</p><h2 id="8bdf" class="ks iq hh bd ir kt ku kv iv kw kx ky iz jy kz la jd kc lb lc jh kg ld le jl lf bi translated">第二步</h2><p id="bea6" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">让我们使用GridSearchCV来寻找最佳参数和最佳分数。根据sklearn文档:如果投票设置为“硬”，将使用多数投票规则。如果我们将投票设置为“软”，将使用预测概率之和的argmax，并且建议将该方法用于良好校准的分类器的集成。</p><figure class="lg lh li lj fd ii"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">Step 2</figcaption></figure><p id="1c13" class="pw-post-body-paragraph jn jo hh jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated"><em class="kl">最佳参数为:{'voting': 'soft '，' weights': (1，1，1，2，2)} </em></p><p id="bad5" class="pw-post-body-paragraph jn jo hh jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated"><em class="kl">平均调优交叉验证分数为</em> 0.9188 (+- 0.0341)</p><h1 id="9208" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">结论</h1><p id="3032" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">这篇博客讨论了如何在python中优化你的系综。VotingCLassifier为您的系综简化了超参数调整过程。平均调整的交叉验证显示了更高的平均分数和更小的标准偏差，这意味着集成表现得更好和更稳定。在sklearn中还有另一个类似的方法用于线性回归建模，它被称为“VotingRegressor”。详细内容可以在这里找到<a class="ae km" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.VotingRegressor.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="b63d" class="pw-post-body-paragraph jn jo hh jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated"><strong class="jp hi"> <em class="kl">请随时与我联系</em></strong><a class="ae km" href="https://www.linkedin.com/in/jinhangjiang/" rel="noopener ugc nofollow" target="_blank"><strong class="jp hi"><em class="kl">LinkedIn</em></strong></a><strong class="jp hi"><em class="kl">。</em>T13】</strong></p><h1 id="5eaa" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">相关阅读</h1><p id="b661" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated"><a class="ae km" rel="noopener" href="/analytics-vidhya/simple-weighted-average-ensemble-machine-learning-777824852426">简单加权平均集成|机器学习</a></p><div class="lq lr ez fb ls lt"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lu ab dw"><div class="lv ab lw cl cj lx"><h2 class="bd hi fi z dy ly ea eb lz ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ma l"><h3 class="bd b fi z dy ly ea eb lz ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mb l"><p class="bd b fp z dy ly ea eb lz ed ef dx translated">medium.com</p></div></div><div class="mc l"><div class="md l me mf mg mc mh in lt"/></div></div></a></div></div></div>    
</body>
</html>