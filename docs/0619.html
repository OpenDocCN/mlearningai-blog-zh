<html>
<head>
<title>Predicting Loan Approval Status — Practice Problem on Analytics Vidhya</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测贷款批准状态—分析Vidhya的练习题</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/predicting-loan-approval-status-practice-problem-on-analytics-vidhya-e15ae8b6b0d2?source=collection_archive---------1-----------------------#2021-05-28">https://medium.com/mlearning-ai/predicting-loan-approval-status-practice-problem-on-analytics-vidhya-e15ae8b6b0d2?source=collection_archive---------1-----------------------#2021-05-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/3ff554934ddb3ce89537c569b2d79508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xSaSd1BH4rMBWZkJ"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@alschim?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alexander Schimmeck</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5e25" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本文讨论了一种通过利用基础数据科学和机器学习技术来预测银行贷款批准状态的方法。这个问题是由Analytics Vidhya在他们的黑客马拉松部分作为一个实践挑战主持的。挑战的链接是—<a class="ae it" href="https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/" rel="noopener ugc nofollow" target="_blank">https://data hack . analyticsvidhya . com/contest/practice-problem-loan-prediction-iii/</a></p><p id="62ea" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我解决这个问题的方法获得了0.791的准确率，并在公开排行榜上获得了68K+中的880分。该问题主要是一个经典的二元分类问题，涵盖了正确有效地建模任何机器学习模型所需的许多重要步骤和过程。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="e0f0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第一步:数据加载和可视化</strong></p><p id="9522" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第一步也是最重要的一步是导入必要的库和包，并将数据集作为pandas dataframe加载。该平台分别提供训练和测试数据集。因此，我们加载两个数据集以供进一步分析。</p><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="76b3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通常建议保留原始数据集的副本作为必要的恢复措施，因为数据集的错误处理会给未来的调查造成混乱。</p><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="e604" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第二步:可视化和变量分析——理解数据</strong></p><p id="f39f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现有变量的可视化和有效调查是任何成功的数据分析项目的关键措施。给定数据集，特定申请人的贷款ID有12个特征。每个功能的描述如下:</p><ol class=""><li id="1167" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated"><em class="ko">贷款ID — </em>申请贷款的申请人的贷款ID</li><li id="798f" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">性别— </em>申请人的性别</li><li id="0d22" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">已婚— </em>申请人的婚姻状况</li><li id="14d8" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">家属— </em>申请人家属人数</li><li id="5375" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">教育</em> —申请人的教育状况(研究生/本科生)</li><li id="39e3" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">自雇— </em>申请人是否自雇</li><li id="032c" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">申请人收入— </em>申请人的收入</li><li id="0cc6" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">共同申请人收入— </em>共同申请人的收入</li><li id="60d1" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">贷款金额— </em>贷款金额，以千为单位</li><li id="ddb1" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">贷款_金额_期限—贷款期限(月)</em></li><li id="4e31" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">信用记录</em> —申请人以前的信用记录会议指南</li><li id="7ba1" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">物业区域— </em>城市、半城市或农村地区</li><li id="70fb" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated"><em class="ko">贷款_状态— </em>贷款审批状态(目标变量)</li></ol><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ku"><img src="../Images/a657b6a551ce50bccbf1f42b147d782e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2ojB3GtZYRCMw4KgYeEoQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Train dataset</figcaption></figure><p id="00af" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">取值为Yes(Y)/No(N)的二元变量Loan_Status用作需要利用测试数据预测的目标变量。</p><p id="ed27" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如下所示，使用目标变量对特征进行可视化，以从数据中获得单变量和双变量分析的正确推断。可视化的python源代码清楚地包含在我的Github存储库中，其链接在最后提供。</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kv"><img src="../Images/5d976fd0aecfad82fc47ea74b7b43273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hkr194OShwwO3rsUyJnRhA.png"/></div></div></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/75a19c0760ff4f4e04689eeeea50fcbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fwteS__C_Kkzde_clwweBA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Visualizations carried out using Matplotlib and Seaborn</figcaption></figure><p id="f025" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="ko">从上述分析中得出的推论是:</em></p><ol class=""><li id="f8b3" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">大多数贷款申请人在银行都有良好的信用记录。</li><li id="56de" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated">从图中可以清楚地看到，申请人的收入不是正态分布的，存在相当数量的异常值和异常值。</li><li id="0bd9" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated">然而，贷款金额数字描述了贷款金额的密度在某种程度上是正态分布的，尽管如此，它仍然带有需要适当注意的异常值。</li><li id="dba6" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated">银行在批准贷款时不存在基于性别的重大偏见。</li><li id="a679" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated">已婚人士和有两个受抚养人的人有很大的机会获得贷款批准。</li><li id="da0f" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated">显而易见，银行在提供贷款时更倾向于毕业生，然而，对于个体经营者来说却没有这种优惠。</li><li id="0cc2" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated">与城市和农村居民相比，居住在半城市地区的人更倾向于吸引银行提供贷款。</li><li id="b22a" class="kf kg hh iw b ix kp jb kq jf kr jj ks jn kt jr kk kl km kn bi translated">相关矩阵陈述了一个非常明显的事实，即贷款批准状态与人们过去的信用历史密切相关。</li></ol><p id="2bef" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第三步:数据预处理和特征工程</strong></p><p id="f0dc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">人们常说，几乎80–90%的工作应该投入到数据预处理和特征工程中，以创建一个近乎完美的数据科学和机器学习模型。尽管我在数据预处理方面投入了相当多的时间，但我非常确定可能会有更好的结果。</p><p id="2269" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最初，我们在数据集中检查null或NaN的出现。我们同时对训练集和测试集进行预处理，以优化进一步的实现。</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/f46b271839a5ba0fc4f1c96296385c87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*Kq1hbr_q8Bb-cLgy6QkdYw.png"/></div></figure><ul class=""><li id="bd75" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated">用Y: 1和N: 0映射目标变量。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="4305" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated">使用mode填充已婚和性别列的空值。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="2607" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated"><em class="ko">家属</em>:如果贷款状态为‘1’，家属= 2，否则为1。对于测试数据，如果Credit_History = 1，dependent = 2，否则为1。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="e3ac" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated"><em class="ko"> Credit_History </em>:如果贷款状态为‘1’，则Credit_History = 1，否则为0。对于测试数据，用模式输入是一个很好的选择。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="cfdf" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated"><em class="ko">个体户</em>:如果信用历史为‘1’，则输入个体户=否</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="3ccc" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated"><em class="ko"> Loan_Amount_Term，LoanAmount </em>:用分组的其他列(性别、已婚、教育、自雇、受抚养人)的中值输入特征‘null’。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="15c4" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated">引入新功能<em class="ko">Total _ Income = applicant Income+co applicant Income</em>作为优化功能重要性的功能工程措施。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="60e1" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated">正如从可视化中得出的推论所观察到的，对于<em class="ko"> Total_Amount和LoanAmount </em>的异常值处理，我们使用对数转换方法。由于这些异常值，大部分数据在左边，有一个长的右尾巴。这被称为右偏度，对数变换是去除异常值的好方法。对数转换不会影响较小的实例，而是减少较大的值以获得正态分布。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="e3fa" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated">一个热门的分类变量编码<em class="ko">‘性别’、‘已婚’、‘自雇’、‘教育’。</em></li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="128c" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated">通过与相关值的映射对遗漏的特征进行标签编码。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><ul class=""><li id="1694" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ky kl km kn bi translated">删除建模过程中不需要的列条目。</li></ul><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="03e9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">注- </strong>我采用的这些插补技术是基于我的假设，并牢记影响批准状态的必要因素(即目标变量)。可能有许多其他可能的技术。尽管如此，这些预处理步骤被证明是卓有成效的，使我的模型获得了不错的准确度。</p><p id="f3b1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第三步:建模和结果</strong></p><p id="d548" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了对目标变量进行有效的分类，我采用了两种有效的算法:随机森林分类器和X-treme梯度推进。这两个模型都用相关数据拟合，其中模型的先验超参数调整使用分类所需的优化参数的网格搜索交叉验证。</p><p id="1cde" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第一步是将训练数据集按80:20的比例分成训练集和验证集。验证集对于分析完全看不见的数据的结果非常重要。</p><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="19b5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">随机森林在验证集上给出了-77.23%的准确率。</p><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">GridSearchCV finds optimal parameters from the given set of parameter ranges</figcaption></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kz"><img src="../Images/56304822ea3e825a6cbb73c4fd783405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sUF_Pc1piQaWTjg1mHwH4w.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Optimal parameters achieved on hyperparameter tuning</figcaption></figure><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><p id="843d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">XGBoost在验证集上给出了-78.86%的准确率。</p><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div></figure><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/edb4fcf5b6278a22af9ebefe64650a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bl9zuwMQRXJs8f3xH-eRgA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Optimal Parameters</figcaption></figure><figure class="jz ka kb kc fd ii"><div class="bz dy l di"><div class="kd ke l"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Fitting the model by creating a pipeline of XGBoost</figcaption></figure><p id="0dde" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最终提交的应用了Vidhya提供的分析测试数据的训练模型，获得了相当不错的准确度分数— 79.166 %，在公共排行榜上获得了880的令人满意的位置。</p><p id="5ae0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">用python写的完整源代码的github repo—<a class="ae it" href="https://github.com/poddaraayush14/Loan_Prediction_Challenge" rel="noopener ugc nofollow" target="_blank">https://github.com/poddaraayush14/Loan_Prediction_Challenge</a></p><p id="bc83" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤4:结论</strong></p><p id="7ecc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这个基本的分类问题中，基于树的算法如随机森林分类和梯度推进算法如XGBoost。可能有更多的算法可以提供更有效的结果。集成学习、深度学习和神经网络可以成为未来与这项工作相关的工作的基础。我已经限制了分析的范围，以获得一个像样的公平的结果。机器学习和数据科学是一个巨大的机会海洋，可以尝试和赌博各种技术和过程。</p><p id="133d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> <em class="ko">快乐学习！！！</em>T15】</strong></p></div></div>    
</body>
</html>