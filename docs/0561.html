<html>
<head>
<title>At what price should you sell your home? — Multivariate Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你应该以什么价格出售你的房子？—多元线性回归</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/at-what-price-should-you-sell-your-home-multivariate-linear-regression-a6824ec172b1?source=collection_archive---------4-----------------------#2021-05-15">https://medium.com/mlearning-ai/at-what-price-should-you-sell-your-home-multivariate-linear-regression-a6824ec172b1?source=collection_archive---------4-----------------------#2021-05-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/deeaf3a9608d069d28fcf47b7d8671cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Aq0AUzVBC-zFKRL1"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@brenoassis?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Breno Assis</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="7470" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">先决条件</h1><p id="9766" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">如果你还没有读过我以前的文章，在那篇文章中，我带你一步一步地了解线性回归算法的幕后，在那篇文章中，我们直观地构建了它背后的整个数学本质，<a class="ae it" href="https://hemanth-kotagiri43.medium.com/introduction-to-machine-learning-30a50cdec18e" rel="noopener">你真的需要看看这个</a>。这篇文章是上一篇文章的延伸，我想你已经尝试过了。在本文中，让我们来处理影响我们算法的多个特征/变量的问题。同样，这些是我在Coursera上学习吴恩达的机器学习课程时做的个人笔记。如果你感兴趣的话，可以随意学习，最棒的是这门课是免费的。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><h2 id="58a8" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated">背景</h2><p id="7f7e" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated"><strong class="ju hi">注意我特意为这篇文章选择的图片——房屋</strong>。很明显，每栋房子都有可能以高价出售。在上一篇文章中，我们已经处理了一个单一的特征——也就是说，我们实际上是基于一个可能影响房屋价格的单一因素来构建我们的整个算法的。让我更清楚地说明我们所说的“特性”指的是什么。</p><p id="8cb2" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">假设你是其中一个家庭的居民。你打算卖掉你的房子。你将如何有效地选择你应该销售的阈值？这就是这个算法可以发挥作用的地方。<strong class="ju hi">特色，在这个问题中，就是你家的特色</strong>。比如:</p><ul class=""><li id="9732" class="lq lr hh ju b jv ll jz lm kd ls kh lt kl lu kp lv lw lx ly bi translated">这个家有多老了？</li><li id="c574" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">你家的卧室总数。</li><li id="ad83" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">你家的浴室数量。</li><li id="5996" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">你家所占的总面积。</li><li id="5a20" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">它有停车场吗？如果有，可以停多少车？</li><li id="d755" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">它有一个后院，我可以坐在那里，在季风和阅读浪漫小说吗？</li><li id="ff1a" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">它有一个我可以享受夏天的游泳池吗？</li></ul><p id="b071" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">您已经看到，特征空间正在扩大，您也可以组合几个特征并创建一个新的特征。这就是特征空间发挥作用的地方，跟踪哪些特征影响最大，以及从长远来看哪些特征对算法的性能有更大的影响，这一点非常重要。</p><p id="9175" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">所以，这个想法是，根据具有<strong class="ju hi">相同的多重特征</strong>的“学习范例”来预测你的房子可以卖出的价格。如果你已经明白了以上内容，那么恭喜你！你现在可以开始参加所有初学机器学习的人都参加的最著名的Kaggle竞赛了——房屋价格竞赛，这也是我的第一个竞赛。说够了，让我们开始数学吧。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><h2 id="e307" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated"><strong class="ak">假设函数—重新定义</strong></h2><p id="a063" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">这里，基于我们在上一篇文章中定义的假设，如果我们有一个函数有多个变量/特征比如x1，x2，x3…xn；然后，我们将假设函数表示为:</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es me"><img src="../Images/e636f8f8982a0604233d74b750eaf081.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*Xr8S-ABpy-DNzoaxMaxGJg.png"/></div></figure><p id="ee56" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">我们可以选择以向量的形式来表示我们的假设函数，在许多编程语言中，如MATLAB和Python，由于向量的设计方式，使用向量表示可以提高计算速度。</p><h2 id="b689" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated">多变量梯度下降</h2><p id="65ff" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">设n表示数据集中给定特征的数量。以前，我们有n = 1，这只是一个特性，但在这里，我们可能有2个以上的特性。所以梯度下降算法有一个小变化，比如:</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es mj"><img src="../Images/e77a340ed5c3037d5ed6c1fc6f4c567a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/0*RnObZnegbm9Eqxl0"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo from Machine Learning course taught by Andrew Ng</figcaption></figure><p id="7d2a" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">下图比较了单变量梯度下降和多变量梯度下降:</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es mk"><img src="../Images/859eedf9700540b0bfe0ac402e075437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/0*pXepl80FFkufOB6b"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo from Machine Learning course taught by Andrew Ng</figcaption></figure><p id="d298" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">请注意从0到n的变量“j ”,也就是说，它从偏差项一直迭代到最后一个特征(n)。我们计算每个特征的偏导数，并更新θ值——参数向量。<strong class="ju hi">这里有一个问题，你注意到了吗？</strong>我们正在迭代整个特征空间，计算梯度，一步更新θ值。<strong class="ju hi">和</strong>，我们不可避免地重复这个过程，直到这些θ值之间的变化非常小。这使得梯度下降的速度很慢。就像，真的太慢了，以至于你有停止学习机器学习并回到你的舒适区的冲动。开个玩笑，让我们看看几种可以提高优化算法整体速度的方法。</p><h2 id="0b84" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated">如何能加快梯度下降？</h2><ul class=""><li id="7d20" class="lq lr hh ju b jv jw jz ka kd ml kh mm kl mn kp lv lw lx ly bi translated">我们可以通过使我们的每个输入值处于大致相同的范围内来加速梯度下降，以便高度偏斜的等值线图可以下降到圆形，从而梯度下降会发现更容易达到全局/局部最小值。</li><li id="6602" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">理想情况下，我们可以将输入值的范围选择在-1和1之间。我们可以修改输入要素值，使它们在整个数据集中大致落在同一范围内。</li><li id="0892" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">为此，我们可以在众多技术中使用其中的一种。特征缩放或均值归一化。只要迈出这一步，我们就可以着手写一整本书，难怪已经有很多这样的书了。总之，让我们看看这两种技术是做什么的。</li><li id="6a50" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated"><strong class="ju hi">特征缩放:</strong>在这种方法中，我们将输入值除以数据集的范围(最大值减去最小值),得到一个新的范围1。</li><li id="9841" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated"><strong class="ju hi">均值归一化:</strong>在这种方法中，我们可以用输入变量减去输入特征的平均值，然后除以标准差或输入特征的范围。请注意，将其除以标准差与除以范围相比，会产生不同的结果。例如，如果xi代表的房价范围为100到2000，平均值为1000，则Xi =(Xi-1000)/1900。</li></ul><p id="510c" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">现在你已经了解了加速梯度下降的几个步骤，你将如何确定优化的收敛性？它真的学会参数了吗，它达到全局最小值了吗？还是说，它仍在向全球/局部最小值迈着小步？或者它只是把等高线图射向无穷远处？让我们来回答这些问题</p><h2 id="ef42" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated">调试梯度下降</h2><h2 id="85f2" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated"><strong class="ak">可视化方式——绘制图形</strong></h2><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/00de7fbec72c906693c518d81fcf1bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*Jw6Szd6j0ErrJwr0"/></div></figure><p id="81cd" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">直观检查梯度下降是否正常工作的一个有效方法是绘图。为了调试梯度下降，在x轴上绘制迭代次数图。现在绘制梯度下降迭代次数的成本函数J(θ)。如果J(θ)增加，那么你可能需要减少α。</p><h2 id="e455" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated">自动收敛测试</h2><p id="3519" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">如果J(θ)在一次迭代中减少的量小于e，则声明收敛，其中e是某个小值，如10^−3.然而，在实践中，很难选择这个阈值。</p><div class="mf mg mh mi fd ab cb"><figure class="mp ii mq mr ms mt mu paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/b9f94f1ce9bf6c0a7679e366f4fc7fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*aKYOKI739pbWaLaHcsmYxw.png"/></div></figure><figure class="mp ii mv mr ms mt mu paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/80d46a60b591222e0f8ed24bcad70ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*aZHz1Q7uyWSBDfdP51MWSw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx mw di mx my">Photo from Machine Learning course by Andrew Ng</figcaption></figure></div><p id="1486" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">已经证明，如果学习率α足够小，那么J(θ)将在每次迭代中减小。这并不意味着选择一个极低的学习率，这将潜在地减缓梯度下降甚至更多。如果α太小:收敛慢。如果α太大:它可能不会在每次迭代中减少，因此可能不会收敛。因此，根据你正在处理的数据集，明智地选择学习率α。修补和绘制成本，您将清楚地看到哪个alpha值最适合您的数据集。</p><h2 id="27ac" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated">多项式回归</h2><ul class=""><li id="2ccd" class="lq lr hh ju b jv jw jz ka kd ml kh mm kl mn kp lv lw lx ly bi translated">为了合理地拟合数据，我们的假设函数不必总是线性的。事实上，许多数据集遵循多项式趋势而不是线性趋势。我们可以选择在函数中包含多项式项，希望得到一个好的假设。</li><li id="aba1" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">我们可以通过将多个特征组合成一个来改进我们的假设函数。例如，我们可以将x1和x2特征合并为x1*x2，并生成一个新特征x3 = x1*x2。</li><li id="d326" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">记住，当你包含多项式项时——<strong class="ju hi">特性缩放</strong>变得非常重要。因为一些特征可能会达到非常大的值，使得曲线非常不稳定。比方说包括特征x3 = x1*(x2)。在这种情况下，如果x2的值是100，x1是10，那么x3的值将是100，000，000，这是非常巨大的。在这种情况下，特征缩放可以方便地将该值降低到所需的范围，这样曲线就不会不稳定。</li></ul></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><h2 id="d0f6" class="kx iv hh bd iw ky kz la ja lb lc ld je kd le lf ji kh lg lh jm kl li lj jq lk bi translated">一种计算参数的偷偷摸摸的方法——避免梯度下降</h2><ul class=""><li id="800c" class="lq lr hh ju b jv jw jz ka kd ml kh mm kl mn kp lv lw lx ly bi translated">我们还可以使用分析技术来计算参数向量θ，例如使用这样的方法:θ= inv(x^t * x)*(x^t * y)。这被称为线性回归的<strong class="ju hi">正规方程</strong>。</li><li id="f86d" class="lq lr hh ju b jv lz jz ma kd mb kh mc kl md kp lv lw lx ly bi translated">在解析地寻找参数时，不需要<strong class="ju hi">进行特征缩放</strong>。下面显示了4个训练示例的示例。</li></ul><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/33e88e6ef59d84bf072415cf31ef9717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*B9HJhVqqJAwr38kTgRnhyA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo from Machine Learning course by Andrew Ng</figcaption></figure><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es na"><img src="../Images/ebc8d503a8103e7f14d9a48121b8a209.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*_IIX8eSp7MRxv6FR3lcFMw.png"/></div></figure></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><h1 id="31dc" class="iu iv hh bd iw ix nb iz ja jb nc jd je jf nd jh ji jj ne jl jm jn nf jp jq jr bi translated">把所有的放在一起</h1><p id="daac" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">如果你已经做到了这一步，并且理解了大部分内容，那么恭喜你，给自己一个鼓励——因为这是你应得的！您已经了解了将这些概念实际应用到现实世界数据集并生成预测模型所需的一切。您已经了解了成本函数、优化算法——梯度下降、分析计算参数、有效选择学习速率，还调试了算法的性能。用你最喜欢的编程语言把它们粘在一起——你就有了线性回归。</p><p id="25d3" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">到目前为止，这是一个伟大的旅程，你只是轻松地通过冰山一角。你还可以学习更多的东西，相信我，有许多研究人员花了一生的时间从每种算法中挤出0.1%的性能，尝试不同的方法来实现，希望比以前的版本有所改进。所以，不要着急，对这些概念有了基本的了解就可以度过了。</p><p id="dfdd" class="pw-post-body-paragraph js jt hh ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp ha bi translated">所以，无论如何，永远不要停止学习！</p><blockquote class="ng nh ni"><p id="9d37" class="js jt nj ju b jv ll jx jy jz lm kb kc nk ln kf kg nl lo kj kk nm lp kn ko kp ha bi translated">对宝贝，用耐心。</p></blockquote></div></div>    
</body>
</html>