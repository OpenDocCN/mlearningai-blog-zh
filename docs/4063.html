<html>
<head>
<title>Vowpal Wabbit on Azure ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure ML上的Vowpal Wabbit</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/vowpal-wabbit-on-azure-ml-269616a84b97?source=collection_archive---------2-----------------------#2022-12-03">https://medium.com/mlearning-ai/vowpal-wabbit-on-azure-ml-269616a84b97?source=collection_archive---------2-----------------------#2022-12-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/b7f96941c18a8f69cbbabd44024cac0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PllAuGykmnPhTjLw"/></div></div></figure><h1 id="38a3" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">在Azure ML上运行Vowpal Wabbit的示例</h1><h1 id="c1c5" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">先决条件</h1><ul class=""><li id="f756" class="jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">Azure帐户</li><li id="e953" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">Azure机器学习服务</li></ul><h1 id="9b70" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">步伐</h1><ul class=""><li id="5738" class="jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">用python 3.8创建一个以Azure ML为内核的笔记本</li><li id="50a6" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">安装vowpal wabbit</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="c1a3" class="kt iq hh kp b fi ku kv l kw kx">pip install vowpalwabbit</span></pre><ul class=""><li id="96b1" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">加载必要的库</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="3fe7" class="kt iq hh kp b fi ku kv l kw kx">import pandas as pd<br/>import sklearn<br/>import sklearn.model_selection<br/>import sklearn.datasets<br/>import vowpalwabbit</span></pre><ul class=""><li id="f936" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">现在将虹膜数据集加载到数据帧中</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="11ad" class="kt iq hh kp b fi ku kv l kw kx">iris_dataset = sklearn.datasets.load_iris()<br/>iris_dataframe = pd.DataFrame(<br/>    data=iris_dataset.data, columns=iris_dataset.feature_names<br/>)<br/># vw expects labels starting from 1<br/>iris_dataframe["y"] = iris_dataset.target + 1<br/>training_data, testing_data = sklearn.model_selection.train_test_split(<br/>    iris_dataframe, test_size=0.2<br/>)</span></pre><ul class=""><li id="39da" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">格式特征函数</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="5d09" class="kt iq hh kp b fi ku kv l kw kx">def to_vw_format(row):<br/>    res = f"{int(row.y)} |"<br/>    for idx, value in row.drop(["y"]).iteritems():<br/>        feature_name = idx.replace(" ", "_").replace("(", "").replace(")", "")<br/>        res += f" {feature_name}:{value}"<br/>    return res</span></pre><ul class=""><li id="c83c" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">显示几行</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="53d0" class="kt iq hh kp b fi ku kv l kw kx">for ex in training_data.head(10).apply(to_vw_format, axis=1):<br/>    print(ex)</span></pre><ul class=""><li id="80d1" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">创建足球工作区</li><li id="4b15" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">使用多个样本进行训练</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="be7f" class="kt iq hh kp b fi ku kv l kw kx">vw = vowpalwabbit.Workspace("--oaa 3 --quiet")</span><span id="c6c3" class="kt iq hh kp b fi ld kv l kw kx"># learn from training set with multiple passes<br/>for example in training_data.apply(to_vw_format, axis=1):<br/>    vw.learn(example)</span><span id="f534" class="kt iq hh kp b fi ld kv l kw kx"># predict from the testing set<br/>predictions = []<br/>for example in testing_data.apply(to_vw_format, axis=1):<br/>    predicted_class = vw.predict(example)<br/>    predictions.append(predicted_class)</span></pre><ul class=""><li id="3768" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">现在预测输出</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="6fa8" class="kt iq hh kp b fi ku kv l kw kx">accuracy = len(testing_data[testing_data.y == predictions]) / len(testing_data)</span><span id="3e65" class="kt iq hh kp b fi ld kv l kw kx">print(f"Model accuracy {accuracy}")</span></pre><ul class=""><li id="4147" class="jn jo hh jp b jq ky js kz ju la jw lb jy lc ka kb kc kd ke bi translated">输出应该是</li></ul><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="41a8" class="kt iq hh kp b fi ku kv l kw kx">Model accuracy 0.7333333333333333</span></pre></div><div class="ab cl le lf go lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ha hb hc hd he"><p id="e706" class="pw-post-body-paragraph ll lm hh jp b jq ky ln lo js kz lp lq ju lr ls lt jw lu lv lw jy lx ly lz ka ha bi translated"><em class="ma">最初发表于</em><a class="ae mb" href="https://github.com/balakreshnan/Samples2022/blob/main/AzureML/Vowpal1.md" rel="noopener ugc nofollow" target="_blank"><em class="ma">【https://github.com】</em></a><em class="ma">。</em></p><div class="mc md ez fb me mf"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hi fi z dy mk ea eb ml ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt in mf"/></div></div></a></div></div></div>    
</body>
</html>