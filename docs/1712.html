<html>
<head>
<title>Feature Engineering using Keras Lambda Layers for complete training pipeline.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Keras Lambda层的特征工程，用于完整的培训管道。</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/feature-engineering-using-keras-lambda-layers-ae0c6d3c904f?source=collection_archive---------7-----------------------#2022-01-22">https://medium.com/mlearning-ai/feature-engineering-using-keras-lambda-layers-ae0c6d3c904f?source=collection_archive---------7-----------------------#2022-01-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/0f4032edc595f5fce56e1b680482c1e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YrvMKrWMhi3HomoiTLPsfw.png"/></div></div></figure><p id="58c2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">通常对于结构化数据问题，我们最终会使用多个库进行预处理或特征工程。我们甚至可以有一个完整的ML训练管道，使用不同的库，例如用于读取数据的Pandas，以及用于编码特征的sklearn，例如OneHot编码和标准化。估计器可以是sklearn分类器xgboost，或者它可以是例如Keras模型。在后一种情况下，我们将最终得到用于特征工程和编码的工件，以及用于保存的模型的不同工件。管道也被断开，需要一个额外的步骤来向Keras模型提供编码数据。对于这一步，在将数据输入Keras模型之前，可以将数据从dataframe映射到类似tf.data.Datasets的类型或numpy数组。</p><p id="54a6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本帖中，我们将考虑使用Keras/Tensorflow在本地实现一个培训管道。如标题所示，我们将使用Lambda层进行特征工程。这些工程特征将是无状态的。对于有状态预处理，我们可以使用类似Keras预处理层的东西。我们将最终得到一个训练管道，其中特征工程将成为网络架构的一部分，并且可以作为独立的推理被持久化和加载。</p><p id="f46f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请记住，tf.keras.layers.Lambda层有序列化(反序列化)限制，因为Lambda层是通过序列化python字节码保存的。</p><p id="36cc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将遵循的步骤:</p><ul class=""><li id="1a36" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">用tf.data加载数据</li><li id="e2a2" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">创建输入层</li><li id="e085" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">使用Lambda图层创建要素图层</li><li id="4968" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">火车模型</li></ul></div><div class="ab cl kc kd go ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="ha hb hc hd he"><p id="ec31" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于下面的例子，我们将使用心脏病数据集。让我们导入张量流并读入数据:</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="8e26" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为每个要素创建一个输入对象字典:</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="e003" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将在这个例子中使用Lambda层进行特征工程。以下是我们将用于创建工程特征的功能。</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="9b9c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们有了自己的函数，让我们创建Lambda层的功能:</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="245e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们所有的工程特征层都已创建，现在我们可以将其与其他特征相结合。</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="94a3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们的最后一步是创建和适应我们的Keras模型。对于这个例子，我们将使用一个简单的模型架构。我们将持久化模型，并加载它以进行推理。</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="kn ko l"/></div></figure><p id="57b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">总之，我们能够成功地建立一个模型使用Keras Lambda层。该模型被保存并加载用于推理。我们的特征工程是我们保存的模型(模型架构)的一部分。<strong class="ir hi">一切都原产于喀拉斯。</strong></p><div class="kp kq ez fb kr ks"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kt ab dw"><div class="ku ab kv cl cj kw"><h2 class="bd hi fi z dy kx ea eb ky ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kz l"><h3 class="bd b fi z dy kx ea eb ky ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="la l"><p class="bd b fp z dy kx ea eb ky ed ef dx translated">medium.com</p></div></div><div class="lb l"><div class="lc l ld le lf lb lg in ks"/></div></div></a></div></div></div>    
</body>
</html>