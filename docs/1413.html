<html>
<head>
<title>Is My Model Trained Well?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的模特训练的好吗？</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/is-my-model-trained-well-b2dcb75a4f5d?source=collection_archive---------4-----------------------#2021-12-11">https://medium.com/mlearning-ai/is-my-model-trained-well-b2dcb75a4f5d?source=collection_archive---------4-----------------------#2021-12-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="7b83" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">已训练模型的性能参数</h2></div><p id="d410" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">机器学习是模型的组合，如果在正确的环境中应用，会产生意想不到的结果。相反，如果选择不当，可能会导致错误的预测或输出。因此，开发高度准确的机器学习模型的周期不会停止于训练和使数据集适合所选模型。我们必须分析不同参数的训练模型，以验证其预测的有效性。python中提供了多种参数图，可用于理解训练模型。Python有一个特殊的库<strong class="iy hi"> Scikit-plot </strong>，它有一些包和函数，可以用来创建图表，以便用几行代码理解一个经过训练的模型的性能。在这个博客中，我们将讨论这个库中一些最常用的函数。</p><h1 id="6b8e" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">西基特图</h1><p id="9c1e" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">每个数据科学家都知道，可视化是数据科学过程的重要组成部分之一，不应该被忽视。然而，在训练模型时，大多数数据科学家更关心模型的准确性、超参数调整或获得期望的输出。在这个设置中，像Scikit-plot这样的库帮助很大，它提供了使用几行代码创建信息丰富的图形的包。让我们看看如何使用这个库来创建重要的机器学习图。</p><h1 id="c999" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">装置</h1><p id="9743" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">可以使用PyPi通过以下命令下载最新版本的Scikit-plot。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><h1 id="9393" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">Scikit-plot的先决条件</h1><p id="5a37" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">在使用<strong class="iy hi"> Scikit-plot </strong>创建图形之前，需要导入所需的库。<strong class="iy hi"> Scikit-plot </strong>已经使用matplotlib创建，所以我们也需要导入它。下面的代码导入了我们在实验中使用<strong class="iy hi"> Scikit-plot </strong>时所需的大部分库。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><h1 id="04a9" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">混淆矩阵</h1><p id="e427" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">训练模型后最重要的输出之一是其混淆矩阵，该矩阵可用于解释多种结果，如<strong class="iy hi">真阳性率、假阳性率、精确度、召回率或F1测量值</strong>。通常我们可以输出一个简单的矩阵，但是Scikit-plot提供了一个漂亮的混乱矩阵的热图。这个混淆热图将能够用深色表示混淆矩阵中的高值，这样我们就不会意外地忽略一个重要的输出。</p><p id="b5ca" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们将<strong class="iy hi"> RandomForestClassifier </strong>应用于<strong class="iy hi"> sklearn.datasets </strong>中可用的<strong class="iy hi">数字</strong>数据集，然后使用带有默认参数的<strong class="iy hi"> cross_val_predict </strong>进行预测，下面是代码。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><p id="427b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在让我们使用<strong class="iy hi"> Scikit-plot </strong>绘制混淆矩阵，下面是代码和输出图像。它在混淆矩阵的对角线上显示较暗的单元，这是所期望的，因为大多数预测与实际类别相似。可以从各种博客或教科书中研究与混淆矩阵相关的更多细节，medium.com就是一个例子。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kw"><img src="../Images/e72ea4ed5ee1cdbdf8c09bbf4d65a434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FgRHQxklsZI6I_So"/></div></div></figure><h1 id="6093" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">受试者工作特征曲线</h1><p id="b5ac" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">这是真阳性率和假阳性率之间的曲线。当数据集存在类别不平衡问题时，此图非常重要，但是，它也应该与正常数据集一起绘制。基本上，ROC曲线下的面积是要观察的主要参数，面积越高模型越好。为标注数据集的每个输出类生成ROC曲线。Scikit-plot绘制了一条ROC曲线，其中包含微观平均值和宏观平均值以及所有输出类，下面写有一行代码。由此代码生成的ROC曲线也如下。关于ROC曲线的细节可以从<a class="ae ld" href="https://towardsdatascience.com/understanding-auc-roc-curve-68b2303cc9c5" rel="noopener" target="_blank">这个博客</a>中研究。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es le"><img src="../Images/f28f5aeed158d9d045925c7989759cb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vb3M37tgC-usSOoi"/></div></div></figure><h1 id="6d1e" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">精确回忆曲线</h1><p id="74d2" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">精度-召回曲线用于测试预测阳性类别的模型的准确性。Scikit-plot提供了一个在单行代码中创建精度-召回曲线的函数。关于精确召回曲线的更多细节可以从<a class="ae ld" href="https://towardsdatascience.com/precision-recall-curves-how-to-easily-evaluate-machine-learning-models-in-no-time-435b3dd8939b" rel="noopener" target="_blank">的博客</a>中研究。<strong class="iy hi"> Scikit-plot </strong>的代码及其输出如下。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es le"><img src="../Images/cbee529c1e2bfaa143fb3b74a77a0182.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xk-OnQqoLUCIXGor"/></div></div></figure><h1 id="14cb" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">模型校准(校准曲线)</h1><p id="b32e" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">每当模型为我们提供一个精度值时，它并不反映模型在预测标记输出时的置信度。在任务关键型应用模型中，在比较多个机器学习模型时，还应该考虑预测输出类别的置信度。例如，如果一个经过训练的模型预测一个人没有健康状况(比如说电晕),置信度只有0.60。在这种情况下，此人应该进行进一步的测试，因为0.60不是预测负类的好置信度。校准曲线有助于显示类别的平均预测值以及阳性分数。<strong class="iy hi"> Scikit-plt </strong>的以下代码提供了为四种不同机器学习算法的合成生成数据集生成校准曲线的功能，并显示了它们的校准值以及完美校准的曲线。关于模型校准的细节可以从<a class="ae ld" href="https://towardsdatascience.com/classifier-calibration-7d0be1e05452" rel="noopener" target="_blank">这个博客</a>中进一步研究。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es le"><img src="../Images/d44f1bf887480ac3c4dcd0f917a83d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NTGCxERjlb7fZXX5"/></div></div></figure><h1 id="a5aa" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">学习曲线</h1><p id="6f7e" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">学习曲线是用于比较模型在训练和验证数据集上的训练和测试准确性的曲线。它是根据用于计算这些值的训练示例的数量绘制的。<strong class="iy hi"> Scikit-plot </strong>提供了一个可以帮助你绘制这条曲线的函数，你可以在下面找到代码及其输出。这个图表也可以让你了解<strong class="iy hi">偏差-方差权衡。</strong></p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es lf"><img src="../Images/a5e0c593701f385c2b5b4887172bc03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/0*hEiV6arF3ujmr0WN"/></div></figure><h1 id="de3e" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">特征重要性</h1><p id="cf75" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">减少数据集中的要素数量是数据预处理的主要任务之一。它可以为机器学习模型的成功做出很大贡献。PCA和许多其他技术用于创建新特征，这些新特征可以是一个或多个特征的组合。然而，我们可以在模型训练后计算每个特征的特征重要性值，它也可以反映每个特征对输出决策的贡献。<strong class="iy hi"> Scikit-plot </strong>库也具有查找每个特征的特征重要性值并表示其标准偏差的功能。下面的代码使用sklearn包中可用的iris数据集，并发现它的四个特性对于将实例分类到不同的类中的重要性。</p><figure class="kp kq kr ks fd kt"><div class="bz dy l di"><div class="ku kv l"/></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es le"><img src="../Images/14c3c68aebd8577928eb33ab5f086eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jwky5jdTH8jzV5QC"/></div></div></figure><h1 id="af63" class="js jt hh bd ju jv jw jx jy jz ka kb kc in kd io ke iq kf ir kg it kh iu ki kj bi translated">结论</h1><p id="7486" class="pw-post-body-paragraph iw ix hh iy b iz kk ii jb jc kl il je jf km jh ji jj kn jl jm jn ko jp jq jr ha bi translated">多个模型的比较和模型的不同版本应该在多个参数上进行比较，以便找到最适合给定数据集的参数。在向老板展示这些结果时，与数字相比，图表总是更好的表达方式，这也是事实。有一个名为Scikit-plot的python包可以帮助机器学习实践者用最少的代码行生成这些图形。</p><p id="0c1c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这篇博客中，我们已经看到了一些与分类活动相关的重要函数，以及它们各自的代码和输出。训练完模型后，您可以使用这些代码来分析训练结果。</p></div><div class="ab cl lg lh go li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ha hb hc hd he"><p id="5be8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="ln">原载于2021年12月11日</em><a class="ae ld" href="https://rajindersandhu.com/2021/12/11/is-my-model-trained-well-model-training-analysis/" rel="noopener ugc nofollow" target="_blank"><em class="ln">http://rajindersandhu.com</em></a><em class="ln">。</em></p><div class="lo lp ez fb lq lr"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ls ab dw"><div class="lt ab lu cl cj lv"><h2 class="bd hi fi z dy lw ea eb lx ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ly l"><h3 class="bd b fi z dy lw ea eb lx ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lz l"><p class="bd b fp z dy lw ea eb lx ed ef dx translated">medium.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf lb lr"/></div></div></a></div></div></div>    
</body>
</html>