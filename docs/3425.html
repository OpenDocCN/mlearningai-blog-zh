<html>
<head>
<title>Pytorch &amp; C++ #3: House Price Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pytorch &amp; C++ #3:房价预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/pytorch-c-3-house-price-prediction-47696ad52e52?source=collection_archive---------4-----------------------#2022-09-02">https://medium.com/mlearning-ai/pytorch-c-3-house-price-prediction-47696ad52e52?source=collection_archive---------4-----------------------#2022-09-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/2df193ef8fcb85dc3308b62b246c4add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CCzSulsaZvXvQktwYMRTPw.png"/></div></div></figure><h1 id="4345" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">介绍</h1><p id="3d7d" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在本系列中，我将尝试提供使用Pytorch c++ API的示例/实践/项目。如果你是这个系列的新手，你可以在潜水前查看<a class="ae kl" rel="noopener" href="/@yozkose3/pytorch-c-intro-b50571762162">的第一篇博客</a>。在这个故事中，我们将训练一个模型来预测给定地段面积和建造年份的房价。所有代码都可以在<a class="ae kl" href="https://github.com/EmreOzkose/pytorch_cpp" rel="noopener ugc nofollow" target="_blank">这个Github repo </a>中找到。</p><h1 id="a881" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">内容</h1><ol class=""><li id="e47a" class="km kn hh jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">训练房价预测模型(Python)</li><li id="a43c" class="km kn hh jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">测试训练好的模型。(CPP)</li><li id="0d6f" class="km kn hh jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">这个例子的下一步是什么？</li></ol><h1 id="75fc" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">训练一个房价预测模型</h1><p id="6baf" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">我们将使用<a class="ae kl" href="https://www.kaggle.com/competitions/house-prices-advanced-regression-techniques/data" rel="noopener ugc nofollow" target="_blank">房价预测数据集</a>，其中仅使用地块面积和建造年份值来训练模型。首先，我们应该加载数据并创建Pytorch数据集。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="b7ec" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">创建数据加载器之后，我们应该定义我们的预测模型。因此，这个博客旨在展示基本概念，而不是达到一个最佳模型，我们将使用一个只有3层的多层感知器。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="56b6" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">现在，我们将训练我们的预测模型。我们将使用具有0.01学习率和L1损失的Adam优化器。可以用SGD来改变优化器，或者可以观察到不同的损失函数。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="54d4" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">在培训结束时，我们得到了下面的损失图</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es ll"><img src="../Images/e232316cf61543e1cea53cd4ace327b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*hVjPBmjCsXMT_WS7JJMdUA.png"/></div></figure><p id="b79e" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">损失值对我们教程来说似乎足够了:)。现在我们应该用<code class="du lm ln lo lp b">torch.jit.trace()</code>导出我们的模型。我们必须给出训练好的模型和一个例子给<code class="du lm ln lo lp b">trace()</code>函数。我从<code class="du lm ln lo lp b">test_dl</code>拿了一个样本。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><h1 id="b639" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">测试训练好的模型</h1><p id="4a62" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在这一节中，我们加载我们跟踪的模型，并在cpp文件中进行推理。首先，我们应该加载跟踪预测模型。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="23f0" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">那么模型的输入定义如下。我们对数据样本进行了归一化处理，以便在训练过程中快速收敛。因此，我们也应该规范推理中的输入。我们定义了两个输入的平均值和标准差。其实在Python中定义为<code class="du lm ln lo lp b">statistics</code>变量。我们只将Python中的值复制粘贴到CPP。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="70b3" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">最后，我们将我们的输入提供给加载的预测模型。</p><figure class="la lb lc ld fd ii"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="6b75" class="pw-post-body-paragraph jn jo hh jp b jq lg js jt ju lh jw jx jy li ka kb kc lj ke kf kg lk ki kj kk ha bi translated">CPP代码可以按如下方式构建和运行</p><pre class="la lb lc ld fd lq lp lr ls aw lt bi"><span id="7d2a" class="lu iq hh lp b fi lv lw l lx ly">$ cmake -DCMAKE_PREFIX_PATH=/path/to/libtorch .. &amp;&amp; cmake --build . --config Release &amp;&amp; ./house-prediction 8414 1963</span></pre><h1 id="a2e7" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">这个例子的下一步是什么？</h1><ul class=""><li id="37f9" class="km kn hh jp b jq jr ju jv jy ko kc kp kg kq kk lz ks kt ku bi translated">平均值和标准值可以存储在pt文件中，也可以动态加载到cpp文件中。</li><li id="e48d" class="km kn hh jp b jq kv ju kw jy kx kc ky kg kz kk lz ks kt ku bi translated">可以进行时间分析来观察每个环境的推论之间的差异。</li></ul><h1 id="7010" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">结论</h1><p id="fefc" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在这篇博客中，我们用Pytorch cpp API练习了房价预测。所有代码都可以在<a class="ae kl" href="https://github.com/EmreOzkose/pytorch_cpp" rel="noopener ugc nofollow" target="_blank">这个Github Repo </a>中找到。在本系列的后续博客中，我们将继续使用torch::nn。</p><div class="ma mb ez fb mc md"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="me ab dw"><div class="mf ab mg cl cj mh"><h2 class="bd hi fi z dy mi ea eb mj ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mk l"><h3 class="bd b fi z dy mi ea eb mj ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ml l"><p class="bd b fp z dy mi ea eb mj ed ef dx translated">medium.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr in md"/></div></div></a></div></div></div>    
</body>
</html>