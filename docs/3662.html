<html>
<head>
<title>Calibration in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的校准</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/calibration-in-machine-learning-9d73aeaae8fd?source=collection_archive---------2-----------------------#2022-10-05">https://medium.com/mlearning-ai/calibration-in-machine-learning-9d73aeaae8fd?source=collection_archive---------2-----------------------#2022-10-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/b03d403f2e1750017af4f07e53499320.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*J23t2kbROwm_9xWdhQ95Hw.png"/></div><figcaption class="il im et er es in io bd b be z dx">calibration</figcaption></figure><p id="bca8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当我们接触到“游标卡尺”时，有科学背景的学生一定读过物理学中的校准。</p><p id="8825" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">虽然基本原理保持不变(检查测量/结果的质量)，但机器学习中的校准使用不同的技术，并应用于不同的用例。</p><p id="bc6a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这个故事中，我们将学习机器学习中的校准，为什么我们需要校准，如何执行校准以及理解概率模型。<em class="jn">让我们开始吧，</em></p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="26b3" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ja kg kh ki je kj kk kl ji km kn ko kp bi translated">什么是概率模型？</h2><p id="c746" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">在机器学习中，分类模型是预测类别标签的预测模型。然而，一些分类模型不直接预测类别，而是预测概率；例如，逻辑回归。这种分类模型被称为概率分类模型。</p><h2 id="5b85" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ja kg kh ki je kj kk kl ji km kn ko kp bi translated">为什么要校准？</h2><p id="a3d7" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">在了解我们为什么需要校准之前，让我们来探索一下<strong class="ir hi">在机器学习</strong>的背景下校准意味着什么。</p><blockquote class="kv kw kx"><p id="6b25" class="ip iq jn ir b is it iu iv iw ix iy iz ky jb jc jd kz jf jg jh la jj jk jl jm ha bi translated">如果机器学习模型产生校准的概率，则它是校准的，其中置信度为“p”的类的预测在100 * p的时间内是正确的</p></blockquote><p id="e954" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">考虑一个例子。一个天气预报模型预测下雨的可能性为40%。在所有的日子里，预测概率是40%，实际上下了多少天的雨？？如果下雨的时间多于或少于这些天的40%,那么模型没有很好地校准。</p><p id="b167" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们已经了解了校准，让我们深入了解一下我们为什么需要校准。</p><p id="3090" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">考虑一个场景，其中机器学习模型预测疾病的几率，医生基于预测的置信度，需要决定进一步的诊断。如果模型以90%的概率(置信度)预测输出，但只有70%的概率是正确的，那么这种置信度可靠吗？？</p><p id="73ae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">答案是绝对不行！！</p><p id="cce7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们考虑另一个场景，模型预测哪个广告被点击的几率最高。在这种情况下，我们只关心广告的相对概率，而不太依赖置信度。</p><blockquote class="kv kw kx"><p id="00e3" class="ip iq jn ir b is it iu iv iw ix iy iz ky jb jc jd kz jf jg jh la jj jk jl jm ha bi translated"><strong class="ir hi">因此，在需要根据预测的置信度来解释预测概率的情况下，校准是必要的</strong></p></blockquote><p id="0dc5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jn">“在机器学习中，校准通常是一个被忽视的概念。一个模型是否被校准，取决于它的内在属性。例如，逻辑回归实际上不需要任何额外的训练后校准，因为它使用了损失函数。另一方面，随机森林由于其打包(平均)方法，很少返回值接近0或1，并且需要校准。</em></p><p id="ede1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jn">一般来说，概率模型往往具有更好的内在校准"</em></p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><p id="b67c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">既然我们意识到了校准模型的重要性，那就让我们了解一下校准模型的方法。</p><h2 id="0aaf" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ja kg kh ki je kj kk kl ji km kn ko kp bi translated">如何校准？</h2><p id="857f" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">检查模型校准的最常见方法是创建校准图。</p><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/f1a7bbb4c7d8e1cef7634ded67b55d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*VgGMzOYERBF9khA4kUkdNw.png"/></div><figcaption class="il im et er es in io bd b be z dx">calibration plot</figcaption></figure><p id="c99d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">校准预测概率有两种主要技术</p><ul class=""><li id="5d25" class="lg lh hh ir b is it iw ix ja li je lj ji lk jm ll lm ln lo bi translated">普拉特标度</li><li id="d47b" class="lg lh hh ir b is lp iw lq ja lr je ls ji lt jm ll lm ln lo bi translated">保序回归</li></ul><p id="36a0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们详细学习这两种技术</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><h2 id="f442" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ja kg kh ki je kj kk kl ji km kn ko kp bi translated">普拉特标度</h2><p id="2590" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">它使用基于预测概率的逻辑回归模型。它假设校准曲线是S形的。拟合回归线是预测概率到校准概率的直接映射。</p><h2 id="b1a9" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ja kg kh ki je kj kk kl ji km kn ko kp bi translated">保序回归</h2><p id="e53c" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">它使用加权最小二乘回归模型。“等渗”只是指原始概率到重新标度值的单调递增映射。使用保序回归优于普拉特标度的主要优点是，它不需要假设曲线是S形的。然而，保序回归对异常值很敏感。</p><blockquote class="kv kw kx"><p id="c976" class="ip iq jn ir b is it iu iv iw ix iy iz ky jb jc jd kz jf jg jh la jj jk jl jm ha bi translated">scikit-learn库通过'<strong class="ir hi"> CalibratedClassifierCV </strong>'模块提供对普氏定标和等渗回归方法的访问。需要声明模块的'<em class="hh">方法</em>参数:Platt 的'<em class="hh"> sigmoid '和等张</em>的<em class="hh">'等张'。[要了解更多信息，请参考<a class="ae lu" href="https://scikit-learn.org/stable/modules/generated/sklearn.calibration.CalibratedClassifierCV.html" rel="noopener ugc nofollow" target="_blank">链接</a></em></p></blockquote><div class="lv lw ez fb lx ly"><a href="https://neptune.ai/blog/brier-score-and-model-calibration" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hi fi z dy md ea eb me ed ef hg bi translated">Brier Score:了解模型校准- neptune.ai</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">当你的天气应用程序中下雨的概率低于10%时，你是否遇到过风暴？嗯，这很好地显示了…</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">海王星. ai</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ij ly"/></div></div></a></div><h2 id="0787" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ja kg kh ki je kj kk kl ji km kn ko kp bi translated">结论</h2><p id="5e9d" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">我们现在已经了解了校准的含义以及为什么需要校准。此外，我们还介绍了机器学习中两种主要的校准方法。</p><p id="653f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请记住，校准确实会影响精度(有时会导致性能下降)。例如，考虑非常接近决策边界的值，现在校准可能会将这些点推到影响性能的任何一侧。</p><p id="a8a2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">校准的目的是得到一个更合理的概率结果，我相信你喜欢学习这个美丽的概念。</p><p id="db7a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">请务必传播❤，并关注<a class="ae lu" href="https://youtu.be/8qAeUe5oY7k" rel="noopener ugc nofollow" target="_blank"> datahat </a>以获取关于数据科学的视频和概念。</p><p id="8cc4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jn">谢谢！！不断学习，不断成长，帮助其他数据科学爱好者…..</em>T15】</strong></p><div class="lv lw ez fb lx ly"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hi fi z dy md ea eb me ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">medium.com</p></div></div><div class="mh l"><div class="mn l mj mk ml mh mm ij ly"/></div></div></a></div></div></div>    
</body>
</html>