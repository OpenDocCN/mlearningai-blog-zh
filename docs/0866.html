<html>
<head>
<title>Face Mask Detection using Computer Vision.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用计算机视觉检测人脸面具。</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/face-mask-detection-using-computer-vision-d4aa4ad8cacd?source=collection_archive---------3-----------------------#2021-08-08">https://medium.com/mlearning-ai/face-mask-detection-using-computer-vision-d4aa4ad8cacd?source=collection_archive---------3-----------------------#2021-08-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/b1420f080a5a8c82cb8eac100d668daf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*WFX6ibT3VLrplrGPKk3XJw.jpeg"/></div></figure><h1 id="e867" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated"><strong class="ak">简介:</strong></h1><p id="ed4b" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">在新冠肺炎的情况下，有必要在公共场合戴口罩，以避免感染。在这里，我们建立了一个计算机视觉模型，可以检测人是否戴面具。<br/> <strong class="jl hi">在继续之前，我要感谢</strong><a class="kh ki ge" href="https://medium.com/u/c7c98846a04f?source=post_page-----d4aa4ad8cacd--------------------------------" rel="noopener" target="_blank"><strong class="jl hi">Rahul Arora</strong></a><strong class="jl hi">与我在这方面的合作。</strong></p><h1 id="a002" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">数据集集合:</h1><p id="e5aa" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">在这种情况下，我们在我们的数据集上建立了模型，其中有<strong class="jl hi"> 331个训练图像</strong>和<strong class="jl hi"> 17个测试图像</strong>，带有<strong class="jl hi">标签屏蔽，无屏蔽</strong></p><div class="kj kk kl km fd ab cb"><figure class="kn ii ko kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/d0aa58de20f2ee0bb824e234dda3aeb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*iFp2d_lMQtxh4Zir4B1jIQ.jpeg"/></div></figure><figure class="kn ii ko kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/f2e7564c627add6c35151ec3135bfa66.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8BvCx40S_apHBwQ6kH-JRQ.jpeg"/></div></figure><figure class="kn ii ko kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/a266e1245eb02ed5982e5b0ac6ffea05.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*UPGq-6EWhcWBIvKH4PRTVQ.jpeg"/></div></figure></div><div class="ab cb"><figure class="kn ii kx kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/0de647df811b502229aa4f35bb366440.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*nGs4SrI-gT9MVIYQngu9Sw.jpeg"/></div></figure><figure class="kn ii kx kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/79a1d52eac715236446adf0fb9e3c057.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*jQBELbP3ZvwLXJTNH0Jjgw.jpeg"/></div></figure><figure class="kn ii ky kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/5291fc82e175c5ab78503b105aa87f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*HlXZ28KKEGGCYTiVYyufow.jpeg"/></div><figcaption class="kz la et er es lb lc bd b be z dx ld di le lf"><strong class="bd in">Images With and Without Mask</strong></figcaption></figure></div><h1 id="917e" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated"><strong class="ak">数据标注:</strong></h1><p id="fcbf" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">使用<a class="ae lg" href="https://www.makesense.ai/" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hi"> MakeSense对图像进行了注释。艾</strong> </a>。这是一个开源网站，可以帮助你注释图片，并根据我们的选择下载任何格式的图片。<br/>这里已经用两种方式做了注解:<br/> 1。英寸xml格式，我们有<strong class="jl hi"> X-min，X-max，Y-min，Y-max坐标</strong></p><figure class="kj kk kl km fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/958f20959bdff60b6a1d6931b31ef399.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*kldAM2XgfSRpdgBwvyHVzA.png"/></div></figure><p id="cfb0" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">2.英寸txt格式它包含<strong class="jl hi">对象类、对象坐标、图像宽度、图像高度</strong></p><figure class="kj kk kl km fd ii er es paragraph-image"><div class="er es ln"><img src="../Images/4b59d4968ca0bac4d8274073899615d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*Cg_SCT2Me3G5W3wLfqhdOg.png"/></div></figure><h1 id="5320" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">数据准备和建模:</h1><p id="e66d" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">由于这里我们使用了两种不同的模型，数据准备以两种不同的方式完成。这里我们不会包括所有使用的库或python代码，因为这会使这篇博客太冗长。参考资料将在参考资料部分提供。</p><h2 id="574d" class="lo im hh bd in lp lq lr ir ls lt lu iv ju lv lw iz jy lx ly jd kc lz ma jh mb bi translated">1.采用预训练SSD Resnet的Tensorflow对象检测:</h2><p id="61d0" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">我们必须创造。来自xml的csv文件。</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="37f2" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">之后，我们需要分别创建训练和测试tf记录。</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="12c5" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">我们已经为<strong class="jl hi"> 10000步</strong>训练了我们的模型。这是我们损失的最后几步</p><figure class="kj kk kl km fd ii er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es me"><img src="../Images/dfbe73033899fab1e041039d9e6d99d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lgRarf29kYX2BMYSGgie3A.png"/></div></div></figure><p id="3a93" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">正如我们从上面看到的总损失太大了，所以我们不期望这个模型正常工作。<br/>对于模型的<strong class="jl hi">推理，我们提供了如下要点。</strong></p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="2930" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">让我们看看我们的模型表现如何。</p><div class="kj kk kl km fd ab cb"><figure class="kn ii mf kp kq kr ks paragraph-image"><img src="../Images/e4cb53e4d4551d5e40aa675c5a2b9e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*6sNLHZH6FmDwp-lUHJJCiw.png"/></figure><figure class="kn ii mg kp kq kr ks paragraph-image"><img src="../Images/84202eb1945d51a96908932f6c1ef30d.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*2PLy7jlCNpv7Cua8YXEEnw.png"/></figure></div><p id="9b6b" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">从上面，我们可以清楚地看到，我们的模型表现得不够好。要么需要对更多的步骤进行训练，要么需要使用更好的模型，但对于少数最终步骤，损失没有减少太多，这可能是我们已经达到了饱和点。我们需要使用更好的模型。</p><h2 id="c31e" class="lo im hh bd in lp lq lr ir ls lt lu iv ju lv lw iz jy lx ly jd kc lz ma jh mb bi translated">2.YoloV5s:</h2><p id="6000" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">这里我们将使用。用于训练模型的txt文件批注。yolo v5有不同的版本。我们已经初步使用Yolo v5s版本来检查模型的性能。我们只会发布需要修改的片段。</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="13ea" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">在训练模型之前，确保您的文件结构如下所示:</p><div class="kj kk kl km fd ab cb"><figure class="kn ii mh kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/6cd9a3995af57b23c6440a5250c6127d.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*pZWErjTu5HnFd65Wc58zCA.png"/></div></figure><figure class="kn ii mi kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/a79e17f711f830b9d4e65f1ad9fdd66e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*2V4PD53QBdCcRNhPImO18g.png"/></div></figure></div><p id="5e64" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">确保图像、标签文件名大小写完全一致，否则会抛出错误。<br/>现在我们将为<strong class="jl hi"> 200个时代</strong>训练我们的模型，而<strong class="jl hi">的批量为80个</strong>。对于最后的几个时代，这就是我们损失的样子。</p><figure class="kj kk kl km fd ii er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es mj"><img src="../Images/d57ef58f6824741c19d383b648afde9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2yEa_PRQnHp2ld6GPoNHg.png"/></div></div></figure><p id="5b68" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">让我们来看看我们的模型表现如何:</p><div class="kj kk kl km fd ab cb"><figure class="kn ii mk kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/29a542413f5339f5cd7e1cdae46a22dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*5H-ePYwf9RVG9U_cpx2zXg.jpeg"/></div></figure><figure class="kn ii mk kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/e05e2c181e887fd440e4d498744f1439.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*1kVfU6M7LRoVfacjWR4xUQ.jpeg"/></div></figure><figure class="kn ii ml kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/167c48ae7082ba7a56e01885748721b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*bRb10ZfiWVmbT7igoZpNnA.jpeg"/></div></figure></div><p id="8a07" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">我们可以看到我们的模型表现良好。让我们看看情节是怎样的:</p><figure class="kj kk kl km fd ii er es paragraph-image"><div class="er es mm"><img src="../Images/9ff67269f3bb5737c2a4415559dad6a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*N0cLEHoYDoHa3EJmoJ1wOw.png"/></div></figure><p id="980e" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">从上面我们可以观察到我们的模型一点也没有过度拟合。</p><h1 id="6c93" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">参考链接:</h1><ol class=""><li id="d2b1" class="mn mo hh jl b jm jn jq jr ju mp jy mq kc mr kg ms mt mu mv bi translated"><strong class="jl hi">张量流对象检测</strong>:<br/><a class="ae lg" href="https://www.youtube.com/watch?v=XoMiveY_1Z4" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=XoMiveY_1Z4</a></li><li id="3369" class="mn mo hh jl b jm mw jq mx ju my jy mz kc na kg ms mt mu mv bi translated"><strong class="jl hi">Yolo:</strong><a class="ae lg" href="https://colab.research.google.com/drive/16QCaYzTuHCOF9CQLQYmGNxmtY1xKAIdn?usp=sharing#scrollTo=dOrWg4mthaji" rel="noopener ugc nofollow" target="_blank">https://colab . research . Google . com/drive/16 qcayztuhcof 9 cqiqymgnxmty 1 xkaidn？USP = sharing # scroll to = dorw G4 mthaji</a></li></ol><h1 id="7c9b" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">Github资源库:</h1><div class="nb nc ez fb nd ne"><a href="https://github.com/Nipun-1997/Face-Mask-Detection" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab dw"><div class="ng ab nh cl cj ni"><h2 class="bd hi fi z dy nj ea eb nk ed ef hg bi translated">GitHub-ni pun-1997/面罩-检测</h2><div class="nl l"><h3 class="bd b fi z dy nj ea eb nk ed ef dx translated">在GitHub上创建一个帐户，为ni pun-1997/面罩检测开发做出贡献。</h3></div><div class="nm l"><p class="bd b fp z dy nj ea eb nk ed ef dx translated">github.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns ij ne"/></div></div></a></div><p id="6768" class="pw-post-body-paragraph jj jk hh jl b jm li jo jp jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ha bi translated">这里是我们的linkedin个人资料。尼普·阿格拉瓦尔<a class="ae lg" href="https://www.linkedin.com/in/nipun-agrawal-200597110/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/nipun-agrawal-200597110/</a>2。拉胡尔·阿罗拉<a class="ae lg" href="https://www.linkedin.com/in/rahul-arora-461a19125/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/rahul-arora-461a19125/</a></p></div></div>    
</body>
</html>