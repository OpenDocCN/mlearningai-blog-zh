<html>
<head>
<title>Create new features for NLP with Named Entity Recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过命名实体识别为NLP创建新功能</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/create-new-features-for-nlp-with-named-entity-recognition-62d1804d9f21?source=collection_archive---------2-----------------------#2022-07-04">https://medium.com/mlearning-ai/create-new-features-for-nlp-with-named-entity-recognition-62d1804d9f21?source=collection_archive---------2-----------------------#2022-07-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/3f9871b762be1666ffccfe238b71a938.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhA3QPUXVdSf_gRgJ-HXxQ.png"/></div></div></figure><h1 id="3dd9" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">什么是NLP？</h1><p id="76fb" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi kl translated">自然语言处理(NLP)的目标是让计算机像人类一样理解文本和口语。</p><p id="35ac" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">NLP将统计、机器学习和深度学习模型应用于大型文本数据，以理解演讲者或作者的意图和情感。</p><p id="eab6" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">通常，NLP模型的输入数据是关于文本中的单词。无论如何，我们可以添加更多的特征，使模型更加准确。</p><h1 id="eca4" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">什么是命名实体识别(NER)？</h1><p id="6fc9" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">命名实体识别(NER)(也称为(命名)实体识别、实体分块和实体提取)是信息提取的一个子任务，它试图定位非结构化文本中提到的命名实体并将其分类到预定义的类别中，例如人名、组织、位置、医疗代码、时间表达式、数量、货币值、百分比等。<br/>(来自<a class="ae kz" href="https://en.wikipedia.org/wiki/Named-entity_recognition" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Named-entity_recognition</a>)</p><p id="1186" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">我们可以使用NEM为NLP模型创建新的列，有时NEM的可视化甚至可以对文本类型进行分类。</p><h1 id="8961" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">了解空间</h1><p id="1ddf" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">spaCy是一个免费的开源Python库，用于Python中的自然语言处理。它具有NER、词性标注、依存解析、词向量等功能。</p><p id="08f1" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">在这篇文章中，我将一步一步地向你展示如何使用spaCy库执行NEM。</p><p id="db7e" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">您可以在这里看到所有支持的语言和该语言的型号<a class="ae kz" href="https://spacy.io/models" rel="noopener ugc nofollow" target="_blank"/>。</p></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h1 id="cad9" class="ip iq hh bd ir is lh iu iv iw li iy iz ja lj jc jd je lk jg jh ji ll jk jl jm bi translated">步骤摘要</h1><ol class=""><li id="1dee" class="lm ln hh jp b jq jr ju jv jy lo kc lp kg lq kk lr ls lt lu bi translated">安装和导入库</li><li id="2b4d" class="lm ln hh jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">加载NER模型</li><li id="9c49" class="lm ln hh jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">创建标签列表栏</li><li id="0c5a" class="lm ln hh jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">创建新功能</li></ol><h1 id="bfeb" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">1.安装和导入库</h1><ul class=""><li id="00a0" class="lm ln hh jp b jq jr ju jv jy lo kc lp kg lq kk ma ls lt lu bi translated">打开Anaconda提示符</li></ul><p id="8d9c" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">搜索Anaconda提示符，点击打开。</p><figure class="mc md me mf fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/19cb4d6ade8112009a93b25fdec9e47d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*1s9Qobi-Nwj5FHxDwbSV7A.png"/></div></figure><p id="c728" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">你会看到一个黑屏弹出。</p><figure class="mc md me mf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/76f21ac9d3e70753f63509ede8fa47da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9di4tqkz_q4-o0TSuZspCQ.png"/></div></div></figure><ul class=""><li id="8a8a" class="lm ln hh jp b jq ku ju kv jy mh kc mi kg mj kk ma ls lt lu bi translated">通过在Anaconda提示符下键入以下命令来安装spaCy库</li></ul><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="397d" class="mp iq hh ml b fi mq mr l ms mt">pip install spacy</span></pre><ul class=""><li id="fa8f" class="lm ln hh jp b jq ku ju kv jy mh kc mi kg mj kk ma ls lt lu bi translated">下载预先训练好的NER模型</li></ul><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="2724" class="mp iq hh ml b fi mq mr l ms mt">python -m spacy download en_core_web_sm</span></pre><ul class=""><li id="44a8" class="lm ln hh jp b jq ku ju kv jy mh kc mi kg mj kk ma ls lt lu bi translated">在Python中导入所需的库</li></ul><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="a64a" class="mp iq hh ml b fi mq mr l ms mt">import spacy<br/>import pandas as pd</span></pre><ul class=""><li id="9bfd" class="lm ln hh jp b jq ku ju kv jy mh kc mi kg mj kk ma ls lt lu bi translated">加载数据集</li></ul><p id="ca1e" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">您可以下载新闻标题数据集作为示例。</p><div class="mu mv ez fb mw mx"><a href="https://www.kaggle.com/datasets/therohk/million-headlines/download" rel="noopener  ugc nofollow" target="_blank"><div class="my ab dw"><div class="mz ab na cl cj nb"><h2 class="bd hi fi z dy nc ea eb nd ed ef hg bi translated">你的数据科学之家</h2><div class="ne l"><h3 class="bd b fi z dy nc ea eb nd ed ef dx translated">Kaggle是世界上最大的数据科学社区，拥有强大的工具和资源来帮助您实现您的数据…</h3></div><div class="nf l"><p class="bd b fp z dy nc ea eb nd ed ef dx translated">www.kaggle.com</p></div></div></div></a></div><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="ab14" class="mp iq hh ml b fi mq mr l ms mt">df =pd.read_csv("abcnews-date-text.csv")<br/>df = df[:10] # Use only 10 samples to reduce computation time</span></pre><h1 id="d62c" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">2.加载NER模型</h1><ul class=""><li id="7dba" class="lm ln hh jp b jq jr ju jv jy lo kc lp kg lq kk ma ls lt lu bi translated">使用spacy.load加载预训练的NER模型。(确保您已经在步骤1中下载了该模型)</li></ul><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="c6cc" class="mp iq hh ml b fi mq mr l ms mt">ner = spacy.load("en_core_web_sm")</span></pre><blockquote class="ng nh ni"><p id="2364" class="jn jo nj jp b jq ku js jt ju kv jw jx nk kw ka kb nl kx ke kf nm ky ki kj kk ha bi translated">这就是如何实现加载的模型。</p></blockquote><ul class=""><li id="540a" class="lm ln hh jp b jq ku ju kv jy mh kc mi kg mj kk ma ls lt lu bi translated">用文本拟合模型</li></ul><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="e08f" class="mp iq hh ml b fi mq mr l ms mt">doc = ner(df['headline_text'][9])</span></pre><p id="c774" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">doc是一个空间标记。你可以调用它的属性。</p><ul class=""><li id="32bc" class="lm ln hh jp b jq ku ju kv jy mh kc mi kg mj kk ma ls lt lu bi translated">显示</li></ul><p id="c9aa" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">在文档中循环单词。</p><p id="3e08" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated"><strong class="jp hi">。正文</strong>将返回word</p><p id="5e06" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated"><strong class="jp hi">。pos_ </strong>将返回单词的词性</p><p id="396f" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated"><strong class="jp hi">。ent_type_ </strong>将返回单词的命名实体</p><p id="228c" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">从“澳大利亚被锁定在战争时间表opp”的例子，你会看到该模型可以检测澳大利亚作为GPE(地缘政治实体)。</p><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="c34c" class="mp iq hh ml b fi mq mr l ms mt">print("Text is: "+doc.text+"\n")<br/>for token in doc:<br/>    print(token.text+"\t"+token.pos_+"\t"+token.ent_type_)</span></pre><figure class="mc md me mf fd ii er es paragraph-image"><div class="er es nn"><img src="../Images/171f9f128d8997cdc7ee7e80e0c612a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*XvettT86WKPdJFLqnyA8Xg.png"/></div></figure><p id="4242" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">spaCy有一个很有用的显示工具，<strong class="jp hi"> displacy </strong>，可以很漂亮的可视化命名实体。</p><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="8c87" class="mp iq hh ml b fi mq mr l ms mt">spacy.displacy.render(doc, style="ent")</span></pre><figure class="mc md me mf fd ii er es paragraph-image"><div class="er es no"><img src="../Images/53ed023e13f58bfb0b80185034a4bfda.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*9Yl7Lc0GLgV6Yce8QHUOmg.png"/></div></figure><p id="59b3" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">所有NER的名单可以通过<strong class="jp hi">得到。管道标签</strong>和每个NER的解释被<strong class="jp hi">知晓。解释一下</strong>。</p><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="5766" class="mp iq hh ml b fi mq mr l ms mt">ner_list = ner.pipe_labels['ner']</span><span id="6619" class="mp iq hh ml b fi np mr l ms mt">print("Number of NER: "+str(len(ner_list)))<br/>for i in range(len(ner_list)):<br/>    print(ner_list[i]+" : "+spacy.explain(ner_list[i]))</span></pre><figure class="mc md me mf fd ii er es paragraph-image"><div class="er es nq"><img src="../Images/f03d1af09c400bb9c8432c474018302a.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*4YWs7kHCaMM_oRoZ9qYX5w.png"/></div></figure><p id="e60f" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">如上所示有18个ner。</p><h1 id="4e7d" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">3.创建标签列表栏</h1><p id="f9e8" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">首先，创建一个函数add_tag_column，当输入文本时，它将返回一个标签出现次数的字典。</p><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="ee3a" class="mp iq hh ml b fi mq mr l ms mt">def add_tag_column(text):<br/>    doc = ner(text)<br/>    tag_dict = dict.fromkeys(ner_list,0) # empty column<br/>    for token in doc:<br/>        if token.ent_type_ != "":    <br/>            tag_dict[token.ent_type_] +=1<br/>    return tag_dict</span></pre><p id="85f6" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">将add_tag_column函数应用于数据帧中的所有行。标签列表结果将临时存储在标签列中。</p><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="f946" class="mp iq hh ml b fi mq mr l ms mt">df["tag"] = df["headline_text"].apply(add_tag_column)</span></pre><figure class="mc md me mf fd ii er es paragraph-image"><div class="er es nr"><img src="../Images/8e8c4507417349ce15075aa79837eae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*r-KpG-Z_f5WyhAzm5yfQMA.png"/></div></figure><h1 id="8a34" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ak"> 4。创建新功能</strong></h1><p id="acd8" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">创建新列tag_NER，它是文本中每个NER出现的次数。</p><pre class="mc md me mf fd mk ml mm mn aw mo bi"><span id="9861" class="mp iq hh ml b fi mq mr l ms mt">for tag in ner_list:<br/>    df["tag_"+tag] = df['tag'].apply(lambda count: count[tag])</span></pre><figure class="mc md me mf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ns"><img src="../Images/61a2ce4a44b95036824b5b2d0e9c1dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vnTE3124e06Wf9j23gQo7A.png"/></div></div></figure><p id="d358" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">您可以使用这些列来定型NLP模型。</p><p id="74ee" class="pw-post-body-paragraph jn jo hh jp b jq ku js jt ju kv jw jx jy kw ka kb kc kx ke kf kg ky ki kj kk ha bi translated">如果您觉得这篇文章有帮助，请关注我以获得更多关于数据科学的文章。</p><div class="mu mv ez fb mw mx"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="my ab dw"><div class="mz ab na cl cj nb"><h2 class="bd hi fi z dy nc ea eb nd ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ne l"><h3 class="bd b fi z dy nc ea eb nd ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nf l"><p class="bd b fp z dy nc ea eb nd ed ef dx translated">medium.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny in mx"/></div></div></a></div></div></div>    
</body>
</html>