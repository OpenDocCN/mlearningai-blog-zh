<html>
<head>
<title>Recommendation Systems: Collaborative Filtering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐系统:协同过滤</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/recommendation-systems-collaborative-filtering-75121f19dd03?source=collection_archive---------1-----------------------#2022-12-14">https://medium.com/mlearning-ai/recommendation-systems-collaborative-filtering-75121f19dd03?source=collection_archive---------1-----------------------#2022-12-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/e8108e328709fa45b35e1c92d6b23879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rG3xR2ELqwzR4hvRuH16pQ.jpeg"/></div></div></figure><p id="bb00" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文中，我将讨论协同过滤，这是推荐系统的第三个也是最后一个标题。您可以通过以下链接找到我写的关于推荐系统的前两篇文章，它们是关联规则学习和基于内容的过滤:</p><div class="jn jo ez fb jp jq"><a rel="noopener follow" target="_blank" href="/mlearning-ai/recommendation-systems-arl-association-rule-learning-bed1a07b5d9a"><div class="jr ab dw"><div class="js ab jt cl cj ju"><h2 class="bd hi fi z dy jv ea eb jw ed ef hg bi translated">推荐系统:ARL(关联规则学习)</h2><div class="jx l"><h3 class="bd b fi z dy jv ea eb jw ed ef dx translated">推荐系统旨在使用一些方法和算法向用户推荐内容、产品和服务</h3></div><div class="jy l"><p class="bd b fp z dy jv ea eb jw ed ef dx translated">medium.com</p></div></div><div class="jz l"><div class="ka l kb kc kd jz ke in jq"/></div></div></a></div><div class="jn jo ez fb jp jq"><a rel="noopener follow" target="_blank" href="/mlearning-ai/recommendation-systems-content-based-filtering-e19e3b0a309e"><div class="jr ab dw"><div class="js ab jt cl cj ju"><h2 class="bd hi fi z dy jv ea eb jw ed ef hg bi translated">推荐系统:基于内容的过滤</h2><div class="jx l"><h3 class="bd b fi z dy jv ea eb jw ed ef dx translated">基于内容的过滤是用作推荐系统的方法之一。相似性是通过…</h3></div><div class="jy l"><p class="bd b fp z dy jv ea eb jw ed ef dx translated">medium.com</p></div></div><div class="jz l"><div class="kf l kb kc kd jz ke in jq"/></div></div></a></div><p id="c95d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">协同过滤是一种利用用户和产品之间的相似性来提供建议的方法。协同过滤分析相似的用户或相似评级的产品，并基于该分析推荐用户。</p><p id="e503" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">协同过滤分为3个子标题:</p><ol class=""><li id="c084" class="kg kh hh ir b is it iw ix ja ki je kj ji kk jm kl km kn ko bi translated">基于项目的协同过滤</li><li id="7f04" class="kg kh hh ir b is kp iw kq ja kr je ks ji kt jm kl km kn ko bi translated">基于用户的协同过滤</li><li id="8ccf" class="kg kh hh ir b is kp iw kq ja kr je ks ji kt jm kl km kn ko bi translated">基于模型的协同过滤</li></ol></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="3f54" class="lb lc hh bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">基于项目的协同过滤</h1><p id="a29e" class="pw-post-body-paragraph ip iq hh ir b is lz iu iv iw ma iy iz ja mb jc jd je mc jg jh ji md jk jl jm ha bi translated">它是一种分析产品相似性或用户对产品的评价，并根据分析结果提出建议的方法。</p><p id="8460" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下表是m个用户给n部电影的评分。我们想向观看过《分裂》并喜欢它的用户推荐一部与《分裂》评分相似的电影。</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es me"><img src="../Images/38f225f736ce614f679bcc11476ef626.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*n7POjBHSQ6cLsz9Cd0wiGA.png"/></div></figure><p id="0959" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这种情况下，可以为该用户推荐电影4，该电影是与Split具有相似取向(同时喜欢和不喜欢)的电影。</p><h2 id="2e79" class="mj lc hh bd ld mk ml mm lh mn mo mp ll ja mq mr lp je ms mt lt ji mu mv lx mw bi translated">项目:</h2><p id="c3a9" class="pw-post-body-paragraph ip iq hh ir b is lz iu iv iw ma iy iz ja mb jc jd je mc jg jh ji md jk jl jm ha bi translated">某在线电影平台想开发一个协同过滤的推荐系统。希望以适应机构群体意见的方式提出建议。当用户喜欢一部电影时，与该电影具有相似喜欢模式的其他电影被请求推荐。</p><p id="2645" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">关于数据集:</strong></p><p id="8740" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">电影:</p><ul class=""><li id="572c" class="kg kh hh ir b is it iw ix ja ki je kj ji kk jm mx km kn ko bi translated">电影Id:电影的id</li><li id="5ac5" class="kg kh hh ir b is kp iw kq ja kr je ks ji kt jm mx km kn ko bi translated">标题:电影的标题</li></ul><p id="d03a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">评级:</p><ul class=""><li id="4139" class="kg kh hh ir b is it iw ix ja ki je kj ji kk jm mx km kn ko bi translated">userId:用户的Id</li><li id="973e" class="kg kh hh ir b is kp iw kq ja kr je ks ji kt jm mx km kn ko bi translated">电影Id:电影的id</li><li id="e8aa" class="kg kh hh ir b is kp iw kq ja kr je ks ji kt jm mx km kn ko bi translated">分级:用户对电影的分级</li><li id="76f7" class="kg kh hh ir b is kp iw kq ja kr je ks ji kt jm mx km kn ko bi translated">时间戳:评级的时间戳</li></ul><p id="1ae8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以在这里找到数据集<a class="ae my" href="https://grouplens.org/datasets/movielens/20m/" rel="noopener ugc nofollow" target="_blank"/>。对于这个项目，我们将合并“电影”和“电影评级”数据集。</p><p id="343e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在项目开始时，数据集被读取和合并。你可以查看<a class="ae my" href="https://github.com/zbeyza/collaborative_filtering/blob/main/item_based_collaborative_filtering.py" rel="noopener ugc nofollow" target="_blank">项目的完整代码。</a></p><p id="7f2f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">创建用户电影数据帧:</strong></p><p id="cde4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这一步，我们将创建用户电影数据帧，但我们不希望它稀疏。例如，假设一个用户只评价了一部电影。即使对一部电影进行了分级，该用户也将在用户电影数据帧中的所有其他电影中各占据一个单元。这会延迟要进行的计算，并导致性能问题。为了避免这些计算问题，并防止极少数用户观看的电影被包括在推荐中，应该进行一些缩减过程。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="15f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">完成归约过程后，将创建一个数据透视表，其中行中包含“userId”，列中包含“title”，交叉点中包含“rating”。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="34d2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在“用户-电影”数据框中，如果用户尚未对电影进行评级，则其交叉点处的单元格由NaN表示。</p><p id="c4ab" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">基于项目的电影预测:</strong></p><p id="ae20" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为已经创建了用户电影矩阵，所以可以通过查看电影和其他电影之间的相关性来发现它们之间的相似性。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="12cc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">随机选择电影后，计算这部电影与其他电影的相关性。可以推荐具有高相关性的电影，这意味着表现出与该电影相似行为的电影已经被推荐。</p><p id="c209" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">电影也可以手动选择和检查。您可以使用下面的代码片段通过关键字进行搜索，以获得数据集中电影的全名。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="90bc" class="lb lc hh bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">基于用户的协同过滤</h1><p id="a611" class="pw-post-body-paragraph ip iq hh ir b is lz iu iv iw ma iy iz ja mb jc jd je mc jg jh ji md jk jl jm ha bi translated">这是一种分析用户行为(喜好)并根据表现出类似行为的用户喜好提供建议的方法。</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/e04abe540f4992be66ec84ef997256f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*GZ4hrolQRGde2PzCkdNImw.png"/></div></figure><p id="910d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">表格显示了m个用户给n部电影的评分。用户没有观看的电影的分级是空白的。希望建议一部与用户3相似的他可能喜欢的电影。为此，首先，应该找到表现出类似行为的用户。可以看出，在用户3评价的电影中表现出类似行为的用户是用户2，并且选择推荐用户2喜欢但用户3没有观看的电影3。作为该建议的结果，预期用户3会喜欢这部电影。</p><h2 id="7b97" class="mj lc hh bd ld mk ml mm lh mn mo mp ll ja mq mr lp je ms mt lt ji mu mv lx mw bi translated">项目:</h2><p id="7074" class="pw-post-body-paragraph ip iq hh ir b is lz iu iv iw ma iy iz ja mb jc jd je mc jg jh ji md jk jl jm ha bi translated">在这个项目中，将使用基于项目的协同过滤中使用的相同数据集。将在基于项目的项目中创建的用户电影数据帧上执行操作。这是项目的<a class="ae my" href="https://github.com/zbeyza/collaborative_filtering/blob/main/user_based_collaborative_filtering.py" rel="noopener ugc nofollow" target="_blank">完整代码，用于检查数据集的处理过程并创建数据框。</a></p><p id="b5b1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">确定用户观看的待推荐电影:</strong></p><p id="fd78" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">用户是随机选择的。在该选择之后，应该为该用户减少使用电影数据帧。这样就可以确定这个用户看的电影。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="77f3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">到了<code class="du nc nd ne nf b">len(movies_watched)</code>，发现random_user看了33部电影。</p><p id="4d91" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">访问观看相同电影的其他用户:</strong></p><p id="a463" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这一步，我们首先需要找出有多少电影是其他用户与随机用户共同观看的。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="df1e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这一点上，我们需要一个限制，因为一个只看过1或2部与random_user共同电影的用户不会成为推荐过程的一个标准。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="34a3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">识别与待推荐用户行为最相似的用户</strong></p><p id="2eb3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这将分3步完成:</p><p id="2008" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">步骤1:汇总random_user和其他用户的数据</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="7268" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">步骤2:创建相关性数据框</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="9bb8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">步骤3:寻找最相似的用户(顶级用户)</p><p id="2962" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在前一阶段中找到的值是所有用户的相关值。目的是接触到与random_user高度相关的用户。为此，选择相关性高于0.65的用户。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="2bad" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">计算加权平均推荐分数:</strong></p><p id="0d8f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果根据评级进行排序，相关性的影响将被忽略，如果根据相关性进行排序，评级的影响将被忽略。为了防止这种情况并同时看到两者的效果，将通过将这两个值相乘获得一个名为“weighted_rating”的新变量，并根据该变量进行排序。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="af76" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这样，考虑到相关性和评级，可以向用户做出类似上面的推荐。</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="af2f" class="lb lc hh bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">基于模型的协同过滤(矩阵分解)</h1><p id="acd8" class="pw-post-body-paragraph ip iq hh ir b is lz iu iv iw ma iy iz ja mb jc jd je mc jg jh ji md jk jl jm ha bi translated">在基于模型的协同过滤中，这个问题被更全面地处理。假设存在需要优化的问题。</p><p id="2e74" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">目标是预测并填充m个用户和n部电影的矩阵中标记为空白的单元格。</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ng"><img src="../Images/96b66e458184640d764887ba303922b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9e7oRudu2rklLfYZNGhN6Q.png"/></div></div></figure><p id="3b8c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了填补空白，假设存在于用户和电影的“潜在特征”的权重是在现有数据上找到的，并且用这些权重对不存在的观察进行预测。</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nh"><img src="../Images/664dead4c2100fdb9c82ff30e38a711e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uEZXXWMSIWNkLs23CuwoZw.png"/></div></div></figure><p id="8f7a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">用户电影矩阵被分解成2个更低维度的矩阵。假设从2矩阵到用户电影矩阵的转变伴随着潜在的因素发生。潜在因素的权重在填充的观察值上找到，空的观察值用找到的权重填充。</p><p id="5806" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了更清楚地理解这一过程，通过一个例子将是有用的。</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ni"><img src="../Images/d76c699117474837d8fb65deb69abcdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGfdeg7goiTxLhuyQcUTFg.png"/></div></div></figure><p id="54ec" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们有一个类似上面的用户电影矩阵，我们想在这里估计空值。首先，我们把它分成2个低维矩阵作为用户因子和电影因子。</p><p id="67f3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这一点上，潜在因素在已填充的观测值上的权重应该被发现如下:</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nj"><img src="../Images/488c8904f43e16ea7254b58e7aa514a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b8eoYFt8Th_NL0npbtcJJw.png"/></div></div></figure><figure class="mf mg mh mi fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nk"><img src="../Images/69a374ef496b8e9828d613cbbb3f2a7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rN6TWon0IzDwaF4B5I3LFA.png"/></div></div></figure><figure class="mf mg mh mi fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nl"><img src="../Images/94fd1bd4479cd4a30595a9192c06e5ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NePrltsTEaN_iKUorMHAmw.png"/></div></div></figure><p id="3d8e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所有p和q值都是在现有值上迭代找到的，然后使用。最初，它试图预测随机的p和q值以及评级矩阵中的值。在每次迭代中，安排错误的估计，并试图接近评级矩阵中的值。因此，作为特定迭代的结果，p和q矩阵被填充。</p><p id="26d7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要了解预测是好是坏，需要一个通用的衡量标准。为此，将所有估计值和实际值之间的差的平方相加，然后是平方根，然后是平均值(RMSE和MSE值)。这给了我们关于所有数据的信息。通过这种方式，我们获得了关于预测平均误差的信息，这是我们在研究开始时分配给用户和电影矩阵的值的结果。p和q值被更新以最小化该误差。</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nm"><img src="../Images/947e8109a89492a517f8465ce9037009.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hyLASpfKer56Ly70g0xYA.png"/></div></div></figure><p id="f4e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">矩阵分解的梯度下降:</strong></p><p id="a6df" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">找到p和q权重的一种方法是使用梯度下降法。梯度下降是一种用于函数最小化的优化方法。</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es nn"><img src="../Images/dcbd39774e15bcf41c95090289daeac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*FwYbn5CBUjXIXfAAgd1-4Q.png"/></div></figure><p id="aa20" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在“最陡下降”的方向上迭代地更新参数值，该方向被定义为梯度的负值，并且找到将给出相关函数的最小值的参数。</p><figure class="mf mg mh mi fd ii er es paragraph-image"><div class="er es no"><img src="../Images/79436fb10d0bfd2f7ea0b0cdbbba59dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*xqm84o51Dk1d4wq66eb6iw.png"/></div></figure><p id="530f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里，p和q矩阵中的权重基于导数交换。函数在某一点的导数给出了该函数增长的最大方向。当迭代地沿着定义为梯度的负值的方向进行时，即，与增加方向相反的方向，参数值被更新以最小化相关函数。</p><h2 id="1e17" class="mj lc hh bd ld mk ml mm lh mn mo mp ll ja mq mr lp je ms mt lt ji mu mv lx mw bi translated">项目:</h2><p id="e8a9" class="pw-post-body-paragraph ip iq hh ir b is lz iu iv iw ma iy iz ja mb jc jd je mc jg jh ji md jk jl jm ha bi translated">在协作过滤的最后一个项目中，将使用基于项目和基于用户的协作过滤中使用的相同数据集。这里是<a class="ae my" href="https://github.com/zbeyza/collaborative_filtering/blob/main/matrix_factorization.py" rel="noopener ugc nofollow" target="_blank">项目的完整代码</a>来检查数据集的过程。</p><p id="b4c0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">数据准备:</strong></p><p id="f434" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在可追溯性方面，我将根据4部电影及其id来缩减数据集，并从缩减的数据集创建用户电影数据帧。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="15b8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">既然惊喜库要用在这个项目中，而且它有它特殊的数据结构，movie_user_df就要转换成这个特殊的结构。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="ff1d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">造型:</strong></p><p id="4d33" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于建模步骤，首先数据应按照75%和25%的比例分为训练集和测试集。然后，应创建SVD的模型对象，并对车列执行fit操作。接下来，应该在测试集上测试模型。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="d64e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">可以优选RMSE度量来评估预测的平均误差。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="443c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">userId为1.0、movieId为541的手表单元的实际额定值如下。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="b4a7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当我们使用我们为相同观察单元建立的模型进行预测时，我们获得了4.33的评级:</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="1094" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">模型调整:</strong></p><p id="eeb3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这一步中，将对模型进行优化，即我们将努力增加模型的预测性能。这将通过超参数优化来实现。</p><p id="ec34" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">考虑到理论部分讨论的公式，超参数是时期、潜在因素、学习速率和λ。对于超参数优化，我们将如下定义历元和学习率的参数集。然后，通过用GridSearchCV尝试这些可能的参数集，为历元和学习率的组合计算平均误差，这将给出最低的可能平均误差。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="0b37" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">最终模型&amp;预测:</strong></p><p id="2389" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">模型的缺省值和我们用GridSearchCV找到的最优参数互不相同。因此，必须用这些最佳参数重新创建SVD模型对象。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="9a02" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">到目前为止，我们已经将数据分为训练集和测试集，检查错误并优化超参数。如果模型建立在更大的数据上，就可以进行更好的学习。因此，模型将建立在所有数据的基础上。</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="eea4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">建模步骤中userId-movieId对的预测过程:</p><figure class="mf mg mh mi fd ii"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="1799" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在建模步骤中，对于1.0的用户Id和541的电影Id的预测是4.33。在超参数优化之后，可以看到新的预测是4.23。在超参数优化之后，预测过程已经被执行以更接近实际值(4.00)，也就是说，误差已经减小。</p><p id="c0a4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">得到的优化模型提供了对期望的用户电影对进行预测的可能性。做出相关预测后，就可以过滤电影了。向那些用户推荐对某些用户具有高预测评级的电影。</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><p id="64ff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以从下面的GitHub链接中找到这三个项目的详细代码:</p><div class="jn jo ez fb jp jq"><a href="https://github.com/zbeyza/collaborative_filtering" rel="noopener  ugc nofollow" target="_blank"><div class="jr ab dw"><div class="js ab jt cl cj ju"><h2 class="bd hi fi z dy jv ea eb jw ed ef hg bi translated">GitHub-zbeyza/协作过滤</h2><div class="jx l"><h3 class="bd b fi z dy jv ea eb jw ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="jy l"><p class="bd b fp z dy jv ea eb jw ed ef dx translated">github.com</p></div></div><div class="jz l"><div class="np l kb kc kd jz ke in jq"/></div></div></a></div><p id="dbed" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们已经到达终点了！有问题，遇到困难或者只是想打个招呼？请使用评论框。🦖</p><div class="jn jo ez fb jp jq"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="jr ab dw"><div class="js ab jt cl cj ju"><h2 class="bd hi fi z dy jv ea eb jw ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="jx l"><h3 class="bd b fi z dy jv ea eb jw ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="jy l"><p class="bd b fp z dy jv ea eb jw ed ef dx translated">medium.com</p></div></div><div class="jz l"><div class="nq l kb kc kd jz ke in jq"/></div></div></a></div></div></div>    
</body>
</html>