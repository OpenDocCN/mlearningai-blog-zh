<html>
<head>
<title>Anime/Cartoon Girl Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">动漫/卡通女孩分类器</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/anime-cartoon-girl-classifier-bccef797f6d9?source=collection_archive---------1-----------------------#2021-04-17">https://medium.com/mlearning-ai/anime-cartoon-girl-classifier-bccef797f6d9?source=collection_archive---------1-----------------------#2021-04-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/79d063dc45412a2b51e22cbc0e66374b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9hxfdDf4QZLLv7qi"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx">Photo by <a class="ae hu" href="https://unsplash.com/@timmossholder?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tim Mossholder</a> on <a class="ae hu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="2b3e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi js translated">动漫的艺术风格通常可以与卡通区分开来，但我想知道这是否可以通过深度学习模型来识别，</p><p id="c31e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以在这篇文章中，我将从头到尾经历一个机器学习项目，从获取数据到部署模型。</p><p id="3d82" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最终目标是使用其他人的艺术风格重新创造一个动画/卡通形象，但由于数据有限，在这篇文章中，我将改为对动画/卡通女孩进行分类。</p><blockquote class="kb"><p id="f40d" class="kc kd hx bd ke kf kg kh ki kj kk jr dx translated">问题陈述:对动漫和动漫少女进行分类</p></blockquote><h1 id="3b07" class="kl km hx bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">流程</strong></h1><ul class=""><li id="5a4a" class="lj lk hx iw b ix ll jb lm jf ln jj lo jn lp jr lq lr ls lt bi translated">获取数据</li><li id="e32b" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr lq lr ls lt bi translated">数据预处理</li><li id="e073" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr lq lr ls lt bi translated">型号选择</li><li id="d4d2" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr lq lr ls lt bi translated">使用flask创建一个Web应用程序</li><li id="4332" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr lq lr ls lt bi translated">在Heroku上部署您的应用</li></ul><h1 id="2411" class="kl km hx bd kn ko kp kq kr ks kt ku kv kw lz ky kz la ma lc ld le mb lg lh li bi translated"><strong class="ak">获取数据</strong></h1><p id="6f4c" class="pw-post-body-paragraph iu iv hx iw b ix ll iz ja jb lm jd je jf mc jh ji jj md jl jm jn me jp jq jr ha bi translated">为了收集数据，我使用了bing的图像API。我跟踪了<a class="ae hu" href="https://www.pyimagesearch.com/2018/04/09/how-to-quickly-build-a-deep-learning-image-dataset/" rel="noopener ugc nofollow" target="_blank"> PYImageSearch </a>的博客文章，收集了动漫少女和卡通少女的数据。</p><p id="0054" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">收集完数据后，我给这些数据贴上了“动漫女孩”和“卡通女孩”的标签。</p></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><h1 id="d3e0" class="kl km hx bd kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le mq lg lh li bi translated">数据预处理</h1><figure class="mr ms mt mu fd hj"><div class="bz dy l di"><div class="mv mw l"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">Data preprocessing script</figcaption></figure><ol class=""><li id="d0c1" class="lj lk hx iw b ix iy jb jc jf mx jj my jn mz jr na lr ls lt bi translated"><strong class="iw hy">灰度转换</strong>:假设我的模型不需要学习颜色，我将我的图像输入转换成灰度。我想让我的模型了解艺术风格的差异，因此灰度数据似乎就足够了。</li><li id="943c" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr na lr ls lt bi translated"><strong class="iw hy">图像大小调整:</strong>这是在不同图像大小上测试了我的模型后完成的，120*120像素是我的GPU能够容纳的最大值。</li><li id="160c" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr na lr ls lt bi translated"><strong class="iw hy">数据集分割</strong>:测试集被分割为25%。</li><li id="5b83" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr na lr ls lt bi translated"><strong class="iw hy">数据归一化:</strong>在分割测试和训练数据集之后，我通过将测试和训练特征集除以255来归一化数据。<br/> <strong class="iw hy">注意</strong>:每个像素值都有一个从0到255的值，其中0代表最低强度，即黑色，255代表最高强度，即白色。</li><li id="4a89" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr na lr ls lt bi translated"><strong class="iw hy">标签二进制化器:</strong>我使用Label Binarizer对我的字符串类进行一次性编码。</li><li id="19ac" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr na lr ls lt bi translated"><strong class="iw hy">数据重塑:</strong>根据后端重塑训练和测试特征以包括通道。在Keras中，默认情况下，通道被配置为使用“channels_last”。这可以在Keras配置文件中设置为使用“channels_first”或“channels_last”。</li></ol></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><h1 id="3c0c" class="kl km hx bd kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le mq lg lh li bi translated">型号选择</h1><figure class="mr ms mt mu fd hj"><div class="bz dy l di"><div class="mv mw l"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">Model Code</figcaption></figure><p id="cd12" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最终模型是在多次反复测试模型后选择的，即(观察训练/验证损失和准确性)，通过改变层数并添加批量归一化和剔除以及l2正则化。</p><h2 id="db15" class="nb km hx bd kn nc nd ne kr nf ng nh kv jf ni nj kz jj nk nl ld jn nm nn lh no bi translated">模型摘要</h2><p id="6c78" class="pw-post-body-paragraph iu iv hx iw b ix ll iz ja jb lm jd je jf mc jh ji jj md jl jm jn me jp jq jr ha bi translated">在这个模型中，我有四个层，其中前两层结合使用了两个Conv和最大池层。在第一层中使用批量标准化。</p><p id="ba78" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">点击下面的URL来可视化神经网络模型。</p><div class="hg hh ez fb hi np"><a href="https://ibb.co/YtdKsDL" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab dw"><div class="nr ab ns cl cj nt"><h2 class="bd hy fi z dy nu ea eb nv ed ef hw bi translated">模型图</h2><div class="nw l"><h3 class="bd b fi z dy nu ea eb nv ed ef dx translated">神经网络模型图的绘制</h3></div></div><div class="nx l"><div class="ny l nz oa ob nx oc ho np"/></div></div></a></div><h2 id="48af" class="nb km hx bd kn nc nd ne kr nf ng nh kv jf ni nj kz jj nk nl ld jn nm nn lh no bi translated">精确度和损耗曲线</h2><figure class="mr ms mt mu fd hj er es paragraph-image"><div class="er es od"><img src="../Images/95f50738c8d52fbb2359663b30840b4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Im20_kdmSk1IvKacXK3wPw.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">Model Accuracy for 60 epochs</figcaption></figure><figure class="mr ms mt mu fd hj er es paragraph-image"><div class="er es od"><img src="../Images/0dc736124e501a97a2583fbee3654914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*jpKDaSIhXRBkXCPVryVNOw.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">Model loss for 60 epochs</figcaption></figure></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><h1 id="c10d" class="kl km hx bd kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le mq lg lh li bi translated">使用flask创建一个Web应用程序</h1><p id="3a2e" class="pw-post-body-paragraph iu iv hx iw b ix ll iz ja jb lm jd je jf mc jh ji jj md jl jm jn me jp jq jr ha bi translated">下一步是创建web应用程序。在这一部分，我使用flask构建了一个简单的web应用程序。</p><p id="2228" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上传后，我添加了一个上传按钮、一个提交表单和一个删除按钮。只有2个HTML页面，应用程序将在它们之间旋转。整个应用相当简单，你可以点击<a class="ae hu" href="https://github.com/saipuneet357/Anime_Classifer" rel="noopener ugc nofollow" target="_blank">这里</a>获取GitHub的源代码。</p><figure class="mr ms mt mu fd hj"><div class="bz dy l di"><div class="mv mw l"/></div><figcaption class="hq hr et er es hs ht bd b be z dx">Flask Webapp</figcaption></figure><p id="52d5" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">造型和JS的灵感来自<a class="ae hu" href="https://codepen.io/aaronvanston/pen/yNYOXR" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hy">这个文件上传</strong> </a> <strong class="iw hy"> </strong>由开发者亚伦·万斯顿创作。</p></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><h1 id="df77" class="kl km hx bd kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le mq lg lh li bi translated">在Heroku上部署您的应用</h1><p id="afd8" class="pw-post-body-paragraph iu iv hx iw b ix ll iz ja jb lm jd je jf mc jh ji jj md jl jm jn me jp jq jr ha bi translated">web应用程序完成后，最后一步是将应用程序部署到Heroku服务器上。</p><div class="mr ms mt mu fd ab cb"><figure class="oe hj of og oh oi oj paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><img src="../Images/02fb7764664a0f2cf84d0d6d37ad2105.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*kRosUqJH3_-wj9ELGk2r5A.png"/></div></figure><figure class="oe hj ok og oh oi oj paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><img src="../Images/d2ae6c4b69b600c11eb87f3a55938b24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*Gl7iOHbvJInNEXAzOiOZ9A.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx ol di om on">Anime and Cartoon</figcaption></figure></div><p id="dc10" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最终部署的web应用程序可在以下网址找到:</p><div class="hg hh ez fb hi np"><a href="https://ani-car-class.herokuapp.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab dw"><div class="nr ab ns cl cj nt"><h2 class="bd hy fi z dy nu ea eb nv ed ef hw bi translated">动漫少女vs卡通少女分类器</h2><div class="oo l"><p class="bd b fp z dy nu ea eb nv ed ef dx translated">ani-car-class.herokuapp.com</p></div></div></div></a></div></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><h1 id="9ce9" class="kl km hx bd kn ko mm kq kr ks mn ku kv kw mo ky kz la mp lc ld le mq lg lh li bi translated">考虑未来的改进</h1><ul class=""><li id="db84" class="lj lk hx iw b ix ll jb lm jf ln jj lo jn lp jr lq lr ls lt bi translated">艺术风格转换使用动画风格或相反的风格重新创建卡通形象</li><li id="dfa5" class="lj lk hx iw b ix lu jb lv jf lw jj lx jn ly jr lq lr ls lt bi translated">使用像VGG16这样的预训练网络作为我现有模型的特征。</li></ul></div></div>    
</body>
</html>