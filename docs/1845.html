<html>
<head>
<title>Multivariate Time Series using VAR model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于VAR模型的多元时间序列</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/multivariate-time-series-using-var-model-efa215371738?source=collection_archive---------5-----------------------#2022-02-03">https://medium.com/mlearning-ai/multivariate-time-series-using-var-model-efa215371738?source=collection_archive---------5-----------------------#2022-02-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="8cf9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大家好，如果你熟悉经典时间序列模型，那么在这种情况下，你一定已经知道vectored(V)意味着在这种情况下涉及多个时间序列。今天，我将在数据集上实现VAR模型，该数据集包含季节性趋势和模式，只是为了向您展示如何实现<strong class="ig hi"> VAR </strong>模型。如果你想应用微分和残差(即<strong class="ig hi">移动平均线</strong> ) <strong class="ig hi"> </strong>，我会很高兴看到你的评论。</p><p id="5c41" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">理论:</strong></p><p id="6bf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">向量自回归可以有多种可能的组合，就像我们对ARMA的组合一样。</strong></p><ol class=""><li id="16c7" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated"><strong class="ig hi"> VAR模型</strong>:这里涉及多个时间序列，每一列都有以前的滞后值。</li><li id="ea4a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><strong class="ig hi"> VARMA模型:</strong>此处多个时间序列涉及以前的值及其移动平均值/残差。</li><li id="4939" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><strong class="ig hi"> VARIMA模型:</strong>这里数据集不是静态的，我们希望应用微分来确保数据集变得稳定。为了使它稳定所做的时间微分次数代表I。</li></ol><p id="6d2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在每个人都必须对ARIMA模式有清晰的了解，如果你不了解，请关注我下面的帖子:</p><div class="jq jr ez fb js jt"><a rel="noopener follow" target="_blank" href="/mlearning-ai/univariate-variable-time-series-forecasting-using-arima-using-python-2faa012413e1"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hi fi z dy jy ea eb jz ed ef hg bi translated">基于PYTHON的ARIMA单变量时间序列预测</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">问题陈述:我试图解决一个问题陈述，这将有助于预测单变量…</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">medium.com</p></div></div><div class="kc l"><div class="kd l ke kf kg kc kh ki jt"/></div></div></a></div><p id="7780" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将尝试实现VAR模型，并指导您一步一步地了解模型是如何实现的。让我们跳进来。</p><p id="97a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">像往常一样导入非常基本的模块。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es kj"><img src="../Images/57bdf02c8d7d12246ab7fbed57dc819e.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*PGsNKhSChbhJV03sQCuCbQ.png"/></div></figure><p id="c4d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">读取数据集并进行一些快速的小转换，以使解释更容易。今后，我们将尝试确定哪些时间序列相互影响，以及如何选择列。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kq"><img src="../Images/f00719ecfb0b8df4bfc305da72a1d624.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KVGVIGqk4tA1vzKCS3S0vQ.png"/></div></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es kv"><img src="../Images/5c11c11506b667582e3667ce157c25b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*nWxjZ83A-o0QTEaKN_rqag.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx">Feel the quantity of dataset</figcaption></figure><p id="c033" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们每小时有6条数据记录，因为我的传感器不断产生记录。基于小时汇总数据并重新采样。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es la"><img src="../Images/1a6c41acc6d7a94b54c6de7b097795b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fPCy_QfuQ4dxxP1INzhaFA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">First 5 records</figcaption></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lb"><img src="../Images/db79164f81809e37e1f9cfd20fd7be1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DCDfEcYyoGNJ_tb17IpgAQ.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Last 5 records</figcaption></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es lc"><img src="../Images/6b629ce61505b1ef767c816b9eb1124b.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*c0P9em5PnzNB2OU7l6pHhQ.png"/></div></figure><p id="c13a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我相信我们将数据集从19735减少到了3290。这是不是很棒，因为我们也降低了很多计算能力。</p><p id="7519" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们做一些EDA(探索性数据分析):</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ld"><img src="../Images/551f9e17f82cd8826b5f74c61b751648.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NzTRVGr5el2qOlcTJBArRw.png"/></div></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es le"><img src="../Images/c20c8bcba1816e964c52664c6eab0380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cBLEjAm0bDEn_XI4BTPs0g.png"/></div></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lf"><img src="../Images/fe3a4631d1b498cdc3d7936cbcb6d394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ti60lh6pkgg1DGwgb9DzSA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Data doesn’t look to be oscillating/changing too much</figcaption></figure><p id="65cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了验证我的数据集是否是静态的，你们都必须知道要测试的进程的名字。它可以是EDA(静态平均值和标准偏差测试)或ADF测试。在当前情况下，我们将继续进行增强的Dickey Fuller测试。它基于P假设。</p><p id="fd10" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">H0-&gt;数据不是静止的</p><p id="2d5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">H1-&gt;如果p≤0.05，数据是稳定的</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lg"><img src="../Images/84b16e35d1d42c500470f0b2f3f12919.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpSbd3mpqlGQG4Z_7CyLVA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">seems amazing</figcaption></figure><p id="b5ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你的数据集不是稳定的，就必须做微分，这就是我要介绍的。这个过程与我们在ARIMA所做的一样。</p><p id="5536" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们有了维数灾难，你在机器学习中做PCA测试时听过这个术语。在这种情况下，我们有一些非常相似的东西。我们会做格兰杰因果检验，这也是P假设检验。让我们确定这是一个非常有趣的基本概念。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lh"><img src="../Images/144737ad7356323a0b60059541067741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k6JdWPE5-kTAv3dCYB_9TQ.png"/></div></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es li"><img src="../Images/359f68e941afa7f9223379f1bd799986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rOGf1tXWUeEPWJCnEgcrCg.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Table</figcaption></figure><p id="1549" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上表解释了因果关系。X轴表示特征，y轴表示标注的输出。如上表所示，我们可以看到<strong class="ig hi"> appliances_x </strong>导致<strong class="ig hi"> T_out_y </strong>的p值为0.000，这表明<strong class="ig hi"> appliances_x导致了T_out的值变化。</strong></p><p id="47ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">换句话说，<strong class="ig hi">器具_x </strong>导致<strong class="ig hi">可见度_y是0.4381，这比值0.05和</strong>高得多，因此我们可以得出器具对可见度的影响相当低的结论。因此，我们可以删除列设备，同时确定可见性的时间序列。</p><p id="b060" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它看起来非常类似于降维问题。如果你很好的理解了上面的解释，那么你们可以进入下一步了。</p><p id="c1df" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">考虑到复杂性，让我将其简化为3个特征的时间序列模型。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es lj"><img src="../Images/cd89412593fd55941d218bcc70192715.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*-VkZsm07QOFKa3aLOgnYHQ.png"/></div></figure><p id="b592" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将数据分成训练和测试数据集。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es lk"><img src="../Images/f57f93604864c56acb7c1bbee2d6b70e.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*dPhwdgllA473toetgXqqmQ.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx">Splitting the dataset</figcaption></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es ll"><img src="../Images/0e9daa99211ba20ad7d8bc6f6cddc28b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*ei-OlvuCJz6FwcOxX2t6yg.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx">Look and feel for the test and train dataset</figcaption></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lm"><img src="../Images/e32f5d889e1053518afb56b5ff805a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YbJfk6Ykh78ls5rES1W4A.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Finding out the best order for the lag</figcaption></figure><p id="81e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">优化是非常必要的，更重要的是，找出最佳的滞后阶数可以解决我们所有的问题。我将向您展示两种这样做的方法。<strong class="ig hi">第一种方法:</strong></p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ln"><img src="../Images/59b49c58997e820a085a2d104ad0bfab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5icbfRAeQsj3Rao8Fu4eDA.png"/></div></div></figure><p id="763f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以基于AIC(赤池信息标准)或BIC(商业信息标准)这两个标准找到优化的滞后。模型运行得越好，AIC或BIC的值越低。在上面的例子中，两种情况下的顺序是不同的。但接下来我们将考虑基于AIC的滞后订单。</p><p id="5dfc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第二种方法:</strong></p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es lo"><img src="../Images/1cec323c840ca93066175cc2aabf313d.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*ec2s7O69NC5yVABvt22a-Q.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx">Star Marked will show the best lag orders</figcaption></figure><p id="2471" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们使用VAR来创建模型。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lp"><img src="../Images/fc7d130a97ae43507a4298401733286c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IBBT1PHCKYuyDNjOeby-gw.png"/></div></div></figure><p id="68b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们试着想象一下模型的概要。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lq"><img src="../Images/50ed95d65eab462527719f5a4ac667ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*16LiAXdpnkogqbsffKOIug.png"/></div></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lr"><img src="../Images/efed7623e6b2a54933617c284d360901.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3qZYfx6SahDfAoKh9VUQ7g.png"/></div></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ls"><img src="../Images/2d8e39b579c41c7830a408d064a65eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ZN5ljEnZhJlBG5Y_nQrRQ.png"/></div></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es lt"><img src="../Images/52c6c2ea0671800dbfeffaa782e1beac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*JwFE3iM6ttCOGJUSm0LAmA.png"/></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lu"><img src="../Images/c872b22ea2d67a6e1d11fe9057e01612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RbiPJlQoydyT3bK9fp3Q6Q.png"/></div></div></figure><p id="8606" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们在图表上绘制Appliances actual和appliances_pred，以确定是否有任何巨大的差异。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lv"><img src="../Images/54b1db0e8ed0a84293c107253ea9dffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zdAk5YJUwkmXUAK5ccVLhg.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Appliances_actual vs appliances_pred</figcaption></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lw"><img src="../Images/d1c483c2de2624b3f98f256d66e3bb47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*exw_BdYZKUsI8nNyT4bGLw.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">T_out actual vs T_out pred</figcaption></figure><p id="dff6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">预测没有那么好，我们可以用VARMA模型来提高精确度。请尝试实现相同的并提高模型的性能。你也可以想象特定的滞后的影响，并在此基础上画出你自己的线性方程。</p><p id="002b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我给你看最后一招。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es la"><img src="../Images/aaa5dc11edb516a9211cecaebf8881bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XIi8DD-9GQmM5TIwJNXAxA.png"/></div></div></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es ll"><img src="../Images/67b1fb211484d21534c44b87ab2d8c09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*nXVJG7nu1rS92_r6-rXniw.png"/></div></figure><p id="53ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果p值≤ 0.05，这意味着滞后对确定标签输出有较大影响。它将被考虑，其余的都可以被忽略。它可以转化为多元线性回归方法。</p><p id="265b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">y=L1*x1+L2*x2+L3*x3…+const等等。</p><p id="7c3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">只考虑那些p值小于0.05的系数。</p><p id="8980" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望，我能够帮助你一步一步地理解VAR模型的实现。虽然根据我们的预期，我的模型没有很好地工作，但我觉得每个人都必须一步一步地理解实施过程。非常感谢！！！</p><div class="jq jr ez fb js jt"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ju ab dw"><div class="jv ab jw cl cj jx"><h2 class="bd hi fi z dy jy ea eb jz ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ka l"><h3 class="bd b fi z dy jy ea eb jz ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kb l"><p class="bd b fp z dy jy ea eb jz ed ef dx translated">medium.com</p></div></div><div class="kc l"><div class="lx l ke kf kg kc kh ki jt"/></div></div></a></div></div></div>    
</body>
</html>