<html>
<head>
<title>SynapseML (Open Source) in Azure Databricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure Databricks中的SynapseML(开源)</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/synapseml-open-source-in-azure-databricks-56e3d11e2e70?source=collection_archive---------4-----------------------#2022-03-19">https://medium.com/mlearning-ai/synapseml-open-source-in-azure-databricks-56e3d11e2e70?source=collection_archive---------4-----------------------#2022-03-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="fcf2" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">如何在Azure Databricks中运行SynalpseML</h1><h1 id="8d89" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">先决条件</h1><ul class=""><li id="641b" class="jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">Azure订阅</li><li id="67db" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">Azure数据块</li><li id="a63b" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">SynapseML安装说明</li></ul><h1 id="7369" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">步伐</h1><ul class=""><li id="bd97" class="jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">首先创建一个Azure数据砖块工作区</li><li id="7413" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">创建新计算机</li><li id="a0af" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">我测试了光子和普通火花发动机</li></ul><figure class="ka kb kc kd fd ke er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es jz"><img src="../Images/581ae8e94b982fbbb058c71cce96fe83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*obzwiG_dkc5QWQgp.jpg"/></div></div></figure><ul class=""><li id="7fc4" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">从Maven位置安装库</li><li id="3a14" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">下面是经过测试的集群配置</li></ul><figure class="ka kb kc kd fd ke er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kq"><img src="../Images/4caa19a092ef7e746d3d004d1499be38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yx00xQEVdNdx9oTe.jpg"/></div></div></figure><ul class=""><li id="475a" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">synapseml库安装的配置</li><li id="5395" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">查一下回购网址，不一样</li></ul><pre class="ka kb kc kd fd kr ks kt ku aw kv bi"><span id="76af" class="kw if hh ks b fi kx ky l kz la">maven cordinates: com.microsoft.azure:synapseml_2.12:0.9.5<br/>Repository: <a class="ae lb" href="https://mmlspark.azureedge.net/maven" rel="noopener ugc nofollow" target="_blank">https://mmlspark.azureedge.net/maven</a></span></pre><ul class=""><li id="1cf8" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">接下来启动集群</li><li id="2155" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">等待群集进入运行状态，并且安装了库</li><li id="94c3" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">接下来，让我们创建一个新笔记本</li></ul><h1 id="3fd2" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">密码</h1><ul class=""><li id="7cf3" class="jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">现在让我们编写一个示例代码</li><li id="0b59" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">我在Azure databricks中使用与Repos连接的Git hub存储库</li></ul><pre class="ka kb kc kd fd kr ks kt ku aw kv bi"><span id="5c8a" class="kw if hh ks b fi kx ky l kz la">import synapse.ml<br/>from synapse.ml.cognitive import *</span><span id="dac6" class="kw if hh ks b fi lc ky l kz la">import numpy as np<br/>import pandas as pd</span></pre><ul class=""><li id="f3fa" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">现在让我们加载数据</li></ul><pre class="ka kb kc kd fd kr ks kt ku aw kv bi"><span id="a433" class="kw if hh ks b fi kx ky l kz la">dataFile = "AdultCensusIncome.csv"<br/>import os, urllib<br/>if not os.path.isfile(dataFile):<br/>    urllib.request.urlretrieve("https://mmlspark.azureedge.net/datasets/" + dataFile, dataFile)<br/>data = spark.createDataFrame(pd.read_csv(dataFile, dtype={" hours-per-week": np.float64}))<br/>data.show(5)</span></pre><ul class=""><li id="aea4" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">选择列并拆分用于训练和测试</li></ul><pre class="ka kb kc kd fd kr ks kt ku aw kv bi"><span id="ebb1" class="kw if hh ks b fi kx ky l kz la">data = data.select([" education", " marital-status", " hours-per-week", " income"])<br/>train, test = data.randomSplit([0.75, 0.25], seed=123)</span></pre><ul class=""><li id="a825" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">现在训练模型</li></ul><pre class="ka kb kc kd fd kr ks kt ku aw kv bi"><span id="9c9e" class="kw if hh ks b fi kx ky l kz la">from synapse.ml.train import TrainClassifier<br/>from pyspark.ml.classification import LogisticRegression<br/>model = TrainClassifier(model=LogisticRegression(), labelCol=" income").fit(train)</span></pre><ul class=""><li id="12f2" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">现在公制计算</li></ul><pre class="ka kb kc kd fd kr ks kt ku aw kv bi"><span id="93e0" class="kw if hh ks b fi kx ky l kz la">from synapse.ml.train import ComputeModelStatistics<br/>prediction = model.transform(test)<br/>metrics = ComputeModelStatistics().transform(prediction)<br/>metrics.select('accuracy').show()</span></pre><ul class=""><li id="e941" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">以上是为了展示本库的功能</li><li id="edf5" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">不打算解决任何用例</li><li id="f880" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">所有代码都基于文档</li></ul></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><p id="8459" class="pw-post-body-paragraph lk ll hh je b jf kl lm ln jh km lo lp jj lq lr ls jl lt lu lv jn lw lx ly jp ha bi translated"><em class="lz">最初发表于</em><a class="ae lb" href="https://github.com/balakreshnan/Samples2022/blob/main/AzureDatabricks/synapsemladb.md" rel="noopener ugc nofollow" target="_blank"><em class="lz">【https://github.com】</em></a><em class="lz">。</em></p><div class="ma mb ez fb mc md"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="me ab dw"><div class="mf ab mg cl cj mh"><h2 class="bd hi fi z dy mi ea eb mj ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mk l"><h3 class="bd b fi z dy mi ea eb mj ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ml l"><p class="bd b fp z dy mi ea eb mj ed ef dx translated">medium.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr kj md"/></div></div></a></div></div></div>    
</body>
</html>