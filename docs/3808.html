<html>
<head>
<title>Explained: MobileNet V1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释:V1移动网络</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/explained-mobilenet-v1-bb700abfe824?source=collection_archive---------8-----------------------#2022-10-23">https://medium.com/mlearning-ai/explained-mobilenet-v1-bb700abfe824?source=collection_archive---------8-----------------------#2022-10-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="d459" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MobileNet V1架构是计算机视觉应用中使用最广泛的深度网络架构之一。如果你是那些使用过基于这种架构的模型以及其他模型的人之一(像我一样)，那么你可能知道它在边缘设备(手机、开发板如raspberry pi等)上的速度和效率。).但是究竟是什么让MobileNet V1架构如此快速高效呢？这正是我们将要回答的问题。</p><p id="320f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要理解MobileNet V1架构的基本构建模块，有一个先决条件，您应该知道卷积层是如何工作的。如果你对此不太确定，<a class="ae jc" href="https://www.youtube.com/watch?v=XuD4C8vJzEQ&amp;list=PLkDaE6sCZn6Gl29AoE31iwdVwSG-KnDzF&amp;index=2" rel="noopener ugc nofollow" target="_blank">这里是吴恩达的播放列表，可以让你足够了解</a>。</p><p id="a3d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">影响深度学习模型速度的因素是“计算成本”，简单来说，就是进行预测所需的乘法次数。对于卷积层，计算成本很大。如果我们能够以某种方式降低计算成本，我们的模型将变得快速高效，这就是MobileNet所做的，它减少了通过卷积层所需的乘法次数。为了理解MobileNet是如何做到这一点的，让我们看一个例子。</p><p id="bd34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设有一个尺寸为5x5x3的输入图像，我们需要用16个滤波器对其进行卷积，每个滤波器的尺寸为3x3x3。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/472b8d538af053ba73e94ef3223a0a9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vLWCs3U5OD8e73LSat3dlQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Input image being convolved by 16 filters and producing an output of 3x3x16</figcaption></figure><p id="f575" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每个滤波器同时应用于所有输入通道。输出维度的计算超出了本文的范围，但是您可以在这里<a class="ae jc" href="https://stackoverflow.com/questions/53580088/calculate-the-output-size-in-convolution-layer" rel="noopener ugc nofollow" target="_blank">阅读相关内容。</a></p><p id="dc39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">卷积运算的计算成本通过以下公式计算，</p><p id="5085" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">计算成本=过滤高度*过滤宽度*输入通道数*过滤数量*输出高度*输出宽度</strong></p><p id="cd76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于图中所示的卷积运算，计算成本可以给出如下:</p><p id="5238" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">计算成本= 3 x3x 3 x3x 16 = 3，888次乘法。</p><p id="f531" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是执行图中所示卷积运算所需的乘法次数。</p><p id="29c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MobileNet通过使用一种称为<strong class="ig hi">深度可分卷积的概念来降低计算成本。</strong></p><h2 id="53ed" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">深度方向可分离卷积；</h2><p id="ece1" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">深度方向可分离卷积包括以下两个步骤:</p><ol class=""><li id="9c67" class="kt ku hh ig b ih ii il im ip kv it kw ix kx jb ky kz la lb bi translated">深度方向卷积</li><li id="6401" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">逐点卷积</li></ol><p id="cb8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在深度卷积中，与普通卷积不同，每个滤波器都保留给输入图像的一个通道，而不是所有通道。这意味着每个输入通道都与一个滤波器进行卷积，所有通道的输出最终连接在一起，形成最终输出。</p><p id="a6e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们继续我们的例子，那么在深度方向卷积期间，5x5x3输入图像将与3，3x3滤波器进行卷积，每个滤波器用于一个输入通道，如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f5b0c7357f2ef45e53ed954593054882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MtO720Oud8s7ZOb4eZ5QbQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Depth-wise convolution performed on the input image that yields an output with dimensions 3x3x3</figcaption></figure><p id="9890" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">计算深度方向卷积运算的计算成本的公式略有不同，</p><p id="6b54" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">计算成本=过滤高度*过滤宽度*输入通道数*输出高度*输出宽度</strong></p><p id="75dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以使用上面的公式来计算上图所示的深度方向卷积的计算成本，</p><p id="23d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">计算成本= 3×3×3×3×3 = 243次乘法。</p><p id="d124" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但有一个问题，标准卷积层的输出维度为3x3x16，而当我们应用深度卷积时，输出维度为3x3x3。</p><p id="8f4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是我们使用逐点卷积的地方。逐点卷积基本上是一种卷积运算，滤波器的维数为1x1。因此，如果我们使用大小为1的16个滤波器，我们可以获得所需的输出尺寸(即3x3x16)。如果你没有看到最后一部分，请参考<a class="ae jc" href="https://stackoverflow.com/questions/53580088/calculate-the-output-size-in-convolution-layer" rel="noopener ugc nofollow" target="_blank">这里</a>，然后再次阅读故事:)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/2aff7a248f598f2aff6346697bb84ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fvy9qvKDyw27kkJXh1jDSA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Applying pointwise convolution to the output from depth-wise convolution.</figcaption></figure><p id="dd86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将使用与用于标准卷积的公式相同的公式来计算逐点卷积的计算成本，</p><p id="2cc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">计算成本= 1x1x3x3x3x16 = 432次乘法运算</p><p id="c38d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在应用于我们的例子的深度方向可分离卷积的总计算成本将是，</p><p id="b571" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总计算成本= 243+432 = 675次乘法。</p><p id="8ee3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这表明，通过应用深度方向可分离卷积而不是标准卷积，我们可以减少82.64%的计算成本(那是ALOOTT！！)</p><p id="618e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，深度方向可分离卷积使得MobileNet V1架构如此高效和快速。</p><p id="414c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">更多类似内容，请订阅我的电子邮件列表，并在<a class="ae jc" href="https://www.linkedin.com/in/zain-ehtesham-24086b19b/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我。</p><div class="lh li ez fb lj lk"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ll ab dw"><div class="lm ab ln cl cj lo"><h2 class="bd hi fi z dy lp ea eb lq ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lr l"><h3 class="bd b fi z dy lp ea eb lq ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ls l"><p class="bd b fp z dy lp ea eb lq ed ef dx translated">medium.com</p></div></div><div class="lt l"><div class="lu l lv lw lx lt ly jn lk"/></div></div></a></div></div></div>    
</body>
</html>