<html>
<head>
<title>Introduction to Mixed Models in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R中的混合模型介绍</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/introduction-to-mixed-models-in-r-9c017fd83a63?source=collection_archive---------0-----------------------#2021-10-06">https://medium.com/mlearning-ai/introduction-to-mixed-models-in-r-9c017fd83a63?source=collection_archive---------0-----------------------#2021-10-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="0ae9" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">让变化为你服务。</h2></div><p id="7c72" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面这篇文章是对R中混合模型的一个简单介绍，使用了一个小猪体重发展的数据集。每只小猪在四个时间点被测量——0、7、14和21。</p><p id="beb6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae js" href="https://en.wikipedia.org/wiki/Mixed_model" rel="noopener ugc nofollow" target="_blank">混合模型</a>是传统回归模型的扩展，能够通过使用方差分量对模型中已解释和未解释的<a class="ae js" rel="noopener" href="/@marc.jacobs012/randomness-in-mixed-models-8b7affd8a7c4">随机部分</a>进行建模。因此，它们是处理相关和不平衡数据的极好工具。混合模型的传统出路是包含重复测量的数据集，如果时间是重复的关键原因，则该数据集通常被称为纵向数据。重复数据的另一个例子是制造数据或过程控制数据，其中从机器中取出多个样本来评估(嵌套)方差。</p><p id="345a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是因为在(相关观测值)内部和观测值之间存在差异。在这些模型中，观察发生的级别是关键。在这个例子中，感兴趣的级别是小猪，它包含多个观察值。这样的数据集被标记为“嵌套的”。</p><p id="1209" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在本例中，我将使用上述纵向数据集来构建几个模型:</p><ol class=""><li id="7178" class="jt ju hh iy b iz ja jc jd jf jv jj jw jn jx jr jy jz ka kb bi translated"><strong class="iy hi">无条件均值模型</strong> —仅包括截距(整体均值)。</li><li id="3174" class="jt ju hh iy b iz kc jc kd jf ke jj kf jn kg jr jy jz ka kb bi translated">无条件增长模型或<strong class="iy hi">随机截距模型</strong>。该模型允许仔猪水平的特定截距，但只有一个全局单一斜率系数。</li><li id="afc3" class="jt ju hh iy b iz kc jc kd jf ke jj kf jn kg jr jy jz ka kb bi translated">条件增长或<strong class="iy hi">随机截距随机斜率模型</strong>。每只小猪都被建模为一个独立的实体和更大数据集的一员。因此，对于每只小猪，模拟随机截距和随机斜率，但是估计全局截距和全局斜率。</li></ol><p id="3980" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">混合模型通过查看模型的全局部分来确定特定级别(这里是动物)系数的能力导致了<a class="ae js" rel="noopener" href="/@marc.jacobs012/blups-and-shrinkage-in-mixed-models-sas-3fbc6662fa6b">收缩</a>。这意味着来自混合模型的预测被拉向更大的平均值，这防止了过度拟合。</p><p id="99b2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们开始吧。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Environment is cleared and several packages are loaded. The backbone of a Mixed Model in R is the lme4 package.</figcaption></figure><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Data is loaded and transformed into long format. This means that multiple rows contain data belonging to the same ID. Mixed Models need this long-format in order to model longitudinal data.</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ks"><img src="../Images/14fab2d95a26b0a4b2b9475fb23e851c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cy-nuSCjY0aKgrW-Afx7vw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">The data clearly shows that we have four observations per animal. For simplicity sake, we focus only on treatment as a covariate.</figcaption></figure><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Code to summarize data across time, and across treatment and time. In addition, we will already take a peak at the overall correlation and covariance of time-points. Remember, observations in time are nested, especially when they take place in the same individual. This will affect standard error estimates.</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kz"><img src="../Images/0982d22cb20f87f9e0f424fa5ebb303b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*HO4Zjwtbr_GWAn6vlh9_Iw.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Enough variance, per treatment and per timepoint.</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es la"><img src="../Images/d418530e85f86ee08ac05d0ed6b78e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*L-InJFfUD5J1iPXQ1gg-hw.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Clear correlation across time.</figcaption></figure><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Code to plot data across time to get some idea what it is that we are dealing with.</figcaption></figure><div class="kh ki kj kk fd ab cb"><figure class="lb kl lc ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/ff74efe56b7daa7a3895639b24a10dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*O9wtP8xpLumkWhsLIU1lVw.png"/></div></figure><figure class="lb kl lc ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/30de660d1970ecdeb1f2d1481b430413.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*AmqzRrMAog4Umuuv6GONIw.png"/></div></figure><figure class="lb kl lh ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/f2312096f5340f5d683b223e287ecc20.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*0-NEoNcTivzc6XhMFd55IQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx li di lj lk">Graphs show a clear difference between treatments, in mean and variance, across time.</figcaption></figure></div><p id="2a88" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面的代码是一个旁门左道，引入纵向K-means聚类来评估数据是否可以划分到不同的聚类中。下面的代码做这个练习，寻找2到5个集群。这是一个探索性的工具，包括展示，但结果确实暗示数据不属于五个治疗。或许连四个都不到。此外，很明显，数据在截距上有所不同，尽管在斜率上差别不大。因此，我们有一个随机截距模型的提示。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ll"><img src="../Images/af841b456dc413b41560b97fad7e739e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OFz1hNp98iQdA8ecefVoFw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">Plots show that partitioning the data in 2 to 3 factors makes sense, and that the data clearly shows difference in intercept. Not so much in slope.</figcaption></figure><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">A simple linear regression model to see if time, treatment, and time*treatment make sense.</figcaption></figure><div class="kh ki kj kk fd ab cb"><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/9d291d164dc8bc0669516a994fc1bbee.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*zwVRZr3z2Gm8sdF-zwe4Cw.png"/></div></figure><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/b11b162d10cd1ed041c7e4a66d9184af.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*G9I6CLy9tTBxKCz45gFlDg.png"/></div></figure><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/ce209d715b5b6fb818610bf003f23f04.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*c6LO6JIVfhc0lAHeq8XXYw.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx ln di lo lk">Residuals look good. Time makes sense. Time by treatment does not make sense. The K-Means clustering already hinted at that — time and treatment have a main effect. Not an interaction effect.</figcaption></figure></div><p id="1a8e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的第一个模型，无条件手段模型。其实挺简单的。它有单次拦截，随机效果<em class="lp">(1 |动物)</em>。代码<em class="lp">(1 |动物)</em>告诉模型，对于每只动物，我们要分别估计它的截距。因此，一个随机截距模型。</p><p id="56e5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">尽管我们将包括随机截距，但为了估计<a class="ae js" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1466680/" rel="noopener ugc nofollow" target="_blank">群内相关系数</a> (ICC)，我们将避免使用除了大平均值之外的任何其他预测值。ICC是解释方差/总方差的简单比率。实际上，无条件均值模型的ICC是一个筛选工具，用于查看混合模型是否有意义。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lq"><img src="../Images/c0054977b66340a1d58c6f442a0e18ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5j9F_WFLrQV63B4XEAEyrQ.png"/></div></div></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lr"><img src="../Images/98f3b0388d8e73a0a0ef9d534a90d260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ksel5M3vMxuXE3OOb94CpQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">The grand-mean (intercept) is not a great predictor for the data.</figcaption></figure><p id="9c1c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上面和下面的输出显示了总数据集中6.4%的差异，这可归因于动物之间的差异。这是国际刑事法院。这并不算多，而且说实话，在应用混合模型时，这并不能真正预示大量的成功。但无论如何让我们试试。</p><pre class="kh ki kj kk fd ls lt lu lv aw lw bi"><span id="678a" class="lx ly hh lt b fi lz ma l mb mc">&gt; icc(model.i)<br/># Intraclass Correlation Coefficient</span><span id="4810" class="lx ly hh lt b fi md ma l mb mc">Adjusted ICC: 0.064<br/>Conditional ICC: 0.064</span></pre><p id="f056" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下模型是无条件增长模型。有截距，有时间的固定效应，也有随机截距。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es me"><img src="../Images/97bf0da55a7f257999d992666418fc81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgXRU4XI8aZpbGsr9l1NKA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">The output shows much less residual variance in this model by including the fixed effect of time.</figcaption></figure><div class="kh ki kj kk fd ab cb"><figure class="lb kl mf ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/7d8666173d2f68a2e75142ee05f7291e.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*cplw6qu27roPfC0GkmYUdQ.png"/></div></figure><figure class="lb kl mg ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/ebd829de4b2a0aac553e61a420eada53.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*1Ub9uD0qRE4X5IYVynawvw.png"/></div></figure><figure class="lb kl mh ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/99a6ef34bbd608318d9179f847192c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*gU2aAvOd4xyKJhNUPcVcPQ.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx mi di mj lk">The plots show the marginal prediction (averaged across all data points), the conditional prediction (per animal based on fixed and random intercepts), and the calibration of the model.</figcaption></figure></div><p id="972f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">接下来是无条件多项式增长模型。和上一个模型一样，除了现在我们加入了时间的二次效应。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><div class="kh ki kj kk fd ab cb"><figure class="lb kl mk ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/381066491d760946c4b1cfdf5a438481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1448/format:webp/1*X4h7jcBsjxb0Oe8ig067bA.png"/></div></figure><figure class="lb kl ml ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/aa1c06261f7f5ee2bc427158403c4558.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*pPhtz_-cC9EZ3APxuRYqPA.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx mm di mn lk">Adding a quadratic effect does not really add anything to the model. To the right, you can see the intercept only, linear, and quadratic effect models.</figcaption></figure></div><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Code to assess which model is best — intercept, linear, quadratic.</figcaption></figure><p id="7c43" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">结果有利于二次，但不是压倒性的力量。此外，如果你看看上面的图，我不会那么想使用二次模型。尤其是，因为治疗还没有包括在内。</p><pre class="kh ki kj kk fd ls lt lu lv aw lw bi"><span id="0395" class="lx ly hh lt b fi lz ma l mb mc">  Model K      AICc Delta_AICc AICcWt Cum.Wt        eratio<br/>3     Q 5  932.5382     0.0000      1      1  1.000000e+00<br/>2     L 4  960.9260    28.3878      0      1  1.459925e+06<br/>1     I 3 1445.8183   513.2801      0      1 2.866517e+111</span></pre><p id="a1ec" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面的代码将在动物层面上查看哪个模型是首选的。压倒性地，它是二次模型，这可以通过缺少更重要的变量来解释。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><pre class="kh ki kj kk fd ls lt lu lv aw lw bi"><span id="045e" class="lx ly hh lt b fi lz ma l mb mc">&gt; head(results)<br/>  Animal   Rsq_lin  Rsq_quad         Diff  Bestfit<br/>1  58833 0.9401456 0.9818319 -0.041686360 Rsq_quad<br/>2  58838 0.9933775 0.9988962 -0.005518764 Rsq_quad<br/>3  58842 0.9441755 0.9562784 -0.012102874 Rsq_quad<br/>4  58844 0.9948570 0.9996546 -0.004797544 Rsq_quad<br/>5  58855 0.9592769 0.9644571 -0.005180252 Rsq_quad<br/>6  58857 0.9952800 0.9954673 -0.000187301 Rsq_quad</span></pre><p id="4b17" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们转到条件增长模型——随机截距随机斜率。此外，我们现在包括治疗。顺便说一下，<em class="lp">(时间|动物编号)</em>最好读作<em class="lp">(1+时间|动物编号)</em>，但不需要额外的注释。因此，<em class="lp">(时间|动物数量)</em>是请求随机截距随机斜率模型所必需的代码。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><div class="kh ki kj kk fd ab cb"><figure class="lb kl mo ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/9dc6b4752d6fe676cc16e5644c34f2bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*QpK8PaXEZlXgsl-nUBOPMw.png"/></div></figure><figure class="lb kl mo ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/0ddbcd22699607cfc766b6f1cc5a6812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*0GRQkTYGBUQCUMObgotn8A.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx mp di mq lk">To the left, if you squeeze your eyes, you can see a random slope somewhat, but it is surely not as clear as the random intercept. To the right the calibration plot. Predictions become more off as the weight increases which makes sense. The larger the mean, the more variance you will find. Especially in growth models.</figcaption></figure></div><p id="a4d2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面的代码显示了许多额外的模型，在固定和随机效果方面都有变化。然后我们将它们进行比较，选出一个获胜者。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><pre class="kh ki kj kk fd ls lt lu lv aw lw bi"><span id="86ca" class="lx ly hh lt b fi lz ma l mb mc">&gt; data.frame(Model=myaicc[,1],round(myaicc[, 2:7],4))<br/>  Model  K      AICc Delta_AICc AICcWt Cum.Wt        eratio<br/>5    QT 11  845.2731     0.0000 0.9815 0.9815  1.000000e+00<br/>7   QxT 19  853.2190     7.9459 0.0185 1.0000  5.314210e+01<br/>4    LT 10  904.5280    59.2549 0.0000 1.0000  7.362806e+12<br/>6   LxT 14  905.3122    60.0391 0.0000 1.0000  1.089747e+13<br/>3     Q  5  932.5382    87.2652 0.0000 1.0000  8.900052e+18<br/>2     L  4  960.9260   115.6530 0.0000 1.0000  1.299341e+25<br/>1     I  3 1445.8183   600.5453 0.0000 1.0000 2.551215e+130</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es mr"><img src="../Images/514bf6374896cdb4e7857feb67e77ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G_rMGofQK-SUf7CUqifgbw.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx">Clear to see the variance attributed by the random intercept and random slope at the animal-level. Their correlation is not very high. Below are the fixed effects and their correlation. Treatment does not seem to have any additional explanatory power.</figcaption></figure><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Code to extract random and fixed effects from the best model, as well as the variance-covariance matrix. Last piece of code looks a bit deeper in the q.t.r model.</figcaption></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ms"><img src="../Images/aedb67b3dabe48c7fc08d3f4914d73d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p0jBOKfSDLI1bmQn1b7y2g.png"/></div></div></figure><p id="e409" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面你可以看到，我们要求模型指定动物特定的截距和坡度影响。然后跟着固定效果走。这意味着预测动物58833在治疗2的时间点21的体重的公式如下:</p><p id="bb21" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">截距</strong> → 7.644-0.8421= 6.802 +</p><p id="fd9b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">时间</strong>→0.160+0.021 = 0.181 * 21 = 10.603+</p><p id="5a9a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">时间</strong>→0.0056 = 0.0056 * 21 * 21 = 13.072+</p><p id="c281" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">处理</strong> →-0.0279 =13.045</p><pre class="kh ki kj kk fd ls lt lu lv aw lw bi"><span id="7da5" class="lx ly hh lt b fi lz ma l mb mc">&gt; head(ranef(model.q.t.r))<br/>$animal_number<br/>      (Intercept)         time<br/>58833 -0.84215052  0.020826408<br/>58838  0.14472475  0.116202118<br/>58842  0.72890016 -0.032279547<br/>58844 -0.27168740 -0.040408184<br/>58855  1.99977032  0.042297651<br/>58857  0.36337948 -0.030983612<br/>58859  0.57012609  0.046758630<br/>58861 -1.16268046 -0.025436646<br/>58877 -0.62441343 -0.189737239<br/>58879  0.63046959  0.036521097<br/>58894 -1.88534651 -0.102504893<br/>58895  1.30106656 -0.024664555<br/>58905 -0.60900735  0.022391597<br/>58919 -1.30348657 -0.031411944<br/>58938  1.22407165  0.071694004<br/>58939 -0.86975057 -0.111685843</span><span id="5626" class="lx ly hh lt b fi md ma l mb mc">&gt; head(fixef(model.q.t.r))<br/> (Intercept)         time    I(time^2)      treatm2      treatm3      <br/> 7.644750106  0.160296158  0.005642406 -0.027922237 -0.079978283  </span><span id="6e90" class="lx ly hh lt b fi md ma l mb mc">treatm4<br/>0.081867461</span></pre><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx">Code to check via ANOVA and permuted Likelihood Ratio Testing if adding treatment makes the model better.</figcaption></figure><p id="f645" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面的输出表明，更复杂的模型不会添加相关信息。这意味着整个变化可以通过时间和两个随机因素来解释。</p><pre class="kh ki kj kk fd ls lt lu lv aw lw bi"><span id="3234" class="lx ly hh lt b fi lz ma l mb mc">&gt; anova(model.q.t.r, model.q.r) # treatment does not provide a better model<br/>Data: data_long<br/>Models:<br/>model.q.r: BW ~ time + I(time^2) + (time | animal_number)<br/>model.q.t.r: BW ~ time + I(time^2) + treatm + (time | animal_number)<br/>            npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)<br/>model.q.r      7 836.49 862.34 -411.24   822.49                     <br/>model.q.t.r   11 844.35 884.98 -411.17   822.35 0.1414  4     0.9976</span><span id="cb2d" class="lx ly hh lt b fi md ma l mb mc">PBmodcomp(model.q.t.r, model.q.r, nsim=500, cl=cl)<br/>Bootstrap test; time: 17.55 sec; samples: 500; extremes: 497;<br/>large : BW ~ time + I(time^2) + treatm + (time | animal_number)<br/>BW ~ time + I(time^2) + (time | animal_number)<br/>         stat df p.value<br/>LRT    0.1414  4  0.9976<br/>PBtest 0.1414     0.9940</span></pre><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="km kn l"/></div></figure><p id="0c25" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面你可以看到代码的结果，以评估混合模型是否满足<a class="ae js" href="https://en.wikipedia.org/wiki/Independent_and_identically_distributed_random_variables" rel="noopener ugc nofollow" target="_blank">独立同分布随机变量</a>的假设。显而易见，添加随机截距是有意义的，但对于随机斜率却不是这样。还有，治疗的效果几乎没有。最后但同样重要的是，一张漂亮的桌子可以给朋友和同事留下深刻印象，展示你在混合模型中付出的努力。</p><div class="kh ki kj kk fd ab cb"><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/738f607bb3b0e45df09b373a133c2c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*v1s4h8sNPrTDEdXIkUYTTg.png"/></div></figure><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/44e4bd37fc015c564db2925526dc2908.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*BcyhINE3dHbdTjhqpVrq5Q.png"/></div></figure><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/11ad41d41324a31141f18e497ca80c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*B0-sxpvAUqhU41HKCYsPWA.png"/></div></figure></div><div class="ab cb"><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/1ceae463e696f2e1894bec516ab81cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*olMk-8uC29WLiGdLhXw26A.png"/></div></figure><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/0416096cdb15a0581a898a61a20d5ba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*-JV0ijAyQ6n5S86T3meVrA.png"/></div></figure><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/18db58582df0b29af5b699f01d78222e.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*taki6q1mvzVTRgnRu0-Yqw.png"/></div></figure></div><div class="ab cb"><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/30c60e6c318bfb4e6c709486d6cfec55.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*pqglb9N2LghlOAXeGrqtGw.png"/></div></figure><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/21437e70742470b90f791f0205b374ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*PMLneXDOlac62Cc5kBschg.png"/></div></figure><figure class="lb kl lm ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/71ae2105e9f68c5c2415dd0f950dd943.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*HpkHUQERL4ez8FrxxfaZHw.png"/></div></figure></div><div class="ab cb"><figure class="lb kl mo ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/83a12278c2c55d751917905109c0ee03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*WalcHOYMw7ELROpi4sy13Q.png"/></div></figure><figure class="lb kl mo ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/de98821fc6db43a27f804865437407e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*-ngTQGKp_4ppwGbgpY5mLg.png"/></div></figure></div><div class="ab cb"><figure class="lb kl mt ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/5a5fdbe582f339cb1a171028c945febf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*d2RvM7q07B7ApSJ9sPud7w.png"/></div></figure><figure class="lb kl mu ld le lf lg paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/6577988d9d41de25f8de172a65a2f0d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*kCtrn9_GRtQSb5m77bQDhw.png"/></div></figure></div><div class="mv mw ez fb mx my"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mz ab dw"><div class="na ab nb cl cj nc"><h2 class="bd hi fi z dy nd ea eb ne ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nf l"><h3 class="bd b fi z dy nd ea eb ne ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ng l"><p class="bd b fp z dy nd ea eb ne ed ef dx translated">medium.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm kx my"/></div></div></a></div></div></div>    
</body>
</html>