<html>
<head>
<title>Weight of Evidence (WoE) and Information Value (IV) — how to use it in EDA and Model Building?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">证据权重(WoE)和信息价值(IV) —如何在EDA和建模中使用？</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/weight-of-evidence-woe-and-information-value-iv-how-to-use-it-in-eda-and-model-building-3b3b98efe0e8?source=collection_archive---------0-----------------------#2021-09-05">https://medium.com/mlearning-ai/weight-of-evidence-woe-and-information-value-iv-how-to-use-it-in-eda-and-model-building-3b3b98efe0e8?source=collection_archive---------0-----------------------#2021-09-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5d6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">证据权重(WoE)和信息价值(IV)可用于理解独立变量的预测能力。WoE有助于理解某一类独立变量是否具有更高的好坏分布。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/490b67b401aa0dc98207fc84ef65ecff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*nolqSLc4K5WekDkbpFevdg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Image by author</figcaption></figure><h1 id="2cc0" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">如何计算WOE和IV？</h1><p id="df42" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">如果我们考虑一个二元分类，其中我们的目标变量是不良(0) /良好(1)贷款，我们有一个称为年龄组的特征，有3个类别(18-35，36-55，56-70)，我们可以使用下面的等式计算每个类别的权重系数:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kr"><img src="../Images/9d539924531b4d2d9b46ef7a552a3568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*ydBoxGrvXpo54yEeLDzzMA.png"/></div></figure><p id="e043" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的示例中，共有7302个良好(1)观察，其中2000个属于18-35岁年龄组。同样，在总共693 (0)个坏观察值中，400个观察值属于18-35类。</p><blockquote class="ks kt ku"><p id="4ee6" class="ie if kv ig b ih ii ij ik il im in io kw iq ir is kx iu iv iw ky iy iz ja jb ha bi translated">18-35岁阶层的悲哀=</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es kz"><img src="../Images/77e01beb60208adc24d4c1c71d5a659c.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*62bxB_tofGH4zzs5aXq7Sg.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es le"><img src="../Images/745dd89481bc5fd147bffdeda74422f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDSw-3IslnFfEC2yq5MZKA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Image by author</figcaption></figure><p id="d456" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">18–35的负WoE值表示18–35岁年龄组的商品的<strong class="ig hi">差</strong> &gt; <strong class="ig hi">分布。</strong></p><p id="8aff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，可以通过使用下面的等式来计算信息值:</p><p id="aa14" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="kv"> IV= WoE *(类中所有好的比例—类中所有坏的比例)</em> </strong></p><p id="63d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，对于18-35岁的阶层，IV =-0.75 *(0.27—. 58)= . 23</p><p id="c2f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">年龄组的总体信息值为= (.23+ .08 + .09) = .40</p><h1 id="8bf1" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">哪里用WoE？</h1><h2 id="4f4c" class="lf jp hh bd jq lg lh li ju lj lk ll jy ip lm ln kc it lo lp kg ix lq lr kk ls bi translated">A.使用WoE分析执行特征的宁滨:</h2><p id="6f68" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">在EDA过程中，我们经常对分类变量和连续变量进行宁滨。假设在一个数据集中，我们将年龄作为连续变量，将好/坏贷款作为分类目标变量。我们可能有兴趣找到为不同年龄组创建分类的逻辑分离。首先，我们创建更多的年龄组，然后计算每个组的权重。如果存在WOE值的单调趋势(下降或上升),那么我们可以确认我们的仓具有一般趋势。如果它不是单调的，那么我们需要压缩容器以形成新的组，并且需要再次检查WOE值。因此，使用WOE，我们可以为进一步的数据分析创建逻辑箱。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lt"><img src="../Images/cb3ceeef7f3f4a1d4afa09f853223064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*44lTJ7ETkU012ey7j9IGaQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Image by author</figcaption></figure><p id="2dc3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们的第一次尝试中，我们为连续变量“年龄”创建了5个箱。但是这里看不到<strong class="ig hi">单调趋势</strong>。因此，在下一次尝试中，我们压缩了两个组并创建了3个bin，如下所示。现在，我们可以看到不同类别“年龄”的单调趋势(WOE值降低)。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es le"><img src="../Images/745dd89481bc5fd147bffdeda74422f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDSw-3IslnFfEC2yq5MZKA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Image by author</figcaption></figure><p id="048e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以遵循相同的方法，将具有较高类别数量的序数和名义分类变量分组到较少数量的箱中。</p><h2 id="66bd" class="lf jp hh bd jq lg lh li ju lj lk ll jy ip lm ln kc it lo lp kg ix lq lr kk ls bi translated"><strong class="ak"> B .使用IV进行二元逻辑回归的特征选择:</strong></h2><p id="1ef3" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">我们可以计算一个独立变量的总体信息值，如果该值在0.30到0.50之间，我们可以认为该变量是一个强预测变量。任何IV小于0.02的变量都可以排除在我们的二元逻辑回归模型之外。下表显示了IV和变量预测能力之间的关系。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lu"><img src="../Images/13b5daf668cb845b3c684bde3a7becc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*prl00Y2OtCtdYj6LmTz2eQ.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Image by author</figcaption></figure><p id="0025" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们之前的例子中,“年龄”的IV = .40，这使得它成为预测我们的目标变量(如果贷款是坏的/好的)的强预测器。</p><h2 id="d3bb" class="lf jp hh bd jq lg lh li ju lj lk ll jy ip lm ln kc it lo lp kg ix lq lr kk ls bi translated">C.使用权重值将连续变量转换为离散变量:</h2><p id="33fd" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">在上面的例子中，我们已经将连续变量“年龄”转换为分类变量，用于执行EDA。我们可以进一步用它们的权重值替换这些类别，然后离散变量“年龄”可以用于我们的逻辑回归模型进行二元预测。它有助于模型变得更加稳定，并且“年龄”的微小变化不会影响模型。但这是有代价的。</p><p id="7a5f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以注意到一个有趣的事实。在将箱的数量从5个减少到3个之后,“年龄”变量的总信息值(IV)也减少了一点。每当我们使用宁滨将一个连续变量转换成一个分类变量或者减少一个分类变量的类别数量时，我们也<strong class="ig hi">失去了该变量的一些预测能力</strong>。</p><p id="58cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果一个变量的总体IV是&lt;= .1 then we consider it as a weak predictor and if IV is in between of .3 and .5 then it’s considered as a very good predictor.</p><h2 id="2898" class="lf jp hh bd jq lg lh li ju lj lk ll jy ip lm ln kc it lo lp kg ix lq lr kk ls bi translated">D. Using WoE value to transform Categorical Variables for model building:</h2><p id="4d9e" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">During Binary Classification using Logistic Regression, it’s required to transform any categorical variables into numeric variables. One Hot Encoding and Label Encoding both have some dis-advantages. I am not going into too many details, but one disadvantage you may think of, when a nominal variable has too many classes and performing One Hot Encoding may lead to the <strong class="ig hi">维数灾难</strong>。</p><p id="94ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">WOE评分可用于将分类变量转换为数值变量。不同类别的计算的WOE值可以用来代替它们的实际值。因此，不需要为模型构建执行任何单独的编码。</p><p id="1f6c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">缺失值也可以分组</strong>(比如“未知”类)，并且可以用计算出的WoE值进行估算。</p><p id="20bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">WoE是一种简单而强大的方法，在探索性/验证性数据分析和二元逻辑回归模型构建中非常有用。你需要记住，WoE和信息值主要是针对二元logistic回归模型的。如果你打算使用任何其他分类算法，如<strong class="ig hi"> SVM，决策树或随机森林，那么它不会给你最佳结果</strong>。你能想到的一个原因，决策树或随机森林能识别自变量和目标变量之间的非线性关系。基于IV选择特征可能导致从模型中排除相关特征。</p></div></div>    
</body>
</html>