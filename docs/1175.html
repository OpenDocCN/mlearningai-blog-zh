<html>
<head>
<title>Behavior Sequence Transformer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">行为序列转换器</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/behavior-sequence-transformer-c9bf7308c463?source=collection_archive---------0-----------------------#2021-10-18">https://medium.com/mlearning-ai/behavior-sequence-transformer-c9bf7308c463?source=collection_archive---------0-----------------------#2021-10-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e6cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> ** <em class="jc">论文研究阿里巴巴的SOTA RecSys ** </em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/8874c7179666154bb25ccd3dc803c866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z4UgekKsP7Nc8usy"/></div></figure><p id="a0d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博客中，我将尝试解释BST的一些关键概念，以及其中的哪些因素可以改变游戏规则。如果你不熟悉基于transformer的架构，那么我推荐你阅读这篇文章:<a class="ae jl" href="http://jalammar.github.io/illustrated-transformer/" rel="noopener ugc nofollow" target="_blank">图解Transformer </a>。</p><h1 id="b450" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">概观</h1><p id="856b" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">顺序深度学习模型已经在推荐行业中证明了其优势，可以根据用户过去的行为顺序生成更相关和动态的推荐。BST是阿里巴巴(由陈启伟等人)承担的电子商务推荐系统。在这里找到研究论文:<a class="ae jl" href="https://arxiv.org/pdf/1905.06874.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1905.06874.pdf</a></p><p id="f0bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇论文中，他们提出使用强大的Transformer模型来捕捉阿里巴巴用户行为序列背后的序列信号，以进行推荐。<br/>阿里巴巴的RecSys是一个<strong class="ig hi">两级管道</strong>:匹配和排名。</p><ul class=""><li id="4395" class="kp kq hh ig b ih ii il im ip kr it ks ix kt jb ku kv kw kx bi translated">在匹配中，根据用户交互的项目选择一组相似的项目(<a class="ae jl" href="https://arxiv.org/pdf/1803.02349.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1803.02349.pdf</a></li><li id="9168" class="kp kq hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">然后学习微调预测模型来预测用户点击给定候选项目集的概率。</li></ul><h1 id="cbcd" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">模型架构</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ld"><img src="../Images/e2d7db2f3a8cec7a53de0eace5e84e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C1pMerq0ZwzvzZ5pkQg3CQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx">The overview architecture of the proposed BST</figcaption></figure><p id="ac65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">BST的3个关键组成部分:</p><ul class=""><li id="0a5a" class="kp kq hh ig b ih ii il im ip kr it ks ix kt jb ku kv kw kx bi translated"><strong class="ig hi">嵌入层</strong></li><li id="df3b" class="kp kq hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated"><strong class="ig hi">变压器层</strong></li><li id="f338" class="kp kq hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated"><strong class="ig hi"> MLP </strong></li></ul><p id="6011" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">他们使用了transformer架构的编码器，该架构利用自我关注来组合来自用户过去交互的信号。<strong class="ig hi">自我关注是一种非常有效的机制，可以捕捉用户兴趣的任何近期变化，同时还能保持长期的环境。</strong></p><h1 id="ba3a" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">输入嵌入</h1><p id="11e7" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">这一层对来自交互、用户和项目数据的各种特征进行整形，并将它们加在一起以创建最终的输入向量，该向量将被输入到转换器的编码器层。</p><p id="7549" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有两种类型的特征来表示一个项目，“T21”序列项目特征(在<strong class="ig hi">红色</strong>)和“<strong class="ig hi">位置特征</strong>”(在<strong class="ig hi">深蓝色</strong>)，其中“序列项目特征”包括item_id和category_id。<br/>有各种各样的特征，像用户简档特征、条目特征、上下文特征，以及不同特征的组合，即交叉特征。由于这项工作的重点是使用transformer对行为序列进行建模，因此他们将所有这些特性都标记为“<strong class="ig hi">其他特性</strong>”。</p><p id="b263" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然特征的组合可以由神经网络自动学习，但它们仍然包含一些手工制作的交叉特征，这些特征在深度学习时代之前已经在我们的场景中被证明是有用的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/988107d0a284f8c046a84994ca5b4364.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*FJBlL7Qx5ZPNkbDW3nbRuQ.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx">Other Features</figcaption></figure><p id="dd4c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">序列项目特征在潜在空间的表征方式已经在<a class="ae jl" rel="noopener" href="/@dungcamlang/paper-reading-billion-scale-commodity-embedding-for-e-commerce-recommendation-in-alibaba-e97bd5d32318">这里</a>详细讨论过了。</p><p id="b5c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在这里有趣的部分是<strong class="ig hi">的位置特征。</strong>作者提出了一种位置嵌入来捕捉句子中的顺序信息。同样，顺序存在于用户的行为序列中。因此，添加“位置”作为底层中每个项目的输入特征，然后将其投影为低维向量。<br/>注意，项目v(i)的位置值计算为pos(VI)= t(vt)-t(vi)，其中t(vt)表示推荐时间，t(VI)表示用户点击项目v(i)时的时间戳。<br/> <em class="jc">注意:基于正弦的相对时间编码比使用以天为单位的绝对相对时间作为特征执行得更好。</em></p><h1 id="de47" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">MLP层和损失函数</h1><p id="1b03" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated">通过连接其他功能的嵌入和应用于目标项目的Transformer层的输出，然后使用三个完全连接的层来进一步学习密集功能之间的交互，这是工业RecSys中的标准实践。<strong class="ig hi">为了预测用户是否会点击目标项目v(t)，他们将其建模为二元分类问题</strong>，从而使用sigmoid函数作为输出单元。为了训练模型，他们必须使用交叉熵损失。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ln"><img src="../Images/39eaef7635593c48a84cdd6e912e477b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*JhYmsrtI4MOq-47Ybp-cmg.png"/></div><figcaption class="li lj et er es lk ll bd b be z dx">Configuration</figcaption></figure><p id="f687" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">实验结果证明了该模型的优越性，该模型在淘宝网上部署后，在线点击率(CTR)较两种基线有显著提高。</p><h1 id="252b" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">修改</h1><p id="df13" class="pw-post-body-paragraph ie if hh ig b ih kk ij ik il kl in io ip km ir is it kn iv iw ix ko iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">对原BST模型中实验的修改如下:</em> </strong></p><ol class=""><li id="ae56" class="kp kq hh ig b ih ii il im ip kr it ks ix kt jb lo kv kw kx bi translated"><strong class="ig hi"> <em class="jc">将特征纳入到对输入序列的每一项和目标项的嵌入的处理中，而不是作为变换层之外的“其他特征”来对待。</em>T19】</strong></li><li id="456a" class="kp kq hh ig b ih ky il kz ip la it lb ix lc jb lo kv kw kx bi translated"><strong class="ig hi"> <em class="jc">利用输入序列中的评级或用户反馈，以及它们在序列中的位置，在将它们馈送到自我关注层之前更新它们。</em> </strong></li><li id="feee" class="kp kq hh ig b ih ky il kz ip la it lb ix lc jb lo kv kw kx bi translated"><strong class="ig hi">跨所有类别概率使用Softmax，使模型学习多类别分类。</strong></li><li id="6ea3" class="kp kq hh ig b ih ky il kz ip la it lb ix lc jb lo kv kw kx bi translated"><strong class="ig hi">根据用户的点击进行个性化。计算从用户点击和被点击体验的类别中导出的两个特征:<br/> *类别强度:</strong>具有该特定类别的体验上的用户点击的加权总和，<br/> * <strong class="ig hi">类别新近度:</strong>自从用户最后一次点击该类别中的体验以来经过的天数。<br/> <em class="jc">注意:</em> <em class="jc">用户可能已经点击了具有不同强度和新近度的许多不同类别，但是当针对需要排序的特定体验计算特征时，我们使用该体验类别的强度和新近度。</em></li></ol></div></div>    
</body>
</html>