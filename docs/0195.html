<html>
<head>
<title>Intro to the Viterbi Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">维特比算法简介</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/intro-to-the-viterbi-algorithm-8f41c3f43cf3?source=collection_archive---------1-----------------------#2021-03-02">https://medium.com/mlearning-ai/intro-to-the-viterbi-algorithm-8f41c3f43cf3?source=collection_archive---------1-----------------------#2021-03-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/16eb9162000a0f27dd687114f7287c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTKyphhVdK5g-HoCSljQOw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@jeffreyfotografie?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Jeffrey Brandjes</a> on <a class="ae it" href="https://unsplash.com/s/photos/sequence?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7ee5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在上一篇关于隐马尔可夫模型(HMM)的文章中，我们没有解决找到最可能使用的硬币序列的问题。如果你没有看过HMMs上的帖子，我强烈建议你去看看。对于那些不知道的人，我将概述这个问题。假设某个古鲁走到你面前，告诉你从一个袋子里拿一枚硬币(袋子里只有两枚硬币)，然后把硬币抛起来。你会看到一个头或者一条尾巴。然后你把硬币放回袋子里，再重复3次。你观察头，尾，尾，头。古鲁说如果你猜对了顺序，他会给你一百万美元。古鲁给了你一个嗯。找到最可能的序列将产生最大的获胜机会，但是我们如何找到它呢？正如你可能已经猜到的标题，我们可以使用维特比算法。</p><h1 id="d346" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么是维特比算法？</h1><p id="dbad" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">维特比算法是用于寻找最可能的隐藏状态序列的动态规划解决方案。如果我们有一组状态Q和一组观测值O，我们试图找到使P(Q|O)最大化的状态序列。通过条件概率，我们可以将P(Q|O)转换为P(Q，O)/P(O)，但是没有必要寻找P(O ),因为P(O)与状态序列的变化无关。我们可以找到使P(Q，O)最大化的状态序列。让我们深入研究P(Q，O)的公式。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kv"><img src="../Images/8789f8ba5ef42899d909697b996a0a73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J1innFG8-G_xLsQt-WJDag.jpeg"/></div></div></figure><p id="1089" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">注:</strong> T为序列中的观测值个数。如果您需要复习HMM模型中使用的符号，我建议您查看我在HMM上的帖子。</p><p id="ba52" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，如果我们想找到最大化P(Q，O)的状态序列，你可以想象这将是非常昂贵的，因为我们必须最大化所有可能的状态序列的P(Q，O)。这就是维特比算法的用武之地。维特比算法是求解最可能序列的迭代方法。我们不是为所有的观测值寻找最可能的隐藏状态序列，而是想找到下一个最可能的隐藏状态。我们反复寻找最可能的状态，直到我们完成了一系列的观察。</p><h1 id="ee3a" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">维特比算法</h1><p id="2cec" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">在我们深入研究这些步骤之前，我们应该为维特比算法指出一些符号。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/613e5b70261ae6ce6d4983f63e03d841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QG5BvbpQSesve7Zw433Dig.jpeg"/></div></div></figure><p id="694d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">维特比算法由<strong class="iw hi">三个</strong>步骤组成。</p><p id="2bd2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第一步:初始化</strong></p><p id="6096" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们首先创建一个起始状态q*。然后我们找到初始状态的概率和给定初始状态的观测值。在这种情况下，P(qi|q*)是起始状态为qi的概率。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lb"><img src="../Images/bccee0e430ebdd3ec58ce3a830783f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*if6gJbaIm-uO3k3fgqf4MQ.jpeg"/></div></div></figure><p id="7418" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第二步:诱导</strong></p><p id="1996" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当T大于或等于2且小于或等于T时，我们执行归纳步骤，其中T是观察值的数量+ 1(加1来自添加的起始状态)。t代表观察总数。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lc"><img src="../Images/3b3f488c926826a3fe4fc526d65f4f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VAJXZn6vOK6aL4JylivmQg.jpeg"/></div></div></figure><p id="e3cc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第三步:终止</strong></p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ld"><img src="../Images/8df8ead903f026b558adec0481e6d849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-1KE7x73tQqxGEJvLNJFw.jpeg"/></div></div></figure><h1 id="716e" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">例子</h1><p id="9f66" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">让我们想想我们是否能得奖。如前所述，古鲁给了我们一个HMM，让我们更有可能赢得奖金。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es le"><img src="../Images/fcf0dd32889533bcb79bc3837a77e7a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sh9ZAjdrKaIRLuKqsK-DUA.jpeg"/></div></div></figure><p id="f15c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以，让我们继续，开始寻找我们观察头，尾，尾，头时最可能的隐藏状态序列。我喜欢用格子来形象化维特比算法(下图)。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lf"><img src="../Images/8e9b827bcdf3ecb249439489e2b28269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7aJ8gBm30mhK6uMMk7zDiw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Trellis for coin flip</figcaption></figure><p id="5494" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据算法的定义，在执行归纳步骤之前，我们需要首先进行初始化。</p><p id="552d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">初始化步骤</strong></p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lg"><img src="../Images/cab5999916f918100ca63d8ef537b3a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q0JLqKWlvG6HjMQFChwFFA.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Initialization step</figcaption></figure><p id="2931" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这里，我们计算在时间步长1观察硬币1和硬币2的概率。我们用初态分布代替用户P(qi | q*)。现在我们已经在时间步骤1初始化了函数，我们可以开始归纳步骤。</p><p id="003b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">t = 2时的感应步骤</strong></p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lh"><img src="../Images/5b6f00212907304a3197e8fc158deaea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pE5cQ1CVFTotok1YaoxGGg.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Induction step at time t=2 for coin 1</figcaption></figure><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es li"><img src="../Images/3423a0e30bfb4c6c15922cd51763b62e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DtddWe5ARRmDi6GquxqaPw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Induction step at time t=2 for coin 1</figcaption></figure><p id="0764" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">记住，在归纳步骤中，我们希望发现t-1时刻的状态使函数最大化。我们通过取最大化δ函数的状态来做到这一点。我们对当前时间步中的所有状态都这样做。这里我们看到，如果我们在时间步骤2处于状态硬币1，则在时间步骤2使概率最大化的硬币是硬币1，如果我们在时间步骤2处于状态硬币2，则硬币2使概率最大化。</p><p id="e50a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我不想让博客的主要部分陷入计算的泥沼，所以如果有人想看的话，我会把它们添加到博客的底部。在我们完成计算之后，我们发现具有最大可能性的序列具有大约1.2%的概率。这让我们得出这样的结论:尽管我们做了这么多努力，我们很可能不会赢得这场比赛。至于最有可能的序列，硬币1，硬币1，硬币1，硬币1。如此虎头蛇尾的解决问题的方式。</p><h1 id="93d0" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="6dca" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">希望这是对维特比算法的有益介绍。我在考虑未来改变博客的格式，采用数据科学的方法来解决现实世界的问题，比如证明为什么你永远无法在21点或崩溃中成功击败庄家，以及预测比特币的价格。如果你想看到更多的内容，请在下面留言。一如既往，如果你喜欢这个帖子，请确保击碎鼓掌按钮，如果你喜欢这些风格的帖子，请确保关注我。</p><h1 id="458c" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">剩余维特比算法计算</h1><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es li"><img src="../Images/d4865eef5136707e9eb1e4e86ffcceb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*po2m4oBeMS0JP_EyqQrJtA.jpeg"/></div></div></figure><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/78f960ffb41964e7d47c6724050d7576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0iVFizvOBvYqPG9L-IPN2w.jpeg"/></div></div></figure></div></div>    
</body>
</html>