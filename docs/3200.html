<html>
<head>
<title>Machine Learning Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习管道</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/machine-learning-pipelines-ee5357579cf3?source=collection_archive---------3-----------------------#2022-08-02">https://medium.com/mlearning-ai/machine-learning-pipelines-ee5357579cf3?source=collection_archive---------3-----------------------#2022-08-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="cff0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">关于如何使用Scikit Learn构建有效的ML管道的快速复习。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/51a2b82d86e1a7b4247de2ac689aab3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BOrMUiPtLF1zmbOM"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@rstar50?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Roger Starnes Sr</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="3e33" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">介绍</h1><p id="6ea5" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">Scikit-Learn中的流水线是一串<strong class="ig hi">变压器</strong>和一个最终<strong class="ig hi">估计器</strong>。它们一起被称为<strong class="ig hi">管道</strong>。</p><p id="add9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它被设计成一个的输出是另一个的输入。在下图中，您将看到带有1，2，3…，n个<strong class="ig hi">变压器</strong>和一个<strong class="ig hi">估算器</strong>的管道，用于创建管道。</p><p id="cfd7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当输入数据时，这个管道根据模型学习给出预测。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kw"><img src="../Images/d11961f8da13562df47f6e48c4216dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDynWXhwh0ygE6qo-lnXVw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig-1: A simple machine learning Pipeline</figcaption></figure><p id="d3e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">机器学习管道<strong class="ig hi">有助于标准化开发过程，有助于构建高效准确的模型</strong>。</p></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><h2 id="3d7c" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">变形金刚(电影名)</h2><p id="ed19" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">转换器用于清理、过滤或修改数据。这是数据预处理的一部分。</p><p id="9c50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Scikit-learn为不同的活动提供了一个变形库，例如</p><ol class=""><li id="6697" class="ls lt hh ig b ih ii il im ip lu it lv ix lw jb lx ly lz ma bi translated">清理数据(预处理)，</li><li id="e3bd" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">缩小尺寸(维度减少)</li><li id="8702" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">扩展大小(内核近似值)</li><li id="bf05" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">生成要素制图表达(要素提取)</li></ol><p id="e552" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些转换器类别由以下方法表示:</p><ul class=""><li id="01dd" class="ls lt hh ig b ih ii il im ip lu it lv ix lw jb mg ly lz ma bi translated"><code class="du mh mi mj mk b">fit()</code> <em class="ml">方法</em>:从训练集中学习模型参数(如标准化的平均值和标准偏差)</li><li id="e775" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb mg ly lz ma bi translated"><code class="du mh mi mj mk b">transform()</code> <em class="ml">方法</em>:将这种转换模型应用于看不见的数据</li><li id="5166" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb mg ly lz ma bi translated"><code class="du mh mi mj mk b">fit_transform()</code> <em class="ml">方法</em>:对于训练数据的建模和转换，同时进行可能更方便、更高效</li></ul><h2 id="3eb9" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">评估者</h2><p id="43d4" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">估计器是从数据中学习的任何对象。它可以是分类、回归、聚类算法或从原始数据中提取/过滤有用特征的转换器。</p><p id="ea73" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">estimator类实现了以下方法:</p><ul class=""><li id="0b3b" class="ls lt hh ig b ih ii il im ip lu it lv ix lw jb mg ly lz ma bi translated"><code class="du mh mi mj mk b">fit()</code>方法:从数据中学习</li><li id="bcfa" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb mg ly lz ma bi translated"><code class="du mh mi mj mk b">predict()</code>方法:预测结果(回归或分类)</li></ul></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><h1 id="c211" class="jt ju hh bd jv jw mm jy jz ka mn kc kd ke mo kg kh ki mp kk kl km mq ko kp kq bi translated">示例使用案例</h1><p id="56d9" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在这个用例中，我们将使用<strong class="ig hi"> Titanic </strong>数据集。在这个数据集中，我们将在某些列上应用一些常见的转换器，然后我们将使用决策树估计器来对乘客的生死进行分类。</p><h2 id="3fa4" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">计划</h2><p id="5c78" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">这是我们用例的计划大纲。</p><p id="083a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了让我们的用例容易理解，让我们看看下面的图表。这将使您在视觉上对管道有一个相当好的了解。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mr"><img src="../Images/8b5da23a1f8a7fa0b19f3a5565eb9003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UdF0Ry8R_c7m3v4TgHtaTg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig-2: Pipeline with 4 transformers</figcaption></figure><h2 id="f23f" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">资料组</h2><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="3d55" class="le ju hh mk b fi mw mx l my mz"># Importing necessary libraries<br/>import pandas as pd<br/>import numpy as np<br/>from sklearn.datasets import fetch_openml<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.compose import ColumnTransformer<br/>from sklearn.impute import SimpleImputer<br/>from sklearn.preprocessing import OneHotEncoder<br/>from sklearn.preprocessing import MinMaxScaler<br/>from sklearn.pipeline import Pipeline, make_pipeline<br/>from sklearn.feature_selection import SelectKBest, chi2<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn import set_config</span><span id="b233" class="le ju hh mk b fi na mx l my mz"># config to show pipeline visually<br/>set_config(display='diagram')</span></pre><p id="5c3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们已经导入了所有必要的库，让我们从Titanic数据集获取数据</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="09f4" class="le ju hh mk b fi mw mx l my mz"># fetch the data<br/>dataset = fetch_openml("titanic", version=1)</span><span id="9796" class="le ju hh mk b fi na mx l my mz"># check the data<br/>dataset['frame'].head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nb"><img src="../Images/002bbe596768a77092acb52acdca0746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xcfX4S8OgjQkrpclZjp3Hg.png"/></div></div></figure><p id="3550" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们不需要这里的所有特性，所以我们可以安全地忽略一些对我们来说不太重要的特性。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="486d" class="le ju hh mk b fi mw mx l my mz"># features<br/>features = dataset.frame</span><span id="ffbc" class="le ju hh mk b fi na mx l my mz"># drop the columns that we don't need<br/>features = features.drop(['name', 'ticket', 'cabin', 'survived', 'boat', 'body', 'home.dest'], axis=1)</span><span id="bfed" class="le ju hh mk b fi na mx l my mz"># check the features<br/>features.head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nc"><img src="../Images/821b3c97425ecf9cce4875a356437e42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u9eyZQLz_fGO0tm1JyFFQQ.png"/></div></div></figure><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="804f" class="le ju hh mk b fi mw mx l my mz"># columns description</span><span id="dcf8" class="le ju hh mk b fi na mx l my mz">"""<br/>pclass: passenger class<br/>name: name of passenger<br/>sex: male or female<br/>age: age of passenger<br/>sibsp: siblings of other passenger<br/>parch: number of parent-child<br/>fare: ticker fare<br/>embarked: passenger boarded from (There are three possible boarding points: Southampton[S], Cherbourg[C], Queenstown[Q])<br/>"""</span></pre><p id="d139" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个数据集还带有目标列。因此，让我们从它的目标列。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="cd89" class="le ju hh mk b fi mw mx l my mz"># target<br/>target = dataset.target</span><span id="5b1e" class="le ju hh mk b fi na mx l my mz"># check the target<br/>target.head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nd"><img src="../Images/d6091b63ced6bf7334f1ec407af5ac73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*umf9FAJkl6THNnsiu603Rg.png"/></div></div></figure><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="12d0" class="le ju hh mk b fi mw mx l my mz"># train-test split<br/>X_train, X_test, y_train, y_test = train_test_split(features, target, test_size=0.2, random_state=42)</span><span id="3d31" class="le ju hh mk b fi na mx l my mz"># see the sample training on features<br/>X_train.head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ne"><img src="../Images/a935fe37bcb8cc6be2f36bc682397cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rx9j93v07BzM_QX5nbjMVQ.png"/></div></div></figure><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="314a" class="le ju hh mk b fi mw mx l my mz"># see the training data on target<br/>y_train.head(5)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nf"><img src="../Images/028f25a79ca2b4a07538423c51bee5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RN2M8FLT_Sx0bJuX5K7cVA.png"/></div></div></figure><h2 id="37c2" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">变形金刚(电影名)</h2><p id="fc2f" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">变压器是管道的重要组成部分。这将把数据转换成各种形式，如清理、缩放或特征工程。这些被称为<code class="du mh mi mj mk b">ColumnTransformers</code>。</p><p id="0969" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，按照下面的图表，我们将一个接一个地实现变压器。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mr"><img src="../Images/8b5da23a1f8a7fa0b19f3a5565eb9003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UdF0Ry8R_c7m3v4TgHtaTg.png"/></div></div></figure><p id="9f1a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是使用的变压器:</p><ol class=""><li id="3bbf" class="ls lt hh ig b ih ii il im ip lu it lv ix lw jb lx ly lz ma bi translated">插补:这里我们将使用<code class="du mh mi mj mk b">SimpleImputer</code>变压器</li><li id="7786" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">一热编码:这里我们将使用<code class="du mh mi mj mk b">OneHotEncoder</code>变压器</li><li id="27b2" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">特征缩放:这里我们将使用<code class="du mh mi mj mk b">MinMaxScaler</code>变压器</li><li id="a030" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">特性选择:这里我们将使用<code class="du mh mi mj mk b">SelectKBest</code>变压器</li></ol><p id="43d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们将使用一个分类器来预测我们的结果。这里我们就用<code class="du mh mi mj mk b">DecisionTreeClassifier</code>。</p><h2 id="6381" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">简单输入变压器</h2><p id="7a13" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在这个转换器中，我们将检查数据集是否有丢失的值。</p><p id="08a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于将有缺失值的列，我们必须应用SimpleImputer来处理缺失值。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="f359" class="le ju hh mk b fi mw mx l my mz"># check for missing values<br/>features.isnull().sum()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ng"><img src="../Images/954fdc662e212c2115f506763bbfec0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wnsF25R5rgjsVHW9fycfFw.png"/></div></div></figure><p id="b890" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到<code class="du mh mi mj mk b">age</code>列和<code class="du mh mi mj mk b">embarked</code>列缺少值。在<code class="du mh mi mj mk b">fare</code>上，只缺少一列，所以我们在这里尽量忽略它。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="b4af" class="le ju hh mk b fi mw mx l my mz"># Imputation tansformer<br/>trfOne = ColumnTransformer(<br/>[('impute_age', SimpleImputer(), [2]),<br/>('impute_embarked', SimpleImputer(strategy='most_frequent'), [6])],<br/>remainder='passthrough')</span><span id="6cb9" class="le ju hh mk b fi na mx l my mz"># check if correctly set<br/>trfOne</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nh"><img src="../Images/3f77d93519d934f8a18a4f7ed98d322b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WRAfaoMoNSOEx6XMJRlkiw.png"/></div></div></figure><h2 id="7d67" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">OneHotEncoder变压器</h2><p id="9136" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">将分类特征编码为一个独热数值数组。</p><p id="ac25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们的数据集中，我们看到<code class="du mh mi mj mk b">sex</code>列有分类数据(男性或女性)，而<code class="du mh mi mj mk b">embarked</code>列有分类数据(Q或S或C)。</p><p id="2a1e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们以数值的形式提供所有的列，我们的模型会表现得更好。为此，我们将对<code class="du mh mi mj mk b">sex</code>列和<code class="du mh mi mj mk b">embarked</code>列应用OneHotEncoder。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="f302" class="le ju hh mk b fi mw mx l my mz"># OneHotEncoding transformer<br/>trfTwo = ColumnTransformer(<br/>[('ohe_sex_embarked', OneHotEncoder(sparse=False,<br/>handle_unknown='ignore'), [1,6])],<br/>remainder = 'passthrough')</span><span id="89df" class="le ju hh mk b fi na mx l my mz"># check if correctly set<br/>trfTwo</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ni"><img src="../Images/e1963e8f80f49285f9670425ae69432a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KsstMLETsKH9UX9qL7Rf8Q.png"/></div></div></figure><h2 id="546e" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">缩放变压器</h2><p id="2a1a" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在这个转换器中，我们将使用Scikit-learn MinMaxScaler缩放值。这将应用于所有数字列。由于不同的列有不同的值，因此缩放将使它们达到统一的比例。</p><p id="268f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你有兴趣了解更多关于缩放的知识，我有一个专门的博客。点击查看链接<a class="ae js" rel="noopener" href="/@sc050409/the-modern-rules-of-feature-scaling-in-machine-learning-236b1ce4f818">。</a></p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="2eb8" class="le ju hh mk b fi mw mx l my mz"># Scaling Tranformer<br/>trfThree = ColumnTransformer([('scale', MinMaxScaler(), slice(0,10))])</span><span id="fd2e" class="le ju hh mk b fi na mx l my mz"># check the transformer<br/>trfThree</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nj"><img src="../Images/a53b64f918f9fb7ce0bf1b93fb2af16d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vEwcw9Y6lKGFXctMH6ExLQ.png"/></div></div></figure><p id="1c53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您仔细注意，我已经将MinMaxScaler应用于从0到10的所有列。你应该想知道当我们只有7列时，为什么我们选择10列。</p><p id="6d6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">答案很简单，当我们进行OneHotEncoding时，我们会删除两个列<code class="du mh mi mj mk b">sex</code>和<code class="du mh mi mj mk b">embarked</code>，但随后我们还会再添加2个与<code class="du mh mi mj mk b">sex</code>相关的列和3个与<code class="du mh mi mj mk b">embarked</code>相关的列。OneHotEncoding就是这么做的。点击查看详情<a class="ae js" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="96af" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">特征选择转换器</h2><p id="74e4" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">为了选择特性，我们将使用Scikit-Learn的SlectKBest。顾名思义，这将帮助我们从算法将挑选的所有特征列表中选择前K个最佳特征。我们还将使用chi2，这是一种评分算法，用于根据分数选择最佳特性。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="daab" class="le ju hh mk b fi mw mx l my mz"># feature selection<br/>trfFour = SelectKBest(score_func=chi2, k=5)</span><span id="df29" class="le ju hh mk b fi na mx l my mz"># see the details<br/>trfFour</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nk"><img src="../Images/d4380cbcd62060d12beec36b49a0fbf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jnPGv9dESF0gmDpRf7GJpw.png"/></div></div></figure><h2 id="9f4f" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">编码器</h2><p id="5f45" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">现在，当我们准备好所有的转换器后，我们将把转换后的数据输入编码器。这些只是机器学习模型，现在将从这些转换的数据中学习并做出预测。</p><h2 id="6ac4" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">决策树分类器</h2><p id="5a03" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">对于这个问题，我们将使用决策树分类器。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="6c7b" class="le ju hh mk b fi mw mx l my mz"># Encoder<br/>trfFive = DecisionTreeClassifier()</span><span id="8eeb" class="le ju hh mk b fi na mx l my mz"># details<br/>trfFive</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nl"><img src="../Images/4591dfda815e6066c3a9a2283ef929b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-6AeazEHeY8Ox46gH5JBg.png"/></div></div></figure><h2 id="075c" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">完整管道</h2><p id="d062" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">有了这个，我们就完成了我们的计划。现在让我们再看一下图表，这样我们就知道我们在做什么了</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mr"><img src="../Images/b558873685d21457aafe1fdb62455371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z-VM74vshAdRbj4hhzo-Kg.png"/></div></div></figure><h2 id="370d" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">管道</h2><p id="059a" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">这里，我们将在上述所有转换器和编码器的帮助下创建我们的管道。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="4ec5" class="le ju hh mk b fi mw mx l my mz"># pipeline<br/>pipe = Pipeline([('trfOne', trfOne),('trfTwo', trfTwo),('trfThree', trfThree),('trfFour', trfFour),('trfFive', trfFive)])</span><span id="6d63" class="le ju hh mk b fi na mx l my mz"># details<br/>pipe</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nm"><img src="../Images/d53c950d4e8c6c49a6c38db36ed041ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HJITr0xkdIx9s4J4OTk7cQ.png"/></div></div></figure><h2 id="3dfc" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">制作管道</h2><p id="e9b2" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">还有一种创建管道的方法。除了直接使用Pipeline，我们还可以使用make_pipeline()。这里我们不必声明每个管道的名称。我们只需要调用这个函数中的所有组件。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="7981" class="le ju hh mk b fi mw mx l my mz"># make_pipeline<br/>pipe = make_pipeline(trfOne, trfTwo, trfThree, trfFour, trfFive)</span><span id="19ea" class="le ju hh mk b fi na mx l my mz"># check details<br/>pipe</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nn"><img src="../Images/c6b9ae72c082147f96652275e3bd9278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MSOyshUGmOT05zXf4dTZnQ.png"/></div></div></figure><h2 id="ea68" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">培养</h2><p id="a4fc" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">现在我们已经准备好了管道，我们现在必须使用这个管道来训练我们的数据，看看它是否能够预测预期的结果。</p><p id="c9d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但在此之前，如果我们调用我们的<code class="du mh mi mj mk b">pipe.fit()</code>方法，它也会给我们整个管道的图。获得管道的可视化表示有多种好处。例如，有人可能只知道你对数据做了什么操作。看看这个。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="fdd6" class="le ju hh mk b fi mw mx l my mz"># train the pipeline and display the graph<br/>pipe.fit(X_train, y_train)</span><span id="9392" class="le ju hh mk b fi na mx l my mz"># display the steps<br/>pipe.named_steps</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es no"><img src="../Images/55b5c1cae60a9759637072afeedf3622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OrbuFObwRW0B9hvX-Eoe1w.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es np"><img src="../Images/f18626757e6e561557743a259f5f9c41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-WpwcabesEa3LNoR9g2Mw.png"/></div></div></figure><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="62bf" class="le ju hh mk b fi mw mx l my mz"># display sigle step<br/>pipe.named_steps['columntransformer-1']</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nq"><img src="../Images/3d1c80041a6205a0c186250ee697cedb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZCSlnAhtHaKkV3WmSd6mQ.png"/></div></div></figure><h2 id="bb6c" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">预言；预测；预告</h2><p id="1716" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">既然我们已经在数据上训练了我们的管道，现在是时候进行一些预测，并检查我们的模型是否从数据中学到了一些东西。</p><pre class="jd je jf jg fd ms mk mt mu aw mv bi"><span id="ecf9" class="le ju hh mk b fi mw mx l my mz"># predict<br/>y_pred = pipe.predict(X_test)</span><span id="3b68" class="le ju hh mk b fi na mx l my mz"># check the prediction score<br/>from sklearn.metrics import accuracy_score<br/>accuracy_score(y_test, y_pred)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nr"><img src="../Images/66bbacf0baea24e2f58a673da97cea87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FL4qRzFUEsNULkRX9mAMvA.png"/></div></div></figure><p id="ac12" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们可以看到，我们的模型对其预测几乎没有60%的信心。由于我们的重点是了解如何在这里建立一个管道，所以我们不会太关心准确性得分。</p></div><div class="ab cl kx ky go kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ha hb hc hd he"><h1 id="94c1" class="jt ju hh bd jv jw mm jy jz ka mn kc kd ke mo kg kh ki mp kk kl km mq ko kp kq bi translated">结论</h1><p id="c9ed" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">这篇博客的目标是理解管道的概念以及如何自己构建一个管道。所以我们可以放心地忽略这里的模型分数。</p><p id="4834" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们试图按照计划一步一步地建立管道，并取得了成功。</p><p id="da42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这只是向您展示，如果您使用Pipeline，这可以减少多少工作量。</p><blockquote class="ns nt nu"><p id="d7c6" class="ie if ml ig b ih ii ij ik il im in io nv iq ir is nw iu iv iw nx iy iz ja jb ha bi translated">代码看起来整洁干净。它也可以投入生产。您可以在项目代码中部署这个管道，并开始获得预测。</p></blockquote><h2 id="097a" class="le ju hh bd jv lf lg lh jz li lj lk kd ip ll lm kh it ln lo kl ix lp lq kp lr bi translated">在你走之前…</h2><p id="5867" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在这篇博客中，我们学到了以下内容:</p><ol class=""><li id="9185" class="ls lt hh ig b ih ii il im ip lu it lv ix lw jb lx ly lz ma bi translated">机器学习中的流水线是什么</li><li id="94f3" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">什么是变压器和编码器</li><li id="abae" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">如何建立管道</li><li id="87bd" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">如何用实际数据进行训练和测试</li><li id="7be6" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">如何将其部署到生产中</li></ol><p id="ec12" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你跟随我到这里，我相信你一定已经对机器学习中的流水线以及如何使用它们有了很好的了解。</p><div class="ny nz ez fb oa ob"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="oc ab dw"><div class="od ab oe cl cj of"><h2 class="bd hi fi z dy og ea eb oh ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="oi l"><h3 class="bd b fi z dy og ea eb oh ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="oj l"><p class="bd b fp z dy og ea eb oh ed ef dx translated">medium.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op jm ob"/></div></div></a></div></div></div>    
</body>
</html>