<html>
<head>
<title>SimCSE: Simple Contrastive Learning of Sentence Embeddings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SimCSE:句子嵌入的简单对比学习</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/simcse-simple-contrastive-learning-of-sentence-embeddings-54e90a99cc2c?source=collection_archive---------1-----------------------#2022-01-05">https://medium.com/mlearning-ai/simcse-simple-contrastive-learning-of-sentence-embeddings-54e90a99cc2c?source=collection_archive---------1-----------------------#2022-01-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d586be501796c8959345d39d30d671d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ilbzxqb2pWgIX5iifTSrFA.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@geoffpinkney?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Geoff Pinkney</a> on <a class="ae it" href="https://unsplash.com/s/photos/two-trees?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ff72" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">句子级表示一直是自然语言处理中的一个热门话题。在BERT之前，我们使用word2vec模型对句子中的单词嵌入进行平均。在BERT时代，我们通过使用CLS令牌来获得句子级表示，从而利用大型语言模型。</p><p id="356c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本文介绍了SimCSE(简单对比句嵌入框架)，一篇在EMNLP2021上被接受的论文。<a class="ae it" href="https://arxiv.org/abs/2104.08821" rel="noopener ugc nofollow" target="_blank">纸张</a>和<a class="ae it" href="https://github.com/princeton-nlp/SimCSE" rel="noopener ugc nofollow" target="_blank">代码</a>。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es js"><img src="../Images/b9bd3c8c39689da78080e8d14d5189ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FaGwXLk7gVAKtJvGx4WpHw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">From paper. We will only discuss the left part.</figcaption></figure><p id="58b3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我将分四个部分介绍这篇论文:对比学习背景、无监督模拟、各向异性和实验结果。请注意，本文还讨论了监督版本，但这不是本文的重点。</p><h2 id="8aa6" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jf ki kj kk jj kl km kn jn ko kp kq kr bi translated">对比学习背景</h2><p id="5bd2" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn kw jp jq jr ha bi translated">对比学习的目标是聚类相似的数据点，并在嵌入空间中“推开”不相似的数据点。输入是一组成对的例子，其中两个数据点在语义上是相关的。那么训练目标如下所示，其中h是从BERT模型嵌入的句子。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kx"><img src="../Images/b2e464f02fd5d7c1d606608eaf16e60a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRVK_ufKRzwEq3NKCMJXew.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">From paper. Performance is the highest when \tau is 0.05</figcaption></figure><p id="04a7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通常，我们必须在小批量中构建配对。在CV任务中，我们可以简单地旋转或翻转图片，以获得高质量的“语义”相关的图片。但是在NLP任务中，对句子的一个简单的修改，甚至一个简单的转换都可能彻底改变抽象的意思。</p><p id="a670" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本文的主要贡献是使用标准的dropout运算来生成高质量的训练对。它是可扩展的，在NLP任务中使用的常规数据扩充中更好。</p><p id="b862" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们如何衡量对比学习的质量？答案是对齐和统一。比对用于计算配对之间距离的期望值，而一致性用于测量嵌入的展开程度。(假设嵌入在潜在空间中形成了一个超球面)详细的分析，请查看<a class="ae it" href="http://proceedings.mlr.press/v119/wang20k/wang20k.pdf" rel="noopener ugc nofollow" target="_blank">的论文</a>“通过超球面上的对齐和一致理解对比表征学习”。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/288cc3559278622f3df76fbe7aefdfe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*OWo1-mEtV4fVkkJ10kEHdw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Alignment formula</figcaption></figure><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kz"><img src="../Images/ecf1b6cc5fec82a223c5bc88cf83e5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wb4RXRRacE_oAAb18dc7_Q.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Uniformity formula</figcaption></figure><h2 id="4d01" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jf ki kj kk jj kl km kn jn ko kp kq kr bi translated">无监督SimCSE</h2><p id="743b" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn kw jp jq jr ha bi translated">给定一组句子，我们使用同一个句子两次作为输入，由于BERT模型中的丢失操作，将得到两个不同的嵌入。然后我们使用这两个作为训练目标的正对。这在概念上非常有用和简单:即使从一开始对于同一个句子，嵌入也不会相同，因此最小的数据扩充自然也是如此。</p><p id="755b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在下图中，作者比较了标准删除和其他增强技术的性能，如裁剪、单词删除、同义词替换或屏蔽语言模型。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/9b61bfdeb4091973aca0b2907f1b203e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZRDpZGvNwRkNvVn4zThEg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">From paper. Comparison of data augmentations on STS-B development set (Spearman’s correlation)</figcaption></figure><p id="970e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，本文还表明，无监督SimCSE的训练目标优于传统的下一句预测和两个分离的编码器。</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lb"><img src="../Images/a64fb786d2ae2a32f23d1fe5892ab422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d59PmpK3-P52KNIL9C8Q6A.png"/></div></div></figure><p id="f96e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据实验，当辍学率为<strong class="iw hi"> 0.1 </strong>时，性能最佳。</p><h2 id="c1e7" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jf ki kj kk jj kl km kn jn ko kp kq kr bi translated">各向异性问题</h2><p id="74bd" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf ku jh ji jj kv jl jm jn kw jp jq jr ha bi translated">它指的是学习到的嵌入在向量空间中占据一个狭窄的锥，这严重限制了它们的表达能力。这自然与一致性有关，两者都说嵌入应该均匀地分布在潜在空间中。</p><p id="2a7c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以前解决这个问题的两种方法是:</p><ul class=""><li id="b8c8" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lh li lj lk bi translated">后处理:消除主要主成分或将嵌入映射到各向同性分布。查看这篇<a class="ae it" href="https://arxiv.org/pdf/2103.15316.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>“白化句子表示以获得更好的语义和更快的检索”了解更多信息。</li><li id="3be1" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated">训练时添加正则化:查看这篇<a class="ae it" href="https://openreview.net/forum?id=ByxY8CNtvr" rel="noopener ugc nofollow" target="_blank">论文</a>“用频谱控制改进神经语言生成”关于频谱控制。</li></ul><p id="03fe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本文中对比学习的训练目标可以用下面的等式来表达，其中第一项保持正例相似，第二项将负例分开:</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/d025b4b89326b41c63ed8dce180bcf4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Do4XlPNQNRnNxWi7x35KLw.png"/></div></div></figure><h2 id="738e" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jf ki kj kk jj kl km kn jn ko kp kq kr bi translated">STS基准测试任务的结果</h2><blockquote class="lr ls lt"><p id="6b2b" class="iu iv lu iw b ix iy iz ja jb jc jd je lv jg jh ji lw jk jl jm lx jo jp jq jr ha bi translated">2012年至2016年的语义文本相似性(STS)基准测试任务(STS12，STS13，STS14，STS15，STS16，STS-B)基于两种表示的余弦相似性来测量两个句子的相关度。评价标准是皮尔逊相关。</p><p id="e747" class="iu iv lu iw b ix iy iz ja jb jc jd je lv jg jh ji lw jk jl jm lx jo jp jq jr ha bi translated">病态相关度(SICK-R)任务训练一个线性模型，以输出从1到5的分数，指示两个句子的相关度。对于同一个数据集(SICK-E)，可以使用蕴涵标签(类是“蕴涵”、“矛盾”和“中性”)将它视为三类分类问题。SICK-R的评估度量是SICK-E的皮尔逊相关性和分类准确度。</p></blockquote><p id="f40e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">SimCSE的SOTA结果如下所示:</p><figure class="jt ju jv jw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/49fb1fb9f55d26fdd0530c6e583d4057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVHSIpDrnNHiI0H16CTUhA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Here I only show the unsupervised result.</figcaption></figure><h2 id="6a2f" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jf ki kj kk jj kl km kn jn ko kp kq kr bi translated">参考</h2><ul class=""><li id="31ef" class="lc ld hh iw b ix ks jb kt jf lz jj ma jn mb jr lh li lj lk bi translated"><a class="ae it" href="https://arxiv.org/abs/2104.08821" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/2104.08821</a></li><li id="92ca" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated"><a class="ae it" href="https://github.com/princeton-nlp/SimCSE" rel="noopener ugc nofollow" target="_blank">https://github.com/princeton-nlp/SimCSE</a></li><li id="370a" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated">苏建林，曹家润，，欧。<br/> 2021。用于bet- <br/> ter语义和更快检索的白化句子表示。arXiv预印本<br/> arXiv:2103.15316。<a class="ae it" href="https://arxiv.org/pdf/2103.15316.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2103.15316.pdf</a></li><li id="870a" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated">王、、、胡、、、顾。2020.利用频谱控制改善神经语言生成。在ICLR召开的国际学术会议上。【https://openreview.net/forum?id=ByxY8CNtvr T4】</li><li id="0f50" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated">王彤宙和菲利普·伊索拉。2020.通过超球面上的对齐和一致来理解对比表征学习。Inter <br/>机器学习全国会议(ICML)<br/>第9929–9939页。<a class="ae it" href="http://proceedings.mlr.press/v119/wang20k/wang20k.pdf" rel="noopener ugc nofollow" target="_blank">http://proceedings.mlr.press/v119/wang20k/wang20k.pdf</a></li><li id="1980" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated"><a class="ae it" href="http://nlpprogress.com/english/semantic_textual_similarity.html" rel="noopener ugc nofollow" target="_blank">http://NLP progress . com/English/semantic _ textual _ similarity . html</a></li></ul><div class="mc md ez fb me mf"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hi fi z dy mk ea eb ml ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">medium.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt in mf"/></div></div></a></div></div></div>    
</body>
</html>