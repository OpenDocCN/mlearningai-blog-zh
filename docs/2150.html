<html>
<head>
<title>Predicting atmospheric temperature using landscape images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用景观图像预测大气温度</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/predicting-atmospheric-temperature-using-landscape-images-5130495f80bf?source=collection_archive---------7-----------------------#2022-03-15">https://medium.com/mlearning-ai/predicting-atmospheric-temperature-using-landscape-images-5130495f80bf?source=collection_archive---------7-----------------------#2022-03-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/ea2d01f66cd41355dfff60fff8342e1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*LM_hX_EgKt-xJvxxhAYZQA.gif"/></div><figcaption class="il im et er es in io bd b be z dx">Actual vs. predicted temperatures at <a class="ae ip" href="https://www.youtube.com/watch?v=n3B8fp-Henc" rel="noopener ugc nofollow" target="_blank">Rainbow Bridge</a>, Tokyo across 2 days</figcaption></figure><p id="2675" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">你能猜出照片拍摄时以下地点的温度吗？</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jo"><img src="../Images/79ad0af476a6095ca11a19c9dc6fceaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KUVORVmdFof09byXeZl2w.png"/></div></div><figcaption class="il im et er es in io bd b be z dx"><a class="ae ip" href="https://www.youtube.com/watch?v=n3B8fp-Henc" rel="noopener ugc nofollow" target="_blank">Rainbow Bridge</a>, Tokyo on a sunny yet cloudy day</figcaption></figure><p id="4337" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">这是一项艰巨的任务，对吗？这张照片可能来自一个寒冷的清晨，也可能来自一个温暖的傍晚。大气温度也取决于季节和地点。总而言之，大气温度是很多参数共同作用的结果，这些参数让我们很难一眼就能确定。供您参考，上述情况下的温度为5.4摄氏度。</p><h2 id="6350" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">目标</h2><p id="8dca" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated">在这篇文章中，我们将尝试通过观察东京彩虹桥的图像来估计这个地方的大气温度。</p><h2 id="23f5" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">方法</h2><p id="f7d0" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated">我们将使用卷积神经网络来训练一个模型，预测图像拍摄时的温度。我们的任务将是回归任务，而不是分类任务，因为我们的目标变量(温度)是一个连续变量。虽然图像卷积主要用于分类问题，如对象检测或人脸识别，但它并不常用于回归任务，因此在线上没有很多关于这方面的资料。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jo"><img src="../Images/ba0400ee24b915a21d0a61d47b277ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSi9iFtwsv8C__r1ZAxXqQ.png"/></div></div><figcaption class="il im et er es in io bd b be z dx">Temperature: 9.1 °C at <a class="ae ip" href="https://www.youtube.com/watch?v=n3B8fp-Henc" rel="noopener ugc nofollow" target="_blank">Rainbow Bridge</a>, Tokyo</figcaption></figure><h2 id="097e" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">数据收集</h2><p id="51ef" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated">对于这个任务，我们将连接到Youtube和OpenWeatherMap APIs，分别用于收集图像和天气信息。我们编写一个连接到Youtube API的脚本，每隔50秒对Odaiba直播摄像头进行一次截图。拍摄快照后，脚本连接到OpenWeatherMap API并获取彩虹桥(Odaiba)的天气信息。收集的数据与时间戳一起写入我们的本地机器，以便稍后链接回图像和温度。我们运行这个脚本大约2天，收集2k+的图像和天气信息。</p><h2 id="671c" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">数据处理</h2><p id="5b0b" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated">当OpenWeatherMap API被请求提供一个坐标的天气信息时，它检查附近的气象站并提供最新的信息。例如，当我们查询彩虹桥时，我们根据查询完成的时间从塔米或品川站获得信息。由于我们不希望我们的数据出现不连续(塔米和品川可能在同一时间有不同的温度)，我们将数据集缩小到从塔米站获得的信息。这总共给我们留下了1902张图像。图像文件路径和相关温度以及时间戳被整理到主数据文件中。这些数据和图像一起被上传到Google Drive，用于在Google Colab上训练模型。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jo"><img src="../Images/9e8f360e43369404d150336fea690b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mrpawQuenDvWNdOMWoqFDQ.png"/></div></div><figcaption class="il im et er es in io bd b be z dx">Temperature: 11.1 °C at <a class="ae ip" href="https://www.youtube.com/watch?v=n3B8fp-Henc" rel="noopener ugc nofollow" target="_blank">Rainbow Bridge</a>, Tokyo</figcaption></figure><h2 id="ba74" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">模型</h2><p id="9619" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated">使用彩虹桥区域的1，902幅图像，我们将数据集分为训练(70%)和测试(30%)子集。训练子集的一部分将被用作早期停止的验证子集，以防止过拟合。</p><p id="8285" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">神经网络由1个输入层、2个卷积层+最大池层+ 1个全局平均池层+ 3个密集层和1个输出层(温度)组成。</p><p id="7cb4" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">卷积层在图像上滑动一个小窗口，并从图像中提取有用的特征。在一个常用的例子中，卷积层可以学习识别图像中的边缘。在卷积层之后立即应用MaxPool是缩小输出的常见做法。然后，我们应用全局平均池层，以减少图像到1D矢量。这个1D向量通过一个标准的3层多层感知器移动，该感知器具有一个ReLu激活函数，它将从图像中给我们温度作为1值。</p><p id="c940" class="pw-post-body-paragraph iq ir hh is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">我们在Google Colab上使用GPU加速来更快的学习。第一个纪元将花费相对较长的时间，因为张量被移动到GPU，但未来的纪元将花费明显较短的时间，学习将在不到10分钟内完成。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jo"><img src="../Images/99b216a29e2a36486945b830fdbe0d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SwfDvjoxq6oHiYSbj_ZC8A.png"/></div></div><figcaption class="il im et er es in io bd b be z dx">Temperature: 13.5 °C at <a class="ae ip" href="https://www.youtube.com/watch?v=n3B8fp-Henc" rel="noopener ugc nofollow" target="_blank">Rainbow Bridge</a>, Tokyo</figcaption></figure><h2 id="c285" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">结果</h2><p id="9f1f" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated">模型达到均方根误差<strong class="is hi"> 1.2 C </strong>，而R平方为<strong class="is hi"> 0.79 </strong>。不错吧，特别是考虑到模型只使用图像进行训练，没有额外的数据。</p><h2 id="3b56" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">结论</h2><p id="43e7" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated">我们使用卷积神经网络训练了一个机器学习模型，通过查看东京彩虹桥的图像来预测大气温度。图像和温度数据在2天内从Youtube live cam和OpenWeatherMap获得。使用1，902幅图像来训练模型，并且达到了合理的精度。该模型很难预测清晨和傍晚的温度，这两个时段的温度变化很大，而图像却保持相似。这可以通过将小时作为另一个变量提供给模型来解决。此外，一个高度精确的模型可以用一年中更大的图像数据集来训练。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es jo"><img src="../Images/4dc9f01b57108c46beac1952b75a8fb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KQo5i4RW-aQeo6PR_tdEZA.png"/></div></div><figcaption class="il im et er es in io bd b be z dx">Temperature: 12.3°C at <a class="ae ip" href="https://www.youtube.com/watch?v=n3B8fp-Henc" rel="noopener ugc nofollow" target="_blank">Rainbow Bridge</a>, Tokyo</figcaption></figure><h2 id="e65e" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated"><strong class="ak">自己试试吧！</strong></h2><p id="6640" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated">我创建了一个<a class="ae ip" href="https://weather-prediction.vercel.app/" rel="noopener ugc nofollow" target="_blank">网站</a>，可以让你用自己的图像预测一幅风景图像的大气温度！推断是在浏览器上完成的，图像不会保存在任何地方。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es kx"><img src="../Images/653bbc40b284b3d852a16dca3a03e477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j-C9gBtY8XdkOrjhjgK70A.png"/></div></div><figcaption class="il im et er es in io bd b be z dx">Test the model using your own images! (Image by the author)</figcaption></figure><h2 id="a0fb" class="jx jy hh bd jz ka kb kc kd ke kf kg kh jb ki kj kk jf kl km kn jj ko kp kq kr bi translated">来源</h2><p id="8d8d" class="pw-post-body-paragraph iq ir hh is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn ha bi translated"><a class="ae ip" href="https://weather-prediction.vercel.app/" rel="noopener ugc nofollow" target="_blank">项目网站</a>，<a class="ae ip" href="https://colab.research.google.com/drive/1cFlGTV0bDZgda3qLoO5cGHvcbFrHE0J5?usp=sharing" rel="noopener ugc nofollow" target="_blank">机器学习代码</a>，<a class="ae ip" href="https://colab.research.google.com/drive/11DMV4It_DxDvq1TaojlOROhVncjtp306?usp=sharing" rel="noopener ugc nofollow" target="_blank">数据采集代码</a>，<a class="ae ip" href="https://drive.google.com/drive/folders/19egAgOXflnckYDF9DzvC261R47jqwV_u?usp=sharing" rel="noopener ugc nofollow" target="_blank">数据</a></p><div class="ky kz ez fb la lb"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lc ab dw"><div class="ld ab le cl cj lf"><h2 class="bd hi fi z dy lg ea eb lh ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="li l"><h3 class="bd b fi z dy lg ea eb lh ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lj l"><p class="bd b fp z dy lg ea eb lh ed ef dx translated">medium.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp ij lb"/></div></div></a></div></div></div>    
</body>
</html>