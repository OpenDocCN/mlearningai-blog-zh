<html>
<head>
<title>Movie Recommender System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电影推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/movie-recommender-system-b348ecb0e19f?source=collection_archive---------4-----------------------#2022-05-18">https://medium.com/mlearning-ai/movie-recommender-system-b348ecb0e19f?source=collection_archive---------4-----------------------#2022-05-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/f73990259c9d828605bc460f6b339b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*riZsouf2AINzb5Et-AUrQg.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image by <a class="ae it" href="https://pixabay.com/illustrations/question-mark-pile-question-mark-1495858/" rel="noopener ugc nofollow" target="_blank">pixabay</a></figcaption></figure><p id="90c2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这篇文章中，我将展示一些流行的推荐算法。</p><p id="0a81" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">推荐系统用例广泛应用于电子商务、在线娱乐平台(网飞、Spotify、Youtube等)、健康技术等等。</p><p id="9445" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">它真的可以有效地为我们的用户提供他们需要的商品，而无需在平台上手动搜索。我个人认为，作为一名数据科学家或分析师，我们至少需要了解推荐引擎的基本工作原理。</p><p id="435f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，在第一部分，推荐将基于每个电影名称的评级和电影之间的相关性。</p><p id="f726" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">接下来，将会有一个只有文本数据的推荐系统。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="2776" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">文章指南:</p><ol class=""><li id="3085" class="jz ka hh iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">通用推荐系统</li><li id="1df8" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">基于内容的推荐系统</li></ol><h2 id="abf8" class="kn ko hh bd kp kq kr ks kt ku kv kw kx jf ky kz la jj lb lc ld jn le lf lg lh bi translated"><strong class="ak">通用推荐系统</strong></h2><p id="0e3c" class="pw-post-body-paragraph iu iv hh iw b ix li iz ja jb lj jd je jf lk jh ji jj ll jl jm jn lm jp jq jr ha bi translated">对于我们的第一个推荐系统，我们将使用包含电影名称及其基于平台上每个用户的相应评级的数据集。</p><p id="fb2c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，我将使用来自Kaggle的数据集(请参考下面的链接)，数据集包含以下主要特征:</p><ol class=""><li id="6e51" class="jz ka hh iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">item_id:每部电影的唯一id</li><li id="bd56" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">标题:电影的名字</li><li id="0dab" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">user_id:每个用户的唯一id</li><li id="3484" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">评级:电影评分(1-5)</li></ol><p id="4fa3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从以上特征，我们可以简单地通过计算每个电影之间的相关性来简单地开发我们的推荐模型。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="36f1" class="kn ko hh ls b fi lw lx l ly lz">#Generating Pivot Table for each movie title</span><span id="312d" class="kn ko hh ls b fi ma lx l ly lz">df_title = pd.read_csv('/kaggle/input/dataset/Movie_Id_Titles.csv')<br/>df_dataset = pd.read_csv('/kaggle/input/dataset/Dataset.csv')<br/><br/>df_merged = pd.merge(df_title, df_dataset, left_on = 'item_id', right_on = 'item_id')</span><span id="3595" class="kn ko hh ls b fi ma lx l ly lz">pivot = df_merged.pivot_table(index = 'user_id',columns = 'title', values = 'rating')<br/>pivot.head()</span></pre><figure class="ln lo lp lq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/2194850fe0e80977be53a3593336d8ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WFkZfQL9r-u9EIBCppw57w.png"/></div></div></figure><p id="08ab" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上面的数据透视表告诉我们每个用户给数据集中的每部电影多少分。</p><p id="d57d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如您所见，数据集中有许多NaN值，最好保持原样，而不是用平均值或中值替换这些值(因为这将在测量电影之间的相关性时产生偏差结果)。</p><p id="22b9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">接下来，我们将生成一个函数来衡量我们观看的电影与其他电影的相关性，并根据高相关值提供推荐。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="1c89" class="kn ko hh ls b fi lw lx l ly lz">def movie_correlation(movie_title, n) :<br/>    movie_rating = pivot[movie_title]<br/>    similar_to_movie = pivot.corrwith(movie_rating)<br/>    corr_ = pd.DataFrame(similar_to_movie, columns=['correlation'])<br/>    corr_.dropna(inplace=True)<br/>    return corr_.sort_values(by ='correlation',ascending=False).head(n)<br/><br/><br/>movie_correlation('12 Angry Men (1957)', n = 10)</span></pre><figure class="ln lo lp lq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/4f8faa29e84b1f9a04839e0bfb037a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kszTGb2Du2ebYluY2Im3LA.png"/></div></div></figure><p id="84b6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最终结果显示了基于我们观看的电影的前10部电影推荐，在这种情况下，电影“12个愤怒的人(1957)”提供了上述10部电影名称，因为它与它具有高度的相关性。</p><p id="214f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">带有评级的一般推荐开发起来很简单，生成结果也很快，但有时评论并不容易获得，推荐引擎向其用户提供任何推荐都是不可持续的。</p><p id="3950" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，另一种选择是开发基于内容的推荐。</p><h2 id="14f2" class="kn ko hh bd kp kq kr ks kt ku kv kw kx jf ky kz la jj lb lc ld jn le lf lg lh bi translated">基于内容的推荐系统</h2><p id="3f00" class="pw-post-body-paragraph iu iv hh iw b ix li iz ja jb lj jd je jf lk jh ji jj ll jl jm jn lm jp jq jr ha bi translated">在这一节中，我将简单地演示我们如何利用文本数据来创建一个推荐系统。</p><p id="393e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本部分使用的数据来自Kaggle(请参考下面的链接)。</p><p id="3642" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于这些特性，我们将在本文中使用以下内容:</p><ol class=""><li id="2a1e" class="jz ka hh iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">原标题:电影片名</li><li id="0b6b" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">类别:电影类型</li><li id="c454" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">导演/创作者:电影制片人</li><li id="1113" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">审阅标题:审阅的标题</li></ol><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="11c2" class="kn ko hh ls b fi lw lx l ly lz">df = pd.read_csv('/kaggle/input/imdb-320000-movie-reviews-sentiment-analysis/IMDB_dataset_320.000_reviews.csv')</span><span id="2793" class="kn ko hh ls b fi ma lx l ly lz">df_final = df[['original title','category','director/creator','review title']]<br/>df_final.head()</span></pre><figure class="ln lo lp lq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/078e5b080f01eca27b9f10b0084bdbc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDbPhEP0UxSSviQFxLjIgQ.png"/></div></div></figure><p id="c5d9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我要对这些数据做的是使用余弦相似度根据“评论标题”值推荐一个电影列表。</p><p id="3723" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">余弦相似度是用于测量两个文档的字数之间的欧几里德距离和角度的术语(角度越小，余弦相似度越高)。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="0bf8" class="kn ko hh ls b fi lw lx l ly lz">#Import Library for Text Preprocessing and Model Development</span><span id="5d9c" class="kn ko hh ls b fi ma lx l ly lz">from nltk.corpus import stopwords<br/>from sklearn.metrics.pairwise import linear_kernel, cosine_similarity<br/>from sklearn.feature_extraction.text import TfidfVectorizer<br/>import re</span><span id="8b59" class="kn ko hh ls b fi ma lx l ly lz">replace_by_re = re.compile('[/(){}\[\]\|@,;]')<br/>symbols_re = re.compile('[^0-9a-z #+_]')<br/>stopwords_ = set(stopwords.words('english'))</span><span id="b63b" class="kn ko hh ls b fi ma lx l ly lz">def clean_text(text) :<br/>    <br/>    text = text.lower()<br/>    text = replace_by_re.sub('', text)<br/>    text = symbols_re.sub('', text)<br/>    <br/>    text = ' '.join(word for word in text.split() if word not in stopwords_)<br/>    <br/>    return text<br/>    <br/>    <br/>df_final['review_title_clean'] = df_final['review title'].apply(clean_text)<br/>df_final['original_title_clean'] = df_final['original title'].apply(clean_text)<br/>df_final.head()</span></pre><figure class="ln lo lp lq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/f85d1dc70b1aed7d9721b9d3a1ce5348.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zTzGE4HI_W3YBkCU1y5Jnw.png"/></div></div></figure><p id="766f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，在清理“评论标题”和“原始标题”数据后，我们有了必要的数据集。</p><p id="3bbb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">接下来，我们将开始使用tfidf矢量器和余弦相似度来构建我们的模型。</p><pre class="ln lo lp lq fd lr ls lt lu aw lv bi"><span id="fce9" class="kn ko hh ls b fi lw lx l ly lz">df_final = df_final[~df_final.duplicated()]</span><span id="239d" class="kn ko hh ls b fi ma lx l ly lz">df_final.set_index('original_title_clean', inplace = True)</span><span id="b924" class="kn ko hh ls b fi ma lx l ly lz">tf = TfidfVectorizer(analyzer = 'word', ngram_range = (3,3), min_df = 1)</span><span id="e3d4" class="kn ko hh ls b fi ma lx l ly lz">tfidf_matrix = tf.fit_transform(df_final['review_title_clean'])</span><span id="d51a" class="kn ko hh ls b fi ma lx l ly lz">cosine_similarities = cosine_similarity(tfidf_matrix, tfidf_matrix)</span><span id="1ccf" class="kn ko hh ls b fi ma lx l ly lz">indices = pd.Series(df_final.index)</span><span id="b9bd" class="kn ko hh ls b fi ma lx l ly lz">#Function for Developing Recommendation Model </span><span id="1680" class="kn ko hh ls b fi ma lx l ly lz">def movie_recommendations(title,cosine_similarities = cosine_similarities) :<br/>    <br/>    recommendation_movies = []<br/>    <br/>    idx = indices[indices == category].index[0]<br/>    <br/>    score_series = pd.Series(cosine_similarities[idx]).sort_values(ascending = False)<br/>    <br/>    top_10_index = list(score_series[1:11].index)<br/>    <br/>    for a in top_10_index :<br/>        recommendation_movies.append(list(df_final.index)[a])<br/>        <br/>    return recommendation_movies</span><span id="e874" class="kn ko hh ls b fi ma lx l ly lz">movie_recommendations('logans war bound honor')</span></pre><figure class="ln lo lp lq fd ii er es paragraph-image"><div class="er es mf"><img src="../Images/0aeab45fd6cbb939bb1fd7db72d21774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*8Zg7nUJ00_xSoECOWAfAUg.png"/></div></figure><p id="fe7c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是基于上述代码的逐步过程:</p><ol class=""><li id="1aa4" class="jz ka hh iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">将我们的目标结果设置为数据框架中的索引</li><li id="8b52" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">使用TfidfVectorizer将文本数据(review_title_clean)转换为字数</li><li id="91f1" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">从Tfidf矩阵数据中寻找余弦相似性</li><li id="9c23" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">从数据帧中生成一个由索引组成的变量</li></ol><p id="a0d3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">完成所有4个步骤后，我们可以开始构建我们的推荐模型。</p><p id="6ffd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">推荐模型将使用电影标题作为输入，基于其余弦相似性的得分来生成推荐。</p><p id="be36" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以基于上面的模型，基于余弦相似性得分，电影《洛根战争界限荣誉》与其他10部电影(从上面的图像中可以看出)有相似性。</p><p id="077c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本文到此结束，我希望这能简化推荐系统的开发过程，给所有的读者。</p><p id="4a99" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">还有其他的推荐系统主题我还没有涉及，那就是协同过滤推荐系统。将来，我会写一篇关于它的文章，但现在，我认为这足以让你们对推荐系统如何工作有一个大致的了解。</p><p id="8c0d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">再次感谢你的支持，如果你觉得我的内容有帮助，请鼓掌或订阅我的页面。另外，如果你们有想要阅读的特定主题，请随时告诉我。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="22cb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">参考资料:</p><div class="mg mh ez fb mi mj"><a href="https://www.kaggle.com/code/kelvinprawtama/movie-recommendation-system-in-python/notebook" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hi fi z dy mo ea eb mp ed ef hg bi translated">Python中的电影推荐系统</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自电影推荐系统的数据</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">www.kaggle.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx in mj"/></div></div></a></div><div class="mg mh ez fb mi mj"><a href="https://www.kaggle.com/code/kelvinprawtama/movie-recommendation-system" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hi fi z dy mo ea eb mp ed ef hg bi translated">电影推荐系统</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自IMDB 320.000电影评论、情感…</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">www.kaggle.com</p></div></div><div class="ms l"><div class="my l mu mv mw ms mx in mj"/></div></div></a></div><div class="mg mh ez fb mi mj"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hi fi z dy mo ea eb mp ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">medium.com</p></div></div><div class="ms l"><div class="mz l mu mv mw ms mx in mj"/></div></div></a></div></div></div>    
</body>
</html>