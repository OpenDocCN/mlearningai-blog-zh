# ç”¨ Python ä»£ç å®ç°çš„åŸºäºå†…å®¹çš„åŸºæœ¬æ¨èç³»ç»Ÿ

> åŸæ–‡ï¼š<https://medium.com/mlearning-ai/basic-content-based-recommendation-system-with-python-code-be920b412067?source=collection_archive---------1----------------------->

![](img/8af42ba27898df12f11ef31f880dd55b.png)

# â“ä»€ä¹ˆæ˜¯æ¨èç³»ç»Ÿï¼Ÿ

éšç€åœ¨çº¿å¹³å°çš„å‘å±•ï¼Œæ¶ˆè´¹è€…æ›´æœ‰å¯èƒ½åœ¨ç½‘ä¸Šè´­ä¹°äº§å“ã€‚å…¬å¸è¯•å›¾äº†è§£ä»–ä»¬çš„å®¢æˆ·ï¼Œå¹¶åˆ©ç”¨å®¢æˆ·æ•°æ®æ¥è·å¾—æ›´å¤šåˆ©æ¶¦ã€‚

å®ç°æ¨èç³»ç»Ÿå¯ä»¥æä¾›ä¸ªæ€§åŒ–çš„æŠ¥ä»·ã€‚ä¸å¤§è§„æ¨¡å¹¿å‘Šç›¸åï¼Œä¸ªæ€§åŒ–çš„äº§å“ä¼šå¸¦æ¥æ›´é«˜çš„å®¢æˆ·æ»¡æ„åº¦ã€å‚ä¸åº¦å’Œé”€å”®é¢ã€‚

**ä¾‹å­** **é‡‡ç”¨æ¨èåˆ¶çš„å…¬å¸**

*   ç½‘é£:ç”µå½±/è¿ç»­å‰§æ¨è
*   Spotify:æ­Œæ›²æ¨è
*   Goodreads:ä¹¦ç±æ¨è

![](img/cbcabd6c8be8aaab7c34c67d5ced4969.png)

Goodreads recommendations

# ğŸ¬æ¨èç³»ç»Ÿç±»å‹

æœ‰ä¸¤ç§ç±»å‹çš„æ¨èå™¨:ååŒè¿‡æ»¤å’ŒåŸºäºå†…å®¹çš„è¿‡æ»¤ã€‚

![](img/4d4a82bce85a4099d905f1678904a9f1.png)

2 types of recommenders

**ååŒè¿‡æ»¤**

> æ¨èç±»ä¼¼ç”¨æˆ·å–œæ¬¢çš„äº§å“

è¿™ä¸ªæ¨èçš„æƒ³æ³•æ˜¯ï¼Œå“å‘³ç›¸åŒçš„äººå¾€å¾€å–œæ¬¢åŒæ ·çš„ä¸œè¥¿ã€‚

ä¾‹å¦‚ï¼Œåœ¨ç½‘é£ä¸Šè§‚çœ‹â€œç›—æ¢¦ç©ºé—´â€çš„ç”¨æˆ·é€šå¸¸è§‚çœ‹â€œæ˜Ÿé™…â€ã€‚å½“å¦ä¸€ä¸ªç”¨æˆ·åˆšçœ‹å®Œã€Šç›—æ¢¦ç©ºé—´ã€‹æ—¶ï¼Œç³»ç»Ÿä¼šçŸ¥é“è¿™ä¸ªç±»å‹çš„ç”¨æˆ·å¯èƒ½ä¹Ÿå–œæ¬¢ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹ï¼Œæ‰€ä»¥ä¼šæ¨èè¿™éƒ¨ç”µå½±ã€‚

**åŸºäºå†…å®¹çš„è¿‡æ»¤**

> æ¨èç±»ä¼¼äº§å“

è¿™ç§æ–¹æ³•åŸºäºç”¨æˆ·å¯èƒ½å–œæ¬¢ä¸ä»–ä»¬åˆšåˆšè´­ä¹°çš„äº§å“ç›¸ä¼¼çš„äº§å“çš„æ¦‚å¿µã€‚

å†æ¬¡ä»¥ç½‘é£ä¸ºä¾‹ã€‚å½“ä½ è§‚çœ‹ä¸€éƒ¨ç”µå½±æ—¶ï¼Œç½‘é£çš„æ¨èå™¨å°†åœ¨å…¶æ•°æ®åº“ä¸­å¯»æ‰¾ä¸€éƒ¨ç”µå½±ï¼Œä»¥æ‰¾åˆ°ä¸æ‰€è§‚çœ‹çš„ç”µå½±æ¥è¿‘çš„ç”µå½±(ä¾‹å¦‚å…·æœ‰ç›¸åŒçš„å¯¼æ¼”æˆ–ç›¸åŒçš„æµæ´¾)ã€‚

è¿™ç§æ¨èç³»ç»Ÿä¸éœ€è¦å…¶ä»–ç”¨æˆ·çš„æ•°æ®ï¼Œå› æ­¤å¯ä»¥åœ¨æ²¡æœ‰æ•°æ®æ”¶é›†æœŸçš„æƒ…å†µä¸‹åº”ç”¨ã€‚

> ä»‹ç»å¤Ÿäº†ã€‚å¼€å§‹ç¼–ç å§ï¼ï¼

# ğŸ‘æ­¥éª¤æ‘˜è¦

1.  å¯¼å…¥åº“
2.  è¾“å…¥æ•°æ®
3.  æ ‡è®°æ–‡æœ¬æ•°æ®
4.  è®¡ç®—ç›¸ä¼¼åº¦
5.  åˆ›å»ºä¸€ä¸ªå‡½æ•°
6.  å°è¯•åˆ›å»ºçš„æ¨èç³»ç»Ÿ

# 1.å¯¼å…¥åº“

æœ‰ 3 ä¸ªå¿…éœ€çš„åº“ã€‚

```
import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import linear_kernel
```

*   ç†ŠçŒ«:ç”¨äºè¯»å– csv æ–‡ä»¶
*   TfidfVectorizer:ç”¨äºæ–‡æœ¬æ•°æ®æ ‡è®°åŒ–
*   çº¿æ€§ _ å†…æ ¸:ç”¨äºç›¸ä¼¼æ€§è®¡ç®—

# 2.è¾“å…¥æ•°æ®

æˆ‘å°†ä½¿ç”¨çš„æ•°æ®æ˜¯**ç½‘é£ç”µå½±å’Œç”µè§†èŠ‚ç›®**ï¼Œå®ƒåŒ…å«äº†ç½‘é£ 8807 éƒ¨ç”µå½±å’Œç”µè§†èŠ‚ç›®çš„åˆ—è¡¨ã€‚

æ‚¨å¯ä»¥ä»åŠ è½½æ•°æ®

 [## ä½ çš„æ•°æ®ç§‘å­¦ä¹‹å®¶

### Kaggle æ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„æ•°æ®ç§‘å­¦ç¤¾åŒºï¼Œæ‹¥æœ‰å¼ºå¤§çš„å·¥å…·å’Œèµ„æºæ¥å¸®åŠ©æ‚¨å®ç°æ‚¨çš„æ•°æ®â€¦

www.kaggle.com](https://www.kaggle.com/datasets/shivamb/netflix-shows/download) 

æ•°æ®ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºã€‚æœ‰è¶£çš„åˆ—æ˜¯æ ‡é¢˜å’Œæè¿°ã€‚

å¯¹äºè¿™ä¸ªç®€å•çš„æ¨èç³»ç»Ÿï¼Œæˆ‘ä¸ä¼šä½¿ç”¨å…¶ä»–åˆ—(æ‚¨ä¹Ÿå¯ä»¥å‘æ¨èå¼•æ“æ·»åŠ å…¶ä»–åˆ—)ã€‚

![](img/1d25594df0f2da4eeb085c9d892d112b.png)

Netflix data samp

ä½¿ç”¨ pandas åŠ è½½ä¸€ä¸ª csv æ•°æ®æ–‡ä»¶ï¼Œå¹¶ç”¨ç©ºæ ¼å¡«å……ç¼ºå°‘çš„å€¼ã€‚

```
df = pd.read_csv('netflix_titles.csv')# Replace NaN with an empty string
df['description'] = df['description'].fillna('')
```

# 2.æ ‡è®°æ–‡æœ¬æ•°æ®

è¦å¤„ç†æ–‡æœ¬æ•°æ®ï¼Œéœ€è¦è¿›è¡Œæ ‡è®°åŒ–ã€‚

è®°å·åŒ–æ˜¯ä¸€ç§å°†æ–‡æœ¬åˆ†è§£æˆç§°ä¸ºè®°å·çš„æ›´å°å•å…ƒçš„æ–¹æ³•ã€‚æœ¬ä¾‹ä¸­çš„æ ‡è®°æ˜¯ä¸€ä¸ªå•è¯ã€‚

Tfidf ç”¨äºæ ‡è®°åŒ–æè¿°åˆ—ã€‚TF-IDF(æœ¯è¯­é¢‘ç‡-é€†æ–‡æ¡£é¢‘ç‡)è¡¡é‡ä¸€ä¸ªå•è¯ä¸æ–‡æ¡£é›†åˆä¸­çš„ä¸€ä¸ªæ–‡æ¡£çš„ç›¸å…³ç¨‹åº¦ã€‚

```
# Create a TfidfVectorizer and Remove stopwords
tfidf = TfidfVectorizer(stop_words='english')# Fit and transform the data to a tfidf matrix
tfidf_matrix = tfidf.fit_transform(df['description'])# Print the shape of the tfidf_matrix
tfidf_matrix.shape
```

tfidf_matrix çš„å½¢çŠ¶æ˜¯ 8807 è¡Œå’Œ 18895 åˆ—ã€‚

![](img/dd51392f9f25ee4a41ac37c60b3d98c2.png)

å¦‚æ‚¨æ‰€è§ï¼Œè¡Œæ•°(8807)æ˜¯æˆ‘ä»¬çš„æ•°æ®ä¸­ç”µå½±å’Œç”µè§†èŠ‚ç›®çš„æ•°é‡ã€‚

åˆ—æ•°(18895)æ˜¯åˆ é™¤åœç”¨è¯åçš„é‡è¦å•è¯æ•°ã€‚(åœç”¨è¯æ˜¯ä»»ä½•è¯­è¨€ä¸­çš„ä¸€ç»„å¸¸ç”¨è¯ã€‚åœç”¨è¯(ä¸é‡è¦çš„è¯)è¢«åˆ é™¤ï¼Œä»¥ä½¿æ¨¡å‹èƒ½å¤Ÿä¸“æ³¨äºé‡è¦çš„è¯ã€‚)

# 3.è®¡ç®—ç›¸ä¼¼åº¦

è¿™ä¸€æ­¥æ˜¯äº†è§£æ¯éƒ¨ç”µå½±çš„ç›¸ä¼¼ä¹‹å¤„ã€‚

ä¸ºæ­¤ï¼Œæˆ‘è®¡ç®—äº†æ¯å¯¹ç”µå½±çš„ä½™å¼¦ç›¸ä¼¼åº¦ã€‚

![](img/8ea9669172cf5a2ea41e84c123e1eaa4.png)

è¿™å¼ å›¾ç‰‡å±•ç¤ºäº†äºŒç»´ä½™å¼¦ç›¸ä¼¼æ€§ã€‚å¦‚æœä¸¤ä¸ªæ•°æ®å‘é‡æ˜¯é—­åˆçš„ï¼Œåˆ™è¿™ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦å¾ˆå°ï¼Œä½™å¼¦ç›¸ä¼¼åº¦å¾ˆé«˜ã€‚å°½ç®¡æˆ‘ä»¬çš„æ ‡è®°åŒ–æ–‡æœ¬æ•°æ®æœ‰ 18895 ä¸ªç»´åº¦ï¼Œä½†æ¦‚å¿µä»ç„¶æ˜¯ç›¸åŒçš„ã€‚

```
# Compute the cosine similarity between each movie description
cosine_sim = linear_kernel(tfidf_matrix, tfidf_matrix)
```

ä½¿ç”¨ linear_kernel å‡½æ•°è®¡ç®—æ­¥éª¤ 3 ä¸­ tfidf çŸ©é˜µçš„ä½™å¼¦ç›¸ä¼¼æ€§(è®¡ç®—ä¸å…¶è‡ªèº«çš„ç›¸ä¼¼æ€§)ã€‚

cosine_sim å…·æœ‰ 8807 è¡Œå’Œ 8807 åˆ—ï¼Œå¹¶ä¸”æ¯ä¸ªå•å…ƒè¡¨ç¤ºä¸¤éƒ¨ç”µå½±/è¿ç»­å‰§æè¿°ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼æ€§ã€‚

![](img/8845403e5333ee52c764207fae32a5de.png)

# 4.åˆ›å»ºä¸€ä¸ªå‡½æ•°

åœ¨åˆ›å»ºå‡½æ•°ä¹‹å‰ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªåä¸º indices çš„ç†ŠçŒ«ç³»åˆ—ã€‚ç´¢å¼•å°†ä½¿ç´¢å¼•ä¸ç”µå½±æ ‡é¢˜ç›¸åŒ¹é…ã€‚å› ä¸º

```
indices = pd.Series(df.index, index=df['title']).drop_duplicates()
```

![](img/7c53b52b0e715894b88e1c494117c03f.png)

indices

å‡½æ•° get_recommendations å°†æ¥æ”¶ç”µå½±æ ‡é¢˜ã€ä½™å¼¦ç›¸ä¼¼æ€§çŸ©é˜µå’Œä¸€äº›æ¨èçš„ç”µå½±ä½œä¸ºè¾“å…¥ã€‚ç„¶åï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªç”µå½±æ¨èåˆ—è¡¨ã€‚

```
def get_recommendations(title, cosine_sim=cosine_sim, num_recommend = 10):
    idx = indices[title]# Get the pairwsie similarity scores of all movies with that movie
    sim_scores = list(enumerate(cosine_sim[idx]))# Sort the movies based on the similarity scores
    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)# Get the scores of the 10 most similar movies
    top_similar = sim_scores[1:num_recommend+1]# Get the movie indices
    movie_indices = [i[0] for i in top_similar]# Return the top 10 most similar movies
    return df['title'].iloc[movie_indices]
```

*   è¯¥å‡½æ•°å°†æŸ¥æ‰¾æ‰€æœ‰ç”µå½±ä¸è¾“å…¥ç”µå½±çš„ç›¸ä¼¼æ€§å¾—åˆ†(æ¥è‡ªä½™å¼¦ _sim)ã€‚
*   ç„¶åï¼Œå®ƒä¼šå…ˆå¯¹ç›¸ä¼¼åº¦æœ€é«˜çš„ç”µå½±è¿›è¡Œæ’åºï¼Œä»ç¬¬äºŒä¸ªå¼€å§‹å¾—åˆ°åˆ—è¡¨ï¼Œç›´åˆ°æƒ³è¦çš„æ¨èç”µå½±æ•°(ç›¸ä¼¼åº¦æœ€é«˜çš„ç”µå½±æœ¬èº«å°±æ˜¯ lol)ã€‚
*   æœ€åè¿”å›æ¨èåˆ—è¡¨ã€‚

# 5.å°è¯•åˆ›å»ºçš„æ¨èç³»ç»Ÿ

ç°åœ¨ï¼Œæ˜¯æ—¶å€™åœ¨æ­¥éª¤ 4 ä¸­è°ƒç”¨æˆ‘ä»¬çš„å‡½æ•°äº†ã€‚

```
get_recommendations('Power Rangers Zeo', num_recommend = 20)
```

ä¸‹é¢æ˜¯ä¸ºã€ŠæƒåŠ›æµæµªè€…æ°æ¬§ã€‹æ¨èçš„ç”µå½±ã€‚å¤§éƒ¨åˆ†éƒ½æ˜¯ Power Ranger ç³»åˆ—çš„ã€‚ç„¶è€Œï¼Œæœ‰äº›ç”µå½±å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¥½çš„æ¨èé€‰æ‹©ï¼Œå¦‚ Peaky Blinderã€‚

![](img/9d5d349ce2dec9acb985980555ccf949.png)

# â­ç»“è®º

æ‚¨å¯ä»¥ä½¿ç”¨ Python åˆ›å»ºä¸€ä¸ªç®€å•çš„åŸºäºå†…å®¹çš„æ¨èç³»ç»Ÿã€‚é¦–å…ˆï¼Œå¯¹æ–‡æœ¬æ•°æ®è¿›è¡Œæ ‡è®°å¹¶è®¡ç®—ç›¸ä¼¼åº¦ã€‚ç„¶åï¼Œå°†æ¨èç›¸ä¼¼åº¦æœ€é«˜çš„ä¸€ä¸ªã€‚

å¦‚æœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œè¯·é¼“æŒå¹¶å…³æ³¨æˆ‘æ›´å¤šå…³äºæ•°æ®ç§‘å­¦çš„æ–‡ç« ã€‚

[](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb) [## Mlearning.ai æäº¤å»ºè®®

### å¦‚ä½•æˆä¸º Mlearning.ai ä¸Šçš„ä½œå®¶

medium.com](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb)