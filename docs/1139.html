<html>
<head>
<title>Modelling Bodyweight in Grower-Finisher Pigs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模拟生长肥育猪的体重</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/analysis-of-bodyweight-in-grower-finisher-pigs-using-mixed-models-splines-and-bootstrapping-in-r-4a997a04f77d?source=collection_archive---------2-----------------------#2021-10-09">https://medium.com/mlearning-ai/analysis-of-bodyweight-in-grower-finisher-pigs-using-mixed-models-splines-and-bootstrapping-in-r-4a997a04f77d?source=collection_archive---------2-----------------------#2021-10-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="cf0c" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">在R中使用混合模型、样条和引导</h2></div><p id="5a09" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是我在2017年做的一个分析。尽管现在是2021年，我不得不重新评估所有代码，看看它们是否仍然有效，但考虑到数据的性质及其潜在的生物学，我相信我很难比当时做得更好。</p><p id="4635" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该数据集包含对300多头生长肥育猪的观察，分为两个处理，为期168天。在产仔、哺育和生长完成阶段总共进行了11次测量。实验设计不得不重新洗牌，导致两个随机完全区组设计。</p><p id="ded5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个数据集的难点在于，猪有很强的能力来弥补过去的生长中断。此外，随着时间的推移和体重的增加，差异也会增加。严重地。此外，围栏内和围栏间发生的事情变得越来越重要，往往取代了治疗的影响。</p><p id="10b8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从统计学的角度来看，这是一个很棒的数据集，其中再次强调了使用<a class="ae js" rel="noopener" href="/@marc.jacobs012/introduction-to-mixed-models-in-r-9c017fd83a63"><strong class="iy hi"/></a><a class="ae js" rel="noopener" href="/@marc.jacobs012/analysis-of-bw-in-piglets-using-mixed-models-splines-in-r-a7c0952b15fc"><strong class="iy hi">样条</strong> </a>和<a class="ae js" href="https://www.statmethods.net/advstats/bootstrapping.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iy hi">自举</strong> </a>。一如既往，我相信我在这里展示的东西可以大大改进。</p><p id="94d1" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">尽情享受吧！</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">As always with R, the more functionality you want to use, the bigger the list of libraries becomes.</figcaption></figure><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Import of growth dataset and transformation in long-format to allow longitudinal analysis.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ke"><img src="../Images/dfc276e3ae1b4da51944e3d58905d787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJKkbwdgy3mXzG_dfUZL_w.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">How the data looks now — one row per observations.</figcaption></figure><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Centering of time-varying coefficients to enable better convergence. Does not change model diagnostics, but can hinder interpretation, since everything is now subtracted from the grand mean. Do note that I am not scaling here, just centering.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kl"><img src="../Images/0070943b76306febcfa62a969e274e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSE476MJXoKjFLXGqpQ9uQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">The dataset after centering.</figcaption></figure><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Creation of time-varying variables, and assessment of deleting some perhaps strange observations.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es km"><img src="../Images/02fe762d51726bba8f2515d116bda208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_FM2bIj3x_9AJY-T8pDHgg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Adding time-varying variables.</figcaption></figure><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">MELTING data to allow drawing of certain plots.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es kn"><img src="../Images/eeef7dec81ffa91e371b637f0b1bdf20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-oPDxu810Th9ja4jkk1cQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">TREATmelt dataset, which shows per treatment and time some key metrics. Note the difference between means for the treatments over time.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ko"><img src="../Images/f7d1e4543bd857fc4cd561a05061aa05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7BXDEUtV6BLpOi-2JFsjbQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Deleting some animals will lead to differences in estimates. If there is no real biological reason to delete observations or complete subjects, I would always advise against it.</figcaption></figure><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">The code to draw plots that follow after extensive data wrangling.</figcaption></figure><div class="jt ju jv jw fd ab cb"><figure class="kp jx kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/762168d6d63f5013054859f20d1c0a6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*cJOyEy76mhk11bq4xhtbUw.png"/></div></figure><figure class="kp jx kv kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/5f3041cba128e188023ca26145a8e431.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*A2QCSKm0LchbYlcper4Rog.png"/></div></figure><figure class="kp jx kv kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/b18183eade67808eefae943fa8c04669.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*wmFUKe_SC_Qi2HxHvDv36w.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx kw di kx ky">Plots showing the variation within and between treatments. Image by author.</figcaption></figure></div><div class="ab cb"><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/84c6d8625889ffc150fe9447488654a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*9Pe16P8yvpGs7dOchAbkKA.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/7e973ab15d9e21cf5129e4c33adb49c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*yaXavJGDEuJSfYml9OQe2A.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/f59444fbfe7a2ce238f84920fb144547.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*7QtHhn9BscCWT8uibunhCQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx la di lb ky">Plots showing variation between sows, blocks, and across phases. Image by author.</figcaption></figure></div><div class="ab cb"><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/72100a279c724e3baad31f3f5754ae41.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*kTfP_DXW2rB2aK68M4M2hA.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/830cd2b6977fa849b0527738513182e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*81DixBg1BuTVnxL95-4VNw.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/e0835d32fc860a84e8b34f980a4aea67.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*hZoy2Lc9ylw7QItYRC8AOg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx la di lb ky">Plots showing variation dependent on potential important covariates. Image by author.</figcaption></figure></div><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Code to assess if a linear or polynomial / spline model is warranted. The previous plots already gave us a pretty good idea about what to do. Image by author.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lc"><img src="../Images/8f472cf0303e46b4754b885a304333f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_uxVYxrORhPbHL6PtIeWQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Plots of polynomial degrees shows that a quadratic regression should suffice. Image by author.</figcaption></figure><p id="8c73" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">到目前为止，代码和结果应该非常简单。我们加载、争论和绘制数据，以了解我们正在处理的是什么。我们确实有足够的观测数据，但是方差越来越大，使得数据建模变得不那么容易。让我们深入探讨一下。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Code to look at variation across time in three ways.</figcaption></figure><p id="bdab" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您可以在下面看到，所有时间点的数据分布似乎都是非常高斯的，但自由标度可能很棘手，因为接下来的两个图显示的是方差几乎呈指数增长。这将使数据建模变得非常困难，尤其是当我们必须通过许多观测数据来构建一个可靠的协方差矩阵来对误差部分进行建模时。因此，为了创建某种程度上稳定的模型，可能要使用<a class="ae js" href="https://en.wikipedia.org/wiki/Power_transform" rel="noopener ugc nofollow" target="_blank"> <strong class="iy hi"> Box-Cox变换</strong> </a> (BC)并稳定随时间变化的方差。</p><div class="jt ju jv jw fd ab cb"><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/43dfeddf5cb3ac02df5c1af14a53e4d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0GZg8PVj8ADZ6MirfJm0wQ.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/5ec9aa8836ab6d8978614b66e79c9d03.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*qhK9U9NG8WGqrByllunVEw.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/30c21a8435464d804fa6560b9ed88a85.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ZaQzQKm4y9cHjCyMe1-6YQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx la di lb ky">Image by author.</figcaption></figure></div><p id="c770" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Box-Cox，或<strong class="iy hi">幂变换</strong>，是一种简单而直接的减少变量内方差的方法。通过利用“幂树”,自动化程序将运行几个变换，并评估哪些变换获得最佳对数似然性。常见的Box-Cox变换遵循连续标度的<strong class="iy hi">λ</strong>标准变换。与键转换相对应的lambda的值得注意的示例有:</p><p id="e454" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2→1/Y2<br/>-1→1/Y1<br/>-0.5→1/(Sqrt(Y))<br/>0→log(Y)<br/>0.5→Sqrt(Y)<br/>1→Y<br/>2→Y</p><p id="bea5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我用线性回归来做评估。Once还可以选择更深入—通过治疗运行它—或者更深入地查看数据集的嵌套级别以寻找合适的转换。为了简化已经变得相当费力的分析，我选择只使用固定效应模型。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ld"><img src="../Images/7e1a25bcbfa9dcf0a7d5f6bbbf1a5fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*um4D7yTOMo2YCDwy6Je04g.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">The optimal lambda value was 0.18. Image by author.</figcaption></figure><div class="jt ju jv jw fd ab cb"><figure class="kp jx le kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/8a383dcfebb7b937ebc2af8d390846d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*xlTIMke2yVLRBi5gmeVEVQ.png"/></div></figure><figure class="kp jx le kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/25ac40e44ac653c091eb4335fbb69315.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*Xo008h1hVO3qjls-zJi2GA.png"/></div></figure><figure class="kp jx lf kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/f901a83ba6fd8bbebfb04e82ac2fc8fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*vcj0mUMS3mlu0HrcGZ_kNg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx lg di lh ky">Applying the Box-Cox transformation to the outcome did indeed stabilize variances. Image by author.</figcaption></figure></div><p id="963f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在是开始构建模型的时候了，你在下面看到的是过多的模型。我不会深入探究我为什么做这些，因为建模是由科学、统计和简单的试错法驱动的。最后一条评论不是最性感的，但却是事实。很多时候，我甚至不知道我到底在找什么，直到我看到它，通过引导许多模型并观察它们变化的行为，我希望看到哪些部分会影响，哪些不会。由于参数的数量很少，我们可以这样处理它。</p><p id="0f44" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">事实上，你在这里看到的只是一个更大的模型列表中的一小部分。需要注意的关键是，我没有对这些模型应用BC转换，因为我想看看它们的表现如何。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es li"><img src="../Images/62f11594366b95fc30cddeef5c86825b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iggOw2jNuWO0vzNmt_vIAQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">It seems some models for sure perform better than others. The last one is incomparable to the others, since it is on a different scale.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lj"><img src="../Images/60a3f2d172552276af7dd25cfea6c861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p58q8H0Lz4DU5w9ru8k-Mg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Fit 10 cannot be used in an Anova since it is on a different scale then the rest. Actually, by including it here, I am messing up the sequence of the Anova. But I do not like these models anyhow, so I just let it be as for now.</figcaption></figure><p id="7b86" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">好，让我们建立一个新的模型，仍然使用原始的BW比例。我在<em class="lk">时间</em>变量上应用样条，与<em class="lk">处理</em>交互，添加额外的预测值，请求嵌套在阶段<em class="lk">(1 |阶段/块)</em>的块上的随机截距，以及仅用于每只动物生长的随机斜率，嵌套在母猪<em class="lk"> (0+ns(Time_center，3)/sownr/pig_id) </em>。这是一个值得估计的模型。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><div class="jt ju jv jw fd ab cb"><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/1776840413da2e54bebd4903c1cf4903.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*5sDo0miUs7JkVWZKd4_c5g.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/c68d68044dc1314583654e0717bb89a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*84FuuYns-Kiuv884FM5Rvw.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/630c42db2aa596bbfbb85b13fef87aa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*a2AdrFxOD731NNR_zd5B0w.png"/></div></figure></div><div class="ab cb"><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/a3c97cb34dc182136452714a8a2438fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*zIYjRIWdgSjbCd1DgG5Cyw.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/fee99d369b58b9f87c67a8894b6a5bda.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*or5OlsLFrvn_NKr7kgEi1Q.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/09c233189d00ca5ea1e693df1b03b098.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*MDLbCLxczVhBKf6H1vE64Q.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx la di lb ky">Can’t say I am to pleased with the QQ plot nor the residuals estimates for block, pen, and time. The residuals for phase and sex seem to be doing better, although residual increase follows time, as expected. All of this is because we did not apply the variance stabilizing factor as provided to use via Box-Cox. Image by author.</figcaption></figure></div><p id="7af9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">到目前为止的结果证明了通过Box-Cox提供的稳定因子——λ值的使用是正确的。这是我们在下一个模型中要做的。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">These models are substantially different then the previous once. We cannot compare them using the standard metrics, because any transformation on the raw data — and not inside the model — will provide us with different metric values. Image by author.</figcaption></figure><p id="209b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">基于对一组数据(未在此显示)的额外分析，我们拟合了最终模型。由于在数据上增加了三个节点，模型的复杂性大大增加了。现在来看这个模型，我会说它严重过度拟合，但当时的意图是确保模型尽可能地拟合数据，以便在最终寻找治疗均值和变异系数的差异，确切地说，是在方差最高的时候。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ll"><img src="../Images/e7d5fefb570d67833514c90b0544358f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dStbvaH3wa0cyqLGOWSBQQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">The output of the models shows how complex it is with many variances being calculated. The random-effects components have standard errors exceeding the point estimates in size. That is not a good sign. The correlation matrix seems to be good. Image by author.</figcaption></figure><div class="jt ju jv jw fd ab cb"><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/2365fb45e4ebe6453dfb3a500dca1e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*qVTvLgyv6kJUChjC1dGgJA.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/755d05e7c2c5843098ead93b9c1597f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*k-rCdvQXFGqwngn6cXNuiQ.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/92beb142509faba885a32a8919670e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*_e4lWNR2DhcEhFTSDl6xrg.png"/></div></figure></div><div class="ab cb"><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/a7a7c8d1377769b6ad9ae13bd6ed3c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*VAJ_Z7BWtO_SPLiAOb8nOg.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/cc53d368ae89608c211700fcb906cac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*JTZ4GB90oyeavaMLULd1Ww.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/5675fe12cfcc78c9d6d67b76a6d71cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Tsq8rdP6s2Pi2EFgkVGWGQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx la di lb ky">The QQ-plot does not convince me, it shows heavy tails which means I am most likely not including all predictors that I need to in order to explain variance. However, considering the heavy model included, one might wonder how much is left. Random effects seem to be okay, except phase, which can hardly be named a random effect with only three levels. Image by author.</figcaption></figure></div><p id="2d99" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通常，在分析重复观测值时，模型确实需要考虑自然发生的自相关——这意味着可以通过过去的观测值预测某个时间的观测值。这会对您的估计值产生影响，因为数据不再是唯一的，所以标准误差会自动增加。不考虑互相关意味着你通过夸大你所拥有的独特观察的数量(在重复观察实验中很少等于收集的观察的数量)而低估了标准误差。</p><p id="b859" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae js" href="https://cran.r-project.org/web/packages/lme4/lme4.pdf" rel="noopener ugc nofollow" target="_blank"> lme4 </a>包不能对模型的错误部分建模，但是<a class="ae js" href="https://cran.r-project.org/web/packages/nlme/nlme.pdf" rel="noopener ugc nofollow" target="_blank"> nlme </a>包中的gls函数可以。我所做的是让算法在同一个模型上拟合误差部分的所有潜在协变量结构，并给我带回最佳拟合模型。</p><p id="db9e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请注意，我在这里没有使用BC转换。请记住，它们是为了在无法对误差部分建模的情况下稳定方差。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lm"><img src="../Images/bd8c55505c389a36c2993d1ea64d296f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6dZdg_f4aKCyHLuDFVuV4g.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Model 7 has the lowest AIC, which corresponds to a spherical spatial correlation structure.</figcaption></figure><p id="7a88" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面你可以看到这个模型的结果。方差没有得到控制，甚至没有这个模型，这使我相信，除非我严重过度拟合模型，否则我最终将很难处理方差。这正是我感兴趣的地方。</p><div class="jt ju jv jw fd ab cb"><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/4989851964a76412ad852d31f25d5e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*wxCRzme_zcgCgoLEBNBzJg.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/f7f3a53d1890224700038fa20e23488d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gv-e2wHLXR-z716AtEgKIw.png"/></div></figure><figure class="kp jx kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/089d3ca14a44f64aaf98b4d2bac3f819.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*cdlQpZZznDcexkyqcX34FQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx la di lb ky">Image by author.</figcaption></figure></div><div class="ab cb"><figure class="kp jx ln kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/31122003423aac28fad86f633f73a08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*VafG09HlptEIhydFnOZqAQ.png"/></div></figure><figure class="kp jx ln kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/bf638eeb1c1e61ff9bbb1a5651093c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*dco-2rbsT5aopwbHMLaCaA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx lo di lp ky">The last plot shows the insane importance of Time according to the Anova function. Time is by itself a horrible variable to include since it is a proxy for change, without knowing what is causing it. Time — by itself — cannot cause anything. Image by author.</figcaption></figure></div><p id="7195" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">接下来，我将着眼于潜在的影响对象。也许在这里，我可以找到一些缓解，但对于这样一个复杂的模型，这项工作很容易需要几个小时。除了识别影响的来源，我还发现迭代删除观察值是查看模型稳定性的好方法。如果你的控制台在这个过程中一直显示奇点或无法收敛，你可以放心，你在过度拟合方面做得很好。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">I identified some animals that might not help me in my endeavor. Lets see what happens if I delete them. Image by author.</figcaption></figure><div class="jt ju jv jw fd ab cb"><figure class="kp jx ln kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/a30a6d855a8244b3bb73376bbc7b8ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*cmxlBZp8NgUGKUcxTW6xHQ.png"/></div></figure><figure class="kp jx ln kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/ccadbb40ac596af3aa8c85cc847feea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*VfQO_wSl42nrqxzfS4rMvQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx lo di lp ky">Nothing happens, except loosing observational data, so I keep them in. Image by author.</figcaption></figure></div><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">Code to plot the predicted values from the final model — back-transformed of course — on the observed data points. Image by author.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lq"><img src="../Images/cb6e881d11ea02fb17ff1eea949582bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a2WCwu_J2hpPreXvGzCwhg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Quite a good fit. An overfitted fit I might add. Image by author.</figcaption></figure><p id="1055" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，因为我相信我不能做得更好，让我们做一个完整的模型评估。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lq"><img src="../Images/7b663043f86d0b3839fea567470426d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rprwvDnZoT380DJ_9jEYHA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Residuals look good, except the QQ-plot. The calibration plot is a bit to perfect to be honest. Image by author.</figcaption></figure><p id="c548" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，但同样重要的是，我们需要开始做出更可靠的预测。所以我创建了一个新的数据库，模仿过去的结构。这也是自举发挥作用的地方。我所做的基本上是重复分析1000次，存储处理差异——平均值、标准差、变异系数——并绘制结果。在我当时的电脑上(i5 ),这需要8个小时。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lr"><img src="../Images/4b4c63a096830cbc2bc06fb39103b8e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*IVi16jN6fEFwMfyClBHyrA.png"/></div></div></figure><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div><figcaption class="ka kb et er es kc kd bd b be z dx">I fit a model, use the new database, apply the model, store the predictions, and repeat that process 1000 times.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es ls"><img src="../Images/2df66bc99ba8ff7665546efb63f14ff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9lUNEhyHdOSAk0X9yorfZg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">Bootstrapping looks good. The dataset is ready to go. Image by author.</figcaption></figure><p id="bd40" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，经过8个小时的采样后，是时候使用所有不确定性的估计值并绘制处理差异了——平均值、标准偏差、变异系数。</p><figure class="jt ju jv jw fd jx"><div class="bz dy l di"><div class="jy jz l"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lt"><img src="../Images/465bb6e900852f1a326398640eaeb1d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VMuFQDvU-P1_-qpEkyuC3g.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">BW differences between treatments follow a Normal distribution. There is for sure bias, every now and then. Image by author.</figcaption></figure><div class="jt ju jv jw fd ab cb"><figure class="kp jx ln kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/cb2f3f11900837d8b965119f161ef6d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*3Tc_9qC7ypqtKIEQcvRIdQ.png"/></div></figure><figure class="kp jx ln kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/3e82bd46df60221363cd5c29f6ca3326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*kxswDCq1RZ1yo_IQ4iQWKQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx lo di lp ky">Histograms and QQ-plots for the SD show little bias and a good fit. Hence, bootstrapped samples can be trusted. Image by author.</figcaption></figure></div><div class="ab cb"><figure class="kp jx ln kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/2a98afcec0fd3957ea5aa615aaddfa57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*kpgJriVeiWqaoMMHhqp76w.png"/></div></figure><figure class="kp jx ln kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><img src="../Images/d14b6bc52c18584c5fd6044a98d78397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ohIhiBD30Kf2YgPuZ960tA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx lo di lp ky">Histograms and QQ-plots for the CV show little bias and a good fit. Hence, bootstrapped samples can be trusted. Image by author.</figcaption></figure></div><p id="f998" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上面所有的工作——重新采样、建立数据库、检查假设——只有一个目的，那就是绘制下面的图表并安全地解释它们。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lu"><img src="../Images/80e21c4f0ba8a4709d2cb7169de196ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hok4Ms1xUNIs60QRCJrG-Q.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">This plot shows a heavy treatment difference in the middle of the study, which is lost at the end. Image by author.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lv"><img src="../Images/49f0bbf6bf9a0af8f85890731eb529b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KANNGsw2uHt2MgT4ArSWmQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">The standard deviation of the difference remains the same across time. Image by author.</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lv"><img src="../Images/c6c86c8d7d58ed27c7bfbb7596261f48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wQCNy4xCwLrlFR5jJOmN4A.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx">The CV of the difference increase exponentially. Image by author.</figcaption></figure><p id="f609" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">哇，这是相当多的工作来分析和展示。和往常一样，这里所描述的远非完美，它只是分析像这样的数据集的单一方法。</p><p id="f6c4" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果您发现新的技术可以让分析这类数据变得轻而易举，请随时告诉我！！</p><div class="lw lx ez fb ly lz"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hi fi z dy me ea eb mf ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">medium.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn kj lz"/></div></div></a></div><p id="6066" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">v</p></div></div>    
</body>
</html>