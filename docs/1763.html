<html>
<head>
<title>Practical introduction to language modelling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">语言建模实用入门</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/practical-introduction-to-language-modelling-f5337bc26c5?source=collection_archive---------7-----------------------#2022-01-26">https://medium.com/mlearning-ai/practical-introduction-to-language-modelling-f5337bc26c5?source=collection_archive---------7-----------------------#2022-01-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="27e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">边做边学:在几分钟内为成千上万的用户构建和部署对话式人工智能。然后理解模型背后的高级理论。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/2d4cb25de0722b02644209249a835e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rE56InYU99hGEnlDjjrPtQ.gif"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Learn by doing: experimenting with bot building on the <a class="ae js" href="http://chai.ml" rel="noopener ugc nofollow" target="_blank">Chai platform</a>. Then deploy your experiment to thousands of users.</figcaption></figure><h1 id="a6a9" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">内容:</h1><ul class=""><li id="9b90" class="kr ks hh ig b ih kt il ku ip kv it kw ix kx jb ky kz la lb bi translated">实践:为成千上万的用户构建和部署对话式人工智能</li><li id="a7ee" class="kr ks hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">理论:如何用文字做数学？</li><li id="f58a" class="kr ks hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">背景:为什么这与你相关</li></ul><h1 id="1699" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">为成千上万的用户构建和部署对话式人工智能</h1><p id="087e" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated">了解一项新技术的最佳方式是用它来建造一些东西。在接下来的几段中，我会给你所有你需要的工具来构建你的第一个对话式人工智能。</p><p id="fb98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在一个高层次上，我们将:给你的人工智能一个名字和图片，给驱动它的模型一个提示(你可以把它想象成上下文，即你将如何向某人描述这个人工智能)，然后我们将硬编码对话的开始，选择一个模型，最后<strong class="ig hi">调整模型参数</strong>。</p><p id="2344" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先:前往在线<a class="ae js" href="http://chai.ml" rel="noopener ugc nofollow" target="_blank">对话式人工智能生成器</a>，点击“构建一个机器人”。首先选择你想给这个机器人起的名字，并给将要和它说话的用户一个简短的描述。然后你可以选择一张“个人资料图片”——你希望你的人工智能是什么样子的？接下来，您需要对机器人将向您或用户发送的第一条消息进行硬编码。</p><p id="5b22" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">驱动这些人工智能的模型(<a class="ae js" href="https://www.infoq.com/news/2021/07/eleutherai-gpt-j/" rel="noopener ugc nofollow" target="_blank"> GPT-J </a>、<a class="ae js" href="https://github.com/pytorch/fairseq" rel="noopener ugc nofollow" target="_blank">费尔塞奇</a>、…)是<strong class="ig hi">通用语言模型</strong>。我将在下面的理论部分详细解释这意味着什么。实际上，重要的是，它们不仅仅是为了交谈而制作的。我们需要<strong class="ig hi">设计一个提示</strong>让模型明白它的工作是和用户聊天。实现这一点的方法是格式化提示，如下所示:</p><blockquote class="lk ll lm"><p id="f87f" class="ie if ln ig b ih ii ij ik il im in io lo iq ir is lp iu iv iw lq iy iz ja jb ha bi translated">杰西卡是纽约的一名小学教师。她很健谈，喜欢谈论用户的感受和任何与视觉艺术相关的事情。</p><p id="f65d" class="ie if ln ig b ih ii ij ik il im in io lo iq ir is lp iu iv iw lq iy iz ja jb ha bi translated">杰西卡:你好:)我叫杰西卡，是一名小学老师。用户:嗨，你今天好吗？杰西卡:我感觉很好。你呢？<br/>用户:感觉有点低落<br/>杰西卡:</p></blockquote><p id="b0f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里有两个部分:</p><ol class=""><li id="a5ec" class="kr ks hh ig b ih ii il im ip lr it ls ix lt jb lu kz la lb bi translated">对机器人个性的描述</li><li id="5ea9" class="kr ks hh ig b ih lc il ld ip le it lf ix lg jb lu kz la lb bi translated">以“杰西卡:”结束的对话开头</li></ol><p id="6bce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，模型能够理解这种模式:它必须以“杰西卡”的身份做出响应。</p><p id="687c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦我们给了模型一个名字、图片、个性和对话历史，我们就可以在<a class="ae js" href="https://chai.ml/" rel="noopener ugc nofollow" target="_blank">网络应用</a>上与它对话，并将其部署到<a class="ae js" href="https://apps.apple.com/us/app/chai/id1544750895" rel="noopener ugc nofollow" target="_blank">移动应用</a>，在那里成千上万的用户可以与机器人对话。</p><h2 id="1063" class="lv ju hh bd jv lw lx ly jz lz ma mb kd ip mc md kh it me mf kl ix mg mh kp mi bi translated">高级参数</h2><p id="aa5b" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated">如果你喜欢冒险，你可以玩一些模型参数，甚至选择模型本身。</p><p id="e04c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">模型设置是温度和重复惩罚。如果你降低<strong class="ig hi">温度参数</strong>，你的机器人将产生更合理的反应，很可能是连贯的。如果你增加它，你可能会从你的人工智能那里得到更有创造性的反应，但是它也更有可能是不连贯的。</p><p id="63f0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">重复惩罚是另一个你可以调整的参数。如果你把它调得低一些，模型就可以更频繁地重复它以前见过的单词，如果你把它调得高一些，它就不会重复那么多了。如果重复惩罚太低，那么聊天机器人可能会一遍又一遍地重复自己。如果太高，机器人将被迫给出更多意想不到的反应，这可能不是你所希望的。</p><h2 id="f808" class="lv ju hh bd jv lw lx ly jz lz ma mb kd ip mc md kh it me mf kl ix mg mh kp mi bi translated">将您的机器人部署到成千上万的用户！</h2><p id="2165" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated">一旦你玩了参数，你对你的AI的性能感到满意，你可以点击“发布到应用程序”按钮，大约一分钟后它就会被部署！然后你只需要查看机器人排行榜，看看用户是否喜欢你的机器人。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mj"><img src="../Images/3e26f82b73ae1bd7d7dba0d64ca2ce88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*40Xxuz1ry05HpbOa4yW7Ew.gif"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">The <a class="ae js" href="http://chai.ml/dev" rel="noopener ugc nofollow" target="_blank">chat-bot leaderboard</a>.</figcaption></figure><h1 id="ddfc" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">理论:机器学习如何为聊天机器人建模</h1><p id="1de5" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated">构建“语言模型”到底意味着什么？这并不意味着硬编码语法规则。它实际上的意思是建立一个软件，你可以给出一个单词或字符序列，它会输出一个好的单词或字符序列来继续输入序列。例如:</p><p id="4182" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设字母表中只有4个字母:H、E、L和O。如果我们根据训练序列“heLLO”训练一个模型，我们预计如果我们给它输入“HE ”,它将输出“L ”,如果我们给它输入“HELL ”,它将输出“O”。</p><p id="4a32" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">更正式地说，我们可以这样写:什么字符c_n最大化概率P(c_n | c_{n-1}，…，c_0)？</p><p id="64ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的例子中，c_n是字母“O”。</p><p id="eb3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如何用文字做数学？</strong></p><p id="6b9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">神经网络基本上是大型微积分机器，对反向传播进行偏导数并应用非线性函数(例如sigmoid)。如果您需要复习这方面的内容，请查看<a class="ae js" href="https://www.youtube.com/watch?v=aircAruvnKk&amp;list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&amp;ab_channel=3Blue1Brown" rel="noopener ugc nofollow" target="_blank"> 3blue1brown的系列讲座</a>。但是你怎么用字母做微积分呢？你不知道。相反，您使用单词嵌入，这意味着将字符转换为向量的模式。这些方法中最简单的是1-to-k编码:在上面的小例子中，我们的词汇表是[H，E，L，O],因此字母H被编码为[1，0，0，0]向量，字母E被编码为[0，1，0，0]等等。好了，现在我们已经将字符转换为向量，我们肯定可以将向量输入到神经网络中(这是输入层)。</p><p id="4fff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这正是引擎盖下正在发生的事情，在一个高层次上，这些语言模型如<a class="ae js" href="https://www.infoq.com/news/2021/07/eleutherai-gpt-j/" rel="noopener ugc nofollow" target="_blank"> GPT-J </a>。</p><h1 id="3b9c" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">上下文:为什么现在是学习语言建模的好时机？</h1><p id="8552" class="pw-post-body-paragraph ie if hh ig b ih kt ij ik il ku in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated">简短的回答是:因为没有人意识到这些模型的重要性。如果你现在开始，你就走在了潮流的前面。</p><p id="f82f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在过去的一年里，语言建模领域的发展速度令人眩晕。仅仅在过去的6个月里:EleutherAI发布了GPT-3的开源版本，DeepMind展示了你可以建立与GPT-3一样强大但更小的模型(<a class="ae js" rel="noopener" href="/mlearning-ai/retrieval-enhanced-transformers-deepmind-paper-summary-efc2653e64b4">检索增强变形金刚</a>)，使训练更便宜，更容易部署，脸书人工智能研究所建立了他们自己的模型，优于GPT-3 ( <a class="ae js" href="https://github.com/pytorch/fairseq" rel="noopener ugc nofollow" target="_blank"> fairseq </a>)。</p><p id="33da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">按照这种速度，并考虑到模型已经有多好，很明显，几年后每个人都会清楚地看到这项技术的潜力。然后在它的背后会涌现出许多企业。</p><div class="mk ml ez fb mm mn"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hi fi z dy ms ea eb mt ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">medium.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb jm mn"/></div></div></a></div></div></div>    
</body>
</html>