<html>
<head>
<title>Introduction to Chi-Squared Test for Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的卡方检验介绍</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/introduction-to-chi-squared-test-for-machine-learning-2875d661d606?source=collection_archive---------0-----------------------#2021-01-30">https://medium.com/mlearning-ai/introduction-to-chi-squared-test-for-machine-learning-2875d661d606?source=collection_archive---------0-----------------------#2021-01-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/3a1dfa41be01001d33f03ee5abd23d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PiCxYP2S8wv5qC6E"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@claybanks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Clay Banks</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a0bc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">应用机器学习中的一个普遍问题是发现输入特征对于要预测的结果是否重要。<br/> <strong class="iw hi">这就是特征选择的问题。</strong></p><p id="f941" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在输入变量也是分类变量的分类问题中，我们将使用统计检验来确定输出变量是依赖于输入变量还是独立于输入变量。如果是独立的，则输入变量是可能不适合问题并从数据集中移除的特征的候选。</p><p id="a899" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">皮尔逊的卡方统计假设是检验分类变量之间独立性的一个例子。</p><h2 id="84cf" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">相依表</h2><p id="a88e" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">一个<strong class="iw hi">列联表</strong>，有时也称为双向频率表<strong class="iw hi">是一个至少有两行和两列的表格机制，在<strong class="iw hi">统计</strong>中使用，以频率计数的形式呈现分类数据。</strong></p><p id="94f0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">例如，带有人为计数的Sex=rows和Interest=columns表可能如下所示:</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="5356" class="js jt hh kx b fi lb lc l ld le">      Science, Math, Art<br/>Male     20,    30,  15<br/>Female   20,    15,  30</span></pre><p id="b5f4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">卡方分布的自由度基于列联表的大小计算如下:</p><p id="6aa0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">自由度:</strong>(行— 1) *(列— 1)</p><p id="298b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">就p值和选定的显著性水平(α)而言，测试可解释如下:</p><p id="2f47" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">If <strong class="iw hi"> p值</strong> <strong class="iw hi"> &lt; = </strong> alpha:显著结果，拒绝零假设(H0)，相依。</p><p id="392f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果<strong class="iw hi"> p值</strong><strong class="iw hi">&gt;</strong>α:不显著结果，未能拒绝零假设(H0)，独立。</p><p id="cdc3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Pearson的独立性卡方检验可以在Python中使用chi2_contingency() SciPy函数来计算。</p><p id="a332" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该函数将一个数组作为输入，表示两个分类变量的列联表。它返回计算的统计数据和<strong class="iw hi"> p值</strong>用于解释，以及计算的<strong class="iw hi">自由度</strong>和预期频率表。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="7bee" class="js jt hh kx b fi lb lc l ld le">stat, p, dof, expected = chi2_contingency(table)</span></pre><p id="4365" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以通过从自由度的概率和数量的卡方分布中检索临界值来解释统计数据。</p><p id="c48c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">例如，</strong> <br/>可以使用95%的概率，表明假设测试的变量是独立的，那么测试的发现是很有可能的。如果统计量小于或等于临界值，我们可以不拒绝这个假设，否则，可以拒绝。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="864c" class="js jt hh kx b fi lb lc l ld le"># interpret test-statistic<br/>prob = 0.95<br/>critical = chi2.ppf(prob, dof)<br/>if abs(stat) &gt;= critical:<br/>print('Dependent (reject H0)')<br/>else:<br/>print('Independent (fail to reject H0)')</span></pre><p id="6d68" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们还可以通过将p值与选定的显著性水平进行比较来解释p值，显著性水平为5%，通过反转临界值解释中使用的95%概率来计算。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="5d27" class="js jt hh kx b fi lb lc l ld le"># interpret p-value<br/>alpha = 1.0 - prob<br/>if p &lt;= alpha:<br/>print('Dependent (reject H0)')<br/>else:<br/>print('Independent (fail to reject H0)')</span></pre><p id="23f2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以将所有这些联系在一起，并使用一个设计好的列联表来演示卡方显著性检验。下面定义了一个列联表，它对每个群体(行)有不同数量的观察值，但对每个组(列)有相似的比例。给定相似的比例，我们期望测试发现组是相似的，并且变量是独立的(不能拒绝零假设或H0)。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="8ec3" class="js jt hh kx b fi lb lc l ld le">table = [ [10, 20, 30],<br/>           [6, 9, 17]]</span></pre><p id="67b6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">下面列出了完整的示例。</strong></p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="521d" class="js jt hh kx b fi lb lc l ld le"># chi-squared test with similar proportions<br/>from scipy.stats import chi2_contingency<br/>from scipy.stats import chi2<br/># contingency table<br/>table = [ [10, 20, 30],<br/>[6, 9, 17]]<br/>print(table)<br/>stat, p, dof, expected = chi2_contingency(table)<br/>print('dof=%d' % dof)<br/>print(expected)</span><span id="f96a" class="js jt hh kx b fi lf lc l ld le"># interpret test-statistic<br/>prob = 0.95<br/>critical = chi2.ppf(prob, dof)<br/>print('probability=%.3f, critical=%.3f, stat=%.3f' % (prob, critical, stat))<br/>if abs(stat) &gt;= critical:<br/>print('Dependent (reject H0)')<br/>else:<br/>print('Independent (fail to reject H0)')</span><span id="7118" class="js jt hh kx b fi lf lc l ld le"># interpret p-value<br/>alpha = 1.0 - prob<br/>print('significance=%.3f, p=%.3f' % (alpha, p))<br/>if p &lt;= alpha:<br/>print('Dependent (reject H0)')<br/>else:<br/>print('Independent (fail to reject H0)')</span></pre><p id="8a1f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">运行该示例首先打印列联表。计算测试，自由度(dof)报告为2，<br/>接下来，打印计算出的期望频率表，我们可以看到，通过肉眼检查数字，观察到的列联表确实匹配。<br/>计算并解释临界值，发现变量确实是独立的(未能拒绝H0)。对p值的解释得出了同样的结论。</p><pre class="ks kt ku kv fd kw kx ky kz aw la bi"><span id="c206" class="js jt hh kx b fi lb lc l ld le">[[10, 20, 30], [6, 9, 17]]<br/>dof=2<br/>[[10.43478261 18.91304348 30.65217391]<br/>[ 5.56521739 10.08695652 16.34782609]]<br/>probability=0.950, critical=5.991, stat=0.272<br/>Independent (fail to reject H0)<br/>significance=0.050, p=0.873<br/>Independent (fail to reject H0)</span></pre><p id="3367" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">感谢Regex软件提供冬季实习。</p><p id="62b6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">希望你喜欢这个帖子，一定要为这个帖子鼓掌。</p></div></div>    
</body>
</html>