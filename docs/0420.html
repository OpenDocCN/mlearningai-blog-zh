<html>
<head>
<title>Wine Quality Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">葡萄酒质量预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/wine-quality-prediction-6da930eb6ba1?source=collection_archive---------4-----------------------#2021-04-09">https://medium.com/mlearning-ai/wine-quality-prediction-6da930eb6ba1?source=collection_archive---------4-----------------------#2021-04-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/a6d60d405f6edddff546da859273af28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*YIEzsYy1a-mBrin6U5uaBg.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx">photo by <a class="ae ip" href="https://unsplash.com/@winephotos" rel="noopener ugc nofollow" target="_blank">Armands Brants</a> on Unsplash</figcaption></figure><h1 id="0f2d" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">导入所需的模块</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5fd8" class="jx ir hh jt b fi jy jz l ka kb">from sklearn.preprocessing import StandardScaler<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.neighbors import KNeighborsClassifier<br/>from sklearn.tree import DecisionTreeClassifier <br/>from sklearn.metrics import accuracy_score<br/>from sklearn.naive_bayes import GaussianNB<br/>import matplotlib.pyplot as plt<br/>from sklearn.svm import SVC<br/>import pandas as pd<br/>import numpy as np</span></pre><h1 id="344e" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">正在加载数据集</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="a003" class="jx ir hh jt b fi jy jz l ka kb">df = pd.read_csv(“datasets/winequality-red.csv”)</span></pre><h1 id="930c" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">了解数据集</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="9bdd" class="jx ir hh jt b fi jy jz l ka kb">df.head()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kc"><img src="../Images/6e1bd0eb5d60d3845b2a93abb8b35ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tl8EZ96dDOyvr-lhm0Ah3Q.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="3642" class="jx ir hh jt b fi jy jz l ka kb">df.info()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kh"><img src="../Images/3d68c638da57cfdc883dfba6213da9f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*1lyUMmrfYedwZuMQMAtB4g.png"/></div></figure><h1 id="f004" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">形象化</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="f0d3" class="jx ir hh jt b fi jy jz l ka kb">plt.bar(‘quality’,’fixed acidity’,data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ki"><img src="../Images/16921b7f8121732ac3187a4d81eeded7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*JQfcYYgEg5S50_7b6c544g.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d144" class="jx ir hh jt b fi jy jz l ka kb">plt.bar(‘quality’,’volatile acidity’,data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kj"><img src="../Images/bcda9c4a56e743c7bc14f60751b609c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*bbv98pMR_BviJgY0TV0e6A.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e821" class="jx ir hh jt b fi jy jz l ka kb">plt.bar('quality','citric acid',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kk"><img src="../Images/dbf689b6f38384ffe5b46b67be580f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*RwrDEGU1he0ykl_5R8ABMA.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="e5ad" class="jx ir hh jt b fi jy jz l ka kb">plt.bar('quality','residual sugar',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ki"><img src="../Images/a10c80f6702dd7645af801ca38c2a1c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*JalXl8j1fZDfUags9aw7aA.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1a79" class="jx ir hh jt b fi jy jz l ka kb">plt.bar('quality','chlorides',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kl"><img src="../Images/4a264b6c8f0eadb3c9f11e369bd633e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*43pdO4iCDAN7hzjnApNF8Q.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="60f3" class="jx ir hh jt b fi jy jz l ka kb">plt.bar('quality','free sulfur dioxide',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es km"><img src="../Images/69730c4ee17e1a243adc41f71294793d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*P6OHmaIzXWslGW-Ip37ynQ.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="3bc4" class="jx ir hh jt b fi jy jz l ka kb">plt.bar('quality','total sulfur dioxide',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kn"><img src="../Images/edc9994f24eaa78f267a317bdd91b319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*qhwozABICmMhUG4BTcZf0g.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c680" class="jx ir hh jt b fi jy jz l ka kb">plt.scatter('quality','density',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ko"><img src="../Images/f4196bcdb770ec1d803ea1c862bece1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*YuXEStf6k6L5I5_UUb8X8w.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="fa74" class="jx ir hh jt b fi jy jz l ka kb">plt.bar('quality','pH',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kp"><img src="../Images/ae932366c3927ec4ecee503d426a930e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*qDiD6RCBhm4U9BtpC8ahWQ.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="5bb2" class="jx ir hh jt b fi jy jz l ka kb">plt.bar('quality','sulphates',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kn"><img src="../Images/9e996d4ae6d5b3ccb8b654eecf8cb5d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*eqQl316UWEMrGKYhTcSMIw.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="d001" class="jx ir hh jt b fi jy jz l ka kb">plt.bar('quality','alcohol',data = df)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kq"><img src="../Images/75798a379cbf08d4234dab7c99157d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*0qIAM2AJpuSYFdPxkvtI1w.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="6cc5" class="jx ir hh jt b fi jy jz l ka kb">plt.plot(df["quality"])</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kr"><img src="../Images/4eaa824dba9950ee362330d7a60359bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*HqxqyxzOrS0_JcMQBvCkJw.png"/></div></figure><h1 id="7595" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">将葡萄酒质量分为好坏</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="fc1b" class="jx ir hh jt b fi jy jz l ka kb">#bins will set the limits for the classification.<br/>bins = (3, 6, 8) #qualities ranging from 3–6 are classified as bad and 6–8 as good<br/>group_names = [‘bad’, ‘good’]<br/>df[“quality”] = pd.cut(df[“quality”], bins = bins, labels = group_names)<br/>df["quality"].head()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/953f2f973a6ac894affdacc22e354622.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*_CbkqreV_9-Mst5k8QzzwQ.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="f054" class="jx ir hh jt b fi jy jz l ka kb">#one hot-encoding<br/>df[“quality”] = pd.get_dummies(df[“quality”],drop_first=True)<br/>df[“quality”][:5]</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/fe6dd04afcf9c8f2dbb7ee6c58bff32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*b7XTbtneckk_Tmw3wWcWdA.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="0f4d" class="jx ir hh jt b fi jy jz l ka kb">df[“quality”].value_counts()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ku"><img src="../Images/ac5e04b4d1876ca84647c037e926d089.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*9QkQFCZ4NDtHJJi6HTBCKg.png"/></div></figure><h1 id="9722" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">将数据集分离为目标变量和特征变量</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="895a" class="jx ir hh jt b fi jy jz l ka kb">X = df.drop(“quality”, axis = 1)<br/>y = df[‘quality’]<br/>X.head()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es kv"><img src="../Images/785486b9beb7ba2c7c3d7e254f8e472f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCty-2-N-lGGX8cmWN7sFQ.png"/></div></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="1478" class="jx ir hh jt b fi jy jz l ka kb">y.head()</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/8c2fba9eb9c97b575ab9985163e5df2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*0Lgnp7qKYoBApebXrLBbPQ.png"/></div></figure><h1 id="3edc" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">将数据集拆分为训练和测试数据</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="b079" class="jx ir hh jt b fi jy jz l ka kb">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 42)</span></pre><p id="3ba3" class="pw-post-body-paragraph kw kx hh ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ha bi translated">将y_train转换为一维</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="2b2c" class="jx ir hh jt b fi jy jz l ka kb">y_train = np.ravel(y_train)<br/>y_train</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es lu"><img src="../Images/04b9e14cbd0e36f5e09812dddb7c5188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*oae11vB7Avk4_5p_AOdSvQ.png"/></div></figure><p id="c961" class="pw-post-body-paragraph kw kx hh ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ha bi translated">应用标准缩放以获得优化结果</p><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c287" class="jx ir hh jt b fi jy jz l ka kb">sc = StandardScaler()<br/>X_train = sc.fit_transform(X_train)<br/>X_test = sc.fit_transform(X_test)</span></pre><h1 id="4420" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">创建模型</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="648e" class="jx ir hh jt b fi jy jz l ka kb">models = [ 'DecisionTreeClassifier', 'Support Vector Machine', 'GaussianNaiveBayes', 'KNeighborsClassifier', 'RandomForestClassifier']<br/>accuracy_score_list = []</span></pre><h1 id="30ff" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">决策树分类器</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="61e4" class="jx ir hh jt b fi jy jz l ka kb">dtc = DecisionTreeClassifier()<br/>dtc.fit(X_train, y_train)<br/>pred_dtc = dtc.predict(X_test)</span><span id="a2dd" class="jx ir hh jt b fi lv jz l ka kb">acc = accuracy_score(y_test, pred_dtc)<br/>accuracy_score_list.append(acc)<br/>print(acc)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es lw"><img src="../Images/ab76815f211ab207fdb2b330d7c66e72.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*SZXNOfxd607iSn8KoAgSuA.png"/></div></figure><h1 id="9569" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">支持向量机</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="68fb" class="jx ir hh jt b fi jy jz l ka kb">svm = SVC()<br/>svm.fit(X_train, y_train)<br/>pred_svm = svm.predict(X_test)</span><span id="d7f0" class="jx ir hh jt b fi lv jz l ka kb">acc = accuracy_score(y_test, pred_svm)<br/>accuracy_score_list.append(acc)<br/>print(acc)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/a203363f41d2f81a91f12eb435b01504.png" data-original-src="https://miro.medium.com/v2/resize:fit:194/format:webp/1*KzMlhbBxoSrEAI1tLBNo5w.png"/></div></figure><h1 id="ad84" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">高斯贝叶斯</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="4a74" class="jx ir hh jt b fi jy jz l ka kb">gnb = GaussianNB()<br/>gnb.fit(X_train, y_train)<br/>pred_gnb = gnb.predict(X_test)</span><span id="0320" class="jx ir hh jt b fi lv jz l ka kb">acc = accuracy_score(y_test, pred_gnb)<br/>accuracy_score_list.append(acc)<br/>print(acc)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/d5e7d3074f540c8a07e349a18c2eba77.png" data-original-src="https://miro.medium.com/v2/resize:fit:276/format:webp/1*UTIvaqCgA8Jp4AaHUbKeZg.png"/></div></figure><h1 id="076f" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">近邻分类器</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="c0f2" class="jx ir hh jt b fi jy jz l ka kb">knn = KNeighborsClassifier(n_neighbors=22)<br/>knn.fit(X_train, y_train)<br/>pred_knn = knn.predict(X_test)</span><span id="4a38" class="jx ir hh jt b fi lv jz l ka kb">acc = accuracy_score(y_test, pred_knn)<br/>accuracy_score_list.append(acc)<br/>print(acc)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/f2dc38593c21151d4db0cfdee8a801ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*Gal-rLke1FAZ4lWof1eycg.png"/></div></figure><h1 id="02e5" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">随机森林分类器</h1><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="fbc4" class="jx ir hh jt b fi jy jz l ka kb">rfc = RandomForestClassifier()<br/>rfc.fit(X_train, y_train)<br/>pred_rfc = rfc.predict(X_test)</span><span id="6628" class="jx ir hh jt b fi lv jz l ka kb">acc = accuracy_score(y_test, pred_rfc)<br/>accuracy_score_list.append(acc)<br/>print(acc)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/4f606132f2e392a12559e1ef46ee1d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:250/format:webp/1*833sbviC5zemT9Cv6Jhq4g.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="8d5e" class="jx ir hh jt b fi jy jz l ka kb">compare = pd.DataFrame({'Algorithms' : models , 'accuracy_score' : accuracy_score_list})<br/>compare.sort_values(by='accuracy_score' ,ascending=False)</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/b37ff0eab67299f20d261dd5e8173fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*rjKIzQPhhqUeEea8KYTdIg.png"/></div></figure><pre class="jo jp jq jr fd js jt ju jv aw jw bi"><span id="2114" class="jx ir hh jt b fi jy jz l ka kb">plt.plot(compare['Algorithms'], compare['accuracy_score'], label = "accuracy_score")</span></pre><figure class="jo jp jq jr fd ii er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es mc"><img src="../Images/781fdf33fd8cd98011c6eed86bd6e2a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIbVqzxgdZVKua6in09uwg.png"/></div></div></figure><h1 id="8822" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated">使用随机森林分类器的最大准确度是87%</h1></div></div>    
</body>
</html>