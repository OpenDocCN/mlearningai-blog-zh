<html>
<head>
<title>Time Series forecasting using SARIMAX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用SARIMAX进行时间序列预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/time-series-forecasting-using-sarimax-ca98dd7238a0?source=collection_archive---------1-----------------------#2022-01-31">https://medium.com/mlearning-ai/time-series-forecasting-using-sarimax-ca98dd7238a0?source=collection_archive---------1-----------------------#2022-01-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3802" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大家好，在我以前的一篇帖子中，我们讨论了如何使用经典时间序列模型(ARIMA)预测变量。在本帖中，我将向你展示如何使用一个经典的时间序列模型(SARIMAX ),以防你的数据集有相关的季节性趋势。看起来每个人都很兴奋，让我们快点开始吧。如果你不确定ARIMA模式，请跟进以下帖子:</p><div class="jc jd ez fb je jf"><a rel="noopener follow" target="_blank" href="/mlearning-ai/univariate-variable-time-series-forecasting-using-arima-using-python-2faa012413e1"><div class="jg ab dw"><div class="jh ab ji cl cj jj"><h2 class="bd hi fi z dy jk ea eb jl ed ef hg bi translated">基于PYTHON的ARIMA单变量时间序列预测</h2><div class="jm l"><h3 class="bd b fi z dy jk ea eb jl ed ef dx translated">问题陈述:我试图解决一个问题陈述，这将有助于预测单变量…</h3></div><div class="jn l"><p class="bd b fp z dy jk ea eb jl ed ef dx translated">medium.com</p></div></div><div class="jo l"><div class="jp l jq jr js jo jt ju jf"/></div></div></a></div><p id="ba47" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">理论:</strong> SARIMAX是四个不同模块的组合，即</p><p id="22e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">S-&gt;它代表季节性。如果您发现数据模式每月/每年都重复，那么是的，这是季节性的。</p><p id="e5d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">AR-&gt;自动回归意味着我的当前值依赖于所有滞后值或过去值。</p><p id="6584" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">I-&gt;如果你的数据集不是稳定的，你就像我们在上面提到的帖子中所做的那样，在ARIMA模型的情况下，继续尝试使它稳定。I代表我们用以前存在的价值创造的差异的数量。</p><p id="ae39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">移动平均线，在某种程度上我们需要把它卷起来。</p><p id="ad5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">X-&gt;它代表导致变量变化的其他外部变量。当我们做多变量时间序列分析时使用它。</p><p id="5a14" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们开始编码吧，因为我们要让经典时间序列模型的实现变得非常容易。</p><p id="2c5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们首先从导入非常基本的模块开始:</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es jv"><img src="../Images/cb42973f578fda1891ecc469f5068bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2sZlJvH6EN2bLq-UrppK3w.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Please import the packages as it is required for the practicals</figcaption></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es kk"><img src="../Images/10f0ad9e7538863f8f5bc00acf399bf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*-OmaEZGtGonT3NKahY9xtw.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">Basic modules imported</figcaption></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es kl"><img src="../Images/f4eaf8415866fcc809dfdc84f03b3651.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*Aqjdm2GIU8wqAAlIP1uLBw.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">Reading the dataset from Kaggle and setting the date column as index</figcaption></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es km"><img src="../Images/447a38453918e684f9c4e0114a3c6ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*dutxbWtnr28gqMXOUIdmaA.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">Visualizing the dataset</figcaption></figure><p id="9ed7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我可以用我的探索性数据分析技巧想象出数据有上升的趋势、每年的季节性和小的残差。让我们尝试应用更多的编码技巧。</p><p id="f005" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们需要检查并确定我的数据集是否是静态的。我相信你们都知道如何检查。如果你不喜欢，请阅读上面的博客。我也提到了简短的代码片段。</p><p id="3a3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这种情况下，我应用ADF测试(增强的Dickey Fuller测试)。我将用两种不同的方式向你展示如何去做(<strong class="ig hi">老方法</strong>):</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kn"><img src="../Images/9d94cf949874cc6a4bc5cb8899a83d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wYE0b0FwZgcERwJpfAeHhQ.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Data is not stationary. fails hypothesis test.</figcaption></figure><p id="cda6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们用另一种方式做同样的测试(<strong class="ig hi">新方式</strong>):</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ko"><img src="../Images/fbd8d48155ce77868fbc8a25ab6bfb24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CVJFcpRqfXvjsW7CH68T0Q.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Data is not stationary. fails hypothesis test.</figcaption></figure><p id="07ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们尝试将数据的四个组成部分形象化，这四个组成部分依次构成一个时间序列。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es kp"><img src="../Images/9d29018d2d585b5f92ef37cab20cbe86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*qczD_3dekhxOH7711YvPXg.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">Code for seasonal_decompose</figcaption></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kq"><img src="../Images/051f44315836cc6d3ce559e24a8bd671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHlSbRXgpFvqW5juWrYTOQ.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">EDA for 4 components in time series</figcaption></figure><p id="30b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，当我发现我的数据不是稳定的，我必须做大量的数学，微分和许多其他东西，使数据稳定，以应用时间序列模型。此外，我还必须执行pacf(部分自动相关)和acf(自动相关)测试，以确定p和q的值。让我们使用auto_arima包来简化这个过程。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kr"><img src="../Images/e23e73d3c67c97f2b046d0fd79dc5e48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfmXMropdLEIvmhv7jPsOw.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Just one line solves all our problem</figcaption></figure><p id="b08a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我命令我的代码尝试p、d和q的多种组合，从值1开始，一直到最大值5。它基于AIC值进行检查，并尝试返回p、d和q的最佳值。看起来如此简单和容易。</p><p id="3079" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">简言之，降低AIC的价值，作为回报，你会得到更好的模型。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ks"><img src="../Images/9ed5331cdbdc0842504c464c475e9f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cRh_99gMwrc4_KctddRYGw.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Computer suggested me to use SARIMAX. I even got the parameters (wowwww) moment!!!</figcaption></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ks"><img src="../Images/9ed5331cdbdc0842504c464c475e9f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cRh_99gMwrc4_KctddRYGw.png"/></div></div></figure><p id="4cf4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们尝试将数据分为训练数据集和测试数据集。我们必须用Sarimax训练我们的模型，测试它，然后预测未来的值。这是我们的主要目标。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es kt"><img src="../Images/80be8e7a133d3fbef32ffafffc3586e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*WcQaWsXjZktKPf6hNBKfeA.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">Splitting</figcaption></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es ku"><img src="../Images/5a0638128d3a9df0c1984fad85ec5896.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*x7Ibi2ssBk4z4uL7zqDigw.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">Checking the look and feel of train and test dataset</figcaption></figure><p id="0bad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们引入statsmodels包的使用，并尝试将SARIMAX模型实施到行动中。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kv"><img src="../Images/d9d683b320f8c27ea855c86de08169da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzxyaiIoBSJuFhhgwfufmQ.png"/></div></div></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kw"><img src="../Images/a390ccf3947969b8e5172936c95ed6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WqQHfE__PB0bu3N14mKGqQ.png"/></div></div></figure><p id="5e2f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们预测测试数据集的结果。这个过程非常有趣，有点不同，因为它是一个时间序列模型。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kx"><img src="../Images/b4d9b9aefd047f8a344d0e27ae38d1e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PAxcS5GYuVBzCUWWuIPxng.png"/></div></div></figure><p id="5652" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们把预测值和实际值连接起来，并把它们放在一起。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div class="er es ky"><img src="../Images/28ca51c10103d2f32a190d91b640516d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*7D06tI5jp1EYhYTbtG_WOA.png"/></div><figcaption class="kg kh et er es ki kj bd b be z dx">seems good</figcaption></figure><p id="4fde" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们尝试将实际值、预测值和预测值可视化。我得到了惊人的结果。</p><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kz"><img src="../Images/48d76c24d34eb58482c5199b51d82cb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IqJOWWW6461XIANphS5zLA.png"/></div></div></figure><figure class="jw jx jy jz fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es la"><img src="../Images/a065d39a93ec55fbd91374bc63438455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GqUHpmlDpbeXStZNxItlDA.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx">Seems awesome right!!!</figcaption></figure><p id="6c20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请记住，SARIMAX p，d，q值也可以通过以前的pacf和acf测试方法来确定，就像在以前的帖子中讨论的那样。我试图让这个过程变得简单一点，这样即使一个非技术人员也可以实现和使用它。如果你有任何疑问或担心，请让我知道。任何评论都可以帮助我更快地走向数据科学之路。</p><div class="jc jd ez fb je jf"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="jg ab dw"><div class="jh ab ji cl cj jj"><h2 class="bd hi fi z dy jk ea eb jl ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="jm l"><h3 class="bd b fi z dy jk ea eb jl ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="jn l"><p class="bd b fp z dy jk ea eb jl ed ef dx translated">medium.com</p></div></div><div class="jo l"><div class="lb l jq jr js jo jt ju jf"/></div></div></a></div></div></div>    
</body>
</html>