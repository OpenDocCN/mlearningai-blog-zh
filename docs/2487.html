<html>
<head>
<title>Meta-Learning the Huggingface Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">元学习拥抱脸的方式</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/meta-learning-the-huggingface-way-9422a08188ce?source=collection_archive---------1-----------------------#2022-05-09">https://medium.com/mlearning-ai/meta-learning-the-huggingface-way-9422a08188ce?source=collection_archive---------1-----------------------#2022-05-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="6481" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">作者</h1><p id="44c8" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">纳巴伦·巴鲁阿</p><p id="c447" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><a class="ae kf" href="https://github.com/nabarunbaruaAIML" rel="noopener ugc nofollow" target="_blank">Git</a>/<a class="ae kf" href="https://www.linkedin.com/in/nabarun-barua-aiml-engineer/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>/<a class="ae kf" rel="noopener" href="/@nabarun.barua">towards data science</a></p><p id="107a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">阿尔琼·库姆巴卡拉</p><p id="ff09" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><a class="ae kf" href="https://github.com/arjunKumbakkara" rel="noopener ugc nofollow" target="_blank">Git</a>/<a class="ae kf" href="https://www.linkedin.com/in/arjunkumbakkara/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>/<a class="ae kf" rel="noopener" href="/@arjunkumbakkara">towards data science</a></p><p id="8869" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">元学习是一个令人兴奋的研究趋势，在我们进入项目实施之前，我们认为我们应该首先了解元学习的基础。</p><p id="4946" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在传统的ML/DL方法中，我们遵循的是我们获得一个巨大的数据集，并开始在该数据集上进行训练，最终，我们获得了一个良好的准确度分数。</p><p id="ca53" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在，元学习方法就像人类学习的方式，它首先在一个领域学习&amp;在获得足够的知识后，它试图在下一个领域学习，在过去获得的知识的基础上用少量的例子。这样，通过多次重复这一步骤，我们可以在有限的训练数据下提高模型的准确性。现在，元学习比传统的对大型数据集进行微调的方法效果更好，因为该数据集有许多领域。然而，在传统的方法中，一个模型一次尝试在不同的随机域上学习，这增加了总的训练时间，而在元学习模型中，学习具有k个样本训练数据的域，并且无论正在学习什么，都在每个时期之后被传递到主模型(这里对于每个主/元时期，有多个被称为内部时期的更精简时期)</p><p id="e972" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">元学习有多种类型:</p><ol class=""><li id="a811" class="kg kh hh je b jf ka jj kb jn ki jr kj jv kk jz kl km kn ko bi translated">基于度量的元学习</li></ol><ul class=""><li id="0b07" class="kg kh hh je b jf ka jj kb jn ki jr kj jv kk jz kp km kn ko bi translated">暹罗网络</li><li id="82f2" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">匹配网络</li><li id="ce3f" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">原型网络</li><li id="aa61" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">关系网络</li></ul><p id="9360" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">2.基于优化的元学习</p><ul class=""><li id="f6e5" class="kg kh hh je b jf ka jj kb jn ki jr kj jv kk jz kp km kn ko bi translated">MAML(模型不可知元学习)</li><li id="c32b" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">一阶MAML</li><li id="0e0d" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">爬行动物</li></ul><p id="6800" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">上述元学习技术的细节将在这篇<a class="ae kf" href="https://arxiv.org/pdf/2007.09604.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>中提供</p><p id="4934" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在我们的项目中，我们使用了基于优化的元学习的MAML(模型不可知元学习)的变体爬虫。在根Meta_Learning.py中我们得到了一个完整的元学习训练过程。</p><p id="25bf" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在，在我们的项目Meta_Learning.py中，我们有两个重要的函数</p><ul class=""><li id="0d08" class="kg kh hh je b jf ka jj kb jn ki jr kj jv kk jz kp km kn ko bi translated">元任务:该函数创建n个随机任务，即n个域用于训练，给定K个样本用于训练集，L个样本用于测试集。</li><li id="298c" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">Leaner:该函数为元任务给出的每个任务训练i epoch，并在所有任务的训练结束时更新主模型的梯度。</li></ul><p id="476f" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如需详细的流程，请遵循以下整体元学习流程图:</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es kv"><img src="../Images/27ed7ad15a1d9b96722b2f0de1c80964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7XQln1ekmjIWpWkQU8A1UA.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx">Meta-Flow Diagram</figcaption></figure><p id="757a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在是技术堆栈:</p><ul class=""><li id="0151" class="kg kh hh je b jf ka jj kb jn ki jr kj jv kk jz kp km kn ko bi translated">拥抱变形金刚</li><li id="9650" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">拥抱面部数据集</li><li id="7162" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">拥抱脸加速</li><li id="a2d1" class="kg kh hh je b jf kq jj kr jn ks jr kt jv ku jz kp km kn ko bi translated">Pytorch</li></ul><p id="77f1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">对于以上技术栈，需要有一个基本的了解。我们使用Huggingface数据集而不是Pytorch数据集，因为Huggingface数据集使用apache arrow格式，数据处理速度快。为了更好地理解，请浏览我们以前的博客<a class="ae kf" rel="noopener" href="/mlearning-ai/forget-complex-traditional-approaches-to-handle-nlp-datasets-huggingface-dataset-library-is-your-1f975ce5689f">第一部分</a> &amp; <a class="ae kf" rel="noopener" href="/mlearning-ai/forget-complex-traditional-approaches-to-handle-nlp-datasets-huggingface-dataset-library-is-your-fe5de16d88c8">第二部分</a>。我们使用Huggingface <a class="ae kf" href="https://huggingface.co/docs/accelerate/index" rel="noopener ugc nofollow" target="_blank"> Accelerate </a>库，因为我们想要一个生产就绪的多GPU/CPU代码，可以毫不费力地部署。简单配置处理单个GPU/CPU或多个GPU的方法，而无需更改代码。</p><p id="9544" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在让我们来讨论这个项目(<a class="ae kf" href="https://github.com/nabarunbaruaAIML/Meta_Learning" rel="noopener ugc nofollow" target="_blank"> Github链接</a>)</p><p id="bd27" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">第一步从设置环境开始，我们有不同的bash文件来创建本地环境。请根据您的需要选择bash文件。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div class="er es ll"><img src="../Images/d93657d0c86149bf71a6793928009dce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*B92DgW2jyF8zKy3_fZeTEg.jpeg"/></div><figcaption class="lh li et er es lj lk bd b be z dx">Bash Files Images</figcaption></figure><p id="58ca" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在设置好本地环境之后，我们就可以开始元学习了，但是在我们开始元学习python文件之前。我们应该了解我们正在使用的数据集，下面是每个域的记录数:</p><p id="2430" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'服装':1717年，</p><p id="6a49" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'宝贝':1107，</p><p id="cff8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'美丽':993，</p><p id="88c6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'书籍':921，</p><p id="18db" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">camera_&amp;_photo': 1086，</p><p id="d799" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'手机服务':698，</p><p id="7baa" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">' dvd': 893，</p><p id="86b9" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'电子':1277年，</p><p id="bc37" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'杂货店':1100，</p><p id="5443" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">health_&amp;_personal_care': 1429，</p><p id="bfbd" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">珠宝_ &amp; _手表':1086，</p><p id="cf0c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">厨房用品:1390年，</p><p id="8e52" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">“杂志”:1133年，</p><p id="0ac9" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'音乐':1007，</p><p id="93c0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'户外_生活':980，</p><p id="aba3" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'软件':1029，</p><p id="3763" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">体育_ &amp; _户外':1336，</p><p id="709b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">玩具_游戏':1363年，</p><p id="9874" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'视频':1010，</p><p id="c70c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">'汽车':100，</p><p id="dd3e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">电脑_视频_游戏':100，</p><p id="b8fd" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">' office_products': 100</p><p id="2f88" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我们可以看到最后三个领域，即汽车、计算机&amp;视频游戏和办公产品只有100条记录，因此，我们将它们作为测试集，而其余的则在训练集中。</p><p id="4abc" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">元训练的所有配置和参数都集中在Config.yaml文件&amp; Params.yaml文件中，可以对其进行更改以影响训练。</p><figure class="kw kx ky kz fd la er es paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="er es lm"><img src="../Images/4e6951c35c46a873f87459a7dc86ce18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*0pR-RqNGYD8MzRqec83BYw.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx">Config &amp; Params Yaml File</figcaption></figure><p id="240e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在，要在多GPU或单GPU或CPU中执行培训，我们需要配置Accelerate，这样我们只需执行一个命令</p><pre class="kw kx ky kz fd ln lo lp lq aw lr bi"><span id="fd47" class="ls if hh lo b fi lt lu l lv lw">accelerate config</span></pre><p id="2ded" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">一旦上述命令执行，然后回答简单的问卷，它将为Accelerate Library生成一个配置文件，该文件将在培训期间自动选取(执行一次以创建一个配置文件)。这个过程是可选的，如果我们想以传统方式执行我们的python文件，那么Accelerate Library将使用适合单个GPU训练的默认参数来执行。</p><p id="d19b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">执行python文件的传统方式</p><pre class="kw kx ky kz fd ln lo lp lq aw lr bi"><span id="0b1f" class="ls if hh lo b fi lt lu l lv lw">python my_script.py</span></pre><p id="2297" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">现在，如果我们有一个多GPU设置，我们想训练，完成配置后。只需要执行下面的命令。</p><pre class="kw kx ky kz fd ln lo lp lq aw lr bi"><span id="1a0d" class="ls if hh lo b fi lt lu l lv lw">accelerate launch my_script.py</span></pre><p id="e767" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在我们的示例中，my_script.py是Meta_Learning.py文件。一旦执行上述命令，训练将开始。</p><p id="55b7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">您可以在running_logs.log文件中名为Logs的文件夹中看到结果。至此，我们的博文到此结束。</p><p id="7409" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我们工作的灵感来自这个完全在PyTorch中实现的<a class="ae kf" href="https://github.com/mailong25/meta-learning-bert" rel="noopener ugc nofollow" target="_blank"> Github </a>(龙脉)，如果你想完全用PyTorch的方式实现你的实现，请访问并检查。</p><p id="8d36" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如果你喜欢这个博客，请表达你的爱，给我们一个大拇指，给我们加星，如果不喜欢，请在评论区给我们一个反馈。这里希望你会喜欢这个实现！</p><p id="eb3a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">为了合作，帮助和一起学习-</p><h2 id="0dc8" class="ls if hh bd ig lx ly lz ik ma mb mc io jn md me is jr mf mg iw jv mh mi ja mj bi translated">加入我们的不和谐服务器:【https://discord.gg/Z7Kx96CYGJ】T2</h2><p id="e894" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">一路平安！</p><div class="mk ml ez fb mm mn"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hi fi z dy ms ea eb mt ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">medium.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb lf mn"/></div></div></a></div></div></div>    
</body>
</html>