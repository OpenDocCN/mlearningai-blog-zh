<html>
<head>
<title>A brief introduction to Feature Extraction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特征提取简介</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/a-brief-introduction-to-feature-extraction-e0a6ae4371b?source=collection_archive---------4-----------------------#2022-11-08">https://medium.com/mlearning-ai/a-brief-introduction-to-feature-extraction-e0a6ae4371b?source=collection_archive---------4-----------------------#2022-11-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="8fcb" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">从时间序列中提取特征时，您应该尝试一个有用的工具</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/6ea26def85114d0577dcc8327643d0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wa40TBlA-4EjT8Y3"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@jakehills?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jake Hills</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c94d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">您正在将原始时间序列数据用于监督或无监督学习模型，并且数据集太大而无法有效管理？还是你的学习模型速度相当慢？</p><p id="f3f1" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">那么你可能想更仔细地研究特征提取。在这篇文章中，我将简要介绍特征提取的目的、好处和挑战。最后，我将向您展示如何使用Python中的<code class="du kj kk kl km b">tsfresh</code>包轻松地从时间序列数据中获得特性。</p></div><div class="ab cl kn ko go kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ha hb hc hd he"><p id="4f65" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">特征提取的目的是从原始数据集中提取信息丰富、相关且不冗余的特征。由此，特征提取与降维相关。例如，我们可以提取时间序列的趋势、季节性或峰度，或将原始数据转换为数值。</p><p id="2f86" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">与直接使用原始数据集相比，特征提取具有以下优点。使用特征而不是原始数据改善了数据处理，并提高了我们的机器学习方法的学习速度，因为我们有一个更小的数据集。此外，当我们减少过度拟合的机会和更有效的模型构建时，我们通常会得到更好的结果。</p><p id="2894" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">然而，选择和组合特征是耗时且乏味的。我们需要识别可能的特征，提取特征，然后只使用需要的特征。最后一步非常重要，因为我们使用的每个功能都应该有助于改进我们的模型。</p><p id="0370" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">为此，我们需要对数据集有深刻的理解。因此，特征提取是一项重复的任务，是探索性数据分析和特征工程的结合。此外，拥有领域专业知识会有所帮助，因为这让我们更容易识别相关特性。最后，我们需要一个验证策略来检查每个特性在改进模型中的有效性。这样的策略应该比仅仅绘制和比较结果更加复杂和稳健。例如，我们可以构建一个基线模型，然后构建一个模型，在这个模型中，我们一个接一个地添加特性，并比较新模型是否比我们的基线模型有所改进。如果是，我们保留该特征，否则我们移除该特征。</p></div><div class="ab cl kn ko go kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ha hb hc hd he"><h1 id="0bc4" class="ku kv hh bd kw kx ky kz la lb lc ld le in lf io lg iq lh ir li it lj iu lk ll bi translated">时间序列特征提取</h1><p id="6421" class="pw-post-body-paragraph jn jo hh jp b jq lm ii js jt ln il jv jw lo jy jz ka lp kc kd ke lq kg kh ki ha bi translated">在深入研究时间序列的特征提取之前，我想简单地给你一些你应该记住的时间序列特征，除了常用的特征，如趋势、季节性、峰度和偏斜度，它们通常是检测模式的良好起点。</p><p id="252b" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">日期时间特征:</strong>这些可以由时间序列中每个观察的时间戳导出。例如，我们可以提取日、小时、工作日、假日等。使用Python的<a class="ae jm" href="https://pandas.pydata.org/docs/user_guide/timeseries.html#time-date-components" rel="noopener ugc nofollow" target="_blank"> pandas datetime功能</a>可以很容易地提取这些特性。</p><p id="4ef5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">滞后和窗口特征:</strong>有时值会受到先前时间步长值的影响。因此，检测到这样的模式，我们可以改进我们的模型。虽然很难确定这样的特征，但我们可以使用自相关来找到相互影响的值之间的正确滞后。</p><p id="8710" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们可以使用来自<code class="du kj kk kl km b">pandas</code>或<code class="du kj kk kl km b">numpy</code>的函数提取特征。或者，我们可以让我们的生活简单一点，通过使用<code class="du kj kk kl km b"><a class="ae jm" href="https://tsfresh.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">tsfresh</a></code>来自动提取特征。</p><h2 id="8075" class="lr kv hh bd kw ls lt lu la lv lw lx le jw ly lz lg ka ma mb li ke mc md lk me bi translated">自动化特征提取</h2><p id="591a" class="pw-post-body-paragraph jn jo hh jp b jq lm ii js jt ln il jv jw lo jy jz ka lp kc kd ke lq kg kh ki ha bi translated"><code class="du kj kk kl km b">tsfresh</code>是一个python包，可以自动计算几百个时间序列特征/特性。这些包括简单的特征，如最小值或中值，但也包括更复杂的特征，如相关性。该软件包还提供了评估每个特性的相关性/重要性的方法。我们可以通过运行<code class="du kj kk kl km b">pip install tsfresh</code>来安装<code class="du kj kk kl km b">tsfresh</code>。</p><p id="12fd" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我将向您展示如何使用基于电力负荷曲线时间序列的<code class="du kj kk kl km b">tsfresh</code>。我的数据帧包含每个<code class="du kj kk kl km b">day</code>在特定<code class="du kj kk kl km b">time</code>的有功功率值<code class="du kj kk kl km b">P</code>。如您所见，电力负荷曲线的分辨率为15分钟，涵盖了2020年5月下旬至2021年6月下旬之间的几天。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mf"><img src="../Images/9065f8010668c599ab5ef28d42c5785b.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*q5Ivgwk6ipNkUEKc6ez2OA@2x.jpeg"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">DataFrame of electricity load profiles in 15 min resolution.</figcaption></figure><p id="26c6" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">为了提取时间序列的特征，我们需要运行<code class="du kj kk kl km b"><a class="ae jm" href="https://tsfresh.readthedocs.io/en/latest/api/tsfresh.feature_extraction.html#" rel="noopener ugc nofollow" target="_blank">extract_features()</a></code>函数，并将时间序列数据作为DataFrame传递。此外，我们需要指定我们的数据的数据格式。</p><p id="aaf1" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">由于数据帧中可以有多个时间序列，我们需要通过将列名传递给参数<code class="du kj kk kl km b">column_id</code>来指示每个时间序列属于哪个实体。例如，在我的例子中，实体是天，因为我想提取每日电力负荷概况的特征。如果我想提取描述每个时间步载荷的特征，实体就是时间步。</p><p id="ed9f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">当我们想要提取时间序列的特征时，根据时间对值进行排序是很重要的。为了确保时间序列被排序，我们将指示时间步长的列传递给参数<code class="du kj kk kl km b">column_sort</code>。</p><p id="661c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">该函数返回包含每个实体的所有提取特征的数据帧。</p><pre class="ix iy iz ja fd mg km mh mi aw mj bi"><span id="984c" class="lr kv hh km b fi mk ml l mm mn">from tsfresh import extract_features</span><span id="f77a" class="lr kv hh km b fi mo ml l mm mn">extracted_features = extract_features(timeseries, column_id="date", column_sort="time", impute_function=impute)</span></pre><p id="1a05" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">通常，并不是所有的特征都能被计算出来，有些特征会带有<code class="du kj kk kl km b">NaN</code>值。我们可以通过传递参数<code class="du kj kk kl km b">impute_function</code>或者运行:</p><pre class="ix iy iz ja fd mg km mh mi aw mj bi"><span id="d1ce" class="lr kv hh km b fi mk ml l mm mn">from tsfresh.utilities.dataframe_functions import impute<br/><br/>impute(extracted_features)</span></pre><p id="5c53" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果您不想提取所有可能的特征，因为您已经确定了哪些参数是相关的，或者您想要微调您的特征提取，您可以将带有相关特征的<a class="ae jm" href="https://tsfresh.readthedocs.io/en/latest/text/feature_extraction_settings.html" rel="noopener ugc nofollow" target="_blank">字典</a>传递给<code class="du kj kk kl km b">default_fc_parameters</code>。例如，对于我的电力负荷曲线时间序列，我只想提取包括中值、平均值、最小值、最大值、峰度等特征。</p><pre class="ix iy iz ja fd mg km mh mi aw mj bi"><span id="282a" class="lr kv hh km b fi mk ml l mm mn">fc_parameters = {'sum_values': None, <br/>'median': None,<br/>'mean': None,<br/>'standard_deviation': None,<br/>'variation_coefficient': None,<br/>'variance': None,<br/>'skewness': None,<br/>'kurtosis': None,<br/>'last_location_of_maximum': None,<br/>'first_location_of_maximum': None,<br/>'last_location_of_minimum': None,<br/>'first_location_of_minimum': None,<br/>'maximum': None,<br/>'minimum': None,<br/>'number_peaks': [{'n': 1}, {'n': 3}, {'n': 5}, {'n': 10}]}</span><span id="e2be" class="lr kv hh km b fi mo ml l mm mn">extract_features = extract_features(timeseries, column_id="date", column_sort="time", impute_function=impute, default_fc_parameters=fc_parameters)</span></pre><p id="d616" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">要查看您可以选择哪些功能，您可以通过运行以下命令来查看<code class="du kj kk kl km b">tsfresh</code>的参数:</p><pre class="ix iy iz ja fd mg km mh mi aw mj bi"><span id="f904" class="lr kv hh km b fi mk ml l mm mn">from tsfresh.feature_extraction import ComprehensiveFCParameters</span><span id="8fa1" class="lr kv hh km b fi mo ml l mm mn">fc_parameters = ComprehensiveFCParameters()</span></pre><h2 id="4acd" class="lr kv hh bd kw ls lt lu la lv lw lx le jw ly lz lg ka ma mb li ke mc md lk me bi translated">自动化特征选择</h2><p id="b120" class="pw-post-body-paragraph jn jo hh jp b jq lm ii js jt ln il jv jw lo jy jz ka lp kc kd ke lq kg kh ki ha bi translated">在我们自动提取特征后，我们需要决定哪些是相关的。在这里，<code class="du kj kk kl km b">tsfresh</code>也可以帮助我们，如果我们有一个目标向量。为此，<code class="du kj kk kl km b">tsfresh</code>根据特征的<a class="ae jm" href="https://tsfresh.readthedocs.io/en/latest/text/feature_filtering.html" rel="noopener ugc nofollow" target="_blank">重要性识别特征，以预测目标</a>。例如，在我的例子中，目标向量可以是在对每日电力负荷分布图进行聚类之后的聚类标签。</p><p id="dbe9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们可以通过使用<code class="du kj kk kl km b">tsfresh</code>的<code class="du kj kk kl km b">select_features()</code>函数过滤特性，并将目标向量作为pandas Series或numpy数组传递:</p><pre class="ix iy iz ja fd mg km mh mi aw mj bi"><span id="2157" class="lr kv hh km b fi mk ml l mm mn">from tsfresh import select_features</span><span id="4603" class="lr kv hh km b fi mo ml l mm mn">features_filtered = select_features(extracted_features, target)</span></pre><p id="6eec" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><code class="du kj kk kl km b">tsfresh</code>不是分两步提取和过滤特征，而是允许我们一步完成特征提取和选择。为此，我们只需使用<code class="du kj kk kl km b">extract_relevant_features</code>功能:</p><pre class="ix iy iz ja fd mg km mh mi aw mj bi"><span id="4ec3" class="lr kv hh km b fi mk ml l mm mn">from tsfresh import extract_relevant_features</span><span id="c1c3" class="lr kv hh km b fi mo ml l mm mn">extract_relevant_features(timeseries, y, column_id='date', column_sort='time')</span></pre></div><div class="ab cl kn ko go kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ha hb hc hd he"><h1 id="6556" class="ku kv hh bd kw kx ky kz la lb lc ld le in lf io lg iq lh ir li it lj iu lk ll bi translated">结论</h1><p id="59d3" class="pw-post-body-paragraph jn jo hh jp b jq lm ii js jt ln il jv jw lo jy jz ka lp kc kd ke lq kg kh ki ha bi translated">特征提取可以帮助您改进机器学习模型，因为我们使用信息和非冗余特征来减少数据集的大小。然而，特别是特征提取和特征选择可能非常繁琐和耗时，因为我们需要识别可能的特征并决定它们是否相关。因此，在本文中，我向您展示了一个Python包，它可以帮助您找到时间序列的相关特征。</p><p id="9b06" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果你喜欢这篇文章和/或有任何意见，我很高兴听到它。</p><div class="mp mq ez fb mr ms"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mt ab dw"><div class="mu ab mv cl cj mw"><h2 class="bd hi fi z dy mx ea eb my ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mz l"><h3 class="bd b fi z dy mx ea eb my ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="na l"><p class="bd b fp z dy mx ea eb my ed ef dx translated">medium.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng jg ms"/></div></div></a></div></div></div>    
</body>
</html>