<html>
<head>
<title>Data Preprocessing in Python : 4 Essential Steps to Make your Dataset Ready</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的数据预处理:准备数据集的4个基本步骤</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/data-preprocessing-in-python-4-essential-steps-to-make-your-dataset-ready-ae4ce570b56f?source=collection_archive---------6-----------------------#2022-08-11">https://medium.com/mlearning-ai/data-preprocessing-in-python-4-essential-steps-to-make-your-dataset-ready-ae4ce570b56f?source=collection_archive---------6-----------------------#2022-08-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/7c32991416d0c721de5070255aa44538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iuA-WLeT9verltae"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@isaacmsmith?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Isaac Smith</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="6dfd" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">为什么要进行数据预处理？</h1><p id="6eb7" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">曾经想知道您的现实模型开发过程将如何增长吗？任何机器学习模型的准确性都取决于数据的清洁度和一致性。大多数时候，这与您的数据预处理技能高度相关。除了简单的回归问题，你将不得不处理分类和数字数据，使它们为模型开发做好准备。</p><p id="6937" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">如果你是机器学习的新手，你可能听说过数据科学和机器学习中广泛使用的术语:<a class="ae it" href="https://en.wikipedia.org/wiki/Data_pre-processing" rel="noopener ugc nofollow" target="_blank"> <em class="kv">数据预处理</em>。</a>良好的数据预处理是模型开发的下一步，可防止预期预测的准确性问题。在本指南中，我将解释应用更好的数据预处理的4个关键步骤。</p><p id="7dd6" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">我们首先进口熊猫和熊猫，然后阅读。csv文件来可视化数据集的表格形式。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="4ceb" class="lf iv hh lb b fi lg lh l li lj">import numpy as np<br/>import pandas as pd<br/>dataset = pd.read_csv('Data.csv')<br/>dataset</span></pre><figure class="kw kx ky kz fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/cc81c1993a98937228f97d55f0379be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*JXa-IKFp4kGW6T26TreS4g.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Tabular representation</figcaption></figure><p id="e838" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">该数据集包含数值变量和分类变量。我们必须将数据集分成特征和标签，以便使用强大的机器学习库<a class="ae it" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> <em class="kv"> scikit-learn进行进一步的预处理。</em> </a></p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="b4e6" class="lf iv hh lb b fi lg lh l li lj">X = dataset.iloc[:, :-1].values<br/>y = dataset.iloc[:, -1].values</span></pre><p id="9243" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">既然我们已经提取了要素和标签部分，我们可以继续进一步的预处理。</p><h1 id="5ba1" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">步骤1 —处理缺失值</h1><p id="4ca5" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">在现实世界中，数据集将包含缺失值。由于您的数据源不同，此问题可能会出现，也可能不会出现。有许多方法可以处理数据集的缺失值。有效的方法之一就是使用scikit-learn的SimpleImputer。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="f40d" class="lf iv hh lb b fi lg lh l li lj">from sklearn.impute import SimpleImputer<br/>imputer = SimpleImputer(missing_values=np.nan, strategy='mean')<br/>imputer.fit(X[:, 1:3])<br/>X[:, 1:3] = imputer.transform(X[:, 1:3])<br/>print(X)</span></pre><p id="899f" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">当你创建一个简单估算对象时，它需要两个基本的关键字参数:<a class="ae it" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html" rel="noopener ugc nofollow" target="_blank"> <em class="kv"> missing_values </em> </a>和<a class="ae it" href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.SimpleImputer.html" rel="noopener ugc nofollow" target="_blank"> <em class="kv">策略</em> </a>。请注意，我们使用<em class="kv"> mean </em>是因为数据集中缺失的值是数字。你需要根据场合使用其他人。使用<em class="kv">。拟合</em>属性，我们可以通过索引必要的列来拟合X上的估算值。同理，<em class="kv">。变换</em>属性估算x中所有缺失的值</p><p id="c519" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">这些是结果:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div class="er es ll"><img src="../Images/0c0042ed8406769af3415305c6880b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*MCGKkBaGzm3tvwneCboDDw.png"/></div></figure><h1 id="bd2c" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">步骤2——编码独立变量</h1><p id="8719" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">数据集的第一列包含分类数据。分类数据是<strong class="ju hi">一种</strong>类型的数据<strong class="ju hi"> </strong>即<strong class="ju hi"> </strong>用于分组具有<strong class="ju hi">相似特征</strong>的信息，而数值数据是一种以数字形式表达信息的数据类型。</p><p id="fa96" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">大多数机器学习模型只接受数值变量。因此，预处理分类变量成为一个必要的步骤。我们需要将这些分类变量转换成数字，以便<strong class="ju hi">模型能够理解并提取有价值的信息</strong>。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="9cfa" class="lf iv hh lb b fi lg lh l li lj">from sklearn.compose import ColumnTransformer<br/>from sklearn.preprocessing import OneHotEncoder<br/>ct = ColumnTransformer(transformers=[('encoder', OneHotEncoder(), [0])], remainder='passthrough')<br/>X = np.array(ct.fit_transform(X))</span></pre><p id="fd9c" class="pw-post-body-paragraph js jt hh ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp ha bi translated">在这个例子中，我们使用一个热编码<em class="kv">(或者序数编码)。</em> One Hot编码是机器学习模型分类特征预处理的常用方式。这种类型的编码为每个可能的类别创建一个新的二进制特征，并将值1分配给对应于其原始类别的每个样本的特征。</p><h1 id="304c" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">第三步——因变量编码</h1><p id="c54f" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">我们将应用相同的过程，因为数据集的最后一列<em class="kv">(标签)</em>也包含分类数据。这一次我们使用的是<a class="ae it" href="https://scikit-learn.org/stable/modules/preprocessing_targets.html#preprocessing-targets" rel="noopener ugc nofollow" target="_blank"> <em class="kv"> LabelEncoder </em> </a>，它是一个实用程序类，帮助标准化标签，使它们只包含0和n_classes-1之间的值。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="c6a4" class="lf iv hh lb b fi lg lh l li lj">from sklearn.preprocessing import LabelEncoder<br/>le = LabelEncoder()<br/>y = le.fit_transform(y)</span></pre><h1 id="fe56" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">步骤4-训练-测试分割</h1><p id="8db6" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">现在是时候将我们的数据集分成<em class="kv">训练</em>部分和<em class="kv">测试</em>部分了。<a class="ae it" href="https://www.geeksforgeeks.org/how-to-split-a-dataset-into-train-and-test-sets-using-python/" rel="noopener ugc nofollow" target="_blank"> <em class="kv">训练测试分割</em> </a>用于近似适用于基于预测的应用的机器学习算法的性能。这种方法是一种快速且容易执行的程序，使得我们可以将我们自己的机器学习模型结果与机器结果进行比较。</p><pre class="kw kx ky kz fd la lb lc ld aw le bi"><span id="e398" class="lf iv hh lb b fi lg lh l li lj">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state=1)</span></pre><h1 id="2136" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">结论</h1><p id="462e" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">总之，我们已经执行了必要的数据预处理步骤，以使我们的数据集为模型开发做好准备。在将数据集从原始数据转换为模型就绪数据时，执行这些步骤始终非常重要。</p><div class="lm ln ez fb lo lp"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lq ab dw"><div class="lr ab ls cl cj lt"><h2 class="bd hi fi z dy lu ea eb lv ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lw l"><h3 class="bd b fi z dy lu ea eb lv ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lx l"><p class="bd b fp z dy lu ea eb lv ed ef dx translated">medium.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md in lp"/></div></div></a></div></div></div>    
</body>
</html>