# ä½¿ç”¨ CNN çš„éŸ³ä¹æµæ´¾åˆ†ç±»:ç¬¬ 1 éƒ¨åˆ†-ç‰¹å¾æå–

> åŸæ–‡ï¼š<https://medium.com/mlearning-ai/music-genre-classification-using-cnn-part-1-feature-extraction-b417547b8981?source=collection_archive---------1----------------------->

äº†è§£å¦‚ä½•ä»éŸ³é¢‘ä¸­æå–ç‰¹å¾ï¼Œå¹¶ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œå°†éŸ³ä¹åˆ†ç±»ä¸ºä¸åŒçš„æµæ´¾ã€‚

![](img/562ce9f3d89216e7d3a32fd02b5ba152.png)

Photo by [Marius Masalar](https://unsplash.com/@marius?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

# ä»‹ç»

æˆ‘ä»¬æ¯å¤©éƒ½å¬éŸ³ä¹ï¼Œä¸ç®¡æ˜¯åœ¨å®¶é‡Œï¼Œåœ¨è½¦é‡Œï¼Œè¿˜æ˜¯åœ¨ä»»ä½•åœ°æ–¹ã€‚éŸ³ä¹åˆ†ä¸ºä¸åŒçš„æµæ´¾ï¼Œå¦‚æµè¡Œã€æ‘‡æ»šã€é‡‘å±ã€çˆµå£«ã€è“è°ƒç­‰ã€‚æ¯å¤©å¤§çº¦æœ‰ 24ï¼Œ000 é¦–æ­Œæ›²è¢«å‘å¸ƒã€‚æ¯å¤©å‘å¸ƒçš„æ­Œæ›²å¦‚æ­¤ä¹‹å¤šï¼Œä»¥è‡³äºæ— æ³•å¯¹å®ƒä»¬è¿›è¡Œæ‰‹åŠ¨åˆ†ç±»ã€‚åƒ Shazam å’Œ Spotify è¿™æ ·çš„åº”ç”¨ç¨‹åºå¯ä»¥æ’­æ”¾æ•°ç™¾ä¸‡é¦–æ­Œæ›²ï¼Œå¹¶ä½¿ç”¨éŸ³ä¹æµæ´¾åˆ†ç±»ç³»ç»Ÿå°†å®ƒä»¬å½’ç±»ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨æœºå™¨å­¦ä¹ ç®—æ³•æ¥è‡ªåŠ¨åŒ–è¿™é¡¹å·¥ä½œã€‚éŸ³ä¹å¹³å°ä½¿ç”¨éŸ³ä¹æµæ´¾åˆ†ç±»å°†éŸ³ä¹åˆ†ä¸ºä¸åŒçš„ç±»åˆ«ï¼Œä»¥å®ç°å®šåˆ¶çš„ UX(ç”¨æˆ·ä½“éªŒ)ã€‚Spotify å°†å…¶éŸ³ä¹åˆ†ä¸º 5071 ç§ç±»å‹ã€‚ä»–ä»¬ä½¿ç”¨éŸ³ä¹åˆ†ç±»å‘å®¢æˆ·æä¾›ä¸ªæ€§åŒ–çš„æ¨èã€‚

ä¸ºäº†åˆ†ç±»çš„ç›®çš„ï¼Œæˆ‘ä»¬ä»éŸ³é¢‘æ–‡ä»¶ä¸­æå–æ—¶åŸŸå’Œé¢‘åŸŸç‰¹å¾ã€‚è¿™äº›ç‰¹å¾æ˜¯å…‰è°±å›¾ã€æ¢…å°”å…‰è°±å›¾ã€MFCCã€å…‰è°±è´¨å¿ƒã€è‰²è°±å›¾ã€èƒ½é‡ã€å…‰è°±è¡°å‡ã€å…‰è°±é€šé‡ã€å…‰è°±ç†µã€è¿‡é›¶ç‡å’Œé—´è·ã€‚éŸ³ä¹æµæ´¾åˆ†ç±»å¤„ç†çš„ä¸€ä¸ªä¸»è¦é—®é¢˜æ˜¯ä¸€äº›æµæ´¾å¯èƒ½è¢«é”™è¯¯åœ°åˆ†ç±»ä¸ºå½¼æ­¤ï¼Œä¾‹å¦‚ä¹¡æ‘å’Œæ‘‡æ»šã€æµè¡Œå’Œè¿ªæ–¯ç§‘ã€çˆµå£«å’Œé›·é¬¼ç­‰ã€‚å¾ˆå°‘æœ‰ç±»æ˜¯é«˜åº¦ç›¸ä¼¼çš„ï¼Œå¹¶ä¸”å½¼æ­¤æœ‰æ˜¾è‘—çš„é‡å ã€‚

# **æ•°æ®é›†æè¿°**

æˆ‘ä»¬ä½¿ç”¨äº† [GTZAN](https://www.tensorflow.org/datasets/catalog/gtzan) æ•°æ®é›†ã€‚GTZAN æ•°æ®é›†åŒ…å« 1000 ä¸ªéŸ³é¢‘æ–‡ä»¶å’Œæ¯ç»„ 100 ä¸ªéŸ³é¢‘(10 ç»„)ã€‚å®ƒåŒ…å«ä»¥ä¸‹ç±»åˆ«:æ‘‡æ»šã€æµè¡Œã€çˆµå£«ã€è“è°ƒã€ä¹¡æ‘ã€é‡‘å±ã€è¿ªæ–¯ç§‘ã€é›·é¬¼ã€å˜»å“ˆå’Œå¤å…¸ã€‚è¯»å–éŸ³é¢‘æ–‡ä»¶æ—¶ï¼Œå‘ç°äº† 56 ä¸ªæŸåçš„æ–‡ä»¶ã€‚å› æ­¤ï¼Œå¯¹ 944 ä¸ªæ–‡ä»¶è¿›è¡Œäº†ç‰¹å¾æå–å’Œåˆ†ç±»ã€‚

ä»æ—¶åŸŸæå–æ—¶é—´ç‰¹å¾ï¼Œä»é¢‘åŸŸæå–é¢‘è°±ç‰¹å¾ã€‚ç„¶è€Œï¼Œåƒå…‰è°±å›¾ã€MFCCs ç­‰ç‰¹å¾ã€‚åŒ…å«æ—¶é—´å’Œé¢‘ç‡ä¿¡æ¯ã€‚

# æ—¶é¢‘åŸŸç‰¹å¾

æˆ‘ä»¬åœ¨åˆ†ç±»ä»»åŠ¡ä¸­ä½¿ç”¨äº†ä»¥ä¸‹åŠŸèƒ½:

## **1ã€‚å£°è°±å›¾**

é¢‘è°±å›¾æ˜¯ä¿¡å·å¼ºåº¦éšæ—¶é—´å˜åŒ–çš„ç›´è§‚è¡¨ç¤ºï¼Œåœ¨æ¯ä¸ªæ—¶é—´æ­¥é•¿éƒ½æœ‰ä¸åŒçš„é¢‘ç‡ã€‚å°±éŸ³é¢‘è€Œè¨€ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸ºå£°è°±å›¾æˆ–å£°è°±å›¾ã€‚å£°è°±å›¾æœ‰ä¸‰ä¸ªç»´åº¦ï¼Œä¸¤ä¸ªæ˜¯é¢‘ç‡(y è½´)å’Œæ—¶é—´(x è½´)ï¼Œç¬¬ä¸‰ä¸ªç»´åº¦æ˜¯æŒ¯å¹…ã€‚

ä¸‹å›¾æ˜¯ä¸€ä¸ªå£°è°±å›¾ï¼Œé»„è‰²ä»£è¡¨é«˜æŒ¯å¹…ï¼Œè“è‰²ä»£è¡¨ä½æŒ¯å¹…ã€‚

ä½¿ç”¨å‚…ç«‹å¶å˜æ¢ä»æ—¶åŸŸè®¡ç®—å…‰è°±å›¾ã€‚å½“éŸ³é¢‘è¢«é‡‡æ ·æ—¶(åœ¨æ—¶åŸŸä¸­)ï¼Œå®ƒè¢«åˆ†å‰²æˆå‡ ä¸ªé‡å çš„çª—å£ã€‚ç„¶åï¼Œä½¿ç”¨çŸ­æ—¶å‚…ç«‹å¶å˜æ¢(STFT)æ¥è®¡ç®—æ¯ä¸ªçª—å£çš„é¢‘è°±ï¼Œå¹¶ä¸”æ¯ä¸ªçª—å£è¡¨ç¤ºå›¾åƒä¸­çš„ä¸€æ¡å‚ç›´çº¿ã€‚è¿™äº›é›¶ä»¶å¹¶æ’æ”¾åœ¨ä¸€èµ·ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºçª—å£ã€‚é€šè¿‡æ•°å­—å¤„ç†åˆ›å»ºé¢‘è°±å›¾çš„è¿‡ç¨‹å®è´¨ä¸ŠåŒ…æ‹¬è®¡ç®—ç‰¹å®šçª—å£å®½åº¦çš„ä¿¡å· STFT çš„å¹³æ–¹å¹…åº¦ã€‚éŸ³é¢‘æ–‡ä»¶çš„å£°è°±å›¾å¦‚å›¾ 1 æ‰€ç¤ºã€‚

![](img/7b8641f7157224fce6f6c5766b59bb44.png)

Fig 1: Spectrogram of sample audio (Image by the Author)

## 2.**æ¢…å°”è°±å›¾**

Mel æ ‡åº¦(åœ¨å•è¯ melody ä¹‹å)æ˜¯ä¸€ä¸ªæ„ŸçŸ¥æ ‡åº¦ï¼Œç”±å¬è€…åˆ¤æ–­å½¼æ­¤ä¹‹é—´çš„è·ç¦»ç›¸ç­‰ã€‚

ä¸è¾ƒé«˜é¢‘ç‡ç›¸æ¯”ï¼Œäººç±»å¯ä»¥å¾ˆå¥½åœ°æ£€æµ‹è¾ƒä½é¢‘ç‡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åŒºåˆ† 200 Hz å’Œ 400 Hz ä¹‹é—´çš„å·®å¼‚ï¼Œä½†æˆ‘ä»¬æ— æ³•åŒºåˆ† 2000 Hz å’Œ 2200 Hz ä¹‹é—´çš„å·®å¼‚ï¼Œå³ä½¿ä¸¤å¯¹ä¹‹é—´çš„å·®å¼‚ä¸º 200 Hzã€‚åŸå› æ˜¯äººç±»ä»¥éçº¿æ€§çš„æ–¹å¼æ„ŸçŸ¥å£°éŸ³ã€‚Mel-scale æ­£æ˜¯è¿™æ ·åšçš„ã€‚ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ mel æ ‡åº¦éšç€é¢‘ç‡çš„å¢åŠ æŒ‡æ•°åœ°åˆ†ç»„æ›´é«˜çš„é¢‘ç‡ã€‚Mel æ ‡åº¦ä¸ Hertz æ ‡åº¦çš„å…³ç³»å¦‚å›¾ 2 æ‰€ç¤ºã€‚

![](img/137320d3d3e1f1266d8147b8bb52d0f3.png)

Fig 2: Mel scale versus Hertz scale ([source](https://en.wikipedia.org/wiki/Mel_scale))

åœ¨ mel é¢‘è°±å›¾ä¸­ï¼Œä½¿ç”¨ mel æ»¤æ³¢å™¨ç»„å°†é¢‘è°±å›¾è½¬æ¢ä¸º Mel æ ‡åº¦ã€‚åœ¨è®¡ç®—è°±å›¾ä¹‹åï¼Œæˆ‘ä»¬å°†è°±å›¾çš„é¢‘ç‡(y è½´)æ˜ å°„åˆ° mel æ ‡åº¦ä»¥å½¢æˆ Mel è°±å›¾ã€‚éŸ³é¢‘æ–‡ä»¶çš„ Mel è°±å›¾å¦‚å›¾ 3 æ‰€ç¤ºã€‚

![](img/de3a2f4f923d9468fc5ac1aebb2e8ec4.png)

Fig 3: Mel-Spectrogram of sample audio (Image by the Author)

## 3.MFCC

MFCC æ˜¯æ¢…å°”é¢‘ç‡å€’è°±ç³»æ•°ã€‚å®ƒä»¬æ˜¯ç²¾ç¡®æè¿°å…‰è°±åŒ…ç»œå®Œæ•´å½¢çŠ¶çš„ä¸€å°ç»„ç‰¹å¾ã€‚MFCC ä½¿ç”¨ MEL æ ‡åº¦å°†é¢‘å¸¦åˆ’åˆ†ä¸ºå­å¸¦ã€‚ç„¶åï¼Œé€šè¿‡è®¡ç®—ç¦»æ•£ä½™å¼¦å˜æ¢(DCT)æå–å€’è°±ç³»æ•°ã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼ŒMFCCs å‹ç¼©äº† Mel è°±å›¾çš„æ•°æ®ã€‚DCT å› æ˜“äºå›¾åƒå‹ç¼©è€Œæµè¡Œã€‚MFCC ä»£è¡¨å£°é“çš„å½¢çŠ¶ã€‚éŸ³é¢‘æ–‡ä»¶çš„ MFCC å¦‚å›¾ 5 æ‰€ç¤ºã€‚

![](img/6bee8e23f2b21e5df9b89bdd015b200a.png)

Fig 5: MFCC of sample audio (Image by the Author)

# å±¥è¡Œ

ä»¥ä¸‹æ˜¯æå–ä¸åŒç±»å‹ç‰¹å¾çš„æ­¥éª¤:

1.  **å¯¼å…¥åº“**

2.**ä¿å­˜éŸ³é¢‘è·¯å¾„å’Œç›®æ ‡æ ‡ç­¾**

3.æå–ç‰¹å¾:ç°åœ¨ï¼Œæˆ‘ä»¬ä»éŸ³é¢‘ä¸­æå–ä¸åŒçš„ç‰¹å¾ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æå–äº†å…‰è°±å›¾ã€æ¢…å°”å…‰è°±å›¾ã€MFCCã€è¿‡é›¶ç‡ã€å…‰è°±è´¨å¿ƒå’Œè‰²è°±å›¾ã€‚ä½†æ˜¯å‡ºäºåˆ†ç±»çš„ç›®çš„ï¼Œæˆ‘ä»¬å°†åªä½¿ç”¨å£°è°±å›¾ã€æ¢…å°”å£°è°±å›¾å’Œ MFCCã€‚ä¸€äº›éŸ³é¢‘æ–‡ä»¶å·²æŸåï¼Œå› æ­¤æˆ‘ä»¬æ‰¾åˆ°äº†è¿™äº›æŸåçš„éŸ³é¢‘æ–‡ä»¶çš„ç´¢å¼•ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚

4.**åˆ é™¤æŸåçš„æ–‡ä»¶:**åˆ é™¤æŸåç´¢å¼•å¤„çš„éŸ³é¢‘æ–‡ä»¶å’Œæ ‡ç­¾ã€‚ç„¶åï¼Œè¦ç´ è¢«è½¬æ¢ä¸º float32 æ•°æ®ç±»å‹ä»¥èŠ‚çœå†…å­˜ä½¿ç”¨ã€‚ä¹‹åï¼Œæˆ‘ä»¬ç»™æ ‡ç­¾åˆ†é…æ•°å€¼ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢æˆåˆ†ç±»æ•°æ®ã€‚æœ€åï¼Œæˆ‘ä»¬å°†æ‰€æœ‰æå–çš„ç‰¹å¾åŠå…¶æ ‡ç­¾ä¿å­˜åˆ°ä¸€ä¸ª. npz æ–‡ä»¶ä¸­ã€‚å½“æˆ‘ä»¬å¼€å§‹åˆ†ç±»ä»»åŠ¡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åŠ è½½ã€‚npz æ–‡ä»¶æ¥ä½¿ç”¨è¿™äº›åŠŸèƒ½ã€‚

> å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨ GitHub [è¿™é‡Œ](https://github.com/namratadutt/Music-genre-classification-Feature-extraction)è·å¾—ã€‚

# ç»“è®º

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä»éŸ³é¢‘ä¸­æå–ä¸åŒçš„ç‰¹å¾ã€‚åœ¨æœ¬æ–‡çš„ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åˆ†åˆ«ä½¿ç”¨è¿™äº›ç‰¹å¾å’Œè¿™äº›ç‰¹å¾çš„ç»„åˆæ¥å¯¹éŸ³é¢‘è¿›è¡Œåˆ†ç±»ã€‚æˆ‘ä»¬å°†æ¢ç´¢éŸ³ä¹æµæ´¾åˆ†ç±»çš„æ·±åº¦ CNNã€‚

> *æ„Ÿè°¢é˜…è¯»ï¼æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚*
> 
> åŠ æ²¹é³„é±¼é˜Ÿï¼ğŸŠ

# å‚è€ƒ

[](https://en.wikipedia.org/wiki/Mel_scale) [## æ¢…å°”é‡è¡¨-ç»´åŸºç™¾ç§‘

### mel æ ‡åº¦(å•è¯å)æ˜¯ä¸€ä¸ªæ„ŸçŸ¥æ ‡åº¦ï¼Œç”±å¬ä¼—åˆ¤æ–­éŸ³é«˜ä¸ä¸€ä¸ªâ€¦

en.wikipedia.org](https://en.wikipedia.org/wiki/Mel_scale) [](https://towardsdatascience.com/music-genre-classification-with-python-c714d032f0d8) [## ç”¨ Python è¿›è¡ŒéŸ³ä¹æµæ´¾åˆ†ç±»

### éŸ³ä¹å°±åƒä¸€é¢é•œå­ï¼Œå®ƒå‘Šè¯‰äººä»¬ä½ æ˜¯è°ï¼Œä½ å…³å¿ƒä»€ä¹ˆã€‚ä½ å°±æ˜¯ä½ æ‰€æµçš„ã€‚

towardsdatascience.com](https://towardsdatascience.com/music-genre-classification-with-python-c714d032f0d8) [](https://www.kaggle.com/datasets/andradaolteanu/gtzan-dataset-music-genre-classification) [## GTZAN æ•°æ®é›†-éŸ³ä¹æµæ´¾åˆ†ç±»

### éŸ³é¢‘æ–‡ä»¶| Mel å…‰è°±å›¾|å¸¦æå–ç‰¹å¾çš„ CSV

www.kaggle.com](https://www.kaggle.com/datasets/andradaolteanu/gtzan-dataset-music-genre-classification) [](https://www.tensorflow.org/datasets/catalog/gtzan) [## gtzan | TensorFlow æ•°æ®é›†

### æ•°æ®é›†ç”± 1000 ä¸ªéŸ³è½¨ç»„æˆï¼Œæ¯ä¸ªéŸ³è½¨é•¿ 30 ç§’ã€‚å®ƒåŒ…å« 10 ä¸ªæµæ´¾ï¼Œæ¯ä¸ªæµæ´¾ä»£è¡¨ 100 é¦–æ›²ç›®â€¦

www.tensorflow.org](https://www.tensorflow.org/datasets/catalog/gtzan)  [## ç‰¹å¾æå–- librosa 0.9.1 æ–‡æ¡£

### ç¼–è¾‘æè¿°

librosa.org](https://librosa.org/doc/main/feature.html) [](https://ieeexplore.ieee.org/document/1021072) [## éŸ³é¢‘ä¿¡å·çš„éŸ³ä¹ç±»å‹åˆ†ç±»

### éŸ³ä¹æµæ´¾æ˜¯äººç±»åˆ›é€ çš„ç”¨æ¥æè¿°éŸ³ä¹ä½œå“çš„åˆ†ç±»æ ‡ç­¾ã€‚éŸ³ä¹æµæ´¾æ˜¯â€¦

ieeexplore.ieee.org](https://ieeexplore.ieee.org/document/1021072) [](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb) [## Mlearning.ai æäº¤å»ºè®®

### å¦‚ä½•æˆä¸º Mlearning.ai ä¸Šçš„ä½œå®¶

medium.com](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb)