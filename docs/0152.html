<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/different-cross-validation-types-and-how-it-works-to-overcome-overfitting-in-machine-learning-59297fca64f9?source=collection_archive---------3-----------------------#2021-02-22">https://medium.com/mlearning-ai/different-cross-validation-types-and-how-it-works-to-overcome-overfitting-in-machine-learning-59297fca64f9?source=collection_archive---------3-----------------------#2021-02-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/ca5ebf99a4a8476288b078a0d8f8e815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcNteUb8CsbGWe8EqmoIRA.png"/></div></div></figure><p id="0ad2" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">不同的交叉验证类型及其如何克服机器学习中的过拟合</em></p><p id="9622" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">在这篇博客中，我试图探索不同类型的交叉验证方法。</em></p><p id="2f0a" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated">在机器学习中，我们将数据分为训练和测试，我们根据训练数据建立模型，并使用测试数据检查准确性。存在<strong class="ht iq"> <em class="ip">模型欠拟合或</em> </strong>过拟合的情况。我们可以克服<strong class="ht iq"> <em class="ip">过拟合</em> </strong>的问题，聪明的办法无非是<strong class="ht iq"> <em class="ip">交叉验证</em>。</strong>交叉验证是防止过度拟合的最佳预防措施。这是一种聪明的技术，让我们能够更好地利用我们的数据。</p><p id="ee5e" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated">交叉验证有<strong class="ht iq">不同的类型</strong>或变体，但总体程序保持不变。</p><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es ir"><img src="../Images/6ccac60bf94e97fb69fa23cc277650e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*CisG47jCvt_6nU7kIpWRlg.png"/></div></figure><p id="7911" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip">以下是一些常用的交叉验证类型。下面给出这些方法:</em> </strong></p><ol class=""><li id="f0f8" class="iw ix hs ht b hu hv hy hz ic iy ig iz ik ja io jb jc jd je bi translated"><strong class="ht iq"> <em class="ip">【留一出来交叉验证(LOOCV) </em> </strong></li></ol><p id="270c" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated">这里每一个<strong class="ht iq"> <em class="ip">单个记录作为试验</em> </strong>留一行</p><p id="a475" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip">例如</em> </strong>我们有100条记录:</p><p id="d273" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated">(此处将第一个记录作为测试，其余记录作为第一次迭代中的训练，然后在第二次实验中进行第二次迭代，依此类推……)</p><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jf"><img src="../Images/71f1830c001aca5eb06af7e79f656320.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*0K2hg4UNL3RfRtmv5SZhAQ.png"/></div></figure><p id="ae4c" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip">优点&amp;缺点:</em> </strong></p><p id="35b1" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">此过程中偏差最小</em></p><p id="0535" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">由于每个数据都作为测试数据处理，因此执行时间较长</em></p><p id="ee72" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">导致测试数据的高度变化</em></p><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jg"><img src="../Images/fbdbcce2ea80f55846bdb689d128635f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*x3g2jwzM90uaOi8C3nhkJQ.png"/></div></figure><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jh"><img src="../Images/27d29cff36d1cdcee106ca40f8982142.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*yFA0dpl9UFSK5VWLeArK3g.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx"><strong class="bd jm"><em class="jn">(Here every record is taken as test in Sequence)</em></strong></figcaption></figure><p id="f4e0" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip"> 2) K倍交叉验证</em> </strong></p><p id="118c" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated">将输入数据集分成大小相等的样本组。这些样本被称为褶皱。<strong class="ht iq">K值决定折叠次数</strong>。假设K=3，它将被分成3份。每次一组数据被当作测试数据。</p><p id="dcf8" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip">例如</em> </strong> <em class="ip">有</em> <strong class="ht iq"> <em class="ip"> 900条记录，K= 3 </em> </strong> <em class="ip">数据被分成3块各为一个</em><strong class="ht iq"><em class="ip">900/3 = 300</em></strong><em class="ip">各为300。每次每组都被当作测试数据。</em></p><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jo"><img src="../Images/c3e10d4e39104287566480a689d8d8ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*-AsqBULLzGOeikaO-tDH9Q.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx"><strong class="bd jm"><em class="jn">Each fold will give us a value that and We can take the Mean of the experiments to predict the accuracy of the model</em></strong></figcaption></figure><p id="8d1d" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"><em class="ip">Kfold如何工作</em> </strong></p><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jp"><img src="../Images/a54c9b6d825f41ee4391c68e481befe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*V8uugqCgNOc-f9Qm_JpPXg.png"/></div></figure><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jq"><img src="../Images/279e2e5687583e086d0b2437f8fc7f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*WcxmPGV4_1_RSgxMF6kWhw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx"><strong class="bd jm"><em class="jn">(Here if you note the index’s of train index and test index divide into 3 folds every Data is taken in sequence as test</em></strong></figcaption></figure><p id="d7bf" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip">缺点:</em> </strong></p><p id="c02e" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">如果它的二进制澄清问题，那么它将不会给出模型的良好精度。例如，我们将数据集分为男性&amp;女性，与女性相比，男性的数据可能更多，因此测试数据可能导致较大差异。</em></p><p id="d847" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip"> 3)分层k重交叉验证</em> </strong></p><p id="c409" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">它与K-Fold相同，但是数据的排列是这样的，每个Fold在数据中有大量的变化。处理偏差和方差，这是最好的方法之一。</em></p><p id="78ea" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip">如</em> </strong> <em class="ip">如果我们有一个雌雄的分类问题，每一个褶皱都会这样划分，它有一个</em> <strong class="ht iq"> <em class="ip">好的雌雄比例</em></strong><em class="ip"/></p><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jr"><img src="../Images/e5b42c8ed538553f705bfb6e86835302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BrMk2-sH_IkNXEELSGScoQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Data Divided into Folds that has a good ration of Male and Female</figcaption></figure><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es js"><img src="../Images/1160b1943e22b9cadfee0b0edf962817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*LvUM9KxBgr1bh_vvTlSxzw.png"/></div></figure><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jt"><img src="../Images/eb9ad746f820c2f0a10c6688080fae6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*Oj5u4zOiP4PmLseOfJylHA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx"><strong class="bd jm">(Here we have k=5 so its divided into 5 and the index for Training and Testing are not in sequence as in Kfold Here data is divided into folders and data are taken randomly)</strong></figcaption></figure><p id="f15d" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><strong class="ht iq"> <em class="ip"> 4)时间序列数据的交叉验证</em> </strong></p><p id="b55a" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">交叉验证</em> <strong class="ht iq"> <em class="ip">时间序列模型是滚动交叉验证。</em> </strong> <em class="ip">当您处理</em> <strong class="ht iq"> <em class="ip">与时间或日期相关的数据</em> </strong> <em class="ip">时，这很有帮助，因为其结果会成为对即将到来的未来数据进行预测的训练。例如，股票的预测取决于前一天的结果。</em></p><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es ju"><img src="../Images/23c2d8c29786b1545260ce7731165acb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*17iTNiVJspWOTEVDR5JkSQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx"><strong class="bd jm"><em class="jn">Here the outcome of particular day becomes the input for the prediction of next day.</em></strong></figcaption></figure><p id="7788" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated"><em class="ip">此处，之前的</em> <strong class="ht iq"> <em class="ip"> 5天成为第6天</em> </strong> <em class="ip">的结果，同样，对于第7天的</em> <strong class="ht iq"> <em class="ip">我们考虑之前的5天，即第2天到第6天，其中第6天成为第7天</em> </strong>的可预测结果的输入</p><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jv"><img src="../Images/bf6235f7424a6f7fed9f67d2e776e0dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*rCyrQ9ouBNlbwRZgfwKSaw.png"/></div></figure><figure class="is it iu iv fd hj er es paragraph-image"><div class="er es jw"><img src="../Images/6e191ad566257d04ad1e2a77b55c3436.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*wKs8BQj1Xpr2xNRnhBFWhw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx"><strong class="bd jm">(Here you see the index value validation becomes the input for the train data for the upcoming output)</strong></figcaption></figure><p id="663f" class="pw-post-body-paragraph hq hr hs ht b hu hv hw hx hy hz ia ib ic id ie if ig ih ii ij ik il im in io ha bi translated">希望它能帮助你理解各种交叉验证是如何工作的，并有助于打破过度拟合。你可以访问我的博客来了解过度和不足<a class="ae jx" rel="noopener" href="/analytics-vidhya/how-bias-and-variance-help-to-classify-underfitting-and-overfitting-of-model-1f2a0237c131">点击这里</a></p></div></div>    
</body>
</html>