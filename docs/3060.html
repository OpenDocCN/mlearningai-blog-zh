<html>
<head>
<title>Softmax Temperature</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Softmax温度</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/softmax-temperature-5492e4007f71?source=collection_archive---------0-----------------------#2022-07-15">https://medium.com/mlearning-ai/softmax-temperature-5492e4007f71?source=collection_archive---------0-----------------------#2022-07-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a984" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">温度</strong>是LSTMs(以及一般的神经网络)的超参数，用于在应用softmax之前通过缩放逻辑来控制预测的随机性。温度缩放已被广泛用于提高利用Softmax决策层的NLP任务的性能。</p><p id="1c37" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了解释它的效用，我们将考虑自然语言生成的情况，其中我们需要通过从语言模型中抽取新的序列来生成文本(使用seq-to-seq架构的解码器部分)。在解码阶段的每个时间步，我们需要预测一个令牌，这是通过使用一种采样技术从softmax分布(在词汇表上)中采样来完成的。简而言之，一旦获得logits，预测的质量和多样性由softmax分布和应用于其上的采样技术控制。这篇文章是关于调整softmax分布来控制预测的多样性和新颖性。后者将在以后的文章中讨论。</p><p id="d72c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图1是如何在解码阶段的中间时间步长之一进行预测的快照。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/e3ce874f3a5ee45c37ee693d93f1faa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J8gIAZofl6MlfLUK.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig 1: Logits transformation by Softmax</figcaption></figure><p id="7b63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">但是这里的问题是什么？</strong></p><p id="b68a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">生成的序列将具有可预测的通用结构。原因是softmax分布中的<strong class="ig hi">熵</strong>或<strong class="ig hi">随机性</strong>，在某种意义上，特定单词(对应于上面示例中的索引9)被选中的可能性远远高于其他单词。只要目标是得到真实的序列，一个可预测的序列是没有问题的。但是如果目标是生成一个从未见过的新文本或图像，随机性就是圣杯。</p><p id="d7e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">解决方法？</strong></p><p id="5789" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">增加随机性</strong>。这正是温度标度的作用。它表征了用于采样的概率分布的熵，换句话说，它控制了下一个词将有多令人惊讶或可预测。通过将logit向量除以值T(表示温度)来进行缩放，然后应用softmax。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es js"><img src="../Images/4d01842b1cf50e087ada8213a81c0603.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/0*9XTJp_YNolXuBnFG.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig 2: Temperature Scaling</figcaption></figure><p id="8d18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这种缩放的效果可以在图3中看到:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jt"><img src="../Images/92fa11e7e3503e78af89e509cd1b8d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7xj72SjtNHvCMQlV.jpeg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ju"><img src="../Images/46adf87fe7b11e3de9354a5d57274bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*p1iKxUJcXDlSEZCpMCwNgg.gif"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig 3: Visualizing the Effects of Temperature Scaling. Each word gets equal probability as the Temperature increases</figcaption></figure><p id="f9e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的分布接近均匀分布，使每个单词被抽样的概率相等，从而使生成的序列看起来更有创造性。太多的创造力也不好。在极端情况下，生成的文本可能毫无意义。因此，像所有其他超参数一样，这也需要调整。</p><p id="548b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结论:</strong> <br/>温度的尺度控制着产量分配的平滑度。因此，它增加了对低概率候选者的敏感性。随着T → ∞，分布变得更加均匀，从而增加了不确定性。相反，当T → 0时，分布坍缩为点质量。</p><p id="17fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如前所述，温度标度的范围不仅限于NLG。它还用于在训练和强化学习时校准深度学习模型。另一个更广泛的概念是<strong class="ig hi">知识蒸馏。</strong>以下是关于这些主题的链接，以供进一步探索。</p><p id="0a8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">参考文献:</strong></p><ol class=""><li id="7640" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated"><a class="ae ke" href="https://openreview.net/pdf?id=H1x9004YPr" rel="noopener ugc nofollow" target="_blank">语言建模中的语境温度</a></li><li id="2cda" class="jv jw hh ig b ih kf il kg ip kh it ki ix kj jb ka kb kc kd bi translated"><a class="ae ke" href="https://arxiv.org/pdf/1503.02531.pdf" rel="noopener ugc nofollow" target="_blank">提取神经网络中的知识</a></li><li id="876c" class="jv jw hh ig b ih kf il kg ip kh it ki ix kj jb ka kb kc kd bi translated"><a class="ae ke" href="https://arxiv.org/pdf/1706.04599.pdf" rel="noopener ugc nofollow" target="_blank">关于现代神经网络的校准</a></li></ol><div class="kk kl ez fb km kn"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ko ab dw"><div class="kp ab kq cl cj kr"><h2 class="bd hi fi z dy ks ea eb kt ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ku l"><h3 class="bd b fi z dy ks ea eb kt ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kv l"><p class="bd b fp z dy ks ea eb kt ed ef dx translated">medium.com</p></div></div><div class="kw l"><div class="kx l ky kz la kw lb jm kn"/></div></div></a></div></div></div>    
</body>
</html>