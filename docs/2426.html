<html>
<head>
<title>The Recommended Music That I Don’t Like Are So-Called False Positives</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我不喜欢的推荐音乐是所谓的误报</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/the-recommended-music-i-dont-like-are-so-called-false-positives-5df25a0d34a8?source=collection_archive---------8-----------------------#2022-04-30">https://medium.com/mlearning-ai/the-recommended-music-i-dont-like-are-so-called-false-positives-5df25a0d34a8?source=collection_archive---------8-----------------------#2022-04-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="2273" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">以客户为中心思考音乐推荐算法。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/3b1b8778b952523310f37c7531268e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C7BMOeNEDTvt9n_oMqgLhg.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by John Tekeridis: <a class="ae jm" href="https://www.pexels.com/photo/person-using-smartphone-340103/" rel="noopener ugc nofollow" target="_blank">https://www.pexels.com/photo/person-using-smartphone-340103/</a></figcaption></figure><h1 id="ff3d" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">介绍</h1><p id="cfb8" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">今天下午早些时候，我一边看书一边听音乐。这个应用程序开始随机“推荐”真正让我心烦的音乐。就在那一瞬间，一个看似不相关的名词浮现在我的脑海:<strong class="kh hi">假阳性</strong>。</p><p id="45c3" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">对于Apple Music，Spotify，Amazon Music等音乐平台。，他们的推荐团队必须如此努力地工作，以建立识别我的兴趣和个性化我的体验的系统。所以，我作为客户，是可以挽留的。在一首新的音乐进入队列让我听之前，它可能已经被分析并与我先前标记为喜欢的音乐进行了比较。系统相信我会喜欢这首曲子。</p><p id="0b61" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">屏幕背后的真实系统肯定比我上面描述的要复杂得多。他们可能已经完成了一些类型的无监督学习作为子模块来增强系统，例如音乐聚类、用户聚类、与歌词相关的NLP分析等等。所有这些工作完成后，在最后一步，系统必须决定我是否会喜欢这段音乐。很明显，今天下午系统做了一个错误的决定。</p><p id="6384" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">嗯，可能是我太挑剔了。作为一个客户，我真的不需要考虑原因和算法。我需要做的就是将它标记为“不感兴趣/不喜欢”，信任这些应用程序，并希望我不会再次遇到这样的事情。然而，作为一名数据科学家，我忍不住认为，我不喜欢的推荐音乐是算法产生的误报之一。为了解决这个问题，我们可能需要在分析问题时，暂时将我们的战略从以算法为中心调整为以客户为中心。</p><blockquote class="lg"><p id="fee3" class="lh li hh bd lj lk ll lm ln lo lp la dx translated">我宁愿不听让我心烦的音乐，也不愿听我可能喜欢的音乐。</p></blockquote><h1 id="caaa" class="jn jo hh bd jp jq jr js jt ju jv jw jx in lq io jz iq lr ir kb it ls iu kd ke bi translated">数据</h1><p id="4784" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">我在Kaggle上找到了一个带标签的Spotify数据集，它应该符合我们在这种情况下的需求。可以在这里找到数据:<a class="ae jm" href="https://www.kaggle.com/datasets/bricevergnou/spotify-recommendation?select=data.csv" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/datasets/bricevergnou/Spotify-推荐？select=data.csv </a>。</p><p id="0107" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">原始数据集有100首音乐被标记为喜欢，95首被标记为不喜欢。为了模拟我们的情况，我在拟合模型之前丢弃了35首不喜欢的音乐，因为不平衡的类别更有可能导致错误分类。</p><p id="ce1c" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">我只拿了15%的数据做训练，剩下的作为测试数据。可用的特征都是数字的。因为我们对每个特性的贡献不感兴趣，所以没有进行进一步的特性工程。</p><h1 id="e35d" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">建模</h1><h2 id="5d40" class="lt jo hh bd jp lu lv lw jt lx ly lz jx ko ma mb jz ks mc md kb kw me mf kd mg bi translated">基础模型</h2><p id="4d7f" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">因为我们对避免误报感兴趣，所以我选择了precision分数和f1分数作为评估指标。假阳性越小，精度得分越高。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Code by author</figcaption></figure><p id="541e" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">我首先用随机森林分类器建立了一个基本模型。对于我们的测试数据，我们发现了8个假阳性，精确度分数为0.90，f1分数为0.87。</p><h2 id="b8b4" class="lt jo hh bd jp lu lv lw jt lx ly lz jx ko ma mb jz ks mc md kb kw me mf kd mg bi translated">手动强制降低FP</h2><p id="82f4" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">如果我们使用predict_proba进行预测，而不是返回0和1，它将返回分类器给每个类的概率。我手动将阈值从0.5提高到0.9，如下所示。这就像我们告诉分类器，只有当它对自己的决定有90%的信心时，才会向我们推荐新音乐。否则，标记为0。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Code by author</figcaption></figure><p id="cd80" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">通过调整阈值，我们不再看到误报推荐。然而，假阴性推荐的数量增加到77，f1分数降低到0.19。</p><p id="c25d" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">让我们做一个网格搜索，看看阈值如何影响分数。我们每次迭代都将阈值增加0.025，并打印结果:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/b65783cb6f1c07c1b6a60900e057bcda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y_6MuLkIK2JG9KtNRjfZxA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Code by author</figcaption></figure><p id="bbfd" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">简单地提高阈值肯定会删除误报推荐。但是，它也删除了大量正确的建议。所以，让我们找到一个更“算法化”的方法来解决这个问题。</p><h2 id="34e6" class="lt jo hh bd jp lu lv lw jt lx ly lz jx ko ma mb jz ks mc md kb kw me mf kd mg bi translated">随机森林中的类权重</h2><p id="6d58" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">随机森林中的一个参数叫做class_weight。与形式为<code class="du mk ml mm mn b">{class_label: weight}</code>的类别相关的权重。如果没有给定，所有类的权重都应该是1。这个参数也接受两个模式名字符串作为输入。第一种是“平衡”模式，使用y值自动调整与输入数据中类别频率成反比的权重，如<code class="du mk ml mm mn b">n_samples / (n_classes * np.bincount(y))</code>。另一种是“平衡子样本”模式。它与“平衡”相同，只是权重是基于每棵生长的树的bootstrap样本计算的。(<a class="ae jm" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/modules/generated/sk learn . ensemble . randomforestclassifier . html</a>)</p><p id="8699" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">为了让观众更好地了解这个参数如何帮助我们，我进行了另一次网格搜索，并将结果存储到一个表中:</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Code by author</figcaption></figure><p id="fc19" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">让我们想象一下结果:</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mh mi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Code by author</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mo"><img src="../Images/ff723300ca7f0ff50f1f2b75e7187d19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q3KCcHsVPKx_6RhF7-49Ig.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by author</figcaption></figure><p id="79e8" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">根据迭代，类1的最佳权重是1.25。通过将权重调整为1.25，我们成功地删除了3个误报推荐，精确度分数增加到0.93，f1分数的下降幅度最小(-0.0075)。</p><h1 id="e4ef" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">结论</h1><p id="ff2b" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">这个项目始于这样一个问题:“如果我宁愿不听让我心烦的音乐，也不听我可能喜欢的音乐，会怎么样？”我试图用随机森林中的class_weight参数来惩罚误报推荐。随着f1分数的最小损失，我们的精确度分数有了很大的提高。对于Xgboost，它有一个类似的参数叫做“scale_pos_weight ”,这个参数应该可以解决同样的问题。</p><p id="df5e" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">另一个涉及此问题的例子是垃圾邮件识别。每一个误报分类都意味着一封重要的电子邮件有可能在没有通知的情况下被删除。</p><p id="532f" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">通过这个项目，我真正想提出的想法是，我们机器学习模型的最佳得分可能不会导致生产中的最佳用户体验。我们每天都在努力打造我们相信能为客户带来最佳UX的车型。然而，不管算法有多先进，人类都应该拥有选择权。我真的希望有一天在我的应用程序中看到一个按钮，让我惩罚FP，这样得到一首愚蠢歌曲的可能性将被推至无穷大。对于那些喜欢听新音乐的人来说，情况正好相反。惩罚新生力量应该是他们的选择。</p><p id="3db0" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated"><strong class="kh hi"> <em class="mp">请随时与我联系</em></strong><a class="ae jm" href="https://www.linkedin.com/in/jinhangjiang/" rel="noopener ugc nofollow" target="_blank"><strong class="kh hi"><em class="mp">LinkedIn</em></strong></a><strong class="kh hi"><em class="mp">。</em>T13】</strong></p><h1 id="bc1e" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">参考</h1><p id="d76b" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">韦尔努，b。Spotify推荐。<a class="ae jm" href="https://www.kaggle.com/datasets/bricevergnou/spotify-recommendation?select=data.csv" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/datasets/bricevergnou/Spotify-推荐？select=data.csv </a>。</p><p id="8ecc" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated"><strong class="kh hi">佩德拉戈萨<em class="mp">等人</em> </strong> <em class="mp"> (2011)。</em> JMLR 12号，第2825–2830页。<a class="ae jm" href="http://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html" rel="noopener ugc nofollow" target="_blank">sci kit-learn:Python中的机器学习</a>。</p><div class="mq mr ez fb ms mt"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mu ab dw"><div class="mv ab mw cl cj mx"><h2 class="bd hi fi z dy my ea eb mz ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="na l"><h3 class="bd b fi z dy my ea eb mz ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nb l"><p class="bd b fp z dy my ea eb mz ed ef dx translated">medium.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh jg mt"/></div></div></a></div></div></div>    
</body>
</html>