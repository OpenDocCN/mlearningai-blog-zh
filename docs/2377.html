<html>
<head>
<title>Azure Synapse Analytics using Synapse ML batch processing Health Care Text analytics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure Synapse Analytics使用Synapse ML批量处理医疗保健文本分析</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/azure-synapse-analytics-using-synapse-ml-batch-processing-health-care-text-analytics-2f2444e4d586?source=collection_archive---------4-----------------------#2022-04-23">https://medium.com/mlearning-ai/azure-synapse-analytics-using-synapse-ml-batch-processing-health-care-text-analytics-2f2444e4d586?source=collection_archive---------4-----------------------#2022-04-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="ff3d" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">使用SynapseML的Azure Healthcare文本分析api</h1><h1 id="b489" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">先决条件</h1><ul class=""><li id="7827" class="jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">document—<a class="ae ju" href="https://microsoft.github.io/SynapseML/docs/next/features/cognitive_services/CognitiveServices%20-%20Overview/#text-analytics-for-health-sample" rel="noopener ugc nofollow" target="_blank">https://Microsoft . github . io/SynapseML/docs/next/features/cognitive _ services/cognitive services % 20-% 20 overview/# text-analytics-for-health-sample</a></li><li id="5a0b" class="jc jd hh je b jf jv jh jw jj jx jl jy jn jz jp jq jr js jt bi translated">创建Azure认知服务帐户</li><li id="9654" class="jc jd hh je b jf jv jh jw jj jx jl jy jn jz jp jq jr js jt bi translated">创建Azure存储帐户</li><li id="8e53" class="jc jd hh je b jf jv jh jw jj jx jl jy jn jz jp jq jr js jt bi translated">创建Azure synapse分析工作区</li><li id="bc32" class="jc jd hh je b jf jv jh jw jj jx jl jy jn jz jp jq jr js jt bi translated">创建spark计算集群</li><li id="fa32" class="jc jd hh je b jf jv jh jw jj jx jl jy jn jz jp jq jr js jt bi translated">使用pyspark</li></ul><h1 id="eb6c" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">步伐</h1><ul class=""><li id="992d" class="jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">安装synapseml</li></ul><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="13ea" class="kj if hh kf b fi kk kl l km kn">%%configure -f<br/>{<br/>"name": "synapseml",<br/>"conf": {<br/>"spark.jars.packages": "com.microsoft.azure:synapseml_2.12:0.9.5-13-d1b51517-SNAPSHOT",<br/>"spark.jars.repositories": "https://mmlspark.azureedge.net/maven",<br/>"spark.jars.excludes": "org.scala-lang:scala-reflect,org.apache.spark:spark-tags_2.12,org.scalactic:scalactic_2.12,org.scalatest:scalatest_2.12",<br/>"spark.yarn.user.classpath.first": "true"<br/>}<br/>}</span></pre><ul class=""><li id="552d" class="jc jd hh je b jf ko jh kp jj kq jl kr jn ks jp jq jr js jt bi translated">导入认知服务</li></ul><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="a1b8" class="kj if hh kf b fi kk kl l km kn">from synapse.ml.cognitive import *</span></pre><ul class=""><li id="b430" class="jc jd hh je b jf ko jh kp jj kq jl kr jn ks jp jq jr js jt bi translated">现在带来认知服务的keyvault秘密和sql密码</li></ul><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="0746" class="kj if hh kf b fi kk kl l km kn">key = TokenLibrary.getSecret("vaultname", "secretname", "valutlinked")<br/>password = TokenLibrary.getSecret("vaultname", "secretname", "valutlinked")</span></pre><ul class=""><li id="0dd1" class="jc jd hh je b jf ko jh kp jj kq jl kr jn ks jp jq jr js jt bi translated">配置JDBC</li></ul><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="2f47" class="kj if hh kf b fi kk kl l km kn">jdbcHostname = "sqlserver.database.windows.net"<br/>jdbcDatabase = "dbname"<br/>jdbcPort = 1433<br/>jdbcUrl = "jdbc:sqlserver://{0}:{1};database={2}".format(jdbcHostname, jdbcPort, jdbcDatabase)<br/>connectionProperties = {<br/>"user" : "sqladmin",<br/>"password" : password,<br/>"driver" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"<br/>}</span></pre><ul class=""><li id="ef3a" class="jc jd hh je b jf ko jh kp jj kq jl kr jn ks jp jq jr js jt bi translated">读取azure sql数据</li></ul><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="edb1" class="kj if hh kf b fi kk kl l km kn">Spdf = spark.read.jdbc(url=jdbcUrl, table="dbo.precribdata", properties=connectionProperties).limit(100)<br/>display(Spdf)</span></pre><ul class=""><li id="33c7" class="jc jd hh je b jf ko jh kp jj kq jl kr jn ks jp jq jr js jt bi translated">现在连接到医疗保健api</li></ul><pre class="ka kb kc kd fd ke kf kg kh aw ki bi"><span id="0869" class="kj if hh kf b fi kk kl l km kn">healthcare = (HealthcareSDK()<br/>    .setSubscriptionKey(key)<br/>    .setLocation("centralus")<br/>    .setLanguage("en")<br/>    .setOutputCol("response"))</span><span id="0c30" class="kj if hh kf b fi kt kl l km kn">display(healthcare.transform(df))</span></pre><figure class="ka kb kc kd fd kv er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ku"><img src="../Images/90e360883d0e79228534335497a20a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PzN1KLD6GvRs2u9G.jpg"/></div></div></figure></div><div class="ab cl lc ld go le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ha hb hc hd he"><p id="02ab" class="pw-post-body-paragraph lj lk hh je b jf ko ll lm jh kp ln lo jj lp lq lr jl ls lt lu jn lv lw lx jp ha bi translated"><em class="ly">最初发表于</em><a class="ae ju" href="https://github.com/balakreshnan/Samples2022/blob/main/SynapseIntegrate/synapsemlhealth.md" rel="noopener ugc nofollow" target="_blank">T5【https://github.com】</a><em class="ly">。</em></p><div class="lz ma ez fb mb mc"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="md ab dw"><div class="me ab mf cl cj mg"><h2 class="bd hi fi z dy mh ea eb mi ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mj l"><h3 class="bd b fi z dy mh ea eb mi ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mk l"><p class="bd b fp z dy mh ea eb mi ed ef dx translated">medium.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq la mc"/></div></div></a></div></div></div>    
</body>
</html>