<html>
<head>
<title>Feature Engineering using custom Keras Layers for a complete training and inference pipeline.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用定制Keras层的特征工程，用于完整的训练和推理管道。</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/feature-engineering-using-custom-keras-layers-part-2-aead2b89ee06?source=collection_archive---------3-----------------------#2022-03-15">https://medium.com/mlearning-ai/feature-engineering-using-custom-keras-layers-part-2-aead2b89ee06?source=collection_archive---------3-----------------------#2022-03-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/06142d5ad2ae1d9759cd3200bd6f2309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8kAvwH89NumNaTd1kzo36w.png"/></div></div></figure><p id="0539" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在之前的<a class="ae jn" rel="noopener" href="/mlearning-ai/feature-engineering-using-keras-lambda-layers-ae0c6d3c904f">帖子</a>中，我们看了Keras Lambda图层的特征工程应用。我们还提到Lambda层有一些序列化限制。在本帖中，我们将看到如何通过子类化Keras层接口来克服这些问题，并创建自定义层来实现特征工程。</p><p id="cce2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">快速回顾一下之前的帖子:</p><p id="3aa2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们使用Keras/Tensorflow在本地实现了一个训练和推理管道。从用tf.data加载数据。我们利用Lambda层进行特征工程。我们最终有了一个训练管道，其中特征工程是网络架构的一部分，并且可以作为独立的推理被持久化和加载。从设计和服务的角度来看，如果例如使用Tensorflow服务于模型，这有一些好处。在将数据提供给服务端点之前，不需要使用不同的库来设计数据。</p><p id="ed55" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将遵循的步骤:</p><ul class=""><li id="4141" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">用tf.data加载数据</li><li id="a0b7" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">创建输入层</li><li id="97dc" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">子类Keras图层类</li><li id="d0fa" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">火车模型</li></ul><p id="17af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将再次使用心脏病数据集。让我们导入张量流并读入数据:</p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="e958" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为每个要素创建一个输入对象字典:</p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="6d2e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将研究两种创建要素图层的方法。场景1为不同的功能使用多个自定义Keras层，场景2仅使用一个层。</p><h2 id="e9bd" class="ki kj hh bd kk kl km kn ko kp kq kr ks ja kt ku kv je kw kx ky ji kz la lb lc bi translated">场景1:多个自定义层</h2><p id="d2f9" class="pw-post-body-paragraph ip iq hh ir b is ld iu iv iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm ha bi translated">在这里，我们将为不同的要素创建单独的自定义图层，最后一步，我们将连接我们的图层以创建一个完整的要素图层。</p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="0920" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们使用自定义图层来构建我们的图表。</p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="179e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，我们将创建一个Keras模型来帮助可视化我们的网络图。这将说明一切是如何一起流动的，并展示层的依赖性。</p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="01c7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这将生成下图:</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es li"><img src="../Images/4cef5dd8cd46a66621021cbdca85d93f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdsUtHLL40rYd18YtPitxA.png"/></div></div></figure><p id="7529" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">场景1包含一些步骤，但最终会有一个信息丰富的图表，显示所有输入如何进入网络以及如何创建要素。在下一节中，我们将使用一个单独的自定义层来创建与上面相同的功能。但是，我们将无法绘制与下图相同的图表，因为要素图层将包含在一个图表中。</p><h2 id="8a77" class="ki kj hh bd kk kl km kn ko kp kq kr ks ja kt ku kv je kw kx ky ji kz la lb lc bi translated">场景2:单个自定义层</h2><p id="e6c5" class="pw-post-body-paragraph ip iq hh ir b is ld iu iv iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm ha bi translated">在本节中，我们将实现一个更简单的要素层。</p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="156f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果我们只使用一层，这就是我们所需要的。让我们编译并构建我们的模型:</p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="0302" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">总之，我们展示了两种实现特征工程定制层的方法。场景1使用了多个层，涉及更多的实现步骤，但也产生了一个显示特性流的信息图。场景2更快，实施步骤更少。</p><div class="lj lk ez fb ll lm"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ln ab dw"><div class="lo ab lp cl cj lq"><h2 class="bd hi fi z dy lr ea eb ls ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lt l"><h3 class="bd b fi z dy lr ea eb ls ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lu l"><p class="bd b fp z dy lr ea eb ls ed ef dx translated">medium.com</p></div></div><div class="lv l"><div class="lw l lx ly lz lv ma in lm"/></div></div></a></div></div></div>    
</body>
</html>