<html>
<head>
<title>Deploy a local trained machine learning model on AWS using SAM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SAM在AWS上部署本地训练的机器学习模型</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/deploy-a-local-trained-machine-learning-model-on-aws-using-sam-cbb065067692?source=collection_archive---------4-----------------------#2022-06-09">https://medium.com/mlearning-ai/deploy-a-local-trained-machine-learning-model-on-aws-using-sam-cbb065067692?source=collection_archive---------4-----------------------#2022-06-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/888a0ed6f1d690d3e5a9512f484ae7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MPmQESGXxT_AJ-KOnS-46g.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Center_of_the_Milky_Way_Galaxy</figcaption></figure></div><div class="ab cl it iu go iv" role="separator"><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy"/></div><div class="ha hb hc hd he"><h2 id="b9b1" class="ja jb hh bd jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx bi translated">介绍</h2><blockquote class="jy jz ka"><p id="18dc" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ha bi translated">部署机器学习模型可能会令人头疼。它可能花费与构建、开发、培训和评估同样多的时间，甚至更多的时间和精力。我没有找到很多关于这个话题的博客，特别是关于SAM的，但是不用担心！在这篇博客中，我将总结我在修复依赖项、配置和策略错误近一周后的部署经验。我还将对用于部署您的机器学习模型并将其dockerize的最佳实践提出一些建议，所以让我们开始吧。</p></blockquote></div><div class="ab cl it iu go iv" role="separator"><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy"/></div><div class="ha hb hc hd he"><h2 id="471c" class="ja jb hh bd jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx bi translated">为什么是萨姆？</h2><p id="1ded" class="pw-post-body-paragraph kb kc hh ke b kf la kh ki kj lb kl km jl lc kp kq jp ld kt ku jt le kx ky kz ha bi translated">AWS无服务器应用程序模型(SAM)使机器学习模型的部署比以往任何时候都更容易。它从创建(s3桶，ecr，lamda函数，..等等)以及更多简单的命令(可以自动化)。让您的应用程序可以使用端到端的公共API。下面的图1显示了无服务器架构的优势。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lf"><img src="../Images/44894f548209768d3c965993a2a938f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Znh_Tyo0pmRBHP3ffUcGDg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 1</figcaption></figure><p id="1da2" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">你可以在它的文档中找到更多关于SAM的信息<a class="ae lk" href="https://aws.amazon.com/serverless/sam/" rel="noopener ugc nofollow" target="_blank">这里</a></p></div><div class="ab cl it iu go iv" role="separator"><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy"/></div><div class="ha hb hc hd he"><h1 id="4c04" class="ll jb hh bd jc lm ln lo jg lp lq lr jk ls lt lu jo lv lw lx js ly lz ma jw mb bi translated">先决条件</h1><p id="ed78" class="pw-post-body-paragraph kb kc hh ke b kf la kh ki kj lb kl km jl lc kp kq jp ld kt ku jt le kx ky kz ha bi translated">您应该在PC上安装以下软件，以便能够使用SAM进行部署:</p><ul class=""><li id="ac19" class="mc md hh ke b kf kg kj kk jl me jp mf jt mg kz mh mi mj mk bi translated">Python(推荐版本&gt; 3.7)</li><li id="3602" class="mc md hh ke b kf ml kj mm jl mn jp mo jt mp kz mh mi mj mk bi translated">Docker(推荐版本20.10.12)</li><li id="c277" class="mc md hh ke b kf ml kj mm jl mn jp mo jt mp kz mh mi mj mk bi translated">AWS CLI(推荐版本2.7.4)你可以从<a class="ae lk" href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html" rel="noopener ugc nofollow" target="_blank">这里</a>安装</li><li id="2c23" class="mc md hh ke b kf ml kj mm jl mn jp mo jt mp kz mh mi mj mk bi translated">SAM(推荐版本1.33.0)你可以从<a class="ae lk" href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/serverless-sam-cli-install.html" rel="noopener ugc nofollow" target="_blank">这里</a>安装</li></ul></div><div class="ab cl it iu go iv" role="separator"><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy"/></div><div class="ha hb hc hd he"><h1 id="6967" class="ll jb hh bd jc lm ln lo jg lp lq lr jk ls lt lu jo lv lw lx js ly lz ma jw mb bi translated">步伐</h1><p id="77a1" class="pw-post-body-paragraph kb kc hh ke b kf la kh ki kj lb kl km jl lc kp kq jp ld kt ku jt le kx ky kz ha bi translated">我们将从一个SAM模板开始，并用我们的模型和推理功能的逻辑对其进行编辑..安装SAM后</p><h1 id="f112" class="ll jb hh bd jc lm mq lo jg lp mr lr jk ls ms lu jo lv mt lx js ly mu ma jw mb bi translated"><strong class="ak">-初始化一个SAM项目</strong></h1><p id="2239" class="pw-post-body-paragraph kb kc hh ke b kf la kh ki kj lb kl km jl lc kp kq jp ld kt ku jt le kx ky kz ha bi translated">(附在下面的图2中的所有这些设置)</p><p id="de28" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">1-终端中的类型<strong class="ke hi"> sam init </strong></p><p id="87e1" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">2-选择<strong class="ke hi"> 1 </strong> (AWS快速入门模板)</p><p id="be8c" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">3-选择<strong class="ke hi"> 2 </strong>(图像选项更好，因为我们的docker图像大小限制为10g，Zip选项只有250兆)</p><p id="a877" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">4-选择<strong class="ke hi">5</strong>(Amazon/python 3.8-base)或最适合你的ML模型的python版本</p><p id="768f" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">5-键入您的应用名称，例如:<strong class="ke hi"> model-x-deploy </strong></p><p id="f971" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">6-选择<strong class="ke hi"> 2 </strong> (PyTorch机器学习示例)-不要担心，我们将在下一步编辑我们的需求文件-</p><p id="f872" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">您将找到一个包含模板文件的生成文件夹和一个README.md，其中包含部署应用程序的后续步骤的详细信息。<strong class="ke hi">(注意:根据SAM版本的不同，这些设置的名称、编号和顺序可能会有所不同，但最终结果应该是相同的)</strong></p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mv"><img src="../Images/a3b71ed565928bec99e57f6e306440b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJUkIyV-IxCXy-BZpXwTBw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Figure 2</figcaption></figure><h1 id="26ea" class="ll jb hh bd jc lm mq lo jg lp mr lr jk ls ms lu jo lv mt lx js ly mu ma jw mb bi translated">-构建SAM项目</h1><p id="fbe7" class="pw-post-body-paragraph kb kc hh ke b kf la kh ki kj lb kl km jl lc kp kq jp ld kt ku jt le kx ky kz ha bi translated">为了构建我们的本地映像，我们首先需要用我们的依赖项和推理函数的逻辑来编辑这个模板。</p><p id="4d4a" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">1-打开docker文件，你会在<em class="kd"> app </em>文件夹中找到它，应该是下面这样</p><pre class="lg lh li lj fd mw mx my mz aw na bi"><span id="e2a5" class="ja jb hh mx b fi nb nc l nd ne">FROM public.ecr.aws/lambda/python:3.8<br/><br/>COPY app.py requirements.txt ./<br/>COPY model /opt/ml/model<br/><br/>RUN python3.8 -m pip install -r requirements.txt -t .<br/><br/>CMD ["app.lambda_handler"]</span></pre><p id="1e3f" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">这里，我们从ecr.aws lamda注册表中提取所需的python版本映像，以便调用该映像中的lamda处理程序。然后，我们复制我们的app.py，它具有app.py中lamda_handler函数的推理逻辑。我们还复制我们的模型(您应该将模型物理地放在名为model的app文件夹中)。我们将这个模型文件夹检查点中的内容复制到我们的相对路径“opt/ml/model”中，稍后我们将使用这个相对路径作为代码中的硬编码路径。然后，我们在requirements.txt文件中安装所有需要的依赖项。</p><p id="e988" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">关于最佳实践，我在这里发现了一个重要的词，你不应该直接从文本文件中获取需求，而是直接将它们一行一行地放入dockerfile文件中。这样，您将尽可能多地使用缓存，因为每次您在. txt文件中添加新的依赖项时，所有其他包的缓存都将丢失，您必须从头开始下载它们，这与您只在docker文件中添加新的包pip install不同。另一个提示是，您应该在大的包中增加-default-time out = 200，以免由于超时错误而导致大量失败。一个好的实践是为每个包都有一个特定的版本，以便在未来的版本中不会面临任何依赖问题。不要忘记使用COPY命令在映像中添加任何本地包或其他源代码或任何依赖项。您还需要确保添加最后一行来制作应用程序。调用处理程序。</p><p id="45b6" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">对于app.py，您应该将您的逻辑放在<em class="kd"> lamda_handler </em>函数中，并确保像这样将模型作为全局变量加载</p><p id="3208" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated"><code class="du nf ng nh mx b">model_file = ‘/opt/ml/model’<br/>model = torch.jit.load(model_file) # pytorch example</code></p><p id="6e27" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">对于数据，您应该有这个带有事件变量的函数，它被传递给<code class="du nf ng nh mx b"> lamda_handler</code>(事件，上下文)。如下图所示</p><pre class="lg lh li lj fd mw mx my mz aw na bi"><span id="4704" class="ja jb hh mx b fi nb nc l nd ne">def parse_event(event):<br/>    if 'body' in event.keys():<br/>        return json.loads(event['body'])['data']<br/>    else:<br/>        return event['data']</span></pre><p id="cd6e" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">看看<code class="du nf ng nh mx b">template.yaml </code>文件，你可以编辑你喜欢的路径和其他参数，就像我下面做的编辑一样。但是通常你不需要编辑那么多。</p><pre class="lg lh li lj fd mw mx my mz aw na bi"><span id="7aa6" class="ja jb hh mx b fi nb nc l nd ne"><em class="kd"><br/>  </em>Properties:<br/>    Path: /model_x_inference<br/>    Method: post</span></pre><p id="e5ad" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">2-使用命令<strong class="ke hi">sudo Sam build-debug</strong>构建你的映像</p><p id="6166" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">3-在本地运行<strong class="ke hi">sudo Sam local start-API—debug</strong>来测试您的映像。通过在另一个终端中运行以下curl命令来测试它</p><pre class="lg lh li lj fd mw mx my mz aw na bi"><span id="d6fb" class="ja jb hh mx b fi nb nc l nd ne">curl --request POST \<br/>  --url http://127.0.0.1:3000/model_x_inference/ \<br/>  --header 'content-type: application/json' \<br/>  --data '{<br/>  "data": {<br/>    "data_key": "data_value"<br/>  }<br/>}'</span></pre><h1 id="462b" class="ll jb hh bd jc lm mq lo jg lp mr lr jk ls ms lu jo lv mt lx js ly mu ma jw mb bi translated">-部署SAM项目</h1><p id="ed52" class="pw-post-body-paragraph kb kc hh ke b kf la kh ki kj lb kl km jl lc kp kq jp ld kt ku jt le kx ky kz ha bi translated">要将本地映像部署到AWS，请使用以下命令</p><p id="a052" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated"><strong class="ke hi"> sudo sam部署—调试—引导</strong></p><p id="b6bf" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">然后按照终端指示进行操作。</p></div><div class="ab cl it iu go iv" role="separator"><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy"/></div><div class="ha hb hc hd he"><p id="c316" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated"><strong class="ke hi">您可能会遇到的错误以及解决方法将在本节中列出</strong></p><p id="ac80" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">1)“没有基本身份验证凭据”错误</p><p id="90d7" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">这是我花时间和精力试图解决的最难的错误:该错误意味着AWS CLI无法找到您的访问键环境变量来使用您的凭证部署您的本地映像。</p><p id="3d6b" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated"><strong class="ke hi">基本解决方案</strong>使用<strong class="ke hi"> aws configure </strong>命令你会看到类似这样的东西:</p><p id="3f0a" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">AWS访问密钥ID [****************xxxx]:</p><p id="e22b" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">AWS秘密访问密钥[****************xxxx]:</p><p id="0c64" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">你应该在这里输入你的密钥，你可以使用这个<a class="ae lk" href="https://docs.aws.amazon.com/powershell/latest/userguide/pstools-appendix-sign-up.html" rel="noopener ugc nofollow" target="_blank">链接</a>来生成它们</p><p id="f4cc" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">第一个解决方案链接是<a class="ae lk" href="https://stackoverflow.com/questions/34689445/cant-push-image-to-amazon-ecr-fails-with-no-basic-auth-credentials" rel="noopener ugc nofollow" target="_blank">这里是</a></p><p id="38bb" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">如果您尝试了这些解决方案，但仍然得到相同的错误，该怎么办？(和我一样)…别担心，我有另一个解决方案给你:)</p><p id="d820" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">您可能知道，当运行任何使用Docker的命令或试图运行任何本地映像时，它将需要sudo访问。如果您尝试使用sam进行构建，而不在命令中包含sudo，则可能会失败。因此，当使用sudo时，您现在访问的是root用户的环境变量，正如您可能猜到的那样，这些变量没有您刚刚添加的凭证。</p><p id="1d6f" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">因此，第二个解决方案是运行<strong class="ke hi"> sudo aws configure </strong>，您将会看到凭证和区域尚未设置，这样就可以修复第一个错误了。</p><p id="05ec" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">2)“授权令牌已过期”</p><p id="19dd" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">当您在部署时尝试使用docker存储库而不是sam推送您的映像并将映像url发送到sam时，会发生这种情况，因为出于安全原因，docker凭据仅在12小时后过期。解决方案在<a class="ae lk" href="https://stackoverflow.com/questions/41379808/authorization-token-has-expired-issue-aws-cli-on-macos-sierra" rel="noopener ugc nofollow" target="_blank">这里</a>有。</p><p id="0717" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">3)“登录AWS帐户时出现大量权限错误”</p><p id="7d12" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">我也很纠结这个问题，以为问题出在我的SAM或CLI版本或任何其他依赖项上，结果发现这只是我们ML策略组的另一个权限，这需要与软件负责人或Devops团队领导讨论很多，才能从他们的超级用户根帐户获得这个权限。在这里，我列出了所有策略，甚至内联编写的策略，通过这些设置和策略，我能够成功部署这些策略。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ni"><img src="../Images/f1de78e6e2ca51537c15b4be9fdbc942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O7lzHszuQaJdcvy_WGQMzw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">figure2 the list of policies</figcaption></figure><p id="b3b5" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">对于ML内联策略，这里是它的JSON<a class="ae lk" href="https://stackoverflow.com/questions/65137639/lambda-does-not-have-permission-to-access-the-ecr-image" rel="noopener ugc nofollow" target="_blank">ref链接</a></p><pre class="lg lh li lj fd mw mx my mz aw na bi"><span id="47fe" class="ja jb hh mx b fi nb nc l nd ne">{<br/> "Version": "2012–10–17",<br/> "Statement": [<br/> {<br/> "Sid": "VisualEditor0",<br/> "Effect": "Allow",<br/> "Action": [<br/> "ecr:SetRepositoryPolicy",<br/> "ecr:GetDownloadUrlForLayer",<br/> "ecr:BatchGetImage",<br/> "ecr:CompleteLayerUpload",<br/> "ecr:DescribeImages",<br/> "ecr:DescribeRepositories",<br/> "ecr:UploadLayerPart",<br/> "ecr:ListImages",<br/> "ecr:InitiateLayerUpload",<br/> "ecr:BatchCheckLayerAvailability",<br/> "ecr:GetRepositoryPolicy",<br/> "ecr:PutImage"<br/> ],<br/> "Resource": "*"<br/> },<br/> {<br/> "Sid": "VisualEditor1",<br/> "Effect": "Allow",<br/> "Action": "ecr:GetAuthorizationToken",<br/> "Resource": "*"<br/> }<br/> ]<br/>}</span></pre><p id="a545" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">4)“基于云形成误差”</p><p id="ade6" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">似乎SAM有时候无法自动更新或删除一个旧栈，所以当你发现错误与cloudwatch有某种关联时，应该尝试手动删除，像这个<code class="du nf ng nh mx b">“ValidationError Stack:arn </code> aws cloudformation stack处于ROLLBACK_COMPLETE状态，无法更新。“类似错误的链接是<a class="ae lk" href="https://stackoverflow.com/questions/57932734/validationerror-stackarn-aws-cloudformation-stack-is-in-rollback-complete-state" rel="noopener ugc nofollow" target="_blank">这里的</a>。你可以从主菜单访问云手表，删除任何失败的堆栈，如果它第一时间没有删除也不用担心。它会要求您验证该删除是否会删除与其相关的功能和模块，然后成功删除。</p><p id="ae1e" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">5)“内部服务器错误”</p><p id="d609" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">最后，您现在已经部署了您的模型，当在公共API上测试它时，它失败了，并显示这个错误，但是这个错误到底是什么意思呢？你需要访问AWS云观察日志来检查它。请使用此链接。如果错误还没有出现，似乎是环境变量的名称造成的。将来可能会更改，但对我来说，当将名称从<strong class="ke hi">$ context . integration error message</strong>更改为<strong class="ke hi">$ context . integration . error</strong><a class="ae lk" href="https://noise.getoto.net/2020/09/04/troubleshooting-amazon-api-gateway-with-enhanced-observability-variables/" rel="noopener ugc nofollow" target="_blank">参考链接</a>时会显示出来</p><p id="0f82" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">6)<code class="du nf ng nh mx b">OSError: [Errno 38] Function not implemented</code></p><p id="46f8" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">这个比较棘手。当您在Python中使用任何多线程函数时，都会发生这种情况。似乎Python的aws lamda函数仍然存在错误，所以对我来说，解决方案是在pytorch模型中设置num_workers = 0。错误已解决。<a class="ae lk" href="https://stackoverflow.com/questions/69042763/error-oserror-errno-38-function-not-implemented-accessing-trend-deepsec" rel="noopener ugc nofollow" target="_blank">参考链接</a></p><p id="6fda" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">7)“冷启动问题”</p><p id="a834" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">在这漫长的旅程之后，如果您在成功部署之后刚刚测试了它，并且发现了类似“超时”或其他类似的错误，请不要惊慌。这是因为冷启动众所周知的问题。你可以在其他博客或文章中了解更多。所以无论如何，耐心点，你的API最终会部署成功:)</p><p id="ef4a" class="pw-post-body-paragraph kb kc hh ke b kf kg kh ki kj kk kl km jl ko kp kq jp ks kt ku jt kw kx ky kz ha bi translated">我希望你会发现这篇文章很有用，并修复你将面临的一个或多个错误。欢迎在评论区问我，如果是一般性的错误，我会尽力帮助并把这些新错误添加到博客中。祝您好运，并愉快地部署每个人:)</p><div class="nj nk ez fb nl nm"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="nn ab dw"><div class="no ab np cl cj nq"><h2 class="bd hi fi z dy nr ea eb ns ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nt l"><h3 class="bd b fi z dy nr ea eb ns ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nu l"><p class="bd b fp z dy nr ea eb ns ed ef dx translated">medium.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa in nm"/></div></div></a></div></div></div>    
</body>
</html>