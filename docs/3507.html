<html>
<head>
<title>Building an Image Colorization Neural Network — Part 3: Convolutional Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建图像彩色化神经网络第3部分:卷积神经网络</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/building-an-image-colorization-neural-network-part-3-convolutional-neural-networks-21a45ef42dde?source=collection_archive---------6-----------------------#2022-09-12">https://medium.com/mlearning-ai/building-an-image-colorization-neural-network-part-3-convolutional-neural-networks-21a45ef42dde?source=collection_archive---------6-----------------------#2022-09-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div class="er es hf"><img src="../Images/efa9d14e9504bc4fe43b92a552ceb7b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*0-_GCOzqZ32v2ZoyacV7Ww.png"/></div><figcaption class="hm hn et er es ho hp bd b be z dx">Image generated by <a class="ae hq" href="https://stability.ai/blog/stable-diffusion-public-release" rel="noopener ugc nofollow" target="_blank">Stable Diffusion</a></figcaption></figure><div class=""/><p id="b375" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">你好，欢迎回到这个系列的第三部分，我们试图用神经网络给黑白图像着色。如果您还没有检查我们分析自动编码器和人工神经网络基础的前两部分，请确保在继续之前检查(下面的链接)。</p><p id="253a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">整个系列由以下4部分组成:</p><ol class=""><li id="c181" class="jo jp ht is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><a class="ae hq" rel="noopener" href="/mlearning-ai/building-an-image-colorization-neural-network-part-1-generative-models-and-autoencoders-d68f5769d484"> <strong class="is hu">第一部分</strong> </a>:概述生成模型和<em class="jx">自动编码器</em>的基础知识。</li><li id="57a4" class="jo jp ht is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><a class="ae hq" rel="noopener" href="/mlearning-ai/building-an-image-colorization-neural-network-part-2-artificial-neural-networks-ac591eb180"> <strong class="is hu">第二部分</strong> </a>:展示了人工<em class="jx">神经网络</em>的基本概念。</li><li id="78fd" class="jo jp ht is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><strong class="is hu">第三部分(当前)</strong>:介绍<em class="jx">卷积神经网络</em>的基础知识。</li><li id="c4c5" class="jo jp ht is b it jy ix jz jb ka jf kb jj kc jn jt ju jv jw bi translated"><a class="ae hq" rel="noopener" href="/@geokam/building-an-image-colorization-neural-network-part-4-implementation-7e8bb74616c"> <strong class="is hu">第四部分</strong> </a>:描述实际模型的实现。</li></ol><blockquote class="kd ke kf"><p id="91d8" class="iq ir jx is b it iu iv iw ix iy iz ja kg jc jd je kh jg jh ji ki jk jl jm jn ha bi translated">声明:这绝不是一个教程。它提供了一些基本知识，但主要目标是展示如何构建这样一个模型。</p></blockquote><p id="f5b4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">在前一篇文章中，我们展示了什么是人工神经网络，它如何工作，以及我们如何训练它来解决一个特定的问题。在目前的文章中，我们将提供完全相同的问题的答案，但对于卷积神经网络。</p></div><div class="ab cl kj kk go kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="ha hb hc hd he"><h1 id="4863" class="kq kr ht bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">卷积神经网络</h1><p id="bb1c" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn ha bi translated">人工神经网络的基本形式在输入数据是用相对“少”的维度“结构化”的情况下工作得非常好。但是，有些输入数据(如图像)被认为是“非结构化的”，因为它们包含过多的维度。让我们考虑这样一个场景，我们有256x256像素的彩色图像。输入的尺寸将是256x256x3 = 196，608，因为我们有3个通道:红色、绿色和蓝色。如果我们创建一个简单的线性神经网络，它接收这些图像作为输入并产生相同大小的图像，我们将需要196，608个参数！现在应该很清楚，这样的网络需要非常大的内存，更不用说过多的训练时间了。</p><p id="dd77" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">虽然图像可以表示为非常高维的向量，但是它具有一些特殊的特征。第一个称为<em class="jx">位置</em>，本质上意味着图像中的对象确实有局部空间支持。也就是说，相邻像素看起来非常相似，或者它们以某种方式相关。第二个叫做<em class="jx">平移不变性，</em>表示物体的外观通常与它们的位置无关。例如，不管人脸在图像上的位置如何(即，上、右、下、左)，人脸看起来都是一样的。</p><p id="c5c2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">如何利用这些特性来建立可管理的神经网络？为了在神经网络中引入局部性的概念，我们必须调整发生在各层之间的操作。更具体地说，我们需要从计算显式神经元之间的乘积转移到利用矩形区域，也称为感受野或核，它在执行卷积运算时越过输入。请注意，输入和感受野之间的卷积会导致图像尺寸变小。由于这一开始可能很难理解，下面的图展示了上述范式转变:</p><figure class="lu lv lw lx fd hj er es paragraph-image"><div class="er es lt"><img src="../Images/6ec1aad3a7f3a715c4343ab41f01dacd.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*mNsiZVG7HP0BOYaqJcqHEA.png"/></div><figcaption class="hm hn et er es ho hp bd b be z dx">Dot product between neurons and input</figcaption></figure><figure class="lu lv lw lx fd hj er es paragraph-image"><div class="er es ly"><img src="../Images/609634835217138d85b80d89d023b7c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/0*QASgfSWTqsYhAMw0.png"/></div><figcaption class="hm hn et er es ho hp bd b be z dx">Dot product formula</figcaption></figure><figure class="lu lv lw lx fd hj er es paragraph-image"><div class="er es lz"><img src="../Images/a9ff27eff25c6bdb17923fab677b1b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*h-XRD6-qIaA6YYv8yAlXNg.png"/></div><figcaption class="hm hn et er es ho hp bd b be z dx">Convolution between receptive field and input</figcaption></figure><figure class="lu lv lw lx fd hj er es paragraph-image"><div class="er es ma"><img src="../Images/d07c8013180324c143c73066b17a28fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/0*bkZ2HDQppq2bqbA9.png"/></div><figcaption class="hm hn et er es ho hp bd b be z dx">Convolution formula</figcaption></figure><p id="b347" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">在已建立的过程中引入平移不变性假设可以通过强制感受野的权重wᵢ在输入上共享来实现。</p><p id="7e62" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">也就是说，<em class="jx">卷积神经网络</em>或CNN是一种特定类型的人工神经网络，其中各层之间的基本操作是卷积而不是乘法。卷积发生在感受野和输入之间，其中感受野的数量和大小是可配置的，权重是可训练的。在中枢神经网络中，我们通常出于不同的原因使用不同种类的感受野。例如，应用于图像的某些字段会检测边缘或模糊或锐化图像。然而，在一般情况下，感受野的权重被初始化，然后被训练，就像在传统的前馈神经网络中训练神经元的权重一样。更清楚地说，在人脸识别任务中，一些感受域可能最终识别眼睛，而另一些则识别鼻子、头发或其他任何东西。所有这些的结合给了我们一个完整的人脸识别模型。</p><h2 id="54e7" class="mb kr ht bd ks mc md me kw mf mg mh la jb mi mj le jf mk ml li jj mm mn lm mo bi translated">配置</h2><p id="dedc" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn ha bi translated">既然我们已经解释了感受野背后的直觉，让我们来看看它们应用于输入的不同方式。实际上，有4个可配置的参数会影响卷积过程。</p><h2 id="2e9c" class="mb kr ht bd ks mc md me kw mf mg mh la jb mi mj le jf mk ml li jj mm mn lm mo bi translated">填料</h2><p id="9789" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn ha bi translated">填充处理包含零的帧的大小，可以在输入周围添加零。通过使用填充，我们可以更好地控制输出分辨率，因为感受野会更加关注图像的边缘。在某种意义上，填充有助于保持输入分辨率。</p><figure class="lu lv lw lx fd hj er es paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="er es mp"><img src="../Images/7ec5b33b622653d6c692241504895f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YyTJGZg0aToaPnB2PBvpTA.png"/></div></div><figcaption class="hm hn et er es ho hp bd b be z dx">Padding example</figcaption></figure><h2 id="74a7" class="mb kr ht bd ks mc md me kw mf mg mh la jb mi mj le jf mk ml li jj mm mn lm mo bi translated">进展</h2><p id="c165" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn ha bi translated">当应用卷积时，步幅处理感受野的步长。步幅为1意味着感受野将一次移动一步，而步幅为2表示在输入上移动两步。Stride有助于降低空间分辨率，以实现更好的处理。</p><figure class="lu lv lw lx fd hj er es paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="er es mu"><img src="../Images/7c2c442b32e17feaa5410b87000dd2f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ixs6XlilLH9FQzG_6KJp1A.png"/></div></div><figcaption class="hm hn et er es ho hp bd b be z dx">Stride example</figcaption></figure><h2 id="15ad" class="mb kr ht bd ks mc md me kw mf mg mh la jb mi mj le jf mk ml li jj mm mn lm mo bi translated">联营</h2><p id="8efa" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn ha bi translated">与stride类似，还有另一种称为池化的技术具有相同的目的，即在不丢失有价值的细节的情况下加快处理速度。有许多不同的池，如平均池和最大池。在第一种情况下，我们计算感受野的平均输入，这与应用权重固定为1/k的k×k步长卷积相同。在第二种情况下，我们计算并保持感受野的最大输入。</p><h2 id="b2d1" class="mb kr ht bd ks mc md me kw mf mg mh la jb mi mj le jf mk ml li jj mm mn lm mo bi translated">扩张</h2><p id="bc1e" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn ha bi translated">扩张处理感受野的扩展。1的扩张意味着3×3感受野将保持3×3，而2的扩张意味着相同的场将被转换成5×5的场，因为它通过在权重之间添加“孔”而被扩展。扩张试图模仿大的感受野，同时保持较小的权重。例如，膨胀为2的3x3场具有9个可训练权重(具有1个通道)，而膨胀为1的5x5场具有25个可训练权重。</p><figure class="lu lv lw lx fd hj er es paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="er es mu"><img src="../Images/41cd0a866295d944b1dc9ba49fb66503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_mzjHOG_5UoluTFsSNzkww.png"/></div></div><figcaption class="hm hn et er es ho hp bd b be z dx">Dilation example</figcaption></figure><h1 id="9c1f" class="kq kr ht bd ks kt mv kv kw kx mw kz la lb mx ld le lf my lh li lj mz ll lm ln bi translated">转置卷积</h1><p id="fadd" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn ha bi translated">卷积层在输入是“非结构化”的(如图像)辨别任务中非常有用。然而，在我们的任务中，我们必须建立一个生成模型来创建新的图像。更正式地说，在图像着色任务中，我们必须增加维度来实现我们的目标。我们可以用<em class="jx">转置卷积</em>来实现，它与卷积完全相反。卷积层会降低分辨率，而转置层会提高分辨率。它们的作用对于生成模型和自动编码器至关重要，因为解码器是转置卷积层的混合物。</p><h1 id="ccf5" class="kq kr ht bd ks kt mv kv kw kx mw kz la lb mx ld le lf my lh li lj mz ll lm ln bi translated">结论</h1><p id="1993" class="pw-post-body-paragraph iq ir ht is b it lo iv iw ix lp iz ja jb lq jd je jf lr jh ji jj ls jl jm jn ha bi translated">总之，为了训练有或没有转置层的CNN，必须指定层数，并为每一层确定感受野的数量、它们的大小以及填充、步幅和扩张选项。然后，就像在简单的ann中一样训练网络，不同之处在于在CNN中，我们调整感受域的权重。</p><p id="2add" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn ha bi translated">通读完这一部分，你就具备了理解图像彩色化攻击方案所需要的全部基础知识。这就是我们在本系列的下一篇也是最后一篇文章中要做的事情。所以，敬请期待！</p><div class="hg hh ez fb hi na"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hu fi z dy nf ea eb ng ed ef hs bi translated">Mlearning.ai提交建议</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">medium.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no hk na"/></div></div></a></div></div></div>    
</body>
</html>