<html>
<head>
<title>Introduction to diffusion models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ‰©æ•£æ¨¡å‹ä»‹ç»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/introduction-to-diffusion-models-86afe13a4c50?source=collection_archive---------2-----------------------#2022-11-29">https://medium.com/mlearning-ai/introduction-to-diffusion-models-86afe13a4c50?source=collection_archive---------2-----------------------#2022-11-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="8c08" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æœ€è¿‘<a class="jc jd ge" href="https://medium.com/u/b1574f0c6c5e?source=post_page-----86afe13a4c50--------------------------------" rel="noopener" target="_blank">æ‹¥æŠ±è„¸</a>æ¨å‡ºäº†ä¸€é—¨å…³äºæ‰©æ•£æ¨¡å‹çš„è¯¾ç¨‹ã€‚è¿™ä¸ªåšå®¢æ—¨åœ¨ä»‹ç»æ‰©æ•£æ¨¡å‹çš„åŸºç¡€çŸ¥è¯†ï¼Œå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿè¿˜æœ‰<strong class="ig hi">æ‰©æ•£åº“ï¼ğŸ¤—</strong></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/8ef5b31025f1d26381c465cf51d46120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rg5lZJGdjxhcjdLc"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx">Photo by <a class="ae ju" href="https://unsplash.com/ja/@marc_schulte?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marc Schulte</a> on <a class="ae ju" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="ad01" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">æ‰©æ•£æ¨¡å‹æœ‰å“ªäº›ï¼Ÿ</h2><p id="eeb5" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">å®ƒä»¬æ˜¯ç”Ÿæˆæ¨¡å‹çš„ç±»å‹ã€‚å®ƒä»¬ç”Ÿæˆä¸€ç»„ä¸åŒçš„è¾“å‡ºï¼Œè¿™äº›è¾“å‡ºç±»ä¼¼äºè®­ç»ƒæ•°æ®ï¼Œä½†ä¸æ˜¯å®Œå…¨ç›¸åŒçš„å‰¯æœ¬ã€‚ä¸ºäº†ä½¿æ‰©æ•£æ¨¡å‹èµ·ä½œç”¨ï¼Œè®­ç»ƒæ˜¯åå¤è¿›è¡Œçš„ã€‚åœ¨æ·»åŠ éšæœºå™ªå£°å’Œæ¨¡å‹ä¼°è®¡çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¦‚ä½•ä»å°å™ªå£°åˆ°å®Œå…¨å»å™ªçš„å›¾åƒã€‚</p><h2 id="92a5" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">æ‰©æ•£æ¨¡å‹çš„åŸ¹è®­ç¨‹åº:</h2><ol class=""><li id="1f49" class="kv kw hh ig b ih kq il kr ip kx it ky ix kz jb la lb lc ld bi translated">åŠ è½½æ•°æ®</li><li id="07cb" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">æ·»åŠ å™ªå£°(ä¸åŒæ•°é‡)</li><li id="8a04" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">è¾“å…¥æœ‰å™ªå£°çš„ç‰ˆæœ¬</li><li id="f423" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">ä¼˜åŒ–æ¨¡å‹é™å™ªçš„æ•ˆæœã€‚</li><li id="fc35" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated">æ ¹æ®ä¸Šè¿°ä¿¡æ¯æ›´æ–°æ¨¡å‹æƒé‡ã€‚</li></ol><h2 id="d5c0" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">ç”¨æ‰©æ•£æ¨¡å‹ç”Ÿæˆæ–°å›¾åƒ:</h2><p id="250a" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">æˆ‘ä»¬ä»å®Œå…¨éšæœºçš„è¾“å…¥æ›´æ–°å¼€å§‹ï¼Œæ¯æ¬¡éƒ½åŸºäºæ¨¡å‹é¢„æµ‹è¿›è¡Œå°‘é‡æ›´æ–°ã€‚</p><h2 id="388f" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">æ¢¦å¹»å°å±‹</h2><p id="5b8b" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">ç¨³å®šæ‰©æ•£æ¨¡å‹æ˜¯ä¸€ä¸ªæ–‡æœ¬æ¡ä»¶æ¨¡å‹ã€‚å®ƒè®©æˆ‘ä»¬åˆ›é€ å‡ºè‡ªå·±çš„å˜ä½“ï¼Œæ‹¥æœ‰é¢å¤–çš„ç‰¹å®šé¢å­”ã€ç‰©ä½“æˆ–é£æ ¼ã€‚</p><h2 id="bc6f" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">æ‹¥æŠ±é¢APIæ‰©æ•£å™¨</h2><ol class=""><li id="8734" class="kv kw hh ig b ih kq il kr ip kx it ky ix kz jb la lb lc ld bi translated"><strong class="ig hi">ç®¡é“</strong>:é«˜çº§ç±»</li><li id="50c0" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated"><strong class="ig hi">å‹å·</strong>:æ¶æ„</li><li id="c9a2" class="kv kw hh ig b ih le il lf ip lg it lh ix li jb la lb lc ld bi translated"><strong class="ig hi">è°ƒåº¦å™¨</strong>:åœ¨æ¨ç†è¿‡ç¨‹ä¸­ä»å™ªå£°ä¸­ç”Ÿæˆå›¾åƒï¼Œä»¥åŠä¸ºè®­ç»ƒç”Ÿæˆæœ‰å™ªå£°çš„å›¾åƒã€‚</li></ol><p id="8a09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> DDPM(å»å™ªæ‰©æ•£æ¦‚ç‡æ¨¡å‹)è°ƒåº¦å™¨:<br/> </strong> ddpmæ˜¯å™ªå£°è°ƒåº¦å™¨ï¼Œå®ƒå°†å™ªå£°å›¾åƒé¦ˆé€ç»™æ¨¡å‹ï¼Œåœ¨æ¨ç†æœŸé—´ï¼Œæˆ‘ä»¬è¿­ä»£åœ°ä½¿ç”¨æ¨¡å‹é¢„æµ‹æ¥å»é™¤å™ªå£°ã€‚è°ƒåº¦ç¨‹åºå¸®åŠ©æˆ‘ä»¬å¤„ç†è¿™ä¸ªè¿‡ç¨‹ã€‚</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lj"><img src="../Images/8853e1a9e0984f8f31bbe2ce38d93e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*QuKm4ofbbujjCq3OeGlF3w.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx">adding noise to butterfly images.</figcaption></figure><h2 id="9c1b" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">å®šä¹‰æ¨¡å‹</h2><p id="6541" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">æˆ‘ä»¬å¯ä»¥å°†è¯¥æ¨¡å‹å®šä¹‰ä¸ºUNETæ¶æ„çš„å˜ä½“(å¦‚ä¸‹å›¾æ‰€ç¤º)</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lk"><img src="../Images/75d313a3a7a99d14de0b05b921c249c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_-7rHclT_qvky2rYnWOFyQ.png"/></div></div></figure><p id="ff8c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">è¯¥æ¨¡å‹å…·æœ‰å½“å‰å±‚çš„å‡ ä¸ªå—ï¼Œè¿™äº›å—å°†å›¾åƒå¤§å°å‡åŠï¼Œä¹‹åæˆ‘ä»¬å†æ¬¡ä¸Šé‡‡æ ·ä»¥å¢åŠ å›¾åƒå¤§å°ã€‚</p><p id="06b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å®šä¹‰æ¨¡å‹åï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¨¡å‹è®­ç»ƒä¸ºå¸¸è§„pytorchè®­ç»ƒå¾ªç¯</p><h2 id="251a" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">è®­ç»ƒå¾ªç¯+ç»™å›¾åƒæ·»åŠ å™ªå£°</h2><pre class="jf jg jh ji fd ll lm ln bn lo lp bi"><span id="2685" class="lq jw hh lm b be lr ls l lt lu"># Set the noise scheduler<br/>noise_scheduler = DDPMScheduler(<br/>    num_train_timesteps=1000, beta_schedule="squaredcos_cap_v2"<br/>)<br/><br/># Training loop<br/>optimizer = torch.optim.AdamW(model.parameters(), lr=4e-4)<br/><br/>losses = []<br/><br/>for epoch in range(30):<br/>    for step, batch in enumerate(train_dataloader):<br/>        clean_images = batch["images"].to(device)<br/>        # Sample noise to add to the images<br/>        noise = torch.randn(clean_images.shape).to(clean_images.device)<br/>        bs = clean_images.shape[0]<br/><br/>        # Sample a random timestep for each image<br/>        timesteps = torch.randint(<br/>            0, noise_scheduler.num_train_timesteps, (bs,), device=clean_images.device<br/>        ).long()<br/><br/>        # Add noise to the clean images according to the noise magnitude at each timestep<br/>        noisy_images = noise_scheduler.add_noise(clean_images, noise, timesteps)<br/><br/>        # Get the model prediction<br/>        noise_pred = model(noisy_images, timesteps, return_dict=False)[0]<br/><br/>        # Calculate the loss<br/>        loss = F.mse_loss(noise_pred, noise)<br/>        loss.backward(loss)<br/>        losses.append(loss.item())<br/><br/>        # Update the model parameters with the optimizer<br/>        optimizer.step()<br/>        optimizer.zero_grad()<br/><br/>    if (epoch + 1) % 5 == 0:<br/>        loss_last_epoch = sum(losses[-len(train_dataloader) :]) / len(train_dataloader)<br/>        print(f"Epoch:{epoch+1}, loss: {loss_last_epoch}")</span></pre><p id="1930" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ç»è¿‡50ä¸ªæ—¶æœŸçš„è®­ç»ƒæ¨¡å‹ï¼Œå¯ä»¥ç”Ÿæˆä¸è®­ç»ƒæ•°æ®ç›¸ä¼¼çš„å›¾åƒã€‚</p><p id="6f32" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ç¤ºä¾‹:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lj"><img src="../Images/b7461d093f4dfe2a682caf00bc4399de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*SGjfWro9j7wb7oxscO8wUQ.png"/></div></figure><h2 id="b1f3" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">ç¬”è®°æœ¬é“¾æ¥</h2><div class="lv lw ez fb lx ly"><a href="https://colab.research.google.com/github/huggingface/diffusion-models-class/blob/main/unit1/01_introduction_to_diffusers.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hi fi z dy md ea eb me ed ef hg bi translated">è°·æ­Œè”åˆå®éªŒå®¤</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">ç¼–è¾‘æè¿°</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">colab.research.google.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm jo ly"/></div></div></a></div><h2 id="cf6d" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">é“¾æ¥åˆ°è¯¾ç¨‹GitHub</h2><div class="lv lw ez fb lx ly"><a href="https://github.com/huggingface/diffusion-models-class/tree/main/unit1" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hi fi z dy md ea eb me ed ef hg bi translated">ä¸»ç»“åˆé¢å¤„çš„æ‰©æ•£æ¨¡å‹-ç­‰çº§/å•å…ƒ1/æ‰©æ•£æ¨¡å‹-ç­‰çº§</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">æ¬¢è¿æ¥åˆ°æ‹¥æŠ±è„¸æ‰©æ•£æ¨¡å‹è¯¾ç¨‹çš„ç¬¬ä¸€å•å…ƒï¼åœ¨è¿™ä¸€å•å…ƒï¼Œä½ å°†å­¦ä¹ å¦‚ä½•æ‰©æ•£çš„åŸºæœ¬çŸ¥è¯†â€¦</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">github.com</p></div></div><div class="mh l"><div class="mn l mj mk ml mh mm jo ly"/></div></div></a></div><h2 id="18a3" class="jv jw hh bd jx jy jz ka kb kc kd ke kf ip kg kh ki it kj kk kl ix km kn ko kp bi translated">å‚è€ƒ</h2><div class="lv lw ez fb lx ly"><a href="https://arxiv.org/abs/2006.11239" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hi fi z dy md ea eb me ed ef hg bi translated">å»å™ªæ‰©æ•£æ¦‚ç‡æ¨¡å‹</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">æˆ‘ä»¬æå‡ºäº†é«˜è´¨é‡çš„å›¾åƒåˆæˆç»“æœä½¿ç”¨æ‰©æ•£æ¦‚ç‡æ¨¡å‹ï¼Œä¸€ç±»æ½œåœ¨å˜é‡æ¨¡å‹â€¦</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">arxiv.org</p></div></div><div class="mh l"><div class="mo l mj mk ml mh mm jo ly"/></div></div></a></div><div class="lv lw ez fb lx ly"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hi fi z dy md ea eb me ed ef hg bi translated">Mlearning.aiæäº¤å»ºè®®</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">å¦‚ä½•æˆä¸ºMlearning.aiä¸Šçš„ä½œå®¶</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">medium.com</p></div></div><div class="mh l"><div class="mp l mj mk ml mh mm jo ly"/></div></div></a></div></div></div>    
</body>
</html>