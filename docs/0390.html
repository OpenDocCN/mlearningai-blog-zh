<html>
<head>
<title>Instacart Market Basket Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Instacart市场篮分析</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/instacart-market-basket-analysis-a726bb56d62?source=collection_archive---------4-----------------------#2021-04-03">https://medium.com/mlearning-ai/instacart-market-basket-analysis-a726bb56d62?source=collection_archive---------4-----------------------#2021-04-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="78b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">用户在下一个订单中会对之前订购的哪些产品</em> <strong class="ig hi"> <em class="jc">再订购</em> </strong> <em class="jc">？</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/bc855fb6386bf3bc887bbd56c7ed5d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_2k0pFX1LxfwxAzt12xQ4w.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Source: EnvatoElements/RossHelen</figcaption></figure><h1 id="18eb" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">问题描述:</h1><p id="bbda" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">Instacart是一款杂货订购和交付应用程序，允许客户在其应用程序或网站上选择产品，个人购物者通过店内购物挑选这些产品并交付订单。在这场Kaggle比赛中，Instacart向机器学习从业者提供了他们的匿名数据，旨在建立最佳机器学习模型来分析客户的再订购模式，并根据客户之前的购物数据预测客户可以再订购哪些产品。</p><p id="0987" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">杂货包括日常必需品、食品、护肤品和更多更有可能被重新订购的商品。这种重新排序行为在与日常必需品、食品等产品相关的每个人中都很常见，并且可能与其他产品不同。即使每个人都需要一些共同类型的产品，选择也因品牌和其他因素而不同。例如，每个人都需要洗发水，但他们使用哪种洗发水取决于顾客的兴趣。客户选择的产品将取决于他们的品味、文化多样性、生活方式和其他因素。但是这种订购模式可以通过客户在一段时间内所下的大量订单来分析。</p><p id="d2ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里的业务需求是预测哪些以前购买的产品将出现在客户的下一个订单中。这个模型应该使用匿名数据开发，这些数据包含Instacart开源的数百万条记录。这改善了用户体验以及Instacart的业务。这不同于常规的推荐系统问题。该任务不涉及冷启动问题，即我们的目标是预测<strong class="ig hi">用户是否会再次订购</strong>之前购买的特定产品。此任务不期望向客户推荐新产品。</p><h1 id="d80e" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据集分析:</h1><p id="b667" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">可用的数据集是一组描述客户订单的相关文件。</p><ol class=""><li id="0262" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated"><strong class="ig hi"> aisles.csv </strong>:这个csv文件有两个字段，aisle_id和aisle name。</li><li id="846e" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi"> departments.csv: </strong>一个部门有多个过道。这个csv文件有两个字段，部门标识和部门名称。</li><li id="6cbb" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi"> orders.csv: </strong>这个csv文件包含一段时间内客户订单的信息。这有七个字段，order_id(订单的唯一id)、user_id(下订单的用户的唯一id)、eval_set(记录是否属于先前、训练或测试集)、order_number、order_dow(星期几)、order_hour_of_day、days_since_prior_order。Instacart为每个用户提供了4到100个订单。</li><li id="b6a1" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi"> products.csv: </strong>这个csv文件有四个字段。product_id(产品的唯一id)、product_name、aisle_id(该产品可用的通道id)、department_id(该产品可用的部门id)。</li><li id="03ae" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi">Order _ products _ _ prior . csv:</strong>这个CSV文件有用户以前的订单记录(除了最近的)。订单文件中的eval_set=prior意味着它属于这个先前的文件。这个文件有四个字段，order_id，product_id，add_to_cart_order，redordered(0 =新订购的产品，1 =以前订购的产品)。</li><li id="18cc" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi">order _ products _ _ train . csv:</strong>该CSV文件记录了用户最近的订单。订单文件中的eval_set=train意味着它属于该train文件。此处的字段与Order_products__prior相同。</li></ol><p id="0bd5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">该数据集没有关于订购产品数量的信息。</em>T9】</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lk"><img src="../Images/06e8830d60bbdf66f304a97f82729ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MPFR2iSY9x5RJrU3UGYg_w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">This image convey relation between datasets. source: <a class="ae ll" href="https://www.kaggle.com/c/instacart-market-basket-analysis/discussion/33128" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/instacart-market-basket-analysis/discussion/33128</a></figcaption></figure><h1 id="8873" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">机器学习的问题公式化；</h1><p id="4dd3" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在order_prior__train中，我们有每个用户最近订单的记录。使用关系表，我们可以获取订购了具有order_id的产品的user_id，并且我们可以以这样的方式制定，即我们拥有user_id、product_id和ordered。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/06b537eb5ea403b8fc4b050bc985395a.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*ynsMV2Z0oQsV_-6peD7goA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx"><strong class="bd jv">to</strong></figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ln"><img src="../Images/c6e82354c8f228bce69355da3f221e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*WuDks2HWJYeKRhtn_i3Tig.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">fetched user_id using order_id</figcaption></figure><p id="fe9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，ordered=1表示这是用户以前订购的产品，ordered=0表示这是用户第一次订购的产品。</p><p id="5a51" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是这个竞赛的任务是预测客户的下一个订单中会出现哪些以前购买过的产品。对于这个问题，我们不应该考虑新订购的产品。因此，我们可以删除reordered = 0的记录，并从order _ products _ _ prior中获取每个用户在最近订单(order_products__train)中没有订购的产品，并将它们标记为0。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lo"><img src="../Images/2a3ea46c215ee8fb80fce72723fe746c.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*dCSgIjfnJYlWUtcl7tSpiQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">formulation for ML problem</figcaption></figure><p id="f1a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图说明了我是如何为ML建模制定数据的。这是user_id=1的最近顺序的数据。到目前为止，该用户订购了18种独特的产品(之前),其中他/她在最近的订单中重新订购了10种产品。这里，重新订购=1意味着用户<strong class="ig hi">在最近的订单中重新购买了之前订购的产品</strong>，重新订购=0意味着用户<strong class="ig hi">没有在最近的订单中重新购买之前订购的产品</strong>。现在，我们可以从先前的数据中提取用户相关特征、产品相关特征、用户-产品交互特征、时间相关特征等等，并使用重新排序作为类别标签来构建ML模型。</p><p id="729a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">这是一个二元分类问题，数据高度不平衡。</em> </strong></p><h1 id="9cb7" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">绩效指标:</h1><p id="36d8" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated"><strong class="ig hi">平均f1分数</strong>是根据Kaggle竞赛的性能指标，但考虑到现实世界的情况<strong class="ig hi">,“1 =将重新排序”</strong>的F1分数是应特别评估模型的性能指标。更进一步，对'<strong class="ig hi">的回忆会重新排序</strong>'可以给出观察结果。</p><h1 id="7e86" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">探索性数据分析:</h1><p id="2725" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">都是质疑。</em>T3】</strong></p><ol class=""><li id="06b3" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated"><strong class="ig hi">有多少订单没有再订购的产品？</strong></li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/2259ec6a76f5674a631423ee53da1809.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*hAKfCxMhk9tYvtZIu6nycw.png"/></div></figure><p id="8557" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以观察到，大多数订单包含用户以前购买的产品。</p><p id="50d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。哪些部门的再订购率较高？</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lq"><img src="../Images/2ab6f5ef0783e7d87574f2c5681d8e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wrrWlkrt0B_Su-qAa0WwxA.png"/></div></div></figure><p id="cc1f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3。订购最多的前20种产品是什么？</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/43145975b92f3d15a340a0080f133bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2kkHlLOL3Mwp7JG-Xgnoxw.png"/></div></div></figure><p id="0d40" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">水果和蔬菜，尤其是“有机”显示出完全的优势。</p><p id="fb1d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。一周中的哪几天订购和再订购的产品数量最多？</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/b9685c46c28d8f4dbbcf18516c4d3ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j47lLM6SXKtk6UGQhW-KkA.png"/></div></div></figure><p id="43e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">肉和酒精有什么不同吗？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/4c9aa644451d685b7a62a180bdcb808c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6VPueXJvoiKkRwFZQdILvQ.png"/></div></div></figure><p id="4ba4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在一周的第0天和第1天下的订单数量较高，在再订购的百分比中也观察到了同样的情况。但是酒精产品在一周的第4天和第5天被订购的最多。可能是因为周末快到了。</p><p id="b02f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 5。每个用户订购了多少独特的产品？</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lq"><img src="../Images/9a5371e35a11a6311a396aa5baa800ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aKaYx4CC2j4mdAmZedVaGw.png"/></div></div></figure><p id="870f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这看起来像表现出对数正态行为。是吗？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lu"><img src="../Images/32501003652cf32428c9d438888dff3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*OSAj1n-PgopMf2OErnY93A.png"/></div></figure><p id="4c9b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">是的，在某种程度上。</p><p id="15e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6。没有再订购产品的订单(无订单)之间的订单差距有多大？</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lv"><img src="../Images/ad5ecb3955c9bcdd4195fad6761447a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vQ4CHQCGVXjjQ8csbysDQ.png"/></div></div></figure><p id="9f57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在用户最后一次订购后一个月，订购了大量新订购的产品(无再订购)。</p><p id="a5c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那再订购产品的订单怎么办？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/7c02b90bbf9ebab70f6523d68d49c658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQmgtsfC1h9xma7ySwTy5A.png"/></div></div></figure><p id="284c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">周订单重要性增加，其次是月订单。</p><p id="83ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">深入EDA可以在我的Github资源库中探索。我进一步探讨了关于某些部门的星期几和一天中的小时之间的关系、部门和每月、每周订单之间的关系等等。</em>T19】</strong></p><h1 id="c644" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">特色化:</h1><p id="c672" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我从第二名获奖者的博客中实现了一些最重要的功能，当然它们工作得很好。</p><p id="d157" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以查看:<a class="ae ll" rel="noopener" href="/kaggle-blog/instacart-market-basket-analysis-feda2700cded">https://medium . com/ka ggle-blog/insta cart-market-basket-analysis-feda 2700 cded</a></p><p id="85c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将只展示那些我额外开发的功能。</p><h2 id="bace" class="lx ju hh bd jv ly lz ma jz mb mc md kd ip me mf kh it mg mh kl ix mi mj kp mk bi translated">1.通过奇异值分解(SVD)使用矢量表示的基于余弦相似性的特征:</h2><p id="9fb1" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">使用SVD，我获得了每个用户和产品的向量表示，使用用户购买产品的次数作为邻接矩阵中的交互元素。在将每个向量转换成单位向量(除以大小——余弦相似性)后，我计算了某个用户以前购买的特定产品与该用户订购最多的前3个产品的余弦相似性。利用这一点，我开发了三个特征，前三个相似性的最大值、前三个相似性的总和以及前三个相似性的乘积。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/eff894092d256aca22e9746ff2b7c462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_X9MfBIOho4RjFro68dnsw.png"/></div></div></figure><p id="d730" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们可以观察到，对于最大相似度=1的数据点(即，用户订购最多的前3个产品中的产品)，重新排序的次数更多。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/05588c2f94ea17441f75f3ef149497ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UW1E9F5C5OYmy7r9jRl34w.png"/></div></div></figure><p id="7a1a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">重新排序的数量在前3个相似性之和等于1时达到峰值，并且优势持续到更高的值。</p><h2 id="a7ca" class="lx ju hh bd jv ly lz ma jz mb mc md kd ip me mf kh it mg mh kl ix mi mj kp mk bi translated">2.产品的平均订购次数:</h2><p id="e5a8" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">当特定产品被更少数量的独立用户订购更多次数时，产品的平均订购次数将会更多。通过这种方式，可以识别由特定人群订购的产品(例如，与宠物相关的产品不会被所有人订购)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/9f448801ae70b12d14c42f1e5fcee753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBnmrgpT1mqG7f3kkIIBTg.png"/></div></div></figure><p id="338b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随着平均值的增加，再订购的优势也增加了。</p><h2 id="3bd7" class="lx ju hh bd jv ly lz ma jz mb mc md kd ip me mf kh it mg mh kl ix mi mj kp mk bi translated">3.首次购买该产品后的用户-产品订单比率:</h2><p id="02e8" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">让用户A下了100个订单，从第51个订单开始，用户购买了产品A 30次。现在，当我们计算用户订购产品A的次数比率时，我们得到30/100=0.3。但是我们可以观察到，用户A是最近订单中频繁购买的产品A。因此，这个特性捕获了关于用户A在第一次购买产品后购买了多少次的比率的信息(30/50=0.6)。我为最近的5个订单以及每个用户的所有订单开发了这个。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/d2d04cc6f891365486539ad0625c46a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8PLo8UM7iqI30NNWu4QJg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">for recent 5 orders of every user</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/3c804fa968b9f5910ba09f92e51e09b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*43la4lh5YP4wLGXltmFtow.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">for all prior orders of every user</figcaption></figure><p id="0832" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了探索我开发的其他功能，我详细解释了每个功能，并记录了如何开发这些功能的说明。我总共开发了30个功能，这些功能基于用户订购特定产品、与用户相关的功能、与产品相关的功能以及更多用户-产品交互功能之间差距的统计测量。T3】</p><h1 id="3393" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">最佳模特:</h1><h2 id="1894" class="lx ju hh bd jv ly lz ma jz mb mc md kd ip me mf kh it mg mh kl ix mi mj kp mk bi translated">1.XGBClassifier:</h2><p id="d6ee" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated"><strong class="ig hi">超参数</strong> : n_estimators=1000，max_depth=3</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mr"><img src="../Images/3e124decf6a469f47c72282f48e980d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4O4XvHRY-jhSSaHurioHA.png"/></div></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ms"><img src="../Images/b5306022c040ca123005fca8344821be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MfrNBYnEPI4C-x7Ib9lKsw.png"/></div></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mt"><img src="../Images/b495fe1fa372b70813181920b69c4f81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tLrvSCYUr6107XzLxXicuQ.png"/></div></div></figure><p id="2922" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随着基础学习者数量的增加，xgb分类器往往会过度适应。在n_estimators(基础学习者的数量)=1000和max_depth(每个基础学习者的最大深度)=3的情况下，没有观察到过度拟合。</p><p id="7154" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">决定类标签被调整的概率阈值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mu"><img src="../Images/63222713a684663969da53264353ba2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqFETkiptDwI8734gjWbOA.png"/></div></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mv"><img src="../Images/fd20ab61c52d4ed41cdee0fbee0648fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9el90ZBDrfnnSqz_JJwL1g.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mw"><img src="../Images/27f22675d9b58e05f8465befaf2689a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-tb7STPScItzeO5TDONE6g.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Confusion, Precision, Recall matrices</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/cd65191ebb10d2b83be40e0ddf24da27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d26I0lGDAZJm4gWN0cJ1Ow.png"/></div></div></figure><p id="74ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">使用XGBClassifier的Kaggle评分:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/6b1fb4cac360bf3c9fb0612c0bd089e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIxqhtpl-bK5gvUyieRerg.png"/></div></div></figure><h2 id="94a9" class="lx ju hh bd jv ly lz ma jz mb mc md kd ip me mf kh it mg mh kl ix mi mj kp mk bi translated">2.具有平衡类权重的随机森林分类器；</h2><p id="cd06" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated"><strong class="ig hi">超参数</strong> : n_estimators=1000，max_depth=12</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mz"><img src="../Images/b36036faff858217f8dc011648ffc1bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uAxdN9pR4xcz4Uygl8sb3w.png"/></div></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es na"><img src="../Images/26d37dee016078631d4bc2dcd08e1dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8NaowJnXWJqHebRbCcf7nw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/538226703be988bb702abc9514084eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UoD0eO1HT1nCdYG-JCN2zg.png"/></div></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nc"><img src="../Images/bc8051906e6a243b94ee4377ca04c7d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sFpgYuwH9B9KAyeT1NhyKA.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nd"><img src="../Images/6b3f81a6ca6bf1f32527ae4b37577d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MDmNUQeWXPaoZdum-1fQPw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Confusion, Precision and Recall matrices</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ne"><img src="../Images/d00783cd98f7278b50e6309389abf025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVEPsM3_H98ETHryLREHPg.png"/></div></div></figure><p id="a75a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">使用具有平衡类权重的随机森林的Kaggle分数:</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/fc1dd1a6879e1e0dee470c66c1a6e129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KMfetp4AeMdWyewr0nQYbQ.png"/></div></div></figure><p id="205d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"><em class="jc">XGB和随机森林的得分几乎相似，但随机森林预测的概率阈值更高(0.69)。</em>T15】</strong></p><h1 id="fe89" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">所有车型的Kaggle排名:</h1><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mp mq l"/></div></figure><p id="dc11" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">由于有限的计算能力和巨大的数据量，我对ML模型进行的所有超参数调整仅使用了大约20%的数据。如果使用大量数据和调整其他超参数如学习速率、正则化强度等进一步调整。，分数可以进一步提高。</em>T19】</strong></p><p id="0f1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">浏览我的Github存储库，探索我调优和使用的模型。我还开发了“深度神经网络”。</strong></p><h1 id="4906" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">未来工作:</h1><ul class=""><li id="f0f5" class="kw kx hh ig b ih kr il ks ip ng it nh ix ni jb nj lc ld le bi translated"><strong class="ig hi">‘购物篮分析’</strong>是数据挖掘的一个概念。可以开发和检查基于此概念的功能。</li><li id="670c" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb nj lc ld le bi translated">并且如上所述，如果计算能力支持，可以使用更大量的数据来执行进一步的超参数调整。</li><li id="a7be" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb nj lc ld le bi translated"><strong class="ig hi">支持向量机(SVM) </strong>如果要使用的正确内核是已知的，可以尝试。</li><li id="d514" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb nj lc ld le bi translated">此外，可以使用不同的优化器开发更深层次的神经网络。到目前为止，我在深度学习模型中只使用了<strong class="ig hi">亚当</strong>。</li></ul><h1 id="53d1" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考资料:</h1><ul class=""><li id="9082" class="kw kx hh ig b ih kr il ks ip ng it nh ix ni jb nj lc ld le bi translated"><strong class="ig hi">冠军访谈:第二名，友川翁德拉:</strong><a class="ae ll" rel="noopener" href="/kaggle-blog/instacart-market-basket-analysis-feda2700cded"><strong class="ig hi">https://medium . com/ka ggle-blog/insta cart-market-basket-analysis-feda 2700 cded</strong></a></li><li id="6199" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb nj lc ld le bi translated"><a class="ae ll" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">https://www.appliedaicourse.com/</strong></a></li><li id="fe4c" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb nj lc ld le bi translated"><a class="ae ll" href="https://maielld1.github.io/posts/2017/08/Instacart-Kaggle" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">https://maielld1.github.io/posts/2017/08/Instacart-Kaggle</strong></a></li><li id="53c7" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb nj lc ld le bi translated"><strong class="ig hi">ML—insta cart F1 0.38—第二部分；XGBoost+F1 Max:</strong><a class="ae ll" href="https://www.kaggle.com/kokovidis/ml-instacart-f1-0-38-part-two-xgboost-f1-max" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">https://www . ka ggle . com/Koko vidis/ml-insta cart-F1-0-38-part-two-XGBoost-F1-Max</strong></a></li><li id="e116" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb nj lc ld le bi translated"><strong class="ig hi">购物篮分析-关联规则简介:</strong><a class="ae ll" href="https://towardsdatascience.com/a-gentle-introduction-on-market-basket-analysis-association-rules-fa4b986a40ce" rel="noopener" target="_blank"><strong class="ig hi">https://towardsdatascience . com/A-Gentle-Introduction-on-Market-Basket-Analysis-Association-Rules-fa 4b 986 a4ce</strong></a></li></ul><p id="839a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc"> Github资源库:</em></strong><a class="ae ll" href="https://github.com/Chaitanya-Boyalla/Instacart-Market-Basket-Analysis" rel="noopener ugc nofollow" target="_blank">https://Github . com/Chaitanya-Boyalla/insta cart-Market-Basket-Analysis</a></p><p id="71e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">领英:</em></strong><a class="ae ll" href="http://www.linkedin.com/in/chaitanya-boyalla-23051998" rel="noopener ugc nofollow" target="_blank">www.linkedin.com/in/chaitanya-boyalla-23051998</a></p><p id="ff5d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc"><strong class="ig hi">邮箱:</strong></em>chaitanya.boyalla@gmail.com</p></div></div>    
</body>
</html>