<html>
<head>
<title>How to Build a Custom Multivariate Imputation Model in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在机器学习中建立自定义多元插补模型</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/how-to-build-a-custom-multivariate-imputation-model-in-machine-learning-a1322ad4aa82?source=collection_archive---------8-----------------------#2022-06-06">https://medium.com/mlearning-ai/how-to-build-a-custom-multivariate-imputation-model-in-machine-learning-a1322ad4aa82?source=collection_archive---------8-----------------------#2022-06-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c3a20d6f9b0e50b7006d267e56578020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nc-tTk5IFXyvuipNxSD63Q.png"/></div></div></figure><p id="7cf7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">处理数据集的缺失值是数据清理和模型开发过程的重要部分。更常见的是，数据科学家试图通过用均值/中值/众数/零值/常数值替换它们或使用内置的scikit-learn类来避免丢失值，如SimpleImputer，<strong class="ir hi">iterative inputr</strong>(在本文中，我试图建立一个类似于此的模型)，KNNImputer。</p><p id="d9cd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">基于机器学习的缺失数据填补方法通常使用建模来挖掘不完整数据中的有效信息。在本文中，我将介绍如何构建一个自定义的多元插补模型，用于对数据集中的缺失值进行插补。</p><p id="d518" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我将在本文中使用的数据集可以在<a class="ae jn" href="https://www.kaggle.com/datasets/dileep070/heart-disease-prediction-using-logistic-regression" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi"> Kaggle </strong> </a>上找到。此外，您可以在那里参考数据集的详细信息。</p><p id="5ce7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在开始建模之前，下面我已经给出了这种方法的基本流程，以获得主要思想。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es jo"><img src="../Images/1f5973807c629f253a68b78f66f3ec1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*ou8-t58J0FsREVhnpqaVPQ.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">Figure 01:Basic Process</figcaption></figure><p id="f19a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们开始这个过程。</p><p id="fbea" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，让我们首先导入所需的库:</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="32fc" class="kc kd hh jy b fi ke kf l kg kh"><strong class="jy hi">from sklearn.linear_model import LinearRegression<br/>import pandas as pd<br/>import numpy as np</strong></span></pre><p id="04f0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文中，我只构建了一个线性回归模型来预测缺失值。但是，我会给出一个资源来引用可以用于这类问题的算法。</p><p id="d8b7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们将数据读入熊猫数据框:</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="89b2" class="kc kd hh jy b fi ke kf l kg kh"><strong class="jy hi">df=pd.read_csv(‘heart_disease_data.csv’)</strong></span></pre><p id="f75a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们打印前五行数据:</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="77d3" class="kc kd hh jy b fi ke kf l kg kh"><strong class="jy hi">df.head()</strong></span></pre><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ki"><img src="../Images/5cdfbc6d3e5792002600d963e83d61d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cTY8I-zkfl6dKQTYRPCTiw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Figure 02:Dataframe Head values</figcaption></figure><p id="e5f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看数据帧的信息</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="4344" class="kc kd hh jy b fi ke kf l kg kh"><strong class="jy hi">df.info()</strong></span></pre><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kj"><img src="../Images/bb7fb130fef6efbaeb28c4ef59a73b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*OfjjSBAaIxCf_VLUrJqprg.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">Figure 03:Dataframe Information</figcaption></figure><p id="031b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">可以看出，有7列由空值组成。因此，让我们开始构建这些空值的插补模型。</p><p id="570f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，让我们将包含一个或多个空值的数据帧拆分成行。</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="1290" class="kc kd hh jy b fi ke kf l kg kh"><em class="kk">#filter only 1 or more nan values rows and make a sub dataframe</em><br/><strong class="jy hi">df1 = df[df.isna().any(axis=1)]<br/>df1.head()</strong></span></pre><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kl"><img src="../Images/a3775c6b8cc1c16c2a053707baf0f8d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sTRASp3lz7GU6megLqs-Jw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Figure 04:Dataframe which contains 1 or more null values in the rows</figcaption></figure><p id="f949" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们得到不包含任何空值的数据帧(这是在下一阶段训练模型所需要的)</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="36b8" class="kc kd hh jy b fi ke kf l kg kh"><em class="kk">#dataframe which not containing null values</em><br/><strong class="jy hi">df2=df.dropna()<br/>df2</strong></span></pre><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es km"><img src="../Images/a5c2cb98eb04f286691f3a8e3bbba139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IX_4ejQqR6t1nBQ_Vqx7og.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Figure 05:Dataframe which does not contain any null values</figcaption></figure><p id="a8b8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一些行组包含相同位置的相同数量的空值。如果我们可以对这些行进行分组，那么我们就可以减少训练模型的计算量。因此，为了对行进行分组，在代码段下面用0替换空值，用1替换非空值(在<strong class="ir hi"> df1 </strong> dataframe中)。</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="29df" class="kc kd hh jy b fi ke kf l kg kh"><em class="kk">#replace null values to 0 and not null values to 1(purpose:for grouping the rows in the next codes)</em></span><span id="d474" class="kc kd hh jy b fi kn kf l kg kh"><strong class="jy hi">df3=df1.notnull().astype(“int”)<br/>df3.head()</strong></span></pre><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ko"><img src="../Images/51bcf5f3bb71ee0d749f891fdcd3ad65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SowE2T5idy4DTOxEU6nXgA.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx">Figure 06:After replacing df1 with 0s and 1s</figcaption></figure><p id="3d2a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，他们可以使用上述数据框(df3)根据空值位置和数量对行进行分组。下面的代码段做了分组。</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="f7b1" class="kc kd hh jy b fi ke kf l kg kh">#grouping the dataframe based on null value quantity and position<br/><strong class="jy hi">dfGrouped=df3.groupby(list(df3.columns))</strong></span></pre><p id="ca86" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们开始为每组建立一个模型。然后预测并替换空值。下面的代码段给出了整个过程(每一行都有注释)</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="205e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上面的代码中，你可以使用类似的模型(只有<strong class="ir hi">多输出回归</strong>模型，你可以在这里参照详细的<strong class="ir hi"/><a class="ae jn" href="https://machinelearningmastery.com/multi-output-regression-models-with-python/" rel="noopener ugc nofollow" target="_blank"><strong class="ir hi"/></a>)</p><ul class=""><li id="1c56" class="kr ks hh ir b is it iw ix ja kt je ku ji kv jm kw kx ky kz bi translated">线性回归(及相关)</li><li id="844a" class="kr ks hh ir b is la iw lb ja lc je ld ji le jm kw kx ky kz bi translated">KNeighborsRegressor</li><li id="74e2" class="kr ks hh ir b is la iw lb ja lc je ld ji le jm kw kx ky kz bi translated">决策树回归器</li><li id="8698" class="kr ks hh ir b is la iw lb ja lc je ld ji le jm kw kx ky kz bi translated">RandomForestRegressor(及相关)</li></ul><p id="106a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看用预测值替换空值后的数据帧，</p><pre class="jp jq jr js fd jx jy jz ka aw kb bi"><span id="965b" class="kc kd hh jy b fi ke kf l kg kh">finaldf.info()</span></pre><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/4ddba7ec3339491d75bab4741560b7fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*zxF76FgZvJiDqbx2E0e7_g.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx">Figure 07:Dataframe after replacing null values</figcaption></figure><p id="2dfb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此，可以看出，整个数据帧不包含任何空值，这些空值被上面建立的模型(线性回归模型)所替代。您可以根据自己的意愿定制该过程。你可以在这个<a class="ae jn" href="https://github.com/Ravinath98/Multivariate-Imputation-Model" rel="noopener ugc nofollow" target="_blank"> repo </a>里看到完整的源代码。如果你对这篇文章有任何批评，请留下评论。谢谢你。</p><h1 id="72e7" class="lg kd hh bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">参考</h1><ul class=""><li id="2da3" class="kr ks hh ir b is md iw me ja mf je mg ji mh jm kw kx ky kz bi translated">sci kit-学习。2022.<em class="kk"> 6.4。缺失值的插补</em>。[在线]可在:&lt;https://scikit-learn.org/stable/modules/impute.html&gt;[2022年6月5日访问]</li><li id="3a3a" class="kr ks hh ir b is la iw lb ja lc je ld ji le jm kw kx ky kz bi translated">j .布朗利，2022。<em class="kk">如何用Python开发多输出回归模型</em>。[在线]机器学习掌握。可从以下网址获取:&lt;https://machine learning mastery . com/multi-output-regression-models-with-python/&gt;【2022年6月5日获取】</li></ul><div class="mi mj ez fb mk ml"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mm ab dw"><div class="mn ab mo cl cj mp"><h2 class="bd hi fi z dy mq ea eb mr ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ms l"><h3 class="bd b fi z dy mq ea eb mr ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mt l"><p class="bd b fp z dy mq ea eb mr ed ef dx translated">medium.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz in ml"/></div></div></a></div></div></div>    
</body>
</html>