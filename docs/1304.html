<html>
<head>
<title>Understanding and using the class structure for creating models with PyTorch 🔥</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解和使用PyTorch创建模型的类结构🔥</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/understanding-and-using-the-class-structure-for-creating-models-with-pytorch-76e2502e8d7e?source=collection_archive---------0-----------------------#2021-11-18">https://medium.com/mlearning-ai/understanding-and-using-the-class-structure-for-creating-models-with-pytorch-76e2502e8d7e?source=collection_archive---------0-----------------------#2021-11-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/a4bcbd25c9af06a91c2d67904ebbe9b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T8cMcxnsbxF7r8Ur"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@hiteshchoudhary?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Hitesh Choudhary</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0d2a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了在PyTorch中创建通用模型，我们使用<code class="du js jt ju jv b">nn.Sequential</code> API并创建我们的神经网络模型。</p><pre class="jw jx jy jz fd ka jv kb kc aw kd bi"><span id="7e17" class="ke kf hh jv b fi kg kh l ki kj"><strong class="jv hi">model</strong> <strong class="jv hi">=</strong> <strong class="jv hi">nn.Sequential(</strong><br/>          <strong class="jv hi">nn.Conv2d(</strong>1<strong class="jv hi">,</strong>20<strong class="jv hi">,</strong>5<strong class="jv hi">),</strong><br/>          <strong class="jv hi">nn.ReLU(),</strong><br/>          <strong class="jv hi">nn.Conv2d(</strong>20<strong class="jv hi">,</strong>64<strong class="jv hi">,</strong>5<strong class="jv hi">),</strong><br/>          <strong class="jv hi">nn.ReLU()</strong><br/>        <strong class="jv hi">)</strong></span></pre><p id="f3f3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这种结构的问题是，你不能有混合模式。创建复杂的模型，并且您不能完全控制您的模型并在模型上传递数据。</p><p id="3b5f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了完全控制模型并创建一个在真正的机器学习中对我们有帮助的模型，我们可以使用类like结构并从PyTorch模块类继承<code class="du js jt ju jv b">torch.nn.Module</code>来做同样的事情</p><pre class="jw jx jy jz fd ka jv kb kc aw kd bi"><span id="4a1d" class="ke kf hh jv b fi kg kh l ki kj">import torch <br/>import torch.nn as nn </span><span id="1f99" class="ke kf hh jv b fi kk kh l ki kj">class MyModel(torch.nn.Module):<br/>     def __init__(self):<br/>         super(MyModel,self).__init__()<br/>         self.lay1 = nn.Conv2d(1,20,5)<br/>         self.lay2 = nn.Conv2d(20,64,5)<br/>         self.flatten = nn.Flatten()<br/>         self.relu = nn.ReLU()<br/>     <br/>     def forward(self,inputs):<br/>         ins = self.relu(self.lay1(inputs))<br/>         ins = self.relu(self.lay2(ins))<br/>         output = self.flatten(ins)</span></pre><p id="cc33" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这里的优势是您可以完全控制数据如何流入模型。您可以拥有多个层和混合结构，如下图所示</p><figure class="jw jx jy jz fd ii er es paragraph-image"><div class="er es kl"><img src="../Images/09cdfda3be35900ec79a76c13b21e825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*y4pSdFRL8PRWuUfYFS42xg.png"/></div></figure><p id="dae0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当你控制你的模型中的整个数据流时，让我们看一下我们之前代码中的每个部分显示了什么</p><h1 id="ffc0" class="km kf hh bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">类结构中__init__是什么？</h1><p id="64b9" class="pw-post-body-paragraph iu iv hh iw b ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">该方法有助于python中的面向对象编程。这是一个保留的方法，它充当我们类的构造函数。</p><p id="dce7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">构造函数是初始化类中内容的第一件事，当我们创建模型的对象时，它是第一个被调用的方法，并且将使用随机权重初始化我们的Conv和线性层</p><h1 id="5048" class="km kf hh bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">什么叫超级(MyModel，self)。__init__()在做什么？</h1><p id="f98a" class="pw-post-body-paragraph iu iv hh iw b ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated"><code class="du js jt ju jv b">super(MyModel, self).__init__()</code>是指这是<code class="du js jt ju jv b">nn.Module</code>的子类，并且继承了所有方法。定义好这个之后，我们就可以使用PyTorch的<code class="du js jt ju jv b">nn.Module</code>类中已经实现的所有预处理代码了。</p><h2 id="391b" class="ke kf hh bd kn lo lp lq kr lr ls lt kv jf lu lv kz jj lw lx ld jn ly lz lh ma bi translated">简而言之，super方法允许您使用torch.nn.Module类中实现的所有模块。</h2><h1 id="cab8" class="km kf hh bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">课堂上的自我是什么？</h1><p id="4ac1" class="pw-post-body-paragraph iu iv hh iw b ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">self表示类的实例。该属性可用于访问类中定义的属性和方法(函数)。在上面的例子中，我们使用self来声明层，这样我们就可以在forward方法中使用它们。</p><h1 id="501a" class="km kf hh bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">什么是正向法？</h1><p id="149f" class="pw-post-body-paragraph iu iv hh iw b ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn ln jp jq jr ha bi translated">这个方法是我们模型的驱动方法，这是在训练循环中调用我们的模型后，我们层的权重得到更新的地方。</p></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><blockquote class="mi mj mk"><p id="70e8" class="iu iv ml iw b ix iy iz ja jb jc jd je mm jg jh ji mn jk jl jm mo jo jp jq jr ha bi translated">感谢你阅读我的博客:)关注更多，在评论中向我问好，这给了我写更多博客的鼓励:)祝你有美好的一天:)</p></blockquote></div></div>    
</body>
</html>