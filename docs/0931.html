<html>
<head>
<title>A Beginnerâ€™s Guide to Data Pipelines with Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tensorflowæ•°æ®ç®¡é“åˆå­¦è€…æŒ‡å—</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/how-to-use-data-pipelines-with-python-a9b662fadec2?source=collection_archive---------0-----------------------#2021-08-27">https://medium.com/mlearning-ai/how-to-use-data-pipelines-with-python-a9b662fadec2?source=collection_archive---------0-----------------------#2021-08-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="25f0" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">å¦‚ä½•ä½¿ç”¨Tensorflowä¸ºæ–‡æœ¬ã€å›¾åƒå’Œnumpyæ•°ç»„æ•°æ®é›†æ„å»ºæ•°æ®ç®¡é“ï¼Ÿ</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/d1ec91eda6d6a5eeb60cf6c45063aca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OFmtGhO4gBRYUFHW"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@jeremybishop?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jeremy Bishop</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="676e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">åœ¨æ„å»ºæ¨¡å‹æ—¶ï¼Œå°†æ•°æ®è½¬æ¢ä¸ºé€‚å½“çš„æ ¼å¼éå¸¸é‡è¦ã€‚æ•°æ®åˆ†æä¸­æœ€é‡è¦çš„æ­¥éª¤ä¹‹ä¸€æ˜¯æ•°æ®é¢„å¤„ç†ã€‚æ•°æ®é¢„å¤„ç†å ç”¨äº†æ•°æ®ç§‘å­¦å®¶çš„å¤§éƒ¨åˆ†æ—¶é—´ã€‚è‡ªåŠ¨åŒ–æ•°æ®é¢„å¤„ç†æ­¥éª¤ç®€åŒ–äº†æ•°æ®åˆ†æã€‚æ•°æ®ç®¡é“æ˜¯ä»ä¸åŒæ¥æºè·å–åŸå§‹æ•°æ®å¹¶å°†æ•°æ®ç§»åŠ¨åˆ°ç›®çš„åœ°è¿›è¡ŒåŠ è½½ã€è½¬æ¢å’Œåˆ†æçš„ä¸€ç³»åˆ—æ­¥éª¤ã€‚</p><p id="631d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†è®¨è®ºä»¥ä¸‹ä¸»é¢˜</p><ul class=""><li id="ef0b" class="kj kk hh jp b jq jr jt ju jw kl ka km ke kn ki ko kp kq kr bi translated">ä¸ºæ–‡æœ¬æ•°æ®é›†æ„å»ºæ•°æ®ç®¡é“</li><li id="421b" class="kj kk hh jp b jq ks jt kt jw ku ka kv ke kw ki ko kp kq kr bi translated">ä¸ºå½±åƒæ•°æ®é›†æ„å»ºæ•°æ®ç®¡é“</li><li id="4de6" class="kj kk hh jp b jq ks jt kt jw ku ka kv ke kw ki ko kp kq kr bi translated">ä¸ºnumpyæ•°ç»„æ•°æ®é›†æ„å»ºæ•°æ®ç®¡é“</li></ul><p id="3be8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è¯·ä¸è¦å¿˜è®°è®¢é˜…<a class="ae jm" href="https://youtube.com/c/tirendazacademy" rel="noopener ugc nofollow" target="_blank">æˆ‘ä»¬çš„youtubeé¢‘é“</a>ï¼Œåœ¨é‚£é‡Œæˆ‘åˆ›å»ºäº†å…³äºäººå·¥æ™ºèƒ½ã€æ•°æ®ç§‘å­¦ã€æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„å†…å®¹ã€‚</p><p id="62e3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><h1 id="a69e" class="kx ky hh bd kz la lb lc ld le lf lg lh in li io lj iq lk ir ll it lm iu ln lo bi translated">æ–‡æœ¬æ•°æ®é›†çš„æ•°æ®ç®¡é“</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lp"><img src="../Images/92eea9e8bcddb602d68519da3500ad8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_Y5uSlHBmieR7D8Z"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@rvignes?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Romain Vignes</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b781" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è¦åˆ†ææ–‡æœ¬æ•°æ®ï¼Œæ‚¨éœ€è¦æ­£ç¡®åœ°ç»„ç»‡ç›®å½•ç»“æ„ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¿…é¡»å°†è®­ç»ƒæ–‡æœ¬ç»„ç»‡æˆé˜³æ€§å’Œé˜´æ€§ï¼Œä»¥è¿›è¡Œå¦‚ä¸‹æ–‡æœ¬åˆ†ç±»:</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="f813" class="lv ky hh lr b fi lw lx l ly lz">main_directory/<br/>....pos <br/>........pst1.txt <br/>........pst2.txt <br/>....neg <br/>........ngt1.txt <br/>........ngt2.txt</span></pre><p id="bbab" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‚¨å¯ä»¥ä½¿ç”¨TensorFlowä¸­çš„text_dataset_from_directoryæ–¹æ³•ä¸ºæ–‡æœ¬æ•°æ®é›†åˆ›å»ºç®¡é“ã€‚è¿™ä¸ªæ–¹æ³•å°†è¿”å›ä¸€ä¸ª<code class="du ma mb mc lr b"><a class="ae jm" href="https://www.tensorflow.org/api_docs/python/tf/data/Dataset" rel="noopener ugc nofollow" target="_blank">tf.data.Dataset</a></code>ï¼Œå®ƒç»™å‡ºäº†æ¥è‡ªå­ç›®å½•poså’Œnegçš„ä¸€æ‰¹æ–‡æœ¬ã€‚è®©æˆ‘ä»¬æƒ³åˆ°äº’è”ç½‘ç”µå½±æ•°æ®åº“(IMDB)æ•°æ®é›†ï¼Œå°†ç”µå½±è¯„è®ºåˆ†ä¸ºæ­£é¢å’Œè´Ÿé¢ã€‚è¯¥æ•°æ®é›†é€šå¸¸ç”¨äºæ•™æˆæ–‡æœ¬åˆ†æï¼Œç”±25ï¼Œ000æ¡ç”¨äºè®­ç»ƒçš„é«˜åº¦ææ€§ç”µå½±è¯„è®ºå’Œ25ï¼Œ000æ¡ç”¨äºæµ‹è¯•çš„ç”µå½±è¯„è®ºç»„æˆã€‚</p><h2 id="738b" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">ä¸‹è½½æ•°æ®é›†</h2><p id="2f33" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">é¦–å…ˆï¼Œæˆ‘æ¥å¯¼å…¥åº“ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="8f2e" class="lv ky hh lr b fi lw lx l ly lz">import io<br/>import os<br/>import re<br/>import shutil<br/>import string<br/>import tensorflow as tf</span></pre><p id="cdcd" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ç°åœ¨ï¼Œæˆ‘å°†åŠ è½½IMDbæ•°æ®é›†ã€‚å¦‚æœä½ æƒ³ç›´æ¥ä¸‹è½½ï¼Œä½ å¯ä»¥ä½¿ç”¨get_fileæ–¹æ³•ã€‚get_fileæ–¹æ³•ä»ä¸€ä¸ªURLä¸‹è½½ä¸€ä¸ªä¸åœ¨ç¼“å­˜ä¸­çš„æ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œè®©æˆ‘åˆ›å»ºä¸€ä¸ªåä¸ºurlçš„å˜é‡ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="7857" class="lv ky hh lr b fi lw lx l ly lz">url = "https://ai.stanford.edu/~amaas/data/sentiment/aclImdb_v1.tar.gz"</span></pre><p id="7237" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä½¿ç”¨get_fileæ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="e224" class="lv ky hh lr b fi lw lx l ly lz">data = tf.keras.utils.get_file(<br/>          "aclImdb_v1.tar.gz", <br/>          url,<br/>          untar=True, <br/>          cache_dir='.', <br/>          cache_subdir='')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mv"><img src="../Images/e35b5de0fafacd053051ca266de91d71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*WuajGNM0zRN2gs2t_HV46Q.png"/></div></figure><p id="7f88" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å› æ­¤ï¼Œæ•°æ®é›†è¢«ä¸‹è½½ï¼Œå¹¶åœ¨å½“å‰ç›®å½•ä¸­åˆ›å»ºäº†ä¸€ä¸ªåä¸ºaclImdbçš„ç›®å½•ã€‚æˆ‘å°†åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œå®ƒä»£è¡¨è¿™ä¸ªæ–‡ä»¶è·¯å¾„ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="3373" class="lv ky hh lr b fi lw lx l ly lz">data_dir = os.path.join(os.path.dirname(data), 'aclImdb')</span></pre><p id="96d9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘ä»¬çœ‹çœ‹data_dirç›®å½•ä¸­train_dirçš„å†…éƒ¨ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="d436" class="lv ky hh lr b fi lw lx l ly lz">train_dir = os.path.join(data_dir, 'train')<br/>os.listdir(train_dir)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mw"><img src="../Images/340a1a79b28b3d3f57db0415c38b3d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxHJgg8Lj5vkO-NYjKmxWg.png"/></div></div></figure><p id="3b8e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚æ‚¨æ‰€è§ï¼Œæœ‰ä¸€ä¸ªåä¸ºunsupçš„ç›®å½•ã€‚æˆ‘ä¸éœ€è¦unsupç›®å½•ã€‚è®©æˆ‘åˆ é™¤è¿™ä¸ªç›®å½•ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="3932" class="lv ky hh lr b fi lw lx l ly lz">unused_dir = os.path.join(train_dir, 'unsup')<br/>shutil.rmtree(unused_dir)</span></pre><p id="287b" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æˆ‘è¦å»çœ‹çœ‹train_dirã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="50ea" class="lv ky hh lr b fi lw lx l ly lz">os.listdir(train_dir)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mx"><img src="../Images/38c91cc1ba4d3d93dd4c389ff9e01a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SCKXrp_q5uBI0CcuknJATg.png"/></div></div></figure><p id="cb5a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚æ‚¨æ‰€è§ï¼Œunsupå·²ä»æ•°æ®ç›®å½•ä¸­åˆ é™¤ã€‚ç¡®ä¿åªæœ‰ç›®å½•åè¢«ç”¨ä½œæ ‡ç­¾ã€‚è®©æˆ‘çœ‹çœ‹åŸ¹è®­ç›®å½•é‡Œçš„å†…å®¹ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="a9c1" class="lv ky hh lr b fi lw lx l ly lz">ls aclImdb\train</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es my"><img src="../Images/1edfd45df4037dba92976638a3cf32c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3HFFZsztHgsrNz3hXFKIQ.png"/></div></div></figure><p id="7e99" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚ä½ æ‰€è§ï¼Œæœ‰poså’Œnegç›®å½•ã€‚</p><h2 id="de66" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">åˆ›å»ºæ•°æ®ç®¡é“</h2><p id="3121" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">ç°åœ¨æˆ‘è¦åˆ›å»ºä¸€ä¸ªç®¡é“ã€‚é¦–å…ˆï¼Œè®©æˆ‘åˆ›å»ºä¸€ä¸ªbatch_sizeå’Œç§å­å˜é‡:</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="ab9d" class="lv ky hh lr b fi lw lx l ly lz">batch_size = 1024<br/>seed = 123</span></pre><p id="6a2c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‰¹é‡å¤§å°ä½¿ç”¨åœ¨ä¸€æ¬¡è®­ç»ƒè¿­ä»£ä¸­ä½¿ç”¨å¤šå°‘æ ·æœ¬ã€‚æˆ‘æŒ‡å®šäº†seedå‚æ•°æ¥ä»¥ç›¸åŒçš„é¡ºåºä¼ è¾“æ–‡ä»¶ã€‚ç°åœ¨æˆ‘å°†ä½¿ç”¨test_dataset_from_directory()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ•°æ®ç®¡é“ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="a305" class="lv ky hh lr b fi lw lx l ly lz">train_ds = tf.keras.preprocessing.text_dataset_from_directory(    <br/>    'aclImdb/train', <br/>    batch_size = batch_size, <br/>    validation_split=0.2, <br/>    subset='training', <br/>    seed=seed)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mz"><img src="../Images/a8d1a32cef49fa7e929652fc83235d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wu2OY4c2Z5AOYO0uuA4Ddg.png"/></div></div></figure><p id="33d0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‰€ä»¥æˆ‘å¾ˆå®¹æ˜“åœ°ä½¿ç”¨ç®¡é“åˆ›å»ºäº†è®­ç»ƒæ•°æ®é›†ã€‚ä¸ºäº†å¾®è°ƒè¶…å‚æ•°ï¼Œæˆ‘å°†ä½¿ç”¨ä¸€ä¸ªéªŒè¯æ•°æ®é›†ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéªŒè¯æ•°æ®é›†ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="b4bb" class="lv ky hh lr b fi lw lx l ly lz">val_ds = tf.keras.preprocessing.text_dataset_from_directory( <br/>        'aclImdb/train', <br/>        batch_size=batch_size,   <br/>        validation_split=0.2, <br/>        subset='validation', <br/>        seed=seed)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es na"><img src="../Images/da32d83dc113764820eaa5347cd5331e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pxPLDygOY22ARLnmes43Eg.png"/></div></div></figure><h2 id="b47b" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">æ¢ç´¢æ•°æ®é›†</h2><p id="836d" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">ç°åœ¨æˆ‘å°†æ¢ç©¶è¿™äº›æ–‡ä»¶çš„å†…å®¹ã€‚è®©æˆ‘ä»¬åœ¨ç¬¬ä¸€æ‰¹ä¸­éšæœºé€‰æ‹©5è¡Œå¹¶æ‰“å°å‡ºæ¥ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="da9f" class="lv ky hh lr b fi lw lx l ly lz">import random<br/>idx = random.sample(range(1, batch_size), 5)<br/>for text_batch, label_batch in train_ds.take(1):<br/>    for i in idx:<br/>        print(label_batch[i].numpy(),      <br/>              text_batch.numpy()[i])</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nb"><img src="../Images/b7d05ac39dcad748b6765c95add13e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dCLrD9PUJZq82Ztw6SvokQ.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/a70877b87fa9f379c63426e56083a6b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*26lcAkbng1cILbIELPQrsQ.png"/></div></div></figure><p id="b3e7" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ç®¡é“å¤„ç†æ–‡æœ¬æ•°æ®é›†ã€‚å¦‚æ‚¨æ‰€è§ï¼Œä½¿ç”¨ç®¡é“å¯ä»¥è½»æ¾å®Œæˆæ•°æ®é¢„å¤„ç†ã€‚</p><h1 id="7d8e" class="kx ky hh bd kz la lb lc ld le lf lg lh in li io lj iq lk ir ll it lm iu ln lo bi translated">å›¾åƒæ•°æ®é›†çš„æ•°æ®ç®¡é“</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nd"><img src="../Images/06911694befc4be0a079faf40a4c7be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CaB84btm7IyrayVM"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Photo by <a class="ae jm" href="https://unsplash.com/@nowyouknowgini?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">virginia lackinger</a> on <a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7047" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‚¨å¯ä»¥å°†ç®¡é“ç”¨äºå›¾åƒæ¨¡å‹ï¼Œè¯¥æ¨¡å‹å¯ä»¥ä»åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶èšåˆæ•°æ®ï¼Œå¯¹æ¯ä¸ªå›¾åƒåº”ç”¨éšæœºæ‰°åŠ¨ï¼Œå¹¶å°†éšæœºé€‰æ‹©çš„å›¾åƒåˆå¹¶åˆ°ä¸€ä¸ªæ‰¹å¤„ç†ä¸­è¿›è¡Œè®­ç»ƒã€‚</p><p id="72c9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä¾‹å¦‚ï¼Œåœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­æœ‰å¤šä¸ªå›¾åƒã€‚è¯¥æ–‡ä»¶åŒ…æ‹¬ä¸¤åˆ—:ä¸€åˆ—åŒ…å«æ‰€æœ‰æ–‡ä»¶åï¼Œå¦ä¸€åˆ—åŒ…å«æ ‡ç­¾ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­å¤„ç†å›¾åƒæ•°æ®é›†çš„æ•°æ®ç®¡é“ã€‚</p><p id="3c68" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä¸ºäº†å±•ç¤ºå¦‚ä½•ä¸ºå›¾åƒæ•°æ®é›†åˆ›å»ºç®¡é“ï¼Œæˆ‘å°†ä½¿ç”¨<a class="ae jm" href="https://data.mendeley.com/datasets/jxmfrvhpyz/1" rel="noopener ugc nofollow" target="_blank">èŠ±å‰æ•°æ®é›†</a>ã€‚æˆ‘å°†æ•°æ®é›†ä¸‹è½½åˆ°å·¥ä½œç›®å½•ä¸­çš„flower_photosæ–‡ä»¶ä¸­ã€‚</p><h2 id="69ec" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">æ¢ç´¢æ•°æ®é›†</h2><p id="e0eb" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">è®©æˆ‘å¯¼å…¥åº“ï¼Œè¿™å°†åœ¨æœ¬èŠ‚ä¸­ä½¿ç”¨ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="3a2f" class="lv ky hh lr b fi lw lx l ly lz">import tensorflow as tf<br/>import tensorflow_hub as hub<br/>import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt</span></pre><p id="de2f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è¯·æ³¨æ„ï¼Œæ•°æ®é›†æœ‰ä¸€ä¸ªæ ‡ç­¾æ–‡ä»¶ã€‚æˆ‘å°†ä½¿ç”¨ç†ŠçŒ«å›¾ä¹¦é¦†æŸ¥çœ‹å®ƒçš„å†…å®¹ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="397c" class="lv ky hh lr b fi lw lx l ly lz">traindf=pd.read_csv(<br/>    'flower_photos/all_labels.csv',<br/>    dtype=str)<br/># Take a look first five fows of the dataset<br/>traindf.head()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ne"><img src="../Images/9c2f8ad03abed057602681e023e2f472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*ZPUctlPJZt3yAOHlHQ0CtQ.png"/></div></figure><h2 id="9e3f" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">åˆ›å»ºæ•°æ®ç®¡é“</h2><p id="2ddc" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªæ•°æ®ç®¡é“ï¼Œå°†è¿™äº›å›¾åƒè¾“å…¥å›¾åƒåˆ†ç±»æ¨¡å‹ã€‚ä¸ºäº†æ„å»ºæ¨¡å‹ï¼Œæˆ‘å°†ä½¿ç”¨TensorFlow Hubä¸­é¢„å…ˆæ„å»ºçš„ResNetæ¨¡å‹ã€‚</p><p id="7b22" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ç°åœ¨æˆ‘è¦åˆ›å»ºä¸€äº›è¶…å‚æ•°ï¼Œç¨åä¼šç”¨åˆ°ã€‚è¯·æ³¨æ„ï¼ŒResNetæ¨¡å‹æœŸæœ›å›¾åƒçš„åƒç´ å°ºå¯¸ä¸º224*224ï¼Œæˆ‘éœ€è¦ç¡®å®šæ‰¹é‡å¤§å°ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="b9fe" class="lv ky hh lr b fi lw lx l ly lz">data_root = 'flower_photos/flowers'<br/>IMAGE_SIZE = (224, 224)<br/>TRAINING_DATA_DIR = str(data_root)<br/>BATCH_SIZE = 32</span></pre><p id="db22" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘ä»¬æ ‡å‡†åŒ–æ•°æ®é›†ï¼Œå¹¶ä¸ºéªŒè¯æ•°æ®é›†ä¿ç•™20%çš„å›¾åƒã€‚è®©æˆ‘ç”¨ä¸€ä¸ªå­—å…¸ç»“æ„ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="42f0" class="lv ky hh lr b fi lw lx l ly lz">datagen_kwargs = dict(<br/>    rescale=1./255, <br/>    validation_split=.20)</span></pre><p id="ba89" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ç°åœ¨è®©æˆ‘åˆ›å»ºä¸€ä¸ªæ–°å˜é‡ï¼Œå¹¶å°†datagen_kwargsä¼ é€’åˆ°è¿™ä¸ªå˜é‡ä¸­ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="0b7e" class="lv ky hh lr b fi lw lx l ly lz">dataflow_kwargs = dict(<br/>    target_size=IMAGE_SIZE,<br/>    batch_size=BATCH_SIZE, <br/>    interpolation="bilinear")</span></pre><p id="3aa7" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æ‚¨å¯ä»¥ä½¿ç”¨ImageDataGeneratorå°†è¿™äº›å›¾åƒæµå¼ä¼ è¾“åˆ°åŸ¹è®­è¿‡ç¨‹ä¸­ã€‚ä¸ºæ­¤ï¼Œæˆ‘å°†å®šä¹‰ä¸€ä¸ªç”Ÿæˆå™¨ï¼Œå¹¶å°†datagen_kwargsä¼ é€’ç»™è¿™ä¸ªç”Ÿæˆå™¨ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="6aa4" class="lv ky hh lr b fi lw lx l ly lz">train_datagen =   tf.keras.preprocessing.image.ImageDataGenerator(<br/>**datagen_kwargs)</span></pre><p id="f384" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ä¸ºäº†åˆ›å»ºæ•°æ®ç®¡é“ï¼Œæˆ‘å°†ä½¿ç”¨flow_from_dataframeæ–¹æ³•ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="bee9" class="lv ky hh lr b fi lw lx l ly lz">train_generator = train_datagen.flow_from_dataframe(<br/>    dataframe=traindf, <br/>    directory=data_root, <br/>    x_col="file_name", <br/>    y_col="label", <br/>    subset="training", <br/>    seed=10, shuffle=True, <br/>    class_mode="categorical", <br/>    **dataflow_kwargs)</span></pre><h2 id="0089" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">æ£€æŸ¥æ•°æ®é›†</h2><p id="582c" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">è®©æˆ‘å±•ç¤ºæ•°æ®é›†ä¸­çš„å›¾åƒã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="d3c3" class="lv ky hh lr b fi lw lx l ly lz">image_batch, label_batch = next(iter(train_generator))<br/>fig, axes = plt.subplots(8, 4, figsize=(20, 40))<br/>axes = axes.flatten()<br/>for img, lbl, ax in zip(image_batch, label_batch, axes):<br/>    ax.imshow(img)<br/>    label_ = np.argmax(lbl)<br/>    label = idx_labels[label_]<br/>    ax.set_title(label)<br/>    ax.axis('off')<br/>    plt.show()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nf"><img src="../Images/78a94c850e5d95be2d366ddcc6287662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smjYJmUtURcyslzaKv6nJQ.png"/></div></div></figure><p id="bc8f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å› æ­¤ï¼Œæ•°æ®æ¥æ”¶ç®¡é“å·²ç»å¯ä»¥ä½¿ç”¨äº†ã€‚è®©æˆ‘ä»¬è®­ç»ƒæ¨¡å‹ã€‚</p><h2 id="ec05" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">è®­ç»ƒæ¨¡å‹</h2><p id="9883" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">æˆ‘å°†ä½¿ç”¨ResNetæ¨¡å‹æ¥æ„å»ºæ¨¡å‹ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="b050" class="lv ky hh lr b fi lw lx l ly lz">model = tf.keras.Sequential([<br/>    tf.keras.layers.InputLayer(<br/>        input_shape=IMAGE_SIZE + (3,)),<br/>    hub.KerasLayer( <br/>        "https://tfhub.dev/tensorflow/resnet_50/feature_vector/1", trainable=False),<br/>    tf.keras.layers.Dense(<br/>        5, activation='softmax', <br/>        name = 'custom_class')])<br/>model.build([None, 224, 224, 3])</span></pre><p id="5a6d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘ä»¬ç¼–è¯‘æ¨¡å‹ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="7837" class="lv ky hh lr b fi lw lx l ly lz">model.compile(<br/>    optimizer=tf.keras.optimizers.SGD(lr=0.005, momentum=0.9),       <br/>    loss=tf.keras.losses.CategoricalCrossentropy(<br/>        from_logits=True, label_smoothing=0.1), <br/>    metrics=['accuracy'])</span></pre><p id="38bd" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">ç°åœ¨æˆ‘è¦è®­ç»ƒæ¨¡å‹äº†ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="d7e6" class="lv ky hh lr b fi lw lx l ly lz">steps_per_epoch = train_generator.samples // train_generator.batch_size</span><span id="0625" class="lv ky hh lr b fi ng lx l ly lz">validation_steps = valid_generator.samples // valid_generator.batch_size</span><span id="8d18" class="lv ky hh lr b fi ng lx l ly lz">model.fit(<br/>    train_generator, <br/>    epochs=13, <br/>    steps_per_epoch=steps_per_epoch,   <br/>    validation_data=valid_generator, <br/>    validation_steps=validation_steps)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nh"><img src="../Images/e1e02c6de3235a9edfe14c803885e4e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KSeAhGkl8rQwH3gGE5P4MA.png"/></div></div></figure><p id="23d1" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚æ‚¨æ‰€è§ï¼Œè®­ç»ƒå›¾åƒç”Ÿæˆå™¨å’ŒéªŒè¯å›¾åƒç”Ÿæˆå™¨è¢«ä¼ é€’åˆ°è®­ç»ƒè¿‡ç¨‹ä¸­ã€‚è®­ç»ƒç²¾åº¦å’ŒéªŒè¯ç²¾åº¦éƒ½å¯ä»¥ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å±•ç¤ºäº†å¦‚ä½•å¯¹å›¾åƒæ•°æ®é›†ä½¿ç”¨æ•°æ®æ¥æ”¶ç®¡é“ã€‚</p><h1 id="0d14" class="kx ky hh bd kz la lb lc ld le lf lg lh in li io lj iq lk ir ll it lm iu ln lo bi translated">NumPyæ•°ç»„æ•°æ®é›†çš„æ•°æ®ç®¡é“</h1><p id="84b3" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å·²ç»çœ‹åˆ°äº†å¦‚ä½•å°†æ•°æ®ç®¡é“ç”¨äºæ–‡æœ¬å’Œå›¾åƒæ•°æ®é›†ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ä¸ºNumPyæ•°ç»„æ•°æ®é›†åˆ›å»ºæ•°æ®ç®¡é“ã€‚ä¸ºæ­¤ï¼Œæˆ‘å°†ä½¿ç”¨from_tensor_slicesæ–¹æ³•ã€‚</p><p id="1530" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘ä»¬ä½¿ç”¨æ—¶å°šMNISTæ•°æ®é›†ï¼Œå®ƒç”±10ç§ç°åº¦æœè£…ç»„æˆã€‚è¿™äº›å›¾åƒä½¿ç”¨NumPyç»“æ„è¡¨ç¤ºï¼Œè€Œä¸æ˜¯å…¸å‹çš„å›¾åƒæ ¼å¼ï¼Œå¦‚JPEGæˆ–PNGã€‚ä½ å¯ä»¥ç”¨tfè½»æ¾ä¸‹è½½ã€‚Keras APIã€‚</p><h2 id="171c" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">åŠ è½½æ•°æ®é›†</h2><p id="ea18" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">é¦–å…ˆï¼Œæˆ‘æ¥å¯¼å…¥åº“ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="08c0" class="lv ky hh lr b fi lw lx l ly lz">import tensorflow as tf<br/>import numpy as np<br/>import matplotlib.pyplot as plt</span></pre><p id="085e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘ä»¬ä½¿ç”¨tf.keras APIä¸­çš„load_dataå‡½æ•°åŠ è½½æ•°æ®é›†ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="ada2" class="lv ky hh lr b fi lw lx l ly lz">fashion_mnist = tf.keras.datasets.fashion_mnist<br/>(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data()</span></pre><p id="c294" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘çœ‹çœ‹æ•°æ®é›†çš„ç»“æ„ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="bcff" class="lv ky hh lr b fi lw lx l ly lz">print(type(train_images), type(train_labels))</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ni"><img src="../Images/27b181ac94ae0376ee5867437637a543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VIJS--ymIvuWXFOsEHddA.png"/></div></div></figure><p id="9b7a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚æ‚¨æ‰€è§ï¼Œæ•°æ®é›†çš„ç»“æ„æ˜¯NumPyæ•°ç»„ã€‚ç°åœ¨ï¼Œæˆ‘å°†ä½¿ç”¨shapeå±æ€§æŸ¥çœ‹æ•°æ®é›†çš„å½¢çŠ¶ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="3844" class="lv ky hh lr b fi lw lx l ly lz">print(train_images.shape, train_labels.shape)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nj"><img src="../Images/696e28d43b14d9e8ecf7173bf7536169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*pMAT2nWwcG91S9EcbJ0cEQ.png"/></div></div></figure><h2 id="bd29" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">æ¢ç´¢æ•°æ®é›†</h2><p id="3cf4" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">ä¸ºäº†å¯è§†åŒ–ä¸€ä¸ªNumPyæ•°ç»„ï¼Œæˆ‘å°†ä½¿ç”¨matplotlibåº“ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="488f" class="lv ky hh lr b fi lw lx l ly lz">plt.figure()<br/>plt.imshow(train_images[5])<br/>plt.colorbar()<br/>plt.grid(False)<br/>plt.show()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nk"><img src="../Images/b010eb57df2f9e8326fdc67bddbe92b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*mFG8u5sFRnwp1jPWbXOsJw.png"/></div></figure><h2 id="6dad" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">é¢„å¤„ç†æ•°æ®é›†</h2><p id="aab0" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">å›¾åƒç”±0åˆ°255ä¹‹é—´çš„åƒç´ å€¼ç»„æˆã€‚ä¸ºäº†æ›´å¿«åœ°æ„å»ºæ¨¡å‹å¹¶è·å¾—æ›´å¥½çš„å‡†ç¡®æ€§ï¼Œæˆ‘å°†å¯¹åƒç´ å€¼è¿›è¡Œå½’ä¸€åŒ–ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="2892" class="lv ky hh lr b fi lw lx l ly lz">train_images = train_images/255</span></pre><p id="c40e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">æˆ‘å°†ä½¿ç”¨from_tensor_slicesæ–¹æ³•å»ºç«‹ä¸€ä¸ªæµç®¡é“ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="aa3f" class="lv ky hh lr b fi lw lx l ly lz">train_dataset = tf.data.Dataset.from_tensor_slices(<br/>        (train_images, train_labels))</span></pre><p id="c8af" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">è®©æˆ‘å°†è¿™ä¸ªæ•°æ®é›†åˆ†æˆè®­ç»ƒé›†å’ŒéªŒè¯é›†ã€‚è¶…å‚æ•°ç”¨éªŒè¯æ•°æ®é›†å¾®è°ƒï¼Œæ¨¡å‹ç”¨è®­ç»ƒæ•°æ®é›†å»ºç«‹ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="0097" class="lv ky hh lr b fi lw lx l ly lz">SHUFFLE_BUFFER_SIZE = 10000<br/>TRAIN_BATCH_SIZE = 50<br/>VALIDATION_BATCH_SIZE = 10000</span><span id="e734" class="lv ky hh lr b fi ng lx l ly lz">#Creating the data pipelines<br/>validation_ds = train_dataset.shuffle( SHUFFLE_BUFFER_SIZE).take( VALIDATION_SAMPLE_SIZE).batch(VALIDATION_BATCH_SIZE)</span><span id="1f4b" class="lv ky hh lr b fi ng lx l ly lz">train_ds = train_dataset.skip( VALIDATION_BATCH_SIZE).batch( TRAIN_BATCH_SIZE).repeat()</span></pre><h2 id="ebae" class="lv ky hh bd kz md me mf ld mg mh mi lh jw mj mk lj ka ml mm ll ke mn mo ln mp bi translated">æ„å»ºæ¨¡å‹</h2><p id="06f6" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">æ•°æ®é›†å·²å‡†å¤‡å¥½æ„å»ºæ¨¡å‹ã€‚ä¸ºäº†è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘å°†ä½¿ç”¨åºåˆ—æ¨¡å‹ã€‚</p><pre class="ix iy iz ja fd lq lr ls lt aw lu bi"><span id="15c0" class="lv ky hh lr b fi lw lx l ly lz"># Build the model<br/>model = tf.keras.Sequential([<br/>    tf.keras.layers.Flatten(input_shape=(28, 28)),    <br/>    tf.keras.layers.Dense(30, activation='relu'),   <br/>    tf.keras.layers.Dense(10)</span><span id="9781" class="lv ky hh lr b fi ng lx l ly lz"># Compiling the model<br/>model.compile(<br/>    optimizer=tf.keras.optimizers.RMSprop(),   <br/>    loss=tf.keras.losses.SparseCategoricalCrossentropy( from_logits=True), <br/>    metrics=['sparse_categorical_accuracy'])</span><span id="7ca8" class="lv ky hh lr b fi ng lx l ly lz">#Trainging the model<br/>model.fit(<br/>    train_ds, <br/>    epochs=13, <br/>    steps_per_epoch=steps_per_epoch,    <br/>    validation_data=validation_ds,   <br/>    validation_steps=validation_steps)</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nl"><img src="../Images/40515f9665931305c0431584971bd7ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WDIGY24ocHrieryU-NuGRA.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/5d9e413a873653155c1cbd03568423bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-v1gvxmpN_GNmRYrc3H4eQ.png"/></div></div></figure><p id="8493" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å› æ­¤train_dså’Œvalidation_dsè¢«ä¼ é€’åˆ°è®­ç»ƒè¿‡ç¨‹ä¸­ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨from_tensor_slicesä¸ºåŒ…å«NumPyæ•°ç»„çš„æ•°æ®é›†åˆ›å»ºæ•°æ®ç®¡é“ã€‚</p><h1 id="e750" class="kx ky hh bd kz la lb lc ld le lf lg lh in li io lj iq lk ir ll it lm iu ln lo bi translated">æ‘˜è¦</h1><p id="dd55" class="pw-post-body-paragraph jn jo hh jp b jq mq ii js jt mr il jv jw ms jy jz ka mt kc kd ke mu kg kh ki ha bi translated">æ‚¨å¯ä»¥ä½¿ç”¨æ–‡æœ¬ã€å›¾åƒå’ŒNumpyæ•°ç»„æ•°æ®é›†çš„æ•°æ®ç®¡é“è½»æ¾æ„å»ºæ¨¡å‹ã€‚ä½¿ç”¨æ•°æ®ç®¡é“ï¼Œæ‚¨å¯ä»¥ä»å­˜å‚¨æ•°æ®çš„ä½ç½®è®¿é—®æ•°æ®ï¼Œè½¬æ¢ã€ç¼©æ”¾æ•°æ®ï¼Œç„¶åå°†æ•°æ®ä¼ é€’ç»™æ¨¡å‹ã€‚</p></div><div class="ab cl nm nn go no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ha hb hc hd he"><p id="0c04" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">åœ¨è¿™é‡Œå¯ä»¥æ‰¾åˆ°ç¬”è®°æœ¬<a class="ae jm" href="https://github.com/TirendazAcademy/DEEP-LEARNING-WITH-TENSORFLOW/blob/main/08-How%20to%20Use%20Data%20Pipelines%20with%20Python.ipynb" rel="noopener ugc nofollow" target="_blank">ã€‚æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢å®ƒã€‚åˆ«å¿˜äº†å…³æ³¨æˆ‘ä»¬çš„</a><a class="ae jm" href="https://youtube.com/c/TirendazAcademy" rel="noopener ugc nofollow" target="_blank">YouTube</a>|<a class="ae jm" href="https://github.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">GitHub</a>||<a class="ae jm" href="https://twitter.com/TirendazAcademy" rel="noopener ugc nofollow" target="_blank">|<em class="nt">Twitter</em></a><em class="nt"/>|<a class="ae jm" href="https://www.kaggle.com/tirendazacademy" rel="noopener ugc nofollow" target="_blank">ka ggle</a>|<em class="nt">|</em><a class="ae jm" href="https://www.linkedin.com/in/tirendaz-academy" rel="noopener ugc nofollow" target="_blank"><em class="nt">LinkedIn</em></a><em class="nt"/>ğŸ‘</p><div class="nu nv ez fb nw nx"><a href="https://levelup.gitconnected.com/7-differences-between-deep-learning-and-machine-learning-b5f2ff0ae00a" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab dw"><div class="nz ab oa cl cj ob"><h2 class="bd hi fi z dy oc ea eb od ed ef hg bi translated">æ·±åº¦å­¦ä¹ å’Œæœºå™¨å­¦ä¹ çš„7ä¸ªåŒºåˆ«</h2><div class="oe l"><h3 class="bd b fi z dy oc ea eb od ed ef dx translated">æ·±åº¦å­¦ä¹ ä¸æœºå™¨å­¦ä¹ â€”â€”æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3></div><div class="of l"><p class="bd b fp z dy oc ea eb od ed ef dx translated">levelup.gitconnected.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol jg nx"/></div></div></a></div><div class="nu nv ez fb nw nx"><a rel="noopener follow" target="_blank" href="/geekculture/6-steps-to-become-a-machine-learning-expert-5a1f155f7207"><div class="ny ab dw"><div class="nz ab oa cl cj ob"><h2 class="bd hi fi z dy oc ea eb od ed ef hg bi translated">æˆä¸ºæœºå™¨å­¦ä¹ ä¸“å®¶çš„6ä¸ªæ­¥éª¤</h2><div class="oe l"><h3 class="bd b fi z dy oc ea eb od ed ef dx translated">æˆä¸ºæœºå™¨å­¦ä¹ ä¸“å®¶éœ€è¦çŸ¥é“çš„ä¸€åˆ‡ã€‚</h3></div><div class="of l"><p class="bd b fp z dy oc ea eb od ed ef dx translated">medium.com</p></div></div><div class="og l"><div class="om l oi oj ok og ol jg nx"/></div></div></a></div><h1 id="18f5" class="kx ky hh bd kz la lb lc ld le lf lg lh in li io lj iq lk ir ll it lm iu ln lo bi translated">èµ„æº</h1><ul class=""><li id="6f5f" class="kj kk hh jp b jq mq jt mr jw on ka oo ke op ki ko kp kq kr bi translated"><a class="ae jm" href="https://www.oreilly.com/library/view/tensorflow-2-pocket/9781492089179/" rel="noopener ugc nofollow" target="_blank"> TensorFlow 2è¢–çå‚è€ƒ</a></li><li id="e2b9" class="kj kk hh jp b jq ks jt kt jw ku ka kv ke kw ki ko kp kq kr bi translated"><a class="ae jm" href="https://www.tensorflow.org/tutorials" rel="noopener ugc nofollow" target="_blank"> TensorFlowæ•™ç¨‹</a></li></ul><p id="fb7a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">å¦‚æœè¿™ç¯‡æ–‡ç« æœ‰å¸®åŠ©ï¼Œè¯·ç‚¹å‡»æ‹æ‰‹ğŸ‘æŒ‰é’®å‡ ä¸‹ï¼Œä»¥ç¤ºæ”¯æŒğŸ‘‡</p></div></div>    
</body>
</html>