<html>
<head>
<title>Spam Detection: Quick and easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">垃圾邮件检测:快速简单</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/spam-detection-quick-and-easy-7e8b3ba0cf11?source=collection_archive---------4-----------------------#2022-05-26">https://medium.com/mlearning-ai/spam-detection-quick-and-easy-7e8b3ba0cf11?source=collection_archive---------4-----------------------#2022-05-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/def6a6274f297ac09f537fa34753660b.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*AaLHumkcubAGPEeYuVx_Pw.jpeg"/></div></figure><p id="e9e5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">机器学习帮助谷歌能够将垃圾信息与非垃圾信息区分开来。有人可能会认为快速建造一个是一项艰巨的任务。在这篇文章中，我将试图向你展示这是一个非常简单的过程。正如我过去一直做的那样，我将使用机器学习工作流来解释它，可以在下图中看到。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es ie"><img src="../Images/0a9a7b23e41b73521dfd414cf1c11018.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*srdrRQ3-7-4KjIKMdgNcnQ.jpeg"/></div></figure><p id="f2ae" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在开始之前，让我们导入相关的库</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es jn"><img src="../Images/da3cdf22cf5586db311b5eb261b4e2bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*ReJ_tBh-l9_T60J5GdbDIg.png"/></div></div></figure><h2 id="c8f0" class="js jt hh bd ju jv jw jx jy jz ka kb kc iw kd ke kf ja kg kh ki je kj kk kl km bi translated"><strong class="ak">数据收集</strong></h2><p id="91c5" class="pw-post-body-paragraph il im hh in b io kn iq ir is ko iu iv iw kp iy iz ja kq jc jd je kr jg jh ji ha bi translated">本项目中使用的数据集来自kaggle.com。在这个项目中使用的所有资源将在下面的资源部分。数据集包含文本及其对应的类，即“垃圾邮件”或“垃圾邮件”。使用pandas库加载数据集。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/80a6845dcbce284ef2ae7ca403a7e05a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*5fatDG20i0im3sJeN7Q90Q.png"/></div></figure><blockquote class="kt ku kv"><p id="f0c3" class="il im kw in b io ip iq ir is it iu iv kx ix iy iz ky jb jc jd kz jf jg jh ji ha bi translated">NB:正如我们已经看到的，数据需要清理，这让我们进入下一个阶段。</p></blockquote><h2 id="f4e9" class="js jt hh bd ju jv jw jx jy jz ka kb kc iw kd ke kf ja kg kh ki je kj kk kl km bi translated">数据清理和预处理</h2><p id="c955" class="pw-post-body-paragraph il im hh in b io kn iq ir is ko iu iv iw kp iy iz ja kq jc jd je kr jg jh ji ha bi translated">寻找和数据集。我们有3个不相关的列，列名不够详细。所以用熊猫，正如你在下面看到的，两者都被解决了。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es la"><img src="../Images/d44bcc7d3cdac06ee8880e60d9bb5726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*--jYySdMtHduY9WZVKZGxg.png"/></div></figure><p id="2bd8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在继续之前，让我们检查呼叫不平衡。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lb"><img src="../Images/3b235538e5665a14fa2d505dd2431cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*F_t1x5U3M3wBk89QkCmmUw.png"/></div></div></figure><p id="5825" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">正如我们所看到的，类之间存在巨大的不平衡，在评估我们模型的性能时必须注意到这一点。</p><h2 id="e68e" class="js jt hh bd ju jv jw jx jy jz ka kb kc iw kd ke kf ja kg kh ki je kj kk kl km bi translated">特征提取和特征选择</h2><p id="7221" class="pw-post-body-paragraph il im hh in b io kn iq ir is ko iu iv iw kp iy iz ja kq jc jd je kr jg jh ji ha bi translated">机器学习算法只处理数字，而我们的数据集包含文本。由于我们的“Class”列只包含“spam”和“ham ”,一个简单的映射应该就可以了。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es lc"><img src="../Images/3c13d67c70c9d8a40953ccfbaa8699a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*aTTSBrWlIx9NVjCY2b13dw.png"/></div></figure><p id="7819" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">接下来，我们决定将数据集分成因变量和自变量。然后分成训练集和测试集。顾名思义，训练集将用于训练我们的模型，测试集将用于测试我们的模型的性能。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ld"><img src="../Images/8a7ebd4169b85f0a1204c39f166a39ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VODkrPpRvgAuvYs8_SSvA.png"/></div></div></figure><blockquote class="kt ku kv"><p id="cbf5" class="il im kw in b io ip iq ir is it iu iv kx ix iy iz ky jb jc jd kz jf jg jh ji ha bi translated">注意:在这一点上,“文本”列仍然包含文本而不是数字。</p></blockquote><p id="780a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，我们使用sklearn中的计数矢量器类将“文本”列转换成数字。如果你不知道计数矢量器类是如何工作的，我会在下面的链接和文章中很好地解释这一点。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es le"><img src="../Images/29dc72555b77640ece1e4be7d74d8f98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*KCNybwrtGpGTHvv7zvWpJg.png"/></div></figure><p id="37df" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在是最简单的部分。</p><h2 id="31e6" class="js jt hh bd ju jv jw jx jy jz ka kb kc iw kd ke kf ja kg kh ki je kj kk kl km bi translated">分类模型</h2><p id="2071" class="pw-post-body-paragraph il im hh in b io kn iq ir is ko iu iv iw kp iy iz ja kq jc jd je kr jg jh ji ha bi translated">NB:重要的部分来了。在sklearn的朴素贝叶斯模块中，有三种常用的分类器，分别是MultinomialNB、GaussianNB和BernoulliNB。</p><blockquote class="lf"><p id="acea" class="lg lh hh bd li lj lk ll lm ln lo ji dx translated">BernoulliNB最适合二进制数据，多项式iNB最适合分类数据，这就是我们使用它的原因，而GaussianNB最适合连续数据。</p></blockquote><figure class="lq lr ls lt lu ii er es paragraph-image"><div class="er es lp"><img src="../Images/192fd64ef0b9b3907b307ba76b4423ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*cw6wyYfo7FAYaWrkPllb7A.png"/></div></figure><p id="24cf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在到最后一个阶段。</p><h2 id="97e1" class="js jt hh bd ju jv jw jx jy jz ka kb kc iw kd ke kf ja kg kh ki je kj kk kl km bi translated">检查模型的性能</h2><figure class="jj jk jl jm fd ii er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es lv"><img src="../Images/b509080a1196a17fe389f85a89260db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A4IPQ7yoB7cKONolHoLANg.png"/></div></div></figure><p id="228e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在我们可以看到，训练集和测试集都有99%的准确率。但是不要被这个骗了。我们正在处理的数据集是不平衡的，即使模型预测所有的类都是“ham ”,准确性也会很高。为了更好地了解准确性，我们需要使用混淆矩阵。这里，我们决定创建一个可视化混淆矩阵的函数。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es lw"><img src="../Images/e781581635619fd1da950007af5a149a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*Wh6RdW7jLeEp0POoHjnZ2Q.png"/></div></figure><p id="6330" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">使用函数来可视化我们的混淆矩阵</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/67e246f4b48d6defa400b5f1899037f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*NwTJs7U66maeYfY33dioBQ.png"/></div></figure><p id="957a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">通过这种可视化，我们可以看到，该模型仅将3封垃圾邮件误分类为ham，并将9封ham邮件误分类为垃圾邮件。</p><h2 id="72a4" class="js jt hh bd ju jv jw jx jy jz ka kb kc iw kd ke kf ja kg kh ki je kj kk kl km bi translated">额外的</h2><p id="7923" class="pw-post-body-paragraph il im hh in b io kn iq ir is ko iu iv iw kp iy iz ja kq jc jd je kr jg jh ji ha bi translated">只是为了好玩，我们已经决定使用word cloud来绘制垃圾邮件和火腿消息。</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/f4563cdbeec6cf66b2b4d4974fa4c8f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*ogcfDJCiGoQjaH7CdGHvBA.png"/></div></figure><p id="5821" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">对于垃圾邮件:</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/5a220e0fc81cd8e435bef9c6d83600f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*AuimUEvb3y_ttoPw8HP0WQ.png"/></div></figure><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/c5cd1387a4a5694c11620037a68c83db.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*9zkwuLPj-dWyEIWNQk5nJg.png"/></div></figure><p id="99a8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">对于火腿:</p><figure class="jj jk jl jm fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/233d0f0468f8ab0233928f044057495f.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*xNGMtpR52AhRMIOxudBbjA.png"/></div></figure><h2 id="dddd" class="js jt hh bd ju jv jw jx jy jz ka kb kc iw kd ke kf ja kg kh ki je kj kk kl km bi translated">资源:</h2><p id="ae33" class="pw-post-body-paragraph il im hh in b io kn iq ir is ko iu iv iw kp iy iz ja kq jc jd je kr jg jh ji ha bi translated">计数矢量器:"<a class="ae mc" href="https://towardsdatascience.com/basics-of-countvectorizer-e26677900f9c" rel="noopener" target="_blank">https://towards data science . com/basics-of-count矢量器-e26677900f9c </a>"</p><p id="8e94" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">GitHub:【github.com】oluwatomsin/Spam _ Detection:这包含了一个垃圾邮件检测模型的代码</p><div class="md me ez fb mf mg"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mh ab dw"><div class="mi ab mj cl cj mk"><h2 class="bd hi fi z dy ml ea eb mm ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mn l"><h3 class="bd b fi z dy ml ea eb mm ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mo l"><p class="bd b fp z dy ml ea eb mm ed ef dx translated">medium.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu ij mg"/></div></div></a></div></div></div>    
</body>
</html>