<html>
<head>
<title>Flight Fare Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">航班票价预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/flight-fare-predictions-b1150fdc45a3?source=collection_archive---------0-----------------------#2021-12-02">https://medium.com/mlearning-ai/flight-fare-predictions-b1150fdc45a3?source=collection_archive---------0-----------------------#2021-12-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a1e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">详细探索性数据分析(EDA)</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/4933cc19ede704db0af20f805b18167f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ea1QU0yDUHYjtuon"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Image source <a class="ae js" href="https://www.pexels.com/photo/a380-air-airbus-aircraft-358220/" rel="noopener ugc nofollow" target="_blank">here</a></figcaption></figure><h2 id="df66" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated"><strong class="ak">目标</strong></h2><p id="cc55" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">本文的目标是基于各种变量预测航班价格。这篇文章中使用的数据可以在Kaggle上找到。因为价格是目标或因变量，这将是一个回归问题(连续数值)。</p><h2 id="d7fa" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated"><strong class="ak">简介:</strong></h2><p id="76e4" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">近年来，坐飞机的人数急剧增加。由于许多变量，价格会动态变化，这使得航空公司很难维持价格。因此，我们将尝试使用机器学习来解决这个问题。这可以帮助航空公司确定他们可以保持什么样的费率。顾客也可以用它来预测未来的机票价格，并适当地计划他们的旅行。</p><h2 id="538d" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated"><strong class="ak">数据集:</strong></h2><p id="97f7" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">来源:<a class="ae js" href="https://www.kaggle.com/nikhilmittal/flight-fare-prediction-mh" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/nikhilmittal/flight-fare-prediction-MH</a></p><p id="6e66" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里有两个数据集:训练集和测试集。</p><h2 id="7c39" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated"><strong class="ak">方法:</strong></h2><ol class=""><li id="8049" class="kt ku hh ig b ih ko il kp ip kv it kw ix kx jb ky kz la lb bi translated">导入培训数据</li><li id="33a5" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">数据预处理</li><li id="2ab0" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">导入测试数据和数据预处理</li><li id="4e99" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">创建自变量和因变量</li><li id="9d2c" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">功能选择</li><li id="643b" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">模型结构</li><li id="d55b" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">超参数调谐</li><li id="6b3c" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb ky kz la lb bi translated">结论</li></ol><h1 id="a372" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated">1.导入数据集</h1><p id="6216" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">由于数据是excel文件的形式，我们必须使用“pandas.read_excel”加载数据并将其存储在数据框train_data中。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="b6cc" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Import Dataset</em><br/>train_data<strong class="lz hi">=</strong>pd<strong class="lz hi">.</strong>read_excel("Data_Train.xlsx")</span><span id="04aa" class="jt ju hh lz b fi mi me l mf mg"><em class="mh"># lets look at datset of first 5 rows</em><br/>train_data<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mj"><img src="../Images/225c0f9a02fae4f7ac8864b99c146c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QXgXb0ZL0X0vTPtddKh5Hw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Training data</figcaption></figure><h1 id="7458" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> 2。数据预处理:</strong></h1><p id="af13" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">将原始数据转换成易于理解的格式的过程称为数据准备。我们不能处理原始数据，因此这是数据挖掘中的一个关键阶段。在使用机器学习或数据挖掘方法之前，确保数据质量良好。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="34ac" class="jt ju hh lz b fi md me l mf mg"># Shape of the data<br/>train_data<strong class="lz hi">.</strong>shape</span><span id="4ed0" class="jt ju hh lz b fi mi me l mf mg"># Data information<br/>train_data<strong class="lz hi">.</strong>info()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mk"><img src="../Images/d3dc5ba83dc07068850f14e62b936c08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*nRFtn86NTj17ag-2acnjnA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Data types</figcaption></figure><p id="5fc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">变量数量= 11 <br/>行数= 10683 <br/>分类特征类型数量= 10 <br/>数字特征类型数量= 1</p><h1 id="dc20" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> 2.1缺失值:</strong></h1><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="40ed" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#checking for null values in dataset</em><br/>train_data<strong class="lz hi">.</strong>isnull()<strong class="lz hi">.</strong>sum()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ml"><img src="../Images/5c2b82a4291213373d3db9a79552cd64.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*E9WOBQFhPu5k_zqXDS01bA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Missing values</figcaption></figure><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="a053" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># we will drop the nan values</em><br/>train_data<strong class="lz hi">.</strong>dropna(inplace<strong class="lz hi">=True</strong>)<br/>train_data<strong class="lz hi">.</strong>isnull()<strong class="lz hi">.</strong>sum()</span></pre><p id="c769" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为只缺少一个值，所以我们可以删除它。</p><h1 id="5c74" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> 2.2转换为日期时间:</strong></h1><ul class=""><li id="3eef" class="kt ku hh ig b ih ko il kp ip kv it kw ix kx jb mm kz la lb bi translated">我们将从旅行的日期中提取日期和月份</li></ul><p id="fcef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为此，我们需要pandas to_datetime将对象数据类型转换为datetime数据类型。</p><ul class=""><li id="c695" class="kt ku hh ig b ih ii il im ip mn it mo ix mp jb mm kz la lb bi translated">该方法将只从日期中提取一天。</li><li id="4575" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated"><code class="du mq mr ms lz b">.dt.month</code>该方法将只提取该日期的月份。</li></ul><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="57a6" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># here we will extract date and month from Date of Journey</em><br/><em class="mh">#day</em><br/>train_data["journey_Date"]<strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>to_datetime(train_data['Date_of_Journey'], format<strong class="lz hi">=</strong> "%d/%m/%Y")<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>day<br/><br/><em class="mh">#month</em><br/>train_data["journey_Month"]<strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>to_datetime(train_data['Date_of_Journey'], format<strong class="lz hi">=</strong> "%d/%m/%Y")<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>month</span><span id="bc1c" class="jt ju hh lz b fi mi me l mf mg"># Lets look at the first 5 rows<br/>train_data<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mt"><img src="../Images/b3c15154c34c00523d4afadc4ff73643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zjbt2TUrfM4chwI9lbt8Xg.png"/></div></div></figure><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="b9cd" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Since we have converted Date_of_Journey column into integers, Now we can drop as it is of no use.</em><br/>train_data<strong class="lz hi">.</strong>drop(['Date_of_Journey'],axis<strong class="lz hi">=</strong>1,inplace<strong class="lz hi">=True</strong>)</span></pre><p id="3e21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们从<strong class="ig hi"> " <em class="mh">旅行日期"</em> </strong> <em class="mh">列中提取出<strong class="ig hi">日</strong>和<strong class="ig hi">月</strong>，并将其删除。</em></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="abcc" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Departure time is when a plane leaves the gate. </em><br/><em class="mh"># Similar to Date_of_Journey we can extract values from Dep_Time</em><br/><br/><em class="mh"># Extracting Hours</em><br/>train_data['Dep_hour']<strong class="lz hi">=</strong>pd<strong class="lz hi">.</strong>to_datetime(train_data['Dep_Time'])<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>hour  <em class="mh">#pd.to_datetime</em><br/><br/><em class="mh">#Extracting minutes</em><br/>train_data['Dep_min']<strong class="lz hi">=</strong>pd<strong class="lz hi">.</strong>to_datetime(train_data['Dep_Time'])<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>minute<br/><br/><em class="mh">#Now we will drop the dep_time, no use</em><br/>train_data<strong class="lz hi">.</strong>drop(['Dep_Time'],axis<strong class="lz hi">=</strong>1,inplace<strong class="lz hi">=True</strong>)</span></pre><p id="fdcd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">起飞<em class="mh">时间</em> </strong> <em class="mh">是飞机离开登机口的时间。</em> <br/> <em class="mh">类似于</em> <strong class="ig hi"> <em class="mh">【日期_行程】</em> </strong> <em class="mh">我们可以从</em><strong class="ig hi"><em class="mh">【Dep _ Time】</em></strong>中提取值</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="ab6d" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Arrival time is when a plane leaves. </em><br/><em class="mh"># Similar to Date_of_Journey we can extract values from Dep_Time</em><br/><br/><em class="mh"># Extracting Hours</em><br/>train_data['Arrival_hour']<strong class="lz hi">=</strong>pd<strong class="lz hi">.</strong>to_datetime(train_data['Arrival_Time'])<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>hour  <em class="mh">#pd.to_datetime</em><br/><br/><em class="mh">#Extracting minutes</em><br/>train_data['Arrival_min']<strong class="lz hi">=</strong>pd<strong class="lz hi">.</strong>to_datetime(train_data['Arrival_Time'])<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>minute<br/><br/><em class="mh">#Now we will drop the dep_time, no use</em><br/>train_data<strong class="lz hi">.</strong>drop(['Arrival_Time'],axis<strong class="lz hi">=</strong>1,inplace<strong class="lz hi">=True</strong>)</span></pre><p id="1860" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mh">到达时间</em> </strong> <em class="mh">是飞机起飞的时间。</em> <br/> <em class="mh">类似于</em><strong class="ig hi"><em class="mh">【Date _ of _ Journey】</em></strong><em class="mh">我们可以从</em><strong class="ig hi"><em class="mh"/>【Arrival _ Time】</strong>中提取值。</p><p id="6b72" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们来看数据。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="c651" class="jt ju hh lz b fi md me l mf mg">train_data<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mu"><img src="../Images/576861478f822cee69bd611dcec2be04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9mOgc4KjM4mOUWUz8WGJ-g.png"/></div></div></figure><h2 id="0486" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated"><strong class="ak">“持续时间”栏:</strong></h2><p id="8595" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">这里我们试图从特征<strong class="ig hi">“持续时间】</strong>中提取<strong class="ig hi">小时</strong>和<strong class="ig hi">分钟</strong>。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="3810" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Assigning and converting Duration column into list</em><br/>duration <strong class="lz hi">=</strong> list(train_data["Duration"])<br/><strong class="lz hi">for</strong> i <strong class="lz hi">in</strong> range(len(duration)):<br/>    <strong class="lz hi">if</strong> len(duration[i]<strong class="lz hi">.</strong>split()) <strong class="lz hi">!=</strong>2:  <em class="mh"># Check if duration contains only hour or mins</em><br/>        <strong class="lz hi">if</strong> "h" <strong class="lz hi">in</strong> duration[i]:<br/>            duration[i] <strong class="lz hi">=</strong> duration[i]<strong class="lz hi">.</strong>strip() <strong class="lz hi">+</strong> " 0m"   <em class="mh"># Adds 0 minute</em><br/>        <strong class="lz hi">else</strong>:<br/>            duration[i] <strong class="lz hi">=</strong> "0h " <strong class="lz hi">+</strong> duration[i]           <em class="mh"># Adds 0 hour</em><br/><br/>duration_hours <strong class="lz hi">=</strong> []<br/>duration_mins <strong class="lz hi">=</strong> []<br/><strong class="lz hi">for</strong> i <strong class="lz hi">in</strong> range(len(duration)):<br/>    duration_hours<strong class="lz hi">.</strong>append(int(duration[i]<strong class="lz hi">.</strong>split(sep <strong class="lz hi">=</strong> "h")[0]))    <em class="mh"># Extract hours from duration</em><br/>    duration_mins<strong class="lz hi">.</strong>append(int(duration[i]<strong class="lz hi">.</strong>split(sep <strong class="lz hi">=</strong> "m")[0]<strong class="lz hi">.</strong>split()[<strong class="lz hi">-</strong>1]))   <em class="mh"># Extracts only minutes from duration</em></span></pre><p id="39c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mh">添加“</em><strong class="ig hi"><em class="mh">duration _ hours”</em></strong><em class="mh">和“</em><strong class="ig hi"><em class="mh">duration _ mins”</em></strong><em class="mh">列表到train_data数据帧，并从中删除列“</em><strong class="ig hi"><em class="mh">【duration】</em></strong><em class="mh">。</em></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="ad82" class="jt ju hh lz b fi md me l mf mg">train_data["Duration_hours"] <strong class="lz hi">=</strong> duration_hours<br/>train_data["Duration_mins"] <strong class="lz hi">=</strong> duration_mins<br/><br/><em class="mh">#we will remove the DUrtaion clumns</em><br/>train_data<strong class="lz hi">.</strong>drop(['Duration'],axis<strong class="lz hi">=</strong>1,inplace<strong class="lz hi">=True</strong>)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mv"><img src="../Images/9c67f46922ea6115c2f90374656e8b2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jbme_mzFOd-o1HlKUY3i8w.png"/></div></div></figure><h1 id="2ba7" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated">2.3.处理分类数据:</h1><p id="e264" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">航空公司、来源、目的地、路线、总停留次数、附加信息是我们数据中的分类变量。让我们一个一个来处理。</p><ul class=""><li id="9830" class="kt ku hh ig b ih ii il im ip mn it mo ix mp jb mm kz la lb bi translated"><strong class="ig hi">标称数据</strong> →没有任何顺序→ <strong class="ig hi">在这种情况下使用OneHotEncoder </strong></li><li id="1d00" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated"><strong class="ig hi">顺序数据</strong> →有序→ <strong class="ig hi">标签编码器</strong>在这种情况下使用</li></ul><p id="debf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mh">试图找出航空公司列中的唯一值，并统计这些唯一值。</em>T79】</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="dd80" class="jt ju hh lz b fi md me l mf mg">train_data['Airline']<strong class="lz hi">.</strong>unique()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mw"><img src="../Images/3e6c640efb17af39cb7c04361abb1297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r19WlAqSFaWK6LVXXKPF1A.png"/></div></div></figure><p id="ce9d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以说<strong class="ig hi"> Jet Airways </strong>出现的次数最多，其次是IndiGo和Air India。</p><h1 id="4888" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> 2.3.1一键编码:</strong></h1><ul class=""><li id="2cdd" class="kt ku hh ig b ih ko il kp ip kv it kw ix kx jb mm kz la lb bi translated">另一种处理分类信息的典型技术是一键编码。它只是根据唯一值的数量向分类特征添加更多的特征。每个类别的独特价值将作为一个功能添加。</li><li id="7389" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated">构造虚拟变量的方法被称为一键编码。</li><li id="df7c" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated">在这种编码技术中，每个类别被表示为一个单热点向量。让我们看看如何在Python中进行一键编码:</li></ul><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="6159" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#OneHotEncoding -----&gt; Nominal data</em><br/>Airline <strong class="lz hi">=</strong> train_data[["Airline"]]<br/>Airline <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>get_dummies(train_data['Airline'],drop_first<strong class="lz hi">=True</strong>)<br/>Airline<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mx"><img src="../Images/267c57a569b67018dc8d905906a1aeb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YUTCY4tHZGWNsglK8GgZig.png"/></div></div></figure><h1 id="63aa" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak">航空公司vs价格:</strong></h1><p id="ae9e" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">让我们看看<strong class="ig hi">航空公司</strong>变量与<strong class="ig hi">价格</strong>变量是如何关联的。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="8318" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Airline vs Price</em><br/>sns<strong class="lz hi">.</strong>catplot(y <strong class="lz hi">=</strong> "Price", x <strong class="lz hi">=</strong> "Airline", data <strong class="lz hi">=</strong> train_data<strong class="lz hi">.</strong>sort_values("Price", ascending <strong class="lz hi">=</strong> <strong class="lz hi">False</strong>), kind<strong class="lz hi">=</strong>"boxen", height <strong class="lz hi">=</strong> 6, aspect <strong class="lz hi">=</strong> 3)<br/>plt<strong class="lz hi">.</strong>show()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es my"><img src="../Images/0425605328a1c3333e0b2b236517e2ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4RG8hI2AmpqF-e6m0otIag.png"/></div></div></figure><p id="d9c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以看出，航空公司的名字很重要。最贵的选择是'<strong class="ig hi"> JetAirways Business </strong>'其他运营商的费用也各不相同。</p><p id="4b1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将使用<strong class="ig hi"> one-hot编码</strong>来处理Airline变量，因为它是名义分类数据(航空公司名称没有任何排序)。</p><h1 id="431a" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak">出发地与目的地:</strong></h1><p id="427d" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">同样，变量<strong class="ig hi">‘源’</strong>和<strong class="ig hi">‘目的’</strong>是名义分类数据。为了处理这两个变量，我们将再次使用一键编码。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="87da" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Source vs Price</em><br/><br/>sns<strong class="lz hi">.</strong>boxplot(y <strong class="lz hi">=</strong> "Price", x <strong class="lz hi">=</strong> "Source", data <strong class="lz hi">=</strong> train_data<strong class="lz hi">.</strong>sort_values("Price", ascending <strong class="lz hi">=</strong> <strong class="lz hi">False</strong>))<br/>plt<strong class="lz hi">.</strong>show()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mz"><img src="../Images/45d5bec2b182a43718f49757a3d13311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*xo4mQPkTJ5Ta8o_ESQ3_XA.png"/></div></figure><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="b69f" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#OneHotEncoding -----&gt; Nominal data</em><br/>Source <strong class="lz hi">=</strong> train_data[["Source"]]<br/>Source <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>get_dummies(train_data['Source'],drop_first<strong class="lz hi">=True</strong>)<br/>Source<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es na"><img src="../Images/4c1306cc9d087b3f2669c3ceb6014969.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*Rzj4njyVvPZanB_X0f2IGQ.png"/></div></figure><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="91bc" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># As Destination is Nominal Categorical data we will perform OneHotEncoding</em><br/><br/>Destination <strong class="lz hi">=</strong> train_data[["Destination"]]<br/><br/>Destination <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>get_dummies(Destination, drop_first <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/>Destination<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nb"><img src="../Images/8cad9bdf771b9fcc4ef03f179ec327d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jEnCp6sYa4GjlpAR0PFaJw.png"/></div></div></figure><h1 id="caf3" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak">可变路线:</strong></h1><p id="1be9" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">旅程的路径由route变量表示。我选择删除这个字段，因为<strong class="ig hi">‘总停留数’</strong>值表示航班是直达还是中转。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="40d7" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># droping column, because Additinal_info has since 80 % has no information </em><br/><em class="mh"># Route---&gt; is related to no of stops</em><br/>train_data<strong class="lz hi">.</strong>drop(["Route", "Additional_Info"], axis <strong class="lz hi">=</strong> 1, inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)</span></pre><h1 id="489d" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> Total_Stops变量:</strong></h1><p id="771f" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">直达指的是不经停的飞行，即直线飞行。不言而喻，其他价值观也有同样的意义。我们可以看到它是有序分类数据，因此我们将使用<strong class="ig hi"> LabelEncoder </strong>来处理它。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="039a" class="jt ju hh lz b fi md me l mf mg">train_data['Total_Stops']<strong class="lz hi">.</strong>value_counts()<br/><em class="mh"># As this is case of Ordinal Categorical type we perform LabelEncoder</em><br/><em class="mh">#we replace the values in key values </em><br/>train_data<strong class="lz hi">.</strong>replace({'non-stop':0,'1 stop':1,'2 stops':2,'3 stops':3,'4 stops':4},inplace<strong class="lz hi">=True</strong>)</span><span id="09a1" class="jt ju hh lz b fi mi me l mf mg">train_data<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nc"><img src="../Images/e3483b412d23aca915728b431c7b6daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Jv8z-N33yN9dKCdQVuUtQ.png"/></div></div></figure><h1 id="e9d2" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak">最终数据帧:</strong></h1><p id="7930" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">现在，我们将所有的一次性要素和标注编码要素连接到原始数据框，以形成最终的数据框。我们还将删除用来创建新编码变量的旧变量。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="b5a9" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#Concatenate dataframe --&gt; train_data + Airline + Source + Destination</em><br/>data_train<strong class="lz hi">=</strong>pd<strong class="lz hi">.</strong>concat([train_data,Airline , Source, Destination],axis<strong class="lz hi">=</strong>1)</span><span id="e3f5" class="jt ju hh lz b fi mi me l mf mg"><em class="mh"># we have drop the varibles</em><br/>data_train<strong class="lz hi">.</strong>drop(["Airline","Source","Destination"],axis<strong class="lz hi">=</strong>1,inplace<strong class="lz hi">=True</strong>)</span><span id="612b" class="jt ju hh lz b fi mi me l mf mg">data_train<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nd"><img src="../Images/a6c8a4acf06724f93934ef0850dab6ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3oR1ok7jaeuONX3wHDshQ.png"/></div></div></figure><p id="a695" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，最终数据帧有<strong class="ig hi"> 30个变量，</strong>包括因变量“价格”对于训练，只有<strong class="ig hi">29个变量</strong>。</p><h1 id="a260" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated">3.测试数据:</h1><p id="efb4" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">我们将对测试数据重复所有这些步骤。</p><p id="0bb7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">导入测试数据:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="eb01" class="jt ju hh lz b fi md me l mf mg">test_data<strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>read_excel("Test_Set.xlsx")<br/>test_data<strong class="lz hi">.</strong>head()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ne"><img src="../Images/2fb9f4ca86d583396bca97942d1861ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pV6Y2MsBQgQpqIW06Uz2Kg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Test data</figcaption></figure><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="ca68" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Preprocessing</em><br/><br/><br/>print(test_data<strong class="lz hi">.</strong>info())<br/><br/><br/>test_data<strong class="lz hi">.</strong>dropna(inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/>print(test_data<strong class="lz hi">.</strong>isnull()<strong class="lz hi">.</strong>sum())<br/><br/><em class="mh"># EDA</em><br/><br/><em class="mh"># Date_of_Journey</em><br/>test_data["Journey_day"] <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>to_datetime(test_data<strong class="lz hi">.</strong>Date_of_Journey, format<strong class="lz hi">=</strong>"%d/%m/%Y")<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>day<br/>test_data["Journey_month"] <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>to_datetime(test_data["Date_of_Journey"], format <strong class="lz hi">=</strong> "%d/%m/%Y")<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>month<br/>test_data<strong class="lz hi">.</strong>drop(["Date_of_Journey"], axis <strong class="lz hi">=</strong> 1, inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><em class="mh"># Dep_Time</em><br/>test_data["Dep_hour"] <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>to_datetime(test_data["Dep_Time"])<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>hour<br/>test_data["Dep_min"] <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>to_datetime(test_data["Dep_Time"])<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>minute<br/>test_data<strong class="lz hi">.</strong>drop(["Dep_Time"], axis <strong class="lz hi">=</strong> 1, inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><em class="mh"># Arrival_Time</em><br/>test_data["Arrival_hour"] <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>to_datetime(test_data<strong class="lz hi">.</strong>Arrival_Time)<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>hour<br/>test_data["Arrival_min"] <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>to_datetime(test_data<strong class="lz hi">.</strong>Arrival_Time)<strong class="lz hi">.</strong>dt<strong class="lz hi">.</strong>minute<br/>test_data<strong class="lz hi">.</strong>drop(["Arrival_Time"], axis <strong class="lz hi">=</strong> 1, inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><em class="mh"># Duration</em><br/>duration <strong class="lz hi">=</strong> list(test_data["Duration"])<br/><br/><strong class="lz hi">for</strong> i <strong class="lz hi">in</strong> range(len(duration)):<br/>    <strong class="lz hi">if</strong> len(duration[i]<strong class="lz hi">.</strong>split()) <strong class="lz hi">!=</strong> 2:    <em class="mh"># Check if duration contains only hour or mins</em><br/>        <strong class="lz hi">if</strong> "h" <strong class="lz hi">in</strong> duration[i]:<br/>            duration[i] <strong class="lz hi">=</strong> duration[i]<strong class="lz hi">.</strong>strip() <strong class="lz hi">+</strong> " 0m"   <em class="mh"># Adds 0 minute</em><br/>        <strong class="lz hi">else</strong>:<br/>            duration[i] <strong class="lz hi">=</strong> "0h " <strong class="lz hi">+</strong> duration[i]           <em class="mh"># Adds 0 hour</em><br/><br/>duration_hours <strong class="lz hi">=</strong> []<br/>duration_mins <strong class="lz hi">=</strong> []<br/><strong class="lz hi">for</strong> i <strong class="lz hi">in</strong> range(len(duration)):<br/>    duration_hours<strong class="lz hi">.</strong>append(int(duration[i]<strong class="lz hi">.</strong>split(sep <strong class="lz hi">=</strong> "h")[0]))    <em class="mh"># Extract hours from duration</em><br/>    duration_mins<strong class="lz hi">.</strong>append(int(duration[i]<strong class="lz hi">.</strong>split(sep <strong class="lz hi">=</strong> "m")[0]<strong class="lz hi">.</strong>split()[<strong class="lz hi">-</strong>1]))   <em class="mh"># Extracts only minutes from duration</em><br/><br/><em class="mh"># Adding Duration column to test set</em><br/>test_data["Duration_hours"] <strong class="lz hi">=</strong> duration_hours<br/>test_data["Duration_mins"] <strong class="lz hi">=</strong> duration_mins<br/>test_data<strong class="lz hi">.</strong>drop(["Duration"], axis <strong class="lz hi">=</strong> 1, inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><br/><em class="mh"># Categorical data</em><br/><br/>print("Airline")<br/>print("-"<strong class="lz hi">*</strong>75)<br/>print(test_data["Airline"]<strong class="lz hi">.</strong>value_counts())<br/>Airline <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>get_dummies(test_data["Airline"], drop_first<strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><br/><br/><br/>print(test_data["Source"]<strong class="lz hi">.</strong>value_counts())<br/>Source <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>get_dummies(test_data["Source"], drop_first<strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><br/><br/><br/>print(test_data["Destination"]<strong class="lz hi">.</strong>value_counts())<br/>Destination <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>get_dummies(test_data["Destination"], drop_first <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><em class="mh"># Additional_Info contains almost 80% no_info</em><br/><em class="mh"># Route and Total_Stops are related to each other</em><br/>test_data<strong class="lz hi">.</strong>drop(["Route", "Additional_Info"], axis <strong class="lz hi">=</strong> 1, inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><em class="mh"># Replacing Total_Stops</em><br/>test_data<strong class="lz hi">.</strong>replace({"non-stop": 0, "1 stop": 1, "2 stops": 2, "3 stops": 3, "4 stops": 4}, inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/><em class="mh"># Concatenate dataframe --&gt; test_data + Airline + Source + Destination</em><br/>data_test <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>concat([test_data, Airline, Source, Destination], axis <strong class="lz hi">=</strong> 1)<br/><br/>data_test<strong class="lz hi">.</strong>drop(["Airline", "Source", "Destination"], axis <strong class="lz hi">=</strong> 1, inplace <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>)<br/><br/>print()<br/>print()<br/><br/>print("Shape of test data : ", data_test<strong class="lz hi">.</strong>shape)</span></pre><p id="9117" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">最终测试数据:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es my"><img src="../Images/4269272046a8eec4902dffb4d6913509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0RA2TU3p6VSfHT8U_zQO2g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Final Test data</figcaption></figure><h1 id="d614" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> 4。创建自变量和因变量:</strong></h1><p id="f717" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated"><strong class="ig hi">自变量</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="2983" class="jt ju hh lz b fi md me l mf mg">X<strong class="lz hi">=</strong> data_train[['Total_Stops', 'journey_Date', 'journey_Month', 'Dep_hour',<br/>       'Dep_min', 'Arrival_hour', 'Arrival_min', 'Duration_hours',<br/>       'Duration_mins', 'Air India', 'GoAir', 'IndiGo', 'Jet Airways',<br/>       'Jet Airways Business', 'Multiple carriers',<br/>       'Multiple carriers Premium economy', 'SpiceJet', 'Trujet', 'Vistara',<br/>       'Vistara Premium economy', 'Chennai', 'Delhi', 'Kolkata', 'Mumbai',<br/>       'Destination_Cochin', 'Destination_Delhi', 'Destination_Hyderabad',<br/>       'Destination_Kolkata', 'Destination_New Delhi']]<br/>X<strong class="lz hi">.</strong>head()</span></pre><p id="4516" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">因变量:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="8db1" class="jt ju hh lz b fi md me l mf mg">y<strong class="lz hi">=</strong>data_train['Price']</span></pre><h1 id="ae4c" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated">5.特征选择</h1><p id="9130" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">找出有助于目标变量并与目标变量有良好关系的最佳特征。以下是一些特征选择方法，</p><ul class=""><li id="bee7" class="kt ku hh ig b ih ii il im ip mn it mo ix mp jb mm kz la lb bi translated">相互关系</li><li id="1021" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated">特征重要性</li><li id="d824" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated">选择最佳</li></ul><h1 id="f268" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> 5.1。关联:</strong></h1><p id="7fce" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">相关性是一种确定两个变量之间联系的技术，它在现实生活中很有用，因为它允许我们使用与一个变量相关的其他因素来预测该变量的值。因为涉及到两个变量，所以它是一种二元统计量。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="1a0e" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Heatmap</em><br/>plt<strong class="lz hi">.</strong>figure(figsize<strong class="lz hi">=</strong>(25,25))<br/>sns<strong class="lz hi">.</strong>heatmap(data_train<strong class="lz hi">.</strong>corr(),annot <strong class="lz hi">=</strong> <strong class="lz hi">True</strong>, cmap <strong class="lz hi">=</strong> "RdYlGn")</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nf"><img src="../Images/85cbbc283d4906d67823fed7291c776f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yHFhyLn2X-6H2lKC7whNsQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Correlation graph</figcaption></figure><p id="a023" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">寻找高度相关的独立变量</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="1ac6" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#Removing correlated features</em><br/>Threshold<strong class="lz hi">=</strong>0.9</span><span id="8d84" class="jt ju hh lz b fi mi me l mf mg"><em class="mh"># find and remove correlated features</em><br/><strong class="lz hi">def</strong> correlation(dataset, threshold):<br/>    col_corr <strong class="lz hi">=</strong> set()  <em class="mh"># Set of all the names of correlated columns</em><br/>    corr_matrix <strong class="lz hi">=</strong> dataset<strong class="lz hi">.</strong>corr()<br/>    <strong class="lz hi">for</strong> i <strong class="lz hi">in</strong> range(len(corr_matrix<strong class="lz hi">.</strong>columns)):<br/>        <strong class="lz hi">for</strong> j <strong class="lz hi">in</strong> range(i):<br/>            <strong class="lz hi">if</strong> abs(corr_matrix<strong class="lz hi">.</strong>iloc[i, j]) <strong class="lz hi">&gt;</strong> threshold: <em class="mh"># we are interested in absolute coeff value</em><br/>                colname <strong class="lz hi">=</strong> corr_matrix<strong class="lz hi">.</strong>columns[i]  <em class="mh"># getting the name of column</em><br/>                col_corr<strong class="lz hi">.</strong>add(colname)<br/>    <strong class="lz hi">return</strong> col_corr</span><span id="4727" class="jt ju hh lz b fi mi me l mf mg"><br/>correlation(X,Threshold)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ng"><img src="../Images/0121bede9688d6e14ca45a2530953a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M-1SkdI5sbq6Q_16PILkvA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Highly Correlated features</figcaption></figure><h1 id="0e37" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated">5.2.功能重要性:</h1><p id="fe65" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">在机器学习中，特征选择的目的是发现最佳的特征集，允许人们开发被检查现象的可用模型。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="748e" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Important feature using ExtraTreesRegressor</em><br/><br/><strong class="lz hi">from</strong> sklearn.ensemble <strong class="lz hi">import</strong> ExtraTreesRegressor<br/>selection <strong class="lz hi">=</strong> ExtraTreesRegressor()<br/>selection<strong class="lz hi">.</strong>fit(X, y)</span></pre><p id="0b85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图表:</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="dc3f" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#plot graph of feature importances for better visualization</em><br/><br/>plt<strong class="lz hi">.</strong>figure(figsize <strong class="lz hi">=</strong> (12,8))<br/>feat_importances <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>Series(selection<strong class="lz hi">.</strong>feature_importances_, index<strong class="lz hi">=</strong>X<strong class="lz hi">.</strong>columns)<br/>feat_importances<strong class="lz hi">.</strong>nlargest(20)<strong class="lz hi">.</strong>plot(kind<strong class="lz hi">=</strong>'barh')<br/>plt<strong class="lz hi">.</strong>show()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nh"><img src="../Images/c1035ca985c02e2baba425c7115bb44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9oVi8dzd29G1FdZ9SJCkjA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Features important graph</figcaption></figure><h1 id="a52a" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> 5.3。选择测试:</strong></h1><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="3499" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># import library</em><br/><strong class="lz hi">from</strong> sklearn.feature_selection <strong class="lz hi">import</strong> SelectKBest<br/><strong class="lz hi">from</strong> sklearn.feature_selection <strong class="lz hi">import</strong> chi2</span><span id="c59c" class="jt ju hh lz b fi mi me l mf mg"><em class="mh">#Deifne feature selection</em><br/>fs<strong class="lz hi">=</strong>SelectKBest(score_func<strong class="lz hi">=</strong>chi2)  <br/><em class="mh"># Applying feature selection</em><br/>X_selected<strong class="lz hi">=</strong>fs<strong class="lz hi">.</strong>fit(X,y)</span></pre><p id="671c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图表:</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="907d" class="jt ju hh lz b fi md me l mf mg">plt<strong class="lz hi">.</strong>figure(figsize<strong class="lz hi">=</strong>(15,15))<br/>feat_importances <strong class="lz hi">=</strong> pd<strong class="lz hi">.</strong>Series(X_selected<strong class="lz hi">.</strong>scores_, index<strong class="lz hi">=</strong>X<strong class="lz hi">.</strong>columns)<br/>feat_importances<strong class="lz hi">.</strong>nlargest(20)<strong class="lz hi">.</strong>plot(kind<strong class="lz hi">=</strong>'barh')<br/>plt<strong class="lz hi">.</strong>show()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ni"><img src="../Images/bd3d39f8e0a29cd9b05bc550b1b70839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQYrKio9GbN_hDkb2R34Ig.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">SelectKBasket Graph</figcaption></figure><h1 id="35dc" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated">6.使用随机森林拟合模型</h1><p id="ffea" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated"><em class="mh"> 1。将数据集分成训练和测试集，以预测w.r.t X_test </em></p><p id="b113" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mh"> 2。随机森林中不进行缩放</em></p><p id="7fac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mh"> 3。导入模型</em></p><p id="de0b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mh"> 4。拟合数据</em></p><p id="9a6c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mh"> 5。预测w.r.t X_test </em></p><p id="7488" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mh"> 6。在回归检查中RSME得分</em></p><p id="26b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7 .<em class="mh">。绘制误差图</em></p><p id="9e29" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6.1列车试运行:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="ff94" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#Splitting inot train_test</em><br/><strong class="lz hi">from</strong> sklearn.model_selection <strong class="lz hi">import</strong> train_test_split<br/>X_train,X_test,y_train,y_test<strong class="lz hi">=</strong>train_test_split(X,y,test_size<strong class="lz hi">=</strong>0.2,random_state<strong class="lz hi">=</strong>0)</span></pre><p id="5025" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6.2建立模型:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="8cc7" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#Building the model</em><br/><strong class="lz hi">from</strong> sklearn.ensemble <strong class="lz hi">import</strong> RandomForestRegressor<br/>reg<strong class="lz hi">=</strong>RandomForestRegressor()<br/>reg<strong class="lz hi">.</strong>fit(X_train,y_train)</span></pre><p id="3bb0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6.3预测模型:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="9c2a" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#predicting the model</em><br/>y_pred<strong class="lz hi">=</strong>reg<strong class="lz hi">.</strong>predict(X_test)</span></pre><p id="7e88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6.4评估模型:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="edd0" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#Accuracy</em><br/>print(reg<strong class="lz hi">.</strong>score(X_test,y_test))<br/>print(reg<strong class="lz hi">.</strong>score(X_train,y_train))</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nj"><img src="../Images/34bee3523bcba98e2d1bc307d8dbbe9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*cHQls0LLzdI70VTBacYcAg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Accuracy</figcaption></figure><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="6263" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#RMSE</em><br/><strong class="lz hi">from</strong> sklearn.metrics <strong class="lz hi">import</strong> mean_squared_error<br/><strong class="lz hi">from</strong> math <strong class="lz hi">import</strong> sqrt<br/>rmse<strong class="lz hi">=</strong>sqrt(mean_squared_error(y_test,y_pred))<br/>rmse</span></pre><p id="e246" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 6.5绘制误差图:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="504b" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#Plotting the error graph and should be mean=0</em><br/>sns<strong class="lz hi">.</strong>distplot(y_test<strong class="lz hi">-</strong>y_pred,kde<strong class="lz hi">=True</strong>)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nk"><img src="../Images/d507e17ec336eb83bdb64a36d58f54c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*tNPDe4OEM90KEJWixDghUA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Error Graph</figcaption></figure><p id="d846" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">散点图:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="8b93" class="jt ju hh lz b fi md me l mf mg"><em class="mh">#Plotting scatter graph to check linear relations</em><br/>plt<strong class="lz hi">.</strong>scatter(y_test,y_pred,alpha<strong class="lz hi">=</strong>0.5)<br/>plt<strong class="lz hi">.</strong>xlabel('y_test')<br/>plt<strong class="lz hi">.</strong>ylabel('y_pred')</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nl"><img src="../Images/4b6318f6f0b6cbcd820c51754790c534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*arRKc3I9ou_lROjjSaq89w.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Scatter graph</figcaption></figure><p id="a017" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">r2得分为81 %,使用该模型，我们还可以计算平均绝对误差、均方误差和均方根误差(回归指标)的最小值。我们将通过调整超参数来提高精确度。</p><h1 id="2654" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated">7.超参数调谐</h1><ul class=""><li id="419e" class="kt ku hh ig b ih ko il kp ip kv it kw ix kx jb mm kz la lb bi translated">选择以下超参数调整方法</li></ul><ol class=""><li id="b2e4" class="kt ku hh ig b ih ii il im ip mn it mo ix mp jb ky kz la lb bi translated"><strong class="ig hi">随机搜索CV </strong></li></ol><ul class=""><li id="da81" class="kt ku hh ig b ih ii il im ip mn it mo ix mp jb mm kz la lb bi translated">以字典的形式分配超参数</li><li id="5f35" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated">符合模型</li><li id="3da1" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated">检查最佳参数和最佳分数</li></ul><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="86ae" class="jt ju hh lz b fi md me l mf mg"><strong class="lz hi">from</strong> sklearn.model_selection <strong class="lz hi">import</strong> RandomizedSearchCV</span><span id="934d" class="jt ju hh lz b fi mi me l mf mg"><strong class="lz hi">import</strong> numpy <strong class="lz hi">as</strong> np<br/><br/><em class="mh">#Randomized Search CV</em><br/><br/><em class="mh"># Number of trees in random forest</em><br/>n_estimators <strong class="lz hi">=</strong> [int(x) <strong class="lz hi">for</strong> x <strong class="lz hi">in</strong> np<strong class="lz hi">.</strong>linspace(start <strong class="lz hi">=</strong> 100, stop <strong class="lz hi">=</strong> 1200, num <strong class="lz hi">=</strong> 12)]<br/><em class="mh"># Number of features to consider at every split</em><br/>max_features <strong class="lz hi">=</strong> ['auto', 'sqrt']<br/><em class="mh"># Maximum number of levels in tree</em><br/>max_depth <strong class="lz hi">=</strong> [int(x) <strong class="lz hi">for</strong> x <strong class="lz hi">in</strong> np<strong class="lz hi">.</strong>linspace(5, 30, num <strong class="lz hi">=</strong> 6)]<br/><em class="mh"># Minimum number of samples required to split a node</em><br/>min_samples_split <strong class="lz hi">=</strong> [2, 5, 10, 15, 100]<br/><em class="mh"># Minimum number of samples required at each leaf node</em><br/>min_samples_leaf <strong class="lz hi">=</strong> [1, 2, 5, 10]</span></pre><p id="e085" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">创建参数网格:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="8792" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Create the random grid</em><br/><br/>random_grid <strong class="lz hi">=</strong> {'n_estimators': n_estimators,<br/>               'max_features': max_features,<br/>               'max_depth': max_depth,<br/>               'min_samples_split': min_samples_split,<br/>               'min_samples_leaf': min_samples_leaf}</span></pre><p id="2c8e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">最佳参数:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="e50c" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Random search of parameters, using 5 fold cross validation, </em><br/><em class="mh"># search across 100 different combinations</em><br/><br/>rf_random <strong class="lz hi">=</strong> RandomizedSearchCV(estimator <strong class="lz hi">=</strong> reg, param_distributions <strong class="lz hi">=</strong> random_grid,scoring<strong class="lz hi">=</strong>'neg_mean_squared_error', n_iter <strong class="lz hi">=</strong> 10, cv <strong class="lz hi">=</strong> 5, verbose<strong class="lz hi">=</strong>2, random_stat</span></pre><p id="9e7f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">拟合模型:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="a2a8" class="jt ju hh lz b fi md me l mf mg">rf_random<strong class="lz hi">.</strong>fit(X_train,y_train)</span></pre><p id="ecbe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">最佳参数:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="ff2b" class="jt ju hh lz b fi md me l mf mg"><em class="mh"># Finding the best parameter we should give in </em><br/>rf_random<strong class="lz hi">.</strong>best_params_</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nm"><img src="../Images/584c75a6fe5c3d03d668729d4b3b504d.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*QGlbK2GM3hCKsBntGb2zGQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Best Parameter</figcaption></figure><p id="aca9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">预测调整后的模型:</strong></p><p id="dc51" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们使用最佳参数来预测最终模型。</p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="6167" class="jt ju hh lz b fi md me l mf mg">prediction <strong class="lz hi">=</strong> rf_random<strong class="lz hi">.</strong>predict(X_test)</span></pre><p id="a71c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">调谐模型的误差图:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="694e" class="jt ju hh lz b fi md me l mf mg">plt<strong class="lz hi">.</strong>figure(figsize <strong class="lz hi">=</strong> (8,8))<br/>sns<strong class="lz hi">.</strong>distplot(y_test<strong class="lz hi">-</strong>prediction)<br/>plt<strong class="lz hi">.</strong>show()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nn"><img src="../Images/6a14281e9ad0a355a5c40b02fac06ee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5R1_v03hw-cpCPVCs6B8CA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Error graph of the tuned model</figcaption></figure><p id="395f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">调优模型散点图:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="8566" class="jt ju hh lz b fi md me l mf mg">plt<strong class="lz hi">.</strong>figure(figsize <strong class="lz hi">=</strong> (8,8))<br/>plt<strong class="lz hi">.</strong>scatter(y_test, prediction, alpha <strong class="lz hi">=</strong> 0.5)<br/>plt<strong class="lz hi">.</strong>xlabel("y_test")<br/>plt<strong class="lz hi">.</strong>ylabel("y_pred")<br/>plt<strong class="lz hi">.</strong>show()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es no"><img src="../Images/1e5bbc153ed2327b4a6bdf27dbcba523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tWyzDgbsiCTiqEIz5m8xlA.png"/></div></div></figure><p id="5ee6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">评估调整后的模型:</strong></p><pre class="jd je jf jg fd ly lz ma mb aw mc bi"><span id="2975" class="jt ju hh lz b fi md me l mf mg">print('MAE:', metrics<strong class="lz hi">.</strong>mean_absolute_error(y_test, prediction))<br/>print('MSE:', metrics<strong class="lz hi">.</strong>mean_squared_error(y_test, prediction))<br/>print('RMSE:', np<strong class="lz hi">.</strong>sqrt(metrics<strong class="lz hi">.</strong>mean_squared_error(y_test, prediction)))</span><span id="0612" class="jt ju hh lz b fi mi me l mf mg">#accuracy<br/>metrics<strong class="lz hi">.</strong>r2_score(y_test,prediction)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es np"><img src="../Images/c20e7518cef4fe2c082a17cb842cc914.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*Ec1qv-vWSty32R0BpH09gg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Result</figcaption></figure><p id="0ca3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">超调后，随机林回归器的r2分数为84 %,而在超调前，随机林回归器的r2分数为81%。MAE的值也下降了，表明我们成功地调整了我们的模型。</p><h1 id="b9c4" class="lh ju hh bd jv li lj lk jz ll lm ln kd lo lp lq kg lr ls lt kj lu lv lw km lx bi translated"><strong class="ak"> 8。结论:</strong></h1><ul class=""><li id="50ae" class="kt ku hh ig b ih ko il kp ip kv it kw ix kx jb mm kz la lb bi translated">因此，我们对此数据使用了随机森林模型，并通过进行超参数调整来提高准确性。</li><li id="f202" class="kt ku hh ig b ih lc il ld ip le it lf ix lg jb mm kz la lb bi translated">因此，我们能够成功地训练我们的回归模型“随机森林模型”，以84%的r2分数预测定价航班，并完成所需的工作。</li></ul><div class="nq nr ez fb ns nt"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="nu ab dw"><div class="nv ab nw cl cj nx"><h2 class="bd hi fi z dy ny ea eb nz ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="oa l"><h3 class="bd b fi z dy ny ea eb nz ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ob l"><p class="bd b fp z dy ny ea eb nz ed ef dx translated">medium.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh jm nt"/></div></div></a></div></div></div>    
</body>
</html>