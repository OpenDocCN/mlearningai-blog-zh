<html>
<head>
<title>Search, Rank, and Recommendations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">搜索、排名和推荐</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/search-rank-and-recommendations-35cc717772cb?source=collection_archive---------0-----------------------#2021-07-05">https://medium.com/mlearning-ai/search-rank-and-recommendations-35cc717772cb?source=collection_archive---------0-----------------------#2021-07-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="94d0" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">重新排列搜索结果和个性化推荐的简单方法。</h2></div><p id="023e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这篇文章是我上一篇文章<strong class="iy hi"/><strong class="iy hi">的延续，用S-BERT进行语义搜索就是你所需要的全部</strong></p><div class="js jt ez fb ju jv"><a rel="noopener follow" target="_blank" href="/mlearning-ai/semantic-search-with-s-bert-is-all-you-need-951bc710e160"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hi fi z dy ka ea eb kb ed ef hg bi translated">使用S-BERT进行语义搜索是您所需要的</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">从头开始构建内部语义搜索引擎—快速而准确</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">medium.com</p></div></div><div class="ke l"><div class="kf l kg kh ki ke kj kk jv"/></div></div></a></div><p id="37c0" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们在上一篇文章中提到的内容:</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/f0732a11aab8cae2d937673cf27ea9e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c9A2GZ7GQYOEEeKwQ2ZfjQ.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">The architecture we have already discussed</figcaption></figure><ul class=""><li id="9e81" class="la lb hh iy b iz ja jc jd jf lc jj ld jn le jr lf lg lh li bi translated">搜索类型:不对称和对称</li><li id="8ea2" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">基于点积和余弦积的模型</li><li id="0e86" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">嵌入存储(FAISS)</li><li id="32d9" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">合成查询生成</li><li id="97ce" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">双编码器微调</li></ul><p id="b818" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们留下了一些重要的问题:</p><ul class=""><li id="43bf" class="la lb hh iy b iz ja jc jd jf lc jj ld jn le jr lf lg lh li bi translated">结果重新排序的方法</li><li id="dd51" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">结果的质量，如何内联到用户查询。</li><li id="ad8f" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">如何在推荐结果中融入用户行为</li></ul><h1 id="e8f5" class="lo lp hh bd lq lr ls lt lu lv lw lx ly in lz io ma iq mb ir mc it md iu me mf bi translated">入门:概述</h1><figure class="km kn ko kp fd kq"><div class="bz dy l di"><div class="mg mh l"/></div></figure><p id="8a81" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">搜索排名和推荐是主要互联网公司非常感兴趣的基本问题，包括网络搜索引擎、内容发布网站和市场。然而，尽管有一些共同的特征，但在这一领域并不存在一刀切的解决方案。考虑到需要分级、个性化和推荐的内容的巨大差异，每个市场都有一些独特的挑战。</p><p id="7a8f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">搜索和推荐有很多共同点。他们帮助用户了解新产品，并需要在很短的时间内检索和排列数百万个产品(&lt;150ms). They’re trained on similar data, have content and behavioral-based approaches, and optimize for engagement (e.g., click-through rate) and revenue (e.g., conversion, gross merchandise value).</p><p id="97a5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">)尽管如此，搜索在一个关键方面有所不同——它将用户的查询作为额外的输入。</strong>(将搜索视为推荐，将查询视为额外的上下文。)这是福也是祸。这是一个福音，因为查询提供了更多的上下文来帮助我们帮助用户找到他们想要的东西；这是一个祸根，因为用户希望结果与他们的查询相符。</p><p id="e439" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">搜索和推荐系统的一个常见架构由以下组件组成:</p><ul class=""><li id="4136" class="la lb hh iy b iz ja jc jd jf lc jj ld jn le jr lf lg lh li bi translated">候选生成</li><li id="f52e" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">得分</li><li id="3945" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">重新排名</li></ul><p id="85e6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在上一篇文章中，我们了解了如何通过更好地理解数据和微调我们的模型来创建一个<strong class="iy hi">概念搜索</strong>，从而为用户搜索查询生成更好的候选。</p><p id="858c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然而，检索系统可能检索与搜索查询不相关的文档。因此，在第二阶段，我们使用基于<strong class="iy hi">交叉编码器</strong>的<strong class="iy hi">重排序器</strong>，其对给定搜索查询的所有候选项的相关性进行评分。</p><h2 id="a98b" class="mi lp hh bd lq mj mk ml lu mm mn mo ly jf mp mq ma jj mr ms mc jn mt mu me mv bi translated">交叉编码器</h2><p id="3d76" class="pw-post-body-paragraph iw ix hh iy b iz mw ii jb jc mx il je jf my jh ji jj mz jl jm jn na jp jq jr ha bi translated">C.e对给定的输入和候选标签进行完全的(交叉的)自我注意，并且倾向于获得比他们的对手高得多的准确度。每当我们有一组预定义的想要评分的句子对时，就可以使用交叉编码器。</p><p id="5ba1" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">基于交叉编码器的重排序器可以显著改善用户的最终结果。查询和可能的文档被同时传递到transformer网络，然后transformer网络输出一个介于0和1之间的分数，表示该文档与给定查询的相关程度。</p><p id="a091" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因为我们处理的是电影情节，所以我传递了用户查询并检索了情节。</p><div class="js jt ez fb ju jv"><a href="https://github.com/99sbr/semantic-search-with-sbert" rel="noopener  ugc nofollow" target="_blank"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hi fi z dy ka ea eb kb ed ef hg bi translated">99sbr/带sbert的语义搜索</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">使用S-BERT构建语义搜索，并以无人监管的方式微调您的模型</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">github.com</p></div></div><div class="ke l"><div class="nb l kg kh ki ke kj kk jv"/></div></div></a></div><p id="c947" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">卡格尔内核:<a class="ae nc" href="https://www.kaggle.com/sbrvrm/search-ranking" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/sbrvrm/search-ranking</a></p><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="f1df" class="mi lp hh ne b fi ni nj l nk nl">def cross_score(model_inputs):<br/>    scores = cross_model.predict(model_inputs)<br/>    return scores<br/><br/>model_inputs = [[query,item['Plot']] for item <strong class="ne hi">in</strong> results]<br/>scores = cross_score(model_inputs)<br/><em class="nm">#Sort the scores in decreasing order</em><br/>ranked_results = [{'Title': inp['Title'], 'Score': score} for inp, score <strong class="ne hi">in</strong> zip(results, scores)]<br/>ranked_results = sorted(ranked_results, key=lambda x: x['Score'], reverse=True)</span></pre><p id="9078" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">之前:</p><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="309c" class="mi lp hh ne b fi ni nj l nk nl">query="Artificial Intelligence based action movie"<br/>results=search(query, top_k=5, index=index, model=model)</span><span id="c749" class="mi lp hh ne b fi nn nj l nk nl">Results:<br/>'Title': 'The Cape Canaveral Monsters'<br/>'Title': 'Small Soldiers'<br/>'Title': 'Chappie'<br/>'Title': 'Armed Response'<br/>'Title': 'Galactic Armored Fleet Majestic Prince: Genetic Awakening'</span></pre><p id="de2f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用交叉编码器并将结果与分数排序后:</p><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="8043" class="mi lp hh ne b fi ni nj l nk nl">'Title': 'Armed Response'<br/>'Title': 'The Cape Canaveral Monsters'<br/>'Title': 'Chappie'<br/>'Title': 'Galactic Armored Fleet Majestic Prince: Genetic Awakening'<br/>'Title': 'Small Soldiers'</span></pre><h2 id="be0c" class="mi lp hh bd lq mj mk ml lu mm mn mo ly jf mp mq ma jj mr ms mc jn mt mu me mv bi translated">BERT-score ( <strong class="ak"> Bert令牌嵌入+令牌IDF权重</strong>)</h2><p id="a3d3" class="pw-post-body-paragraph iw ix hh iy b iz mw ii jb jc mx il je jf my jh ji jj mz jl jm jn na jp jq jr ha bi translated">BERTScore利用来自BERT的预训练上下文嵌入，并通过余弦相似度匹配候选和参考句子中的单词。它已被证明与人类对句子级和系统级评估的判断相关。此外，BERTScore还计算精确度、召回率和F1值，这对于评估不同的语言生成任务非常有用。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es no"><img src="../Images/253ed6aa2bc9526e844546736ab067ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKuNUB2K2YkCXjXNszHGuA.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Bert score</figcaption></figure><p id="e04d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以我们的查询作为参考，以结果作为候选，我们计算BERT得分f1。</p><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="e0ac" class="mi lp hh ne b fi ni nj l nk nl">ranked_results_bert = []<br/><br/>for cand <strong class="ne hi">in</strong> results:<br/>    P, R, F1 = score([cand['Plot']], ref, lang='en')<br/>    ranked_results_bert.append({'Title': cand['Title'], 'Score': F1.numpy()[0]})</span><span id="a1bf" class="mi lp hh ne b fi nn nj l nk nl">Results:</span><span id="4e86" class="mi lp hh ne b fi nn nj l nk nl">'Title': 'Armed Response'<br/>'Title': 'Chappie'<br/>'Title': 'Small Soldiers'<br/>'Title': 'Galactic Armored Fleet Majestic Prince: Genetic Awakening'<br/>'Title': 'The Cape Canaveral Monsters'</span></pre><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es np"><img src="../Images/0da281c7d15c5dc8a625365ad165c593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xMpdmz4w2bZLlZ-b51mLuw.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Re-ranking Summary</figcaption></figure><p id="ef13" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下图大致代表了我们在本系列中所涉及的内容，我们没有讨论的是在显示结果或基于过去的搜索执行新的推荐时考虑用户行为。</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es nq"><img src="../Images/9da91e3cd5cb8b70f7b626695632a3dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ltHuuV_Dyok-E_4CE42N3g.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">credit: Eugene Ryan</figcaption></figure><h1 id="520c" class="lo lp hh bd lq lr ls lt lu lv lw lx ly in lz io ma iq mb ir mc it md iu me mf bi translated">使用嵌入的搜索中的个性化</h1><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es nr"><img src="../Images/de4e4f2883762c7ca51401d2892b0f26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JseeLP_GtFYN-xfvzHYYNQ.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Capturing User Interactions in Personalized Search</figcaption></figure><p id="be98" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，了解用户行为可以通过他过去的项目交互/搜索或类似的兴趣用户来完成，众所周知，每个人都是基于内容的协作推荐者。这些不仅有助于推荐，也有助于排名结果。</p><p id="c793" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="nm">在我们跳到任何公式之前，让我们明白仅仅推荐东西也依赖于项目的新近性和频率。用户最近浏览或观看的电影类型反映了他最近的品味和兴趣领域，因此我们可能希望在推荐结果项目时给它一个权重，同时将频率因素考虑在内</em>。</p><p id="4f50" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">仅以电影为例。<strong class="iy hi">用户A </strong>已经观看或与<strong class="iy hi"> 3种类型</strong>的电影互动，比如动作片、剧情片和爱情片。</p><p id="0b20" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面的数据显示了每周与每种电影类型的互动历史。这清楚地表明，用户的口味更倾向于动作片，而对爱情片的亲和力下降了。</p><div class="km kn ko kp fd ab cb"><figure class="ns kq nt nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/18efc2e4e5223b9135453a29a997ffd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*5zLMbbVwAR57zRNPYx8wwA.png"/></div></figure><figure class="ns kq ny nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/1e4aefc7cc2013d3117d83fead8441d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*wpx8crf5Db46lsKUSeABlg.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx nz di oa ob">10-week User history</figcaption></figure></div><p id="2ff8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们使用指数最近加权平均公式来汇总用户浏览历史。下面是为您推荐的<strong class="iy hi">(RFY车型)</strong>配方:</p><figure class="km kn ko kp fd kq er es paragraph-image"><div class="er es oc"><img src="../Images/8352d8c4d319ebbcaae62d5e642b4085.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*APtWEchr1_vwuWmH.png"/></div><figcaption class="kw kx et er es ky kz bd b be z dx">RFY Weightage Formula</figcaption></figure><p id="2d61" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这符合我们的假设，即最近的浏览数据对下一个动作的预测贡献最大。<br/> <strong class="iy hi"> <em class="nm"> x(i)是我们的项目向量，w(i)是基于其新近性分配的权重。</em> </strong></p><p id="b226" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">对于α= 0.5，较高的值“<em class="nm">I”</em>将被分配较高的权重。<br/> </strong>我修改了上面的一点点，在得到加权向量之前，在所有项目权重上添加了softmax。</p><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="1113" class="mi lp hh ne b fi ni nj l nk nl">***************  method-1   ****************<br/>&gt;&gt; softmax(np.asarray([weight(10), weight(8), weight(0)]))<br/>array([0.43589772, 0.29958783, 0.26451446])</span></pre><p id="ae63" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我只计算了最近的浏览数据，并计算了电影各自类型的权重。但它没有考虑过去9周的时间。因此，让我们考虑给出距离分数的东西，记住完整的用户观看历史数据分布，即<strong class="iy hi"> z分数。</strong></p><blockquote class="od oe of"><p id="4f64" class="iw ix nm iy b iz ja ii jb jc jd il je og jg jh ji oh jk jl jm oi jo jp jq jr ha bi translated">action _ movie _ zscore = stats . zscore(user _ watch _ hist[' action _ movie '])[-1][-1]drama _ movie _ zscore = stats . zscore(user _ watch _ hist[' drama _ movie '])[-1]romance _ movie _ zscore = stats . zscore(user _ watch _ hist[' romance _ movie '])[-1]</p></blockquote><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="ce04" class="mi lp hh ne b fi ni nj l nk nl">***************  method-2   ****************<br/>&gt;&gt; x = np.asarray([action_movie_zscore, drama_movie_zscore, romance_movie_zscore])<br/>&gt;&gt; softmax(x)<br/>array([0.56467654, 0.38601828, 0.04930517])</span></pre><p id="2be9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Z-score更易于计算和维护，并且是反映当前观察值离平均值有多远的强大指标。<br/>从方法-1和方法-2的softmax输出中可以清楚地看出，后者在其得分中具有更多的用户行为相关性。<br/><strong class="iy hi">基于z分数的softmax方法</strong>的额外好处是针对目录中新添加或最近添加的流派。假设你有一个新的流派，那么你添加一个对应于该流派的z值“0”。</p><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="f250" class="mi lp hh ne b fi ni nj l nk nl">&gt;&gt; x = np.asarray([action_movie_zscore, drama_movie_zscore, romance_movie_zscore, 0])<br/>&gt;&gt; softmax(x)<br/>array([0.49878136, 0.34097171, 0.04355148, 0.11669544])</span></pre><p id="9d3e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从权重分数可以看出，它赋予了比言情电影更多的权重，所以你最终的推荐在推荐上会有多样性和新鲜感。</p><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="1c2c" class="mi lp hh ne b fi ni nj l nk nl"><br/>from sentence_transformers import SentenceTransformer, util</span><span id="bd83" class="mi lp hh ne b fi nn nj l nk nl">#Compute embeddings of retrieved candidate movie plots<br/>embeddings = model.encode(candidate_plots)</span><span id="d85d" class="mi lp hh ne b fi nn nj l nk nl">#Compute cosine-similarities for each plot with user vector<br/>cosine_scores = util.pytorch_cos_sim(<strong class="ne hi">user_encoded_vector</strong>, embeddings)</span><span id="709f" class="mi lp hh ne b fi nn nj l nk nl">#Find the pairs with the highest cosine similarity scores<br/>titles = [x[‘Title’] for x in results]</span><span id="05ca" class="mi lp hh ne b fi nn nj l nk nl">ranked_user_behaviour = [{‘Title’:x ,’Score’: y} for x,y in zip(titles,cosine_scores.numpy()[0])]<br/>ranked_user_behaviour = sorted(ranked_user_behaviour, key=lambda x: x[‘Score’], reverse=True)</span></pre><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es oj"><img src="../Images/7cf33493c65c66c87402f52cbccd1a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7T7yNFTOCp5HJFTrenuVBw.png"/></div></div><figcaption class="kw kx et er es ky kz bd b be z dx">Comparison Table</figcaption></figure><p id="6f40" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们使用用户行为(<strong class="iy hi"> user_encoded_vector </strong>)来重新排列显示给<strong class="iy hi">用户A </strong>的输出。</p><p id="8e8e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当他返回主页时，我们使用相同的<strong class="iy hi"> user_encoded_vector </strong>获取最近邻居的电影，并推荐他观看。推荐会有很多动作片、戏剧和浪漫片。</p><pre class="km kn ko kp fd nd ne nf ng aw nh bi"><span id="2e69" class="mi lp hh ne b fi ni nj l nk nl">#code</span><span id="437a" class="mi lp hh ne b fi nn nj l nk nl">t=time.time()<br/>query_vector = user_encoded_vector<br/>top_k = index.search(query_vector, 20)<br/>top_k_ids = top_k[1].tolist()[0]<br/>top_k_ids = list(np.unique(top_k_ids))<br/>[fetch_movie_info(idx) for idx <strong class="ne hi">in</strong> top_k_ids]</span><span id="ece8" class="mi lp hh ne b fi nn nj l nk nl">#output</span><span id="8d35" class="mi lp hh ne b fi nn nj l nk nl">&gt;&gt;&gt;&gt; Recommendation Results in Total Time: 0.03316307067871094</span><span id="b2dd" class="mi lp hh ne b fi nn nj l nk nl">[{'Title': 'Key Witness'},<br/> {'Title': 'The Good Mother'},<br/> {'Title': 'Fire on the Amazon'},<br/> {'Title': 'Bang'},<br/> {'Title': 'How to Make a Monster'},<br/> {'Title': 'Hammers Over the Anvil'},<br/> {'Title': 'The Nursemaid Who Disappeared'},<br/> {'Title': 'Third Person'},<br/> {'Title': 'You Were Never Really Here'},<br/> {'Title': 'Shadow Dancing'},<br/> {'Title': 'Remembrance'},<br/> {'Title': 'Small Town Murder Songs'},<br/> {'Title': 'Eadweard'},<br/> {'Title': 'Caught in the Web'},<br/> {'Title': 'Bounty Hunters'},<br/> {'Title': 'Fulltime Killer'},<br/> {'Title': 'Amar'},<br/> {'Title': 'SMS'},<br/> {'Title': 'JAKQ Dengeki Tai'},<br/> {'Title': 'Gekijō-ban Tiger &amp; Bunny -The Beginning'}]</span></pre><p id="fcfe" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">代码:</p><div class="js jt ez fb ju jv"><a href="https://github.com/99sbr/semantic-search-with-sbert/blob/main/search-ranking.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="jw ab dw"><div class="jx ab jy cl cj jz"><h2 class="bd hi fi z dy ka ea eb kb ed ef hg bi translated">99sbr/带sbert的语义搜索</h2><div class="kc l"><h3 class="bd b fi z dy ka ea eb kb ed ef dx translated">使用S-BERT构建语义搜索，并以无人监督的方式微调您的模型</h3></div><div class="kd l"><p class="bd b fp z dy ka ea eb kb ed ef dx translated">github.com</p></div></div><div class="ke l"><div class="ok l kg kh ki ke kj kk jv"/></div></div></a></div><h2 id="3c32" class="mi lp hh bd lq mj mk ml lu mm mn mo ly jf mp mq ma jj mr ms mc jn mt mu me mv bi translated">接下来呢？</h2><ul class=""><li id="b33e" class="la lb hh iy b iz mw jc mx jf ol jj om jn on jr lf lg lh li bi translated">BERT4Rec:来自Transformer的双向编码器表示的顺序推荐</li><li id="e2e0" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">使用用户数据训练PRM(个性化重新排序模型)</li><li id="1078" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">通过增强用户地理和元特征来解决冷启动问题</li><li id="030f" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">图表:从用户或项目的邻居处学习</li><li id="bde2" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">项目2项目相似性</li><li id="8e3e" class="la lb hh iy b iz lj jc lk jf ll jj lm jn ln jr lf lg lh li bi translated">基于RFM的客户细分，实现有针对性的推荐和品牌推广。</li></ul></div></div>    
</body>
</html>