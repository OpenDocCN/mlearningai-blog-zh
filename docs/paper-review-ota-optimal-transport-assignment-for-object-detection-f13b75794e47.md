# è®ºæ–‡ç»¼è¿°:â€œOTA:ç›®æ ‡æ¢æµ‹çš„æœ€ä¼˜è¿è¾“åˆ†é…â€

> åŸæ–‡ï¼š<https://medium.com/mlearning-ai/paper-review-ota-optimal-transport-assignment-for-object-detection-f13b75794e47?source=collection_archive---------5----------------------->

## åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å›é¡¾ OTAï¼Œå®ƒæ˜¯ä¸€ç§ç”¨äºä»å…¨å±€è§’åº¦è¿›è¡Œç›®æ ‡æ£€æµ‹çš„é«˜çº§æ ‡ç­¾åˆ†é…ï¼Œå¹¶å°†åˆ†é…è¿‡ç¨‹å…¬å¼åŒ–ä¸ºä¸€ä¸ªæœ€ä¼˜è¿è¾“é—®é¢˜ã€‚

åŸæ–‡ï¼š<https://arxiv.org/pdf/2103.14259.pdf>

# **1ã€‚æ ‡ç­¾åˆ†é…**

åŸºäº CNN çš„å¯¹è±¡æ£€æµ‹å™¨ï¼Œå¦‚ YOLOã€RetinaNetã€FCOSã€CenterNetâ€¦â€¦é€šè¿‡é¢„æµ‹åˆ†ç±»æ ‡ç­¾å’Œå›å½’ä¸€ç»„é¢„å®šä¹‰é”šçš„åç§»æ¥æ£€æµ‹å¯¹è±¡(å¯¹äºåƒ FCOS è¿™æ ·çš„æ— é”šæ£€æµ‹å™¨ï¼Œç‰¹å¾ç‚¹å¯ä»¥è¢«è§†ä¸ºæ”¶ç¼©çš„é”šæ¡†ã€‚ä½œè€…å°†é”šç›’å’Œé”šç‚¹ç§°ä¸ºâ€œé”šâ€)ã€‚å› æ­¤ï¼Œä¸ºäº†è®­ç»ƒæ£€æµ‹å™¨ï¼Œä¸ºæ¯ä¸ªé”šç‚¹å®šä¹‰ cls å’Œ reg ç›®æ ‡æ˜¯ä¸€ä¸ªå¿…è¦çš„æ­¥éª¤ï¼Œè¿™åœ¨å¯¹è±¡æ£€æµ‹ä¸­ç§°ä¸º*æ ‡ç­¾åˆ†é…*ã€‚

![](img/9abbc92410e64933d0abc313402e9139.png)

**Fig. 1:** Label assignment strategies of RetinaNet and FCOS ([1])

ä¸åŒçš„æ¨¡å‹å…·æœ‰ä¸åŒçš„ç­–ç•¥æ¥åŒ¹é…æ¯ä¸ªé”šç‚¹çš„åœ°é¢çœŸå®(gt)å¯¹è±¡æˆ–èƒŒæ™¯ã€‚å¦‚å›¾ 1(a)æ‰€ç¤ºï¼ŒRetinaNet ä½¿ç”¨ IoU å°†ä¸åŒé‡‘å­—å¡”ç­‰çº§çš„é”šç›’åˆ†ä¸ºæ­£é¢å’Œè´Ÿé¢ã€‚é¦–å…ˆï¼Œå®ƒå°†æ¯ä¸ªå¯¹è±¡çš„æœ€ä½³é”šç›’å’Œ IoU > Î¸_p çš„é”šç›’æ ‡è®°ä¸ºé˜³æ€§ï¼Œç„¶åå°† IoU < Î¸_n as negatives, finally other anchor boxes are ignored during training. For the FCOS model, it divides the anchor points from various pyramid levels using spatial and scale constraint. It examines the ground-truth box anchor points as candidate positive samples, then picks the final positive samples from candidates depending on the scale range provided for each pyramid level, and lastly considers the unselected anchor points as negative samples.

![](img/fc2cb539671ab769fef968e7d17d6510.png)

**Fig. 2:** An illustration of ambiguous anchor points in object detection ([2])

However, above methods only focus on individual *gt* å¯¹è±¡çš„é”šç›’è§†ä¸ºé˜³æ€§ï¼Œè€Œæ²¡æœ‰ä»å…¨å±€è§’åº¦è€ƒè™‘ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚åœ¨å›¾ 2 ä¸­çš„ä¾‹å­ä¸­ï¼Œä¸Šè¿°æ–¹æ³•éš¾ä»¥å¤„ç†ä¸æ˜ç¡®çš„é”š(åŒæ—¶ä½œä¸ºå¤šä¸ª *gt* çš„é˜³æ€§æ ·æœ¬çš„é”š)ã€‚ç»™ä»»ä½• gt(æˆ–èƒŒæ™¯)åˆ†é…ä¸æ˜ç¡®çš„é”šä¼šåœ¨è®­ç»ƒå’Œæ¨æ–­è¿‡ç¨‹ä¸­å¼•èµ·é—®é¢˜ã€‚

> å› æ­¤ï¼Œæ›´å¥½çš„åˆ†é…ç­–ç•¥åº”è¯¥æ‘†è„±ç‹¬ç«‹åœ°ä¸ºæ¯ä¸ª gt è¿½æ±‚æœ€ä¼˜åˆ†é…çš„æƒ¯ä¾‹ï¼Œè€Œè½¬å‘å…¨å±€æœ€ä¼˜çš„æ€æƒ³ï¼Œæ¢å¥è¯è¯´ï¼Œä¸ºå›¾åƒä¸­çš„æ‰€æœ‰ gt å¯»æ‰¾å…¨å±€é«˜ç½®ä¿¡åº¦åˆ†é…ã€‚([2])

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½œè€…æå‡ºå°†æ ‡ç­¾åˆ†é…å…¬å¼åŒ–ä¸ºæœ€ä¼˜è¿è¾“(OT)é—®é¢˜â€”â€”ä¼˜åŒ–ç†è®ºä¸­çº¿æ€§è§„åˆ’(LP)çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚

# 2.æ–¹æ³•

# **2.1 æœ€ä¼˜è¿è¾“é—®é¢˜**

æœ€ä¼˜è¿è¾“(OT)é—®é¢˜æè¿°å¦‚ä¸‹:å‡è®¾åœ¨æŸä¸€åœ°åŒºæœ‰ *m* ä¸ªä¾›åº”å•†å’Œ *n* ä¸ªéœ€æ±‚è€…ã€‚ç¬¬ *i* ä¾›æ–¹æŒæœ‰ *s_i* å•ä½è´§ç‰©ï¼Œè€Œç¬¬ *j* éœ€æ–¹éœ€è¦ *d_j* å•ä½è´§ç‰©ã€‚æ¯å•ä½è´§ç‰©ä»ä¾›æ–¹ *i* åˆ°éœ€æ–¹ *j* çš„è¿è¾“æˆæœ¬ç”¨ *c_{ij}* è¡¨ç¤ºã€‚OT é—®é¢˜çš„ç›®æ ‡æ˜¯å¯»æ‰¾ä¸€ä¸ªè¿è¾“è®¡åˆ’Ï€*={ *Ï€_{iï¼Œj}* | *i* =1ï¼Œ2ï¼Œâ€¦ *m* ï¼Œ *j* = 1ï¼Œ2ï¼Œâ€¦ï¼Œ *n* }ï¼Œæ ¹æ®è¯¥è¿è¾“è®¡åˆ’ï¼Œä¾›åº”å•†çš„æ‰€æœ‰è´§ç‰©éƒ½å¯ä»¥ä»¥æœ€å°çš„è¿è¾“æˆæœ¬è¿è¾“åˆ°éœ€æ±‚æ–¹:

![](img/8c5bb159380c6dab5024072adf8be820.png)

è¿™æ˜¯ä¸€ä¸ªå…·æœ‰å¤šé¡¹å¼æ—¶é—´è§£çš„çº¿æ€§ç¨‹åºã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ç§å«åš Sinkhorn-Knopp çš„å¿«é€Ÿè¿­ä»£æ–¹æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜(è¯¦è§[2])ã€‚

# 2.2 æ ‡ç­¾åˆ†é…åŠ ç­

å‡è®¾ä¸€ä¸ªå›¾åƒè¾“å…¥ *I.* æœ‰ *m* *gt* ä¸ªç›®æ ‡å’Œ *n* ä¸ªé”šç‚¹ï¼Œæˆ‘ä»¬å°†æ¯ä¸ª *gt* è§†ä¸ºæ‹¥æœ‰ *k* ä¸ªæ­£æ ‡ç­¾å•ä½çš„ä¾›åº”è€…(å³ *s_i = k* )ï¼Œæ¯ä¸ªé”šç‚¹è§†ä¸ºéœ€è¦ä¸€ä¸ªæ ‡ç­¾å•ä½çš„éœ€æ±‚è€…(å³ *d_j = 1 ã€T43 ä» *gt_{i}* åˆ°é”š *a_j* è¿è¾“ä¸€ä¸ªå•ä½æ­£æ ‡ç­¾çš„æˆæœ¬ *c^{fg}* å®šä¹‰ä¸ºå®ƒä»¬çš„ *cls* å’Œ *reg* æŸè€—çš„åŠ æƒæ€»å’Œï¼›*

![](img/e2ce321b4fb094f4f3066f91f923e334.png)![](img/532ddb10b22af8dc5fcf53f818a54d11.png)

**Fig. 3:** An iIlustration of IoU loss ([3])

é™¤æ­¤ä¹‹å¤–ï¼Œå¤§é‡çš„ä¸»æ’­åœ¨è®­ç»ƒæ—¶è¢«å½“ä½œè´Ÿæ ·æœ¬ã€‚ä½œè€…ä»‹ç»å¦ä¸€å®¶ä¾›åº”å•†â€”â€”*èƒŒæ™¯*ï¼Œåªæä¾›è´Ÿé¢æ ‡ç­¾ã€‚*åå°*å¯æä¾›çš„åº•ç‰‡æ•°é‡ä¸º*n mÃ—k*ä»*åå°*è¿é€ä¸€å¼ åº•ç‰‡åˆ° *a_j* çš„è´¹ç”¨å®šä¹‰ä¸º:

![](img/4d2638504cfcccd184b402db31772013.png)

å…¶ä¸­âˆ…æŒ‡çš„æ˜¯*èƒŒæ™¯*é˜¶å±‚ã€‚ä¾›åº”å‘é‡ *s* åº”ç›¸åº”æ›´æ–°ä¸º:

![](img/9d6fff30159f282c9c16387685705653.png)

ç”±äºæˆ‘ä»¬å·²ç»æœ‰äº†æˆæœ¬çŸ©é˜µï¼Œä¾›åº”å‘é‡ *s* å’Œéœ€æ±‚å‘é‡ *dï¼Œ*æœ€ä¼˜è¿è¾“è®¡åˆ’Ï€*å¯ä»¥é€šè¿‡ç°æˆçš„ Sinkhorn-Knopp è¿­ä»£æ¥æ±‚è§£è¿™ä¸ª OT é—®é¢˜ã€‚**æ³¨æ„åˆ° OTA ä»…å¢åŠ äº†ä¸åˆ° 20%çš„æ€»è®­ç»ƒæ—¶é—´ï¼Œå¹¶ä¸”åœ¨æµ‹è¯•é˜¶æ®µå®Œå…¨å…è´¹ã€‚**

# 2.3 é«˜çº§è®¾è®¡

![](img/6f6fc0c24e209785e3ab132f2cba4b6c.png)

**Fig. 4:** An iIlustration of Optimal Transport Assignment. ([2])

ä»¥å‰çš„æ–¹æ³•åªä»æœ‰é™é¢ç§¯çš„å¯¹è±¡çš„ä¸­å¿ƒåŒºåŸŸé€‰æ‹©æ­£é”šç‚¹ï¼Œç§°ä¸º**ä¸­å¿ƒå…ˆéªŒã€‚**å¯¹äº COCO è¿™æ ·çš„ä¸€èˆ¬æ£€æµ‹æ•°æ®é›†ï¼Œä½œè€…å‘ç°ä¸­å¿ƒå…ˆéªŒä»ç„¶æœ‰åˆ©äº OTA çš„è®­ç»ƒã€‚å› æ­¤ï¼Œä»–ä»¬åœ¨æˆæœ¬çŸ©é˜µä¹‹å‰å¼ºåŠ äº†ä¸€ä¸ªä¸­å¿ƒã€‚å¯¹äºæ¯ä¸ª *gt* ï¼Œä»–ä»¬æ ¹æ®é”šä¸*gt çš„ä¸­å¿ƒè·ç¦»ï¼Œä»æ¯ä¸ª FPN ç­‰çº§ä¸­é€‰æ‹© *r^2* æœ€è¿‘çš„é”šã€‚*å¯¹äºä¸åœ¨ *r^2* æœ€æ¥è¿‘åˆ—è¡¨ä¸­çš„é”šï¼Œå®ƒä»¬åœ¨æˆæœ¬çŸ©é˜µ *c* ä¸­çš„å¯¹åº”æ¡ç›®å°†æœä»é¢å¤–çš„æ’å®šæˆæœ¬ï¼Œä»¥é™ä½å®ƒä»¬åœ¨è®­ç»ƒé˜¶æ®µè¢«åˆ†é…ä¸ºæ­£æ ·æœ¬çš„å¯èƒ½æ€§ã€‚

**åŠ¨æ€ *k* ä¼°ç®—ã€‚**é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¯ä¸ª *gt* çš„åˆé€‚æ­£é”šæ•°é‡åº”è¯¥æ˜¯ä¸åŒçš„ï¼Œå¹¶åŸºäºè®¸å¤šå› ç´ ï¼Œå¦‚å¯¹è±¡çš„å¤§å°ã€æ¯”ä¾‹å’Œé®æŒ¡æ¡ä»¶ç­‰ã€‚ä½œè€…æå‡ºäº†ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•ï¼Œæ ¹æ® IoU ç²—ç•¥ä¼°è®¡æ¯ä¸ª gt çš„æ­£ç¡®é”šå®šæ•°é‡ã€‚

> å…·ä½“æ¥è¯´ï¼Œå¯¹äºæ¯ä¸ª *gt* ï¼Œæˆ‘ä»¬æ ¹æ® IoU å€¼é€‰æ‹©å‰ q ä¸ªé¢„æµ‹ã€‚è¿™äº› IoU å€¼åŠ èµ·æ¥ä»£è¡¨è¿™ä¸ª *gt* ä¼°è®¡çš„æ­£é¢é”šæ•°é‡ã€‚æˆ‘ä»¬å°†è¿™ç§æ–¹æ³•ç§°ä¸ºåŠ¨æ€ k ä¼°è®¡ã€‚è¿™ç§ä¼°è®¡æ–¹æ³•åŸºäºä»¥ä¸‹ç›´è§‰:å¯¹äºæŸä¸ª *gt* çš„åˆé€‚çš„æ­£é”šçš„æ•°é‡åº”è¯¥ä¸å¾ˆå¥½åœ°å›å½’è¯¥ *gt çš„é”šçš„æ•°é‡æ­£ç›¸å…³ã€‚*(ã€2ã€‘)

ç»“è®ºï¼Œæœ€ä¼˜äº¤é€šåˆ†é…ç®—æ³•å¦‚å›¾ 5 æ‰€ç¤º(åŒ…æ‹¬ä¸­å¿ƒå…ˆéªŒå’ŒåŠ¨æ€ k ä¼°è®¡)ã€‚

![](img/53d0159f32c15a2194703335302b9ffd.png)

**Fig. 5:** Optimal Transport Assignment algorithm. ([2])

# 3.å®éªŒå’Œç»“æœ

# 3.1 FCOS

åœ¨å®éªŒä¸­ï¼Œä½œè€…ä½¿ç”¨äº† FCOSâ€”â€”ä¸€ç§ç®€å•çš„æ— é”šæ¢æµ‹å™¨ã€‚é€šè¿‡æ¶ˆé™¤é¢„å®šä¹‰çš„é”šç›’é›†ï¼ŒFCOS é¿å…äº†ä¸é”šç›’ç›¸å…³çš„è®¡ç®—ï¼Œä¾‹å¦‚åœ¨è®­ç»ƒæœŸé—´è®¡ç®—é‡å ã€‚å®ƒè¿˜é¿å…äº†ä¸é”šç›’ç›¸å…³çš„æ‰€æœ‰è¶…å‚æ•°ï¼Œè¿™äº›è¶…å‚æ•°é€šå¸¸å¯¹æœ€ç»ˆæ£€æµ‹æ€§èƒ½éå¸¸æ•æ„Ÿã€‚æˆ‘ä»¬åœ¨ MS COCO 2017 ä¸Šè¿›è¡Œäº†å¤§é‡å®éªŒï¼Œè¯¥å®éªŒåˆ†åˆ«åŒ…å«å¤§çº¦ 118kã€5k å’Œ 20k çš„è®­ç»ƒã€val å’Œæµ‹è¯•å¼€å‘é›†å›¾åƒã€‚

![](img/cee366b3c2e4b47868bd7c0fb0915488.png)

**Fig. 6:** The network architecture of FCOS. ([4])

# 3.1 ç»“æœ

ä¸‹é¢çš„å›¾ç‰‡æ˜¯å¾—åˆ°çš„ä¸€äº›å¯¹æ¯”ç»“æœ(ç»†èŠ‚åœ¨åŸæ–‡ä¸­)ã€‚

![](img/b314556bc308403ff2a6b2b93004d90a.png)

**Fig. 7:** Performances of different label assigning strategies([2])

![](img/a39908e3ecf5cd3c32f2c1438d90fe2a.png)

**Fig. 7:** Visualizations of assigning results ([2])

![](img/ecfc948b30ebbe45a1fd65c9e25df543.png)

**Fig. 8:** Performance comparison with state-of-the-art one-stage detectors on MS COCO 2017 ([2])

![](img/7a1f28da358b06f4cb83fa9d4ca59fdc.png)

**Fig. 9:** Performance comparison on the CrowdHuman validation
set. ([2])

# ç»“è®º

OTA å°†ç‰©ä½“æ£€æµ‹ä¸­çš„æ ‡è®°è¿‡ç¨‹è½¬åŒ–ä¸ºæœ€ä¼˜è¿è¾“é—®é¢˜ï¼Œç›®æ ‡æ˜¯ä»¥æœ€å°‘çš„æˆæœ¬å°†æ ‡ç­¾ä»çœŸå®ç‰©ä½“å’ŒèƒŒæ™¯ä¼ é€åˆ°é”šç‚¹ã€‚ä½† OTA ä½¿ç”¨ Sinkhorn-Knopp è¿­ä»£ç®—æ³•ï¼Œå¸¦æ¥ 20%çš„é¢å¤–è®­ç»ƒæ—¶é—´ï¼Œè®­ç»ƒæˆæœ¬ç›¸å½“é«˜ã€‚

æ‚¨å¯ä»¥åœ¨ä»¥ä¸‹ç½‘å€æ‰¾åˆ°è®ºæ–‡çš„å®˜æ–¹æºä»£ç :

[](https://github.com/Megvii-BaseDetection/OTA) [## GitHub -æ—·è§†ç§‘æŠ€-åŸºç¡€æ£€æµ‹/OTA:æ­£å¼å®æ–½æˆ‘ä»¬çš„ CVPR2021 è®ºæ–‡â€œOTA:æœ€ä½³â€¦

### è¿™ä¸ªé¡¹ç›®ä¸ºæˆ‘ä»¬çš„ CVPR2021 è®ºæ–‡â€œOTA:å¯¹è±¡çš„æœ€ä¼˜è¿è¾“åˆ†é…â€æä¾›äº†ä¸€ä¸ªå®ç°

github.com](https://github.com/Megvii-BaseDetection/OTA) 

***å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·åœ¨ä¸‹æ–¹è¯„è®ºæˆ–é€šè¿‡***[***LinkedIn***](https://www.linkedin.com/in/tuan-nguyen85/)***æˆ–***[***github***](https://github.com/anhtuan85)è”ç³»æˆ‘

å¦‚æœä½ å–œæ¬¢è¿™ä¸ªï¼Œè¯·è€ƒè™‘æ”¯æŒæˆ‘ã€‚

[![](img/81047f44c89ac80b25a2614f96e6d829.png)](https://ko-fi.com/anhtuan85)

# èµ„æº:

[1]è‡ªé€‚åº”è®­ç»ƒæ ·æœ¬é€‰æ‹©:[https://arxiv.org/pdf/1912.02424.pdf](https://arxiv.org/pdf/1912.02424.pdf)

[2]å¤ªç”°:[https://arxiv.org/pdf/2103.14259.pdf](https://arxiv.org/pdf/2103.14259.pdf)

[3]UnitBox:[https://arxiv.org/pdf/1608.01471.pdf](https://arxiv.org/pdf/1608.01471.pdf)

[4]https://arxiv.org/pdf/1904.01355.pdf[FCOS](https://arxiv.org/pdf/1904.01355.pdf)

ã€5ã€‘çº¦æ´›å¤« 4:[https://arxiv.org/pdf/2004.10934.pdf](https://arxiv.org/pdf/2004.10934.pdf)

[](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb) [## Mlearning.ai æäº¤å»ºè®®

### å¦‚ä½•æˆä¸º Mlearning.ai ä¸Šçš„ä½œå®¶

medium.com](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb) 

ğŸ”µ [**æˆä¸ºä½œå®¶**](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb)