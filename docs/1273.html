<html>
<head>
<title>Evaluation of a Prenatal Screening test — simulation in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">产前筛查试验的评价——R</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/evaluation-of-a-prenatal-screening-test-simulation-in-r-239844058853?source=collection_archive---------3-----------------------#2021-11-10">https://medium.com/mlearning-ai/evaluation-of-a-prenatal-screening-test-simulation-in-r-239844058853?source=collection_archive---------3-----------------------#2021-11-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="69b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jc translated">产前筛查的目的是在遗传疾病的任何迹象或症状出现之前识别该疾病。焦点是每个人的23对染色体，因为它们包含了你所有的DNA。这些测试是专门设计来检测偏离常态的。</p><p id="6c91" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">三种最常见的疾病是唐氏症、爱德华氏症和帕托氏症。分别在21号、18号和13号染色体上发现了异常。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/ad7840301c5a0935714a5c3c74559b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Iaj78gFAYCz7VJF0IdeHA.png"/></div></div></figure><p id="4c34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">评估筛选测试的可用性意味着你必须处理测试预测尚未发生的事情的能力。因此，每个测试都提供一个概率作为结果。因此，要评估一项测试，你需要设计和实验，并将测试结果与“黄金标准”结合起来。在这种情况下，金标准就是身体病史&amp;检测染色体异常的DNA测试。</p><p id="dd42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有了这样的数据集，我们可以创建一个2*2的表，告诉您测试预测阳性/阴性的频率以及黄金标准检测阳性/阴性的频率。</p><p id="1f1b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从2*2表格中，我们可以得出<a class="ae jx" href="https://online.stat.psu.edu/stat507/lesson/10/10.3" rel="noopener ugc nofollow" target="_blank">四个最常见的指标，通过这些指标来评估测试的预测能力</a>:</p><ol class=""><li id="a3bc" class="jy jz hh ig b ih ii il im ip ka it kb ix kc jb kd ke kf kg bi translated"><strong class="ig hi">敏感度</strong>，这是一项测试将在患病者中显示“疾病”的概率。</li><li id="42f0" class="jy jz hh ig b ih kh il ki ip kj it kk ix kl jb kd ke kf kg bi translated"><strong class="ig hi">特异性</strong>，即未患病者中检测结果为阴性者的比例。</li><li id="1a0f" class="jy jz hh ig b ih kh il ki ip kj it kk ix kl jb kd ke kf kg bi translated"><strong class="ig hi">阳性预测值(PPV) </strong>，即如果检测呈阳性，某人患该病的概率。</li><li id="1551" class="jy jz hh ig b ih kh il ki ip kj it kk ix kl jb kd ke kf kg bi translated"><strong class="ig hi">阴性预测值(NPV) </strong>，即如果检测结果为阴性，某人没有患病的概率。</li></ol><p id="2e56" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PPV和NPV都取决于疾病在人群中的流行程度，因此遵循<a class="ae jx" href="https://en.wikipedia.org/wiki/Bayes%27_theorem" rel="noopener ugc nofollow" target="_blank">贝叶斯定理</a>，该定理基于可能与事件相关的条件的先验知识，规定了事件的概率。</p><p id="4e70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面您可以找到感兴趣的疾病的这些指标的值。</p><div class="jm jn jo jp fd ab cb"><figure class="km jq kn ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/7b0e6058f9ecc88e8548835cd82b03a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*bXohpu4ufbADur7gBOwTSg.png"/></div></figure><figure class="km jq ks ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/1d5cab4a3716bf4d7229d31af7d436f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*vZWFXvWDH6lulFl0Sb_O0w.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx kx di ky kz">The 2*2 matrix to evaluate a test by using a gold standard. Next to the table you see the calculations for estimating the four most common metrics of a test.</figcaption></figure></div><div class="ab cb"><figure class="km jq la ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/47928d78bfc5c82957aad4042bdb3290.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*vaM-_QC9iXIKP0YSNtNwBQ.png"/></div></figure><figure class="km jq lb ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/4632af829547f08e299fdbd94f9aa199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*tlOvvSrOjNhkR7e5ZLtTEA.png"/></div></figure></div><div class="ab cb"><figure class="km jq lc ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/98393b28db7c95c7f9f1b1bd895433dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*cgg0nJbJYj_TCNIeulAFig.png"/></div></figure><figure class="km jq ld ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/2e08a8decfb2c46b068cfa07f47a91d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*khuTWC-eJfvC2J-S7565jw.png"/></div></figure></div><div class="ab cb"><figure class="km jq le ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/a6729b6dfb3cefed235a8fcc23ccb8c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*cqTLdDADUprj6y5C4RyTHw.png"/></div></figure><figure class="km jq lf ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/69d32bdbc30629d90d6dc687f983c451.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*wF1kTeZQPDWT5x1RauDDqw.png"/></div></figure></div><div class="ab cb"><figure class="km jq lg ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/380c7aed5507d44ea5ef3a19407ee1e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*hMdakhhpXl_IobcwmFqHqg.png"/></div></figure><figure class="km jq lh ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/d93f53e74d28fa50a051ff434ee60809.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*kcXHCxCmh7P16QC5RJpimg.png"/></div></figure></div><div class="ab cb"><figure class="km jq li ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/0b6b5ae8ffed45da823fcc6b0876edad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*DlNfKOjDA1BK6kfyz4hF2Q.png"/></div></figure><figure class="km jq lj ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/b36a31ace2a171f27f1eb2a87a16f72d.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*K4cvcU1iQC4nEqZpYj7oOQ.png"/></div></figure></div><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lk"><img src="../Images/ac765752947b5cd9f077bdfe4307e317.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L3bdhyF1EArRlRjTK43BOw.png"/></div></div></figure></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><p id="e3bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jc translated">现在，让我们开始模拟产前检查的流行性、敏感性和特异性对PPV和NPV的影响。我将使用从文献中获得并在上面描述的值。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="ls lt l"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">A function to determine the PPV can be found here.</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lu"><img src="../Images/3ea8f1805cd67eefcc7eb2eea9ca4627.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*ZaLmSJ3bkIAtkU-eN886fw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">PPV is based on the prevalence, sensitivity, and specificity.</figcaption></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="ls lt l"/></div></figure><div class="jm jn jo jp fd ab cb"><figure class="km jq lv ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/7ea0b72855df5fa0804bb777d56b42eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*EbRhKK6-IYGDRt60tof0cA.png"/></div></figure><figure class="km jq lw ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/bcebb9e91be650a8e70e6754c9caa7da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*_c4hwTmftWQeXZR7MrAwgg.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx lx di ly kz">PPV as a function of the prevalence</figcaption></figure></div><div class="ab cb"><figure class="km jq lz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/b043075913019bb18afebfc17241f9cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Q2g2dLZd2hBN6q58n_CYuQ.png"/></div></figure><figure class="km jq lz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/df81f6d9b4572abce122588972731ae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*xrdwz7IIsB9Am9j6lDtOcw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx ma di mb kz">Minor changes in the prevalence can have a big impact on the PPV given a certain sensitivity and specificity.</figcaption></figure></div><p id="17fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里重要的是区分预测试和后测概率。预测试概率就是疾病在人群中的患病率。这是底线。后验概率是患病率(在贝叶斯定理中是先验的),而检验数据则是可能性。提供后验(检验后)概率。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es mc"><img src="../Images/e1dfa00613b7110117fbe2a4563d0a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTQaBEypUrEYtOhUJXTRRQ.png"/></div></div></figure><p id="58d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们看看PPV是如何随着患病率和特异性的变化而变化的。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="ls lt l"/></div></figure><div class="jm jn jo jp fd ab cb"><figure class="km jq md ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/14739cfdc2403a408494884a49d59bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*zt_rcYfJB4jSv3ghOMqJ2g.png"/></div></figure><figure class="km jq me ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/3b7569b819de5ab638bb204afcb35aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*4KQwlvLT1Ovp5mdwhMD62g.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx mf di mg kz">The relationship between prevalence, sensitivity, and specificity is clear.</figcaption></figure></div><p id="7b7b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在是灵敏度的变化。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es mh"><img src="../Images/3d74d95b126f16126a87b9c47e456282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qnkwjLpHIKPULmdSyKY2OA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Not so big as for the specificity, which has to do with how the metrics are build up.</figcaption></figure><p id="fec6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们前进到似然比的领域。LR代表一个因子，在给定阳性/阴性测试结果的情况下，通过该因子，您患/未患该疾病的概率增加/减少。这是测试的内在指标。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="ls lt l"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">Code to measure the PLR and NLR.</figcaption></figure><pre class="jm jn jo jp fd mi mj mk ml aw mm bi"><span id="c131" class="mn mo hh mj b fi mp mq l mr ms">[1] 0.0314379973 0.0001897793</span></pre><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es mt"><img src="../Images/84a11e18afbd028c4c38995d5ab9738e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*tQK2G3ylqZjLo7z98iOA2A.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx">And the dataset with values based on the sensitivity and specificity.</figcaption></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="ls lt l"/></div></figure><div class="jm jn jo jp fd ab cb"><figure class="km jq lz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/d073a26188ea6388221d0bcf2d88a382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*K8SE3Ug5eYVvZHs6pICFbw.png"/></div></figure><figure class="km jq lz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/98a838564e2db5518686b0e0142cd889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*AxLyTogaKofMzuqhnatjqA.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx ma di mb kz">If a test is positive, your probability of having the disease is 18 times higher then your pre-test probability. <em class="mu">If a test is negative, your probability of having the disease is 10 times lower then your pre-test probability</em></figcaption></figure></div><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es mv"><img src="../Images/1df2990a9380937c2514720cd23c81e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sveWKhMiDgCpHC7Ni46FmA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx">Likelihood ratios for all two prenatal tests and three chromosomal deviations.</figcaption></figure><p id="e030" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，如果你想估计后验概率，你需要有前验概率和似然比，计算如下:</p><ul class=""><li id="c7c4" class="jy jz hh ig b ih ii il im ip ka it kb ix kc jb mw ke kf kg bi translated">预测优势=(预测概率/(1-预测概率)</li><li id="f1cd" class="jy jz hh ig b ih kh il ki ip kj it kk ix kl jb mw ke kf kg bi translated">测验后优势=测验前优势*可能性比率</li><li id="7a84" class="jy jz hh ig b ih kh il ki ip kj it kk ix kl jb mw ke kf kg bi translated">事后检验概率=事后检验优势/(事后检验优势+ 1)</li></ul><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es mv"><img src="../Images/1df2990a9380937c2514720cd23c81e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sveWKhMiDgCpHC7Ni46FmA.png"/></div></div></figure></div><div class="ab cl ll lm go ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ha hb hc hd he"><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="ls lt l"/></div></figure><div class="jm jn jo jp fd ab cb"><figure class="km jq lz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/35a5346d327ac6b07474f366644cf356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ft5jZdQM2tvGkWMvVA2hDw.png"/></div></figure><figure class="km jq lz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/3fbe1edc0cd469632707e79b8c508fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ca659wd_d-hyu15rz96kCw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx ma di mb kz">The baseline chance of a chromosomal abnormality is dependent on the age at pregnancy.</figcaption></figure></div><p id="45f3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以及与更完美的测试(灵敏度和特异性均为99%)相比，基于阴性和阳性测试来估计测试后概率的函数和代码。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="ls lt l"/></div></figure><div class="jm jn jo jp fd ab cb"><figure class="km jq lz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/ec4b27caf61eab6e7ee5a1afe1fed842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*0AAqFP3e5Sm6HDeEszW7Ew.png"/></div></figure><figure class="km jq lz ko kp kq kr paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><img src="../Images/70a877fd4b6658a4220f18e43e553d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*xZ58MJu6vcFXPFOTp23mCw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx ma di mb kz">And the results, which show that the NIPT is a good as it gets</figcaption></figure></div><p id="4b18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望你喜欢！如果有什么不对劲，请告诉我！</p><div class="mx my ez fb mz na"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hi fi z dy nf ea eb ng ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">medium.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no jv na"/></div></div></a></div></div></div>    
</body>
</html>