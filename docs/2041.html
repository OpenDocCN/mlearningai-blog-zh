<html>
<head>
<title>How to Install the NVIDIA CUDA Toolkit 11.2 and cuDNN 8.1 for TensorFlow in WSL2 — Ubuntu 20.04 LTS with Anaconda Support</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在wsl 2-Ubuntu 20.04 LTS中安装支持Anaconda的用于TensorFlow的NVIDIA CUDA Toolkit 11.2和cuDNN 8.1</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/how-to-install-the-nvidia-cuda-toolkit-11-2-a94d86a45d38?source=collection_archive---------0-----------------------#2022-02-26">https://medium.com/mlearning-ai/how-to-install-the-nvidia-cuda-toolkit-11-2-a94d86a45d38?source=collection_archive---------0-----------------------#2022-02-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es il"><img src="../Images/8e7df9e462cdfc9b5226a5ce1afb45f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-FZIXF3g-vhzIPp5"/></div></div><figcaption class="ix iy et er es iz ja bd b be z dx">Photo by <a class="ae jb" href="https://unsplash.com/@nanadua11?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nana Dua</a> on <a class="ae jb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4db3" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">因此，在这篇文章中，我将快速解释如何通过Linux的Windows子系统访问GPU加速。我个人需要Tensorflow将它用作Open3D的后端:一个现代的3D数据处理库。</p><p id="ebfb" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">当您有一台Windows机器，但需要使用专为Linux构建的东西时，问题就出现了。您的选择非常有限，要么设置双重引导，要么尝试使用WSL2。截至2021年11月，随着Windows 10(非内部人员)2021H2的发布，增加了对CUDA的支持，您现在可以在WSL2中访问主机上的GPU。这在Windows 11上同样适用。</p><p id="e9de" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">然而，安装所需的软件有些棘手，因为你需要在主机和你正在使用的WSL2发行版上做一些步骤。康达渠道的标准<a class="ae jb" href="https://anaconda.org/anaconda/cudatoolkit" rel="noopener ugc nofollow" target="_blank"> cudatoolkit </a>和<a class="ae jb" href="https://anaconda.org/conda-forge/cudnn" rel="noopener ugc nofollow" target="_blank"> cudnn </a>不工作。</p></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><h1 id="32f7" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">1-仅在Windows机器上为您的GPU安装CUDA驱动程序:</h1><ul class=""><li id="845e" class="ky kz hh je b jf la jj lb jn lc jr ld jv le jz lf lg lh li bi translated">从:<a class="ae jb" href="https://www.nvidia.com/Download/index.aspx?lang=en-us" rel="noopener ugc nofollow" target="_blank"> Nvidia官网</a>下载基于您的GPU所需的驱动程序</li></ul><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es lj"><img src="../Images/b6759e65c924d110c2387e16f847e1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SBPZuccVOAHJ4kpB6uNkkw.png"/></div></div></figure><ul class=""><li id="67df" class="ky kz hh je b jf jg jj jk jn lk jr ll jv lm jz lf lg lh li bi translated">运行下载的驱动程序并继续安装。</li></ul><h1 id="1340" class="ka kb hh bd kc kd ln kf kg kh lo kj kk kl lp kn ko kp lq kr ks kt lr kv kw kx bi translated">2-安装WSL2:</h1><ul class=""><li id="4f6d" class="ky kz hh je b jf la jj lb jn lc jr ld jv le jz lf lg lh li bi translated">打开提升的PowerShell(以管理员身份)</li></ul><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es ls"><img src="../Images/d1d4c2aebf06f7858dcad043b8f12d3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xHL2m_LSIyMkpDqA.png"/></div></div></figure><ul class=""><li id="973d" class="ky kz hh je b jf jg jj jk jn lk jr ll jv lm jz lf lg lh li bi translated">使用以下软件安装WSL2 Ubuntu-20.04:</li></ul><pre class="im in io ip fd lt lu lv lw aw lx bi"><span id="ba6b" class="ly kb hh lu b fi lz ma l mb mc">wsl --install -d Ubuntu-20.04</span></pre><ul class=""><li id="4375" class="ky kz hh je b jf jg jj jk jn lk jr ll jv lm jz lf lg lh li bi translated">安装完成后，使用以下命令登录到WSL2内核:</li></ul><pre class="im in io ip fd lt lu lv lw aw lx bi"><span id="82a4" class="ly kb hh lu b fi lz ma l mb mc">wsl -d Ubuntu-20.04</span></pre><h1 id="f60d" class="ka kb hh bd kc kd ln kf kg kh lo kj kk kl lp kn ko kp lq kr ks kt lr kv kw kx bi translated">3-安装Anaconda</h1><ul class=""><li id="dddb" class="ky kz hh je b jf la jj lb jn lc jr ld jv le jz lf lg lh li bi translated">从<a class="ae jb" href="https://www.anaconda.com/products/individual#linux" rel="noopener ugc nofollow" target="_blank"> Anaconda官网</a>下载WSL2机器中的Anaconda(Linux版)</li><li id="3d78" class="ky kz hh je b jf md jj me jn mf jr mg jv mh jz lf lg lh li bi translated">安装Anaconda(如果不知道如何安装，可以查看本<a class="ae jb" href="https://docs.anaconda.com/anaconda/install/linux/" rel="noopener ugc nofollow" target="_blank">指南</a>)。</li><li id="5b50" class="ky kz hh je b jf md jj me jn mf jr mg jv mh jz lf lg lh li bi translated">一旦安装了Anaconda，并且处于基本环境中，就可以继续安装CUDA Toolkit和CuDNN了。</li></ul><h1 id="b4cc" class="ka kb hh bd kc kd ln kf kg kh lo kj kk kl lp kn ko kp lq kr ks kt lr kv kw kx bi translated">4-安装CUDA工具包和CuDNN:</h1><ul class=""><li id="e99c" class="ky kz hh je b jf la jj lb jn lc jr ld jv le jz lf lg lh li bi translated">由于最近的Tensorflow版本需要CUDA Toolkit 11.2和CuDNN 8.1，我们将安装这些版本。只需在Ubuntu机器上运行这个命令。</li></ul><pre class="im in io ip fd lt lu lv lw aw lx bi"><span id="756f" class="ly kb hh lu b fi lz ma l mb mc">sudo apt-key adv --fetch-keys https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/7fa2af80.pub &amp;&amp; sudo sh -c 'echo "deb http://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64 /" &gt; /etc/apt/sources.list.d/cuda.list' &amp;&amp; sudo apt-get update &amp;&amp; sudo apt-get --yes install cuda-toolkit-11-2 &amp;&amp; sudo sh -c 'echo "deb http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu2004/x86_64 /" &gt; /etc/apt/sources.list.d/nvidia-machine-learning.list' &amp;&amp; sudo apt-get update &amp;&amp; sudo apt-get install --yes --no-install-recommends cuda-11-2 libcudnn8=8.1.0.77-1+cuda11.2 libcudnn8-dev=8.1.0.77-1+cuda11.2</span></pre><p id="1978" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">为了提高可读性，可以将前面的命令分成单独的命令运行(如果已经运行了前面的块，就不要运行这个命令):</p><pre class="im in io ip fd lt lu lv lw aw lx bi"><span id="ed81" class="ly kb hh lu b fi lz ma l mb mc">sudo apt-key adv --fetch-keys https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/7fa2af80.pub</span><span id="84a5" class="ly kb hh lu b fi mi ma l mb mc">sudo sh -c 'echo "deb http://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64 /" &gt; /etc/apt/sources.list.d/cuda.list'</span><span id="97b2" class="ly kb hh lu b fi mi ma l mb mc">sudo apt-get update</span><span id="10fa" class="ly kb hh lu b fi mi ma l mb mc">sudo apt-get --yes install cuda-toolkit-11-2</span><span id="e0e8" class="ly kb hh lu b fi mi ma l mb mc">sudo sh -c 'echo "deb http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu2004/x86_64 /" &gt; /etc/apt/sources.list.d/nvidia-machine-learning.list'</span><span id="affe" class="ly kb hh lu b fi mi ma l mb mc">sudo apt-get update</span><span id="a0a8" class="ly kb hh lu b fi mi ma l mb mc">sudo apt-get install --yes --no-install-recommends cuda-11-2 libcudnn8=8.1.0.77-1+cuda11.2 libcudnn8-dev=8.1.0.77-1+cuda11.2</span></pre><ul class=""><li id="77fb" class="ky kz hh je b jf jg jj jk jn lk jr ll jv lm jz lf lg lh li bi translated">完成后，通过运行<em class="mj"> BlackScholes </em>样本确认一切正常:</li></ul><pre class="im in io ip fd lt lu lv lw aw lx bi"><span id="00bd" class="ly kb hh lu b fi lz ma l mb mc">cd /usr/local/cuda-11.2/samples/4_Finance/BlackScholes</span><span id="542c" class="ly kb hh lu b fi mi ma l mb mc">sudo make</span><span id="9c8d" class="ly kb hh lu b fi mi ma l mb mc">./BlackScholes</span></pre><ul class=""><li id="edf4" class="ky kz hh je b jf jg jj jk jn lk jr ll jv lm jz lf lg lh li bi translated">如果一切正常，您应该会看到类似这样的内容</li></ul><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es mk"><img src="../Images/9e9b70e73b4d1614311ce80ad1449a41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8yd8Kl7xHK0_reVdW_nsQQ.png"/></div></div></figure><h1 id="75a2" class="ka kb hh bd kc kd ln kf kg kh lo kj kk kl lp kn ko kp lq kr ks kt lr kv kw kx bi translated">创建一个新的Anaconda环境并开始开发</h1><pre class="im in io ip fd lt lu lv lw aw lx bi"><span id="c8cd" class="ly kb hh lu b fi lz ma l mb mc">conda create -n tf2<br/>conda activate tf2<br/>conda install tensorflow<br/>python -c "import tensorflow"</span></pre><ul class=""><li id="180a" class="ky kz hh je b jf jg jj jk jn lk jr ll jv lm jz lf lg lh li bi translated">如果您看不出错过CUDA库有什么奇怪的，那么您就可以开始了！</li><li id="7326" class="ky kz hh je b jf md jj me jn mf jr mg jv mh jz lf lg lh li bi translated">您可以通过运行以下python脚本来进一步确认。它应该返回Tensorflow在WSL2上找到的GPU。</li></ul><pre class="im in io ip fd lt lu lv lw aw lx bi"><span id="7d8b" class="ly kb hh lu b fi lz ma l mb mc">import tensorflow as tf<br/>print(tf.config.list_physical_devices('GPU'))</span></pre><p id="44a7" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">这就是本指南的全部内容。编码快乐！</p><div class="ml mm ez fb mn mo"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hi fi z dy mt ea eb mu ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">medium.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc iv mo"/></div></div></a></div></div></div>    
</body>
</html>