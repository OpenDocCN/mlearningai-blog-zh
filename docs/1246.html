<html>
<head>
<title>Imputation of Longitudinal Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">纵向数据的插补</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/imputation-of-longitudinal-data-via-non-linear-mixed-models-in-r-d203b9cbabb8?source=collection_archive---------1-----------------------#2021-11-05">https://medium.com/mlearning-ai/imputation-of-longitudinal-data-via-non-linear-mixed-models-in-r-d203b9cbabb8?source=collection_archive---------1-----------------------#2021-11-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="80a7" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">通过R中的非线性混合模型</h2></div><p id="6f53" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一个好的开始，但不是最终的解决方案</p><p id="7246" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di">在</span>这篇文章中，我将分享我使用非线性混合模型对纵向数据进行插补的经验。这意味着我将展示使用生物学公式输入缺失数据的可行性。在这种情况下，奶牛提供的牛奶产量(MY)。奶牛产下幼崽并提供牛奶的时期称为产次。确切的时间通常被称为“产奶天数”(DMI)，并且已知奶牛有多胎。这些胎次是一个众所周知的预测我的常见指标，特别是因为奶牛的产奶曲线往往在不同胎次之间有所不同。</p><p id="69db" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">手头的数据集包含近10年的数据，累计超过40万次观察。数据是每日的。为了确定我的预测，我们必须首先处理肯定存在的缺失数据。尽管存在用于输入缺失数据的复杂方法，但我们现在正在处理一个已经开发出生物非线性曲线的过程，例如<a class="ae kb" href="https://www.sciencedirect.com/science/article/pii/S002203029776185X" rel="noopener ugc nofollow" target="_blank">伍德的模型</a>。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es kc"><img src="../Images/266eb2270bdd3d2d26846f1fa0ed1aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*tQKHVQ1qaMUue4BXJLZxNg.png"/></div></figure><p id="b9f5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，我们可以尝试使用众所周知的生物学公式来估算缺失值，而不是使用随机森林之类的机器学习算法或构建完整的特定条件插补模型。</p><p id="e9f2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们看看这是如何为我们工作的。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Lets import the data</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kq"><img src="../Images/dd25ec8b7733c7b867d278c66617d9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*juur0Hrgb3bv45kFj6ObYg.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">And then look at the data. We have quite some data, of which some are missing at a very high rate. The most important are Dry Matter Intake (DMI)and Milk Yield (MY). Those are abundantly present.</figcaption></figure></div><div class="ab cl kv kw go kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ha hb hc hd he"><p id="3614" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> T </span>他要做的第一件事就是在缺失的数据中进行更深入的研究。缺少多少个数据点？有模式吗？我们能在失踪人口中找到能帮助我们估算他们的关系吗？在前面的图表中，您已经看到了缺失百分比的高级概述，但现在我想更深入一些。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Some code on missing data exploration. It is all straightforward and what I am looking for are associations and things that stick out.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lc"><img src="../Images/778c84a96a5b40d05804d71cc640e598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AqOedhpFDPaeblRs-rbpRg.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Missing pattern analysis. This shows that missing observations for body weight (BW_NA) often go hand in hand with missing for Body Condition Score and BW in the morning or BW in the evening. Which is the case for 143928 observations. Then there are several more combinations which all have to do with these five variables.</figcaption></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh le lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/d986b78d6ff2b755a4489f54e21a0cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*LUMzt1KZ7OOEOaI2xbsgjA.png"/></div></figure><figure class="ld kh lj lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/5b0560ed0b7ebd8f506743793b254ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*ztFO_J3-rvxVM_OaibBskw.png"/></div></figure><figure class="ld kh lj lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/7693daa0b7e229d809d645b49d7bd12b.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*v09kvxzSL15N4a9GAVcpgQ.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx lk di ll lm">Missing data overal</figcaption></figure></div><div class="ab cb"><figure class="ld kh ln lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/f5de5ddd3ed4390671d7b26d6acd88bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*L65xlGwgwXWSb5Toq1-faw.png"/></div></figure><figure class="ld kh lo lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/537254fbfec8f05747d78386af110e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*rHaQSG-FBz7LrNeKaEQ8Dg.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx lp di lq lm">Missing data per factor</figcaption></figure></div><div class="ab cb"><figure class="ld kh lr lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/919b90c644fb2596c18ca0c7e352b96e.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*rJrpAA8FV2rYs71vuDIp_A.png"/></div></figure><figure class="ld kh lr lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/6d50010514eb782df89fa5a9c157be97.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*vCMJ4wAYZS5UFA02Pi4OSQ.png"/></div></figure><figure class="ld kh ls lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/0eb0d41e5d5fae7d89ae415b02ac890b.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*-d92gEUEHSBnbFjB9EHEMQ.png"/></div></figure></div><div class="ab cb"><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/7d1461cd07d2c5656b0edd5342399237.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*TNxHuWoRanPZCE8DI1LCjQ.png"/></div></figure><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/0135446c882e3f5e8ed60f6a938908fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*GzZx1z5HSq0MgzEC0Szwzg.png"/></div></figure><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/873f67230cc8d0aae238f3fcca486a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Oxf_eVDzln_DDtGKqtouaQ.png"/></div></figure></div><div class="ab cb"><figure class="ld kh lu lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/ccb749cdbfa5adcf37ea177f3cc86c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*iyZAwOHzn7g7l6yNbYHHwg.png"/></div></figure><figure class="ld kh lv lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/d6304f07e1a244b596c75ead369d70c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*70KhtVYsoW_WoAIuWQOElg.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx lw di lx lm">Missing data per factor extended.</figcaption></figure></div><p id="2fbc" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">总的来说，上述图表清楚地表明，缺失的数据仅限于几个变量，这些变量在我们当前的分析中几乎不起作用。当然，产奶量除外。所以，让我们深入挖掘原始数据。就我个人而言，我发现R在绘制这种数量级的数字时有些吃力。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Some code to plot the data</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ly"><img src="../Images/7ce5372c5cd5cd0b699add6dfa2cbf70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C6HPemZ3ZUE5ul7QTaUgdg.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">All 400k data points.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lc"><img src="../Images/615b3e59e37da6ce37a2541d2ff886b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWFXcXOJ7CztBn_azeuCDA.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Relationship between Milk Yield and Days in Milk as a function of parity. We have a total of 12 parities included, of which only 11 produce data. The higher the parity number, the less data we have. Also, there is a lot of variability within parity.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lz"><img src="../Images/8d3d8062fa80117a6566df7a235f0fc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3V02S9gijrgtc-JR3LQlQ.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">The relationship between Milk Yield, Days in Milk, month and year. We have almost 10 years worth of data.</figcaption></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh ma lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/02ef802728ed28ae933db46444d97b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*Daqlnj1I4XiAdTZpgtMudA.png"/></div></figure><figure class="ld kh mb lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/941e83266b5e03e322c9f6747f72fab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*sdSwto3at1a0xZS5haF4Vw.png"/></div></figure><figure class="ld kh mc lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/e0c5a1b6920d426080e0bd9daadbe337.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*7_EsalJLCb-pRr8m9cZGBQ.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx md di me lm">Relationship between Milk Yield and Days in Milk — by parity — for weeks, years, and number of calves. The plots do not reveal any interesting relationship to be honest, but then again, at these numbers, scatter plots can easily reach their visual limits.</figcaption></figure></div><div class="ab cb"><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/e8a92f3c72aae9f66f3ce82860d1370b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*4DvphJoVJDtEjaP5KuYfPw.png"/></div></figure><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/595a66d02d863b330542dde3d4458caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*f2PA7rnmNE0I2OC-3kKNcg.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mg di mh lm">Left: Relationship between Milk Yield, Days in Milk, and Parity which the Cow ID determining the color. Right: relationships plotted for several cows. As you can see, the curves have missing data, and can become quite unwieldy.</figcaption></figure></div></div><div class="ab cl kv kw go kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ha hb hc hd he"><p id="337d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在是时候进行一些非线性建模了。正如我之前所说，产奶量和产奶天数之间的关系可以用特定的公式来建模，Wood的公式就是其中之一。下面你会看到我在观察数据上应用那个公式，并评估模型拟合。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/5ccc27dc8e8fd8a4fadc0cf271d71469.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*9hDTnDuUlPXs3Mb3vARZcg.png"/></div></figure><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/c3564a5996a8ddff4a00c7e354d5c8e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Sillb9yMYBNNTrRjAKahKw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mg di mh lm">Left is the original curve by observed data, right is Wood’s formula with arbitrary values. The fit is not great.</figcaption></figure></div><p id="ac6a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">低于公式的系数。我想看到的是标准误差的大小低于估计值。这里的情况就是如此，这意味着数据可以为模型提供良好的基础。</p><div class="kd ke kf kg fd ab cb"><figure class="ld kh mi lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/1f64ab73577c849822959e6edfeeb3ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*jTFgZ8ebVjuGAxlhcyodEQ.png"/></div></figure><figure class="ld kh mj lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/2d5ab2d7c500c92a63a1761612bbbe07.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*aVKrVycUhaPjWIA2pSETDg.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mk di ml lm">Results including a correlation matrix. That correlation matrix is very important since extremely high correlation means that the formula can be simplified. A and C seem to have high correlation, but we have not included random effects yet. Since the formula has also been tried and tested, I will leave it for now as it is.</figcaption></figure></div><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es mm"><img src="../Images/c6aa8677f31af63fe6139ebef96ae619.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*ULKxp2tVi70xD3XEkAh1iw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Confidence intervals looking quite good — not too broad.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es lc"><img src="../Images/32423fa31f7b35489e3dfcc8db2fb315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcAc0NobtOjPknzQKJTDgQ.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Observed data with overlaid lines — first guess in red and fitted line by non-linear model in green. The non-linear model fits the data really good, even though it is not perfect. Remember that the NLS formula fits a marginal model — for each cow and each parity the same parameters apply. As such, its quite amazing to pick a good fit in this example since it could have easily been way off.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es mn"><img src="../Images/ec93cc7bb1e8a3a24cf770b66381ee1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tsx5LFH3NY_pzONCgBwLFQ.png"/></div></div></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/3b80f741f4f318d91497e8a0ad485eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*fRveSBVCvByTt1lYwiPMLA.png"/></div></figure><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/4b19010bfe3691107269147022159d60.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*_3Hu71hunV0KW8anngNZRw.png"/></div></figure><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/a4ad9aeef4ccb43b1124cba77f84d559.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ndwytOnCfVraduK8cHxg2g.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mo di mp lm">Plots showing how a, b, c, and d are estimated. From these plots you also get a sense of the size of the confidence limits.</figcaption></figure></div><p id="e711" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们知道产次对产奶量曲线有巨大的影响，所以我想看看能不能通过产次来调整固定效应——<em class="mq">a</em>、<em class="mq"> b </em>、<em class="mq"> c </em>、<em class="mq">d</em>——的影响。为了简化建模，我将把自己限制在前五个部分。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Model to adjust fixed effects by parity. Rest of the code is to check the model.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es mr"><img src="../Images/37d515d2100994580f45dc37e359feaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*DgOm54FvAuLsoGmcdVyTHw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">All parameters are significant. Standard errors are mostly of a magnitude smaller than the estimate.</figcaption></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh ms lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/75ca92b282b4ccf6aa8f0788b5939269.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*zHo_VzQtjtAb0morzOpUAw.png"/></div></figure><figure class="ld kh mt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/e3794ab79ed18ee4d5aa42561b701c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*Ic-tcwdOXL7chx1BWJ5JWw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mu di mv lm">Residuals are normal but not homogenous.</figcaption></figure></div><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">A bit of a repeat from above, but with a toned down dataset and codes included to plot the fit of the model on the data.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es mw"><img src="../Images/332c3a01f0ecf1f46894e7663d9c0cbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GeJ0_Zbx3Xs-_BB8QOOUcQ.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">By modelling by parity, I can also fit different curves by parity — as you would expect. However, it is not enough and the fit is quit off at times. Also, for some, the curves are extremely unwieldy, which makes me doubt if daily values are sufficient for such a model. Nevertheless, the dataset on daily values is the most informative, so lets stick with it and build more advanced models.</figcaption></figure><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Code to create calibration plots.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es mw"><img src="../Images/63789ff1bac5dcd32d42a53c035cacbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OyykjwPXIHKbi25Afn4-Sw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">And a confirmation of what we already saw earlier — the models predicts well globally but is complete off when you zoom in towards a more granular level.</figcaption></figure></div><div class="ab cl kv kw go kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ha hb hc hd he"><p id="3143" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在构建模型时，我希望id之间有尽可能多的差异，因为我可以将这些差异建模，并将其包含在内。包含方差通常有助于预测，但对解释没什么帮助。尤其是在处理纵向数据时。我们已经看到，我们可以通过将奇偶校验作为四个固定因素中每一个的虚拟变量来提高预测准确性。现在，我们将添加随机截距和斜率，允许参数在奶牛水平上移动。因此，我们将把我们的非线性模型转换成非线性混合模型(NLMM)。关于<a class="ae kb" rel="noopener" href="/@marc.jacobs012/non-linear-mixed-model-in-r-a6fc054c3f82"> NLMM </a>和<a class="ae kb" rel="noopener" href="/@marc.jacobs012/randomness-in-mixed-models-8b7affd8a7c4">随机效果</a>的话题已经在我之前的帖子中讨论过了。</p><p id="f832" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先，我希望并需要创建一个分层数据集，这可以通过使用<a class="ae kb" href="https://cran.r-project.org/web/packages/nlme/nlme.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="iy hi"> nlme包</strong> </a>的<em class="mq"> groupedData </em>函数轻松实现。在这里，您可以看到我指定了一个数据集，在这个数据集里，我将奶牛产奶的天数嵌套在胎次内。因此，我们有一个三级数据集— DIM(0)，Cow(1)，Parity(2)。最后，我获得了一个数据集，nlme包会自动将它识别为具有我希望它识别的特定属性的分层/嵌套数据集。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es mx"><img src="../Images/5bb8d4595890000c1d047ef262bd1d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pl_qjs2chmaAOhrCI8lemw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Summary of the data</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es my"><img src="../Images/8618fb66e3169d7d952dbb0b362a81b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JfboFLKowPwcikwNFGOncA.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Structure of the data</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es mz"><img src="../Images/b1cb1d2d810acebf1ea56ffd463b0146.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*AhFqGhHiPqMWW_k6-NH0wQ.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Nested structure of the data.</figcaption></figure><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Lets plot the dataset.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es mw"><img src="../Images/f04481f80acefef8edb7d452dcee1e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vP3KLRvxi2KWOWCdBYciFg.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Some Cows have no reason to be included in this dataset</figcaption></figure><p id="d1cc" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以，现在是时候通过包含随机项来扩展非线性模型了。赋予混合模型<a class="ae kb" rel="noopener" href="/@marc.jacobs012/introduction-to-mixed-models-in-r-9c017fd83a63">的所有假设也适用于非线性混合模型。</a><a class="ae kb" rel="noopener" href="/@marc.jacobs012/randomness-in-mixed-models-8b7affd8a7c4">这意味着随机项，如误差项，需要表现出同质性和正态性</a>。下面，我指定一个模型，其中包括边际固定效应(不是通过奇偶估计)，以及对<em class="mq"> a </em>和<em class="mq"> b </em>的条件随机效应。数据集有足够的观察值和方差来进行分析。起始值来自旧的非线性公式，有助于混合模型更快地找到最佳值。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Code to create and asses a Non-Linear Mixed Model.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es na"><img src="../Images/4008c57eea6baae03c49b466e128aeec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WsA9WKMrp2gbxlg0MmoxRw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">We have four fixed effects and two random effects across 350k observations coming from five parities and 1460 cows. The fixed effects mimic the effects obtained by the non-linear formula. The random effects are for sure viable, and show a certain amount of correlation (-0.51).</figcaption></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh nb lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/3fbdaf7be9f6da731cbe3125b8cd458d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*jozuNyQJDdzZQFjvP8Qp6A.png"/></div></figure><figure class="ld kh nc lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/9ea6b29a918fd40d0d33abe2fffd755a.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*STYV1szWXfxoMVRKmuOJ7w.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx nd di ne lm">Residuals look OK overal, but are messed up when you look by parity which is where it really counts.</figcaption></figure></div><div class="ab cb"><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/6749df78e472dfb73ed6a2208ca3d774.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*7654l999u9PhUUt7L2_LOQ.png"/></div></figure><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/75788e95588ad1f476670b189a00b872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Pq4ccA2vWXhhxbcY1ND2Ew.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mg di mh lm">Random effects estimates by Cow ID and Parity. This is automatically generated because the model we specified looks across parity. You can clearly see that the random values shift across cows and parity, although only parity one and two really stick out. Afterwards, they start mimicking each other.</figcaption></figure></div><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es nf"><img src="../Images/a1d9f974ad920358cf6092fb2dbd3a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*5HYZUvA2UqUnW1pqwVZqcA.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">The intervals function provides approximate 95% confidence intervals for the fixed and random effects, including the variance and covariance components. This is important information to have as it provides a good glimpse of the underlying variability of the data.</figcaption></figure><p id="a81d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">很好，现在我有了我的基准模型，可以和我所有的新模型进行比较。因此，我会慢慢地开始建立更多的模型，在我进行的过程中加入更多固定的和随机的效果。下面，一个新的模型，其中我添加了一个额外的随机组件— <em class="mq"> c </em>。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ng"><img src="../Images/61ebfe487eb268d9ae1db444fb5a5d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqtfOdmVvbkgOq4IO2kGyw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">The random components are for sure correlated, meaning that there is quite a heavy Cow-specific effect going on.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es nh"><img src="../Images/c7856e40c8252794a0a05ac4e521a69d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*lXI0BIQag3eKD2USIGIQGg.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Before diving deeper into any of the visual and statistical model diagnostics, I want to see if my newer model is a better, more parsimonious model. For this, I chose the ANOVA function. The results are crystal clear — <strong class="bd ni">including a random effect for c</strong> creates a better model!</figcaption></figure><p id="9ddf" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我知道我的新型号是更好的型号，我可以进行评估了。</p><div class="kd ke kf kg fd ab cb"><figure class="ld kh nj lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/b58fdf00e44a6b86c502f44e2ecd6b38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*zXZaEFqc34Yan5H6xpzEpg.png"/></div></figure><figure class="ld kh nk lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/d3b99d642c4acbab7a22da2a0e05335f.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*FyGA7KK_MAOZOqo0WhWb3Q.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx nl di nm lm">Residuals make more sense, but are still not great at the parity level.</figcaption></figure></div><div class="ab cb"><figure class="ld kh nk lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/32bd03cd2ae865982d34597a90de640f.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*4fgqOv90o6vSkq_vwGK0VA.png"/></div></figure><figure class="ld kh nj lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/4d9272b996de22d9dd0f7a6cc92c870f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*LUbg23xA_jKwQ_EemNkOVw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx nn di no lm">Random effects for cow and parity. For sure, the random effect for c is warranted. The first parity stands out amongst the rest.</figcaption></figure></div><div class="ab cb"><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/4559e89ce8eac9bb59fe2aed87977ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ufxOmab-Qewaetyh34CGlQ.png"/></div></figure><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/d9ad654b70bafa65bb5e2944a9c038eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*bn98bLvJecNZ_gI7z7CFFw.png"/></div></figure><figure class="ld kh lt lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/b088cd14898a6434c2523ba65d0194b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*HXxgvsCsSpexRjn33Pi2Sw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mo di mp lm">Plots for autocorrelation and looking at residuals by parity and cow. There is for sure a presence of autocorrelation, but the residuals seem to be equal across groups. To some extent.</figcaption></figure></div><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es np"><img src="../Images/9fef816211699a95f698fce903c2f4b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ySYreeByDA0KtzzsEAlIRg.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Heatmap of the fixed effects variance-covariance matrix.</figcaption></figure><p id="52d9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们仔细看看这个模型是如何预测的，将预测叠加在观察结果之上。因为我们有缺失的数据，并且模型忽略了这些数据，所以我们也需要进行一些数据争论。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es mw"><img src="../Images/0f19b94b980acf2209b99418b85759bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jztNy85M8rurzIFy_3Jnbw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">For sure different predictions based on what level I predict — marginal (fixed), parity, or cow. The cow-level is the most specific model, looking for cow-specific effects.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es mw"><img src="../Images/218f21a67b003b57304c665e24eb3d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nUYzYLpW959509wTbj0K0g.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">And the plot showing the predicted and the observed, overlaid. Although the model surely follows the pattern of the data, it cannot — by nature — deal with any of the perturbations.</figcaption></figure><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh nq lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/0c742e0eab585d19e0e7d1bcb1263444.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*wSyNxueMNGErRz26lwPLQw.png"/></div></figure><figure class="ld kh nr lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/39f17b9bdfb9d9c93fff24bba793ec37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*zAYem7ZmFFncPQWn6LwGKA.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx ns di nt lm">Calibration plots. Although the overal plot left seems to show some nice trends, those calibration plots become sobering when shown per cow.</figcaption></figure></div><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">Code for plotting the residuals</figcaption></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh nu lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/d7710044bba33c5f369469e03c1e7dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*8mOzJcMMNKcct2hDZD4Xlw.png"/></div></figure><figure class="ld kh nv lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/071dc0474ac135ec3aa7d1877d45c0c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*Y9lOsueSO3zkV1MBNcTqyw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx nw di nx lm">Residuals are best for the Cow model. However, the long tails should not be underestimated.</figcaption></figure></div><p id="9bf2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我将开始包括一些宇称特定的固定效应，因为我们知道这些是有影响的。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ny"><img src="../Images/7340dc229cce51a94e0a1d2f5ca4f845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aO0r5p549eBkhUbRRYAJrg.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">Output starts to get bigger, fast.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es nz"><img src="../Images/ba97bc5dca1d51b8d00cf21616872e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*MP0tfMVfHbLr5AK7Q00xLw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">New model is significantly different, but not that much.</figcaption></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh oa lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/141ad15116be5dfc6b1b83b0b394d4b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*whrEMoC5HXO2FrRnU-SlCg.png"/></div></figure><figure class="ld kh ob lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/f1955987da60d4b562c3bf93a35ead2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1558/format:webp/1*OyKtjVynL5XC4qXE8OBEXQ.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx oc di od lm">Residuals have not improved much.</figcaption></figure></div><div class="ab cb"><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/d77816ecf4ac34bbd708fcef8fd9cda7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*dGxpzCV94Fznzkug2d0L3A.png"/></div></figure><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/4b33630536ec1560827c138bfdbb4e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*u1OUyoSFmFXv6eI-wdy_3A.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mg di mh lm">Also here, pretty much the same.</figcaption></figure></div><div class="ab cb"><figure class="ld kh oe lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/bbf5de947cdbdaafc9f4bb2db9397a40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*d5wI2XCRttM47p01xm-VNA.png"/></div></figure><figure class="ld kh of lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/b2ad1d5c5cb8d8d9658a025f1ceb0cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*KH35vuv2tSpQ18sVuOhyFA.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx og di oh lm">Still autocorrelation present.</figcaption></figure></div><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es oi"><img src="../Images/b0bc41b22bba90730ecaecfabf2720ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eq3C2I3TGpYe6Mv9l_mWVQ.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">The random effects for the a, b, and c. Quite some spread showing there that there are quite some cow-specific effects going on. Exactly what you want to see.</figcaption></figure><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es oj"><img src="../Images/d12fa8f51d34be80069df5e50fd8307d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HTFJF3HAilq4EM16zw2IFg.png"/></div></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es ok"><img src="../Images/2639e04739b2996522742da9cc3c5174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*Az1aTAqCzxpkEE6-3Auh9w.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">The last model, <strong class="bd ni">fit3</strong>, is better than the rest.</figcaption></figure><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div><figcaption class="km kn et er es ko kp bd b be z dx">The most advanced model so far. We can expect a large summary output from this model.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ol"><img src="../Images/6f80631f3352060e44fc3c36f35bf049.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IldwYxdbSM54xNn6nxrM1w.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">And we got it — a very large summary output.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div class="er es om"><img src="../Images/3cc7f55ecd8e04e53bae4f2faff5337b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*-AwWjDcIS74yrcDwdOfviQ.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx">And this model is also better, a lot better!</figcaption></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh on lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/217cdb286d276feb9451efc01bc3db3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*0aO1t3WnnmviqZ1ELM7nZg.png"/></div></figure><figure class="ld kh oo lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/9427ec0fcc74364c554d1ca56077917b.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*XTuf0rRhFNE5UyX1R02UfQ.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx op di oq lm">Residuals start to look better and better, for are still much broader then what you would like to see.</figcaption></figure></div><div class="ab cb"><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/6bbee24596ae111a6ff3700a1f7366cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*n487NA85ArNwgV0EcKx19Q.png"/></div></figure><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/fa3562607268479f4db592f0d62f7a68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*G-dPPKDPaK4tc2qHAbTgdw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mg di mh lm">For sure difference in effects at parity and cow level.</figcaption></figure></div><div class="ab cb"><figure class="ld kh or lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/3902a3b4ee55dbe4226ed8579a0fd9d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*cKxRvFteL6LTs-QePd6MqQ.png"/></div></figure><figure class="ld kh os lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/7e00ce026673a0a05bb3e0d798410034.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*P4pwEgtrHOxY2jtROh5P4A.png"/></div></figure><figure class="ld kh os lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/55153a2cc1f5dc2dc8334288221ef918.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*B3e4SpkLeMXBGEDohtarEw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx ot di ou lm">We still have auto-correlation, but the residuals look quite good at the parity and cow level. With some very big outliers, even when applying a model of this size.</figcaption></figure></div><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ov"><img src="../Images/26c607239ecc7cf6d11248698e2000f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dLHiMC7d7uBvLGliSxyBtQ.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">A heatmap showing the relationship between the fixed effects.</figcaption></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/944e7872d04847ac6e96f1d09c33cbd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*KGi5xlLYKh9Mb6FuXivbxg.png"/></div></figure><figure class="ld kh mf lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/7ca569f9ad1d617c456c0fd473af14e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*gEA0pS8O8HI52iLbS0ixHA.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx mg di mh lm">Heatmaps showing the relationship between the random effects per level of the random effect. Left: shows the estimates of the random effects for each of the levels of Parity. Right: shows random effects for each of the levels of Cow.</figcaption></figure></div><p id="9779" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面的预测看起来不一定比之前的模型更好。还要注意，固定效应不再适用，它与奇偶模型完全相同。这是因为数据集的结构—它与Cow一起嵌套在奇偶校验中。通过询问一整套特定于奇偶校验的固定效果，嵌套成为模型的一部分。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ow"><img src="../Images/1eec7958bc11f13ddb62d12c1073feef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ygw47nY2ZZ9ZVyTGGT5erQ.png"/></div></div></figure><div class="kd ke kf kg fd ab cb"><figure class="ld kh ox lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/14f01325edeb2674fd2b10223742d8b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*AOvoCRio5cUp1yHt7EODhA.png"/></div></figure><figure class="ld kh oy lf lg lh li paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/304d7126dccbd8c15c7f6beeece57970.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*B_I_M2fB7kHksARRwKMSfQ.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx oz di pa lm">Calibration plot below left shows how messed up predictions are, still, at the cow level.</figcaption></figure></div><p id="3d99" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这项工作的真正考验是将模型应用于原始数据，并观察它的表现。</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es pb"><img src="../Images/7b6eaa0ff69811e8505865068586c290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adlYXdpzLW7RWPwLVkVVnQ.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">A random cow, not in the model yet. You can see, only fixed / parity model is built but not a cow model, since this cow is not in the original dataset.</figcaption></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es pc"><img src="../Images/27fae714b162a30cdc731312e707ba50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qAXGQ9l0I2Otpn14kUveIw.png"/></div></div><figcaption class="km kn et er es ko kp bd b be z dx">The Wood model as imputation model. Although the model imputes the data in a biological logical line, it cannot impute the perturbations taking place.</figcaption></figure><p id="11e3" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为此，我们需要使用完全不同的模型。或许和这个模型一起。但这是另一个时间和另一个职位。</p><p id="b978" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">希望你喜欢它！</p><figure class="kd ke kf kg fd kh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><div class="pd pe ez fb pf pg"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ph ab dw"><div class="pi ab pj cl cj pk"><h2 class="bd hi fi z dy pl ea eb pm ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="pn l"><h3 class="bd b fi z dy pl ea eb pm ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="po l"><p class="bd b fp z dy pl ea eb pm ed ef dx translated">medium.com</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu ki pg"/></div></div></a></div></div></div>    
</body>
</html>