<html>
<head>
<title>How to Run Machine Learning Model inside a Docker container</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Docker容器中运行机器学习模型</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/how-to-run-machine-learning-model-inside-a-docker-container-d0f26c0ddc13?source=collection_archive---------3-----------------------#2022-02-06">https://medium.com/mlearning-ai/how-to-run-machine-learning-model-inside-a-docker-container-d0f26c0ddc13?source=collection_archive---------3-----------------------#2022-02-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="cac2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Docker 是一款打包应用程序代码及其所有依赖项的软件，提供了一个被称为<strong class="ig hi">容器</strong>的隔离环境。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/310762c1e5bbfb155738f00ad2091ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*8vi0ZQr1f-l9reqhvLrEEg.png"/></div></figure><h1 id="bcf6" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">为什么我们应该使用Docker容器来部署机器学习模型？</h1><ol class=""><li id="f66e" class="ki kj hh ig b ih kk il kl ip km it kn ix ko jb kp kq kr ks bi translated"><strong class="ig hi">我们可以很容易地在我们的系统中创建一个机器学习模型。但是，当我们想在其他系统的生产阶段使用该模型时，这是一项复杂的任务。</strong> Docker让这项任务变得更简单、更快速、更可靠。</li><li id="6f40" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">使用Docker我们可以很容易地<strong class="ig hi">重现工作环境</strong>来训练和运行不同操作系统上的模型</li><li id="ea3e" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">我们可以<strong class="ig hi">使用诸如OpenShift(一个Kubernetes发行版)之类的技术，轻松地部署您的模型，并让您的模型对客户可用。</strong></li><li id="70da" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">开发人员可以跟踪容器映像的不同版本，检查谁用什么构建了一个版本，还可以回滚到以前的版本。</li><li id="58e3" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">即使我们的机器学习应用程序<strong class="ig hi">宕机、修复或更新，它也不会停止运行。</strong></li><li id="bc83" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated"><strong class="ig hi">我们的机器学习模型通常用python等单一编程语言</strong>编写，但<strong class="ig hi">应用程序肯定需要与用不同编程语言编写的其他应用程序进行交互。Docker管理所有这些交互，因为每个微服务可以用不同的语言编写，允许可伸缩性和独立服务的轻松添加或删除。</strong></li></ol><p id="8821" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们理解如何在Docker容器中部署我们的机器学习模型。这里我就拿一个简单的<strong class="ig hi">薪资预测机器学习模型</strong>来说明工作流程。</p><ol class=""><li id="2f3b" class="ki kj hh ig b ih ii il im ip ky it kz ix la jb kp kq kr ks bi translated">为此任务创建一个单独的目录，并将您的机器学习代码复制到该目录。</li></ol><p id="e619" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.创建Dockerfile文件。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lb"><img src="../Images/e7c608a9ccd91a8f96ddd0abc7ab40e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A56XQfsMIOZGCIF5puYAEA.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lg"><img src="../Images/ad0a73c1f1d3fa4c9e301742d6404be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mkq9XkIuc_uzRLtOH_KRDQ.png"/></div></div></figure><ol class=""><li id="0817" class="ki kj hh ig b ih ii il im ip ky it kz ix la jb kp kq kr ks bi translated">这里，我使用了<strong class="ig hi"> rockylinux作为容器的基础图像</strong>。</li><li id="620b" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">安装运行代码所需的所有包。</li><li id="37a9" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated"><strong class="ig hi">复制</strong>命令将<strong class="ig hi">将指定文件从本地机器复制到容器</strong>中，该容器将使用该映像启动。</li><li id="859c" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated"><strong class="ig hi">入口点</strong> <strong class="ig hi">指定容器启动时要执行的命令。</strong></li><li id="53d4" class="ki kj hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated"><strong class="ig hi"> CMD </strong>指定将给予entry point(python 3 Salary _ predict . py)执行的程序的<strong class="ig hi">命令行输入</strong>。这被启动容器期间传递的命令行输入覆盖<strong class="ig hi">(如果有)。</strong></li></ol><p id="24f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意:<strong class="ig hi"> <em class="lh"> Entrypoint和CMD </em> </strong>，<em class="lh">都可以用来指定容器启动时要执行的命令。唯一不同的是</em> <code class="du li lj lk ll b"><em class="lh">ENTRYPOINT</em></code> <em class="lh">不允许你覆盖命令。相反，添加到</em> <code class="du li lj lk ll b"><em class="lh">docker run</em></code> <em class="lh">命令末尾的任何内容都会追加到该命令中。</em></p><p id="4c33" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.Python代码。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lb"><img src="../Images/2e513a8a5bff8a100b0677a1b8b0733a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PttdaIV1xeBcR9KLHdaxg.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lm"><img src="../Images/1bdade080ea33ff5e8541f8fde56c174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2DzTF6Ms8oyQ9qaUTq1bAQ.png"/></div></div></figure><p id="a7f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> sys </strong>模块提供了用于操纵Python运行时环境不同部分的函数和变量。</p><p id="5dae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> sys.argv </strong>是命令行参数的<strong class="ig hi">列表。</strong></p><p id="aa6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是<strong class="ig hi"> sys.argv[0] </strong>是当前Python脚本的<strong class="ig hi">名称。</strong></p><p id="1c2f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> sys.argv[1] </strong>是<strong class="ig hi">的第一个命令行参数。</strong></p><p id="9220" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> sys.argv[2] </strong>是第<strong class="ig hi">个命令行参数</strong>等等。</p><p id="39bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们为ML模型提供sys.argv[1]。</p><p id="20fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.现在，<strong class="ig hi">从上面创建的Dockerfile文件中构建</strong> <strong class="ig hi">一个映像</strong>。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lm"><img src="../Images/a1eff84e6e76f5ab86cac549e39985fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0rzGxPcBKxDsZiXbqwKsQ.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lm"><img src="../Images/ad16bba349eb705dfce3e8b938f30ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eLE-c18zTeccJB7p7uKPoQ.png"/></div></div></figure><p id="f3ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6.最后，我们准备启动我们的<strong class="ig hi">容器</strong>并运行我们的机器学习模型。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ln"><img src="../Images/fb1cb4ae382cbdbfedb3193e12dadf41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3Y7sGPEDjdsxsXtIZeN6Q.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Years of experience = 0</figcaption></figure><p id="fedb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，因为我们没有提供任何命令行参数，所以将使用0作为参数传递给程序入口点。</p><p id="3602" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.我们还可以向python代码提供命令行输入。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ls"><img src="../Images/c6465b0a6ed6cc7535171ffc17781add.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JyS26zwFr-7l4t3s8JM52A.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Years of experience = 1</figcaption></figure><p id="587a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，由于我们已经提供了命令行参数，0将被1覆盖。</p><p id="1e59" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在知道如何在Docker容器中运行机器学习模型。快乐编码。😀</p><div class="lt lu ez fb lv lw"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hi fi z dy mb ea eb mc ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">medium.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk ji lw"/></div></div></a></div><p id="581e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">成为作家</p></div></div>    
</body>
</html>