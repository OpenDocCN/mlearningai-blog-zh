<html>
<head>
<title>Growth Modelling in Piglets — 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">小猪的生长模型— 2</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/growth-modeling-in-piglets-2-8f940505551c?source=collection_archive---------4-----------------------#2022-01-21">https://medium.com/mlearning-ai/growth-modeling-in-piglets-2-8f940505551c?source=collection_archive---------4-----------------------#2022-01-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="62cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">R中通过混合模型模拟增长的另一个例子</p><p id="f5d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个例子和我之前<a class="ae jc" rel="noopener" href="/@marc.jacobs012/growth-modeling-in-piglets-534766dcad1f">发布的例子</a>有很多相似之处。所以我不会在这上面花太多的文字，让代码和图片自己说话。</p><p id="83ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为这是商业数据，我不能与你分享数据集。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="435d" class="jm jn hh ji b fi jo jp l jq jr">rm(list = ls())<br/>#### LIBRARIES ####<br/>library(lme4)<br/>library(ggplot2)<br/>library(rms)<br/>library(plyr)<br/>library(reshape2)<br/>library(boot)<br/>library(sjPlot)<br/>library(sjstats)<br/>library(sjmisc)<br/>library(interval)<br/>library(AICcmodavg)<br/>require(parallel) <br/>library(gridExtra)<br/>library(coefplot) <br/>library(coda)      <br/>library(aods3)     <br/>library(plotMCMC) <br/>library(bbmle)    <br/>library(nlme)<br/>library(merTools)<br/>library(RLRsim) <br/>library(pbkrtest)<br/>library(multcomp)<br/>library(lsmeans)<br/>library(multcompView)<br/>library(lattice)<br/>library(splines)<br/>library(lmtest)<br/>library(mgcv)<br/>library(gamm4)<br/>library(car)</span><span id="d1f3" class="jm jn hh ji b fi js jp l jq jr">### DATA MANAGEMENT ####<br/>library(readxl)<br/>Resultstotalperiod &lt;- read_excel("") <br/>DAT&lt;-Resultstotalperiod[,c(1:11)]<br/>rm(Resultstotalperiod)<br/>head(DAT)<br/>str(DAT)<br/>summary(is.na(DAT))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es jt"><img src="../Images/d3786cbbb709cbf2c3ef59ba048118f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*UOiHRMe4t58S-lj2Q1g62w.png"/></div></figure><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es jx"><img src="../Images/104b34fde8ec9cad173722c7da1a8aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*Mc2L-1hPhTCfzCGIZiT0Gw.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2408" class="jm jn hh ji b fi jo jp l jq jr">## Number of assessments per pig<br/>Z&lt;-!is.na(DAT[,6:10])<br/>DAT[ ,"nr_asses"]&lt;- as.numeric(rowSums(Z))</span><span id="e750" class="jm jn hh ji b fi js jp l jq jr">## R code to determine when last pig was observed --&gt; since there is no missing data in between, same results as previous code<br/>last.observed &lt;- function (x, time = NULL) {<br/>  if (is.null (time)) {<br/>    time &lt;- 1:length (x)<br/>  }<br/>  dropout &lt;- sapply (1:length(x),<br/>                     function (i, y) all(y[i:length(y)]), is.na (x))<br/>  ifelse (any (dropout), time[which(dropout)[1]-1], time[length(x)])<br/>}<br/>otime&lt;-c(0,07,14,28,42)<br/>DAT$last.observed &lt;- apply(DAT[,6:10], 1, last.observed)</span><span id="4da8" class="jm jn hh ji b fi js jp l jq jr"># Missing DATA pattern<br/>DAT$miss&lt;-ifelse(DAT$last.observed==DAT$nr_asses, "Mono","NonMono")<br/>table(DAT$miss) # all monotonic missing data</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es jy"><img src="../Images/25e76dca172d07b12f117ce823ae63eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*DKXRhn3Cveg_OUWpPr222Q.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="e884" class="jm jn hh ji b fi jo jp l jq jr"># Create long format<br/>DAT&lt;-as.data.frame(DAT)<br/>DAT$nr_asses&lt;-as.factor(DAT$nr_asses)<br/>DAT$miss&lt;-as.factor(DAT$miss)<br/>IRTA&lt;- reshape(DAT,<br/>               varying  = c("iBW", "7dBW", "14dBW", "28dBW","42dBW"),<br/>               v.names = "BW",<br/>               timevar = "Time",<br/>               times = as.numeric(c("0", "7", "14", "28", "42")),<br/>               direction = "long")<br/>IRTA$id&lt;-NULL<br/>IRTA&lt;-IRTA[order(IRTA$Pig),]<br/>row.names(IRTA)&lt;-NULL<br/>IRTA&lt;-IRTA[!is.na(IRTA$BW),]<br/>dim(IRTA)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es jz"><img src="../Images/bf5548fa4d844e3ecbecafded946cf0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:262/format:webp/1*OA33Mhr2jhipfDpp12CeUA.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="9193" class="jm jn hh ji b fi jo jp l jq jr">IRTA$Trt&lt;-as.factor(IRTA$Trt)<br/>IRTA$Sexe&lt;-as.factor(IRTA$Sexe)<br/>IRTA$Bloc&lt;-as.factor(IRTA$Bloc)<br/>IRTA$Fate&lt;-as.factor(IRTA$Fate)<br/>IRTA$BW&lt;-as.numeric(IRTA$BW)/1000<br/>levels(IRTA$Fate) &lt;- c("Dead", "Dead", "Slaughter")<br/>IRTA$Fate&lt;-as.character(IRTA$Fate)<br/>IRTA$Fate&lt;-ifelse(is.na(IRTA$Fate), "Finished", IRTA$Fate)<br/>IRTA$Fate&lt;-as.factor(IRTA$Fate)<br/>IRTA$Time_center&lt;-scale(IRTA$Time, center=TRUE, scale = FALSE)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ka"><img src="../Images/af3cb34520172cfdd6e415514f8f8957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NGgK-tv1uuSwxoWrM8M0Hw.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="b63f" class="jm jn hh ji b fi jo jp l jq jr">## Create dataset with baseline value<br/>IRTA_base&lt;-reshape(DAT,<br/>                   varying  = c("7dBW", "14dBW", "28dBW", "42dBW"),<br/>                   v.names = "BW",<br/>                   timevar = "Time",<br/>                   times = as.numeric(c("7", "14", "28", "42")),<br/>                   direction = "long")<br/>IRTA_base$id&lt;-NULL<br/>IRTA_base&lt;-IRTA_base[order(IRTA_base$Pig),]<br/>row.names(IRTA_base)&lt;-NULL<br/>IRTA_base&lt;-IRTA_base[!is.na(IRTA_base$BW),]<br/>dim(IRTA_base)<br/>IRTA_base$Trt&lt;-as.factor(IRTA_base$Trt)<br/>IRTA_base$Sexe&lt;-as.factor(IRTA_base$Sexe)<br/>IRTA_base$Bloc&lt;-as.factor(IRTA_base$Bloc)<br/>IRTA_base$Fate&lt;-as.factor(IRTA_base$Fate)<br/>IRTA_base$BW&lt;-as.numeric(IRTA_base$BW)/1000<br/>IRTA_base$iBW&lt;-IRTA_base$iBW/1000<br/>levels(IRTA_base$Fate) &lt;- c("Dead", "Dead", "Slaughter")<br/>IRTA_base$Fate&lt;-as.character(IRTA_base$Fate)<br/>IRTA_base$Fate&lt;-ifelse(is.na(IRTA_base$Fate), "Finished", IRTA_base$Fate)<br/>IRTA_base$Fate&lt;-as.factor(IRTA_base$Fate)<br/>IRTA_base$Time_center&lt;-scale(IRTA_base$Time, center=TRUE, scale = FALSE)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kf"><img src="../Images/2d67e5cc4dedffe79360c30fb269e9d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vH0LjluxSkpqr9GWeBI_rg.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="1045" class="jm jn hh ji b fi jo jp l jq jr">DAT2&lt;-DAT[!DAT$Week==1, ]<br/>A&lt;-list(IRTA, DAT[, c("Pig", "iBW")])<br/>IRTA&lt;-join_all(A)<br/>IRTA$iBW&lt;-IRTA$iBW/1000</span><span id="d8c9" class="jm jn hh ji b fi js jp l jq jr">TREATmelt&lt;-ddply(IRTA, c("Time", "Trt"), summarise,<br/>                 N = sum(!is.na(BW)),<br/>                 Mis = sum(is.na(BW)),<br/>                 Mean = round(mean(BW, na.rm=T),3),<br/>                 Median = round(median(BW, na.rm=T),3),<br/>                 SD = round(sd(BW, na.rm=T),3),<br/>                 SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>                 LCI = round(Mean - (2*SE),3), <br/>                 HCI = round(Mean + (2*SE),3))</span><span id="6f96" class="jm jn hh ji b fi js jp l jq jr">SEXmelt&lt;-ddply(IRTA, c("Time", "Sexe"), summarise,<br/>               N = sum(!is.na(BW)),<br/>               Mis = sum(is.na(BW)),<br/>               Mean = round(mean(BW, na.rm=T),3),<br/>               Median = round(median(BW, na.rm=T),3),<br/>               SD = round(sd(BW, na.rm=T),3),<br/>               SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>               LCI = round(Mean - (2*SE),3), <br/>               HCI = round(Mean + (2*SE),3))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es kg"><img src="../Images/5b49c74404776821cb508d07605a9ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*zLz7TmpITX3X14VP3De8xQ.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="9592" class="jm jn hh ji b fi jo jp l jq jr">SEXTREATmelt&lt;-ddply(IRTA, c("Time", "Sexe", "Trt"), summarise,<br/>                    N = sum(!is.na(BW)),<br/>                    Mis = sum(is.na(BW)),<br/>                    Mean = round(mean(BW, na.rm=T),3),<br/>                    Median = round(median(BW, na.rm=T),3),<br/>                    SD = round(sd(BW, na.rm=T),3),<br/>                    SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>                    LCI = round(Mean - (2*SE),3), <br/>                    HCI = round(Mean + (2*SE),3))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es kh"><img src="../Images/7008ceae190ef0a2dff02056dd9fefb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*yTinN6DP5NbPVEfbjHWttQ.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c244" class="jm jn hh ji b fi jo jp l jq jr">BLOCmelt&lt;-ddply(IRTA, c("Time", "Bloc", "Trt"), summarise,<br/>                N = sum(!is.na(BW)),<br/>                Mis = sum(is.na(BW)),<br/>                Mean = round(mean(BW, na.rm=T),3),<br/>                Median = round(median(BW, na.rm=T),3),<br/>                SD = round(sd(BW, na.rm=T),3),<br/>                SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>                LCI = round(Mean - (2*SE),3), <br/>                HCI = round(Mean + (2*SE),3))</span><span id="0c80" class="jm jn hh ji b fi js jp l jq jr">ASSESSmelt&lt;-ddply(IRTA, c("Time","nr_asses"), summarise,<br/>                  N = sum(!is.na(BW)),<br/>                  Mis = sum(is.na(BW)),<br/>                  Mean = round(mean(BW, na.rm=T),3),<br/>                  Median = round(median(BW, na.rm=T),3),<br/>                  SD = round(sd(BW, na.rm=T),3),<br/>                  SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>                  LCI = round(Mean - (2*SE),3), <br/>                  HCI = round(Mean + (2*SE),3))</span><span id="8899" class="jm jn hh ji b fi js jp l jq jr">ASSESSBLOCmelt&lt;-ddply(IRTA, c("Time", "Bloc","nr_asses"), summarise,<br/>                      N = sum(!is.na(BW)),<br/>                      Mis = sum(is.na(BW)),<br/>                      Mean = round(mean(BW, na.rm=T),3),<br/>                      Median = round(median(BW, na.rm=T),3),<br/>                      SD = round(sd(BW, na.rm=T),3),<br/>                      SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>                      LCI = round(Mean - (2*SE),3), <br/>                      HCI = round(Mean + (2*SE),3))</span><span id="7cd9" class="jm jn hh ji b fi js jp l jq jr">FATEmelt&lt;-ddply(IRTA, c("Time", "Fate"), summarise,<br/>                N = sum(!is.na(BW)),<br/>                Mis = sum(is.na(BW)),<br/>                Mean = round(mean(BW, na.rm=T),3),<br/>                Median = round(median(BW, na.rm=T),3),<br/>                SD = round(sd(BW, na.rm=T),3),<br/>                SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>                LCI = round(Mean - (2*SE),3), <br/>                HCI = round(Mean + (2*SE),3))</span><span id="4c47" class="jm jn hh ji b fi js jp l jq jr">FATETREATmelt&lt;-ddply(IRTA, c("Time", "Fate", "Trt"), summarise,<br/>                     N = sum(!is.na(BW)),<br/>                     Mis = sum(is.na(BW)),<br/>                     Mean = round(mean(BW, na.rm=T),3),<br/>                     Median = round(median(BW, na.rm=T),3),<br/>                     SD = round(sd(BW, na.rm=T),3),<br/>                     SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>                     LCI = round(Mean - (2*SE),3), <br/>                     HCI = round(Mean + (2*SE),3))</span><span id="971f" class="jm jn hh ji b fi js jp l jq jr">xlabs &lt;- paste(levels(IRTA$Time),"\n(N=",table(IRTA$Time), ")",sep="")</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es ki"><img src="../Images/5fe70382379eb73d4c9682e99929e277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*Ph3llncn-CEti88CVvCNbg.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="21b8" class="jm jn hh ji b fi jo jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42), labels=xlabs)<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(ASSESSmelt, aes(x=Time, y=Mean, colour=nr_asses))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_point()</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kj"><img src="../Images/bd2c47f7b2d43d3a9d0d61a46e7999dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVH3msJhfiUv7pDMkZQ-fg.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">BW over time as function of number of assessments</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="56e6" class="jm jn hh ji b fi jo jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42), labels=xlabs)<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(ASSESSBLOCmelt, aes(x=Time, y=Mean, colour=nr_asses))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_point()+<br/>  facet_wrap(~Bloc)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ko"><img src="../Images/3284c14e0ab26cf4bd6074e14dbb614d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yk7SAssCluum6rAa1CxzHQ.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="60fa" class="jm jn hh ji b fi jo jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42), labels=xlabs)<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(FATEmelt, aes(x=Time, y=Mean, colour=Fate))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_point()</span><span id="4ddb" class="jm jn hh ji b fi js jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(FATETREATmelt, aes(x=Time, y=Mean, colour=Fate))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_point()+<br/>  facet_wrap(~Trt)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/7640f698db7d3028c68a3f3f4a812dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*OE6fbRmAXTVAo_rPc73yjA.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/7c65331c196467304b63733f5698db43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*8PoxLe1jzPdLOuK3vmCj6w.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="158f" class="jm jn hh ji b fi jo jp l jq jr">droptime&lt;-table(DAT$last.observed)<br/>ndrop&lt;-cumsum(droptime)<br/>ndrop&lt;-1-ndrop[-5]/ndrop[5]<br/>ndrop&lt;-as.vector(ndrop)<br/>time&lt;-c(0,7,14,28,42)<br/>xyplot(ndrop~time[-1], <br/>       type = "o", col=2, lwd=2,<br/>       main = "BW drop out pattern",<br/>       ylab = "Proportion Still in Study",<br/>       xlab = "Time (Days)",<br/>       scales=list(x=list(at=c(0,7,14,28,42)), y=list(at=c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1), limits=c(0,1))))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kj"><img src="../Images/b31a7f7af1a0ed99d9dc5a2b526e087d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eXvuqbxVzFBw2Y5wGG5Dgg.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2a1a" class="jm jn hh ji b fi jo jp l jq jr">xyplot(log(BW)~ Time_center|Pig, data = IRTA, <br/>       strip = FALSE, aspect = "xy", pch = 16, cex=0.2, grid = TRUE,<br/>       panel = function(x, y, ..., fit, subscripts) {<br/>         panel.grid()<br/>         panel.xyplot(x, y)<br/>         panel.lmline(x, y, lty = 2, col="black")<br/>         fm&lt;-lm(y~ns(x,2))<br/>         panel.lines(x, fitted(fm), lty=2, col.line="red")<br/>         fm2&lt;-lm(y~ns(x,3))<br/>         panel.lines(x, fitted(fm2), lty=2, col.line="green")<br/>         ypred.mixed&lt;- fitted(fit.full.mixed_nodead6.3)[subscripts]<br/>         panel.lines(x, ypred.mixed, col = "orange")<br/>         ypred.mixed2&lt;- fitted(fit_nlme)[subscripts]<br/>         panel.lines(x, ypred.mixed2, col = "purple")<br/>         panel.abline(0, 0)<br/>       } )</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kv"><img src="../Images/83cf4f8f03730f2038e246467fe17f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OWmAmIrxSUxhOB5EtN8j-Q.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">A two-knot spline is probably best when on log scale, which is strange , not sure if natural</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="1f32" class="jm jn hh ji b fi jo jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(TREATmelt, aes(x=Time, y=Mean, colour=Trt))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_ribbon(aes(ymin=LCI, ymax=HCI, fill=Trt), alpha=0.1)+<br/>  facet_wrap(~Trt)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es kw"><img src="../Images/61c438defc900c41a7017c6600e39a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXNhHctPoiRhjup38Dh0UA.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="ec7d" class="jm jn hh ji b fi jo jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(SEXmelt, aes(x=Time, y=Mean, colour=Sexe))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_ribbon(aes(ymin=LCI, ymax=HCI, fill=Sexe), alpha=0.1)+<br/>  facet_wrap(~Sexe)</span><span id="0991" class="jm jn hh ji b fi js jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(SEXTREATmelt, aes(x=Time, y=Mean, colour=Sexe))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_ribbon(aes(ymin=LCI, ymax=HCI, fill=Sexe), alpha=0.1)+<br/>  facet_wrap(~Trt)</span><span id="2e9a" class="jm jn hh ji b fi js jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(BLOCmelt, aes(x=Time, y=Mean, colour=Bloc))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_ribbon(aes(ymin=LCI, ymax=HCI, fill=Bloc), alpha=0.1)+<br/>  facet_wrap(~Trt)</span><span id="5236" class="jm jn hh ji b fi js jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(BLOCmelt, aes(x=Time, y=Mean, colour=Trt))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_ribbon(aes(ymin=LCI, ymax=HCI, fill=Trt), alpha=0.1)+<br/>  facet_wrap(~Bloc)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju kx kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/178b4cdaa84b92c245e396c067b34e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*j4naU6iISc2qEl--BXqmyA.png"/></div></figure><figure class="kp ju ky kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/fdfec71a9ce4459c335954c41adb16bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*7FiHqp3nPQUKeK9OzwwAHQ.png"/></div></figure></div><div class="ab cb"><figure class="kp ju kz kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/31f9a92c1ebd8f0696910e62ebd59a29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*HmgAN06HZRmc4e_X1tFC4Q.png"/></div></figure><figure class="kp ju la kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/bfbea062294f6e8bfc2de39410824488.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*n135xRYpUtWAY3bR2pC0vA.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="9892" class="jm jn hh ji b fi jo jp l jq jr">sjp.poly(IRTA$BW,IRTA$Time, 1)<br/>sjp.poly(IRTA$BW,IRTA$Time, 2) # seems enough<br/>sjp.poly(IRTA$BW,IRTA$Time, 3)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/4918d2b0bb2b869ae64c6a550005cbb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*plGiNsmcJyccnPPGzo0AtA.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/5bd644356d11224aabc5031551c0386d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*cKlQ2CZeMXJ4ba1bUhQCWw.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/bd6306f0954e45cfd53edfb1f8c84e3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8IFdIQDZrmUl-q5_I623Rg.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx lc di ld le">How many polynomial terms do I need for raw BW data?</figcaption></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="817c" class="jm jn hh ji b fi jo jp l jq jr">sjp.poly(log(IRTA$BW),IRTA$Time, 1)<br/>sjp.poly(log(IRTA$BW),IRTA$Time, 2) <br/>sjp.poly(log(IRTA$BW),IRTA$Time, 3)# seems enough<br/>sjp.poly(log(IRTA$BW),IRTA$Time, 4)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/502cca9d2002b45e9784a6d3b62d3210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*0K-krD7yG2GC0XNHWFuduw.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/0838d4e4a70004114b1fb81a93a9f87e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*6I033SgNosuWCquHkxM2Sg.png"/></div></figure></div><div class="ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/63f9435bee0cd781a9ed589b10d3531a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Gipm8Yh0a4qdcd4c1yottQ.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/0b520ee89e2dbe30723683bb5968b7de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*XGsKHrdN5nQPq7oV7G_yiQ.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx lf di lg le">How many polynomial terms do I need for log BW data?</figcaption></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0820" class="jm jn hh ji b fi jo jp l jq jr">densityplot(~IRTA_nodead$BC_BW|IRTA_nodead$Trt*IRTA_nodead$Time)<br/>densityplot(~IRTA_nodead$BC_BW|IRTA_nodead$Sexe*IRTA_nodead$Time)<br/>densityplot(~IRTA_nodead$BC_BW|IRTA_nodead$Bloc*IRTA_nodead$Time)<br/>densityplot(~IRTA_nodead$BC_BW|IRTA_nodead$Lot*IRTA_nodead$Time) <br/>densityplot(~IRTA_nodead$BC_BW|IRTA_nodead$Time) <br/>densityplot(IRTA_nodead$BC_BW)<br/>densityplot(IRTA_nodead$BW) <br/>densityplot(~IRTA_nodead$BW|IRTA_nodead$Time)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju lh kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/6dda41fe835359dfaf656e208c1c6474.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*UeDQCrUGALVAh5Vcl2XvGg.png"/></div></figure><figure class="kp ju li kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/d865433d4e21faa08a9d2c17f9299014.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*jUomUsXC5lMefQpKPS7UPA.png"/></div></figure><figure class="kp ju lj kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/d5e93e9e307735291d9a8211d796c3ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*dHNPVfVXmmz0GAzjII_Rrw.png"/></div></figure></div><div class="ab cb"><figure class="kp ju lk kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/62053ee6630350e511ffb44f5792e52e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1422/format:webp/1*dYiF0wev8f31k8tuW5cV1w.png"/></div></figure><figure class="kp ju ll kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/da82563dfb3fc539332aabe68a60c982.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*ghCJ584C0khN1bxv3IPbzg.png"/></div></figure></div><div class="ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/bc9f98ff8f292912734f49d4ba154e07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Oz2ZcCcGRvb09aDNMa0QtA.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/2c09b37ff45fc5257a750a7f13285493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*bUzuKF0LrQR4UQEZgECCuQ.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="67ec" class="jm jn hh ji b fi jo jp l jq jr">IRTA&lt;-IRTA[complete.cases(IRTA), ]<br/>## Pooled<br/>fit.pooled&lt;-lm(BW~Time, data=IRTA)<br/>summary(fit.pooled)<br/>IRTA$fit.pooled&lt;-fitted(fit.pooled)<br/>## Unpooled<br/>fit.unpooled&lt;-lm(BW~Time+Bloc-1, data=IRTA)<br/>summary(fit.unpooled)<br/>IRTA$fit.unpooled&lt;-fitted(fit.unpooled)<br/>## Mixed model <br/>fit.mixed&lt;-lmer(BW~Time+(1|Bloc), data=IRTA)<br/>summary(fit.mixed)<br/>fixef(fit.mixed)<br/>ranef(fit.mixed)<br/>IRTA$fit.mixed&lt;-fitted(fit.mixed)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es lm"><img src="../Images/4898e3de4172790f88fdde5364e4434e.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*SRoj_6KApydIrDHhM_AMHQ.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="cd6c" class="jm jn hh ji b fi jo jp l jq jr">fit.pooled&lt;-augment(fit.pooled)<br/>fit.unpooled&lt;-augment(fit.unpooled)<br/>fit.mixed&lt;-augment(fit.mixed)</span><span id="0565" class="jm jn hh ji b fi js jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 20, by=5))<br/>ggplot(data=IRTA, aes(x=Time, y=fit.pooled, group=Bloc))+<br/>  stat_summary(aes(colour="fit.pooled"), fun.y="mean", geom="point", alpha=0.75)+<br/>  stat_summary(aes(colour="fit.pooled"), fun.y="mean", geom="line", alpha=0.75)+  stat_summary(aes(y=fit.unpooled,colour="fit.unpooled"),fun.y="mean", geom="line", alpha=0.75)+<br/>  stat_summary(aes(y=fit.unpooled, colour="fit.unpooled"),fun.y="mean", geom="line", alpha=0.75)+<br/>  stat_summary(aes(y=fit.mixed, colour="fit.mixed"), fun.y="mean", geom="line",alpha=0.75)+<br/>  stat_summary(aes(y=fit.mixed, colour="fit.mixed"),fun.y="mean", geom="line", alpha=0.75)+<br/>  facet_wrap(~Bloc)+<br/>  myy+<br/>  myx+<br/>  labs(title = "Difference in fitted values", y="Fitted values", x="Time (Days)")+<br/>  scale_colour_manual(name="Fit",values=c(fit.pooled="blue", fit.unpooled="red", fit.mixed="green"))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ln"><img src="../Images/bf6b3095099efca022348a9e49012054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DQR_tu329rw5iMNv_BZJog.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Comparing pooled, unpooled, and mixed model → not so big apart</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="4ecc" class="jm jn hh ji b fi jo jp l jq jr">## Pooled<br/>fit.full.pooled&lt;-lm(BW~ns(Time_center,2)*Trt+Sexe, data=IRTA)<br/>IRTA$fit.full.pooled&lt;-fitted(fit.full.pooled)<br/>AIC(fit.full.pooled)</span><span id="7aaf" class="jm jn hh ji b fi js jp l jq jr">## Unpooled<br/>fit.full.unpooled&lt;-lm(BW~ns(Time_center,2)*Trt+Sexe+Bloc-1+Pig-1, data=IRTA)<br/>IRTA$fit.full.unpooled&lt;-fitted(fit.full.unpooled)<br/>AIC(fit.full.unpooled)</span><span id="6dca" class="jm jn hh ji b fi js jp l jq jr">## Mixed model<br/>fit.full.mixed&lt;-lmer(BW~ns(Time_center,2)*Trt+Sexe+(Time_center|Bloc/Pig), data=IRTA) # failed to converge<br/>IRTA$fit.full.mixed&lt;-fitted(fit.full.mixed)</span><span id="283b" class="jm jn hh ji b fi js jp l jq jr">fit.full.mixed2&lt;-lmer(BW~ns(Time_center,2)*Trt+Sexe+(1|Bloc/Pig), data=IRTA) # failed to converge<br/>anova(fit.full.mixed2, fit.full.mixed) </span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es lo"><img src="../Images/df315ae801c0bcb0de34945bdaba4ef4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*D1O7o9dh8uHDRAKI_oPl2w.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="b6bb" class="jm jn hh ji b fi jo jp l jq jr">fit.full.mixed3&lt;-lmer(BW~ns(Time_center,2)*Trt+Sexe+(Time_center|Bloc:Pig), data=IRTA) # failed to converge<br/>anova(fit.full.mixed3, fit.full.mixed2, fit.full.mixed) # </span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lp"><img src="../Images/743c289ebc410bcd30d90d3d6f7001ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*5AXObbLNNho0QBoSiRs1DQ.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx"><strong class="bd lq">Fit.full.mixed</strong> is best, but correlation is almost one between Time and Slope.</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c85f" class="jm jn hh ji b fi jo jp l jq jr">bwplot(resid(fit.full.mixed)~IRTA$Bloc)<br/>bwplot(resid(fit.full.mixed)~IRTA$Trt)<br/>bwplot(resid(fit.full.mixed)~IRTA$Trt|IRTA$Bloc)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju lr kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/12dfe93e3e8fe41e1c076f9d8116676b.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*ZsF-UfuhgZSg0Q_TI0PBjg.png"/></div></figure><figure class="kp ju ls kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/d6c149139f40bfc5f39d70b8fc8a536f.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*vqcCGJbIfPqhZoRsCxr7KA.png"/></div></figure><figure class="kp ju lt kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/f1c1199eb999919bb7b331f29d5cb723.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*c_ljpSTEmyqO3p5K2Iuoiw.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="a3f7" class="jm jn hh ji b fi jo jp l jq jr">fit.full.mixed.base&lt;-lmer(BW~iBW+ns(Time_center,2)*Trt+Sexe+(Time_center|Bloc/Pig), data=IRTA) # failed to converge<br/>IRTA$fit.full.mixed.base&lt;-fitted(fit.full.mixed.base)<br/>plot(fit.full.mixed.base)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lu"><img src="../Images/ff0061b60e7d786e5632a37539d2aef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JoW9k7v4iG8Fyx80YymF2A.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Mixed model with baseline covariate</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f18e" class="jm jn hh ji b fi jo jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 20, by=5))<br/>ggplot(IRTA, aes(x=Time, y=fit.full.pooled))+<br/>  myy+<br/>  myx+<br/>  stat_summary(aes(colour="fit.pooled", fun.y="mean", geom="point", alpha=0.75))+<br/>  stat_summary(aes(colour="fit.pooled", fun.y="mean", geom="line", alpha=0.75))+<br/>  stat_summary(aes(y=fit.full.unpooled,colour="fit.unpooled"),fun.y="mean", geom="line", alpha=0.75)+<br/>  stat_summary(aes(y=fit.full.unpooled, colour="fit.unpooled"),fun.y="mean", geom="line", alpha=0.75)+<br/>  stat_summary(aes(y=fit.full.mixed.base, colour="fit.mixed"), fun.y="mean", geom="line",alpha=0.75)+<br/>  stat_summary(aes(y=fit.full.mixed.base, colour="fit.mixed"),fun.y="mean", geom="line", alpha=0.75)+<br/>  stat_summary(aes(y=fit.full.mixed, colour="fit.mixed"), fun.y="mean", geom="line",alpha=0.75)+<br/>  stat_summary(aes(y=fit.full.mixed, colour="fit.mixed"),fun.y="mean", geom="line", alpha=0.75)+<br/>  facet_wrap(~Bloc)+<br/>  labs(title = "Difference in fitted values", y="Fitted values", x="Time (Days)")+<br/>  scale_colour_manual(name="Fit",values=c(fit.pooled="blue",fit.unpooled="red",fit.mixed="green",fit.mixed.baseline="orange"))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lv"><img src="../Images/3dc12cde981db6a43a818903acd77435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJkYhaTHv4xIXQ3P2TCL6A.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Comparison of technique by fitted values.</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f56f" class="jm jn hh ji b fi jo jp l jq jr">lattice.options(<br/>  layout.heights=list(bottom.padding=list(x=0), top.padding=list(x=0)),<br/>  layout.widths=list(left.padding=list(x=0), right.padding=list(x=0))<br/>)<br/>xyplot(BW ~ Time|Pig, data = IRTA,<br/>       strip = FALSE, aspect = "xy", pch = 16, cex=0.5, grid = FALSE,<br/>       panel = function(x, y, ..., fit, subscripts) <br/>       {<br/>         panel.xyplot(x, y, ...)<br/>         ypred.pooled &lt;- fitted(fit.full.pooled)[subscripts]<br/>         panel.lines(x, ypred.pooled, col = "black")<br/>         ypred.unpooled &lt;- fitted(fit.full.unpooled)[subscripts]<br/>         panel.lines(x, ypred.unpooled, col = "red")<br/>         ypred.mixed &lt;- fitted(fit.full.mixed)[subscripts]<br/>         panel.lines(x, ypred.mixed, col = "green")<br/>         ypred.mixed.base &lt;- fitted(fit.full.mixed.base)[subscripts]<br/>         panel.lines(x, ypred.mixed.base , col = "orange")<br/>       },<br/>       xlab = "Time",  ylab = "BW (kg)",key=list(space="top",<br/>                                                 lines=list(col=c("black","red", "green","orange"), lwd=6),<br/>                                                 text=list(c("LM Pooled", "LM Unpooled", "Mixed model","Mixed model with baseline covariate"), columns=1))<br/>)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lw"><img src="../Images/15865c8852d6e9c2d2506e86b0da87a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1yr9C6_yuo0lutL42O8kOg.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Model fit, but only for Bloc</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="e5fe" class="jm jn hh ji b fi jo jp l jq jr">IRTA_nodead&lt;-IRTA[IRTA$Fate=="Finished"|IRTA$Fate=="Slaughter",]<br/>TREATmelt_nodead&lt;-ddply(IRTA_nodead, c("Time", "Trt"), summarise,<br/>                        N = sum(!is.na(BW)),<br/>                        Mis = sum(is.na(BW)),<br/>                        Mean = round(mean(BW, na.rm=T),3),<br/>                        Median = round(median(BW, na.rm=T),3),<br/>                        SD = round(sd(BW, na.rm=T),3),<br/>                        SE = round(sd(BW, na.rm=T) / sqrt(N),5),<br/>                        LCI = round(Mean - (2*SE),3), <br/>                        HCI = round(Mean + (2*SE),3))</span><span id="d8b1" class="jm jn hh ji b fi js jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,14,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(0, 35, by = 1))<br/>ggplot(TREATmelt_nodead, aes(x=Time, y=Mean, colour=Trt))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1)+<br/>  geom_ribbon(aes(ymin=LCI, ymax=HCI, fill=Trt), alpha=0.1)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lx"><img src="../Images/ce66a1b1d0272fe8146c19c70493e675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rk48N41Hx-ii-1-5ngu5NA.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Asses data excluding pigs that died</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="bc69" class="jm jn hh ji b fi jo jp l jq jr">IRTA_nodead$Time_center&lt;-scale(IRTA_nodead$Time, center=TRUE, scale=FALSE)<br/>fit.full.mixed_nodead&lt;-lmer(BW~ns(Time_center,2)*Trt+Sexe+<br/>                              (ns(Time_center,2)|Bloc/Pig), <br/>                            data=IRTA_nodead)</span><span id="8bc9" class="jm jn hh ji b fi js jp l jq jr">jtools::plot_summs(fit.full.mixed, <br/>                   fit.full.mixed_nodead,<br/>                   plot.distributions = TRUE,<br/>                   rescale.distributions = TRUE,<br/>                   model.names = c("fit.full.mixed", "fit.full.mixed_nodead"))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ly"><img src="../Images/a5ffb29706df593768fa1b51215926e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nZczSDSU-peNkNfXjsmrkw.png"/></div></div></figure><p id="db3b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Box和Cox (1964)提出了一系列变换，旨在减少线性模型中误差的非正态性。事实证明，这样做通常也会降低非线性。为了减少右偏，求根、对数或倒数(根是最弱的)。这是实践中最常见的问题。为了减少左偏斜，采取正方形或立方体或更高的权力。</p><p id="46f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">常见的Box-Cox变换—λ标准变换<br/>#-2→1/y2<br/>#-1→1/y1<br/>#-0.5→1/(sqrt(y))<br/># 0→log(y)<br/># 0.5→sqrt(y)<br/># 1→y<br/># 2→y^2</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="30cb" class="jm jn hh ji b fi jo jp l jq jr">fit&lt;-lm(BW~ns(Time_center,3)*Trt+Sexe, data=IRTA_nodead)<br/>bc1&lt;-boxcox(BW~ns(Time_center,3)*Trt+Sexe, data=IRTA_nodead)<br/>boxcox(fit,lambda=seq(-0.5,0,by=0.05),plotit=T)<br/>which.max(bc1$y)<br/>LV&lt;-bc1[1]$x[as.numeric(which.max(bc1$y))]<br/>LV<br/>fitbc&lt;-lm((BW^LV-1/LV)~ns(Time_center,3)*Trt+Sexe, data=IRTA_nodead)<br/>fitreciproc&lt;-lm((1/BW)~ns(Time_center,3)*Trt+Sexe, data=IRTA_nodead) # reciprocal<br/>fitreciprocsqrt&lt;-lm((1/sqrt(BW))~ns(Time_center,3)*Trt+Sexe, data=IRTA_nodead) # reciprocal square root <br/>fitlog&lt;-lm(log(BW)~ns(Time_center,3)*Trt+Sexe, data=IRTA_nodead)<br/>fitsqrt&lt;-lm(sqrt(BW)~ns(Time_center,3)*Trt+Sexe, data=IRTA_nodead)</span><span id="8645" class="jm jn hh ji b fi js jp l jq jr">par(mfrow=c(2,3))<br/>plot(fit, which=2, main="BW")<br/>plot(fitbc, which=2, main="BW_bc") <br/>plot(fitlog, which=2, main="BW_log") <br/>plot(fitsqrt, which=2, main="BW_sqrt")<br/>plot(fitreciproc, which=2, main="BW_reciprocal") <br/>plot(fitreciprocsqrt, which=2, main="BW_reciprocalsqrt")</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/4a6a5616d5fe836b576c6e1a90e355d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*fQK4iCubTpmSB1JL95jkOQ.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/45ad8a2537ce1f3d38bd9e2d186dcc90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*iPwl9zjxmNGBed4KEW_kiw.png"/></div></figure></div><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es lz"><img src="../Images/bf9194f584c383042338c9c7afc06698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k7Y5GTDsy_tvVKTfUF6Mpw.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Plot several QQ plots based on transformations</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="ab99" class="jm jn hh ji b fi jo jp l jq jr">histogram(~BW|Time,data=IRTA_nodead,type="density", breaks=30)<br/>histogram(~log(BW)|Time,data=IRTA_nodead,type="density", breaks=30)<br/>histogram(~BC_BW|Time,data=IRTA_nodead,type="density", breaks=30)<br/>histogram(~BW^LV|Time,data=IRTA_nodead,type="density", breaks=30)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/6ed5faa699535bf94735df69a8e94502.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*NqBO7Q1Xv662EaC8lbaA1A.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/10a2623cdbdb05415dd4a40376a045ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*qs77k4zsuwBWaBuQMeAmnA.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/332cdda845c7bdf686e0698d29c8f155.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Fc-UXKSt4Ka0-2Tx45mfwg.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="72c1" class="jm jn hh ji b fi jo jp l jq jr">fit.full.mixed_nodead&lt;-lmer(BW~ns(Time_center,2)*Trt+Sexe+<br/>                              (ns(Time_center,2)|Bloc/Pig), <br/>                            data=IRTA_nodead)<br/>fit.full.mixed_nodead2&lt;-lmer(log(BW)~ns(Time_center,2)*Trt+Sexe+<br/>                               (ns(Time_center,2)|Bloc/Pig), <br/>                             data=IRTA_nodead)<br/>fit.full.mixed_nodead3&lt;-lmer(log(BW)~ns(Time_center,2)*Trt+Sexe+<br/>                               (ns(Time_center,2)|Bloc)+<br/>                               (ns(Time_center,2)|Pig), <br/>                             data=IRTA_nodead)<br/>fit.full.mixed_nodead4&lt;-lmer(BC_BW~ns(Time_center,2)*Trt+Sexe+<br/>                               (ns(Time_center,2)|Bloc)+<br/>                               (ns(Time_center,2)|Pig), <br/>                             data=IRTA_nodead)<br/>fit.full.mixed_nodead5&lt;-lmer(BC_BW~ns(Time_center,2)*Trt+Sexe+<br/>                               (1|Bloc)+<br/>                               (1|Pig)+<br/>                               (0+ns(Time_center,2)|Bloc)+<br/>                               (0+ns(Time_center,2)|Pig), <br/>                             data=IRTA_nodead)<br/>fit.full.mixed_nodead6&lt;-lmer(BC_BW~ns(Time_center,2)*Trt+Sexe+<br/>                               (1|Bloc)+<br/>                               (ns(Time_center,2)|Pig), <br/>                             data=IRTA_nodead)<br/>fit.full.mixed_nodead6.1&lt;-lmer(BC_BW~ns(Time_center,3)*Trt+Sexe+<br/>                                 (1|Bloc)+<br/>                                 (ns(Time_center,3)|Pig), <br/>                               data=IRTA_nodead)<br/>fit.full.mixed_nodead8&lt;-lmer(log(BW)~ns(Time_center,2)*Trt+Sexe+<br/>                               (1|Bloc)+<br/>                               (ns(Time_center,2)|Pig), <br/>                             data=IRTA_nodead)<br/>anova(fit.full.mixed_nodead4, <br/>      fit.full.mixed_nodead5, <br/>      fit.full.mixed_nodead6,<br/>      fit.full.mixed_nodead6.1) # 6.1 provides best fit</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ma"><img src="../Images/dfbb65c7c4959a594a26819bbfeb5221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z_IoFqKjqF_XYanR7Gu1Rg.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="e974" class="jm jn hh ji b fi jo jp l jq jr">fit.full.mixed_nodead6.2&lt;-lmer(log(BW)~ns(Time_center,3)*Trt+Sexe+<br/>                                 (1|Bloc)+<br/>                                 (ns(Time_center,3)|Pig), <br/>                               data=IRTA_nodead)<br/>fit.full.mixed_nodead6.2.1&lt;-lmer((1/BW)~ns(Time_center,3)*Trt+Sexe+<br/>                                   (1|Bloc)+<br/>                                   (ns(Time_center,3)|Pig), <br/>                                 data=IRTA_nodead)<br/>fit.full.mixed_nodead6.2.2&lt;-lmer((1/sqrt(BW))~ns(Time_center,3)*Trt+Sexe+<br/>                                   (1|Bloc)+<br/>                                   (ns(Time_center,3)|Pig), <br/>                                 data=IRTA_nodead)<br/>fit.full.mixed_nodead6.2.3&lt;-lmer((1/sqrt(BW))~ns(Time_center,3)*Trt+Sexe+Fate+<br/>                                   (1|Bloc)+<br/>                                   (ns(Time_center,3)|Pig), <br/>                                 data=IRTA_nodead)<br/>fit.full.mixed_nodead6.2.4&lt;-lmer(log(BW)~ns(Time_center,2)*Trt*Sexe+Fate+<br/>                                   (1|Bloc)+<br/>                                   (ns(Time_center,2)|Pig), <br/>                                 data=IRTA_nodead)<br/>fit.full.mixed_nodead6.2.5&lt;-lmer(log(BW)~ns(Time_center,2)*Trt*Sexe+Fate+<br/>                                   (ns(Time_center,2)|Bloc/Pig), <br/>                                 data=IRTA_nodead)<br/>fit.full.mixed_nodead6.2.6&lt;-lmer(log(BW)~ns(Time_center,2)+Trt+Sexe+Fate+<br/>                                   (ns(Time_center,2)|Bloc/Pig), <br/>                                 data=IRTA_nodead)<br/>fit.full.mixed_nodead6.2.7&lt;-lmer(log(BW)~ns(Time_center,2)+Trt+Sexe+nr_asses+<br/>                                   (1|Bloc)+<br/>                                   (1|Lot)+<br/>                                   (ns(Time_center,2)|Pig), <br/>                                 data=IRTA_nodead)<br/>fit.full.mixed_nodead6.3&lt;-lmer(log(BW)~ns(Time_center,3)*Trt+Sexe+<br/>                                 (1|Bloc)+<br/>                                 (1|Pig)+<br/>                                 (0+ns(Time_center,3)|Pig), <br/>                               data=IRTA_nodead)<br/>anova(fit.full.mixed_nodead6.2,<br/>      fit.full.mixed_nodead6.3, <br/>      fit.full.mixed_nodead6.2.4, <br/>      fit.full.mixed_nodead6.2.5,<br/>      fit.full.mixed_nodead6.2.6,<br/>      fit.full.mixed_nodead6.2.7) # 6.2 best for log (BW)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mb"><img src="../Images/d4901c9edaff60619f1a75773b169d94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dv9kiGcbiSqZ18HazpcEpg.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="e5f0" class="jm jn hh ji b fi jo jp l jq jr">fit.full.mixed_nodead10&lt;-glmer(BW~ns(Time_center,2)*Trt+Sexe+<br/>                                 (1|Bloc)+<br/>                                 (0+ns(Time_center,2)|Pig), <br/>                               family=inverse.gaussian(link="1/mu^2"), <br/>                               control = glmerControl(optimizer = "bobyqa", nAGQ = 1),<br/>                               data=IRTA_nodead)</span><span id="569b" class="jm jn hh ji b fi js jp l jq jr">RMSE.merMod(fit.full.mixed_nodead6.2)<br/>RMSE.merMod(fit.full.mixed_nodead6.3)<br/>RMSE.merMod(fit.full.mixed_nodead6.1) </span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es mc"><img src="../Images/65d350f55d96d83147db335efe8a8c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*oI3Iol167Pqk1_VQjBLsWw.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="099f" class="jm jn hh ji b fi jo jp l jq jr">## What if I only kept the finishers<br/>IRTA_finished&lt;-IRTA[IRTA$Fate=="Finished",]<br/>fit.full.mixed_finished&lt;-lmer(log(BW)~ns(Time_center,2)*Trt+Sexe+<br/>                                (ns(Time_center,2)|Bloc/Pig), <br/>                              data=IRTA_finished) <br/>plot(fit.full.mixed_finished)<br/>plot_model(fit.full.mixed_finished, type="est") </span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es md"><img src="../Images/e87b3f427dd7d00e9df974fb7e64cd41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHs7GbDckrVMp91ciDRxLw.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="f250" class="jm jn hh ji b fi jo jp l jq jr">jtools::plot_summs(fit.full.mixed_nodead6.2,<br/>                   fit.full.mixed_nodead6.3, <br/>                   fit.full.mixed_nodead6.2.4, <br/>                   fit.full.mixed_nodead6.2.5,<br/>                   fit.full.mixed_nodead6.2.6,<br/>                   fit.full.mixed_nodead6.2.7, <br/>                   robust = "HC3", <br/>                   model.names = c("6.2",<br/>                                   "6.3", <br/>                                   "6.2.4", <br/>                                   "6.2.5",<br/>                                   "6.2.6",<br/>                                   "6.2.7"))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es me"><img src="../Images/a526b603b7c42c03ce1ca040ebf7cd64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XtAy6a2Mte5Ndzt8wBOqMQ.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="537a" class="jm jn hh ji b fi jo jp l jq jr">Grouped&lt;-groupedData(BW~Time_center|Bloc/Pig,<br/>                     data=IRTA_nodead,<br/>                     FUN=mean)<br/>fit_nlme&lt;-lme(BW~ns(Time_center,2)*Trt+<br/>                Sexe, <br/>              data=IRTA_nodead_deleted,<br/>              random=~ns(Time_center,2)|Bloc/Pig,<br/>              method="ML", <br/>              control=lmeControl(opt="optim", maxIter=1000000, msMaxIter = 10000))<br/>plot(fit_nlme)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es md"><img src="../Images/9e640f2ec45db0742d4b0fee953186d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*09CFcOo2hXMH_1kgQ5Q96A.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">Homogeneity of variances indicates normal distrbution of errors</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="2abc" class="jm jn hh ji b fi jo jp l jq jr">fit_nlme_log&lt;-lme(log(BW)~ns(Time_center,2)*Trt+<br/>                    Sexe, <br/>                  data=IRTA_nodead,<br/>                  random=~ns(Time_center,2)|Bloc/Pig,<br/>                  method="ML", <br/>                  control=lmeControl(opt="optim", maxIter=1000000, msMaxIter = 10000))<br/>plot(fit_nlme_log)<br/>plot(fit.full.mixed_nodead2)<br/>plot(fit_nlme_log, resid(., type = "p") ~ Time_center|Bloc,abline=0) <br/>plot(fit_nlme_log, resid(., type = "p") ~ Time_center|Sexe,abline=0) <br/>plot(fit_nlme_log, resid(., type = "p") ~ Time_center|Trt,abline=0) <br/>plot(fit_nlme_log, resid(., type = "p") ~ Time_center|Fate,abline=0)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/89c85a664b235f36218e4d44d84bc60f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*w6SIXUwlsf06eSlSvRp1-A.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/ded96ab61d700084fe55eda3487f0e43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Hf4Xc3SfaU970I4Hw92GSw.png"/></div></figure></div><div class="ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/ce962c4a4a55207baff58023c650967c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*zyp4aD6kPPf8YOXLz-uVpw.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/776501508e8d67dbfd1d073840d2ae1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*8MUZFnh_2dd5oyacNVRISw.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="951a" class="jm jn hh ji b fi jo jp l jq jr">fit.mixed.pigs&lt;-lmer(BC_BW~ns(Time_center,2)*Trt+Sexe+<br/>                       (ns(Time_center,2)|Pig), <br/>                     data=IRTA_nodead)</span><span id="9361" class="jm jn hh ji b fi js jp l jq jr">inf.Pig&lt;-influence.ME::influence(fit.mixed.pigs, group="Pig")<br/>plot(inf.Pig, which="cook", cutoff=4/368)<br/>cooks.distance(inf.Pig, sort=TRUE)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mf"><img src="../Images/3b479b7d9a85caf6ee49d4096ac426a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NA4PlrBhRbf_Pp43X43d7w.png"/></div></div><figcaption class="kk kl et er es km kn bd b be z dx">INFLUENCE STATISTICS</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0483" class="jm jn hh ji b fi jo jp l jq jr">IRTA_nodead_deleted&lt;-IRTA_nodead[!IRTA_nodead$Pig %in% c(187, 398, 174,167), ] <br/>dim(IRTA_nodead);dim(IRTA_nodead_deleted) # 20 rows missing</span><span id="2786" class="jm jn hh ji b fi js jp l jq jr">fit.full.mixed_nodead6&lt;-lmer(log(BW)~ns(Time_center,2)*Trt+Sexe+<br/>                               (1|Bloc)+<br/>                               (ns(Time_center,2)|Pig), <br/>                             data=IRTA_nodead)</span><span id="7961" class="jm jn hh ji b fi js jp l jq jr">fit.full.mixed_nodead7&lt;-lmer(log(BW)~ns(Time_center,2)*Trt+Sexe+<br/>                               (1|Bloc)+<br/>                               (0+ns(Time_center,2)|Pig), <br/>                             data=IRTA_deleted) <br/>ICtab(fit.full.mixed_nodead6,fit.full.mixed_nodead7)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es mg"><img src="../Images/b72a13892ae474a71192aea9b5a0cdc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*aTH-NZ-oliTZnDSZRcrW4g.png"/></div><figcaption class="kk kl et er es km kn bd b be z dx">Analysis with and without deleted pigs</figcaption></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="ffba" class="jm jn hh ji b fi jo jp l jq jr">Anova(fit.full.mixed_nodead7, type=3, test.statistic = "F")</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es mh"><img src="../Images/3c9ee79cbe6478915a06f57698ae5dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*biP82ZSX_ztDkC0HE9kDkg.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="27d5" class="jm jn hh ji b fi jo jp l jq jr">plot(fit.full.mixed_nodead7)<br/>plot(fit.full.mixed_nodead6)<br/>par(mfrow = c(3, 1))<br/>qqp(resid(fit.full.mixed_nodead7))<br/>qqp(resid(fit.full.mixed_nodead7), "lnorm")<br/>qqp(IRTA_nodead$BW, "lnorm") # not a good fit</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/bb6b34efa4da6c2f59935886b3465dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*oAGIda77TblRrwX1zgw9zg.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/2f49f94bf744ad2409a051c26665eb6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*-9VKbl2TdXHrtS0IqjwtRA.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/1eb9cfd37e7ff52bcec8520a47f7dec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*YTPg5-rcsrD3K0OwhH-oxQ.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="a61c" class="jm jn hh ji b fi jo jp l jq jr">IRTAcomplete&lt;-IRTA_nodead_deleted<br/>final.model&lt;-lmer(1/(sqrt(BW))~ns(Time,3)*Trt+Sexe+Fate+<br/>                    (ns(Time,3)|Bloc/Pig),data=IRTAcomplete)<br/>VarCorr(final.model)<br/>fixef(final.model)<br/>ranef(final.model)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es mi"><img src="../Images/7e5ebf000f955705b1840ff08bf75f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*2H5r-hKkanhp0sfuAcvosg.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="0ef5" class="jm jn hh ji b fi jo jp l jq jr">summary(final.model)<br/>plot(final.model)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mj"><img src="../Images/408b0d320c4228c2a58692c83ae4f176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CS3gCN_G0ugnSw-lwohztA.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="1b05" class="jm jn hh ji b fi jo jp l jq jr">RMSE.merMod(final.model)<br/>[1] 0.004179619</span><span id="d7e2" class="jm jn hh ji b fi js jp l jq jr">qqp(resid(final.model))</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mj"><img src="../Images/157a84c7275884ca43a12037424d7c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VK9B1oVh0uZZNXCYRrFFyw.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="b9e8" class="jm jn hh ji b fi jo jp l jq jr">plot_model(final.model)<br/>plot_model(final.model, type="re")<br/>plot_model(final.model, type="diag")</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/79f19ea47617eaadfa4ea0b22cbdb7ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Fy05S-K0b5TBDtvd28PnmQ.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/80e551fb5eaa8d40723629217db59bc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*mOolrk9teizCOD7XjvVzDA.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/8252da02945e72f312d242c65455bca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*CTInBbT05jR0XHOPlKycKA.png"/></div></figure></div><div class="ab cb"><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/39061cf889247458d3598d554b2cb9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*pfY6nyo5OPGlkkuEY63phw.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/dfd637ca6f47f730328a4af337260796.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Ka6hEBiWAKNrJWw1h41qsg.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/40c3406a4d771980557e81c08af51b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*HMxmNdm0W8Di4ZFy2OxnRQ.png"/></div></figure></div><div class="ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/efda2e6ddf11d8ec2845c89dfd09fe64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*gSsz3vajzPxXkuE_uN-HuA.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/eecdd305774cc5915cc309c97c5003fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*QNX3hfljk3fpyPIaf4vvnQ.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="4769" class="jm jn hh ji b fi jo jp l jq jr"><br/>Anova(final.model, type=3, test.statistic = "F") </span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mk"><img src="../Images/8b3e7350ea3dbab9586f863def3ec90c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Vwbw8uJjhJDhJ3Wx81fUw.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="c7db" class="jm jn hh ji b fi jo jp l jq jr">hnp::hnp(final.model)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mj"><img src="../Images/579564500635e88016ffa2fed9829b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FRR4p0X6RLjeI6oJ5-pI0Q.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="d1c0" class="jm jn hh ji b fi jo jp l jq jr">library(orcutt)<br/>fit.pooled&lt;-lm((BW^LV-1/LV)~ns(Time,3)*Trt+Sexe, data=IRTAcomplete)<br/>fit.pooled2&lt;-lm((BW^LV-1/LV)~ns(Time,3)*Trt+Sexe+as.factor(Fate)+as.factor(Bloc), data=IRTAcomplete) # closest to full model <br/>rho&lt;-orcutt::cochrane.orcutt(fit.pooled)<br/>rho2&lt;-orcutt::cochrane.orcutt(fit.pooled2)<br/>rho$rho # [1] 0.7202645<br/>rho2$rho # [1] 0.635619</span><span id="2df1" class="jm jn hh ji b fi js jp l jq jr">plot(final.model, resid(.) ~ Time, abline = 0 ) <br/>bwplot(resid(final.model)~IRTA_nodead$Bloc)<br/>bwplot(resid(final.model)~IRTA_nodead$Trt)<br/>bwplot(resid(final.model)~IRTA_nodead$Sexe)<br/>bwplot(resid(final.model)~IRTA_nodead$Fate)<br/>bwplot(IRTA_nodead$Time~resid(final.model))<br/>bwplot(resid(final.model)~IRTA_nodead$Pig)</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/ce5982e53becc745d431d7c46648aacd.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*NikZfeB01fr1XTTK76jwRA.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/13ce797a60c3cb4d50cbe83cae2f7172.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*lSLg3HqXu3O9wWDM863J9A.png"/></div></figure><figure class="kp ju lb kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/34c50003e933aa491a5b64e0b5f8369c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*k-xu6KSI_QgiiW_mFxk8Jg.png"/></div></figure></div><div class="ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/36659d0367f4bbe0fa5b47adf2f45393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*BRUiR-KaWBcj4ejxfeII8g.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/1342c88c9fab9ad53d69b56a095060f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*VFdQXz9TNgduzHI9nwgl3g.png"/></div></figure></div><div class="ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/0f7c01562ed8d06d1750c5fcc151d74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*uZzkhaWRn8rqs9TJJD1aMQ.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/6e8029f980f1b095809d9eec458478fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*nfNWYAzlyMVaX-WdJCdP8g.png"/></div></figure></div><p id="5363" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后的方法，看看是否lme4和nlme的预测纳入自相关更好。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="b79c" class="jm jn hh ji b fi jo jp l jq jr">final.model&lt;-lmer(1/(sqrt(BW))~ns(Time,3)*Trt+Sexe+Fate+<br/>                    (ns(Time,3)|Bloc/Pig),data=IRTAcomplete)<br/>final.model_nlme&lt;-lme(1/(sqrt(BW))~ns(Time,3)*Trt+Sexe+Fate, <br/>                      data=IRTAcomplete,<br/>                      random=~ns(Time,3)|Bloc/Pig,<br/>                      correlation=corAR1(0.7, form=~1|Bloc/Pig),<br/>                      method="ML", <br/>                      control=lmeControl(opt="optim", maxIter=1000000, msMaxIter = 10000))<br/>AICtab(final.model, final.model_nlme) # nlme model way better</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es ml"><img src="../Images/61faa736a8316507deaf9091dbb66261.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*sJI_tjCqumCpFBnKL8_i2Q.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="6df8" class="jm jn hh ji b fi jo jp l jq jr">RMSE.merMod(final.model)<br/>rmse(final.model_nlme) </span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mm"><img src="../Images/0269e2f289cef7328440958d5e202935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtNB7LPLok8QhRvi3ua6IQ.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="235c" class="jm jn hh ji b fi jo jp l jq jr">qqp(resid(final.model))<br/>qqp(resid(final.model_nlme))</span></pre><div class="jd je jf jg fd ab cb"><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/fc2755ab1774fee34c1c1e8942fd65d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*VK9B1oVh0uZZNXCYRrFFyw.png"/></div></figure><figure class="kp ju kq kr ks kt ku paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><img src="../Images/e0e9193ffcb7dcd56c533b3112f85c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*w7juUoTq03XhNHej-I7NIw.png"/></div></figure></div><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="b902" class="jm jn hh ji b fi jo jp l jq jr">IRTAcomplete$fit2&lt;-1/(fitted(final.model_nlme)^2)<br/>IRTAcomplete$fit-IRTAcomplete$fit2 <br/>VarCorr(final.model)<br/>VarCorr(final.model_nlme)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div class="er es mn"><img src="../Images/2c8bb305c18eb74cd8bb174de9339d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*-uJInHwSPZUCLAe_jjSnJQ.png"/></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="5223" class="jm jn hh ji b fi jo jp l jq jr">xyplot(BW~Time|Pig, data = IRTAcomplete, <br/>       strip = FALSE, aspect = "xy", pch = 16, cex=0.2, grid = TRUE,<br/>       panel = function(x, y, ..., fit, subscripts) {<br/>         panel.grid()<br/>         panel.xyplot(x, y)<br/>         panel.lmline(x, y, lty = 2, col="black")<br/>         ypred&lt;-IRTAcomplete$fit[subscripts]<br/>         panel.lines(x, ypred, col = "red")<br/>         ypred2&lt;-IRTAcomplete$fit2[subscripts]<br/>         panel.lines(x, ypred2, col = "orange")<br/>         panel.abline(0, 0)<br/>       }</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mo"><img src="../Images/c359e471b978743551f81385bed1d408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OAXDsWwwg3fM4b7LwjFJAA.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="34d9" class="jm jn hh ji b fi jo jp l jq jr">IRTAcomplete$diff&lt;-IRTAcomplete$fit-IRTAcomplete$BW<br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks= seq(0, 35, by = 5))<br/>myy&lt;-scale_y_continuous(breaks= seq(0, 35, by = 5))<br/>ggplot(IRTAcomplete,aes(x=BW, y=fit, colour=diff))+<br/>  geom_abline(intercept=0, slope=1, lty=2, col="black", lwd=1)+<br/>  geom_point()+<br/>  myx+<br/>  myy+<br/>  scale_colour_gradient2(low="red",mid="blue",high="red")+<br/>  facet_wrap(~Trt)+<br/>  labs(title = "Residuals by treatment", y="Predicted", x="Observed")<br/>ggsave(filename="Observed vs. Predicted BW.png", width=16, height=8, dpi=600)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mp"><img src="../Images/60ee2a8c6475143e39d5694e9dadfafd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UXjvIlHz5DCxKDA6oBLpRA.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="8c1d" class="jm jn hh ji b fi jo jp l jq jr">theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks=c(0,7,12,28,42))<br/>myy&lt;-scale_y_continuous(breaks = seq(-2, 2, by = 0.5))<br/>ggplot(IRTAcomplete, aes(x=Time, y=diff, colour=Trt, group=Time))+<br/>  geom_hline(yintercept=c(-2,-1,0,1,2), lty=2)+<br/>  geom_boxplot()+<br/>  myx+<br/>  myy+<br/>  facet_wrap(~Trt)<br/></span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mq"><img src="../Images/57b0a8e5622e379cc2f1faff09ca17ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O_TUED3JJ9LtukGxIF1mSw.png"/></div></div></figure><p id="18bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过扩展数据帧来创建新的预测数据帧，从而为第0天和第42天之间的时间点创建预测，并扩展到第100天。</p><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="7ab2" class="jm jn hh ji b fi jo jp l jq jr">pdata&lt;-subset(IRTAcomplete[,c(1:11)], Time==0)<br/>dim(pdata) # 346 rows of 11 variables, meaning 364 pigs included in dataset<br/>pdata&lt;-as.data.frame(sapply(pdata, rep.int, times=43))<br/>pdata$id&lt;-NULL<br/>pdata&lt;-pdata[order(pdata$Pig),]<br/>row.names(pdata)&lt;-NULL<br/>pdata$Time&lt;-rep(c(0:42),364)<br/>pdata&lt;-as.data.frame(pdata)<br/>pdata$Trt&lt;-as.factor(pdata$Trt)<br/>pdata$Sexe&lt;-ifelse(pdata$Sexe==1, "M", "F")<br/>pdata$Sexe&lt;-as.factor(pdata$Sexe)<br/>pdata$Fate&lt;-ifelse(pdata$Fate==2, "Finished", "Slaughter")<br/>pdata$Fate&lt;-as.factor(pdata$Fate)<br/>pdata$Trt&lt;-as.factor(pdata$Trt)</span><span id="0b83" class="jm jn hh ji b fi js jp l jq jr">### BOOTSTRAP<br/>mySumm &lt;- function(.) {<br/>  predict(., pdata,re.form=NULL)<br/>}<br/>nc &lt;- detectCores()<br/>cl &lt;- makeCluster(rep("localhost", nc))</span><span id="89c1" class="jm jn hh ji b fi js jp l jq jr">pred&lt;-bootMer(final.model, <br/>              mySumm, <br/>              nsim=10, # 7 warnings, not such a stable model and will take a huge amount of tiem to reach 5000 simulations<br/>              use.u=FALSE, <br/>              type="parametric")<br/>attr(pred,"boot.fail.msgs")</span><span id="2640" class="jm jn hh ji b fi js jp l jq jr">### Save bootstraps in dataframe <br/>bootstrapped&lt;-as.data.frame(1/(pred$t^2))<br/>bootstrapped&lt;-as.data.frame(t(bootstrapped))<br/>bootstrapped&lt;-cbind(bootstrapped,pdata[,c(5,10)])<br/>dim(bootstrapped)<br/>str(bootstrapped)<br/>colnames(bootstrapped)</span><span id="85ec" class="jm jn hh ji b fi js jp l jq jr">### CREATE RESULTS for AVERAGE BW DIFFERENCES BETWEEN TREATMENTS <br/>T1.Mean.boot=matrix(ncol=43, nrow=10)<br/>T2.Mean.boot=matrix(ncol=43, nrow=10)<br/>T3.Mean.boot=matrix(ncol=43, nrow=10)<br/>T4.Mean.boot=matrix(ncol=43, nrow=10)<br/>T5.Mean.boot=matrix(ncol=43, nrow=10)<br/>T6.Mean.boot=matrix(ncol=43, nrow=10)</span><span id="dd7d" class="jm jn hh ji b fi js jp l jq jr">for (j in 0:42){<br/>  for (i in 1:10){<br/>    T1.Mean.boot[i,j]&lt;-mean(bootstrapped[,i][bootstrapped$Trt==1&amp;bootstrapped$Time==j])<br/>    T2.Mean.boot[i,j]&lt;-mean(bootstrapped[,i][bootstrapped$Trt==2&amp;bootstrapped$Time==j])<br/>    T3.Mean.boot[i,j]&lt;-mean(bootstrapped[,i][bootstrapped$Trt==3&amp;bootstrapped$Time==j])<br/>    T4.Mean.boot[i,j]&lt;-mean(bootstrapped[,i][bootstrapped$Trt==4&amp;bootstrapped$Time==j])<br/>    T5.Mean.boot[i,j]&lt;-mean(bootstrapped[,i][bootstrapped$Trt==5&amp;bootstrapped$Time==j])<br/>    T6.Mean.boot[i,j]&lt;-mean(bootstrapped[,i][bootstrapped$Trt==6&amp;bootstrapped$Time==j])<br/>  }<br/>}<br/>T1.Mean.boot&lt;-as.data.frame(T1.Mean.boot) # means for treatment 1 for each bootstrap sample and each timepoint<br/>T2.Mean.boot&lt;-as.data.frame(T2.Mean.boot) <br/>T3.Mean.boot&lt;-as.data.frame(T3.Mean.boot)<br/>T4.Mean.boot&lt;-as.data.frame(T4.Mean.boot)<br/>T5.Mean.boot&lt;-as.data.frame(T5.Mean.boot)<br/>T6.Mean.boot&lt;-as.data.frame(T6.Mean.boot)<br/>names(T1.Mean.boot) &lt;- substring(names(T1.Mean.boot), 2)<br/>names(T2.Mean.boot) &lt;- substring(names(T2.Mean.boot), 2)<br/>names(T3.Mean.boot) &lt;- substring(names(T3.Mean.boot), 2)<br/>names(T4.Mean.boot) &lt;- substring(names(T4.Mean.boot), 2)<br/>names(T5.Mean.boot) &lt;- substring(names(T5.Mean.boot), 2)<br/>names(T6.Mean.boot) &lt;- substring(names(T6.Mean.boot), 2)<br/>diffMEAN.T2T1.boot&lt;-as.data.frame(T2.Mean.boot-T1.Mean.boot) <br/>diffMEAN.T3T1.boot&lt;-as.data.frame(T3.Mean.boot-T1.Mean.boot)<br/>diffMEAN.T4T1.boot&lt;-as.data.frame(T4.Mean.boot-T1.Mean.boot)<br/>diffMEAN.T5T1.boot&lt;-as.data.frame(T5.Mean.boot-T1.Mean.boot)<br/>diffMEAN.T6T1.boot&lt;-as.data.frame(T6.Mean.boot-T1.Mean.boot)</span><span id="b2eb" class="jm jn hh ji b fi js jp l jq jr">### Create dataframe to plot differences per time-point<br/>## T2T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffMEAN.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffMEAN.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffMEAN.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffMEAN.T2T1.dist&lt;-sumBoot(diffMEAN.T2T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffMEAN.T2T1.dist&lt;-setDT(diffMEAN.T2T1.dist, keep.rownames = TRUE)[]<br/>diffMEAN.T2T1.dist&lt;-as.data.frame(diffMEAN.T2T1.dist)<br/>colnames(diffMEAN.T2T1.dist)[1]&lt;-"Day"<br/>colnames(diffMEAN.T2T1.dist)[2]&lt;-"Difference BW T2T1"<br/>colnames(diffMEAN.T2T1.dist)[3]&lt;-"LCI T2T1 BW"<br/>colnames(diffMEAN.T2T1.dist)[4]&lt;-"HCI T2T1 BW"<br/>diffMEAN.T2T1.dist$Day&lt;-as.numeric(diffMEAN.T2T1.dist$Day)<br/>diffMEAN.T2T1.dist$`Difference BW T2T1`&lt;-as.numeric(diffMEAN.T2T1.dist$`Difference BW T2T1`)<br/>diffMEAN.T2T1.dist$`LCI T2T1 BW`&lt;-as.numeric(diffMEAN.T2T1.dist$`LCI T2T1 BW`)<br/>diffMEAN.T2T1.dist$`HCI T2T1 BW`&lt;-as.numeric(diffMEAN.T2T1.dist$`HCI T2T1 BW`)</span><span id="4aff" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T2T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffMEAN.T2T1.boot[,j],breaks=5,freq=FALSE, xlab="BW difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T2T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T2T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffMEAN.T2T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffMEAN.T2T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffMEAN.T2T1.boot[,j]),max(diffMEAN.T2T1.boot[,j]),length=length(diffMEAN.T2T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffMEAN.T2T1.boot[,j]),sd=sd(diffMEAN.T2T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="b3cd" class="jm jn hh ji b fi js jp l jq jr">## T3T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffMEAN.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffMEAN.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffMEAN.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffMEAN.T3T1.dist&lt;-sumBoot(diffMEAN.T3T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffMEAN.T3T1.dist&lt;-setDT(diffMEAN.T3T1.dist, keep.rownames = TRUE)[]<br/>diffMEAN.T3T1.dist&lt;-as.data.frame(diffMEAN.T3T1.dist)<br/>colnames(diffMEAN.T3T1.dist)[1]&lt;-"Day"<br/>colnames(diffMEAN.T3T1.dist)[2]&lt;-"Difference BW T3T1"<br/>colnames(diffMEAN.T3T1.dist)[3]&lt;-"LCI T3T1 BW"<br/>colnames(diffMEAN.T3T1.dist)[4]&lt;-"HCI T3T1 BW"<br/>diffMEAN.T3T1.dist$Day&lt;-as.numeric(diffMEAN.T3T1.dist$Day)<br/>diffMEAN.T3T1.dist$`Difference BW T3T1`&lt;-as.numeric(diffMEAN.T3T1.dist$`Difference BW T3T1`)<br/>diffMEAN.T3T1.dist$`LCI T3T1 BW`&lt;-as.numeric(diffMEAN.T3T1.dist$`LCI T3T1 BW`)<br/>diffMEAN.T3T1.dist$`HCI T3T1 BW`&lt;-as.numeric(diffMEAN.T3T1.dist$`HCI T3T1 BW`)</span><span id="8146" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T3T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffMEAN.T3T1.boot[,j],breaks=5,freq=FALSE, xlab="BW difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T3T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T3T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffMEAN.T3T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffMEAN.T3T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffMEAN.T3T1.boot[,j]),max(diffMEAN.T3T1.boot[,j]),length=length(diffMEAN.T3T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffMEAN.T3T1.boot[,j]),sd=sd(diffMEAN.T3T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="4d6f" class="jm jn hh ji b fi js jp l jq jr">## T4T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffMEAN.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffMEAN.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffMEAN.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffMEAN.T4T1.dist&lt;-sumBoot(diffMEAN.T4T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffMEAN.T4T1.dist&lt;-setDT(diffMEAN.T4T1.dist, keep.rownames = TRUE)[]<br/>diffMEAN.T4T1.dist&lt;-as.data.frame(diffMEAN.T4T1.dist)<br/>colnames(diffMEAN.T4T1.dist)[1]&lt;-"Day"<br/>colnames(diffMEAN.T4T1.dist)[2]&lt;-"Difference BW T4T1"<br/>colnames(diffMEAN.T4T1.dist)[3]&lt;-"LCI T4T1 BW"<br/>colnames(diffMEAN.T4T1.dist)[4]&lt;-"HCI T4T1 BW"<br/>diffMEAN.T4T1.dist$Day&lt;-as.numeric(diffMEAN.T4T1.dist$Day)<br/>diffMEAN.T4T1.dist$`Difference BW T4T1`&lt;-as.numeric(diffMEAN.T4T1.dist$`Difference BW T4T1`)<br/>diffMEAN.T4T1.dist$`LCI T4T1 BW`&lt;-as.numeric(diffMEAN.T4T1.dist$`LCI T4T1 BW`)<br/>diffMEAN.T4T1.dist$`HCI T4T1 BW`&lt;-as.numeric(diffMEAN.T4T1.dist$`HCI T4T1 BW`)</span><span id="6451" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T4T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffMEAN.T4T1.boot[,j],breaks=5,freq=FALSE, xlab="BW difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T4T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T4T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffMEAN.T4T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffMEAN.T4T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffMEAN.T4T1.boot[,j]),max(diffMEAN.T2T1.boot[,j]),length=length(diffMEAN.T4T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffMEAN.T4T1.boot[,j]),sd=sd(diffMEAN.T4T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="323f" class="jm jn hh ji b fi js jp l jq jr">## T5T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffMEAN.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffMEAN.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffMEAN.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffMEAN.T5T1.dist&lt;-sumBoot(diffMEAN.T5T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffMEAN.T5T1.dist&lt;-setDT(diffMEAN.T5T1.dist, keep.rownames = TRUE)[]<br/>diffMEAN.T5T1.dist&lt;-as.data.frame(diffMEAN.T5T1.dist)<br/>colnames(diffMEAN.T5T1.dist)[1]&lt;-"Day"<br/>colnames(diffMEAN.T5T1.dist)[2]&lt;-"Difference BW T5T1"<br/>colnames(diffMEAN.T5T1.dist)[3]&lt;-"LCI T5T1 BW"<br/>colnames(diffMEAN.T5T1.dist)[4]&lt;-"HCI T5T1 BW"<br/>diffMEAN.T5T1.dist$Day&lt;-as.numeric(diffMEAN.T5T1.dist$Day)<br/>diffMEAN.T5T1.dist$`Difference BW T5T1`&lt;-as.numeric(diffMEAN.T5T1.dist$`Difference BW T5T1`)<br/>diffMEAN.T5T1.dist$`LCI T5T1 BW`&lt;-as.numeric(diffMEAN.T5T1.dist$`LCI T5T1 BW`)<br/>diffMEAN.T5T1.dist$`HCI T5T1 BW`&lt;-as.numeric(diffMEAN.T5T1.dist$`HCI T5T1 BW`)</span><span id="f4d6" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T5T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffMEAN.T5T1.boot[,j],breaks=5,freq=FALSE, xlab="BW difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T5T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T5T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffMEAN.T5T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffMEAN.T5T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffMEAN.T5T1.boot[,j]),max(diffMEAN.T5T1.boot[,j]),length=length(diffMEAN.T5T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffMEAN.T5T1.boot[,j]),sd=sd(diffMEAN.T5T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="5940" class="jm jn hh ji b fi js jp l jq jr">## T6T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffMEAN.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffMEAN.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffMEAN.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffMEAN.T6T1.dist&lt;-sumBoot(diffMEAN.T6T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffMEAN.T6T1.dist&lt;-setDT(diffMEAN.T6T1.dist, keep.rownames = TRUE)[]<br/>diffMEAN.T6T1.dist&lt;-as.data.frame(diffMEAN.T6T1.dist)<br/>colnames(diffMEAN.T6T1.dist)[1]&lt;-"Day"<br/>colnames(diffMEAN.T6T1.dist)[2]&lt;-"Difference BW T6T1"<br/>colnames(diffMEAN.T6T1.dist)[3]&lt;-"LCI T6T1 BW"<br/>colnames(diffMEAN.T6T1.dist)[4]&lt;-"HCI T6T1 BW"<br/>diffMEAN.T6T1.dist$Day&lt;-as.numeric(diffMEAN.T6T1.dist$Day)<br/>diffMEAN.T6T1.dist$`Difference BW T6T1`&lt;-as.numeric(diffMEAN.T6T1.dist$`Difference BW T6T1`)<br/>diffMEAN.T6T1.dist$`LCI T6T1 BW`&lt;-as.numeric(diffMEAN.T6T1.dist$`LCI T6T1 BW`)<br/>diffMEAN.T6T1.dist$`HCI T6T1 BW`&lt;-as.numeric(diffMEAN.T6T1.dist$`HCI T6T1 BW`)</span><span id="ef0c" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T6T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffMEAN.T6T1.boot[,j],breaks=5,freq=FALSE, xlab="BW difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T6T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffMEAN.T6T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffMEAN.T6T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffMEAN.T6T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffMEAN.T6T1.boot[,j]),max(diffMEAN.T6T1.boot[,j]),length=length(diffMEAN.T6T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffMEAN.T6T1.boot[,j]),sd=sd(diffMEAN.T6T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="f2b3" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in BW between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gBW1&lt;-ggplot(diffMEAN.T2T1.dist, aes(x=Day, y=`Difference BW T2T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T2T1 BW`, ymax=`HCI T2T1 BW`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="828f" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in BW between Treatment 3 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gBW2&lt;-ggplot(diffMEAN.T3T1.dist, aes(x=Day, y=`Difference BW T3T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T3T1 BW`, ymax=`HCI T3T1 BW`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="9466" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in BW between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gBW3&lt;-ggplot(diffMEAN.T4T1.dist, aes(x=Day, y=`Difference BW T4T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T4T1 BW`, ymax=`HCI T4T1 BW`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="3bea" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in BW between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gBW4&lt;-ggplot(diffMEAN.T5T1.dist, aes(x=Day, y=`Difference BW T5T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T5T1 BW`, ymax=`HCI T5T1 BW`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="4fb4" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in BW between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gBW5&lt;-ggplot(diffMEAN.T6T1.dist, aes(x=Day, y=`Difference BW T6T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T6T1 BW`, ymax=`HCI T6T1 BW`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="6c1d" class="jm jn hh ji b fi js jp l jq jr">gridBW&lt;-grid.arrange(gBW1,gBW2,gBW3,gBW4,gBW5)<br/>ggsave("TrtvsControl_BW.png", gridBW, width=16, height=8, dpi=600)<br/>dev.off()</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mr"><img src="../Images/98e2bba35a01d4072e17c1218656383b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xd7_Tg_LvNs7-7XD2OgF_g.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="dd27" class="jm jn hh ji b fi jo jp l jq jr">### CREATE RESULTS for SD DIFFERENCES BETWEEN TREATMENTS <br/>T1.SD.boot=matrix(ncol=43, nrow=10)<br/>T2.SD.boot=matrix(ncol=43, nrow=10)<br/>T3.SD.boot=matrix(ncol=43, nrow=10)<br/>T4.SD.boot=matrix(ncol=43, nrow=10)<br/>T5.SD.boot=matrix(ncol=43, nrow=10)<br/>T6.SD.boot=matrix(ncol=43, nrow=10)</span><span id="2328" class="jm jn hh ji b fi js jp l jq jr">for (j in 0:42){<br/>  for (i in 1:10){<br/>    T1.SD.boot[i,j]&lt;-sd(bootstrapped[,i][bootstrapped$Trt==1&amp;bootstrapped$Time==j])<br/>    T2.SD.boot[i,j]&lt;-sd(bootstrapped[,i][bootstrapped$Trt==2&amp;bootstrapped$Time==j])<br/>    T3.SD.boot[i,j]&lt;-sd(bootstrapped[,i][bootstrapped$Trt==3&amp;bootstrapped$Time==j])<br/>    T4.SD.boot[i,j]&lt;-sd(bootstrapped[,i][bootstrapped$Trt==4&amp;bootstrapped$Time==j])<br/>    T5.SD.boot[i,j]&lt;-sd(bootstrapped[,i][bootstrapped$Trt==5&amp;bootstrapped$Time==j])<br/>    T6.SD.boot[i,j]&lt;-sd(bootstrapped[,i][bootstrapped$Trt==6&amp;bootstrapped$Time==j])<br/>  }<br/>}<br/>T1.SD.boot&lt;-as.data.frame(T1.SD.boot) <br/>T2.SD.boot&lt;-as.data.frame(T2.SD.boot) <br/>T3.SD.boot&lt;-as.data.frame(T3.SD.boot)<br/>T4.SD.boot&lt;-as.data.frame(T4.SD.boot)<br/>T5.SD.boot&lt;-as.data.frame(T5.SD.boot)<br/>T6.SD.boot&lt;-as.data.frame(T6.SD.boot)<br/>names(T1.SD.boot) &lt;- substring(names(T1.SD.boot), 2)<br/>names(T2.SD.boot) &lt;- substring(names(T2.SD.boot), 2)<br/>names(T3.SD.boot) &lt;- substring(names(T3.SD.boot), 2)<br/>names(T4.SD.boot) &lt;- substring(names(T4.SD.boot), 2)<br/>names(T5.SD.boot) &lt;- substring(names(T5.SD.boot), 2)<br/>names(T6.SD.boot) &lt;- substring(names(T6.SD.boot), 2)<br/>diffSD.T2T1.boot&lt;-as.data.frame(T2.SD.boot-T1.SD.boot) <br/>diffSD.T3T1.boot&lt;-as.data.frame(T3.SD.boot-T1.SD.boot)<br/>diffSD.T4T1.boot&lt;-as.data.frame(T4.SD.boot-T1.SD.boot)<br/>diffSD.T5T1.boot&lt;-as.data.frame(T5.SD.boot-T1.SD.boot)<br/>diffSD.T6T1.boot&lt;-as.data.frame(T6.SD.boot-T1.SD.boot)</span><span id="5b29" class="jm jn hh ji b fi js jp l jq jr">### Create dataframe to plot differences per time-point<br/>## T2T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffSD.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffSD.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffSD.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffSD.T2T1.dist&lt;-sumBoot(diffSD.T2T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffSD.T2T1.dist&lt;-setDT(diffSD.T2T1.dist, keep.rownames = TRUE)[]<br/>diffSD.T2T1.dist&lt;-as.data.frame(diffSD.T2T1.dist)<br/>colnames(diffSD.T2T1.dist)[1]&lt;-"Day"<br/>colnames(diffSD.T2T1.dist)[2]&lt;-"Difference SD T2T1"<br/>colnames(diffSD.T2T1.dist)[3]&lt;-"LCI T2T1 SD"<br/>colnames(diffSD.T2T1.dist)[4]&lt;-"HCI T2T1 SD"<br/>diffSD.T2T1.dist$Day&lt;-as.numeric(diffSD.T2T1.dist$Day)<br/>diffSD.T2T1.dist$`Difference SD T2T1`&lt;-as.numeric(diffSD.T2T1.dist$`Difference SD T2T1`)<br/>diffSD.T2T1.dist$`LCI T2T1 SD`&lt;-as.numeric(diffSD.T2T1.dist$`LCI T2T1 SD`)<br/>diffSD.T2T1.dist$`HCI T2T1 SD`&lt;-as.numeric(diffSD.T2T1.dist$`HCI T2T1 SD`)</span><span id="d10f" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diffSD.T2T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffSD.T2T1.boot[,j],breaks=5,freq=FALSE, xlab="SD difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T2T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T2T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffSD.T2T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffSD.T2T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffSD.T2T1.boot[,j]),max(diffSD.T2T1.boot[,j]),length=length(diffSD.T2T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffSD.T2T1.boot[,j]),sd=sd(diffSD.T2T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="28f6" class="jm jn hh ji b fi js jp l jq jr">## T3T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffSD.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffSD.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffSD.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffSD.T3T1.dist&lt;-sumBoot(diffSD.T3T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffSD.T3T1.dist&lt;-setDT(diffSD.T3T1.dist, keep.rownames = TRUE)[]<br/>diffSD.T3T1.dist&lt;-as.data.frame(diffSD.T3T1.dist)<br/>colnames(diffSD.T3T1.dist)[1]&lt;-"Day"<br/>colnames(diffSD.T3T1.dist)[2]&lt;-"Difference SD T3T1"<br/>colnames(diffSD.T3T1.dist)[3]&lt;-"LCI T3T1 SD"<br/>colnames(diffSD.T3T1.dist)[4]&lt;-"HCI T3T1 SD"<br/>diffSD.T3T1.dist$Day&lt;-as.numeric(diffSD.T3T1.dist$Day)<br/>diffSD.T3T1.dist$`Difference SD T3T1`&lt;-as.numeric(diffSD.T3T1.dist$`Difference SD T3T1`)<br/>diffSD.T3T1.dist$`LCI T3T1 SD`&lt;-as.numeric(diffSD.T3T1.dist$`LCI T3T1 SD`)<br/>diffSD.T3T1.dist$`HCI T3T1 SD`&lt;-as.numeric(diffSD.T3T1.dist$`HCI T3T1 SD`)</span><span id="f0e0" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diffSD.T3T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffSD.T3T1.boot[,j],breaks=5,freq=FALSE, xlab="SD difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T3T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T3T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffSD.T3T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffSD.T3T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffSD.T3T1.boot[,j]),max(diffSD.T3T1.boot[,j]),length=length(diffSD.T3T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffSD.T3T1.boot[,j]),sd=sd(diffSD.T3T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="7906" class="jm jn hh ji b fi js jp l jq jr">## T4T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffSD.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffSD.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffSD.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffSD.T4T1.dist&lt;-sumBoot(diffSD.T4T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffSD.T4T1.dist&lt;-setDT(diffSD.T4T1.dist, keep.rownames = TRUE)[]<br/>diffSD.T4T1.dist&lt;-as.data.frame(diffSD.T4T1.dist)<br/>colnames(diffSD.T4T1.dist)[1]&lt;-"Day"<br/>colnames(diffSD.T4T1.dist)[2]&lt;-"Difference SD T4T1"<br/>colnames(diffSD.T4T1.dist)[3]&lt;-"LCI T4T1 SD"<br/>colnames(diffSD.T4T1.dist)[4]&lt;-"HCI T4T1 SD"<br/>diffSD.T4T1.dist$Day&lt;-as.numeric(diffSD.T4T1.dist$Day)<br/>diffSD.T4T1.dist$`Difference SD T4T1`&lt;-as.numeric(diffSD.T4T1.dist$`Difference SD T4T1`)<br/>diffSD.T4T1.dist$`LCI T4T1 SD`&lt;-as.numeric(diffSD.T4T1.dist$`LCI T4T1 SD`)<br/>diffSD.T4T1.dist$`HCI T4T1 SD`&lt;-as.numeric(diffSD.T4T1.dist$`HCI T4T1 SD`)</span><span id="bc3e" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diffSD.T4T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffSD.T4T1.boot[,j],breaks=5,freq=FALSE, xlab="SD difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T4T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T4T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffSD.T4T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffSD.T4T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffSD.T4T1.boot[,j]),max(diffSD.T2T1.boot[,j]),length=length(diffSD.T4T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffSD.T4T1.boot[,j]),sd=sd(diffSD.T4T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="f676" class="jm jn hh ji b fi js jp l jq jr">## T5T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffSD.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffSD.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffSD.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffSD.T5T1.dist&lt;-sumBoot(diffSD.T5T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffSD.T5T1.dist&lt;-setDT(diffSD.T5T1.dist, keep.rownames = TRUE)[]<br/>diffSD.T5T1.dist&lt;-as.data.frame(diffSD.T5T1.dist)<br/>colnames(diffSD.T5T1.dist)[1]&lt;-"Day"<br/>colnames(diffSD.T5T1.dist)[2]&lt;-"Difference SD T5T1"<br/>colnames(diffSD.T5T1.dist)[3]&lt;-"LCI T5T1 SD"<br/>colnames(diffSD.T5T1.dist)[4]&lt;-"HCI T5T1 SD"<br/>diffSD.T5T1.dist$Day&lt;-as.numeric(diffSD.T5T1.dist$Day)<br/>diffSD.T5T1.dist$`Difference SD T5T1`&lt;-as.numeric(diffSD.T5T1.dist$`Difference SD T5T1`)<br/>diffSD.T5T1.dist$`LCI T5T1 SD`&lt;-as.numeric(diffSD.T5T1.dist$`LCI T5T1 SD`)<br/>diffSD.T5T1.dist$`HCI T5T1 SD`&lt;-as.numeric(diffSD.T5T1.dist$`HCI T5T1 SD`)</span><span id="3e08" class="jm jn hh ji b fi js jp l jq jr">## Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diffSD.T5T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffSD.T5T1.boot[,j],breaks=5,freq=FALSE, xlab="SD difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T5T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T5T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffSD.T5T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffSD.T5T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffSD.T5T1.boot[,j]),max(diffSD.T5T1.boot[,j]),length=length(diffSD.T5T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffSD.T5T1.boot[,j]),sd=sd(diffSD.T5T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="d6d6" class="jm jn hh ji b fi js jp l jq jr">## T6T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffSD.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffSD.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffSD.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffSD.T6T1.dist&lt;-sumBoot(diffSD.T6T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffSD.T6T1.dist&lt;-setDT(diffSD.T6T1.dist, keep.rownames = TRUE)[]<br/>diffSD.T6T1.dist&lt;-as.data.frame(diffSD.T6T1.dist)<br/>colnames(diffSD.T6T1.dist)[1]&lt;-"Day"<br/>colnames(diffSD.T6T1.dist)[2]&lt;-"Difference SD T6T1"<br/>colnames(diffSD.T6T1.dist)[3]&lt;-"LCI T6T1 SD"<br/>colnames(diffSD.T6T1.dist)[4]&lt;-"HCI T6T1 SD"<br/>diffSD.T6T1.dist$Day&lt;-as.numeric(diffSD.T6T1.dist$Day)<br/>diffSD.T6T1.dist$`Difference SD T6T1`&lt;-as.numeric(diffSD.T6T1.dist$`Difference SD T6T1`)<br/>diffSD.T6T1.dist$`LCI T6T1 SD`&lt;-as.numeric(diffSD.T6T1.dist$`LCI T6T1 SD`)<br/>diffSD.T6T1.dist$`HCI T6T1 SD`&lt;-as.numeric(diffSD.T6T1.dist$`HCI T6T1 SD`)</span><span id="9540" class="jm jn hh ji b fi js jp l jq jr">## Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diffSD.T6T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffSD.T6T1.boot[,j],breaks=5,freq=FALSE, xlab="SD difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T6T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffSD.T6T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffSD.T6T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffSD.T6T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffSD.T6T1.boot[,j]),max(diffSD.T6T1.boot[,j]),length=length(diffSD.T6T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffSD.T6T1.boot[,j]),sd=sd(diffSD.T6T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="a709" class="jm jn hh ji b fi js jp l jq jr">## Plot differences in SD between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-2,2,0.1))<br/>gSD1&lt;-ggplot(diffSD.T2T1.dist, aes(x=Day, y=`Difference SD T2T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T2T1 SD`, ymax=`HCI T2T1 SD`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="f83d" class="jm jn hh ji b fi js jp l jq jr">## Plot differences in SD between Treatment 3 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-2,2,0.1))<br/>gSD2&lt;-ggplot(diffSD.T3T1.dist, aes(x=Day, y=`Difference SD T3T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T3T1 SD`, ymax=`HCI T3T1 SD`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="055a" class="jm jn hh ji b fi js jp l jq jr">## Plot differences in SD between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-2,2,0.1))<br/>gSD3&lt;-ggplot(diffSD.T4T1.dist, aes(x=Day, y=`Difference SD T4T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T4T1 SD`, ymax=`HCI T4T1 SD`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="42e5" class="jm jn hh ji b fi js jp l jq jr">## Plot differences in SD between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-2,2,0.1))<br/>gSD4&lt;-ggplot(diffSD.T5T1.dist, aes(x=Day, y=`Difference SD T5T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T5T1 SD`, ymax=`HCI T5T1 SD`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="868e" class="jm jn hh ji b fi js jp l jq jr">## Plot differences in SD between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-2,2,0.1))<br/>gSD5&lt;-ggplot(diffSD.T6T1.dist, aes(x=Day, y=`Difference SD T6T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T6T1 SD`, ymax=`HCI T6T1 SD`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="105a" class="jm jn hh ji b fi js jp l jq jr">gridSD&lt;-grid.arrange(gSD1,gSD2,gSD3,gSD4,gSD5)<br/>ggsave("TrtvsControl_SD.png", gridSD, width=16, height=8, dpi=600)<br/>dev.off()</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mr"><img src="../Images/b8888004baccbf9bfac4a3f5164b07a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xNROPkFVyGSIroljF_AOeg.png"/></div></div></figure><pre class="jd je jf jg fd jh ji jj jk aw jl bi"><span id="91a6" class="jm jn hh ji b fi jo jp l jq jr">T1.CV.boot&lt;-100*(T1.SD.boot/T1.Mean.boot)<br/>T2.CV.boot&lt;-100*(T2.SD.boot/T2.Mean.boot)<br/>T3.CV.boot&lt;-100*(T3.SD.boot/T3.Mean.boot)<br/>T4.CV.boot&lt;-100*(T4.SD.boot/T4.Mean.boot)<br/>T5.CV.boot&lt;-100*(T5.SD.boot/T5.Mean.boot)<br/>T6.CV.boot&lt;-100*(T6.SD.boot/T6.Mean.boot)<br/>T1.CV.boot&lt;-as.data.frame(T1.CV.boot) <br/>T2.CV.boot&lt;-as.data.frame(T2.CV.boot) <br/>T3.CV.boot&lt;-as.data.frame(T3.CV.boot)<br/>T4.CV.boot&lt;-as.data.frame(T4.CV.boot)<br/>T5.CV.boot&lt;-as.data.frame(T5.CV.boot)<br/>T6.CV.boot&lt;-as.data.frame(T6.CV.boot)<br/>names(T1.CV.boot) &lt;- substring(names(T1.CV.boot), 2)<br/>names(T2.CV.boot) &lt;- substring(names(T2.CV.boot), 2)<br/>names(T3.CV.boot) &lt;- substring(names(T3.CV.boot), 2)<br/>names(T4.CV.boot) &lt;- substring(names(T4.CV.boot), 2)<br/>names(T5.CV.boot) &lt;- substring(names(T5.CV.boot), 2)<br/>names(T6.CV.boot) &lt;- substring(names(T6.CV.boot), 2)<br/>diffCV.T2T1.boot&lt;-as.data.frame(T2.CV.boot-T1.CV.boot) <br/>diffCV.T3T1.boot&lt;-as.data.frame(T3.CV.boot-T1.CV.boot)<br/>diffCV.T4T1.boot&lt;-as.data.frame(T4.CV.boot-T1.CV.boot)<br/>diffCV.T5T1.boot&lt;-as.data.frame(T5.CV.boot-T1.CV.boot)<br/>diffCV.T6T1.boot&lt;-as.data.frame(T6.CV.boot-T1.CV.boot)</span><span id="58ba" class="jm jn hh ji b fi js jp l jq jr">### Create dataframe to plot differences per time-point<br/>## T2T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffCV.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffCV.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffCV.T2T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffCV.T2T1.dist&lt;-sumBoot(diffCV.T2T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffCV.T2T1.dist&lt;-setDT(diffCV.T2T1.dist, keep.rownames = TRUE)[]<br/>diffCV.T2T1.dist&lt;-as.data.frame(diffCV.T2T1.dist)<br/>colnames(diffCV.T2T1.dist)[1]&lt;-"Day"<br/>colnames(diffCV.T2T1.dist)[2]&lt;-"Difference CV T2T1"<br/>colnames(diffCV.T2T1.dist)[3]&lt;-"LCI T2T1 CV"<br/>colnames(diffCV.T2T1.dist)[4]&lt;-"HCI T2T1 CV"<br/>diffCV.T2T1.dist$Day&lt;-as.numeric(diffCV.T2T1.dist$Day)<br/>diffCV.T2T1.dist$`Difference CV T2T1`&lt;-as.numeric(diffCV.T2T1.dist$`Difference CV T2T1`)<br/>diffCV.T2T1.dist$`LCI T2T1 CV`&lt;-as.numeric(diffCV.T2T1.dist$`LCI T2T1 CV`)<br/>diffCV.T2T1.dist$`HCI T2T1 CV`&lt;-as.numeric(diffCV.T2T1.dist$`HCI T2T1 CV`)</span><span id="a21b" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diffCV.T2T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffCV.T2T1.boot[,j],breaks=5,freq=FALSE, xlab="CV difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T2T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T2T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffCV.T2T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffCV.T2T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffCV.T2T1.boot[,j]),max(diffCV.T2T1.boot[,j]),length=length(diffCV.T2T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffCV.T2T1.boot[,j]),sd=sd(diffCV.T2T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="2185" class="jm jn hh ji b fi js jp l jq jr">## T3T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffCV.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffCV.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffCV.T3T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffCV.T3T1.dist&lt;-sumBoot(diffCV.T3T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffCV.T3T1.dist&lt;-setDT(diffCV.T3T1.dist, keep.rownames = TRUE)[]<br/>diffCV.T3T1.dist&lt;-as.data.frame(diffCV.T3T1.dist)<br/>colnames(diffCV.T3T1.dist)[1]&lt;-"Day"<br/>colnames(diffCV.T3T1.dist)[2]&lt;-"Difference CV T3T1"<br/>colnames(diffCV.T3T1.dist)[3]&lt;-"LCI T3T1 CV"<br/>colnames(diffCV.T3T1.dist)[4]&lt;-"HCI T3T1 CV"<br/>diffCV.T3T1.dist$Day&lt;-as.numeric(diffCV.T3T1.dist$Day)<br/>diffCV.T3T1.dist$`Difference CV T3T1`&lt;-as.numeric(diffCV.T3T1.dist$`Difference CV T3T1`)<br/>diffCV.T3T1.dist$`LCI T3T1 CV`&lt;-as.numeric(diffCV.T3T1.dist$`LCI T3T1 CV`)<br/>diffCV.T3T1.dist$`HCI T3T1 CV`&lt;-as.numeric(diffCV.T3T1.dist$`HCI T3T1 CV`)</span><span id="b1d6" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T3T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffCV.T3T1.boot[,j],breaks=5,freq=FALSE, xlab="CV difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T3T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T3T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffCV.T3T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffCV.T3T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffCV.T3T1.boot[,j]),max(diffCV.T3T1.boot[,j]),length=length(diffCV.T3T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffCV.T3T1.boot[,j]),sd=sd(diffCV.T3T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="bb9d" class="jm jn hh ji b fi js jp l jq jr">## T4T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffCV.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffCV.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffCV.T4T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffCV.T4T1.dist&lt;-sumBoot(diffCV.T4T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffCV.T4T1.dist&lt;-setDT(diffCV.T4T1.dist, keep.rownames = TRUE)[]<br/>diffCV.T4T1.dist&lt;-as.data.frame(diffCV.T4T1.dist)<br/>colnames(diffCV.T4T1.dist)[1]&lt;-"Day"<br/>colnames(diffCV.T4T1.dist)[2]&lt;-"Difference CV T4T1"<br/>colnames(diffCV.T4T1.dist)[3]&lt;-"LCI T4T1 CV"<br/>colnames(diffCV.T4T1.dist)[4]&lt;-"HCI T4T1 CV"<br/>diffCV.T4T1.dist$Day&lt;-as.numeric(diffCV.T4T1.dist$Day)<br/>diffCV.T4T1.dist$`Difference CV T4T1`&lt;-as.numeric(diffCV.T4T1.dist$`Difference CV T4T1`)<br/>diffCV.T4T1.dist$`LCI T4T1 CV`&lt;-as.numeric(diffCV.T4T1.dist$`LCI T4T1 CV`)<br/>diffCV.T4T1.dist$`HCI T4T1 CV`&lt;-as.numeric(diffCV.T4T1.dist$`HCI T4T1 CV`)</span><span id="1d64" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T4T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffCV.T4T1.boot[,j],breaks=5,freq=FALSE, xlab="CV difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T4T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T4T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffCV.T4T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffCV.T4T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffCV.T4T1.boot[,j]),max(diffCV.T2T1.boot[,j]),length=length(diffCV.T4T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffCV.T4T1.boot[,j]),sd=sd(diffCV.T4T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="3937" class="jm jn hh ji b fi js jp l jq jr">## T5T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffCV.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffCV.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffCV.T5T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffCV.T5T1.dist&lt;-sumBoot(diffCV.T5T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffCV.T5T1.dist&lt;-setDT(diffCV.T5T1.dist, keep.rownames = TRUE)[]<br/>diffCV.T5T1.dist&lt;-as.data.frame(diffCV.T5T1.dist)<br/>colnames(diffCV.T5T1.dist)[1]&lt;-"Day"<br/>colnames(diffCV.T5T1.dist)[2]&lt;-"Difference CV T5T1"<br/>colnames(diffCV.T5T1.dist)[3]&lt;-"LCI T5T1 CV"<br/>colnames(diffCV.T5T1.dist)[4]&lt;-"HCI T5T1 CV"<br/>diffCV.T5T1.dist$Day&lt;-as.numeric(diffCV.T5T1.dist$Day)<br/>diffCV.T5T1.dist$`Difference CV T5T1`&lt;-as.numeric(diffCV.T5T1.dist$`Difference CV T5T1`)<br/>diffCV.T5T1.dist$`LCI T5T1 CV`&lt;-as.numeric(diffCV.T5T1.dist$`LCI T5T1 CV`)<br/>diffCV.T5T1.dist$`HCI T5T1 CV`&lt;-as.numeric(diffCV.T5T1.dist$`HCI T5T1 CV`)</span><span id="1979" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T5T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffCV.T5T1.boot[,j],breaks=5,freq=FALSE, xlab="CV difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T5T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T5T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffCV.T5T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffCV.T5T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffCV.T5T1.boot[,j]),max(diffCV.T5T1.boot[,j]),length=length(diffCV.T5T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffCV.T5T1.boot[,j]),sd=sd(diffCV.T5T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="b877" class="jm jn hh ji b fi js jp l jq jr">## T6T1<br/>sumBoot &lt;- function(merBoot) {<br/>  return(<br/>    data.frame(fit = apply(diffCV.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.5, na.rm=TRUE))),<br/>               lwr = apply(diffCV.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.025, na.rm=TRUE))),<br/>               upr = apply(diffCV.T6T1.boot, 2, function(x) as.numeric(quantile(x, probs=.975, na.rm=TRUE)))))}<br/>diffCV.T6T1.dist&lt;-sumBoot(diffCV.T6T1.boot) # diff.dist$fit[1] equals median(diff.boot$1)<br/>library(data.table)<br/>diffCV.T6T1.dist&lt;-setDT(diffCV.T6T1.dist, keep.rownames = TRUE)[]<br/>diffCV.T6T1.dist&lt;-as.data.frame(diffCV.T6T1.dist)<br/>colnames(diffCV.T6T1.dist)[1]&lt;-"Day"<br/>colnames(diffCV.T6T1.dist)[2]&lt;-"Difference CV T6T1"<br/>colnames(diffCV.T6T1.dist)[3]&lt;-"LCI T6T1 CV"<br/>colnames(diffCV.T6T1.dist)[4]&lt;-"HCI T6T1 CV"<br/>diffCV.T6T1.dist$Day&lt;-as.numeric(diffCV.T6T1.dist$Day)<br/>diffCV.T6T1.dist$`Difference CV T6T1`&lt;-as.numeric(diffCV.T6T1.dist$`Difference CV T6T1`)<br/>diffCV.T6T1.dist$`LCI T6T1 CV`&lt;-as.numeric(diffCV.T6T1.dist$`LCI T6T1 CV`)<br/>diffCV.T6T1.dist$`HCI T6T1 CV`&lt;-as.numeric(diffCV.T6T1.dist$`HCI T6T1 CV`)</span><span id="637e" class="jm jn hh ji b fi js jp l jq jr"># Histograms to diagnose bootstrapped samples<br/>par (mfrow=c(2,2))<br/>bootstraps&lt;-as.numeric(sample(colnames(diff.T6T1.boot),4))<br/>for (j in bootstraps){<br/>  #for (i in 1:length(bootstraps)){<br/>  h=hist(diffCV.T6T1.boot[,j],breaks=5,freq=FALSE, xlab="CV difference", main="", ylab="Probability") <br/>  abline(v=0, col="orange", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T6T1.boot[,j], probs=.5, na.rm=TRUE)),col="red", lwd=2)<br/>  abline(v=as.numeric(quantile(diffCV.T6T1.boot[,j], probs=.025, na.rm=TRUE)),col="red", lwd=2) # Lower bootstrapped percentile interval<br/>  abline(v=as.numeric(quantile(diffCV.T6T1.boot[,j], probs=.975, na.rm=TRUE)),col="red", lwd=2) # Upper bootstrapped percentile intervals<br/>  lines(density(diffCV.T6T1.boot[,j]), col="blue", lwd=2)<br/>  xfit&lt;-as.numeric(seq(min(diffCV.T6T1.boot[,j]),max(diffCV.T6T1.boot[,j]),length=length(diffCV.T6T1.boot[,j])))  <br/>  yfit&lt;-as.numeric(dnorm(xfit,mean=mean(diffCV.T6T1.boot[,j]),sd=sd(diffCV.T6T1.boot[,j]))) # correct if i use probability<br/>  lines(xfit, yfit, col="green", lwd=2)}</span><span id="b9e5" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in CV between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gCV1&lt;-ggplot(diffCV.T2T1.dist, aes(x=Day, y=`Difference CV T2T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T2T1 CV`, ymax=`HCI T2T1 CV`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="79f3" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in CV between Treatment 3 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gCV2&lt;-ggplot(diffCV.T3T1.dist, aes(x=Day, y=`Difference CV T3T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T3T1 CV`, ymax=`HCI T3T1 CV`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="3cde" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in CV between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gCV3&lt;-ggplot(diffCV.T4T1.dist, aes(x=Day, y=`Difference CV T4T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T4T1 CV`, ymax=`HCI T4T1 CV`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="9fcc" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in CV between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gCV4&lt;-ggplot(diffCV.T5T1.dist, aes(x=Day, y=`Difference CV T5T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T5T1 CV`, ymax=`HCI T5T1 CV`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="043e" class="jm jn hh ji b fi js jp l jq jr"># Plot differences in CV between Treatment 2 &amp; Treatment 1 for each day <br/>theme_set(theme_bw())<br/>myx&lt;-scale_x_continuous(breaks = seq(0, 42, by = 1))<br/>myy&lt;-scale_y_continuous(breaks = seq(-10,10,0.5))<br/>gCV5&lt;-ggplot(diffCV.T6T1.dist, aes(x=Day, y=`Difference CV T6T1`))+<br/>  myx+<br/>  myy+<br/>  geom_line(lwd=1.5)+<br/>  geom_ribbon(aes(ymin=`LCI T6T1 CV`, ymax=`HCI T6T1 CV`), alpha=0.3, fill="orange")+<br/>  geom_hline(yintercept=0,colour="red", lwd=1, lty=2)</span><span id="6129" class="jm jn hh ji b fi js jp l jq jr">gridCV&lt;-grid.arrange(gCV1,gCV2,gCV3,gCV4,gCV5)<br/>ggsave("TrtvsControl_CV.png", gridCV, width=16, height=8, dpi=600)</span></pre><figure class="jd je jf jg fd ju er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es mr"><img src="../Images/ff5fe784f9b2373e737b48712fed5668.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2fRi4Gt0kkYTvZJweOKh6A.png"/></div></div></figure><p id="eddb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望你喜欢它！如有疑问，请联系我！</p><div class="ms mt ez fb mu mv"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">medium.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj jv mv"/></div></div></a></div></div></div>    
</body>
</html>