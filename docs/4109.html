<html>
<head>
<title>Data Mining for Room Rental Dataset Creation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于房间租赁数据集创建的数据挖掘</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/python-code-for-finding-room-for-rent-1cedc7e9e644?source=collection_archive---------9-----------------------#2022-12-09">https://medium.com/mlearning-ai/python-code-for-finding-room-for-rent-1cedc7e9e644?source=collection_archive---------9-----------------------#2022-12-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="729f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个标题有点误导，不过更具体地说，我将展示如何编写一个python脚本来获取阿德莱德的Roomshare出租房产列表。</p><p id="58a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">搬到一个外国城市接受高等教育从来都不容易，获得专门的学生住宿特别容易，尽管不是很划算。我问了这样做过的学生，他们有一些网站，然后在网上搜索出租房产。分析的唯一标准是来自大学的愿望和租金。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/797d0325978fa97c20352a3acd28852b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eKGwQQDMiqS7jAAB"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@marcusloke?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marcus Loke</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="af5a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">几个月后，我对python有了相当的了解，也知道去哪里找。因此，对于这个“个人”问题，我们将使用</p><ol class=""><li id="e7cf" class="jt ju hh ig b ih ii il im ip jv it jw ix jx jb jy jz ka kb bi translated">BeautifulSoup软件包获得阿德莱德的出租物业，获得关于位置，价格</li><li id="58f4" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">使用谷歌的距离矩阵API来查找从广告位置到大学的距离。</li><li id="062e" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">使用Selenium Web driver将数据添加到google工作表中。</li></ol><p id="4e18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是仅包含TODO语句的代码</p><pre class="jd je jf jg fd kh ki kj bn kk kl bi"><span id="f214" class="km kn hh ki b be ko kp l kq kr"><br/># TODO 1. Get the roomshare data from Gumtree Website<br/><br/><br/># TODO 2. Get distance from the advertisements address to University<br/><br/><br/># TODO 3. Copy data from lists to a Google form<br/></span></pre><p id="bca7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将完整的问题语句分成多个待办事项列表是最好的方法之一，另一个好的做法是为所有待办事项列表定义函数，减少代码中的冗余。我计划在下一次推送中更新。</p></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><p id="3764" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">继续TODO 1。我们必须从Gumtree网页获取数据</p><p id="74ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们在应用过滤器后获得链接，这也可以通过引入用户输入和更改我们提供给Selenium驱动程序的网址来更改，但是我们的重点是</p><p id="0c6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">城市——阿德莱德，</p><p id="2b70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">价格——每周低于200美元，</p><p id="820b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">物业类别—公寓和房间</p><p id="649a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们获取链接，使用Beautiful soup获取网页的HTML数据，并使用我们的Web抓取技能来确定如何获取所需变量(在本例中为列表)中的数据。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kz"><img src="../Images/1b10a41e2b7eb9d4f83cb5088bafd26e.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/1*GXxfE7fqz58sHEPlZ1TZTg.gif"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Website’s Source Code, for particular Ad</figcaption></figure><p id="2ff6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是获取广告链接、广告标题、租金、位置和广告发布日期等数据的代码。</p><pre class="jd je jf jg fd kh ki kj bn kk kl bi"><span id="ddba" class="km kn hh ki b be ko kp l kq kr">from bs4 import BeautifulSoup<br/>import requests<br/><br/>header = {"User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5)<br/>    AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.125 Safari<br/>    /537.36","Accept-Language": "en-GB,en-US;q=0.9,en;q=0.8"<br/>}<br/>response = requests.get("https://www.gumtree.com.au/s-flatshare-<br/>           houseshare/adelaide/c18294l3006878?sort=price_asc&amp;<br/>            price=__200.00",headers=header)<br/>data = response.text<br/>soup = BeautifulSoup(data, "html.parser")<br/><br/>all_link = []<br/>all_heading = []<br/>all_price = []<br/>all_location = []<br/>all_listed_date = []<br/>all_distance = []<br/>for listings_wrapper in soup.find_all("div", class_="user-ad-collection<br/>                                      -new-design__wrapper--row"):<br/>    for listing in listings_wrapper.find_all("a",class_="user-ad-row-new-<br/>                    design link link--base-color-inherit link--hover-<br/>                    color-none link--no-underline"):<br/>        # Getting the Link, Heading, Price, Location, Listed Date <br/>        link = listing.get("href")<br/>        heading, price, third = listing.get("aria-label").split("\n")<br/>        location, listed_date = third.split(". Ad listed ")<br/>        # Storing them in a list after some basic data cleaning<br/>        all_link.append(f"https://www.gumtree.com.au{link}")<br/>        all_heading.append(heading[:-2])<br/>        all_price.append(price[16:-1])<br/>        all_location.append(location[18:]+" ,SA")<br/>        all_listed_date.append(listed_date[:-1])</span></pre><p id="7578" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我本来可以使用字典来存储所有的变量，但是为了简单起见，我使用了多个列表。</p></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><p id="9d08" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于TODO 2。我们需要得到从广告位置到大学的距离，这听起来很简单，但事实并非如此。手动距离计算将涉及获得坐标，并与大学进行比较，我将不得不使用道路旅行的距离。因此，我们使用距离矩阵API来获得从郊区到大学的道路距离。(我们不是在搜索酒店和大学之间的确切距离)</p><p id="b22a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意:谷歌距离矩阵API提供了推荐的路线距离和时间等，是谷歌的付费服务。请在探索之前阅读文档。</p><p id="e8c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是获取TODO 2的代码</p><pre class="jd je jf jg fd kh ki kj bn kk kl bi"><span id="fc29" class="km kn hh ki b be ko kp l kq kr">import GoogleMaps<br/><br/>GOOGLE_API_KEY = #Insert your Google API Key <br/><br/>gmaps = googlemaps.Client(key=GOOGLE_API_KEY)<br/>for locs in all_location:<br/>    my_dist = gmaps.distance_matrix(locs, 'Ingkarni Wardli, Adelaide SA')<br/>                                    ['rows'][0]['elements'][0]<br/>    # We assign the distance between the ad location and the University<br/>    all_distance.append(my_dist['distance']['text'])</span></pre><p id="447f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">代码很短，但它要求你在Google的云控制台上创建一个Google API密钥，设置一个计费帐户，设置配额，并使用distance_matrix方法从JSON获取所需的数据，这是一项付费服务。尽管根据谷歌地图平台网页，每个计费账户每月可获得200美元的谷歌地图平台信用。</p></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><p id="1a1e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于TODO 3。我们需要将数据存储在excel表中，这可以通过创建一个google表单并使用Selenium Web驱动程序填充每个字段来实现。(挺整齐的，嗯！)尽管在我们使用web抓取创建的数据集上有如此多的方法或数据可视化可能性，但我们坚持使用一种非常原始的方法，即使用excel表。</p><pre class="jd je jf jg fd kh ki kj bn kk kl bi"><span id="533d" class="km kn hh ki b be ko kp l kq kr">from selenium import webdriver<br/>import time<br/><br/>#Using Selenium to store the data inside a Google Form<br/>chrome_driver_path = "C:/Users/adity/Development/chromedriver.exe"  <br/>driver = webdriver.Chrome(executable_path=chrome_driver_path)<br/><br/>for n in range(len(all_link)):<br/>  driver.get(URL_TO_YOUR_GOOGLE_FORM)<br/>  time.sleep(2)<br/>  heading_f = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/<br/>              div/div[2]/div[1]/div/div/div[2]/div/div[1]/div/div[1]/<br/>              input')<br/>  location_f = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/<br/>              div/div[2]/div[2]/div/div/div[2]/div/div[1]/div/div[1]/<br/>              input')<br/>  price_f = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/<br/>            div/div[2]/div[3]/div/div/div[2]/div/div[1]/div/div[1]/input')<br/>  listed_date_f = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/<br/>                  div/div[2]/div[4]/div/div/div[2]/div/div[1]/div/div[1]/<br/>                  input')<br/>  link_f = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/div/<br/>           div[2]/div[5]/div/div/div[2]/div/div[1]/div/div[1]/input')<br/>  distance_f = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/<br/>               div/div[2]/div[6]/div/div/div[2]/div/div[1]/div/div[1]<br/>                /input')<br/>  submit_button = driver.find_element_by_xpath('//*[@id="mG61Hd"]/div[2]/<br/>                  div/div[3]/div[1]/div/div')<br/>  heading_f.send_keys(all_heading[n])<br/>  location_f.send_keys(all_location[n])<br/>  price_f.send_keys(all_price[n])<br/>  listed_date_f.send_keys(all_listed_date[n])<br/>  link_f.send_keys(all_link[n])<br/>  distance_f.send_keys(all_distance[n])<br/>  <br/>  submit_button.click()<br/>driver.quit()</span></pre><p id="99d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的代码中，我们使用Selenium web驱动程序将数据自动输入到google表单中，首先需要创建一个google表单来接受数据。然后，我们为从广告网站中挖掘的变量找到每个文本框的XPath，之后我们只需通过一次发送一个条目来填充表单。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kz"><img src="../Images/35784e0117eeff517552880e71fd9e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/1*z4XEpbiohxz8G73ynpn_4A.gif"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Output</figcaption></figure><p id="66ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以使用包含所有相关数据的Excel来分析和决定将哪栋房子出租给您。</p></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es la"><img src="../Images/652e401396b54247164fd3ed5d358e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Vpg2HfpK_iVThZSSkfcO7w.jpeg"/></div></figure><p id="d589" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">代码非常简单，可以在很多地方重构，问题是我所面临的一个真正的问题，我通过编码解决了这个问题。</p><blockquote class="lb lc ld"><p id="98c3" class="ie if le ig b ih ii ij ik il im in io lf iq ir is lg iu iv iw lh iy iz ja jb ha bi translated">估计我现在是程序员了。</p></blockquote><p id="e2d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是GitHub上的完整代码</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="li lj l"/></div></figure><div class="lk ll ez fb lm ln"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lo ab dw"><div class="lp ab lq cl cj lr"><h2 class="bd hi fi z dy ls ea eb lt ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lu l"><h3 class="bd b fi z dy ls ea eb lt ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lv l"><p class="bd b fp z dy ls ea eb lt ed ef dx translated">medium.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb jm ln"/></div></div></a></div></div></div>    
</body>
</html>