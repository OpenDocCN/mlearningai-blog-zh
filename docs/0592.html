<html>
<head>
<title>Training a Computer to Classify Distinct Images Using a Convolutional Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用卷积神经网络训练计算机对不同的图像进行分类</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/i-taught-my-computer-to-recognise-between-a-dog-and-a-cat-79c0cd529847?source=collection_archive---------2-----------------------#2021-05-22">https://medium.com/mlearning-ai/i-taught-my-computer-to-recognise-between-a-dog-and-a-cat-79c0cd529847?source=collection_archive---------2-----------------------#2021-05-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="564a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我教我的计算机使用卷积神经网络区分狗和猫，结果不是我所期望的。所以，让我们往回走一点。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/9bc8e253eb84fe7fc1e3f36f41efcf54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SuKim2w9IPbRxdtz23UNcw.gif"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx"><a class="ae js" href="https://www.analyticsvidhya.com/blog/2020/02/mathematics-behind-convolutional-neural-network/" rel="noopener ugc nofollow" target="_blank">https://www.analyticsvidhya.com/blog/2020/02/mathematics-behind-convolutional-neural-network/</a></figcaption></figure><p id="f8c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我相信我们都知道，在过去的几年里，人工智能 已经在我们的日常生活中普遍存在。但是最常见的一种应用<a class="ae js" href="https://www.sas.com/en_ca/insights/analytics/machine-learning.html#:~:text=Machine%20learning%20is%20a%20method,decisions%20with%20minimal%20human%20intervention." rel="noopener ugc nofollow" target="_blank"> <em class="jt">机器学习</em> </a>的方式是通过<a class="ae js" href="https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53" rel="noopener" target="_blank"> <strong class="ig hi">卷积神经网络</strong> </a> <strong class="ig hi">(图像分类)。</strong></p></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kb"><img src="../Images/bc0c727806be30aa5350243444d4ce92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*yGr8EB1enQQVY0b_p5OEUw.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx"><a class="ae js" href="https://deepnote.com/@donatien-subts/Untitled-Python-Project-IcLtjwWZQSi3aDNHWBtKdA" rel="noopener ugc nofollow" target="_blank">https://deepnote.com/@donatien-subts/Untitled-Python-Project-IcLtjwWZQSi3aDNHWBtKdA</a></figcaption></figure><p id="8a41" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么，现在来了解一下CNN的背景。CNN有很多方面:</p><ul class=""><li id="92eb" class="kc kd hh ig b ih ii il im ip ke it kf ix kg jb kh ki kj kk bi translated">卷积层(添加时，您必须选择滤波器的数量和大小)</li><li id="ff6d" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">每层各自的文件</li><li id="30eb" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">过滤器包括:角、边、角度、图像和形状</li><li id="8001" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">不同类型的图像，这样电脑就可以区分</li></ul><p id="f09f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每个过滤器关注图片的一个特征，所以它最终可以对其进行排序。</p><p id="3ea1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不同过滤器示例:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kq"><img src="../Images/893d4981c4424d21005fabadeaf39a77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e3_TUibNZWSDkcYTogClHg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx"><a class="ae js" href="https://debuggercafe.com/visualizing-filters-and-feature-maps-in-convolutional-neural-networks-using-pytorch/" rel="noopener ugc nofollow" target="_blank">https://debuggercafe.com/visualizing-filters-and-feature-maps-in-convolutional-neural-networks-using-pytorch/</a></figcaption></figure><p id="8c26" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">CNN也有不同的层次，每一层最终都在产品中扮演着重要的角色。还有就是(我之前说过的)<a class="ae js" href="https://databricks.com/glossary/convolutional-layer" rel="noopener ugc nofollow" target="_blank"> <em class="jt">卷积层</em></a><em class="jt"/><a class="ae js" href="https://www.geeksforgeeks.org/cnn-introduction-to-pooling-layer/#:~:text=Pooling%20layers%20are%20used%20to,generated%20by%20a%20convolution%20layer." rel="noopener ugc nofollow" target="_blank"><em class="jt"/></a><em class="jt"/>然后最后是<a class="ae js" href="https://towardsdatascience.com/convolutional-neural-network-17fb77e76c05" rel="noopener" target="_blank"> <em class="jt">【全连通】层</em> </a> <em class="jt">。</em></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kr"><img src="../Images/03047ad0401f6c07bd954a0ecb14c4cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wtsBp-6lknR1AMYy24qM5w.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx"><a class="ae js" href="https://www.researchgate.net/figure/Schematic-diagram-of-a-basic-convolutional-neural-network-CNN-architecture-26_fig1_336805909" rel="noopener ugc nofollow" target="_blank">https://www.researchgate.net/figure/Schematic-diagram-of-a-basic-convolutional-neural-network-CNN-architecture-26_fig1_336805909</a></figcaption></figure><p id="077f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">卷积层:</strong>这个层(小的来说)基本上是从一个输入图像中提取特征。并且，通过使用输入数据的小方块学习图像特征来保存像素之间的关系。这是一个数学任务，需要两个输入:一个图像矩阵和一个过滤器或内核。图像与不同过滤器的卷积可以通过应用过滤器来做诸如边缘检测、模糊和锐化之类的事情。</p><p id="77b0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">汇集层:</strong>当图像过大时，汇集层部分会减少参数的数量。空间池也称为<em class="jt">子采样</em>或<em class="jt">下采样</em>，它减少了每个地图的维度，但保留了重要信息。空间池有三种重要的不同类型:</p><ul class=""><li id="3151" class="kc kd hh ig b ih ii il im ip ke it kf ix kg jb kh ki kj kk bi translated">最大池化</li><li id="6ad0" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">平均池</li><li id="5c37" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">总和池</li></ul><p id="4d09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">全连接层:</strong>这一层是来自一层的所有输入连接到下一层的每个激活单元的地方。</p><p id="0e6e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有关不同层的更多信息，请查看:<a class="ae js" rel="noopener" href="/@RaghavPrabhu/understanding-of-convolutional-neural-network-cnn-deep-learning-99760835f148">https://medium . com/@ RaghavPrabhu/understanding-of-convolutionary-neural-network-CNN-deep-learning-99760835 f148</a></p></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ks"><img src="../Images/423b5e1de80228cc21f193adc134ebea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*amTXybp72wtAwx_Phgj1rw.jpeg"/></div><figcaption class="jo jp et er es jq jr bd b be z dx"><a class="ae js" href="https://support-blog.journiapp.com/en-us/article/207-how-to-make-a-journi-photo-book-with-face-recognition" rel="noopener ugc nofollow" target="_blank">https://support-blog.journiapp.com/en-us/article/207-how-to-make-a-journi-photo-book-with-face-recognition</a></figcaption></figure><p id="7649" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">继续，CNN(卷积神经网络)在我们的日常设备中非常普遍。一个图像分类的例子其实很让人吃惊。</p><p id="60af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的一些Iphones使用<a class="ae js" href="https://www.thalesgroup.com/en/markets/digital-identity-and-security/government/biometrics/facial-recognition" rel="noopener ugc nofollow" target="_blank"> <em class="jt">面部识别</em> </a>，这是一种图像分类，将不同人的图像分类到他们各自的文件夹中。</p><p id="6912" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">计算机必须经过充分的训练才能正确地对照片进行分类，但是在放有你妻子照片的文件夹中看到你姐姐的照片并不罕见。那是因为在这张特定的照片中，你的妹妹和妻子看起来一定非常相似。这极大地混淆了计算机，因为根据代码，这两个女人看起来是一样的。</p></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><p id="b758" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">既然我们已经写下了所有的基础知识，让我们进入主要部分，教计算机识别一只狗和一只猫。 <strong class="ig hi"> <em class="jt"> </em> </strong>所以，首先，我使用了一个名为<a class="ae js" href="https://teachablemachine.withgoogle.com/train/image" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">的网站的可教模型</strong> </a>，然后在我找到了一些这两种动物的图片并把它们添加到各自的类中后，我把这两个类分别重命名为“狗”和“猫”。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kt"><img src="../Images/abbef6ed398f73f2492ede98f8201b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sM9utnyLHkKFoTHz0JYJRw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Dog</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ku"><img src="../Images/eac10c5a3e5c111f36228aabf5d0568f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZtRmRSBMTWAHRVOFf6T8tQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Cat</figcaption></figure><p id="ecc6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我按下“训练模型”,在训练完成后，我会选择一张狗或猫的图片，然后等着看结果。我不骗你，头几次它做错了。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/36d29c8204909d5d56966a2e3daa17aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Z2CWboZuNH_mIgdkHqrJw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">In this picture, it says the photo is 67% dog and only 33% cat. But, in reality, it is supposed to be 100% cat.</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kw"><img src="../Images/46421d29045e05012ebd2989844bcdf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hd4lG5WchDkx-UAa0VejZg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">In this picture, it says the photo is 66% dog and only 34% cat. But, in reality, it is supposed to be 100% dog.</figcaption></figure><p id="ccf9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以，我不得不多运行几次...而且成功了！两只动物都得了100分</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kw"><img src="../Images/bc09b0af8aea9d70452bf1b9f12620bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XomSrSmsxL3iNzWHVdfrWQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Right result!</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kw"><img src="../Images/de57293b972a2ff8428c11f1be4b5276.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lJennWTViIDOL9m2F2OC_w.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Correct!</figcaption></figure><p id="2eaa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，关于代码…这是我解释它的视频:<a class="ae js" href="https://youtu.be/iNy7EsIzrK0" rel="noopener ugc nofollow" target="_blank">https://youtu.be/iNy7EsIzrK0</a></p><pre class="jd je jf jg fd kx ky kz la aw lb bi"><span id="ae58" class="lc ld hh ky b fi le lf l lg lh">import tensorflow.keras<br/>from PIL import Image, ImageOps<br/>import numpy as np</span><span id="e06a" class="lc ld hh ky b fi li lf l lg lh"># Disable scientific notation for clarity<br/>np.set_printoptions(suppress=True)</span><span id="ab07" class="lc ld hh ky b fi li lf l lg lh"># Load the model<br/>model = tensorflow.keras.models.load_model(‘keras_model.h5’)</span><span id="611a" class="lc ld hh ky b fi li lf l lg lh"># Create the array of the right shape to feed into the keras model<br/># The ‘length’ or number of images you can put into the array is<br/># determined by the first position in the shape tuple, in this case 1.<br/>data = np.ndarray(shape=(1, 224, 224, 3), dtype=np.float32)</span><span id="6ce1" class="lc ld hh ky b fi li lf l lg lh"># Replace this with the path to your image<br/>image = Image.open(‘test_photo.jpg’)</span><span id="b14f" class="lc ld hh ky b fi li lf l lg lh">#resize the image to a 224x224 with the same strategy as in TM2:<br/>#resizing the image to be at least 224x224 and then cropping from the center<br/>size = (224, 224)<br/>image = ImageOps.fit(image, size, Image.ANTIALIAS)</span><span id="ba2b" class="lc ld hh ky b fi li lf l lg lh">#turn the image into a numpy array<br/>image_array = np.asarray(image)</span><span id="7143" class="lc ld hh ky b fi li lf l lg lh"># display the resized image<br/>image.show()</span><span id="93ab" class="lc ld hh ky b fi li lf l lg lh"># Normalize the image<br/>normalized_image_array = (image_array.astype(np.float32) / 127.0) — 1</span><span id="d828" class="lc ld hh ky b fi li lf l lg lh"># Load the image into the array<br/>data[0] = normalized_image_array</span><span id="8f3a" class="lc ld hh ky b fi li lf l lg lh"># run the inference<br/>prediction = model.predict(data)<br/>print(prediction)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lj"><img src="../Images/da8b7656c97ac3b7e2eaabc6d9606df4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BIpRgx5FsEMhr1k2EqBKFg.gif"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx"><a class="ae js" href="https://analyticsindiamag.com/how-to-create-your-first-artificial-neural-network-in-python/" rel="noopener ugc nofollow" target="_blank">https://analyticsindiamag.com/how-to-create-your-first-artificial-neural-network-in-python/</a></figcaption></figure></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><blockquote class="lk ll lm"><p id="ca6b" class="ie if jt ig b ih ii ij ik il im in io ln iq ir is lo iu iv iw lp iy iz ja jb ha bi translated">电脑会比美国人更早理解讽刺。<strong class="ig hi"><em class="hh">——杰弗里·辛顿</em> </strong></p></blockquote><p id="77dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">纵观CNN所能做的一切，计算机也能在我们之前发现讽刺就不足为奇了。这恰恰说明了人工智能已经变得多么先进。并且希望在未来将继续改变和发展为最好的而不是最差的。</p><p id="e3bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">TL；DR: </strong>所以如你所见，制作CNN只是使用不同的形状、大小、线条和角度来确定哪张图片与哪张相关。</p><p id="2e43" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">_________________________________________________________________</p><p id="f962" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里有一个视频进一步阐述了什么是卷积神经网络:【https://youtu.be/YRhxdVk_sIsT2】</p><p id="cf3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面评论你最喜欢的动物是什么🐶或者一个🐱？</p></div></div>    
</body>
</html>