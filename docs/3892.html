<html>
<head>
<title>Cross Validation with Code Examples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ä»£ç ç¤ºä¾‹è¿›è¡Œäº¤å‰éªŒè¯</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/cross-validation-with-code-examples-eaabc440f61d?source=collection_archive---------3-----------------------#2022-11-04">https://medium.com/mlearning-ai/cross-validation-with-code-examples-eaabc440f61d?source=collection_archive---------3-----------------------#2022-11-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/4d3b3bbbaec0b062022a32deb92d854b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yz3-BSDxe4wO3pli"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/es/@agforl24?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tai Bui</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="9525" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">æ€»ç»“:</h2><ol class=""><li id="9406" class="js jt hh ju b jv jw jx jy jf jz jj ka jn kb kc kd ke kf kg bi translated">ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯ï¼Ÿ</li><li id="0101" class="js jt hh ju b jv kh jx ki jf kj jj kk jn kl kc kd ke kf kg bi translated">ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨äº¤å‰éªŒè¯ï¼Ÿ</li><li id="0ba4" class="js jt hh ju b jv kh jx ki jf kj jj kk jn kl kc kd ke kf kg bi translated">äº¤å‰éªŒè¯çš„å¸¸è§ç±»å‹æœ‰å“ªäº›ï¼Ÿ</li><li id="f3fc" class="js jt hh ju b jv kh jx ki jf kj jj kk jn kl kc kd ke kf kg bi translated">å¦‚ä½•åº”ç”¨äº¤å‰éªŒè¯(å¸¦ä»£ç )ï¼Ÿ</li><li id="e41b" class="js jt hh ju b jv kh jx ki jf kj jj kk jn kl kc kd ke kf kg bi translated">äº¤å‰éªŒè¯ä¸­çš„è¿‡åº¦æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ</li><li id="56dd" class="js jt hh ju b jv kh jx ki jf kj jj kk jn kl kc kd ke kf kg bi translated">æˆ‘ä»¬åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ</li></ol></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="48b0" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">ä»€ä¹ˆæ˜¯äº¤å‰éªŒè¯ï¼Ÿ</h2><p id="e017" class="pw-post-body-paragraph kt ku hh ju b jv jw kv kw jx jy kx ky jf kz la lb jj lc ld le jn lf lg lh kc ha bi translated">äº¤å‰éªŒè¯æ˜¯ä¸€ç§ç”¨äºè¯„ä¼°æœºå™¨å­¦ä¹ æ¨¡å‹æ€§èƒ½çš„è¯„ä¼°æŠ€æœ¯ã€‚å®ƒä½¿ç”¨å¤šä¸ªè®­ç»ƒæµ‹è¯•åˆ†å‰²æ¥è¯„ä¼°å•ä¸ªæ¨¡å‹ï¼Œå¹¶è¿”å›å¤šä¸ªå‡†ç¡®åº¦åˆ†æ•°ã€‚è¯¥è¿‡ç¨‹ç±»ä¼¼äºé‡é‡‡æ ·è¿‡ç¨‹ï¼Œä½¿ç”¨åŸå§‹æ•°æ®é›†çš„ä¸åŒå­é›†æ¥è®­ç»ƒå’Œè¯„ä¼°åŒä¸€æ¨¡å‹ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ä»ä¸€ç³»åˆ—å¾—åˆ†ä¸­è·å¾—ä¸€ä¸ªå¹³å‡å‡†ç¡®åº¦å¾—åˆ†ï¼Œä»¥ç¡®å®šæˆ‘ä»¬è®­ç»ƒçš„æ¨¡å‹æ˜¯å¦æ˜¯ä¸€ä¸ªå¥½çš„é¢„æµ‹å™¨ã€‚</p></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="b929" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ä½¿ç”¨äº¤å‰éªŒè¯ï¼Ÿ</h2><p id="bfe2" class="pw-post-body-paragraph kt ku hh ju b jv jw kv kw jx jy kx ky jf kz la lb jj lc ld le jn lf lg lh kc ha bi translated">é¦–å…ˆï¼Œäº¤å‰éªŒè¯ç»™äº†æˆ‘ä»¬ä¸€ä¸ª<strong class="ju hi">æ›´ç¨³å®šå¯é çš„æ¨¡å‹ä¼°è®¡</strong>ã€‚ä¼°è®¡çš„å‡†ç¡®åº¦åˆ†æ•°å°†æ ¹æ®åœ¨è®­ç»ƒå’Œæµ‹è¯•é›†ä¸­ç»“æŸçš„æ•°æ®æ ·æœ¬è€Œå˜åŒ–ã€‚å› æ­¤ï¼Œé€šè¿‡äº¤å‰éªŒè¯ï¼Œæˆ‘ä»¬å¯ä»¥ä»å¤šä¸ªè®­ç»ƒæµ‹è¯•æ‹†åˆ†è¿”å›çš„ä¸€ç³»åˆ—åˆ†æ•°ä¸­è·å¾—æ¨¡å‹çš„å¹³å‡å‡†ç¡®åº¦åˆ†æ•°ï¼Œè€Œä¸æ˜¯ä¾èµ–äºå•ä¸ªç‰¹å®šçš„è®­ç»ƒé›†æ¥è·å¾—æœ€ç»ˆçš„å‡†ç¡®åº¦åˆ†æ•°ã€‚</p><p id="96b3" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">ç¬¬äºŒï¼Œäº¤å‰éªŒè¯å¯ä»¥<strong class="ju hi">æ˜¾ç¤ºæ¨¡å‹æ•æ„Ÿåº¦</strong>ã€‚æœ‰äº†äº¤å‰éªŒè¯è¿”å›çš„ä¸€ç³»åˆ—å‡†ç¡®åº¦åˆ†æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¨¡å‹æ€§èƒ½åšæœ€åæƒ…å†µæˆ–æœ€å¥½æƒ…å†µçš„è®¾æƒ³ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶å‡†ç¡®åº¦åˆ†æ•°çš„åˆ†å¸ƒå›¾ï¼Œä»¥æŸ¥çœ‹æˆ‘ä»¬çš„æ¨¡å‹åœ¨æ–°æ•°æ®é›†ä¸Šè¡¨ç°ä¸ä½³æˆ–éå¸¸å¥½çš„å¯èƒ½æ€§ã€‚</p></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="b907" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">äº¤å‰éªŒè¯çš„å¸¸è§ç±»å‹æœ‰å“ªäº›ï¼Ÿ</h2><p id="178b" class="pw-post-body-paragraph kt ku hh ju b jv jw kv kw jx jy kx ky jf kz la lb jj lc ld le jn lf lg lh kc ha bi translated"><strong class="ju hi"> Ké‡äº¤å‰éªŒè¯ã€‚</strong></p><p id="2f1f" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">ä»¥K = 5ä¸ºä¾‹ã€‚å°†åŸå§‹æ•°æ®é›†éšæœºåˆ†æˆå¤§å°ç›¸ç­‰çš„5ä»½ï¼Œå¹¶é‡å¤è¯¥è¿‡ç¨‹5æ¬¡ã€‚å¯¹äºæ¯ä¸€æ¬¡ï¼Œä¸€ä¸ªæŠ˜å ä½œä¸ºæµ‹è¯•é›†ï¼Œå¦å¤–å››ä¸ªæŠ˜å ä½œä¸ºè®­ç»ƒé›†è®­ç»ƒæ¨¡å‹å¾—åˆ°ç›¸åº”çš„å‡†ç¡®ç‡å¾—åˆ†ã€‚æœ‰äº†æ‰€æœ‰è¿™äº›åˆ†æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—ä¸€ä¸ªå¹³å‡äº¤å‰éªŒè¯å‡†ç¡®åº¦åˆ†æ•°ã€‚</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ln"><img src="../Images/a3158be00b0a118e5024cca2619f4a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DkufYLIo0nU2iwQP8IG2Xg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image Source: SIADS542 by Kevyn Collins-Thompson</figcaption></figure><p id="c079" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">ç”±äºåœ¨æ¨¡å‹è®­ç»ƒå’Œæµ‹è¯•æœŸé—´ä½¿ç”¨äº†æ‰€æœ‰æ•°æ®æ ·æœ¬ï¼ŒK-foldäº¤å‰éªŒè¯è¿”å›çš„æ¨¡å‹åå·®è¾ƒå°ã€‚</p><p id="7662" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">ç„¶è€Œï¼Œå¦‚æœåŸå§‹æ•°æ®æ ·æœ¬æ˜¯æŒ‰ç…§æŸç§é¡ºåºæˆ–æ ¹æ®ç±»åˆ«æ ‡ç­¾æ’åºçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½ä¼šä»¥ä¸å¹³è¡¡çš„è®­ç»ƒå­é›†å’Œæ— ä»£è¡¨æ€§çš„æµ‹è¯•é›†æ¥ç»“æŸå¯¹æ¨¡å‹çš„è®­ç»ƒã€‚å› æ­¤ï¼Œå¾—åˆ°çš„å‡†ç¡®åº¦åˆ†æ•°å°†æ˜¯ä¸å‡†ç¡®çš„ã€‚</p><p id="3b70" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated"><strong class="ju hi">ä»£ç ç¤ºä¾‹</strong></p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="4cc6" class="iu iv hh lt b fi lx ly l lz ma"># import libs<br/>from sklearn.datasets import load_breast_cancer<br/>from sklearn.preprocessing import MinMaxScaler<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.model_selection import cross_val_score</span><span id="c9f4" class="iu iv hh lt b fi mb ly l lz ma"># get cancer data<br/>cancer = load_breast_cancer()<br/>X_cancer = cancer['data']<br/>y_cancer = cancer['target']</span><span id="7129" class="iu iv hh lt b fi mb ly l lz ma"># normalized the data<br/>scaler = MinMaxScaler()<br/>X_cancer_scaled = scaler.fit_transform(X_cancer)</span><span id="c35b" class="iu iv hh lt b fi mb ly l lz ma"># apply classifier<br/>clf = LogisticRegression()</span><span id="5bb0" class="iu iv hh lt b fi mb ly l lz ma"># get cv scores<br/>cv_scores = cross_val_score(clf, X_cancer_scaled, y_cancer, cv = 5)</span><span id="8421" class="iu iv hh lt b fi mb ly l lz ma">print('Cross validation scores (5 folds): {}'.format(cv_scores))<br/>print('The average cross validation score (5 folds): {}'.format(np.mean(cv_scores)))</span><span id="a330" class="iu iv hh lt b fi mb ly l lz ma">## final result ##<br/>## Cross validation scores (5 folds): [0.95614035 0.96491228 0.97368421 0.95614035 0.96460177]<br/>## The average cross validation score (5 folds): 0.9630957925787922</span></pre><p id="b483" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated"><strong class="ju hi">åˆ†å±‚KæŠ˜äº¤å‰éªŒè¯ã€‚</strong></p><p id="89dd" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">ä¸ºäº†è§£å†³æ½œåœ¨çš„ä¸å¹³è¡¡é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ†å±‚äº¤å‰éªŒè¯ã€‚åŸºæœ¬ä¸Šï¼Œæ•°æ®æ ·æœ¬è¢«é‡æ–°æ’åˆ—ï¼Œä»¥ç¡®ä¿æ¯ä¸ªå­é›†ä¸­ç±»çš„æ¯”ä¾‹å°½å¯èƒ½æ¥è¿‘æ•´ä¸ªæ•°æ®é›†ä¸­ç±»çš„å®é™…æ¯”ä¾‹ã€‚</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/c0cd08d39e50d1bd191689902760d365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RelCENxw7r-51P9T4tDWXg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image Source: SIADS542 by Kevyn Collins-Thompson</figcaption></figure><p id="ec0e" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">è¿™æ ·ï¼Œæ¯ä¸ªå­é›†éƒ½å¾ˆå¥½åœ°ä»£è¡¨äº†æ•´ä¸ªæ•°æ®é›†ã€‚</p><p id="3942" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated"><strong class="ju hi">ä»£ç ç¤ºä¾‹</strong></p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="3c59" class="iu iv hh lt b fi lx ly l lz ma"># import libs<br/>from sklearn.datasets import load_iris<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.model_selection import cross_val_score<br/>from sklearn.model_selection import StratifiedKFold</span><span id="2126" class="iu iv hh lt b fi mb ly l lz ma"># get iris data<br/>iris = load_iris()<br/>X_iris = iris['data']<br/>y_iris = iris['target']</span><span id="c740" class="iu iv hh lt b fi mb ly l lz ma"># stratified 3-fold splits<br/>skf = StratifiedKFold(n_splits=3)<br/>skf.get_n_splits(X_iris, y_iris)   # 3 iterations</span><span id="2cc3" class="iu iv hh lt b fi mb ly l lz ma"># apply classifier<br/>clf = LogisticRegression()</span><span id="aac7" class="iu iv hh lt b fi mb ly l lz ma"># get stratified cv scores<br/>cv_skf_scores = cross_val_score(clf, X_iris, y_iris, cv = skf)<br/>print('Cross validation scores (3 folds): {}'.format(cv_skf_scores))<br/>print('The average cross validation score (3 folds): {}'.format(np.mean(cv_skf_scores)))</span><span id="66c2" class="iu iv hh lt b fi mb ly l lz ma">## final result ##<br/>## Cross validation scores (3 folds): [0.98 0.96 0.98]<br/>## The average cross validation score (3 folds): 0.9733333333333333</span></pre><p id="4d24" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ˜¯ä¸ºäº†æ¼”ç¤ºã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬è‡ªå·±å¹¶ä¸éœ€è¦è¿›è¡Œåˆ†å±‚æ‹†åˆ†ã€‚<code class="du md me mf lt b">cross_val_score</code>ä¸­çš„<code class="du md me mf lt b">cv</code>å‚æ•°å°†è‡ªè¡Œè¯†åˆ«è¾“å…¥ä¼°ç®—å™¨ã€‚å¦‚æœ<code class="du md me mf lt b">y</code>æ˜¯äºŒè¿›åˆ¶æˆ–å¤šç±»ï¼Œåˆ™è‡ªåŠ¨ä½¿ç”¨<code class="du md me mf lt b">StratifiedKFold</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨<code class="du md me mf lt b">cv = 3 </code>ä»£æ›¿<code class="du md me mf lt b">cv = skf </code>å¾—åˆ°åŒæ ·çš„ç»“æœã€‚</p><p id="d9ce" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated"><strong class="ju hi">ç•™ä¸€äº¤å‰éªŒè¯ã€‚</strong></p><p id="bafd" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">å½“Kç­‰äºæ•°æ®é›†ä¸­æ•°æ®æ ·æœ¬çš„æ€»æ•°(n)æ—¶ï¼Œç•™ä¸€äº¤å‰éªŒè¯æ˜¯Ké‡äº¤å‰éªŒè¯ã€‚é¡¾åæ€ä¹‰ï¼Œåªç•™ä¸‹ä¸€ä¸ªæ•°æ®æ ·æœ¬ä½œä¸ºæµ‹è¯•é›†ï¼Œå…¶ä½™æ‰€æœ‰æ•°æ®æ ·æœ¬ä½œä¸ºè®­ç»ƒé›†ã€‚è¿­ä»£K = næ¬¡åï¼Œå¯ä»¥å¾—åˆ°å¹³å‡äº¤å‰éªŒè¯å‡†ç¡®ç‡å¾—åˆ†ã€‚</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/d99a1d14b69a80647962987497b69bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jchp8OiWV2yqUZrtkQGVYw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image Source: SIADS542 by Kevyn Collins-Thompson</figcaption></figure><p id="670c" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">å¦‚æœæˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰çš„Pä¸ªæ ·æœ¬è€Œä¸æ˜¯ä¸€ä¸ªæ ·æœ¬ä½œä¸ºæµ‹è¯•é›†ï¼Œé‚£ä¹ˆè¿™ç§äº¤å‰éªŒè¯ç§°ä¸º<strong class="ju hi">ç•™P-outäº¤å‰éªŒè¯</strong>ã€‚</p><p id="3faf" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated"><strong class="ju hi">ä»£ç ç¤ºä¾‹</strong></p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="ea05" class="iu iv hh lt b fi lx ly l lz ma"># import libs<br/>from sklearn.datasets import load_iris<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.model_selection import cross_val_score<br/>from sklearn.model_selection import LeaveOneOut<br/>from sklearn.model_selection import LeavePOut</span><span id="889d" class="iu iv hh lt b fi mb ly l lz ma"># get iris data<br/>iris = load_iris()<br/>X_iris = iris['data']<br/>y_iris = iris['target']</span><span id="2222" class="iu iv hh lt b fi mb ly l lz ma"># leave one out splits<br/>loo = LeaveOneOut()<br/>loo.get_n_splits(X_iris)   # 150 iterations</span><span id="ac72" class="iu iv hh lt b fi mb ly l lz ma"># leave P out splits<br/>lpo = LeavePOut(2)<br/>lpo.get_n_splits(X_iris)   # 11175 iterations</span><span id="139a" class="iu iv hh lt b fi mb ly l lz ma"># apply classifier<br/>clf = LogisticRegression()</span><span id="6332" class="iu iv hh lt b fi mb ly l lz ma"># get leave-one-out cv scores<br/>cv_loo_scores = cross_val_score(clf, X_iris, y_iris, cv = loo)<br/>print('Cross validation scores: {}'.format(cv_loo_scores))<br/>print('The average cross validation score: {}'.format(np.mean(cv_loo_scores)))</span><span id="9e8d" class="iu iv hh lt b fi mb ly l lz ma">## leave-one-out result ##<br/>Cross validation scores: [1. ... 1. 1.]<br/>The average cross validation score : 0.9666666666666667</span><span id="0b89" class="iu iv hh lt b fi mb ly l lz ma"># get leave-p-out cv scores<br/>long time to run!<br/>cv_lpo_scores = cross_val_score(clf, X_iris, y_iris, cv = lpo)<br/>print('Cross validation scores: {}'.format(cv_lpo_scores))<br/>print('The average cross validation score: {}'.format(np.mean(cv_lpo_scores)))</span><span id="ffb7" class="iu iv hh lt b fi mb ly l lz ma">## leave-p-out result ##<br/>## Cross validation scores : [1. 1. 1. ... 1. 1. 1.]<br/>## The average cross validation score: 0.9652796420581655</span></pre><p id="ca17" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">æ³¨æ„ï¼Œç•™ä¸€æ³•å’Œç•™pæ³•éƒ½æ˜¯è¯¦å°½çš„äº¤å‰éªŒè¯æŠ€æœ¯ã€‚å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå°çš„æ•°æ®é›†æ—¶ï¼Œæœ€å¥½ä½¿ç”¨å®ƒä»¬ï¼Œå¦åˆ™ï¼Œè¿è¡Œèµ·æ¥ä¼šéå¸¸æ˜‚è´µã€‚</p></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="d982" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">ç»˜åˆ¶éªŒè¯æ›²çº¿ï¼ŒæŸ¥çœ‹è¿‡åº¦æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆ</h2><p id="ace0" class="pw-post-body-paragraph kt ku hh ju b jv jw kv kw jx jy kx ky jf kz la lb jj lc ld le jn lf lg lh kc ha bi translated">ä¸‹é¢ï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="du md me mf lt b">validation_curve()</code>è·å¾—SVMæ¨¡å‹åœ¨<em class="mh">ä¹³è…ºç™Œ</em>æ•°æ®é›†ä¸Šçš„è®­ç»ƒå’Œäº¤å‰éªŒè¯åˆ†æ•°ï¼Œæˆ‘ä»¬ä¹‹å‰ä½¿ç”¨è¯¥æ•°æ®é›†æ¥æŸ¥çœ‹SVMæ¨¡å‹æ¬ æ‹Ÿåˆæˆ–è¿‡æ‹Ÿåˆçš„ç›¸åº”ä¼½é©¬å€¼ã€‚</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mi"><img src="../Images/90c3db587688ecf68036c25fffbd56de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYC52pgUFnp9uXPUE-JrKQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image by the author</figcaption></figure><p id="6a16" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ä¼½ç›å€¼ä½äº10çš„è´Ÿ7æ¬¡æ–¹æ—¶ï¼Œæ¨¡å‹æ¬ æ‹Ÿåˆï¼Œå½“ä¼½ç›å€¼é«˜äº10çš„è´Ÿ4æ¬¡æ–¹æ—¶ï¼Œæ¨¡å‹è¿‡æ‹Ÿåˆã€‚ä¸€ä¸ªå¥½çš„gammaå€¼åº”è¯¥ä»‹äºä¸¤è€…ä¹‹é—´ï¼Œå› ä¸ºè®­ç»ƒå’Œäº¤å‰éªŒè¯åˆ†æ•°éƒ½å¾ˆé«˜(â‰¥0.9)ã€‚</p><p id="d687" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated"><strong class="ju hi">ä»£ç ç¤ºä¾‹</strong></p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="a023" class="iu iv hh lt b fi lx ly l lz ma"><em class="mh">Reference: </em><a class="ae it" href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_validation_curve.html#sphx-glr-auto-examples-model-selection-plot-validation-curve-py" rel="noopener ugc nofollow" target="_blank"><em class="mh">Scikit-learn.org</em></a></span><span id="0815" class="iu iv hh lt b fi mb ly l lz ma">from sklearn.datasets import load_breast_cancer<br/>from sklearn.model_selection import validation_curve<br/>from sklearn.svm import SVC<br/>import matplotlib.pyplot as plt</span><span id="0f1b" class="iu iv hh lt b fi mb ly l lz ma"># get cancer data<br/>cancer = load_breast_cancer()<br/>X_cancer = cancer['data']<br/>y_cancer = cancer['target']</span><span id="2d0d" class="iu iv hh lt b fi mb ly l lz ma"># set gamma parameter values<br/>param_range = np.logspace(-10, -2, 6)</span><span id="50a2" class="iu iv hh lt b fi mb ly l lz ma"># get training and test scores<br/>train_score, test_score = validation_curve(SVC(random_state=0), X_cancer, y_cancer,param_name = 'gamma',param_range = param_range, cv = 5)</span><span id="4b28" class="iu iv hh lt b fi mb ly l lz ma"># get means and stds of training and test scores <br/>train_score_mean = np.mean(train_score, axis = 1)<br/>test_score_mean = np.mean(test_score, axis = 1)<br/>train_score_std = np.std(train_score, axis = 1)<br/>test_score_std = np.std(test_score, axis = 1)</span><span id="0393" class="iu iv hh lt b fi mb ly l lz ma"># make validation curve plot<br/>plt.figure(figsize = (8,6))</span><span id="d3df" class="iu iv hh lt b fi mb ly l lz ma">plt.title("Validation Curve with SVM on Breast Cancer Dataset")<br/>plt.xlabel(r"gamma $\gamma$")<br/>plt.ylabel("Accuracy Score")<br/>plt.ylim(0.0, 1.1)</span><span id="3f5a" class="iu iv hh lt b fi mb ly l lz ma">plt.semilogx(<br/>    param_range, train_score_mean, label="Training score", color="blue", lw=2<br/>)<br/>plt.fill_between(<br/>    param_range,<br/>    train_score_mean - train_score_std,<br/>    train_score_mean + train_score_std,<br/>    alpha=0.2,<br/>    color="blue",<br/>    lw=2,<br/>)<br/>plt.semilogx(<br/>    param_range, test_score_mean, label="Cross-validation score", color="green", lw=2<br/>)</span><span id="d6b0" class="iu iv hh lt b fi mb ly l lz ma">plt.fill_between(<br/>    param_range,<br/>    test_score_mean - test_score_std,<br/>    test_score_mean + test_score_std,<br/>    alpha=0.2,<br/>    color="green",<br/>    lw=2,<br/>)<br/>plt.legend(loc="best")<br/>plt.show()</span></pre></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><h2 id="1334" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">æˆ‘ä»¬åº”è¯¥æ³¨æ„ä»€ä¹ˆï¼Ÿ</h2><p id="4dfc" class="pw-post-body-paragraph kt ku hh ju b jv jw kv kw jx jy kx ky jf kz la lb jj lc ld le jn lf lg lh kc ha bi translated">äº¤å‰éªŒè¯å¯èƒ½<strong class="ju hi">è®¡ç®—é‡å¾ˆå¤§</strong>ï¼Œå°¤å…¶æ˜¯å½“æˆ‘ä»¬æœ‰ä¸€ä¸ªå¤§æ•°æ®é›†å¹¶è®¾ç½®äº†ä¸€ä¸ªå¤§æŠ˜å å€¼æ—¶ã€‚è¿™æ˜¯å› ä¸ºç®—æ³•ä¸èƒ½å¹¶è¡Œè®¡ç®—æŠ˜å ç»“æœï¼Œæ‰€ä»¥éœ€è¦Kå€çš„æ—¶é—´æ¥è·å¾—æ‰€æœ‰åˆ†æ•°ã€‚</p><p id="7a51" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated">æ­¤å¤–ï¼Œäº¤å‰éªŒè¯<strong class="ju hi">ç”¨äºæ¨¡å‹è¯„ä¼°ï¼Œè€Œéæ¨¡å‹è°ƒæ•´</strong>ã€‚æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ç½‘æ ¼æœç´¢ï¼Œè€Œä¸æ˜¯ä½¿ç”¨äº¤å‰éªŒè¯æ¥è°ƒæ•´æ¨¡å‹å‚æ•°ã€‚</p></div><div class="ab cl km kn go ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ha hb hc hd he"><p id="1360" class="pw-post-body-paragraph kt ku hh ju b jv li kv kw jx lj kx ky jf lk la lb jj ll ld le jn lm lg lh kc ha bi translated"><em class="mh">æ„Ÿè°¢é˜…è¯»ï¼å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ä¸ºæˆ‘é¼“æŒ</em>ğŸ‘æ›´å¤šå†…å®¹è¯·å…³æ³¨æˆ‘ï¼ â˜€ï¸ğŸŒ¸ğŸ˜º</p><div class="mj mk ez fb ml mm"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hi fi z dy mr ea eb ms ed ef hg bi translated">Mlearning.aiæäº¤å»ºè®®</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">å¦‚ä½•æˆä¸ºMlearning.aiä¸Šçš„ä½œå®¶</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">medium.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na in mm"/></div></div></a></div></div></div>    
</body>
</html>