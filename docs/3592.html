<html>
<head>
<title>Computer Vision &amp; Reinforcement Learning for platooning cars</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">排队汽车的计算机视觉和强化学习</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/computer-vision-reinforcement-learning-for-platooning-cars-4d81d6cc4b9c?source=collection_archive---------4-----------------------#2022-09-25">https://medium.com/mlearning-ai/computer-vision-reinforcement-learning-for-platooning-cars-4d81d6cc4b9c?source=collection_archive---------4-----------------------#2022-09-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="78a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章解释了我的硕士论文，其中的目标是创造一个代理人能够跟随另一辆车只使用单目摄像机检索的信息。除此之外，我试图用SHAP价值观来解释代理人采取的行动。</p><p id="6528" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">开发是在卡拉(<a class="ae jc" href="https://carla.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">https://carla.readthedocs.io/en/stable/</a>)完成的，这是一个由英特尔、丰田和巴塞罗那计算机视觉中心开发的用于自动驾驶研究的开源模拟器。</p><p id="140d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该项目有4个主要方面:</p><ol class=""><li id="b960" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">卡拉有分段摄像机</li><li id="3445" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">转向代理</li><li id="70b9" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">节流/制动代理(以及使用异常架构的迁移学习)</li><li id="6845" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">SHAP重视解释决策。</li></ol></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="943a" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">分段摄像机</h1><p id="e36e" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">由模拟器提供的分段照相机用于检索创建供给RL代理的环境状态所需的主要信息。</p><p id="e1b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分割相机使用不同的标签对RGB图像中的每个对象进行分类，这允许将标签映射到通过CARLA的文档识别的对象(<a class="ae jc" href="https://carla.readthedocs.io/en/latest/ref_sensors/#semantic-segmentation-camera" rel="noopener ugc nofollow" target="_blank">https://CARLA . readthe docs . io/en/latest/ref _ sensors/# semantic-segmentation-camera</a>)。当模拟开始时，环境中的每个对象都创建有一个标签。当该相机检索图像时，标签信息被编码在红色通道中，这意味着具有红色值<em class="lb">‘10’</em>的像素属于具有<em class="lb">标签‘10’</em>的对象。<em class="lb">标签‘10’</em>将是我们用例中最重要的，因为它标识了领导者。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lc"><img src="../Images/756f0406d3d3274e18885686fd499638.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6LmKGG5u0bNXEcKZ_jK3Q.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Segmented image from CARLA segmentation camera</figcaption></figure><p id="d53c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，仅用一行代码对分割图像进行操作，以将分割图像转换成仅具有前导的图像，如下所示:</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="f7df" class="lx jz hh lt b fi ly lz l ma mb">leader = (sem_camera==10)*1</span></pre><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mc"><img src="../Images/c2fa24adb3adbf1cd2950f5da815bcc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xh8wtjdJEX2myYdcBbvRLg.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Matrix manipulation to get the image used to create the state for both agents</figcaption></figure><p id="752e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有了这个最终的图像，它现在是一个二进制矩阵，其中1标识领导者，我们可以为我们的代理创建状态！</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="e9a6" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">转向代理</h1><p id="762f" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated"><strong class="ig hi">状态</strong></p><p id="68c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该代理的状态包含两个二元特征，称为<em class="lb">‘左’</em>和<em class="lb">‘右’。</em>当<em class="lb">‘left’</em>为1时，则<em class="lb">‘right’</em>为0，这意味着代理与领导者不对齐，领导者在代理的左侧。当<em class="lb">‘右’</em>为1时，则<em class="lb">‘左’</em>为0，这意味着代理与领导者不对齐，领导者在代理的右侧。当<em class="lb">‘左’</em>和<em class="lb">‘右’</em>都为0时，表示代理人与领导者对齐。</p><p id="8108" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过对滤波后的图像进行矩阵操作，我们可以很容易地提取以下信息，以确定<em class="lb">‘左’</em>是1还是0，以及【T30’‘右’是1还是0，方法如下:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es md"><img src="../Images/7a14ea61a5c44c85d941c970737a57f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KGJv7m_4Je2HpVm8.png"/></div></div></figure><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="32af" class="lx jz hh lt b fi ly lz l ma mb">center_leader = int((min(np.where(leader)[1])+max(np.where(leader)[1]))/2)</span></pre><ol class=""><li id="742b" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">如果引线的中心在x坐标低于300的像素上，那么<em class="lb">‘左’</em>为1，<em class="lb">‘右’</em>为0；</li></ol><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="73ff" class="lx jz hh lt b fi ly lz l ma mb">leader_left = (300 &gt; pixel_leader)*1</span></pre><p id="8dda" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.如果引线的中心在x坐标高于340的像素上，则“左”是0，“右”是1；</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="29a8" class="lx jz hh lt b fi ly lz l ma mb">leader_right = (340 &lt; pixel_leader)*1</span></pre><p id="bd53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.最后，如果引线的中心在x坐标在300和340之间的像素上，那么“左”是0,“右”是0。</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="0996" class="lx jz hh lt b fi ly lz l ma mb">aligned_with_leader = (300 &lt;= pixel_leader) &amp; (340 &gt;= pixel_leader)*1</span></pre><p id="dbfb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">动作</strong></p><p id="272f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们将状态输入PPO算法，该算法需要执行以下操作之一:</p><ol class=""><li id="638b" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">直走</li><li id="6261" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">向左转</li><li id="61ee" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">向右转</li></ol><p id="d9d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将根据使用softmax激活函数的输出图层计算出的最大概率来确定决策。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es me"><img src="../Images/84216baa58e313751d213502a0d5fb69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*W4M1bKrmjo6hp1Wy.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Network Architecture</figcaption></figure><p id="e13b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">奖励功能</strong></p><p id="8d56" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">奖励函数由4个部分组成:</p><ol class=""><li id="d258" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">如果发生碰撞，奖励-10</li></ol><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="38b2" class="lx jz hh lt b fi ly lz l ma mb">if len(self.collision_hist) != 0:<br/> reward_steer += -10</span></pre><p id="3712" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.如果分割图像没有<em class="lb">标签10 </em>，则奖励-10</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="afca" class="lx jz hh lt b fi ly lz l ma mb">elif sum(state[:3]) == 0: <br/>  reward_steer += -10</span></pre><p id="b022" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.如果<em class="lb">【左】</em>和<em class="lb">【右】</em>等于0，则奖励+5，否则-5</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="6a0d" class="lx jz hh lt b fi ly lz l ma mb">if state[0] == 1:<br/>  reward_steer += 5 <br/>else: <br/>  reward_steer -= 5</span></pre><p id="ce1a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.指导性决策:</p><p id="0ad9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果<em class="lb"> 'left' </em>等于1，动作是直行还是右转，则奖励-5，否则+5</p><p id="2f30" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果<em class="lb">‘右’</em>等于1，动作是直行还是左转，则奖励-5，否则+5</p><p id="fc4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果<em class="lb">‘右’</em>和<em class="lb">‘左’</em>等于0，且动作不直，则奖励-5，否则+5</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="534f" class="lx jz hh lt b fi ly lz l ma mb">if (state[1] == 1) &amp; (action_steer &gt; 0):<br/>  reward_steer -= 5<br/>elif (state[2] == 1) &amp; (action_steer &lt; 0):<br/>  reward_steer -= 5<br/>elif (state[1] == 1) &amp; (action_steer &lt; 0):<br/>  reward_steer += 5 <br/>elif (state[2] == 1) &amp; (action_steer &gt; 0):<br/>  reward_steer += 5 <br/>elif (state[0] == 1) &amp; (action_steer != 0.0):<br/>  reward_steer -= 5<br/>elif (state[0] == 1) &amp; (action_steer == 0.0):<br/>  reward_steer += 5</span></pre><p id="6200" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从这最后一个部分，我们可以看到，一个简单的启发式算法将解决这个问题，因为如果我们知道领导者在哪里，就很容易定义动作，并且对于相同的状态表示也是一样的。</p><p id="3524" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，很高兴看到PPO能够学习启发式！</p><p id="fac8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">终端状态</strong></p><ol class=""><li id="4780" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">剧集播放时间超过60秒。</li><li id="e3e8" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">代理冲突。</li><li id="0b73" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">代理丢失了领导(分段图像中没有标签<em class="lb">‘10’</em>)。</li></ol><p id="feee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">训练结果:</strong></p><p id="1d90" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在第<strong class="ig hi"> 500 </strong>集左右，该集获得的奖励发生正漂移，这意味着代理开始<strong class="ig hi">学习</strong>预期的内容。</p><p id="b6a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从第<strong class="ig hi"> 650集</strong>开始，累积奖励已经稳定，因此模型已经<strong class="ig hi">收敛</strong>。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mf"><img src="../Images/d232d0e0df182274d841854c22a753fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNZs3K1Wsu6KV7eSy84YAA.png"/></div></div></figure><h1 id="c69b" class="jy jz hh bd ka kb mg kd ke kf mh kh ki kj mi kl km kn mj kp kq kr mk kt ku kv bi translated">节流/制动剂</h1><p id="12c3" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated"><strong class="ig hi">状态</strong></p><p id="162f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该代理的状态包括三个特征，称为<em class="lb">‘距离’，【先前距离】，</em>和<em class="lb">‘速度’。</em></p><p id="e28e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lb">【距离】</em>是来自例外的预测，以及<em class="lb">【先前距离】</em>是来自先前状态的预测。'<em class="lb">速度'</em>是智能体在该时刻驾驶的速度。</p><p id="ea4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了每辆车都有的传感器“T0”速度“T1”之外，为了提取状态的其余特征，我们将使用在“T2”驾驶代理中使用的相同分割图像来提供预测距离的例外，以创建状态。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es me"><img src="../Images/48cebc3c8e1b733ce078fd6dba5c4c7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qTT9a-Bu-zegfX1v.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Process to predict distance</figcaption></figure><p id="aa87" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了能够将迁移学习与Xception一起使用，我们需要对架构进行微小的更改。</p><p id="acb1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于异常是在Imagenet数据集中训练的，目标是基于1000个可用类对图像进行分类，因此我们将输出图层从具有softmax激活函数的1000个节点更改为具有线性激活函数的1个节点。</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="fea9" class="lx jz hh lt b fi ly lz l ma mb">base_model <strong class="lt hi">=</strong> Xception(<br/>    weights<strong class="lt hi">=</strong>'imagenet',  <em class="lb"># Load weights pre-trained on ImageNet.</em><br/>    input_shape<strong class="lt hi">=</strong>(255, 255, 3),<br/>    include_top<strong class="lt hi">=False</strong>) <br/><br/>x <strong class="lt hi">=</strong> base_model<strong class="lt hi">.</strong>output<br/>x <strong class="lt hi">=</strong> GlobalAveragePooling2D()(x)<br/><br/>predictions <strong class="lt hi">=</strong> Dense(1, activation<strong class="lt hi">=</strong>"linear")(x)<br/>model <strong class="lt hi">=</strong> Model(inputs<strong class="lt hi">=</strong>base_model<strong class="lt hi">.</strong>input, outputs<strong class="lt hi">=</strong>predictions)<br/>model<strong class="lt hi">.</strong>compile(loss<strong class="lt hi">=</strong>"mae", optimizer<strong class="lt hi">=</strong>'adam', metrics<strong class="lt hi">=</strong>[tf<strong class="lt hi">.</strong>keras<strong class="lt hi">.</strong>metrics<strong class="lt hi">.</strong>MeanAbsoluteError()])</span></pre><p id="83c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">借助新的架构，我们现在可以使用大约25k的图像在数据集上训练异常，如下所示:</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es ml"><img src="../Images/6d71c45c1998318e2f5a9c75a4f92893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*xn8Jg0tEG6tW218oUeG3uw.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx">Example of images in our dataset.</figcaption></figure><p id="fa69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，经过训练，我们现在可以使用Xception来预测距离，并完成节流/制动代理所需的状态！！</p><p id="18cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">状态中的值通过将距离值除以25(这是训练期间允许的最大值，否则情节将结束)并将速度除以100(这将使速度特征的范围在0和1.2之间，因为允许的最大速度是120 km/h)来归一化。</p><p id="9699" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个状态被输入到我们的第二个PPO算法中，这个算法有一个连续的动作空间(在图像中，这个状态没有被归一化以便于解释):</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mm"><img src="../Images/e76dae9e35e9647c065a41be5f10566a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EqlSPNPZzRfKdpMp.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx">Throttle/Break Architecture</figcaption></figure><p id="5a3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该网络具有不同的输出层，其中只有一个节点具有双曲正切激活函数，该函数将确定代理是否会中断(预测&lt; 0) or accelerate (prediction &gt; 0)。</p><p id="e603" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">奖励功能</strong></p><p id="3e44" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">奖励函数由5部分组成:</p><p id="b7ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1.如果发生碰撞，奖励-10</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="f7bc" class="lx jz hh lt b fi ly lz l ma mb">if len(self.collision_hist) != 0:<br/>  reward_throttle += -10</span></pre><p id="82fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.如果领导者的距离超过25，那么奖励-10</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="679c" class="lx jz hh lt b fi ly lz l ma mb">if distance &gt; 25: <br/>  reward_throttle += -10</span></pre><p id="318b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.如果领导者在8到10之间的距离，那么奖励+5，否则-5</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="81f1" class="lx jz hh lt b fi ly lz l ma mb">if (distance &gt;= 8) &amp; (distance &lt;= 10): <br/>  reward_throttle += 5<br/>else:<br/>  reward_throttle -= 5</span></pre><p id="d855" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4 .如果代理在距离高于10时减少距离，或者在距离低于8时增加距离，则奖励+5，否则-5</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="970e" class="lx jz hh lt b fi ly lz l ma mb">if (distance &lt; previous_distance) &amp; (distance &gt; 10):<br/>  reward_throttle += 5<br/>elif (distance &gt;= previous_distance) &amp; (distance &lt; 8):<br/>  reward_throttle += 5</span></pre><p id="ed8e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.如果速度是0公里/小时&amp;领头人离我们至少有13度的距离&amp;选择的动作小于或等于0(休息)，那么奖励-5</p><pre class="ld le lf lg fd ls lt lu lv aw lw bi"><span id="1338" class="lx jz hh lt b fi ly lz l ma mb">if (int(kmh) == 0) &amp; (float(action_throttle) &lt;= 0.0) &amp; (distance &gt;= 13):<br/>  reward_throttle -= 5</span></pre><p id="a648" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">终端状态</strong></p><ol class=""><li id="1fe9" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb ji jj jk jl bi translated">剧集播放时间超过60秒。</li><li id="038e" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">代理冲突。</li><li id="e2f8" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb ji jj jk jl bi translated">到领导者的距离大于25。</li></ol><p id="e0c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">训练结果</strong></p><p id="5aae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在第<strong class="ig hi"> 430 </strong>集前后，该集获得的奖励发生正漂移，这意味着代理开始<strong class="ig hi">学习</strong>预期的内容。</p><p id="fdde" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从第<strong class="ig hi"> 650集</strong>开始，累积奖励已经稳定，因此模型已经<strong class="ig hi">收敛</strong>。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mn"><img src="../Images/f9b2b31e463e0eb698e2437155dafb1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ag3phVnIEJB5NLQCR1ckZA.png"/></div></div></figure></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><h1 id="4600" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak"> SHAP值</strong></h1><p id="27e3" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">一旦我们有了一个具有可解释特征的数组，我们就可以用它来理解我们的代理所做的决定:</p><p id="8a11" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">操舵代理:</strong></p><ul class=""><li id="944e" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb mo jj jk jl bi translated">向左转的动作由等于1的<em class="lb">‘左’</em>和等于0的<em class="lb">‘右’</em>构成的状态触发，因为红点意味着高特征值，在二进制特征中是1。在图表中，还可以在x轴上验证对模型输出的影响，在这种情况下，红点表示影响超过0.8。</li></ul><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mp"><img src="../Images/fb243e7b42e3518fe4a40d21308a1023.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WDzcMkK-v4bd-5z7g7Legw.png"/></div></div></figure><ul class=""><li id="4880" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb mo jj jk jl bi translated">直行动作由不包含任何1值的<em class="lb">‘左’</em>或【T6’‘右’的状态触发，因为对模型输出的影响小于-0.8，这将减少采取该动作的机会。这意味着，由等于0的<em class="lb">‘左’</em>和等于0的<em class="lb">‘右’</em>定义的状态将增加采取该动作的机会，因为蓝点意味着低特征值，在二进制特征中为0。事实上，从图表中很容易理解，在<em class="lb">‘左’</em>或<em class="lb">‘右’</em>中的1值降低了直行的概率。</li></ul><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mq"><img src="../Images/f7bdab287034619a9f61c8b2b25c6475.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vpz-13hMKNRvQbq3WMAWuQ.png"/></div></div></figure><ul class=""><li id="8467" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb mo jj jk jl bi translated">右转动作由<em class="lb">‘左’</em>等于0和<em class="lb">‘右’</em>等于1构成的状态触发。在图表中，还可以在x轴上验证对模型输出的影响，在这种情况下，红点表示影响超过0.8。</li></ul><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mf"><img src="../Images/d7634f2055964330132124c2d3431485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MlNamMhzQD2q43orLCDycg.png"/></div></div></figure><p id="0e01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">节流/制动代理:</strong></p><ul class=""><li id="11ec" class="jd je hh ig b ih ii il im ip jf it jg ix jh jb mo jj jk jl bi translated">当<em class="lb">‘速度’</em>特征的值高和/或<em class="lb">‘距离’</em>的值低时，代理通常使用中断。也可以看出<em class="lb">“先前距离”</em>对制动动作的重要性不如对油门的重要性。但是，该特性的低值也会触发中断。<br/>这些值是所期望的，因为短的<em class="lb">“距离”</em>将需要中断以跟上期望的距离，并且当<em class="lb">“速度”</em>很高时，从而可以保持允许在撞上领先车之前中断的安全距离。</li><li id="4952" class="jd je hh ig b ih jm il jn ip jo it jp ix jq jb mo jj jk jl bi translated">油门主要在<em class="lb">【速度】</em>低和/或<em class="lb">【距离】</em>和/或<em class="lb">【先前距离】</em>高时触发。这样的事实是有道理的，因为代理应该与领导者保持8到10之间的距离，因此如果距离大于10，它必须踩油门。</li></ul><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mr"><img src="../Images/4587b405de7a992953deea79e1722be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*P2zZ21xuC3uGJmie.png"/></div></div></figure></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><p id="ea37" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是文章的结尾，你可以在这里查看代码:</p><div class="ms mt ez fb mu mv"><a href="https://github.com/rjguedes8/platooning_vehicle" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">GitHub-rjguedes 8/车队_车辆</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">这个库是我的硕士论文的一部分，目标是创建一个能够跟随另一辆车的智能体，只使用…</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">github.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj lm mv"/></div></div></a></div><p id="bcd1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在测试环境中观看一集视频:</p><figure class="ld le lf lg fd lh"><div class="bz dy l di"><div class="nk nl l"/></div></figure><div class="ms mt ez fb mu mv"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">medium.com</p></div></div><div class="ne l"><div class="nm l ng nh ni ne nj lm mv"/></div></div></a></div></div></div>    
</body>
</html>