<html>
<head>
<title>Artist-based lyrics generator using machine learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习的基于艺术家的歌词生成器</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/artist-based-lyrics-generator-using-machine-learning-eb70dc4fb993?source=collection_archive---------2-----------------------#2022-12-30">https://medium.com/mlearning-ai/artist-based-lyrics-generator-using-machine-learning-eb70dc4fb993?source=collection_archive---------2-----------------------#2022-12-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6e51" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我将向你展示如何使用<a class="ae jc" href="https://huggingface.co" rel="noopener ugc nofollow" target="_blank"> HuggingFace </a>微调和训练你自己的变压器。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/33a4a3dbb5ebef82a6cc7b64c20d2e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I5pxCQ6An6xV27e5"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Photo by <a class="ae jc" href="https://unsplash.com/@mattbotsford?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Matt Botsford</a> on <a class="ae jc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="99a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为我的<a class="ae jc" rel="noopener" href="/mlearning-ai/how-to-generate-music-using-machine-learning-72360ba4a085">上一篇关于使用递归神经网络生成音乐的文章</a>的续篇，我们将使用HuggingFace的变形金刚根据我们训练它的艺术家来生成歌词。在这篇文章中，我们将使用狄俄墨德斯·迪亚兹的歌词，以他的写作风格创作一首新歌。我选择狄俄墨德斯是因为他的遗产和对哥伦比亚加勒比文化的影响。</p><p id="a2fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我鼓励你跟随这篇文章，挑选你最喜欢的艺术家，尝试不同的参数和/或不同的模型，看看你会得到什么样的结果。所有的代码都在Github repo中，链接在文章的最后。</p><p id="2ce9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将遵循以下步骤:</p><ul class=""><li id="8769" class="jt ju hh ig b ih ii il im ip jv it jw ix jx jb jy jz ka kb bi translated">从网上扒歌词。</li><li id="37ba" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">将歌词处理成. txt格式。</li><li id="4892" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">从HuggingFace下载标记器和模型。</li><li id="caf5" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">用收集的数据微调模型。</li><li id="fbf0" class="jt ju hh ig b ih kc il kd ip ke it kf ix kg jb jy jz ka kb bi translated">用模型的结果生成一首新歌。</li></ul></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><h1 id="3077" class="ko kp hh bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">网页抓取</h1><p id="14d5" class="pw-post-body-paragraph ie if hh ig b ih lm ij ik il ln in io ip lo ir is it lp iv iw ix lq iz ja jb ha bi translated">我们应该寻找一个网站，其中包含我们想要使用的艺术家的歌词，在我们的情况下，狄俄墨德斯。来发现<a class="ae jc" href="https://www.letras.com/diaz-diomedes/" rel="noopener ugc nofollow" target="_blank">这个网站</a>有一个可访问的(和<em class="lr">可删除的</em>)形式的所有歌词。</p><p id="2df3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们应该为这个任务使用Beautiful Soup，所以让我们导入相关的库:</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="4c94" class="lx kp hh lt b be ly lz l ma mb">import requests<br/>from bs4 import BeautifulSoup</span></pre><p id="b30a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">网页抓取是一个非常迭代的过程，建议你在做的时候理解HTML，这样你就可以对我们正在做的事情有一个大概的了解。</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="4605" class="lx kp hh lt b be ly lz l ma mb">page = requests.get('https://www.letras.com/diaz-diomedes/')<br/>soup = BeautifulSoup(page.text,'html.parser')</span></pre><p id="77ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查网站的代码，我们可以看到歌曲列表是在一个列表标签(<a class="ae jc" href="https://www.w3schools.com/tags/tag_li.asp" rel="noopener ugc nofollow" target="_blank"> <em class="lr"> &lt;【李】&gt; </em> </a>)里面的，所以我们具体来看一下这些标签。</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="34a9" class="lx kp hh lt b be ly lz l ma mb">listOfSongs = []<br/><br/>for i in soup.find_all('li'):<br/>  listOfSongs.append(i)<br/><br/>listOfSongs = [str(x) for x in listOfSongs]</span></pre><p id="a8cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦我们看到了它的内容，如果它们包含“https ”,让我们将它们附加到一个列表中，以确保我们得到了特定歌词的链接</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="7703" class="lx kp hh lt b be ly lz l ma mb">newSongs = []<br/><br/>for link in listOfSongs:<br/>  if 'https' in link:<br/>    newSongs.append(link)</span></pre><p id="cf57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是我们新名单的样子:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mc"><img src="../Images/66a35330a74fda83ea108cfb2d933214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Muko1FY5v-CDCCQEh8bCyQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Output for newSongs</figcaption></figure><p id="e382" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们从歌曲中提取链接:</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="3d41" class="lx kp hh lt b be ly lz l ma mb">urls = []<br/>for song in newSongs:<br/>  try:<br/>    urls.append(song.split('"')[13])<br/>  except:<br/>    print(song)</span></pre><p id="aad8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是我们新的歌词列表的样子:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/e21ad320d8adbb90a2c363c8ad89ba8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*bpnXkT6OyHSHT9Su-Vutzw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx">Output for newSongs</figcaption></figure><p id="8931" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们有了狄俄墨德斯所有歌曲的链接，我们可以一首接一首地抓取它们，遵循与我们目前所做的相似的模式。</p><p id="7a57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们应该有一个列表，其中每个元素都是一首歌的歌词字符串。现在我们应该创建一个包含他所有歌曲歌词的. txt文件，最好用换行符隔开。</p><p id="aac4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">说完，歌词刮擦部分就结束了。现在我们应该转向本文的标记器和模型部分。</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="160a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">令牌化器和变压器</strong></p><p id="68fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在开始选择我们的分词器之前，我们必须选择一个模型用于我们的歌词生成。常见的中型变压器是GPT-2，因此我们将使用该变压器。另一个成功的例子是伯特和罗伯塔，如果你也想试试的话。我测试了上述所有变形金刚，发现GPT-2给出了最一致的结果。</p><p id="ef71" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请记住，狄俄墨德斯·迪亚兹的所有歌曲都是西班牙语，我们将不得不使用西班牙语分词器。在我们的例子中，我们不会训练一个分词器，因为现在有足够多的西班牙语分词器就足够了。但是记号赋予器具体做什么呢？分词器将句子拆分成单词，然后将单词转换成id并存储在查找表中。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es me"><img src="../Images/c489c18866bcde2a2fb72ff44b18e613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IiYse1ng3iW9Rj_CRcp-Iw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">How tokenizers work (taken from <a class="ae jc" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fblog.floydhub.com%2Ftokenization-nlp%2F&amp;psig=AOvVaw0vxFQGfZjvh39tgZJ9jZfH&amp;ust=1672515413046000&amp;source=images&amp;cd=vfe&amp;ved=0CBEQjhxqFwoTCNi6v8qLovwCFQAAAAAdAAAAABAk" rel="noopener ugc nofollow" target="_blank">Tokenizers: How machines read</a>)</figcaption></figure><p id="8649" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在测试了HuggingFace网站推荐的几个标记器后，我发现<a class="ae jc" href="https://huggingface.co/flax-community/gpt-2-spanish" rel="noopener ugc nofollow" target="_blank"><em class="lr">flax-community/GPT-2-Spanish</em></a><em class="lr"/>是我们用例的一个很好的标记器，因为它是在<a class="ae jc" href="https://oscar-project.org" rel="noopener ugc nofollow" target="_blank"> OSCAR </a>数据集上训练的。</p><p id="5cbe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">到目前为止，我们已经刮了我们的歌词，并谈到了记号化，但我们还没有看看什么是变压器。</p><p id="262a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">转换器是一种模型架构，由编码器-解码器对组成，使用注意机制将一个序列转换为另一个序列。这是在论文<a class="ae jc" href="https://arxiv.org/abs/1706.03762" rel="noopener ugc nofollow" target="_blank">“注意力是你所需要的一切”</a>中首次介绍的，这些转换器的一个主要优势是它们可以并行化，而不是像rnn(LSTM、GRU等)那样按顺序进行。这有助于减少培训时间。</p><p id="3cca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">前面提到的注意机制为输入序列中的任何位置提供了上下文。如果输入数据是一个自然语言句子，就像本文中的情况一样，转换器不必一次处理一个单词。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mf"><img src="../Images/db9de5a450b424f074d80922bf4d807c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EFh3r8zNtzogesymErXi5Q.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Figure 1: From ‘Attention Is All You Need’</figcaption></figure><p id="d137" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想了解更多关于变形金刚的知识，我建议你看看马克西姆的<a class="ae jc" rel="noopener" href="/inside-machine-learning/what-is-a-transformer-d07dd1fbec04">什么是变形金刚？</a>还有Jay Alammar的<a class="ae jc" href="http://jalammar.github.io/illustrated-transformer/" rel="noopener ugc nofollow" target="_blank">文章</a>在上面。</p><p id="3f6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">变形金刚非常适合翻译、序列生成和情感分析。</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="8e4c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们下载用于文本处理的分词器</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="33f7" class="lx kp hh lt b be ly lz l ma mb">from transformers import AutoTokenizer, AutoModelForCausalLM<br/><br/>tokenizer = AutoTokenizer.from_pretrained("flax-community/gpt-2-spanish")<br/><br/>model = AutoModelForCausalLM.from_pretrained("flax-community/gpt-2-spanish")</span></pre><p id="7072" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们将测试加载到我们的笔记本中，并在每一个换行符处将其分开。</p><p id="ceef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这样做之后，让我们使用SciKit Learns<em class="lr">train _ test _ split</em>将它拆分到我们的训练/测试集中</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="4e5b" class="lx kp hh lt b be ly lz l ma mb">train, test = train_test_split(lines,test_size=0.15)<br/><br/>print("Train dataset length: "+str(len(train)))<br/>print("Test dataset length: "+ str(len(test)))<br/><br/>&gt;&gt;&gt; Train dataset length: 4676<br/>&gt;&gt;&gt; Test dataset length: 826</span></pre><p id="2257" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们将我们的训练集和测试集保存到单独的。txt文件供以后参考。我们还将获得它们各自的路径，供我们的模型使用</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="4e56" class="lx kp hh lt b be ly lz l ma mb">with open('traincancionesDiomedes.txt', 'w') as f:<br/>  for t in train:<br/>    f.write(t)<br/>    f.write(' ')<br/><br/><br/>with open('testcancionesDiomedes.txt', 'w') as f:<br/>  for t in test:<br/>    f.write(t)<br/>    f.write(' ')<br/><br/>train_path = 'traincancionesDiomedes.txt'<br/>test_path = 'testcancionesDiomedes.txt'</span></pre><p id="ad79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的转换器要求我们将数据加载到DataCollator中以供使用。顺便说一下，数据排序器是通过使用数据集元素列表作为输入来形成批处理的对象。如果输入的长度不同，它们会被动态填充到一个批处理的最大长度。</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="629b" class="lx kp hh lt b be ly lz l ma mb">from transformers import TextDataset,DataCollatorForLanguageModeling<br/><br/>def load_dataset(train_path,test_path,tokenizer):<br/>    train_dataset = TextDataset(<br/>          tokenizer=tokenizer,<br/>          file_path=train_path,<br/>          block_size=128)<br/><br/>    test_dataset = TextDataset(<br/>          tokenizer=tokenizer,<br/>          file_path=test_path,<br/>          block_size=128)<br/><br/>    data_collator = DataCollatorForLanguageModeling(<br/>        tokenizer=tokenizer, mlm=False,<br/>    )<br/>    return train_dataset,test_dataset,data_collator<br/><br/>train_dataset,test_dataset,data_collator = load_dataset(train_path,test_path,tokenizer)</span></pre><p id="8850" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当调用DataCollatorForLanguageModeling时，我们将使用mlm = False (mlm代表屏蔽语言建模)。</p><p id="ee84" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们通过指定输出目录(<em class="lr"> output_dir </em>)、训练时期数(<em class="lr"> num_train_epochs </em>)、训练的批量大小(<em class="lr">per _ device _ train _ batch _ size</em>)、模型评估的批量大小(<em class="lr">per _ device _ eval _ batch _ size</em>)、两次评估之间的更新步骤数(<em class="lr"> eval_steps </em>)、用于在n个步骤之后保存模型的检查点(【T10</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="34f7" class="lx kp hh lt b be ly lz l ma mb">model = AutoModelWithLMHead.from_pretrained("flax-community/gpt-2-spanish")<br/><br/>training_args = TrainingArguments(<br/>    output_dir="./gpt2-diomedes-2", <br/>    overwrite_output_dir=True,<br/>    num_train_epochs=300, <br/>    per_device_train_batch_size=32,<br/>    per_device_eval_batch_size=64,<br/>    eval_steps = 100, <br/>    save_steps=800, <br/>    warmup_steps=500<br/>    )<br/><br/>trainer = Trainer(<br/>    model=model,<br/>    args=training_args,<br/>    data_collator=data_collator,<br/>    train_dataset=train_dataset,<br/>    eval_dataset=test_dataset<br/>)</span></pre><p id="d57b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这部分可能需要一点时间，因为需要下载模型。根据您使用的型号，下载时间可能会有所不同。</p><p id="0125" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们已经设置了我们的训练器和数据，让我们开始训练模型。</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="7780" class="lx kp hh lt b be ly lz l ma mb">trainer.train()</span></pre><p id="c9fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用谷歌Colab Pro的标准GPU，大概花了一个小时，经历了300个纪元。这是模型训练的结果</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mg"><img src="../Images/c42f7168c16dee66c363c7cab5837980.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kcy2QfXfnGdeud6aThDcdw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">Graph showing how the Loss decreased on every epoch</figcaption></figure><p id="ab3b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们测试一下，如果我们给它一个单词的提示，让它完成，模型的表现如何</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="2e31" class="lx kp hh lt b be ly lz l ma mb">from transformers import pipeline<br/><br/>diomedes = pipeline('text-generation',model='./gpt2-diomedes-2', tokenizer='flax-community/gpt-2-spanish')<br/><br/>results = diomedes('Ay! ')[0]['generated_text']<br/><br/>&gt;&gt;&gt; 'Ay! Soy partidario decidir maldecir Que me perdones todo lo que yo hago Que no te conocí en la playa porque no me gustaba su actitud Que ya te la voy a pasar lista andarán mis canciones que acaban pero'</span></pre><p id="9623" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">生成的文本实际上听起来像一首歌！现在让我们来看看如何生成一首完整的歌曲！</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="9a35" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">生成歌曲</strong></p><p id="127b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你一直跟着做，现在你已经成功地用你最喜欢的艺术家训练和微调了你自己的GPT-2模型。让我们用他们的风格创作一首歌。</p><p id="3b7b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从我们的数据集中，让我们挑选几个例子，获取它们的前一个或两个单词，并使用它们作为提示</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="8f6c" class="lx kp hh lt b be ly lz l ma mb">import random<br/><br/>prompts = []<br/>for line in lines:<br/>  prompts(' '.join(line.split(' ')[:2]))<br/><br/>random_prompts =  random.sample([x for x in prompts], 20)</span></pre><p id="79eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这样，我们就有了一个20个随机抽样的两个单词提示的列表，我们将使用它来生成一首20行的歌曲。</p><p id="e2c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们调用这个模型并遍历它来生成我们的新歌。我们还可以设置一个<em class="lr"> max_length </em>参数来限制模型生成的字符数量。让我们试试20到30个字符之间的<em class="lr"> max_length </em>，这将使用<em class="lr"> random.randint() </em>随机选择</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="1941" class="lx kp hh lt b be ly lz l ma mb">song = []<br/><br/>for line in random_inits:<br/>  song.append(diomedes(f'{line}',max_length=random.randint(20, 30))[0]['generated_text'])</span></pre><p id="10b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们看看我们的模型生成了什么</p><pre class="je jf jg jh fd ls lt lu bn lv lw bi"><span id="3547" class="lx kp hh lt b be ly lz l ma mb">&gt;&gt;&gt; ['con el paso del tiempo Que no crea que todo terminó Y ni se imaginan el mundo se va, yo era el',<br/> 'Y que los cumplas a todos gusto y alegremente deseando que pase un año más más lleno de proyectos que he',<br/> 'Qué triste sería no quererte a ti cerca Para ser un gran victoria También es un compositor que vive d',<br/> 'Al fin : Aleluas No sé por qué será, pero aléjense de la',<br/> 'Dime nada yo tengo el present. Y otra ves maana morirme Pero no tienes que temer, no tienes porque aclarar',<br/> 'Y al que encuentra es al difunto  Con lo más sublime del sentimiento  Dime que hizo mal presentándote con su',<br/> ...<br/> 'Yo soy un hombre solo Será en este lugar especial Quedar para ninguno Sí, y yo no',<br/> 'Y andabas pensando en mí dijo la malvade, a la luna que respiros (se escuchaban dulces quejas ']</span></pre><p id="ff5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它肯定需要一些微调！我们可以尝试生成n个新行，然后手工挑选出最有意义的行。</p><p id="0c65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们用来生成新歌的方法有一个缺陷；我们从100多首歌曲中随机挑选了20个两个单词的提示，它们都不是关于同一个主题的，所以模型生成的行可能都是关于不同的主题。</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="0d85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结束语</strong></p><p id="9857" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">学习如何使用HuggingFace和它的模型肯定很有趣，我期待着继续使用它们。如果您有兴趣了解如何使用它，他们的网站上有很多很棒的文档和视频，展示了如何使用他们的模型和标记器。</p><p id="d26f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">再次感谢您抽出时间阅读本文。</p><p id="f1e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lr">免责声明:不要用它来创作你自己的歌曲并从中获利。这是一个实验，展示了机器学习可以做什么。请尊重那些花了数小时、数天、数月甚至数年时间来创作这些歌曲的艺术家们的作品。这篇文章仅用于教育目的。</em></p><div class="mh mi ez fb mj mk"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hi fi z dy mp ea eb mq ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">medium.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my jn mk"/></div></div></a></div></div></div>    
</body>
</html>