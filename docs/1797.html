<html>
<head>
<title>Ranking Top 11% in my first Kaggle Competition [Kuzushiji Recognition]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在我的第一次Kaggle比赛中排名前11%</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/ranking-top-11-in-my-first-kaggle-competition-kuzushiji-recognition-5a8a8a4bb461?source=collection_archive---------2-----------------------#2022-01-30">https://medium.com/mlearning-ai/ranking-top-11-in-my-first-kaggle-competition-kuzushiji-recognition-5a8a8a4bb461?source=collection_archive---------2-----------------------#2022-01-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="303e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用深度学习将古代日语书籍转录为当代日语</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/b9f56365620b1ddb10d37541472ce718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9hXuRkd3VhXj-5E4Tsa3DQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Samples of an ancient Japanese book with its contemporary Japanese transcript.</figcaption></figure><p id="dcf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi js translated">你有没有想过，我们可以通过把一个概念的书面历史文件转录/翻译成现在使用的现代语言来恢复/保存它的完整历史？</p><p id="a58a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我分享了我第一次参加Kaggle比赛的经历，那次比赛是把用Kuzushiji写的古代日本书籍翻译成当代日本文字。在这次比赛中，我作为个人成员加入，在短短1.5个月的时间里，在293支车队中排名<strong class="ig hi">第31位，我上次提交的<a class="ae kb" href="https://www.kaggle.com/c/kuzushiji-recognition/overview/evaluation" rel="noopener ugc nofollow" target="_blank"> F1成绩为0.858</a>。</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/8a33711a4c42d49599a1fd14aa48b2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2InbsfEdqx9B7Kuctkj0-w.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Private Leaderboard scores after final submission.</figcaption></figure><p id="9adc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">日本在全国范围内保存了数百万册书籍和超过10亿份历史文件，如私人信件或日记。只有0.01%的现代日本本土人能读懂，因为它们是写在《苦祖史记》里的。</p><h1 id="9a59" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">什么是Kuzushiji？</h1><p id="f6eb" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">Kuzushiji是一种草书，从8世纪开始在日本使用了一千多年。超过300万本书籍，涉及文学、科学、数学和烹饪等各种主题，至今仍保存着。然而，随着现代日本印刷术的流行，1900年被称为“小学令”的日本教科书标准化从学校课程中删除了Kuzushiji。结果，今天的大多数日本人无法阅读120年前书写或印刷的书籍。</p><p id="8248" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">自从汉字在8世纪进入日本以来，日语在官方记录中一直使用汉字(日语中的汉字)书写。然而，从9世纪晚期开始，日本人开始增加他们自己的字符集:平假名和片假名，它们来自简化日本汉字的不同方法。单个平假名和片假名字符不包含独立的语义，而是携带语音信息(就像英语字母表中的字母)。</p><p id="7d39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Kuzushiji文献中，汉字、平假名和片假名都被使用。然而，每个文档中字符类型的数量因类型而异。例如，故事书大部分是用平假名写的，而正式记录主要是用汉字写的。</p><h1 id="412a" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">数据集挑战</h1><p id="82b3" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">大量字符:<strong class="ig hi">超过4300个</strong>唯一字符存在于Kuzushiji数据集中<strong class="ig hi"> </strong>。然而，我们注意到频率分布是非常长尾的，并且大部分字符可能在整个数据集中只出现一次或两次。因此，我们面临着一个高度不平衡的数据集的问题。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lf"><img src="../Images/e1664841b331e9c501edaa5e09430cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YDw6MsXmDcSOG3w9yAYCQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Character frequency in the dataset (top 50 characters)</figcaption></figure><p id="4251" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Hentaigana:传统平假名或Hentaigana(“字符变体”)的一个特点是，许多在现代日语中只能以一种方式书写的字符可以在Kuzushiji中以多种不同方式书写。例如，这张图片显示了平假名<em class="lg"> Ha </em> (は)可以用几种不同的方式书写。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lh"><img src="../Images/4bc9d5b70448f5e2b1f907417d7f7936.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/0*NY7gUaOBEkIenK0x.jpg"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Example of Hiragana <em class="li">Ha</em> (は) that can be written in various ways in Kuzushiji</figcaption></figure><p id="903b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">人物之间的相似性:Kuzushiji中的几个人物看起来非常相似，如果不将上述人物视为上下文，很难判断这是什么人物。例如，在下图中，红色圆圈显示了3种类型的字符:<em class="lg"> Ku </em> (く)，一个迭代标记，以及<em class="lg"> Te </em> (て).</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lj"><img src="../Images/b3eab9324263b4c05ac0f675f75c5330.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*p_nJRFnYDR0MC68o.jpg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">3 types of Kuzushiji characters: <em class="li">Ku</em> (く), an iteration mark, and <em class="li">Te</em> (て).</figcaption></figure><p id="45c8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">字符之间的连接和重叠:《Kuzushiji》是用草书写的，因此在许多情况下，字符是连接或重叠的，这使得识别任务变得困难。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lk"><img src="../Images/fc85cc9ed023fecf001708ae32f8f425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*N-umBcjQ_c5g1v_C.jpg"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Bounding boxes show that characters overlap a lot in Kuzushiji.</figcaption></figure><p id="066d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">各种布局:Kuzushiji字符的布局(虽然通常排列成列)并不遵循单一的简单规则，因此将字符表示为序列并不总是那么简单。这方面的一些例子包括字符被写为环绕甚至集成到插图中。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ll"><img src="../Images/01dffa09fb52372a7520a9f7d9bc924d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hDKPhgMNvCuYk0wp.jpg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Layout challenges of Kuzushiji characters.</figcaption></figure><h1 id="6863" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">方法和实验</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lm"><img src="../Images/217fa34d1bcf22ab0ab5dd59976dfa2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kJAs_hOKCoPKAkMWjLPB9w.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Proposed Methodology and Inference Pipeline</figcaption></figure><p id="7d07" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了解决当前的问题，引入了三级管道:</p><ol class=""><li id="a627" class="ln lo hh ig b ih ii il im ip lp it lq ix lr jb ls lt lu lv bi translated">字符检测器:训练对象检测器模型来检测给定图像中的所有字符，我们选择名为<strong class="ig hi"> FCOS </strong>的全卷积一级网络来完成这项任务，FCOS是第一个无锚对象检测网络，它避免了与锚框和锚框的所有超参数相关的复杂计算。因此，它可以实现更快的推理时间，并且可以用较少的超参数调整来容易地训练。我们应用512x512滑动裁剪窗口来推断大尺寸图像，然后我们应用NMS并裁剪所有字符，以提供给下一阶段的字符识别。</li><li id="4d81" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">字符分类:为了对所有裁剪的字符进行字符分类，我们使用2个网络进行训练(ResNet18 &amp; VGG16)，图像大小为64px x 64px，最后，我们将两个模型的结果进行组合。我们发现，通过组合几个模型的结果(集合)，我们成功地将分类精度提高了7%，这对于最终的F1分数有0.09的影响。</li><li id="fe09" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">使用LSTM进行序列校正:长短期记忆网络已经被训练用于对最终分类结果进行序列校正。</li></ol><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mb"><img src="../Images/1dbcaf7f3d5b5942015b7e8fe73aa64b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1V0vqY57GO2ySCxu6Gw0g.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">LSTM Training Progress</figcaption></figure><p id="f414" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">网络训练是使用PyTorch框架完成的，带有2x 1080 nVidia GPU。FCOS需要2天，ResNet || VGG一般需要6~9小时培训，LSTM需要18小时衔接。</p><h1 id="26c5" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">承认</h1><p id="df4d" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">本次比赛中使用的所有硬件资源都由ViTrox提供，我们将本次比赛视为一项辅助项目活动，在该活动中，我们将验证和基准测试我们的深度学习知识和假设。</p><h1 id="571e" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">参考</h1><div class="mc md ez fb me mf"><a href="https://www.kaggle.com/c/kuzushiji-recognition/overview/about-kuzushiji" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hi fi z dy mk ea eb ml ed ef hg bi translated">Kuzushiji识别</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">打开了日本千年文化的大门</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">www.kaggle.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt jm mf"/></div></div></a></div><div class="mc md ez fb me mf"><a href="https://github.com/tianzhi0549/FCOS" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hi fi z dy mk ea eb ml ed ef hg bi translated">GitHub-Tianzi 0549/FCOS:FCOS:全卷积一级物体探测(ICCV'19)</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">这个项目包含了实现物体检测的FCOS算法的代码，如我们的论文《FCOS…</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">github.com</p></div></div><div class="mo l"><div class="mu l mq mr ms mo mt jm mf"/></div></div></a></div><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mv mw l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mv mw l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mv mw l"/></div></figure><div class="mc md ez fb me mf"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mg ab dw"><div class="mh ab mi cl cj mj"><h2 class="bd hi fi z dy mk ea eb ml ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mm l"><h3 class="bd b fi z dy mk ea eb ml ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mn l"><p class="bd b fp z dy mk ea eb ml ed ef dx translated">medium.com</p></div></div><div class="mo l"><div class="mx l mq mr ms mo mt jm mf"/></div></div></a></div></div></div>    
</body>
</html>