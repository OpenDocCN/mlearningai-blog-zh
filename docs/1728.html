<html>
<head>
<title>Predicting future terrorist targets with Amazon Neptune ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用亚马逊Neptune ML预测未来的恐怖袭击目标</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/predicting-future-terrorist-targets-with-amazon-neptune-ml-d5471589f0c7?source=collection_archive---------9-----------------------#2022-01-23">https://medium.com/mlearning-ai/predicting-future-terrorist-targets-with-amazon-neptune-ml-d5471589f0c7?source=collection_archive---------9-----------------------#2022-01-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/3fc430cae6e8ff0afd467536d6473d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJPxFaXvkGlCnUiyvrCVcw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Modeling Terrorist Attacks in Nigeria as a Graph Network</figcaption></figure><p id="3ffc" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们经常在现实世界的应用中看到基于图表的推荐引擎，从社交网络到电子商务平台的产品推荐。我们中的许多人已经开始依赖推荐系统来建立新的职业关系(LinkedIn)，做出购买决定(亚马逊)，甚至发现新的音乐来听(Spotify)。在社交网络(例如LinkedIn)中，基于用户的其他联系向用户显示新的联系建议或推荐。具有共同连接的用户很可能认识或想要彼此连接。因此，我们可以很容易地将社交网络表示为图形。</p><p id="9cfd" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">这篇博文的灵感来自AWS最近的一篇博客:</strong></p><div class="jr js ez fb jt ju"><a href="https://aws.amazon.com/blogs/machine-learning/graph-based-recommendation-system-with-neptune-ml-an-illustration-on-social-network-link-prediction-challenges/" rel="noopener  ugc nofollow" target="_blank"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hi fi z dy jz ea eb ka ed ef hg bi translated">基于图的Neptune ML推荐系统:以社会网络链接为例</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">推荐系统是现实世界中最广泛采用的机器学习技术之一</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">aws.amazon.com</p></div></div><div class="kd l"><div class="ke l kf kg kh kd ki in ju"/></div></div></a></div><h2 id="ad8f" class="kj kk hh bd kl km kn ko kp kq kr ks kt je ku kv kw ji kx ky kz jm la lb lc ld bi translated">语境</h2><p id="abcd" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">恐怖袭击可以自然地表示为图形网络，其中节点表示目标位置，目标位置之间的连接、袭击之间的时间顺序表示为边。下面说明了一个示例网络。如果我们想象我们有一个恐怖分子目标网络，地点(节点)在Maina Hari、Pulka、Mandaragirau、Tungushe、Kaiga、Konduga和Gasarwa。它们的关系由链接(边)表示，每个位置的目标属性(如军事基地、宗教机构、非政府组织、私人公民和财产、警察局、教育机构和政府办公室)由节点属性表示。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/47a768f95edf2a83b5786600683dca6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kVS2HxptVArTcZ51ZI5hQQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Boko Haram Attacks in Nigeria as a Graph Network</figcaption></figure><p id="6138" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这里的目标是预测下一个可能的目标位置，如果这些位置之间存在潜在的缺失链接。例如，我们是否应该提醒安全机构普尔卡和通古社之间可能有联系？查看图表，我们可以看到他们有两个共同的位置，阿拉和Maina Hari..因此，通古社和普尔卡有可能受到攻击。这些问题和直觉是网络推荐系统的主要逻辑或推理。</p></div><div class="ab cl lo lp go lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ha hb hc hd he"><p id="02e3" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在这篇博文的剩余部分，我们将使用<a class="ae lv" href="https://www.start.umd.edu/gtd/" rel="noopener ugc nofollow" target="_blank">全球恐怖主义数据库</a>，展示如何用社交网络来表达恐怖袭击。然后，我们将使用<a class="ae lv" href="https://aws.amazon.com/neptune/machine-learning/" rel="noopener ugc nofollow" target="_blank">亚马逊Neptune ML </a>和<a class="ae lv" href="https://aws.amazon.com/sagemaker/" rel="noopener ugc nofollow" target="_blank">亚马逊SageMaker </a>来训练和部署能够预测下一次可能的恐怖袭击的推荐引擎。该系统的结果是在反恐(甚至有组织犯罪)中提高基于人工智能的情报。</p><p id="0be7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们将介绍如何使用图形神经网络(GNNs)来推荐下一个可能被攻击的位置，作为一个<strong class="iv hi">链接预测</strong>问题。我们将使用亚马逊Neptune ML训练一个GNN模型，并通过链接预测任务在演示图上进行推理。GitHub上提供了示例代码(根据要求)。</p><h2 id="b69e" class="kj kk hh bd kl km kn ko kp kq kr ks kt je ku kv kw ji kx ky kz jm la lb lc ld bi translated">基于图形神经网络的路段预测</h2><p id="1f95" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">考虑到以前的恐怖袭击目标网络，我们希望预测/推荐恐怖组织可能袭击的地点。我们希望加强安全人员的情报收集，收集潜在目标位置的信息。Konduga和Tungushe拥有共同的城市/城镇属性，但没有共同的链接。哪个会比较好推荐？当被框定为一个链接预测问题时，任务被分配给两个节点之间任何可能的一个分数。链接分数越高，这个推荐就越有可能收敛。通过学习图中已经存在的链接结构，链接预测模型可以概括新的链接预测，从而“完成”图。</p><p id="6d2c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要了解更多关于图形神经网络中的链接预测以及GNNs如何工作的信息，请查看AWS的博客文章，【Neptune ML的基于图形的推荐系统:社交网络链接预测挑战的说明。</p><h1 id="7024" class="lw kk hh bd kl lx ly lz kp ma mb mc kt md me mf kw mg mh mi kz mj mk ml lc mm bi translated">用亚马逊Neptune ML训练我们的图形卷积网络</h1><p id="2b2a" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">Neptune ML使用图形神经网络技术在您的图形数据上自动创建、训练和部署ML模型。Neptune ML支持常见的图预测任务，例如节点分类和回归、边分类和回归以及链接预测。Neptune ML的动力来自:</p><ul class=""><li id="9c00" class="mn mo hh iv b iw ix ja jb je mp ji mq jm mr jq ms mt mu mv bi translated"><a class="ae lv" href="https://aws.amazon.com/neptune/" rel="noopener ugc nofollow" target="_blank"> Amazon Neptune </a>:一个快速、可靠、完全托管的图形数据库，针对存储数十亿条关系和以毫秒级延迟查询图形进行了优化。</li><li id="99c0" class="mn mo hh iv b iw mw ja mx je my ji mz jm na jq ms mt mu mv bi translated">Amazon SageMaker :一个完全托管的服务，为每个开发人员和数据科学家提供快速准备构建、训练和部署ML模型的能力。</li><li id="e9db" class="mn mo hh iv b iw mw ja mx je my ji mz jm na jq ms mt mu mv bi translated"><a class="ae lv" href="https://www.dgl.ai/" rel="noopener ugc nofollow" target="_blank">深度图形库(DGL) </a>:一个<a class="ae lv" href="https://github.com/dmlc/dgl/" rel="noopener ugc nofollow" target="_blank">开源</a>，高性能，可伸缩的Python包，用于图形上的DL。</li></ul><p id="053a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">使用<a class="ae lv" href="https://docs.aws.amazon.com/neptune/latest/userguide/machine-learning.html" rel="noopener ugc nofollow" target="_blank"> AWS CloudFormation快速入门模板</a>，您可以轻松开始使用Neptune ML。它设置了必要的基础设施组件，包括Neptune DB集群，并设置了网络配置、IAM角色和关联的SageMaker notebook实例，并为Neptune ML预填充了笔记本样本。<em class="nb">完成后不要忘记删除堆栈</em>。</p><h2 id="c804" class="kj kk hh bd kl km kn ko kp kq kr ks kt je ku kv kw ji kx ky kz jm la lb lc ld bi translated">原始数据准备</h2><p id="6f98" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">如前所述，我们将利用全球恐怖主义数据库。对于本例，我们将直接利用网站上的数据子集。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nc"><img src="../Images/50ebfe67fac55e29938322db23323be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9JoFm3n_SJ3QtlckdWLNPQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Pandas read_html table from <a class="ae lv" href="https://www.start.umd.edu/gtd/" rel="noopener ugc nofollow" target="_blank">Global Terrorism Database</a> website</figcaption></figure><p id="19fb" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在我们的数据样本已经准备好了，是时候用Amazon Neptune ML训练我们的GNN模型了。下图显示了Neptune ML训练基于GNN的推荐系统的步骤。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nd"><img src="../Images/21d30148c4fdadfc3472011310de88d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q1vV9qys7xAYN9LRGsisjw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Source: <a class="ae lv" href="https://aws.amazon.com/blogs/machine-learning/graph-based-recommendation-system-with-neptune-ml-an-illustration-on-social-network-link-prediction-challenges/" rel="noopener ugc nofollow" target="_blank">Graph-based recommendation system with Neptune ML: An illustration on social network link prediction challenges</a></figcaption></figure><h2 id="205b" class="kj kk hh bd kl km kn ko kp kq kr ks kt je ku kv kw ji kx ky kz jm la lb lc ld bi translated">数据导出配置</h2><p id="0eec" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">我们的Neptune ML过程的第一步是从Neptune集群导出图形数据。我们必须为数据导出任务指定参数和模型配置。我们使用Neptune工作台进行所有的配置和推荐。工作台让我们可以使用Amazon SageMaker托管的Jupyter笔记本来处理Neptune DB集群。此外，它在笔记本电脑中提供了许多神奇的命令，节省了大量的时间和精力。以下是我们的导出参数示例:</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ne"><img src="../Images/4f19152ce051c11f7d39ee11b34287b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DDuDQTYH5cSktbRkRh5_Ow.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Neptune ML export params</figcaption></figure><p id="e0aa" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">关于<code class="du nf ng nh ni b">export_params</code>所需配置的更多信息，参见<a class="ae lv" href="https://docs.aws.amazon.com/neptune/latest/userguide/machine-learning-data-export.html" rel="noopener ugc nofollow" target="_blank">从Neptune为Neptune ML导出数据</a>。</p><h2 id="f926" class="kj kk hh bd kl km kn ko kp kq kr ks kt je ku kv kw ji kx ky kz jm la lb lc ld bi translated">数据预处理</h2><p id="3483" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">Neptune ML执行特征提取和编码，作为数据处理步骤的一部分。常见的属性预处理类型包括:通过一键编码对分类特征进行编码，对数字特征进行分桶，或者使用word2vec对字符串属性或其他自由格式的文本属性值进行编码。</p><p id="6921" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要运行数据预处理，请使用下面的Neptune notebook magic命令:<code class="du nf ng nh ni b">%neptune_ml dataprocessing start</code></p><p id="0695" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">详见<a class="ae lv" href="https://docs.aws.amazon.com/neptune/latest/userguide/machine-learning-on-graphs-processing.html" rel="noopener ugc nofollow" target="_blank">处理从Neptune导出的图形数据用于训练</a>。</p><h2 id="5514" class="kj kk hh bd kl km kn ko kp kq kr ks kt je ku kv kw ji kx ky kz jm la lb lc ld bi translated">模型培训和部署</h2><p id="d72b" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">下一步是GNN模型的自动化训练。模型训练分两个阶段完成。第一阶段使用SageMaker处理作业来生成模型训练策略。这是一个配置集，它指定了将用于模型训练的模型类型和模型超参数范围。然后，将启动SageMaker超参数调优作业。</p><p id="2188" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要开始训练步骤，您可以使用<code class="du nf ng nh ni b">%neptune_ml training start</code>命令。</p><p id="43e6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">一旦训练步骤完成，我们就可以在SageMaker端点后面部署GNN模型，开始实时提供预测服务。模型输入将是我们需要在遭到攻击后识别可能的恐怖分子目标的城市，以及边类型，输出将是基于该城市的可能的恐怖分子目标的列表。</p><p id="223c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要将模型部署到SageMaker端点实例，使用<code class="du nf ng nh ni b">%neptune_ml endpoint create</code>命令。</p><p id="1dde" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">更多信息见<a class="ae lv" href="https://docs.aws.amazon.com/neptune/latest/userguide/machine-learning-on-graphs-model-training.html" rel="noopener ugc nofollow" target="_blank">使用Neptune ML </a>训练模型。</p><h2 id="d606" class="kj kk hh bd kl km kn ko kp kq kr ks kt je ku kv kw ji kx ky kz jm la lb lc ld bi translated">使用Gremlin查询ML模型</h2><p id="b3c8" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">一旦端点准备好了，我们就可以用它来进行图推理查询。Neptune ML支持Gremlin或SPARQL中的图推理查询。在我们的例子中，我们现在可以用Neptune ML检查城市“Ala”上的潜在恐怖分子目标。它需要几乎相同的语法来遍历边缘，并列出通过ATTACKED_AFTER连接连接到Ala的其他城市。</p><pre class="lk ll lm ln fd nj ni nk nl aw nm bi"><span id="a998" class="kj kk hh ni b fi nn no l np nq">%%gremlin <br/>g.with("Neptune#ml.endpoint","${endpoint_name}").      V().hasLabel('City').has('name', 'Ala').       out('ATTACKED_AFTER').with("Neptune#ml.prediction").hasLabel('City').values('name')</span></pre><p id="dabc" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">下面是另一个例子，可以用来预测“阿拉”受到攻击后最有可能被攻击的前八大城市:</p><pre class="lk ll lm ln fd nj ni nk nl aw nm bi"><span id="2c60" class="kj kk hh ni b fi nn no l np nq">%%gremlin <br/>g.with("Neptune#ml.endpoint","${endpoint_name}").with("Neptune#ml.limit",8).V().hasLabel('City').has('name', 'Ala').       out('ATTACKED_AFTER').with("Neptune#ml.prediction").hasLabel('City').values('name')</span></pre><p id="ce14" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">更多信息见Neptune ML 中的<a class="ae lv" href="https://docs.aws.amazon.com/neptune/latest/userguide/machine-learning-on-graphs-inference-queries.html" rel="noopener ugc nofollow" target="_blank"> Gremlin推理查询。</a></p><h1 id="75c9" class="lw kk hh bd kl lx ly lz kp ma mb mc kt md me mf kw mg mh mi kz mj mk ml lc mm bi translated">结论</h1><p id="73df" class="pw-post-body-paragraph it iu hh iv b iw le iy iz ja lf jc jd je lg jg jh ji lh jk jl jm li jo jp jq ha bi translated">这篇文章的灵感来自AWS blogpost <a class="ae lv" href="https://aws.amazon.com/blogs/machine-learning/graph-based-recommendation-system-with-neptune-ml-an-illustration-on-social-network-link-prediction-challenges/" rel="noopener ugc nofollow" target="_blank">基于图形的推荐系统Neptune ML:一个关于社交网络链接预测挑战的例子</a>。我们展示了Neptune ML和GNNs如何使用链接预测任务，结合图表中复杂交互模式的信息，帮助安全机构加强情报收集，以挫败恐怖袭击。</p><p id="3d06" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">对于生产就绪的实现，该解决方案需要在更大的数据集上进行训练。我们还可以考虑丰富数据集，特别是具有其他属性的位置(节点)天气条件、到特定兴趣点的距离等。</p></div><div class="ab cl lo lp go lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ha hb hc hd he"><p id="51a8" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">想在AWS上构建你的下一个AI用例？你可以通过<a class="ae lv" href="mailto:elesin.olalekan@gmail.com" rel="noopener ugc nofollow" target="_blank">电子邮件</a>联系我，在<a class="ae lv" href="https://twitter.com/elesinOlalekan" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我，或者在<a class="ae lv" href="https://www.linkedin.com/in/elesinolalekan/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我，订阅我在Medium上的时事通讯。</p><div class="jr js ez fb jt ju"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hi fi z dy jz ea eb ka ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">medium.com</p></div></div><div class="kd l"><div class="nr l kf kg kh kd ki in ju"/></div></div></a></div></div></div>    
</body>
</html>