<html>
<head>
<title>My DA Journey — SQL Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的DA之旅— SQL项目</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/my-da-journey-sql-project-ee5e0c1cb416?source=collection_archive---------3-----------------------#2021-02-28">https://medium.com/mlearning-ai/my-da-journey-sql-project-ee5e0c1cb416?source=collection_archive---------3-----------------------#2021-02-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a716" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我喜欢玩数据。它满足了好奇心——为什么？怎么会？真的吗？现实并没有被设定，直到它的边界被数据分析确定，即使那样，它也没有结束。</p><p id="0a35" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我曾在另一个环境中主要使用JMP进行数据分析，但迄今为止，我还没有使用SQL和编程等技术技能处理过数据。这篇博客文章和后面的文章将记录我作为数据分析师实习生进入数据世界的旅程。</p><p id="974e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">到目前为止，我在培训中已经完成了3个项目，我将在这里分享最新的一个，题为“当代音乐中的歌词及其影响”。该任务包括数据清理、在SSMS和Excel上使用SQL进行分析，以及提交分析结果。</p><p id="3911" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">目标和范围:</strong></p><p id="a509" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我的项目的目标是研究英国当代音乐的歌词在1960年至2019年期间在使用积极和消极词汇方面的变化及其影响。正面词汇指的是赞美、崇拜和钦佩的词汇，而负面词汇指的是暗示、攻击、冒犯和贬损的词汇。该分析提取单词，并相应地将歌曲分类为词类——“正面”或“负面”。单词列表如下表所示:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/bb10d314ebe0756dc735a616008d4acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*LozVBhuUhDb2E_lk3adxuA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">List of Positive and Negative Words To Search For In Lyrics (* is used to replace vowels for publishing purpose. Actual word and its various tenses are used in the SQL queries.)</figcaption></figure><p id="e409" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分析范围包括Billboard Top 100歌曲，因为只有当歌曲受欢迎并具有代表性的受众规模时，推导其影响力才有意义。</p><p id="97df" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">数据来源:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/38870c6392ddb7426f5279cba1e5dae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*9aB-b32UrFT5AI8iFr6GrA.png"/></div></figure><p id="558e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">流程:</strong></p><ol class=""><li id="0450" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb jt ju jv jw bi translated">使用Excel和Power Query完成了数据清理。Excel已经足够了，但是我发现替换unicode字符串的便利性令人无法抗拒。</li><li id="026e" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb jt ju jv jw bi translated">以相同的结构排列文件。由于这些文件来自不同的源，因此有必要将它们安排在相同的结构中，以便在SQL查询中组合它们来获得正确的结果。</li><li id="ccb0" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb jt ju jv jw bi translated">运行SQL查询对原始数据进行完整性检查，并检查结果是否符合要求。</li></ol><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kc"><img src="../Images/5394a74c5323d07b2dc9993d2d907d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*ftMX-IK02DIzyIc7a1Dr9w.png"/></div></figure><p id="2bf4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> ERD: </strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kd"><img src="../Images/fea1fa113c489de94f882b487d7d480d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e2a9k1VWHd6aBYpkXhao7g.png"/></div></div></figure><p id="1f23" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">分析:</strong></p><ol class=""><li id="f69e" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb jt ju jv jw bi translated">了解流派是如何随着时间的推移而变化的:</li></ol><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/37537f31856b898cbe65803d3b9c375d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*19xBCF69O_fSBgoZZYldeQ.png"/></div></figure><ul class=""><li id="45db" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">在Billboard Top 100排行榜上，流行音乐与其他音乐类型的竞争越来越激烈，摇滚音乐位居第二。</li><li id="93cc" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">近年来，在Billboard排名前100的歌曲中，超过80首来自流行音乐，这并不奇怪，因为流行音乐很容易听，并以大众吸引力为卖点。</li><li id="9aff" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">Hip Hop (grey)从20世纪80年代就加入了Billboard舞台，但并不具备与流行和摇滚同等的地位。</li><li id="7188" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">布鲁斯和爵士乐不再出现在广告牌上，甚至摇滚也减少了。到世纪之交，Billboard主要是流行、摇滚、嘻哈和乡村音乐。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/bd98fd3de64191f27add0e487536f189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*9ThXjb-spdEE6Mx3JFMlnQ.png"/></div></figure><ul class=""><li id="e490" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">上面的图表清楚地显示了Pop在Billboard Top 100中的比重越来越大。</li></ul><p id="a17e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.了解词类多年来是如何变化的:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/1d070325a39ed7d6ba44947c339c9abf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*lGfzpV98QppjG9_BGG2snA.png"/></div></figure><ul class=""><li id="5885" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">词类的定义:</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kl"><img src="../Images/69f2373b0f593d8eba888c4266213bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*pgrC7yVztKizjnaNzpQWgw.png"/></div></figure><ul class=""><li id="3d67" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">负面词类的歌曲比例从80年代的不到10%上升到2019年的70%以上。</li><li id="30d6" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">正面词类的歌曲保持相当一致，而中性词类的歌曲有所减少。</li><li id="4b2d" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">2019年，Billboard Top 100的100首歌曲中，有70首歌曲属于负面词类。</li></ul><p id="39f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.按体裁理解词类:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/8ffa86f26895ccd9cd3a7ee0bdf2e552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*YXdZbAS40wmCWo_NY3PvAg.png"/></div></figure><ul class=""><li id="6e0f" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">按流派划分，流行歌曲中负面词汇越来越多，而正面词汇越来越少。20世纪80年代以前，很少有流行歌曲包含负面词汇。到了80年代，更多的歌曲属于负面词类。在世纪之交，负面词类的歌曲比例是正面词类的两倍多。</li><li id="e46c" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">从20世纪80年代开始出现在广告牌上的嘻哈音乐主要属于负面词类。</li></ul><p id="8099" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.十大正面词汇:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/6c0d9faa48e863a7dd89ca70f4b65da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*msS4VyaV_LWqoL1REkt3cg.png"/></div></figure><ul class=""><li id="4c2b" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">该图表分为大约20年的3个部分，然后按2000 - 2019年的最新部分排序。</li><li id="fc6a" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">“美丽”是最近一年中最常见的正面词，而“甜蜜”在所有年份中都非常受欢迎。</li></ul><p id="7edf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.十大负面词汇:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/3c3efaacd5aa90b15645a5e7b098f47b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*Bo-LnzyhjjOJi3j_sC7xFQ.png"/></div></figure><ul class=""><li id="ddff" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">不出所料，“F*ck”及其派生词与其他带有种族和女性色彩的贬义词并列第一。</li><li id="99e3" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">从1980-1999年到2000 - 2019年，负面词汇的总使用量增加了7倍。</li><li id="6e2a" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">值得一提的是，单词“B*ng”在1960-1979年这一年段的上升是由于雪儿在1966年创作的一首歌曲“Bang Bang ”(我的宝贝把我打趴下了)。这首歌是一个女孩和一个男孩玩射击游戏的回忆，她爱上了这个男孩，但这段关系没有成功，她觉得自己又被击中了。由于在这首歌中“bang”一词并没有以冒犯的方式使用，人们可以认为这首歌应该从这张图表中删除。然而，这将意味着筛选整个列表，以删除所有带有属性的负面词类歌曲。实际上，这是没有做到的，我们应该认识到，存在一个非常小的误差幅度。由于前4个否定词总共占1467个词中的1057个(72%)，并且这4个词不太可能以无害的方式使用，因此这种不准确性被认为非常小，并且相比之下,“B*ng”的计数非常低。</li></ul><p id="e29f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6.顶点-暴露和影响</p><ul class=""><li id="c82d" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">为了研究流行歌曲歌词中使用的负面词增加的影响，创造了一个简单的负面词总数与按流派划分的歌曲总数的比率，称为曝光率。一个更复杂的公式可能被推导出来，然而这项研究的目的是评估负面词汇的总体影响，因此使用了一个简单的比率。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/197ebab905040dc45b2fff9d26c3f3c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*pr4Jnv0fBgFBAClAeeTsWg.png"/></div></figure><ul class=""><li id="42be" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">嘻哈的曝光率超过6意味着每首歌平均有6个负面词汇。</li><li id="f8c4" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">Hip Hop每首曲目的负面字数按曝光率计算是pop的6倍。</li><li id="b18c" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">虽然雷鬼也显示出很高的曝光率，但从早期的图表来看，他们的存在非常小，因此重点仍然是嘻哈和流行音乐。</li><li id="bccf" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">为了理解暴露比率的影响，该比率乘以scrobbles的数量。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/3083467aa6958a8fd7201db2d3358368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*QUfF56j_WesN-AIfAH5DjQ.png"/></div></figure><ul class=""><li id="fab0" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">Hip Hop的曝光率如此之高，以至于尽管它的scrobbbles数量很低，但它的曝光影响却超过了scrobbbles数量高得多的Rock。</li></ul><p id="fcfa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.与现实相关的</p><p id="bd4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">寻找理由接受感官愉悦的东西，这是人的天性。有人可能会争辩说:流行音乐，以scrobbles的数量来看是最受欢迎的，平均每首歌只有1个负面词汇，而嘻哈音乐，由于它在Billboard上的出现率低得多，高曝光率没有任何影响。为了验证这一论点是否成立，我们应该利用我们从上述分析中得到的理解，根据Billboard Top 100之外的一般音乐人群来衡量影响。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/e420f379d7e601d6e4d86bb7a959595f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*HVqJyWKOpd0bSfUS__8hAg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Share of Total Music album consumption in USA in 2018</figcaption></figure><ul class=""><li id="6872" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">Hip Hop的消费量最高，尽管它在Billboard Top 100中并不占主导地位。这意味着不管站在广告牌上有多受欢迎，嘻哈音乐都被广泛地聆听。</li><li id="0bdc" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">根据Statista (2018)的音乐类型消费细分数据，Hip Hop的消费百分比最高，为21.7%，领先于Pop (20.1%)。因此，消费百分比最高的前两种类型是负面词汇曝光率最高的两种类型。由于高消耗率，暴露影响在横向上也同样高。</li><li id="ef79" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">我们还应该有兴趣通过类型来了解观众:</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/46ef750af242d4e6308ab5beea84fbaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*stb38lWaKLbJzAyKntft3w.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Favorite music genres among consumers in the United States as of July 2018, by age group</figcaption></figure><ul class=""><li id="07cc" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">这是来自Statista的调查数据，涉及3000多名受访者，其中每个受访者为他/她最喜欢的类型投票，不限于1。</li><li id="acd9" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">流行音乐和嘻哈音乐最受年轻一代的喜爱。因此，一般来说，年轻一代受到负面词汇的影响最大。</li><li id="f0b6" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">观察到的经典摇滚、乡村音乐和摇滚乐的峰值可能与伴随这些流派长大的年龄组有关。</li><li id="6ee0" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">虽然不可能根据Statista的这两组数据来量化它们的确切影响，但考虑到所有因素——高曝光率、高scrobbles数量、高消费、高受欢迎程度和个人偏好——流行音乐和嘻哈音乐对社会的影响范围相当大。</li></ul><p id="c8fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">限制:</strong></p><ul class=""><li id="5a30" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">scrobbles的数量来自Spotify，因为没有来自其他流媒体平台的数据。如果Spotify数据的人口统计数据可用，那将会很有趣。这可能会更清楚为什么嘻哈音乐的收入相对较低，但消费却很高。</li><li id="b7bc" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">这些数据并不是一个普遍的代表，但它足以公平地认为，在英语是一种普遍使用的语言和英语当代音乐随处可见的国家，这种影响是真实的。</li><li id="abc1" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">可能值得探索不同的单词提取方法，如正则表达式，以比较不同方法的有效性。</li></ul><p id="34c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">总结:</strong></p><ul class=""><li id="6f2a" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kj ju jv jw bi translated">歌词的趋势是负面词汇的使用急剧增加，主要是“f*ck”、“b*tch”、“n*gga”和“sh*t”。</li><li id="8c2f" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">歌词中负面词影响力最大的两个流派Hip Hop和Pop作为个人最爱的消费率和票数最高，Pop连续霸占Billboard Top 100。</li><li id="d7d9" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kj ju jv jw bi translated">由于负面词汇通常意味着性暗示和歧视，这种对社会和价值观日益增长的影响值得进行单独的广泛研究。</li></ul><p id="5a99" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">以轻松的方式结束项目— SQL Juke Box: </strong></p><p id="c6db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通常一首歌听几遍后，很自然的会下意识的记住一些歌词。虽然没有人能决定一个艺人如何写一首歌或排除一个完整的流派，但我们也许可以选择我们听什么。因此，我用一个存储过程来结束我的项目演示，以帮助用户根据淫秽程度、可跳舞性和歌曲时代来查找歌曲。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ke kf di kg bf kh"><div class="er es kn"><img src="../Images/a5d89fac88a08f7e200aaa06729f1eba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SNekdjwM0LgkQURJM4VWVA.png"/></div></div></figure><p id="dba4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">边注:</strong></p><p id="504d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这对我来说是一个有趣的项目。在数据分析方面还有很多东西要学，我很享受每一刻。也许有一天我会用Python重新审视这个项目。</p><p id="eb28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我很感激对这个项目的反馈。在magcheong333@gmail.com的<a class="ae ko" href="mailto:magcheong333@gmail.com" rel="noopener ugc nofollow" target="_blank">或者linkedin.com/in/magcheong333的</a>或者<a class="ae ko" href="https://www.linkedin.com/in/magcheong333" rel="noopener ugc nofollow" target="_blank">联系我</a></p><p id="b226" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢你。</p></div></div>    
</body>
</html>