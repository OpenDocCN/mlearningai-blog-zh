<html>
<head>
<title>Using Deep Learning modeling to predict Electricity consumption with an external variable — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习建模预测外部变量的用电量—第2部分</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/using-deep-learning-modeling-to-predict-electricity-consumption-with-an-external-variable-part-2-94cacddc6c81?source=collection_archive---------2-----------------------#2022-06-15">https://medium.com/mlearning-ai/using-deep-learning-modeling-to-predict-electricity-consumption-with-an-external-variable-part-2-94cacddc6c81?source=collection_archive---------2-----------------------#2022-06-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="d3f2" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">与以前的机器学习模型相比，展示了时间序列中使用的深度学习模型的威力</h2></div><p id="f3b9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di">在第二部分的</span>中，我们分析并使用室外温度作为预测电力消耗的附加变量。室外温度是一个有趣的变量，因为我们经常用它作为一个视觉指标，要么使用空调降温，要么使用加热设备来温暖我们的家。这当然会对用电量产生直接影响。</p><h1 id="4deb" class="kb kc hh bd kd ke kf kg kh ki kj kk kl in km io kn iq ko ir kp it kq iu kr ks bi translated">我的空间加热器用了多少电？</h1><p id="9b28" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> M </span> ost电暖器用的是1500瓦，但有些略少或略多。因为1000瓦等于1千瓦，这意味着一个加热器使用1.5千瓦的功率。用电暖器使用的瓦特数乘以使用小时数。对于这个例子，我们假设8个小时。</p><p id="c850" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">1500 x8小时= 12000。除以1000 = 12。接下来，用这个数字乘以公用事业公司收取的电费。对T4来说，这大约是0.15欧元。因此，12 x .15 = 1.8欧元。在温暖的房间里享受一整天的奢华阅读大约需要1.8欧元。为了让加热器在整整一个月的时间里每天都这样运转，它会很快增加(大约55欧元/月)。根据加热设备的数量和使用时间的不同，这一成本会有很大差异。然而，使用像上一篇文章中那样的深度学习模型，可以明显看出我们的个人消费习惯。</p><h1 id="4224" class="kb kc hh bd kd ke kf kg kh ki kj kk kl in km io kn iq ko ir kp it kq iu kr ks bi translated">方法</h1><p id="8882" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> U </span>相同的数据集由3列组成，时间戳、功率(kW)和室外温度(摄氏度),来自欧洲冬季的典型家庭消费。时间戳长度为4604行，从2022年1月1日到2月16日。从1:15到23:45，每隔15分钟测量一次时间戳。这种情况下的目标是预测2022年2月17日的用电量，使用和不使用室外温度(作为一个因素)。大部分工作都是用R/Python (Jupyter笔记本格式)完成的。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es kz"><img src="../Images/caa89ca33ef9e7ecf7168cc05e6227c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*b0zSZkiXNziknCJP8n9bEQ.jpeg"/></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 1: Statistics info about the dataset</figcaption></figure><h2 id="4371" class="ll kc hh bd kd lm ln lo kh lp lq lr kl jf ls lt kn jj lu lv kp jn lw lx kr ly bi translated">拆分数据</h2><p id="2f40" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> M </span>获取两组数据，训练数据集(80%)和测试数据集(20%)，以便运行适当的时间序列预测来适当地评估模型，因为我们正在使用新的elecdataset，这将意味着900行作为训练，227行作为测试。</p><h1 id="632c" class="kb kc hh bd kd ke kf kg kh ki kj kk kl in km io kn iq ko ir kp it kq iu kr ks bi translated">时间序列线性回归模型</h1><p id="a19e" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated">为了证明和验证室外温度对用电量(kW)的影响存在，首先需要建立一个 T <a class="ae ky" href="http://r-statistics.co/Time-Series-Analysis-With-R.html" rel="noopener ugc nofollow" target="_blank">时间序列回归模型</a> (TSLM)。回归分析是<a class="ae ky" href="https://statisticsbyjim.com/basics/descriptive-inferential-statistics/" rel="noopener ugc nofollow" target="_blank">推断统计</a>的一种形式。p值有助于确定在样本中观察到的关系是否也存在于更大的总体中。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es lz"><img src="../Images/8d5a32d59ae88d2d2c9bb9a90f39e353.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*pD2PUxWX8n2wDvqavn4cSw.jpeg"/></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 2: Outdoor temperature effect on electricity with TSLM</figcaption></figure><p id="1686" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这种情况下，我们注意到temp_train(温度)的p值小于0.05。这意味着我们拒绝零假设(H0 ),并声明室外温度对耗电量(千瓦)有影响。</p><h2 id="dddf" class="ll kc hh bd kd lm ln lo kh lp lq lr kl jf ls lt kn jj lu lv kp jn lw lx kr ly bi translated">季节性</h2><p id="d764" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di">为了进一步验证，<a class="ae ky" href="https://machinelearningmastery.com/time-series-seasonality-with-python/" rel="noopener ugc nofollow" target="_blank">季节性</a>被添加到现有的TSLM模型中，并再次重新计算，以查看对该数据集是否有任何影响。</span></p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es ma"><img src="../Images/1f83a0fbc426312047f70b71eb3a5613.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*wGh7uPRg0En4QTSrJR9Gkg.jpeg"/></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 3: Outdoor temperature effect on electricity with TSLM+Seasonality</figcaption></figure><p id="e0ad" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这种情况下，P值大于0.05，因此接受零假设，季节性在统计上不显著。第二季、第三季和第四季对TSLM模式没有影响。</p><h2 id="9898" class="ll kc hh bd kd lm ln lo kh lp lq lr kl jf ls lt kn jj lu lv kp jn lw lx kr ly bi translated">趋势</h2><p id="7116" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> F </span>此外，还可以对现有的TSLM进行趋势分析，看看对这个数据集有没有影响。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mb"><img src="../Images/9d25ad8f995745b6304ca02812c7e03f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*nf8L2jo39Jsf4EThoLzSnA.jpeg"/></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 4: Outdoor temperature effect on electricity with TSLM+Trend</figcaption></figure><p id="d355" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">p值小于0.05，这意味着我们拒绝零假设(H0)，并声明存在趋势模式对电力消费(千瓦)的影响，这意味着在这种情况下具有统计学意义。因此，TSLM模型仅用于趋势分析。</p><h2 id="3fe1" class="ll kc hh bd kd lm ln lo kh lp lq lr kl jf ls lt kn jj lu lv kp jn lw lx kr ly bi translated">残差</h2><p id="481a" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di">按</span>顺序进行，TSLM模型假设残差是独立的。为了证明这一点，我们检查了残差以及<a class="ae ky" href="https://www.statisticshowto.com/ljung-box-test/" rel="noopener ugc nofollow" target="_blank"> Ljung-Box </a> (LB)测试。LB以统计学家<a class="ae ky" href="https://en.wikipedia.org/wiki/Greta_M._Ljung" rel="noopener ugc nofollow" target="_blank"> Greta M. Ljung </a>和<a class="ae ky" href="https://en.wikipedia.org/wiki/George_E._P._Box" rel="noopener ugc nofollow" target="_blank"> George E.P. Box </a>的名字命名，是一种检验时间序列中是否存在自相关(值不相关)的统计检验。零假设表明残差是独立分布的。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mc"><img src="../Images/61af6917b888756aa69a82036ea3a894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6szT92qsY6OydOAfHjf5yg.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 5:Residuals + LB test from Linear Regression model</figcaption></figure><p id="27ca" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这里残差是相关的，这意味着这个回归模型是不恰当的。此外，LB检验说明p值小于0.05，这意味着残差是独立分布的。</p><h1 id="d12a" class="kb kc hh bd kd ke kf kg kh ki kj kk kl in km io kn iq ko ir kp it kq iu kr ks bi translated">动态回归模型</h1><p id="d761" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di">I</span>n建议再形成<a class="ae ky" href="https://otexts.com/fpp2/dynamic.html" rel="noopener ugc nofollow" target="_blank">动态回归</a> (DR)模型，用<a class="ae ky" href="https://otexts.com/fpp2/arima.html" rel="noopener ugc nofollow" target="_blank"> ARIMA </a> p，d，q模型对残差建模。阶数的选择<a class="ae ky" href="https://otexts.com/fpp3/non-seasonal-arima.html" rel="noopener ugc nofollow" target="_blank"> p，d，q</a>(p =自回归部分的阶数；d =所涉及的一阶差分的程度；q =移动平均部分的阶数)。这可以通过检查残差或使用许多DR统计软件包中的auto.arima函数自动完成。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mh"><img src="../Images/9d27dff56da4aec8f9567e21b0ddc5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tp051MI4HtKq9VOMfsc7Gw.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 5:Residuals + LB test from Dynamic Regression model</figcaption></figure><p id="4f09" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">用(2，1，2)的ARIMA模型:残差的自相关已经被建模。与之前的线性回归相反，动态回归的LB检验解释了p值大于0.05意味着残差不是独立分布的(它们表现出序列相关性)。</p><h1 id="a8a1" class="kb kc hh bd kd ke kf kg kh ki kj kk kl in km io kn iq ko ir kp it kq iu kr ks bi translated">室外温度的动态回归和神经网络模型</h1><p id="4cc0" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di">我们</span>比较了动态回归模型与神经网络(之前已探讨过)相比的成功程度。由于神经网络模型表现出色，该模型将用于预测未来的预测，也包括室外温度。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mi"><img src="../Images/94050059bf240445a614d121016f71cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*u7h9LhtLdQljkJcYA6Xmeg.jpeg"/></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 6:Train and Test data set with the Dynamic regression model with temperature as well as Neural network with temperature for comparisons</figcaption></figure><p id="2984" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如图6所示，室外温度的动态回归模型表现良好，但是室外温度的神经网络在预测方面表现更好。这只是表明，与以前的机器学习模型相比，神经网络在解决复杂问题方面是多么复杂。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mj"><img src="../Images/5096f9fdb0f2fc72630caf2eabe1360c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*bXJmo12VhU0Tf3lhnCw-5A.jpeg"/></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 7: Neural network with outdoor temperature predicting the Test data set</figcaption></figure><p id="81d3" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在图7中，一个有趣的点是，与之前没有室外温度的神经网络相比，更新的神经网络在添加室外温度作为外部变量的情况下做出了更好的预测。</p><h2 id="bccf" class="ll kc hh bd kd lm ln lo kh lp lq lr kl jf ls lt kn jj lu lv kp jn lw lx kr ly bi translated">未来预测</h2><p id="0d14" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi js translated"><span class="l jt ju jv bm jw jx jy jz ka di"> F </span>最后，我们可以看到神经网络对室外温度的预测有多好，如图8所示。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mk"><img src="../Images/556e5a71c037ac0a2dc175c1bb57fb99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CA0O_Dzq_34hgTa04QKm-A.jpeg"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx">Figure 8: Neural network with outdoor temperature prediction of power consumption</figcaption></figure><h2 id="f96a" class="ll kc hh bd kd lm ln lo kh lp lq lr kl jf ls lt kn jj lu lv kp jn lw lx kr ly bi translated">结论:</h2><p id="96da" class="pw-post-body-paragraph iw ix hh iy b iz kt ii jb jc ku il je jf kv jh ji jj kw jl jm jn kx jp jq jr ha bi translated">在其他模型中，神经网络模型是预测和预报千瓦消耗量随温度变化的最好和最强大的模型。像这样的统计分析可以让数据科学家了解不同因素下时间序列的规律。</p><div class="ml mm ez fb mn mo"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mp ab dw"><div class="mq ab mr cl cj ms"><h2 class="bd hi fi z dy mt ea eb mu ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mv l"><h3 class="bd b fi z dy mt ea eb mu ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mw l"><p class="bd b fp z dy mt ea eb mu ed ef dx translated">medium.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc lf mo"/></div></div></a></div></div></div>    
</body>
</html>