<html>
<head>
<title>How to use emoji in ggplot2 scatter plot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在ggplot2散点图中使用表情符号</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/blog-mdyuanxuan-yang-a328348c4946?source=collection_archive---------2-----------------------#2021-03-14">https://medium.com/mlearning-ai/blog-mdyuanxuan-yang-a328348c4946?source=collection_archive---------2-----------------------#2021-03-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="11bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是一个在ggplot2散点图中使用表情符号(或其他图像)的教程。我们的任务是创建一个地图(散点图)来显示“美国各州最受欢迎的蔬菜”，其中每个州都由蔬菜表情符号表示。以下是最终数字的预览。我们开始吧！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/79407c3312d3f8f0a4ed417ffbce641b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ecEOjXIQLkFq8JZmBHJ8g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Use emoji for scatter plot in ggplot2</figcaption></figure><h1 id="89b0" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">1.获取数据</h1><p id="cf72" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated"><strong class="ig hi">最受欢迎的蔬菜数据</strong>来自<a class="ae kv" href="https://www.thedailymeal.com/eat/popular-vegetable-us-states" rel="noopener ugc nofollow" target="_blank">https://www . the daily meal . com/eat/popular-vegetable-us-States</a>，我已经整理并存储在我的github <a class="ae kv" href="https://github.com/yyuanxuan/squared-map-veg-emoji" rel="noopener ugc nofollow" target="_blank">资源库</a>的“data/state-fav-veg.csv”中。</p><p id="c475" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们看看我们的数据记录。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><pre class="jd je jf jg fd ky kz la lb aw lc bi"><span id="dfda" class="ld jt hh kz b fi le lf l lg lh">## name vegetable <br/>## 1 Alabama Broccoli <br/>## 2 Alaska Tomato <br/>## 3 Arizona Broccoli <br/>## 4 Arkansas Carrot <br/>## 5 California Broccoli <br/>## 6 Colorado Broccoli</span></pre><p id="4d68" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">“state_veg”中的每个记录都包含美国一个州的名称和最受欢迎的蔬菜。</p><p id="91e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来要做的是获取每个州的坐标/位置。于是我在这个<a class="ae kv" href="https://twitter.com/katiepark/status/598139293509492736" rel="noopener ugc nofollow" target="_blank">的twitter帖子</a>中按照凯蒂·帕克的作品设计，坐标存储在“数据/状态-位置-网格. csv”中。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><pre class="jd je jf jg fd ky kz la lb aw lc bi"><span id="76e2" class="ld jt hh kz b fi le lf l lg lh">## code name x y <br/>## 1 AL Alabama 7 2 <br/>## 2 AK Alaska 1 8 <br/>## 3 AZ Arizona 2 3 <br/>## 4 AR Arkansas 5 3 <br/>## 5 CA California 1 4 <br/>## 6 CO Colorado 3 4</span></pre><p id="542a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每条记录包含美国一个州的代码(两个字母的缩写)、名称和x，y坐标。我们可以快速浏览一下它们的位置:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es li"><img src="../Images/6dda5fd7a14c1e8b01930221353bff21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E0mkezvqgZXz3O7bPbVyIQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">US state map — grid location</figcaption></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="73a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后我们连接<strong class="ig hi"> state_veg </strong>和<strong class="ig hi"> state_location </strong>，并使用ggpplot2制作一个基本的散点图。圆点的颜色代表不同的蔬菜类型。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es li"><img src="../Images/169600c93fd8ff5282c6fb1a3604c78c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M5JQmRlZWN2nB2ZthhZ6-A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Most Popular Vegetable by State in US (normal scatter plot with ggplot2)</figcaption></figure><h1 id="5ba5" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">2.表情符号时间</h1><p id="d1e1" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">上面的散点图到目前为止看起来还不错，但是为什么不用一些表情符号蔬菜代替那些无聊的点呢？我们开始吧！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lj"><img src="../Images/d87565d88ddfc482766f9b137fa29965.png" data-original-src="https://miro.medium.com/v2/resize:fit:240/format:webp/1*MWJr8ylaUCrhfSII4tu1Uw.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Broccoli emoji</figcaption></figure><p id="5765" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我尝试过在ggplot中使用表情符号的不同方式，虽然也有类似<a class="ae kv" href="https://cran.r-project.org/web/packages/emojifont/vignettes/emojifont.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> emojifont </strong> </a>和<a class="ae kv" href="https://github.com/dill/emoGG" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> emoGG </strong> </a>的做法，但他们倾向于使用平面版的表情符号。作为一个苹果粉丝(不是真的)，我更喜欢经典的苹果版本。<a class="ae kv" href="https://www.rdocumentation.org/packages/ggimage/versions/0.2.8" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">gg image</strong></a><strong class="ig hi">::geom _ image</strong>是将img添加到ggplot的另一个潜在解决方案。然而，我对img纵横比的复杂设置不感兴趣。</p><p id="b814" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以今天我将采用另一种非常简单的方法——使用<strong class="ig hi"> ggtext </strong>包中提供的<strong class="ig hi"> geom_richtext </strong>。这种方法的灵感来自于<a class="ae kv" href="https://www.hvitfeldt.me/" rel="noopener ugc nofollow" target="_blank">埃米尔·赫维特费尔德的</a>精彩的<a class="ae kv" href="https://www.hvitfeldt.me/blog/real-emojis-in-ggplot2/" rel="noopener ugc nofollow" target="_blank">博客文章</a>。</p><h2 id="a440" class="ld jt hh bd ju lk ll lm jy ln lo lp kc ip lq lr kg it ls lt kk ix lu lv ko lw bi translated">2.1获取表情符号</h2><p id="be9e" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">你可以找到并下载https://emojipedia.org/的所有表情符号。下载完成后，我们可以创建一个数据帧来存储链接/地址(在您的本地机器上),如下所示</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><pre class="jd je jf jg fd ky kz la lb aw lc bi"><span id="9737" class="ld jt hh kz b fi le lf l lg lh">## vegetable emoji_link <br/>## 1 Broccoli img/broccoli_1f966.png <br/>## 2 Tomato img/tomato_1f345.png <br/>## 3 Carrot img/carrot_1f955.png <br/>## 4 Cucumber img/cucumber_1f952.png <br/>## 5 Corn img/ear-of-corn_1f33d.png</span></pre><h2 id="bf02" class="ld jt hh bd ju lk ll lm jy ln lo lp kc ip lq lr kg it ls lt kk ix lu lv ko lw bi translated">2.2加入数据框</h2><p id="d945" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">然后我们需要通过公共变量“蔬菜”来连接<strong class="ig hi"> state_veg </strong>和<strong class="ig hi"> emoji_pic </strong>数据，因此，每条记录都将包含链接到emoji的字符串。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="6453" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦加入，我们的数据终于准备好了，让我们看看</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><pre class="jd je jf jg fd ky kz la lb aw lc bi"><span id="32f7" class="ld jt hh kz b fi le lf l lg lh">## name vegetable code x y emoji_link <br/>## 1 Alabama Broccoli AL 7 2 img/broccoli_1f966.png <br/>## 2 Alaska Tomato AK 1 8 img/tomato_1f345.png <br/>## 3 Arizona Broccoli AZ 2 3 img/broccoli_1f966.png <br/>## 4 Arkansas Carrot AR 5 3 img/carrot_1f955.png <br/>## 5 California Broccoli CA 1 4 img/broccoli_1f966.png <br/>## 6 Colorado Broccoli CO 3 4 img/broccoli_1f966.png</span></pre><h2 id="dcb8" class="ld jt hh bd ju lk ll lm jy ln lo lp kc ip lq lr kg it ls lt kk ix lu lv ko lw bi translated">2.3定义一个函数，为你的表情图像提供更多信息</h2><p id="ea92" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我们将使用<strong class="ig hi"> geom_richtext </strong>在散点图中绘制数据点，并用表情符号替换点形状。<strong class="ig hi"> geom_richtext </strong>绘制类似于<strong class="ig hi"> ggplot::geom_label </strong>的标签，但使用基本markdown/html进行格式化。因此，可以在richtext标签中嵌入图像。在这里，我们将定义一个函数，以便添加表情符号并将其格式化为markdown/html中的资源。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><h2 id="4815" class="ld jt hh bd ju lk ll lm jy ln lo lp kc ip lq lr kg it ls lt kk ix lu lv ko lw bi translated">2.4关键时刻</h2><p id="ade6" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">现在让我们尝试使用表情符号将<strong class="ig hi">几何点</strong>替换为<strong class="ig hi">几何丰富文本</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es li"><img src="../Images/b38781ab0efb126a7c84a5f1047a65b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XsYD_Cvwkk__R7b8KrYsRg.png"/></div></div></figure><p id="1d4c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">万岁，成功了！因此，我们可以做一些进一步的调整，添加复古纸外观背景色，改变字体样式，添加标题和数据源信息。希望你喜欢这个改进版本！</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kw kx l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es li"><img src="../Images/0eb38f1910e1ca6a043dbac703e20611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clClpftGV9Y3uIF5Lb09SA.png"/></div></div></figure><h1 id="189a" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">3.最后一个音符</h1><p id="6525" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">制作这张地图并不意味着我同意地图上的一切。首先，我们可以整天争论“西红柿是水果还是蔬菜？”</p><p id="8de2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是谷歌的回答</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lx"><img src="../Images/9d1cd1efa609a2ac70c0880405c6e1b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CfgGy__zLCoWnq1uP3Gkdg.png"/></div></div></figure><p id="d318" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所提出的方法(使用<strong class="ig hi"> geom_richtext </strong>)的一个好处是，我们可以使用任何我们想要的图像来绘制点，而<a class="ae kv" href="https://cran.r-project.org/web/packages/emojifont/vignettes/emojifont.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> emojifont </strong> </a>和<a class="ae kv" href="https://github.com/dill/emoGG" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> emoGG </strong> </a>包只能为我们提供表情符号的选择。所以我把玉米换成了无版权的爆米花图片。:)</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es li"><img src="../Images/b74e8a18fe4a90418319574f64cac185.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rwsOOgJAcNTRDo2ncF5BlQ.png"/></div></div></figure></div><div class="ab cl ly lz go ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ha hb hc hd he"><p id="faac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mf">最初发表于https://github.com/yyuanxuan/squared-map-veg-emoji</em>T2</p></div></div>    
</body>
</html>