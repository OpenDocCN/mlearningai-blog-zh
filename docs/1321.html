<html>
<head>
<title>Building a Demand Forecasting Model with Google Cloud Vertex AI and BigQuery ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Google Cloud Vertex AI和BigQuery ML构建需求预测模型</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/building-a-demand-forecasting-model-with-google-cloud-vertex-ai-and-bigquery-ml-8dd2b7ee5014?source=collection_archive---------0-----------------------#2021-11-22">https://medium.com/mlearning-ai/building-a-demand-forecasting-model-with-google-cloud-vertex-ai-and-bigquery-ml-8dd2b7ee5014?source=collection_archive---------0-----------------------#2021-11-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9778" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">需求预测是使用定量和定性数据预测未来收入以及购物者将购买哪些产品的过程。它帮助你对你的产品供应、库存、员工和营销做出明智的决定。在这篇博文中，我将向您展示如何使用BigQuery ML构建一个时间序列模型来预测多种产品的需求。使用爱荷华州的酒类销售数据，我将使用18个月的历史交易数据来预测未来30天。</p><h2 id="07ec" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">样本数据集</h2><p id="fdad" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">该解决方案使用来自BigQuery公共数据集的<a class="ae kc" href="https://console.cloud.google.com/marketplace/product/iowa-department-of-commerce/iowa-liquor-sales" rel="noopener ugc nofollow" target="_blank">爱荷华州酒类销售数据集</a>的数据。该数据集包括自2012年以来美国爱荷华州的批发白酒购买量。欲了解更多信息，请参阅爱荷华州的官方文件。</p><p id="cc95" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本动手实验结束时，您将学会如何:</p><ul class=""><li id="602b" class="kd ke hh ig b ih ii il im ip kf it kg ix kh jb ki kj kk kl bi translated">将时间序列数据预处理成创建模型所需的正确格式。</li><li id="82b4" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">在BigQuery ML中训练ARIMA时间序列模型。</li><li id="b69b" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">评估模型。</li><li id="ca38" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">使用该模型预测未来需求。</li><li id="4818" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">使用Data Studio创建一个仪表板来可视化预测需求。</li></ul><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es kr"><img src="../Images/04cd0536d168adc0076e2b69d23bea98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uARDUryA5uu_vG7u.jpg"/></div></figure><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="ab fe cl kz"><img src="../Images/db65b9db0548b481f096b344fdc2db9b.png" data-original-src="https://miro.medium.com/v2/format:webp/1*KB1qKqn2m2eyNj76ZW9t5A.png"/></div></figure><p id="034b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当一切都完成后，你将能够创建一个包含多种产品需求预测的仪表板。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="ab fe cl kz"><img src="../Images/4b0eced25676a72b7136a347652a8f94.png" data-original-src="https://miro.medium.com/v2/format:webp/1*e-SlVJJS4Ci92aFmuc4ceg.png"/></div></figure><h2 id="369e" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated"><strong class="ak">设置</strong></h2><p id="646f" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">安装所需的包，配置环境变量，并创建一个BigQuery数据集。</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="f99c" class="jc jd hh lb b fi lf lg l lh li">### PIP Install Packages and dependencies!pip install google-cloud-bigquery google-cloud-bigquery-storage — upgrade</span></pre><h2 id="da08" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated"><strong class="ak">配置GCP环境设置</strong></h2><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="88c8" class="jc jd hh lb b fi lf lg l lh li">​PROJECT_ID <strong class="lb hi">=</strong> 'arun-krm' <em class="lj"># Change to your project.<br/></em>REGION <strong class="lb hi">=</strong> 'US'</span></pre><h2 id="8aa4" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">导入库并定义常数</h2><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="475f" class="jc jd hh lb b fi lf lg l lh li">from google.cloud import bigquery<br/><strong class="lb hi">import</strong> pandas <strong class="lb hi">as</strong> pd<br/><strong class="lb hi">from</strong> datetime <strong class="lb hi">import</strong> datetime, timedelta<br/>pd.set_option('display.float_format', <strong class="lb hi">lambda</strong> x: '%.3f' <strong class="lb hi">%</strong> x)</span></pre><h2 id="5745" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">导入用于数据操作和打印的库</h2><h2 id="d581" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">创建大查询数据集</h2><p id="46c7" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">在您的项目中创建一个名为<code class="du lk ll lm lb b">bqmlforecast</code>的数据集:</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="f83a" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">!</strong>bq mk <strong class="lb hi">--</strong>location<strong class="lb hi">=</strong>$REGION <strong class="lb hi">--</strong>dataset $PROJECT_ID:bqmlforecast</span><span id="0717" class="jc jd hh lb b fi ln lg l lh li">Dataset 'arun-krm:bqmlforecast' successfully created.</span></pre><h2 id="2bc1" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">准备培训数据</h2><p id="c477" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">您可以在包含交易资料的资料集上定型时间序列模型。每一行代表一个产品的交易，由<code class="du lk ll lm lb b">item_description</code>值标识，并包含销售的瓶子数量和销售额(美元)等详细信息。在下面的步骤中，您将使用售出的瓶数值来预测产品需求。</p><p id="0d1f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="lj">注意</em> : Jupyter运行以%%bigquery开头的单元格作为SQL查询</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="e220" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="d2f1" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="050b" class="jc jd hh lb b fi ln lg l lh li">invoice_and_item_number,</span><span id="8e0a" class="jc jd hh lb b fi ln lg l lh li">date,</span><span id="439b" class="jc jd hh lb b fi ln lg l lh li">store_number,</span><span id="d1d9" class="jc jd hh lb b fi ln lg l lh li">item_description,</span><span id="5ac6" class="jc jd hh lb b fi ln lg l lh li">bottles_sold,</span><span id="f448" class="jc jd hh lb b fi ln lg l lh li">sale_dollars</span><span id="0795" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="fb90" class="jc jd hh lb b fi ln lg l lh li">`bigquery<strong class="lb hi">-</strong>public<strong class="lb hi">-</strong>data.iowa_liquor_sales.sales`</span><span id="dcdd" class="jc jd hh lb b fi ln lg l lh li">LIMIT</span><span id="0dc6" class="jc jd hh lb b fi ln lg l lh li">10</span><span id="7164" class="jc jd hh lb b fi ln lg l lh li">Query complete after 0.00s: 100%|██████████| 2/2 [00:00&lt;00:00, 625.74query/s]                         <br/>Downloading: 100%|██████████| 10/10 [00:01&lt;00:00,  7.30rows/s]</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es lo"><img src="../Images/c2655d7ab6a4b45d8901a0fac3aa6ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LRDuQKD5jwkvnNy8egVLMQ.png"/></div></div></figure><h2 id="7056" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">设置培训数据的开始和结束日期</h2><p id="4c11" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">您可以调整<code class="du lk ll lm lb b">TRAININGDATA_STARTDATE</code>和<code class="du lk ll lm lb b">TRAININGDATA_ENDDATE</code>参数来指定您的训练数据的开始/结束日期:</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="4889" class="jc jd hh lb b fi lf lg l lh li">ARIMA_PARAMS <strong class="lb hi">=</strong> {</span><span id="5416" class="jc jd hh lb b fi ln lg l lh li">'TRAININGDATA_STARTDATE': '2016-01-01',</span><span id="b848" class="jc jd hh lb b fi ln lg l lh li">'TRAININGDATA_ENDDATE': '2017-06-01',</span><span id="789f" class="jc jd hh lb b fi ln lg l lh li">}</span><span id="28b6" class="jc jd hh lb b fi ln lg l lh li">ARIMA_PARAMS</span><span id="9d1e" class="jc jd hh lb b fi ln lg l lh li">{'TRAININGDATA_STARTDATE': '2016-01-01', 'TRAININGDATA_ENDDATE': '2017-06-01'}</span></pre><h1 id="d51d" class="lt jd hh bd je lu lv lw ji lx ly lz jm ma mb mc jp md me mf js mg mh mi jv mj bi translated">将训练数据写入表中</h1><p id="02e4" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">如果您查看培训数据，可以观察到某些天没有给定产品的交易。为了避免进行额外的预处理，BigQuery ML会自动处理以下情况:</p><ul class=""><li id="d085" class="kd ke hh ig b ih ii il im ip kf it kg ix kh jb ki kj kk kl bi translated">缺少值。</li><li id="aa30" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">重复的时间戳</li><li id="f408" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">尖峰和倾斜异常</li></ul><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="4a94" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery <strong class="lb hi">--</strong>params $ARIMA_PARAMS  <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="6725" class="jc jd hh lb b fi ln lg l lh li">CREATE OR REPLACE TABLE bqmlforecast.training_data AS (</span><span id="0b86" class="jc jd hh lb b fi ln lg l lh li">WITH topsellingitems AS(</span><span id="137f" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="0fcc" class="jc jd hh lb b fi ln lg l lh li">item_description,</span><span id="43ba" class="jc jd hh lb b fi ln lg l lh li">count(item_description) cnt_transactions</span><span id="2fdc" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="a7af" class="jc jd hh lb b fi ln lg l lh li">`bigquery<strong class="lb hi">-</strong>public<strong class="lb hi">-</strong>data.iowa_liquor_sales.sales`</span><span id="4db2" class="jc jd hh lb b fi ln lg l lh li">GROUP BY</span><span id="df5d" class="jc jd hh lb b fi ln lg l lh li">item_description</span><span id="b3a3" class="jc jd hh lb b fi ln lg l lh li">ORDER BY cnt_transactions DESC</span><span id="28e6" class="jc jd hh lb b fi ln lg l lh li">LIMIT 5 <em class="lj">#Top N</em></span><span id="c820" class="jc jd hh lb b fi ln lg l lh li">)</span><span id="79fb" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="12a6" class="jc jd hh lb b fi ln lg l lh li">date,</span><span id="da7f" class="jc jd hh lb b fi ln lg l lh li">item_description AS item_name,</span><span id="46d9" class="jc jd hh lb b fi ln lg l lh li">SUM(bottles_sold) AS total_amount_sold</span><span id="a82a" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="35c2" class="jc jd hh lb b fi ln lg l lh li">`bigquery<strong class="lb hi">-</strong>public<strong class="lb hi">-</strong>data.iowa_liquor_sales.sales`</span><span id="b35d" class="jc jd hh lb b fi ln lg l lh li">GROUP BY</span><span id="f0a2" class="jc jd hh lb b fi ln lg l lh li">date, item_name</span><span id="d967" class="jc jd hh lb b fi ln lg l lh li">HAVING</span><span id="5918" class="jc jd hh lb b fi ln lg l lh li">date BETWEEN <strong class="lb hi">@</strong>TRAININGDATA_STARTDATE AND <strong class="lb hi">@</strong>TRAININGDATA_ENDDATE</span><span id="d32c" class="jc jd hh lb b fi ln lg l lh li">AND item_description IN (SELECT item_description FROM topsellingitems)</span><span id="4d2f" class="jc jd hh lb b fi ln lg l lh li">);</span><span id="8f33" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="9a35" class="jc jd hh lb b fi ln lg l lh li">date,</span><span id="c2b3" class="jc jd hh lb b fi ln lg l lh li">item_name,</span><span id="2357" class="jc jd hh lb b fi ln lg l lh li">total_amount_sold</span><span id="7b6b" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="e1a5" class="jc jd hh lb b fi ln lg l lh li">bqmlforecast.training_data</span><span id="a753" class="jc jd hh lb b fi ln lg l lh li">ORDER BY item_name, date</span><span id="1ddb" class="jc jd hh lb b fi ln lg l lh li">LIMIT 15</span><span id="b5df" class="jc jd hh lb b fi ln lg l lh li">Query complete after 0.00s: 100%|██████████| 1/1 [00:00&lt;00:00, 625.55query/s] <br/>Downloading: 100%|██████████| 15/15 [00:01&lt;00:00, 13.07rows/s]</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es mk"><img src="../Images/51a90d48775dd10c69a1f9a5075db95e.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*pbMCZQEDtf1JAcznBMZukA.png"/></div></figure><h2 id="16dd" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">绘制目标酒类产品的销售历史</h2><p id="ea72" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">将训练数据保存到<code class="du lk ll lm lb b">dfhistorical</code>熊猫数据框:</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="fe9d" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery dfhistorical <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="cace" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="56c6" class="jc jd hh lb b fi ln lg l lh li"><strong class="lb hi">*</strong></span><span id="bcbf" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="f134" class="jc jd hh lb b fi ln lg l lh li">bqmlforecast.training_data</span><span id="7237" class="jc jd hh lb b fi ln lg l lh li">Query complete after 0.01s: 100%|██████████| 1/1 [00:00&lt;00:00, 307.03query/s]                          <br/>Downloading: 100%|██████████| 1692/1692 [00:01&lt;00:00, 1193.01rows/s]</span></pre><p id="ed06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用培训数据，绘制目标酒类产品的销售历史:</p><p id="a16e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">[11]:</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="9896" class="jc jd hh lb b fi lf lg l lh li">itemslist <strong class="lb hi">=</strong> list(dfhistorical.item_name.unique())</span><span id="23a0" class="jc jd hh lb b fi ln lg l lh li"><strong class="lb hi">for</strong> item <strong class="lb hi">in</strong> itemslist:</span><span id="6513" class="jc jd hh lb b fi ln lg l lh li">datah <strong class="lb hi">=</strong> dfhistorical[dfhistorical.item_name<strong class="lb hi">==</strong>item]</span><span id="73f3" class="jc jd hh lb b fi ln lg l lh li">plot_historical_and_forecast(input_timeseries <strong class="lb hi">=</strong> datah,</span><span id="2e37" class="jc jd hh lb b fi ln lg l lh li">timestamp_col_name <strong class="lb hi">=</strong> "date",</span><span id="4eb6" class="jc jd hh lb b fi ln lg l lh li">data_col_name <strong class="lb hi">=</strong> "total_amount_sold",</span><span id="8227" class="jc jd hh lb b fi ln lg l lh li">forecast_output <strong class="lb hi">=</strong> <strong class="lb hi">None</strong>,</span><span id="9419" class="jc jd hh lb b fi ln lg l lh li">actual <strong class="lb hi">=</strong> <strong class="lb hi">None</strong>,</span><span id="49b5" class="jc jd hh lb b fi ln lg l lh li">title <strong class="lb hi">=</strong> item)</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es ml"><img src="../Images/b82ba714c348b061852e0e63840b7e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vATR-hZVsMCpuEleHifJhA.png"/></div></div></figure><h2 id="48f8" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">训练模型</h2><p id="512b" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">因为您是在单个模型创建语句中针对多个产品训练模型，所以您必须为<a class="ae kc" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create-time-series#time_series_id_col" rel="noopener ugc nofollow" target="_blank"> TIME_SERIES_ID_COL </a>参数指定<code class="du lk ll lm lb b">item_name</code>列。如果您只预测一个项目，那么您就不需要指定<code class="du lk ll lm lb b">TIME_SERIES_ID_COL</code>。有关更多信息，请参见<a class="ae kc" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create-time-series#create_model_syntax" rel="noopener ugc nofollow" target="_blank"> BigQuery ML时间序列模型创建文档</a>。</p><p id="82e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在BigQuery ML中进行时间序列建模时，还可以考虑假日效应。默认情况下，禁用假日效果建模。但是由于这个数据来自美国，并且该数据包含了一年的每日数据，所以您还可以指定一个可选的<code class="du lk ll lm lb b">HOLIDAY_REGION</code>。启用假日效果后，假日期间出现的峰值和谷值将不再被视为异常。假日地区的完整列表可在<a class="ae kc" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create-time-series#holiday_region" rel="noopener ugc nofollow" target="_blank">假日地区文档</a>中找到。</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="0a50" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="454d" class="jc jd hh lb b fi ln lg l lh li">CREATE OR REPLACE MODEL bqmlforecast.arima_model</span><span id="15b2" class="jc jd hh lb b fi ln lg l lh li">OPTIONS(</span><span id="f47a" class="jc jd hh lb b fi ln lg l lh li">MODEL_TYPE<strong class="lb hi">=</strong>'ARIMA',</span><span id="2acd" class="jc jd hh lb b fi ln lg l lh li">TIME_SERIES_TIMESTAMP_COL<strong class="lb hi">=</strong>'date',</span><span id="9003" class="jc jd hh lb b fi ln lg l lh li">TIME_SERIES_DATA_COL<strong class="lb hi">=</strong>'total_amount_sold',</span><span id="eb84" class="jc jd hh lb b fi ln lg l lh li">TIME_SERIES_ID_COL<strong class="lb hi">=</strong>'item_name',</span><span id="80fc" class="jc jd hh lb b fi ln lg l lh li">HOLIDAY_REGION<strong class="lb hi">=</strong>'US'</span><span id="de54" class="jc jd hh lb b fi ln lg l lh li">) AS</span><span id="fc0e" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="54b9" class="jc jd hh lb b fi ln lg l lh li">date,</span><span id="7b4c" class="jc jd hh lb b fi ln lg l lh li">item_name,</span><span id="e1cc" class="jc jd hh lb b fi ln lg l lh li">total_amount_sold</span><span id="aea6" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="32ec" class="jc jd hh lb b fi ln lg l lh li">bqmlforecast.training_data</span><span id="0ee0" class="jc jd hh lb b fi ln lg l lh li">Query complete after 0.00s: 100%|██████████| 3/3 [00:00&lt;00:00, 1222.24query/s]</span></pre><h2 id="a914" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">评估模型</h2><p id="b009" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">使用<a class="ae kc" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-evaluate" rel="noopener ugc nofollow" target="_blank">毫升。评估</a>功能，查看所有创建模型的评估指标。</p><p id="ba30" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du lk ll lm lb b">non_seasonal_</code> { <code class="du lk ll lm lb b">p</code>、<code class="du lk ll lm lb b">d</code>、<code class="du lk ll lm lb b">q</code> }和<code class="du lk ll lm lb b">has_drift</code>列定义时间序列模型。<code class="du lk ll lm lb b">log_likelihood</code>、<code class="du lk ll lm lb b">AIC</code>和<code class="du lk ll lm lb b">variance</code>栏与模型拟合过程相关。拟合过程通过使用<a class="ae kc" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-create-time-series#auto_arima" rel="noopener ugc nofollow" target="_blank">自动确定最佳模型。ARIMA算法</a>，每个时间序列一个。</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="53ef" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="607e" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="6732" class="jc jd hh lb b fi ln lg l lh li"><strong class="lb hi">*</strong></span><span id="5974" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="2cbc" class="jc jd hh lb b fi ln lg l lh li">ML.EVALUATE(MODEL bqmlforecast.arima_model)</span><span id="a583" class="jc jd hh lb b fi ln lg l lh li">Query complete after 0.00s: 100%|██████████| 3/3 [00:00&lt;00:00, 1132.98query/s]                        <br/>Downloading: 100%|██████████| 5/5 [00:01&lt;00:00,  3.60rows/s]</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mm"><img src="../Images/0e789749e4478832adc4a836024907aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8-4u_NpODxeGx2PgZZ-KFg.png"/></div></div></figure><p id="97bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以看到训练了五个模型，每个模型对应于<code class="du lk ll lm lb b">item_name</code>列中的一种产品。每个模型都有自己的<code class="du lk ll lm lb b">p,d,q</code>超参数，这五个模型检测到的季节性是<code class="du lk ll lm lb b">WEEKLY</code>。</p><h2 id="98f1" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">使用模型进行预测</h2><p id="2d4d" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">使用<a class="ae kc" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-forecast" rel="noopener ugc nofollow" target="_blank"> ML进行预测。预测</a>，预测下一个<em class="lj"> n </em>值，如<code class="du lk ll lm lb b">horizon</code>参数中所指定。您还可以选择更改<code class="du lk ll lm lb b">confidence_level</code>参数，以更改落在预测区间内的未来值的百分比。将预测数据保存到<code class="du lk ll lm lb b">dfforecast</code>数据帧，以便在后续步骤中绘制。</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="87e9" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery dfforecast <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="2c73" class="jc jd hh lb b fi ln lg l lh li">DECLARE HORIZON STRING DEFAULT "30"; <em class="lj">#number of values to forecast</em></span><span id="59e9" class="jc jd hh lb b fi ln lg l lh li">DECLARE CONFIDENCE_LEVEL STRING DEFAULT "0.90";</span><span id="2e1e" class="jc jd hh lb b fi ln lg l lh li">EXECUTE IMMEDIATE format("""</span><span id="d5b0" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="4c16" class="jc jd hh lb b fi ln lg l lh li">*</span><span id="eb53" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="86cd" class="jc jd hh lb b fi ln lg l lh li">ML.FORECAST(MODEL bqmlforecast.arima_model,</span><span id="c97d" class="jc jd hh lb b fi ln lg l lh li">STRUCT(%s AS horizon,</span><span id="0bce" class="jc jd hh lb b fi ln lg l lh li">%s AS confidence_level)</span><span id="e170" class="jc jd hh lb b fi ln lg l lh li">)</span><span id="6d4c" class="jc jd hh lb b fi ln lg l lh li">""",HORIZON,CONFIDENCE_LEVEL)</span><span id="9a9e" class="jc jd hh lb b fi ln lg l lh li">dfforecast.head()</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mn"><img src="../Images/b4995c9284e65e0ac4652750c81bf36b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VjNlEMMfwtMDwCBehlhB9Q.png"/></div></div></figure><p id="bbb2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于<code class="du lk ll lm lb b">horizon</code>设置为30，因此结果为30 x(项目数)，每个预测值占一行:</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="d4c6" class="jc jd hh lb b fi lf lg l lh li">print(f"Number of rows: {dfforecast.shape[0]}")</span><span id="9e01" class="jc jd hh lb b fi ln lg l lh li">Number of rows: 150</span></pre><p id="8dca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">检查模型系数</strong></p><p id="4f57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以使用<a class="ae kc" href="https://cloud.google.com/bigquery-ml/docs/reference/standard-sql/bigqueryml-syntax-arima-coefficients" rel="noopener ugc nofollow" target="_blank"> ML查看每个时间序列模型的系数。ARIMA系数</a>。</p><p id="a065" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于每个模型，<code class="du lk ll lm lb b">ar_coefficients</code>值显示时间序列模型的自回归(AR)部分的模型系数。类似地，<code class="du lk ll lm lb b">ma_coefficients</code>值显示了模型的移动平均(MA)部分的模型系数。这两个值都是数组，长度分别等于<code class="du lk ll lm lb b">non_seasonal_p</code>和<code class="du lk ll lm lb b">non_seasonal_q</code>。<code class="du lk ll lm lb b">intercept_or_drift</code>值是时间序列模型中的常数项。</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="1bd7" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="e822" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="5571" class="jc jd hh lb b fi ln lg l lh li">*</span><span id="416a" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="141a" class="jc jd hh lb b fi ln lg l lh li">ML.ARIMA_COEFFICIENTS(MODEL bqmlforecast.arima_model)</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mo"><img src="../Images/643ff08831cd003d1e611d6e1ffa06e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GjT6YhLU4o5ObIrhr-AHEQ.png"/></div></div></figure><h2 id="b67c" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">对照历史数据绘制预测图</h2><p id="87c1" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">使用包含用于训练的历史数据的<code class="du lk ll lm lb b">dfhistorical</code>数据框和包含预测数据的<code class="du lk ll lm lb b">dfforecast</code>数据框绘制预测:</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="d1b2" class="jc jd hh lb b fi lf lg l lh li">itemslist <strong class="lb hi">=</strong> list(dfhistorical.item_name.unique())</span><span id="88f0" class="jc jd hh lb b fi ln lg l lh li"><strong class="lb hi">for</strong> item <strong class="lb hi">in</strong> itemslist:</span><span id="477e" class="jc jd hh lb b fi ln lg l lh li">datah <strong class="lb hi">=</strong> dfhistorical[dfhistorical.item_name<strong class="lb hi">==</strong>item]</span><span id="ba39" class="jc jd hh lb b fi ln lg l lh li">dataf <strong class="lb hi">=</strong> dfforecast[dfforecast.item_name<strong class="lb hi">==</strong>item]</span><span id="fa4f" class="jc jd hh lb b fi ln lg l lh li">plot_historical_and_forecast(input_timeseries <strong class="lb hi">=</strong> datah,</span><span id="b29e" class="jc jd hh lb b fi ln lg l lh li">timestamp_col_name <strong class="lb hi">=</strong> "date",</span><span id="ad90" class="jc jd hh lb b fi ln lg l lh li">data_col_name <strong class="lb hi">=</strong> "total_amount_sold",</span><span id="0792" class="jc jd hh lb b fi ln lg l lh li">forecast_output <strong class="lb hi">=</strong> dataf,</span><span id="d4d2" class="jc jd hh lb b fi ln lg l lh li">actual <strong class="lb hi">=</strong> <strong class="lb hi">None</strong>,</span><span id="b612" class="jc jd hh lb b fi ln lg l lh li">title <strong class="lb hi">=</strong> item,</span><span id="b9cf" class="jc jd hh lb b fi ln lg l lh li">plotstartdate <strong class="lb hi">=</strong> "2017-01-01")</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mp"><img src="../Images/21edd355a4cf56f3866dcd973535f783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xKteFNlsg36lvdheejvrGg.png"/></div></div></figure><h2 id="6dd6" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">根据实际数据绘制预测图</h2><p id="2a8c" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">将实际销售数据保存到<code class="du lk ll lm lb b">dfactual</code>熊猫数据框:</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="198b" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery dfactual <strong class="lb hi">--</strong>params $ARIMA_PARAMS <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="11cd" class="jc jd hh lb b fi ln lg l lh li">DECLARE HORIZON STRING DEFAULT "30"; <em class="lj">#number of values to forecast</em></span><span id="ff35" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="deb8" class="jc jd hh lb b fi ln lg l lh li">date,</span><span id="3494" class="jc jd hh lb b fi ln lg l lh li">item_description AS item_name,</span><span id="6cd1" class="jc jd hh lb b fi ln lg l lh li">SUM(bottles_sold) AS total_amount_sold</span><span id="9e25" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="836f" class="jc jd hh lb b fi ln lg l lh li">`bigquery<strong class="lb hi">-</strong>public<strong class="lb hi">-</strong>data.iowa_liquor_sales.sales`</span><span id="2f4a" class="jc jd hh lb b fi ln lg l lh li">GROUP BY</span><span id="bfab" class="jc jd hh lb b fi ln lg l lh li">date, item_name</span><span id="1c6d" class="jc jd hh lb b fi ln lg l lh li">HAVING</span><span id="1ace" class="jc jd hh lb b fi ln lg l lh li">date BETWEEN DATE_ADD(<strong class="lb hi">@</strong>TRAININGDATA_ENDDATE,</span><span id="9e13" class="jc jd hh lb b fi ln lg l lh li">INTERVAL 1 DAY)</span><span id="69f0" class="jc jd hh lb b fi ln lg l lh li">AND DATE_ADD(<strong class="lb hi">@</strong>TRAININGDATA_ENDDATE,</span><span id="471e" class="jc jd hh lb b fi ln lg l lh li">INTERVAL 1<strong class="lb hi">+</strong>CAST(HORIZON AS INT64) DAY)</span><span id="007a" class="jc jd hh lb b fi ln lg l lh li">ORDER BY</span><span id="a948" class="jc jd hh lb b fi ln lg l lh li">date;</span><span id="d136" class="jc jd hh lb b fi ln lg l lh li">dfactual.head()</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es mq"><img src="../Images/14b1da3a41e2e26dbb524a65712cd9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*ryDEp6s3y5kNMcBy9M0Jow.png"/></div></figure><p id="0b05" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用包含历史数据的<code class="du lk ll lm lb b">dfhistorical</code>数据框、包含预测数据的<code class="du lk ll lm lb b">dfforecast</code>数据框和包含实际销售数据的<code class="du lk ll lm lb b">dfactual</code>数据框，根据训练数据和实际值绘制预测:</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="9ebd" class="jc jd hh lb b fi lf lg l lh li">itemslist <strong class="lb hi">=</strong> list(dfhistorical.item_name.unique())</span><span id="aea9" class="jc jd hh lb b fi ln lg l lh li"><strong class="lb hi">for</strong> item <strong class="lb hi">in</strong> itemslist:</span><span id="455c" class="jc jd hh lb b fi ln lg l lh li">datah <strong class="lb hi">=</strong> dfhistorical[dfhistorical.item_name<strong class="lb hi">==</strong>item].sort_values('date')</span><span id="9727" class="jc jd hh lb b fi ln lg l lh li">dataf <strong class="lb hi">=</strong> dfforecast[dfforecast.item_name<strong class="lb hi">==</strong>item].sort_values(['forecast_timestamp'])</span><span id="d4c3" class="jc jd hh lb b fi ln lg l lh li">dataa <strong class="lb hi">=</strong> dfactual[dfactual.item_name<strong class="lb hi">==</strong>item].sort_values('date')</span><span id="37a7" class="jc jd hh lb b fi ln lg l lh li">plot_historical_and_forecast(input_timeseries <strong class="lb hi">=</strong> datah,</span><span id="cee2" class="jc jd hh lb b fi ln lg l lh li">timestamp_col_name <strong class="lb hi">=</strong> "date",</span><span id="893c" class="jc jd hh lb b fi ln lg l lh li">data_col_name <strong class="lb hi">=</strong> "total_amount_sold",</span><span id="cd84" class="jc jd hh lb b fi ln lg l lh li">forecast_output <strong class="lb hi">=</strong> dataf,</span><span id="226d" class="jc jd hh lb b fi ln lg l lh li">actual <strong class="lb hi">=</strong> dataa,</span><span id="5cb7" class="jc jd hh lb b fi ln lg l lh li">title <strong class="lb hi">=</strong> item,</span><span id="bb1a" class="jc jd hh lb b fi ln lg l lh li">plotstartdate <strong class="lb hi">=</strong> "2017-01-01")</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="er es mr"><img src="../Images/817463df9314eb3bd4261ea650b44aa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jIUf6OpCxyvWe3XGoxTuPQ.png"/></div></div></figure><h2 id="9b87" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">使用Data Studio创建仪表板</h2><p id="5e52" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">按照本节中的步骤，使用Data Studio创建一个交互式、可共享的预测数据仪表板。</p><h2 id="0b16" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">创建包含仪表板数据的视图</h2><p id="8ff4" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">创建连接历史数据和预测数据的视图。在<code class="du lk ll lm lb b">UNION ALL</code>子句之前的SQL选择历史数据。<code class="du lk ll lm lb b">UNION ALL</code>子句后的SQL使用<code class="du lk ll lm lb b">ML.FORECAST</code>来生成预测值和预测间隔。该查询对<code class="du lk ll lm lb b">history_value</code>和<code class="du lk ll lm lb b">forecasted_value</code>使用不同的字段，以便您可以在接下来的步骤中用不同的颜色绘制它们。</p><pre class="ks kt ku kv fd la lb lc ld aw le bi"><span id="eaed" class="jc jd hh lb b fi lf lg l lh li"><strong class="lb hi">%%</strong>bigquery <strong class="lb hi">--</strong>params $ARIMA_PARAMS  <strong class="lb hi">--</strong>project $PROJECT_ID</span><span id="13fe" class="jc jd hh lb b fi ln lg l lh li">CREATE OR REPLACE VIEW bqmlforecast.outputdata_datastudio AS (</span><span id="82c0" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="d961" class="jc jd hh lb b fi ln lg l lh li">date AS timestamp,</span><span id="dbfd" class="jc jd hh lb b fi ln lg l lh li">item_name,</span><span id="63b3" class="jc jd hh lb b fi ln lg l lh li">total_amount_sold AS history_value,</span><span id="21fc" class="jc jd hh lb b fi ln lg l lh li">NULL AS forecast_value,</span><span id="aa74" class="jc jd hh lb b fi ln lg l lh li">NULL AS prediction_interval_lower_bound,</span><span id="37b1" class="jc jd hh lb b fi ln lg l lh li">NULL AS prediction_interval_upper_bound</span><span id="9513" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="9b2a" class="jc jd hh lb b fi ln lg l lh li">bqmlforecast.training_data</span><span id="a8b9" class="jc jd hh lb b fi ln lg l lh li">UNION ALL</span><span id="3191" class="jc jd hh lb b fi ln lg l lh li">SELECT</span><span id="10fc" class="jc jd hh lb b fi ln lg l lh li">EXTRACT(DATE</span><span id="4cc9" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="362c" class="jc jd hh lb b fi ln lg l lh li">forecast_timestamp) AS timestamp,</span><span id="5f7e" class="jc jd hh lb b fi ln lg l lh li">item_name,</span><span id="0728" class="jc jd hh lb b fi ln lg l lh li">NULL AS history_value,</span><span id="b09d" class="jc jd hh lb b fi ln lg l lh li">forecast_value,</span><span id="688d" class="jc jd hh lb b fi ln lg l lh li">prediction_interval_lower_bound,</span><span id="8dd8" class="jc jd hh lb b fi ln lg l lh li">prediction_interval_upper_bound</span><span id="a1da" class="jc jd hh lb b fi ln lg l lh li">FROM</span><span id="55a8" class="jc jd hh lb b fi ln lg l lh li">ML.FORECAST(MODEL bqmlforecast.arima_model,</span><span id="b4e8" class="jc jd hh lb b fi ln lg l lh li">STRUCT(30 AS horizon, 0.9 AS confidence_level))</span><span id="5891" class="jc jd hh lb b fi ln lg l lh li">ORDER BY timestamp</span><span id="b6ff" class="jc jd hh lb b fi ln lg l lh li">)</span><span id="2bf8" class="jc jd hh lb b fi ln lg l lh li">Query complete after 0.00s: 100%|██████████| 1/1 [00:00&lt;00:00, 617.08query/s]</span></pre><p id="6aad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了帮助零售商提供更简单、更灵活的需求规划解决方案，谷歌云发布了一个<a class="ae kc" href="https://services.google.com/fh/files/misc/smart_analytics_reference_patterns_demand_forecasting_one_sheet.pdf" rel="noopener ugc nofollow" target="_blank">智能分析参考模式</a>，用于使用自回归综合移动平均(ARIMA)作为基础，使用BigQuery ML执行时间序列预测。这个ARIMA模型遵循BigQuery ML低代码设计原则，允许在没有时间序列模型高级知识的情况下进行准确预测。此外，BigQuery ML ARIMA模型在许多人熟悉的原始ARIMA模型上提供了几项创新，包括捕捉多个季节模式的能力、自动化模型选择、无争议的预处理管道，以及最重要的是，只需几行SQL语句，即可轻松生成数千个大规模预测。</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="ab fe cl kz"><img src="../Images/4b0eced25676a72b7136a347652a8f94.png" data-original-src="https://miro.medium.com/v2/format:webp/1*e-SlVJJS4Ci92aFmuc4ceg.png"/></div></figure><h1 id="9715" class="lt jd hh bd je lu lv lw ji lx ly lz jm ma mb mc jp md me mf js mg mh mi jv mj bi translated">参考</h1><ul class=""><li id="fdeb" class="kd ke hh ig b ih jx il jy ip ms it mt ix mu jb ki kj kk kl bi translated"><a class="ae kc" href="https://github.com/kasiarun/analytics-componentized-patterns" rel="noopener ugc nofollow" target="_blank">GitHub:kasi arun/analytics-componented-patterns</a></li><li id="ced9" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">博客:<a class="ae kc" href="https://cloud.google.com/blog/products/data-analytics/get-started-with-data-analytics-demand-forecasting-with-ml-models" rel="noopener ugc nofollow" target="_blank">零售商在BigQuery ML </a>中发现灵活的需求预测模型</li><li id="b99e" class="kd ke hh ig b ih km il kn ip ko it kp ix kq jb ki kj kk kl bi translated">了解<a class="ae kc" href="https://cloud.google.com/bigquery/pricing" rel="noopener ugc nofollow" target="_blank"> BigQuery定价</a>、<a class="ae kc" href="https://cloud.google.com/bigquery-ml/pricing" rel="noopener ugc nofollow" target="_blank"> BigQuery ML定价</a>，并使用<a class="ae kc" href="https://cloud.google.com/products/calculator/" rel="noopener ugc nofollow" target="_blank">定价计算器</a>根据您的预计使用量生成成本估算。</li></ul><div class="mv mw ez fb mx my"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mz ab dw"><div class="na ab nb cl cj nc"><h2 class="bd hi fi z dy nd ea eb ne ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nf l"><h3 class="bd b fi z dy nd ea eb ne ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ng l"><p class="bd b fp z dy nd ea eb ne ed ef dx translated">medium.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm kx my"/></div></div></a></div></div></div>    
</body>
</html>