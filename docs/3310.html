<html>
<head>
<title>Rating Prediction from Review Text with Regularization — Linear Regression vs Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于正则化的评论文本评分预测——线性回归与逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/rating-prediction-from-review-text-with-regularization-linear-regression-vs-logistic-regression-df0181fe9c07?source=collection_archive---------7-----------------------#2022-08-17">https://medium.com/mlearning-ai/rating-prediction-from-review-text-with-regularization-linear-regression-vs-logistic-regression-df0181fe9c07?source=collection_archive---------7-----------------------#2022-08-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c1e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我试图构建几个传统的机器学习模型(线性回归和逻辑回归)并进行正则化，以纯粹基于顾客评论文本预测餐馆的星级。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/f4d8c889fb7c5ad9ecba4d774c4a1fe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NoP0OdpCJF6rGveqFa9mdQ.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx"><a class="ae js" href="https://stock.adobe.com/sg/images/smile-face-and-cart-icon-on-wood-cube-optimistic-person-or-people-feeling-inside-and-service-rating-when-shopping-satisfaction-concept/412850582?asset_id=412850582" rel="noopener ugc nofollow" target="_blank">https://stock.adobe.com/</a></figcaption></figure><h1 id="e538" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">1.简介和数据探索</h1><p id="3535" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">Yelp发布关于企业的众包评论。所使用的数据集是Kaggle的<a class="ae js" href="https://www.kaggle.com/c/yelp-recsys-2013" rel="noopener ugc nofollow" target="_blank"> Yelp商业评分预测</a>比赛数据的一个小子集，可以在这里下载<a class="ae js" href="https://smu-my.sharepoint.com/:f:/g/personal/vaple_2021_mitb_smu_edu_sg/EtFn8Z3ynNVKlkiwEJQ5e8UBs4UO2TM-T81LKh7diLcXFA?e=V65JZA" rel="noopener ugc nofollow" target="_blank">。数据集的一些关键信息:</a></p><ul class=""><li id="5dab" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated">每个观察(行)是特定用户对特定业务的回顾。</li><li id="ba28" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi">星级</strong>栏是评估者给业务分配的星级数(1到5)(星级越高越好。)换句话说，就是写评论的人对企业的评级。</li><li id="10b3" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi">文本</strong>列是评论的文本。</li></ul><p id="c538" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，让我们导入必要的库和数据集本身:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="ebd5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，为了获得关于评论文本的一些直觉，我们可以在两个极端使用流行的词云可视化——一星和五星评论。我们从5星评价开始:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lm"><img src="../Images/5a6635bc75efdef8f56b661ca92f0a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*3bA7tdxNqJMBs92gFVv1Sg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">5-star reviews word cloud</figcaption></figure><p id="89c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来是1星评价:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ln"><img src="../Images/1b92297cfe5ee34bdc39e0ee3d399836.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*KrAzG-AD-aAccXg3zgjkvg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">1-star reviews word cloud</figcaption></figure><p id="5b44" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从生成的两个云来看，很明显输出没有预期的好。我们的期望是，5星评价应该包含更多的正面词汇，如用于补充的词汇，而1星评价应该包含更多的负面词汇。因此，他们的词云应该有这些相反意义的词组占主导地位。</p><p id="9a5c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，这两种词云都以中性和描述性的词为主，如“食物”、“服务”和“地点”。我们可以看到，虽然5星级词云确实包含几个具有积极内涵的词，如“棒”、“好”、“好吃”，但它主要是中性词。此外，1星评级甚至有一个积极的词“好”作为最频繁的词之一，而“坏”的词相对较少，表明频率较低。<br/>统计最频繁出现的单词不会产生评论是否负面的良好指示。</p><p id="83d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这表明需要预处理这些评级，以去除上面列出的高度重复但中性的词，从而将更多的注意力放在评论中与情感相关的词上。</p><h1 id="6dc7" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">2.反矢量器和非正则线性回归</h1><p id="fa48" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">根据Scikit-Learn文档，CountVectorizer将输入语料库中出现的单词创建成单词包(词汇表)。这些标记被理解为建模的属性。然后它将文档(句子/复习课文)列表转换成一个矩阵，其中每行是一个文档，每列是词汇表中每个单词在文档中出现的频率。</p><p id="8859" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个实现中，我们可以使用参数<code class="du lo lp lq lr b">ngram_range = (1, 2)</code>来指定最小1个单词和最大2个单词的长度将作为特征被包括，并且<code class="du lo lp lq lr b">min_df = 10</code>忽略在整个词汇表中出现少于10次的特征。具有CountVectorizer的线性回归模型(训练80%和测试20%)构建如下:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="79c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用训练数据拟合回归模型后，我们可以使用测试数据(X_test)生成预测(Y_pred ),然后检查模型如何通过R平方或RMSE解释残差:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="fe3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">得到的R平方是-4.14，而RMSE是2.74。这些数值表明该模型还不能很好地解释这些数据。我们可以深入了解该模型的重要特性，以获得更多见解:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ls"><img src="../Images/59c967c71d4eb9bb7215201a364ea910.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*Uu-Ndf6GrWRNY4_PCnB3Gg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">linear model feature importance</figcaption></figure><p id="f461" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到，大多数顶级特征都很好地表明了评论的积极或消极。然而，该模型的一些顶级特征具有模糊/中性的含义(“这里有”、“关闭”)或者适用于其他情况的非通用含义(“丰盛的早餐”)。</p><h1 id="6141" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">3.正则线性回归</h1><p id="fb90" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">为了提高上述模型的性能，我们可以尝试不同的正则化技术。在接下来的部分中，套索和山脊正则化以不同的程度实现，由<code class="du lo lp lq lr b">alpha</code>值控制。alpha值越高，应用的正则化强度越大，给予复杂模型的惩罚越多，导致复杂度越低。这可以以训练集准确性为代价来改善模型与测试数据的差异(减少过拟合)。关于这两种技术的一篇好文章将在下面的文章中介绍:</p><div class="lt lu ez fb lv lw"><a href="https://towardsdatascience.com/regularization-in-machine-learning-76441ddcf99a" rel="noopener follow" target="_blank"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hi fi z dy mb ea eb mc ed ef hg bi translated">机器学习中的正则化</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">训练机器学习模型的一个主要方面是避免过度拟合。该模型将有一个低…</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">towardsdatascience.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk jm lw"/></div></div></a></div><p id="2f28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些步骤的总体流程是，对于每个alpha值，使用训练数据构建一个新模型，然后根据测试数据生成预测。训练集和测试集上的错误都被记录并排列成数据帧，以便于阅读。</p><p id="3df7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3.1。拉索正规化</strong></p><p id="88af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，实现套索正则化。请注意，模型的复杂程度可以通过几种方法来计算。这里，L1范数(或系数幅度之和)被用作指示并同时显示。您可以选择一种首选方法(使用numpy线性代数库<code class="du lo lp lq lr b">.norm()</code>方法或应用于系数的简单<code class="du lo lp lq lr b">.abs()</code>方法。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ml"><img src="../Images/29ed8f24bee7cf15ace7dfcb3ef9e821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gr0GrKYoq-sqqMi4wDRWwA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">lasso regularized linear regression models</figcaption></figure><p id="49a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">较高的alpha值不利于更复杂的模型，因此通过移除不重要的特征来降低模型复杂性。当alpha从0.0001增加到0.001时，测试RMSE减少，因此模型的概括能力提高。这是以更高的训练误差为代价实现的，这可以从增加的训练RMSE值中看出。超过0.001的alpha，模型测试误差再次增加。这是较低的复杂性无法推广的地方，因为删除了太多重要的功能。因此，最好的模型似乎是alpha = 0.001，此时模型的概括能力还没有最大化，复杂度相对较低。</p><p id="0bd1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">与上一节类似，我们可以从性能最好的模型中输出模型特性重要性。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="864a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基于下面幅度最大的前10个特征。显而易见，这些特征具有更明确的含义。更强烈的词，清楚地给出了评论的暗示，如“灾难”、“可怕”和“最差”/“不值得”，这些词在以前建立的正常回归中不存在，现在出现了。然而，应该注意的是，顶级功能现在包含所有具有负面意义的内容。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mm"><img src="../Images/5ac5191e84d1a788a6f961ecce36a56e.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*UKRKBmjY1V7W38blaFUoKQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">best-performing lasso model feature importance</figcaption></figure><p id="4f5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3.2。山脊规则化</strong></p><p id="fed0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过同样的方式，下面实现了脊正则化，并且在数据帧中总结了不同正则化强度的结果。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mn"><img src="../Images/fa1c6dd295a6e077d8d6a20d136f391c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qV79kyhIrLIYJD5gBcnwTQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">ridge regularized linear regression models</figcaption></figure><p id="452f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从系数大小的总和可以看出，岭回归产生的模型比以前的lasso回归复杂得多。这是因为<em class="mo">套索回归允许系数一直减少到零</em>，因此完全删除了属性，而ridge不能。</p><p id="ed2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">模型的复杂性也可以通过更常用的Norm2来衡量。基于阿尔法和RMSE值的趋势，有一个单调的趋势:随着阿尔法的增加，应用更多的正则化，以更高的训练误差为代价降低模型复杂度，并实现更好(更低)的测试误差。这个模型越来越好概括。</p><p id="4d2b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们没有看到套索回归中出现的趋势逆转的问题。这可能是因为岭回归没有完全去除任何属性，不管它们的重要性如何。因此，删除能够概括测试数据的重要特性的风险降低了。我们可以将alpha为0.1的模型视为性能最佳的模型，因为它是最简单的<em class="mo">，但仍能确保较低的测试误差</em>。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mp"><img src="../Images/4f210ba28ed4ab77eda0c94e2ff3d7ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*oN59AhvDwPfTNb5T-oBlMg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">best-performing ridge model feature importance</figcaption></figure><p id="90af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上面的10大特征可以看出，这个模型不如lasso之前的好。这是因为虽然强否定词仍被列为强属性，但一些中性/歧义词如“ing”、“drive through”和“here has”仍会出现。</p><p id="a50c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总的来说，线性回归模型可以生成良好的预测特征，可以比简单地使用词云更好地预测评论的评级。然而，观察到这些模型收敛相对较慢，并且在最高评级特征中仍然包含中性词。Lasso的模型复杂度也非常高，这可以从以千计的系数数量级的总和中看出。这使得在实践中使用它成为一个挑战。虽然岭回归可以删除许多特征并生成更简单的模型，但当应用过多的正则化时，它有欠拟合的风险。</p><h1 id="6217" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak"> 3。正则化逻辑回归</strong></h1><p id="5c74" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在这个简单的逻辑回归实现中，我们将问题视为两个极端类别的二元分类:1星和5星评论，方法是创建主数据集的子集，然后对训练测试集进行同样的80-20分割，并将评论文本矢量化为特征。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="a7f0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于在SKLearn中实现的逻辑回归，正则化程度由C值控制，C值与正则化强度的<em class="mo">倒数</em>成比例-C值越小，正则化越强，对复杂模型施加的惩罚越多。</p><p id="b65f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，L2范数正则化类似于岭正则化，而L1范数正则化等价于线性回归模型中的套索正则化。</p><p id="d9e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在模型分类性能方面，在不同的正则化强度下检查ROC曲线下的面积(AUC)。</p><p id="555b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3.1。L2范数正则化逻辑回归</strong></p><p id="56c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以实现L2正则化的逻辑回归模型，并将它们的AUC值记录到一个简单的数据框架中。模型系数幅度的总和用于复杂度测量。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mq"><img src="../Images/0d3c1fefbb713746a3d6be23041111cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*coN7cLd6u9rJKkbR6mQ5Mg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">L2-regularized logistic regression model performance</figcaption></figure><p id="ae8e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以将不同C值的AUC曲线可视化如下:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mr"><img src="../Images/e3a447eec12e85f41b2683f3d21dfad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*nrvVt6i2vJozMDY-iw5Hiw.png"/></div></figure><p id="be4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随着C的增加，对更复杂的模型施加更少的惩罚。因此，由系数幅度之和测量的模型复杂度增加。模型训练AUC值随着其拟合训练数据的能力增加而单调增加。然而，模型试验的AUC在C=1时达到峰值，此后下降。这显示出过度装配的迹象。</p><p id="f3e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">C=0.01的模型似乎是最理想的。这是因为虽然复杂性是第二低的，最复杂模型的5.8%(C = 100，最不规则)，但它可以实现最复杂模型的98%的训练和测试AUC。</p><p id="57ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，让我们挑选这个最佳模型，并检查它们的特性重要性。基于其系数大小的顶部特征是合理的，因为它们中的大多数对评论是正面还是负面具有明确的意义。然而，有两个特征(“否”和“不是”)可能是不明确的。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ms"><img src="../Images/3e4ce042656867c2a73b17a008217891.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*gtRtEAckxNBVHsSXpUlTYA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">best L2-regularized model feature importance</figcaption></figure><p id="c210" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3.2。L1范数正则化逻辑回归</strong></p><p id="a43f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">类似地，让我们建立几个L1正则化模型，并通过AUC表和曲线检查它们的性能。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mt"><img src="../Images/9bd85f508c8a612ade7eee209357e422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*CswnkfjWU9BXQuWMQykxdQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">L1-regularized logistic regression model performance</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mu"><img src="../Images/bc449efeea478ec62c6f980800b2e150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*Py-tiDd13rCw-onEksN9oA.png"/></div></figure><p id="62c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如上表和图所示，与之前的L2惩罚相似，随着C的增加，对更复杂的模型施加的惩罚更少。因此，由系数幅度之和测量的模型复杂度增加。模型训练AUC值随着其拟合训练数据的能力增加而单调增加。</p><p id="9e22" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，模型试验的AUC在C=1时达到峰值，此后下降。这表明过度拟合的迹象。一个重要的观察是，模型的复杂性现在<em class="mo">低得多</em>在每一个C值比L2罚值低的情况下。L1罚模型导致具有同样好性能的更简单的模型。</p><p id="7b05" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">C=0.1的模型似乎是最理想的。这是因为虽然复杂性是第三最低的，是最复杂模型的2.8%(C = 100，最小正则化)，但它可以实现最复杂模型的训练和测试AUC的大约98%。</p><p id="d9b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用相同的方法，我们可以提取该最佳模型的最高特征重要性，如下所示:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lk ll l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mv"><img src="../Images/cff0ec3028d18252d1050414c67670b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*wtBPo6MooigLkqWTuFyESQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">best L1-regularized model feature importance</figcaption></figure><p id="780d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">与使用L2正则化的所选模型相比，L1最佳执行模型具有低得多的复杂度。即使复杂性更低，其10大最重要的特征也比之前的L2模型具有更明确的正面或负面意义。使用这些顶级功能更容易辨别和预测1星和5星评级。在这种情况下没有明显的模糊特征。</p><h1 id="06f6" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">4.摘要</h1><p id="1df5" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">很明显，逻辑回归在适当调整后可以生成简单的模型，具有高质量的顶级特征，清楚地表明了审查数据的内涵。还观察到它运行非常快。这优于线性回归模型。</p><div class="lt lu ez fb lv lw"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lx ab dw"><div class="ly ab lz cl cj ma"><h2 class="bd hi fi z dy mb ea eb mc ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="md l"><h3 class="bd b fi z dy mb ea eb mc ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="me l"><p class="bd b fp z dy mb ea eb mc ed ef dx translated">medium.com</p></div></div><div class="mf l"><div class="mw l mh mi mj mf mk jm lw"/></div></div></a></div></div></div>    
</body>
</html>