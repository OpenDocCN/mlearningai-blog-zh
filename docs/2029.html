<html>
<head>
<title>Classifying sentences: part 1 clustering sentences</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">句子分类:第1部分句子聚类</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/classifying-sentences-part-1-clustering-sentences-acfe49d508a7?source=collection_archive---------1-----------------------#2022-02-24">https://medium.com/mlearning-ai/classifying-sentences-part-1-clustering-sentences-acfe49d508a7?source=collection_archive---------1-----------------------#2022-02-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="f123" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在chatbots上的帖子之后，我对实践更多的文本分析技术感兴趣，比如对文本和单词嵌入进行分类。我去了Kaggle，找到了一个问答数据集(<a class="ae jc" href="https://www.kaggle.com/quora/question-pairs-dataset" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/quora/question-pairs-dataset</a>)。它包含可能相似也可能不相似的问题对。</p><p id="7319" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我练习在数据集中寻找重复的问题，并对句子进行聚类。我们开始吧！</p><p id="e874" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">查看github中支持python的子功能:【https://github.com/j622amilah/Classify_sentences<a class="ae jc" href="https://github.com/j622amilah/Classify_sentences" rel="noopener ugc nofollow" target="_blank">！</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/d6fbe8a47301fb39e9417002fcc4d4c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*WRPqtE7hP4-0921EAqDXZw.png"/></div></figure><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jl jm l"/></div></figure><h1 id="59ec" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">在PC上加载数据</h1><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jl jm l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kl"><img src="../Images/53fd9bdcf1872cb585da98799c34353b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJhT_i3DOw-baZzWqc6Nmw.png"/></div></div></figure><p id="7c9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们只加载整个404350对数据集的前200个问题对。</p><h1 id="c25a" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">在数据集中查找重复的问题</h1><p id="dcfa" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">将您的答案与is_duplicate列进行比较。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jl jm l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kv"><img src="../Images/90e3edd7ecbc24a9630907c0f569b972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqRtNdD6zh30Bvw0pt0i8A.png"/></div></div></figure><p id="91db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到is_duplicate列与计算的余弦相似度只有10%的相似度。并且基于人工检查，所计算的余弦相似性似乎比给定的is_duplicate列更准确；0表示相似，1表示不相似。</p><h1 id="1433" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">集群句</h1><p id="e66f" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">通过聚类相似的句子，可以为每个句子分配一个标签，这样我们就可以对相似的句子进行分类。我们建立句子间的相似度矩阵，并为每个矩阵条目找到最大相似度句子对。然后我们把每组中的第一句话作为‘代表组句’，重复进行相似度矩阵分析，直到所有的句子都缩减成几个大组。我不知道这种算法是否已经存在，但它似乎是对句子进行聚类的最直接的方法之一。</p><p id="37a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对句子进行分组的另一种方法可以是使用现有的单词嵌入矩阵:1)为每个句子计算每个单词的嵌入向量，2)对单词嵌入向量求和以获得句子嵌入向量，3)然后对相似的句子嵌入向量进行分组。</p><h2 id="be3f" class="kw jo hh bd jp kx ky kz jt la lb lc jx ip ld le kb it lf lg kf ix lh li kj lj bi translated">基于最大相似度将句子分成相似的组</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jl jm l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lk"><img src="../Images/0f0e97b1f06a5aeab7b12258b12988df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jIVQioIF_2Dw_MC7dxKuEw.png"/></div></div></figure><p id="8feb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在句子开始重复之前，最大相似性算法运行了14次比较句子相似性的循环。我们可以看到，第5、6和9句群中有很多句子。因此，基于这种算法结构，249个句子可以分为3个主要组。</p><p id="234b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">是的，我说了249个句子，而不是400个句子，我在代码开头的某个地方有一个小错误。这种代码的结构对于重组句子组、确定哪些句子组应该合并以使句子不重复来说是非常困难的。继续前进..</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ll"><img src="../Images/34d6f160d75b83d1fa1f064ecd7f70f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8fA6FOzUjzfTSOGwkoBZAw.png"/></div></div></figure><p id="fc85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所有400个问题的相似性矩阵(上图)，以及最后一个循环的相似性矩阵(下图)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lm"><img src="../Images/34a59dd31acc384163004e47be733490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cKwIr1dQpUZvPrNG65LUgA.png"/></div></div></figure><p id="b03a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是分成3组的最后一组句子。每组的句子主题有很大的不同，有趣的是，它将“如何”问题分为第0组，将“如何”、“能”问题分为第1组，将“什么”、“谁”、“为什么”问题分为第2组。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ln"><img src="../Images/a6f57fd83ade9cd2d6f6632fcc7ade03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EXg8_BNBMcFYBBSOrKhWA.png"/></div></div></figure><p id="0bd3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下一篇文章中，我将使用词袋法和基于聚类句子的标签对句子进行分类。练习愉快！</p><div class="lo lp ez fb lq lr"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="ls ab dw"><div class="lt ab lu cl cj lv"><h2 class="bd hi fi z dy lw ea eb lx ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ly l"><h3 class="bd b fi z dy lw ea eb lx ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lz l"><p class="bd b fp z dy lw ea eb lx ed ef dx translated">medium.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf jj lr"/></div></div></a></div></div></div>    
</body>
</html>