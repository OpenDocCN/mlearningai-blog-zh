<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/univariate-variable-time-series-forecasting-using-arima-using-python-2faa012413e1?source=collection_archive---------4-----------------------#2022-01-19">https://medium.com/mlearning-ai/univariate-variable-time-series-forecasting-using-arima-using-python-2faa012413e1?source=collection_archive---------4-----------------------#2022-01-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><p id="337e" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated"><strong class="hi ie">使用PYTHON的ARIMA进行单变量时间序列预测</strong></p><p id="3199" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">问题陈述:我试图解决一个问题陈述，这将有助于预测基于时间的单变量变量。这将有助于其他人理解数据工程师在数据集上实现算法时要遵循的一步一步的过程。</p><p id="eb4e" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">数据集:</p><p id="56da" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">链接:【https://www.kaggle.com/rohanrao/nifty50-stock-market-data T2】</p><p id="8f6d" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">数据集如下图所示，在kaggle网站上很容易找到。对于这个特定的算法，我们只关心这个数据集的两个特征/列，即日期和前一收盘(前一天的价格)。</p><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es ig"><img src="../Images/48f1622e5e364e0056ad26f28ce3972d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GqwuncDVA5Zef88v06lHhQ.png"/></div></div></figure><p id="66de" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">逐步编码:</p><p id="3cec" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">导入python中处理数据集所需的所有基本模块。将来我会导入更多的模块来实现同样的功能。</p><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es is"><img src="../Images/005b550556ef2c564c0760648fac8cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*3N1uahOSpMOoj1kdj6Jw4Q.png"/></div></figure><p id="6b3c" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">在时间序列预测中，将pandas数据框架的索引设置为特征数据，并利用它来分析特征变量是非常必要的。在这种情况下，日期将被设置为“指数”，而“前收盘”将被设置为“特征”列。为了更快地分析数据，我进一步过滤了数据集。</p><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es it"><img src="../Images/6d04a55f87a4fca82a9d35cb8f1bfcfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ReTGC8-FPX1Yu0MIu6AQiA.png"/></div></div></figure><p id="9089" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">要对时间序列数据应用Arima模型，检查我的数据是否平稳非常重要。如果数据集不是静止的，我们必须让它静止。我还将详细讨论我们为使数据集稳定而执行的测试。让我们先想象一下:</p><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es iu"><img src="../Images/dab25ad8b069f34df912efabcc58bbc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*j-cN02Ln3pi4fxUgRLMUpA.png"/></div><figcaption class="iv iw et er es ix iy bd b be z dx">Plot stock Price Vs Time</figcaption></figure><p id="6fe0" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">在上述情况下，数据集似乎不是静止的。以下是识别数据集是否静止的经验法则。</p><p id="6a81" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">平均翻转试验:</p><p id="c76a" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">CHECK_1:验证滚动平均值是否恒定。</p><p id="97d4" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">CHECK_2:验证滚动标准差是否恒定。</p><p id="4924" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">检查3:数据不能与时间相关</p><p id="bb8d" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">扩充的迪克·富勒试验；</p><p id="5490" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">这使用了P-检验，很简单。只需验证数据集的p值是否小于等于0.5。它的工作原理是假设检验。</p><p id="55b3" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">H0:这表明数据不是稳定的</p><p id="9bba" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">H1:这表明数据是稳定的。</p><p id="995c" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">如果p值≤0.05，则数据集变得稳定。简而言之，记住让P值尽可能的低。</p><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es iz"><img src="../Images/16798a3a2246785bf4347f564c6ea795.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oySsF-egeXk6isL3iczkOA.png"/></div></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es ja"><img src="../Images/0bff17916d3de9ff8cc8de8f9a2e07fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*rDeWlEmGw9xZG2iIq1T5Iw.png"/></div></figure><p id="7585" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">根据上面讨论的规则，很明显数据集具有恒定的方差，但不具有恒定的均值。因此，使用翻转测试时，数据不是稳定的。</p><p id="d3c8" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">应用ADCF测试:</p><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jb"><img src="../Images/8285bcd26a96e9c1aa05cad746c161cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xl5Wlf9oHlZhWOGwPSwI8A.png"/></div></div><figcaption class="iv iw et er es ix iy bd b be z dx">Value of p seems to be way greater than 0.05 :-(</figcaption></figure><p id="913a" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">需要一些转换&amp;数据集上的数学</p><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jc"><img src="../Images/7216cf8045cf09cfe63be2df7814950a.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*mYBd5kFviE1Iv8WmaEjqyw.png"/></div><figcaption class="iv iw et er es ix iy bd b be z dx">Applied Log transformation to dataset</figcaption></figure><p id="2925" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">第二次翻滚试验:</p><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jd"><img src="../Images/b90c0199c0eba883237ba160367e17f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7AmeGmpkXwEGz_gKHJ6Tfg.png"/></div></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es je"><img src="../Images/0938c0ceee02165db186e8ee85891f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*LSjHPxmDym9gopCpdopO1g.png"/></div></figure><p id="fa1d" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">我相信事情似乎已经通过肉眼解决了，但是当进行ADCF测试时，结果并不是我们所期望的。你可以看到一个逐渐上升的趋势仍然可见的滚动平均。</p><p id="7c46" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">第二次ADCF测试:</p><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jf"><img src="../Images/dde82624aac2672d902757db2e7c599f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K6wqdK-LPIN5dUvFvcYWWw.png"/></div></div><figcaption class="iv iw et er es ix iy bd b be z dx">P value is far above 0.05 , hence data is not stationary</figcaption></figure><p id="73f3" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">需要一些转换&amp;数据集上的数学——第2部分</p><p id="3b20" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">对于Sql开发人员来说，这是非常熟悉的，因为我们在日常生活中一直在使用lag函数。我们将在python中使用shift函数做同样的事情。</p><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jg"><img src="../Images/ef5b58a9350ccbfead039a149408a184.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*f4VZW2Hd9vjvLtu3w-JuoA.png"/></div></figure><p id="5a4f" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">执行转换后，让我们再次应用相同的测试。</p><p id="96d7" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">第三次翻滚试验:</p><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jh"><img src="../Images/9b8272c1320f60452f5f6ea0b310d64d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*d1toPSJHD-KexkYzsAvlfg.png"/></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es ji"><img src="../Images/4c346509f9065c4e54b4a51fba8e27a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j1nUFMJWxKvpBoc2dyzGmw.png"/></div></div><figcaption class="iv iw et er es ix iy bd b be z dx">seems like we have achieved constant mean and variance. Hurray</figcaption></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jj"><img src="../Images/46cee72b258aadf0b7e871075c4bc00e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hREWbMMlUnCj5GgDb2SF8g.png"/></div></div></figure><p id="3fe8" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">第一步完成了。现在让我们应用ARIMA模型:</p><p id="56cc" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">ARIMA是以下3种基本模型的组合:</p><p id="3c4b" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">现在，为了应用ARIMA，我们需要以下3个分量:<br/> 1) AR — →达到第一个最小值的滞后数。用P表示使用PACR<br/>2)I—→时间微分数。表示为d(时间微分)<br/>3)MA—→移动平均数。使用ACR用q表示</p><p id="a2e7" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">注:AR →自回归，I →积分，MA →移动平均</p><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jk"><img src="../Images/a5be7c40db0b445e760a469a35d36b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*tHChrHINt5Z1xqVnOhUtnA.png"/></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jl"><img src="../Images/d7920c84765f4452fc28344d83aa393e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*o6QXLURsFzTHWXo9pJN0ag.png"/></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jm"><img src="../Images/44458e20abd29e41728ad2d6a2600a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*GbfH-TGzIe4Grzu5htyuJA.png"/></div></figure><p id="b2e7" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">P和Q的值可以很容易地通过观察上面的图表和倾角来确定。有时这些P和Q值可能不是最好的，如果您有足够的可用资源，您可以进行超调。</p><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jn"><img src="../Images/8e1c1381dc20644aae5703086e210ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*W4V4s7k81t4wHdE9JD0jkw.png"/></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jo"><img src="../Images/bb815f91e2f90e8cdea83447036b9935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3A7iY0rwxQnSjU3bVNyABw.png"/></div></div></figure><p id="4044" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">让我们用p、d和q的各自值来拟合模型。</p><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jp"><img src="../Images/49d59b3146fafff500f31d3466178e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cirMfnb3kmRL-Pc4iaOLoQ.png"/></div></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jq"><img src="../Images/3dec9d2f089e61a2aac54863600b56ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*bHx7k6ROpWBatL0AiEtOPA.png"/></div><figcaption class="iv iw et er es ix iy bd b be z dx">Transformed Dataset</figcaption></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jr"><img src="../Images/f711c4d5edcc53aa2c25f49f51fa0a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_CQNlKQ_rUIx03WVLQwrA.png"/></div></div><figcaption class="iv iw et er es ix iy bd b be z dx">Can forecast as many values you want</figcaption></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es js"><img src="../Images/a52aa8e7d1704ae880e68be77acf4c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nsb31576ShPPY_v4bbxWIg.png"/></div></div><figcaption class="iv iw et er es ix iy bd b be z dx">Hypertuning could be done for different p,d &amp; q values</figcaption></figure><p id="713e" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">再次恢复原始值，向业务用户展示:</p><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es jt"><img src="../Images/15eb79fe19cb4b5b1881d12ccf9a1f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*dVF7E7m6xTW1aq3YmUhaMg.png"/></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div class="er es ju"><img src="../Images/e20c4fc1d0698aa5f1679664f90ea9f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*f83EflLS1yBYB-MnydnrEA.png"/></div></figure><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jv"><img src="../Images/60cd1632d69b8e063458444a6df14213.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_8w8NH7GUBF5YfSB5mXt5A.png"/></div></div></figure><p id="e40b" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">这是最终的数据集。</p><figure class="ih ii ij ik fd il er es paragraph-image"><div role="button" tabindex="0" class="im in di io bf ip"><div class="er es jw"><img src="../Images/f265c765d863da51b33a90b4b0baa8af.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*d5lrQIJenk_0JfRjEZ8NMQ.png"/></div></div><figcaption class="iv iw et er es ix iy bd b be z dx">Back to normal values</figcaption></figure><p id="0701" class="pw-post-body-paragraph hf hg hh hi b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx hy hz ia ib ic id ha bi translated">这是用于基于时间序列预测的单变量预测的问题陈述之一。快乐学习！！！</p><div class="jx jy ez fb jz ka"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kb ab dw"><div class="kc ab kd cl cj ke"><h2 class="bd ie fi z dy kf ea eb kg ed ef kh bi translated">Mlearning.ai提交建议</h2><div class="ki l"><h3 class="bd b fi z dy kf ea eb kg ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kj l"><p class="bd b fp z dy kf ea eb kg ed ef dx translated">medium.com</p></div></div><div class="kk l"><div class="kl l km kn ko kk kp iq ka"/></div></div></a></div></div></div>    
</body>
</html>