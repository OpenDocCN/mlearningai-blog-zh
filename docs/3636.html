<html>
<head>
<title>Implementing Neural Networks from scratch in Python: What is Cost?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python从零开始实现神经网络:代价是什么？</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/implementing-neural-networks-from-scratch-in-python-what-is-cost-c5e1e6d349db?source=collection_archive---------4-----------------------#2022-10-01">https://medium.com/mlearning-ai/implementing-neural-networks-from-scratch-in-python-what-is-cost-c5e1e6d349db?source=collection_archive---------4-----------------------#2022-10-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="f37f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">神经网络或机器学习模型使用称为训练数据的数据集来训练自己，该数据集包含几个训练示例。每个训练示例都由要素和标签组成。模型自我训练的方式是，对于每个训练示例，它预测一个值(或标签)，然后将其与该训练示例的真实标签进行比较。在此过程中，模型会计算一个数值，该数值会量化训练示例的预测标签和实际标签之间的误差。这个误差值对于每个训练示例是不同的，并且被称为“损失”。</p><p id="83ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们要在整个训练数据集上计算这个损失的平均值，那么这个平均值将被称为“成本”。记住，成本越低，模型越好。</p><p id="7979" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可能有几个数学表达式可以计算该误差，但是成本函数(计算模型成本的数学表达式)的最重要的属性是它具有全局最小值。</p><p id="1c58" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了理解什么是全局最小值，请看下图，</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/1b9cf03f16a45dc86af3b8d2fd07cf9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*ar0I-BrowAnQwf4mHjfzDw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Global minima of a mathematical function</figcaption></figure><p id="2f6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该图显示了水平轴(+3)上函数值最小的点，该点被称为所绘制的数学函数的全局最小值。</p><p id="58e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为我们需要最小化成本函数，所以它必须由一个全局最小值(或极小值)组成，其中成本的值是最小的。全局最小值是通过优化算法找到的，比如梯度下降，但是这些算法超出了本文的范围。</p><p id="ee93" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不同类型的成本函数满足前述标准，并且它们的使用取决于被训练的深度学习模型的类型。这里我们将实现二元分类中使用的代价函数(因为这是大多数初学者的起点)。</p><p id="fec9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于二元分类，每个训练示例的损失可以计算为:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jo"><img src="../Images/0568ce893bb9e2fe823a58a17992d265.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*Kx1lMqvJq5oDH8MMjJ3sBw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Loss for ith training example</figcaption></figure><p id="8b07" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中“y”和“a”是第I个训练示例的真实和预测标签。</p><p id="74cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以通过对整个训练数据集的损失进行平均来计算成本:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jp"><img src="../Images/c8a0e08b6ab7863a0da9f4dda35ecb15.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*oKn0W5fsihazL6ermwAMBw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">cost for the entire training set</figcaption></figure><p id="a7e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中“m”是训练集中的样本数。</p><p id="2aff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在python的矢量化形式中，上述数学表达式可以轻松实现如下:</p><pre class="jd je jf jg fd jq jr js jt aw ju bi"><span id="aef9" class="jv jw hh jr b fi jx jy l jz ka">import numpy as np</span><span id="378d" class="jv jw hh jr b fi kb jy l jz ka">def cost(A,Y):<br/>    cost = -1/m * np.sum(Y*np.log(A) + (1-Y)*np.log(1-A))<br/>    return cost</span></pre><p id="02de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里‘Y’是整个训练集的标签向量，而‘A’是包含与‘Y’维数相同的预测标签的向量。</p><p id="2067" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">矢量化实现使我们能够在平均整个训练集的损失的同时，摆脱我们本来会使用的for循环。</p><p id="940c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果这篇文章对你有帮助，可以考虑关注我更多的内容(<a class="ae kc" href="http://www.linkedin.com/in/zain-ehtesham-24086b19b" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae kc" href="https://github.com/MuhammadZainEhtesham" rel="noopener ugc nofollow" target="_blank"> Github </a></p><div class="kd ke ez fb kf kg"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kh ab dw"><div class="ki ab kj cl cj kk"><h2 class="bd hi fi z dy kl ea eb km ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kn l"><h3 class="bd b fi z dy kl ea eb km ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ko l"><p class="bd b fp z dy kl ea eb km ed ef dx translated">medium.com</p></div></div><div class="kp l"><div class="kq l kr ks kt kp ku ji kg"/></div></div></a></div></div></div>    
</body>
</html>