<html>
<head>
<title>What’s Tomorrow Weather ? Rainy or Sunny</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">明天天气如何？下雨还是晴天</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/whats-tomorrow-weather-rainy-or-sunny-82f8c2672a39?source=collection_archive---------4-----------------------#2022-08-23">https://medium.com/mlearning-ai/whats-tomorrow-weather-rainy-or-sunny-82f8c2672a39?source=collection_archive---------4-----------------------#2022-08-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/660e51d152cb8b150f580dea740e25ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aOOvh_3YvXq1cxLTtWUXRw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Image by <a class="ae it" href="https://pixabay.com/photos/rain-street-city-port-1479303/" rel="noopener ugc nofollow" target="_blank">pixabay</a></figcaption></figure><p id="656c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们所有人都肯定对明天要做什么有某种计划(尽管不一定完美)。但有时生活并不按照我们的方式发展，我相信我们中的一些人在前一天的郊游计划后经历了一个下雨和暴风雨的一天(我知道这很糟糕，但我们仍然必须继续前进)。</p><p id="f3a5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，我认为如果你们目前正在工作或学习数据科学，我相信你们会在没有意识到之前遇到天气预报模型。</p><p id="3ac2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在本文中，我将展示如何利用朴素贝叶斯和Python来开发我们自己的天气预测模型(为了更好的明天)。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="2a81" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">指导方针:</p><ol class=""><li id="d83c" class="jz ka hh iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">数据预处理</li><li id="b219" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">模型开发</li><li id="9bf2" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">模型检验</li></ol><h2 id="6205" class="kn ko hh bd kp kq kr ks kt ku kv kw kx jf ky kz la jj lb lc ld jn le lf lg lh bi translated">1.数据预处理</h2><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="9084" class="kn ko hh ln b fi lr ls l lt lu">df = pd.read_csv('/kaggle/input/weather-prediction/seattle-weather.csv')</span><span id="042e" class="kn ko hh ln b fi lv ls l lt lu">df['weather'].unique()</span></pre><figure class="li lj lk ll fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lw"><img src="../Images/6e4e2470fe571d4ab36f3f39a54cfbe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MTdnYVdt-ezGmzOp4toD-A.png"/></div></div></figure><p id="2e3c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">嗯，这是相当的天气，如果你是我，那么我总是计划我的一天，如果明天是晴天。</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="dd55" class="kn ko hh ln b fi lr ls l lt lu">from sklearn.preprocessing import LabelEncoder</span><span id="6737" class="kn ko hh ln b fi lv ls l lt lu">#Turn our Text Values into numeric Values ( e.g. 1,2,3,etc )<br/>le = LabelEncoder()</span><span id="6b70" class="kn ko hh ln b fi lv ls l lt lu">df['weather_label'] = le.fit_transform(df['weather'])</span><span id="1436" class="kn ko hh ln b fi lv ls l lt lu">#Store labels and name for final use<br/>weather_dict = dict(zip(df['weather_label'], df['weather']))</span><span id="873a" class="kn ko hh ln b fi lv ls l lt lu">#Preprocess Datetime Columns<br/>def date_time(df) :<br/>    <br/>    df['date'] = pd.to_datetime(df['date'])<br/>    df['year'] = df['date'].dt.year #Generate Year Column<br/>    df['month'] = df['date'].dt.month #Generate Month Column<br/>    df['day'] = df['date'].dt.day<br/>    <br/>    return df</span><span id="e3a7" class="kn ko hh ln b fi lv ls l lt lu">df_final = date_time(df)</span><span id="c4be" class="kn ko hh ln b fi lv ls l lt lu">df_final = df_final.drop(['weather'],axis=1).set_index('date')<br/>df_final</span></pre><figure class="li lj lk ll fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lx"><img src="../Images/dafc524e64364c4f9c7559b1622f2936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lQHg2feDSFuQpFiEcgLv8w.png"/></div></div></figure><p id="74fc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，下面是上述代码的摘要:</p><ol class=""><li id="5bc7" class="jz ka hh iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">从我们的数据集，我们可以看到我们的目标值(预测值)是天气，但由于它是文本(或字符串)形式的，我们需要在以后将其转换为机器学习模型的数值。因此，来自sklearn的LabelEncoder会自动将我们现有的文本值转换成数值。</li><li id="bad5" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">我在上面创建的weather_dict对象只是为了在我们的模型开发之后使用，以便它可以转换回天气的名称。或者你可以使用LabelEncoder的inverse_transform。</li><li id="9c12" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">最后，我们使用上面的date列生成一些额外的列，并删除模型中未使用的列。</li></ol><h2 id="f457" class="kn ko hh bd kp kq kr ks kt ku kv kw kx jf ky kz la jj lb lc ld jn le lf lg lh bi translated">2.模型开发</h2><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="a7c2" class="kn ko hh ln b fi lr ls l lt lu">from sklearn.model_selection import train_test_split<br/>from sklearn.naive_bayes import GaussianNB<br/>from imblearn.over_sampling import SMOTE<br/>from imblearn.under_sampling import RandomUnderSampler<br/>from sklearn.metrics import accuracy_score, classification_report</span><span id="bf89" class="kn ko hh ln b fi lv ls l lt lu">#Preprocess Data for Machine Learning Development<br/>X = df_final.drop(['weather_label'], axis = 1)<br/>y = df_final['weather_label']</span><span id="6097" class="kn ko hh ln b fi lv ls l lt lu">over_strategy = {0 : 1000, 1 : 1000, 2 : 1000, 3 : 1000, 4 : 2000}<br/>under_strategy = {0 : 1000, 1 : 1000, 2 : 1000, 3 : 1000, 4 : 2000}</span><span id="5a8a" class="kn ko hh ln b fi lv ls l lt lu">oversample = SMOTE(sampling_strategy = over_strategy)<br/>undersample = RandomUnderSampler(sampling_strategy = under_strategy)</span><span id="72a9" class="kn ko hh ln b fi lv ls l lt lu">X_final,y = oversample.fit_resample(X,y)<br/>X_final,y = undersample.fit_resample(X_final, y)</span><span id="8403" class="kn ko hh ln b fi lv ls l lt lu">X_train,X_test,y_train,y_test = train_test_split(X_final,y,random_state = 10, test_size = 0.2)</span><span id="64cb" class="kn ko hh ln b fi lv ls l lt lu">#Model Development<br/>model = GaussianNB()</span><span id="2f03" class="kn ko hh ln b fi lv ls l lt lu">np.random.seed(10)<br/>model.fit(X_train,y_train)</span><span id="f347" class="kn ko hh ln b fi lv ls l lt lu">pred_all = model.predict(X_final)<br/>pred_train = model.predict(X_train)<br/>pred_test = model.predict(X_test)</span><span id="5d24" class="kn ko hh ln b fi lv ls l lt lu">print(f'Accuracy Score on All Data : {round(accuracy_score(y, pred_all),2)*100}')<br/>print(f'Accuracy Score on Train Data : {round(accuracy_score(y_train, pred_train),2)*100}')<br/>print(f'Accuracy Score on Test Data : {round(accuracy_score(y_test, pred_test),2)*100}')</span></pre><figure class="li lj lk ll fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/70f34ebbb600777ef5a4cd0bb43bbc6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*dTivBXwzuGCQ3GfJdPZ90A.png"/></div></figure><p id="c437" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是对上述过程的描述:</p><ol class=""><li id="753d" class="jz ka hh iw b ix iy jb jc jf kb jj kc jn kd jr ke kf kg kh bi translated">首先，我们将数据集分为特征和目标变量。</li><li id="eb0f" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">然后，您可以看到我使用了sklearn.over_sampling和sklearn.under_sampling中的两个函数，我使用这两个函数的主要原因是，由于原始数据提供了一个不平衡的类(这会影响我们的模型性能)，所以我希望用平衡的类来训练所有数据集。</li><li id="4909" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">然后，转换我们的数据集，并使用SMOTE(来自过采样)和RandomUnderSampler(来自欠采样)进行重新采样。并使用train_test_split将我们的数据集分为训练和测试。</li><li id="1faf" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">接下来，我们开始使用sklearn.naive_bayes中的GaussianNB()构建我们的模型，然后我们简单地使用我们的训练集训练我们的数据，然后使用测试数据集上的模型进行预测。</li><li id="2176" class="jz ka hh iw b ix ki jb kj jf kk jj kl jn km jr ke kf kg kh bi translated">最后，我们使用测试集来评估我们的模型。</li></ol><p id="3ccc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，我们可以看到，上述所有分数的输出都是74%，这可以被视为一个好模型，因为它没有过度适应我们的训练集，为了更好地细分我们的每个目标类，这里是细分。</p><figure class="li lj lk ll fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lz"><img src="../Images/055d3a4bbf7a037aa9afa7557487e8c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1bpcu7U3Wx7m_HaMO8bUnA.png"/></div></div></figure><p id="2215" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以看到，我们的模型对天气2和3(雨和雪)的预测精度和f1值超过90%，而对其余天气的预测精度和f1值平均为65%。</p><p id="bfdc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最初，在我写这篇文章之前，我开发了这个没有任何重采样方法的模型，它在训练集上产生了85%的准确性，而在我们的测试数据集上只有54%(这显然表明我们的模型超过了我们的数据)。在我们使用SMOTE和RandomUnderSampler对其进行重采样后，模型稳定下来，并在预测未知数据时显示出更好的模型性能。</p><p id="c519" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">好了，我希望这个天气预报模型可以帮助你们计划一个更好的明天！</p><p id="ccef" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，如果你喜欢阅读我的文章，请随时订阅我的时事通讯，我计划每月发布两次(或更多)新的阅读。</p><p id="5cba" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你有任何意见或反馈，请给我。下一篇文章再见！</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="675a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">参考资料:</p><div class="ma mb ez fb mc md"><a href="https://www.kaggle.com/kelvinprawtama/weather-prediction-using-naive-bayes-algorithm" rel="noopener  ugc nofollow" target="_blank"><div class="me ab dw"><div class="mf ab mg cl cj mh"><h2 class="bd hi fi z dy mi ea eb mj ed ef hg bi translated">基于朴素贝叶斯算法的天气预测</h2><div class="mk l"><h3 class="bd b fi z dy mi ea eb mj ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自天气预测的数据</h3></div><div class="ml l"><p class="bd b fp z dy mi ea eb mj ed ef dx translated">www.kaggle.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr in md"/></div></div></a></div><div class="ma mb ez fb mc md"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="me ab dw"><div class="mf ab mg cl cj mh"><h2 class="bd hi fi z dy mi ea eb mj ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mk l"><h3 class="bd b fi z dy mi ea eb mj ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ml l"><p class="bd b fp z dy mi ea eb mj ed ef dx translated">medium.com</p></div></div><div class="mm l"><div class="ms l mo mp mq mm mr in md"/></div></div></a></div></div></div>    
</body>
</html>