<html>
<head>
<title>Dive into Medical Imaging: X-ray Image Augmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ·±å…¥åŒ»å­¦æˆåƒ:Xå°„çº¿å›¾åƒå¢å¼º</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/dive-into-medical-imaging-image-augmentation-approach-4cfad0f306e3?source=collection_archive---------0-----------------------#2021-08-22">https://medium.com/mlearning-ai/dive-into-medical-imaging-image-augmentation-approach-4cfad0f306e3?source=collection_archive---------0-----------------------#2021-08-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c053" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jc translated">åœ¨æˆ‘ç ”ç©¶ç”Ÿæ¶¯çš„æ—©æœŸï¼Œæˆ‘å¿…é¡»ä¸ºåŸºäºäººå·¥æ™ºèƒ½(AI)çš„åŒ»å­¦æˆåƒç ”ç©¶åšå‡ºé‡å¤§è´¡çŒ®ï¼Œä»é‚£æ—¶èµ·ï¼Œæˆ‘çš„åŒ»å­¦æˆåƒä¹‹æ—…å¼€å§‹äº†ã€‚æœ¬æ–‡å°†è®¨è®ºåŒ»å­¦å›¾åƒå¢å¼ºçš„ç†è®ºå’Œå®é™…å®ç°ã€‚</p><p id="d311" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ¢ç´¢è¿™ç¯‡æ–‡ç« åä½ ä¼šçŸ¥é“ä»€ä¹ˆï¼Ÿ</strong></p><ul class=""><li id="43d6" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">ç”¨äºåŒ»å­¦æˆåƒçš„äººå·¥æ™ºèƒ½</li><li id="8147" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">åŒ»å­¦å›¾åƒå¢å¼ºèƒŒåçš„ç†è®º</li><li id="f6ec" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">æ–°å† è‚ºç‚å›¾åƒæ•°æ®é›†ä¸Šçš„å®é™…å®ç°</li></ul><div class="jz ka kb kc fd ab cb"><figure class="kd ke kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/8912c4e36d163912b683718fa8d2b6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*U3AGh7b9IQ9bsL7Lw5S1CA.png"/></div></figure><figure class="kd ke kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/f9cc3d90371d03febe15754e6593ea46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*XwuzBLmI6-inj7xjrg8DkQ.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx ku di kv kw"><strong class="bd kx">Figure 1: Sample dataset for experimenting (Covid-19 based medical image data)</strong></figcaption></figure></div><blockquote class="ky"><p id="bbd1" class="kz la hh bd lb lc ld le lf lg lh jb dx translated">è®©æˆ‘ä»¬æ·±å…¥æ•°æ®é©±åŠ¨çš„ä¸–ç•Œ</p></blockquote><p id="e742" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated">æœ‰äº†ç§‘æŠ€çš„å…´èµ·ï¼Œå·¥ç§ä¹Ÿåœ¨ä¸æ–­å˜åŒ–ï¼›ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬çœ‹çš„ç¨å¾®å¥½ä¸€ç‚¹ï¼Œå°±ä¼šè§‚å¯Ÿåˆ°äººå·¥æ™ºèƒ½çš„åº”ç”¨è¶Šæ¥è¶Šæ— å¤„ä¸åœ¨ã€‚</p><p id="016e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jc translated"><span class="l jd je jf bm jg jh ji jj jk di">åš</span> <em class="ln">ä½ çŸ¥é“ç°åœ¨çš„ç”µè„‘æœ‰å¤šå¼ºå¤§å—ï¼Ÿ</em>ğŸ¤¨ ğŸ¤¨ ğŸ¤¨</p><p id="2d76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">è®¡ç®—æœºç°åœ¨æ­£æˆä¸ºä¸€ç§å¼ºæœ‰åŠ›çš„æ­¦å™¨ï¼Œå®ƒåœ¨åŒ»ç–—é¢†åŸŸæœ‰æ½œåœ¨çš„åº”ç”¨ã€‚åœ¨åŒ»ç–—ä¿å¥é¢†åŸŸçš„ç ”ç©¶ä¸­ï¼Œå·²ç»å‘ç°äº†å‡ ç§é«˜çº§ç®—æ³•ï¼Œå¯ä»¥è¯»å–ç¡¬å›¾åƒï¼Œå¦‚Xå°„çº¿ã€CTæ‰«æç­‰ã€‚æˆ‘ä»¬ä¸å¿…è¿‡äºä¾èµ–åŒ»ç”Ÿï¼Œå› ä¸ºäººå·¥æ™ºèƒ½çš„åº”ç”¨ä½¿æˆ‘ä»¬çš„ç”Ÿæ´»å˜å¾—æ›´åŠ è½»æ¾ã€‚å…ˆè¯´åŒ»å­¦å½±åƒçš„AIã€‚</p><blockquote class="ky"><p id="0ec8" class="kz la hh bd lb lc lo lp lq lr ls jb dx translated"><strong class="ak">ç”¨äºåŒ»å­¦æˆåƒçš„äººå·¥æ™ºèƒ½</strong></p></blockquote><p id="0ae5" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated">äººå·¥æ™ºèƒ½(AI)åœ¨è¯Šæ–­åŒ»å­¦æˆåƒä¸­çš„åº”ç”¨æ­£åœ¨ç»å†å½»åº•çš„è€ƒè™‘ã€‚ä¾‹å¦‚ï¼Œè®¡ç®—æœºè¾…åŠ©ç®—æ³•å¯ä»¥æ£€æŸ¥xå°„çº¿å’Œå…¶ä»–å›¾åƒä¸­æŒ‡ç¤ºè‚ºç‚çš„ä¸é€æ˜è¿¹è±¡ï¼Œç„¶åæé†’åŒ»ç”Ÿæ½œåœ¨çš„è¯Šæ–­ï¼Œä»¥ä¾¿åœ¨æ€€ç–‘æœ‰æ°”èƒ¸æ—¶æ›´å¿«åœ°è¿›è¡Œæ²»ç–—ï¼Œäººå·¥æ™ºèƒ½å¯ä»¥å¸®åŠ©è¯†åˆ«é«˜é£é™©ä¸ªä½“ï¼Œç‰¹åˆ«æ˜¯åœ¨æ”¾å°„ç§‘åŒ»ç”Ÿä¸åœ¨åœºçš„æƒ…å†µä¸‹ã€‚</p><blockquote class="ky"><p id="9301" class="kz la hh bd lb lc lo lp lq lr ls jb dx translated">åŒ»å­¦å›¾åƒå¢å¼ºèƒŒåçš„ç†è®º</p></blockquote><p id="d687" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated">ä¸ºäº†æ·±å…¥ç ”ç©¶å›¾åƒå¢å¼ºï¼Œéœ€è¦äº†è§£æˆ‘ä»¬åœ¨å¤„ç†åŒ»å­¦å›¾åƒæ•°æ®æ—¶å¯èƒ½ä¼šé‡åˆ°çš„æŒ‘æˆ˜ã€‚æ›´ç®€å•åœ°è¯´ï¼ŒæŸ¥æ‰¾åŒ»å­¦å›¾åƒæ•°æ®ç›¸å¯¹å›°éš¾ï¼Œå› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯è®¿é—®æ€§æ˜¯ä¸€ä¸ªéå¸¸å€¼å¾—å…³æ³¨çš„é—®é¢˜ã€‚å…¶æ¬¡ï¼Œè·å–å¤§é‡çš„æ•°æ®é›†æ˜¯ç›¸å½“å…·æœ‰æŒ‘æˆ˜æ€§çš„ï¼Œå› ä¸ºè¿™ç§ç±»å‹çš„æ•æ„Ÿæ•°æ®é€šå¸¸ä¸å…¬å¼€ã€‚æœºå™¨å­¦ä¹ éœ€è¦å¤§é‡æ•°æ®æ‰èƒ½å·¥ä½œï¼Œè¿™å½“ç„¶æ²¡é”™ï¼›å¦åˆ™ï¼Œåˆ›å»ºå¥å£®çš„æ¨¡å‹å˜å¾—éå¸¸å›°éš¾ï¼Œå¹¶ä¸”å¦‚æœåŒ»å­¦å›¾åƒæ•°æ®æ˜¯è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆæ•°æ®å¤§å°å¿…é¡»å¢åŠ ã€‚å‡è®¾ä½ æœ‰1000ä¸ªå›¾åƒæ•°æ®ï¼Œä½†ä¸çŸ¥ä½•æ•…å¦‚æœèƒ½æˆåŠŸæ‰©å±•åˆ°2000ä¸ªæ ·æœ¬ï¼Œé‚£å°±æ›´æœ‰æ„æ€äº†å§ï¼Ÿ</p><p id="6342" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ‰€ä»¥ï¼Œå›¾åƒå¢å¼ºå°±æ˜¯è¿™æ ·ä¸€ç§æ–¹æ³•ï¼Œé€šè¿‡å®ƒä½ å¯ä»¥å¢åŠ ä½ çš„æ•°æ®æ ·æœ¬ï¼›é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å°†èƒ½å¤Ÿæœ‰æ•ˆåœ°è®­ç»ƒä½ çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚</strong></p><p id="0c94" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">è¦ä½¿ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•è·å¾—å‡†ç¡®çš„ç»“æœï¼Œéœ€è¦å¤§é‡çš„æ•°æ®ã€‚å¯ä»¥é€šè¿‡å„ç§æ–¹å¼æ¥æ‰©å……å›¾åƒï¼Œä»¥æ‰©å¤§æ•°æ®é›†å’Œæ ·æœ¬å¤§å°ã€‚åœ¨å¤„ç†å…³é”®åŒ»å­¦å›¾åƒæ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¯é çš„ç­–ç•¥ï¼Œå› ä¸ºåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¦‚æœæ•°æ®é‡ä¸è¶³ï¼Œæ¨¡å‹çš„å‡†ç¡®æ€§ä¸ä¼šæé«˜ã€‚é™¤äº†å‡å°‘è¿‡åº¦æ‹Ÿåˆï¼Œå¢å¼ºè¿˜å¯ä»¥æé«˜æ‚¨æå‡ºçš„æ¨¡å‹çš„ç²¾åº¦ã€‚</p><blockquote class="ky"><p id="9f7c" class="kz la hh bd lb lc lo lp lq lr ls jb dx translated">æ–°å† è‚ºç‚å›¾åƒæ•°æ®é›†ä¸Šçš„å®é™…å®ç°</p></blockquote><p id="cb70" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated"><strong class="ig hi">æ­¥éª¤01:å…‹éš†æ–°å† è‚ºç‚å›¾åƒæ•°æ®é›†</strong></p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="0910" class="ly lz hh lu b fi ma mb l mc md">!git clone https://github.com/casperbh96/COVID-19-Detection.git dataset</span></pre><p id="a6fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ­¥éª¤02:å¯¼å…¥åŸºæœ¬åº“</strong></p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="9809" class="ly lz hh lu b fi ma mb l mc md">import pandas as pd</span><span id="130a" class="ly lz hh lu b fi me mb l mc md">import matplotlib.pyplot as plt</span><span id="9bd8" class="ly lz hh lu b fi me mb l mc md">%matplotlib inline</span><span id="44c5" class="ly lz hh lu b fi me mb l mc md">import numpy as np</span><span id="5521" class="ly lz hh lu b fi me mb l mc md">import cv2, time</span><span id="9a55" class="ly lz hh lu b fi me mb l mc md">import tensorflow as tf</span><span id="6146" class="ly lz hh lu b fi me mb l mc md">tf.__version__</span></pre><p id="adc3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ­¥éª¤03:åŠ è½½æ–°å† è‚ºç‚æ•°æ®é›†</strong></p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="193c" class="ly lz hh lu b fi ma mb l mc md">covid_path = 'dataset/covid_dataset.csv'</span><span id="2e3b" class="ly lz hh lu b fi me mb l mc md">covid_image_path = 'dataset/covid_adjusted/'</span><span id="57ec" class="ly lz hh lu b fi me mb l mc md">normal_path = 'dataset/normal_xray_dataset.csv'</span><span id="635d" class="ly lz hh lu b fi me mb l mc md">normal_image_path = 'dataset/normal_dataset/'</span><span id="7fe4" class="ly lz hh lu b fi me mb l mc md">covid_df = pd.read_csv(covid_path, usecols=['filename', 'finding'])</span><span id="4f1b" class="ly lz hh lu b fi me mb l mc md">normal_df = pd.read_csv(normal_path, usecols=['filename', 'finding'])</span><span id="6f42" class="ly lz hh lu b fi me mb l mc md">normal_df = normal_df.head(99)</span><span id="32b3" class="ly lz hh lu b fi me mb l mc md">covid_df.head()</span></pre><p id="e583" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œä¸€äº›é¢å¤–çš„å·¥ä½œ</p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="f019" class="ly lz hh lu b fi ma mb l mc md">covid_images = []</span><span id="428b" class="ly lz hh lu b fi me mb l mc md">covid_labels = []</span><span id="4a24" class="ly lz hh lu b fi me mb l mc md">for index, row in covid_df.iterrows():</span><span id="76f1" class="ly lz hh lu b fi me mb l mc md">filename = row['filename']</span><span id="8cb9" class="ly lz hh lu b fi me mb l mc md">label = row['finding']</span><span id="d494" class="ly lz hh lu b fi me mb l mc md">path = covid_image_path + filename</span><span id="d573" class="ly lz hh lu b fi me mb l mc md">image = cv2.imread(path)</span><span id="0104" class="ly lz hh lu b fi me mb l mc md">image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)</span><span id="d26b" class="ly lz hh lu b fi me mb l mc md">covid_images.append(image)</span><span id="338b" class="ly lz hh lu b fi me mb l mc md">covid_labels.append(label)</span><span id="caf7" class="ly lz hh lu b fi me mb l mc md">normal_images = []</span><span id="89fc" class="ly lz hh lu b fi me mb l mc md">normal_labels = []</span><span id="61d6" class="ly lz hh lu b fi me mb l mc md">for index, row in normal_df.iterrows():</span><span id="4100" class="ly lz hh lu b fi me mb l mc md">filename = row['filename']</span><span id="7b00" class="ly lz hh lu b fi me mb l mc md">label = row['finding']</span><span id="a8af" class="ly lz hh lu b fi me mb l mc md">path = normal_image_path + filename</span><span id="31a1" class="ly lz hh lu b fi me mb l mc md"># temporary fix while we preprocess ALL the images</span><span id="0e99" class="ly lz hh lu b fi me mb l mc md">if filename == '4c268764-b5e5-4417-85a3-da52916984d8.jpg':</span><span id="2e75" class="ly lz hh lu b fi me mb l mc md">break</span><span id="69ce" class="ly lz hh lu b fi me mb l mc md">image = cv2.imread(path)</span><span id="2c84" class="ly lz hh lu b fi me mb l mc md">image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)</span><span id="a5ae" class="ly lz hh lu b fi me mb l mc md">normal_images.append(image)</span><span id="dc15" class="ly lz hh lu b fi me mb l mc md">normal_labels.append(label)</span><span id="f766" class="ly lz hh lu b fi me mb l mc md"># normalize to interval of [0,1]</span><span id="42f8" class="ly lz hh lu b fi me mb l mc md">covid_images = np.array(covid_images) / 255</span><span id="16a0" class="ly lz hh lu b fi me mb l mc md"># normalize to interval of [0,1]</span><span id="9ee4" class="ly lz hh lu b fi me mb l mc md">normal_images = np.array(normal_images) / 255</span></pre><p id="22a9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ­¥éª¤04:æˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªå¯è§†åŒ–å›¾åƒçš„å‡½æ•°</strong></p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="1cc5" class="ly lz hh lu b fi ma mb l mc md">def plot_images(images, title):</span><span id="a7e9" class="ly lz hh lu b fi me mb l mc md">nrows, ncols = 3, 8</span><span id="554d" class="ly lz hh lu b fi me mb l mc md">figsize = [10, 6]</span><span id="811e" class="ly lz hh lu b fi me mb l mc md">fig, ax = plt.subplots(nrows=nrows, ncols=ncols, figsize=figsize, facecolor=(1, 1, 1))</span><span id="e28a" class="ly lz hh lu b fi me mb l mc md">for i, axi in enumerate(ax.flat):</span><span id="c15f" class="ly lz hh lu b fi me mb l mc md">axi.imshow(images[i])</span><span id="773c" class="ly lz hh lu b fi me mb l mc md">axi.set_axis_off()</span><span id="18bc" class="ly lz hh lu b fi me mb l mc md">plt.suptitle(title, fontsize=24)</span><span id="ad0d" class="ly lz hh lu b fi me mb l mc md">plt.tight_layout(pad=0.2, rect=[0, 0, 1, 0.9])</span><span id="af45" class="ly lz hh lu b fi me mb l mc md">plt.show()</span><span id="4dc3" class="ly lz hh lu b fi me mb l mc md">plot_images(covid_images, 'Positive COVID-19 Cases')</span><span id="0d36" class="ly lz hh lu b fi me mb l mc md">plot_images(normal_images, 'Negative COVID-19 Cases')</span></pre><p id="aab8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ‰§è¡Œæ­¥éª¤04åï¼Œæ‚¨å°†ä¼šçœ‹åˆ°ä»¥ä¸‹å›¾åƒâ†’ </strong></p><div class="jz ka kb kc fd ab cb"><figure class="kd ke kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/8912c4e36d163912b683718fa8d2b6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*U3AGh7b9IQ9bsL7Lw5S1CA.png"/></div></figure><figure class="kd ke kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/f9cc3d90371d03febe15754e6593ea46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*XwuzBLmI6-inj7xjrg8DkQ.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx ku di kv kw"><strong class="bd kx">Figure 2: Negative and Positive Covid-19 cases images</strong></figcaption></figure></div><p id="cb54" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ­¥éª¤05:å°†æ•°æ®é›†åˆ†æˆæµ‹è¯•å’Œè®­ç»ƒ</strong></p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="d6ff" class="ly lz hh lu b fi ma mb l mc md">from sklearn.model_selection import train_test_split</span><span id="b37a" class="ly lz hh lu b fi me mb l mc md">from sklearn.preprocessing import LabelBinarizer</span><span id="aa72" class="ly lz hh lu b fi me mb l mc md">from tensorflow.keras.utils import to_categorical</span><span id="894a" class="ly lz hh lu b fi me mb l mc md"># split into training and testing</span><span id="9a21" class="ly lz hh lu b fi me mb l mc md">covid_x_train, covid_x_test, covid_y_train, covid_y_test = train_test_split(</span><span id="79f7" class="ly lz hh lu b fi me mb l mc md">covid_images, covid_labels, test_size=0.2)</span><span id="afbf" class="ly lz hh lu b fi me mb l mc md">normal_x_train, normal_x_test, normal_y_train, normal_y_test = train_test_split(</span><span id="b5f7" class="ly lz hh lu b fi me mb l mc md">normal_images, normal_labels, test_size=0.2)</span><span id="b3e1" class="ly lz hh lu b fi me mb l mc md">X_train = np.concatenate((normal_x_train, covid_x_train), axis=0)</span><span id="83cc" class="ly lz hh lu b fi me mb l mc md">X_test = np.concatenate((normal_x_test, covid_x_test), axis=0)</span><span id="c827" class="ly lz hh lu b fi me mb l mc md">y_train = np.concatenate((normal_y_train, covid_y_train), axis=0)</span><span id="c4ee" class="ly lz hh lu b fi me mb l mc md">y_test = np.concatenate((normal_y_test, covid_y_test), axis=0)</span><span id="47b0" class="ly lz hh lu b fi me mb l mc md"># make labels into categories - either 0 or 1</span><span id="a9d2" class="ly lz hh lu b fi me mb l mc md">y_train = LabelBinarizer().fit_transform(y_train)</span><span id="78f3" class="ly lz hh lu b fi me mb l mc md">y_train = to_categorical(y_train)</span><span id="be77" class="ly lz hh lu b fi me mb l mc md">y_test = LabelBinarizer().fit_transform(y_test)</span><span id="cc57" class="ly lz hh lu b fi me mb l mc md">y_test = to_categorical(y_test)</span></pre><p id="3ac5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ­¥éª¤06: </strong>åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€äº›å‡½æ•°æ¥å¢å¼ºæˆ‘ä»¬çš„æ–°å† è‚ºç‚å›¾åƒã€‚å¦‚ä½ æ‰€çŸ¥ï¼Œåœ¨å›¾åƒå¢å¼ºæ–¹é¢å¯ä»¥æ‰¾åˆ°å‡ ç§ä¼ ç»Ÿçš„æ–¹æ³•ã€‚å°½ç®¡å¦‚æ­¤ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œå¯¹æ¯”åº¦ï¼Œé¥±å’Œåº¦ï¼Œä¸Šä¸‹ç¿»è½¬å’Œæ—‹è½¬å·²ç»è¢«è€ƒè™‘ï¼Œå› ä¸ºè¿™äº›æ˜¯æœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚</p><p id="7717" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ–¹æ³•01:å¯¹æ¯”</strong></p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="224c" class="ly lz hh lu b fi ma mb l mc md">X_train_contrast = []</span><span id="90f3" class="ly lz hh lu b fi me mb l mc md">for x in X_train:</span><span id="387d" class="ly lz hh lu b fi me mb l mc md">contrast = tf.image.adjust_contrast( x, 2 ) #It takes two parameter: Images and constrast_factor.</span><span id="b84a" class="ly lz hh lu b fi me mb l mc md">#Images:Images to adjust. At least 3-D.</span><span id="8479" class="ly lz hh lu b fi me mb l mc md">#Constrast_factor:A float multiplier for adjusting contrast.</span><span id="4ab7" class="ly lz hh lu b fi me mb l mc md">X_train_contrast.append(contrast.numpy())</span><span id="8725" class="ly lz hh lu b fi me mb l mc md">plot_images(X_train_contrast, 'Adjusted Contrast')</span></pre><p id="5281" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ‰§è¡Œæ–¹æ³•01åï¼Œæ‚¨å°†è§‚å¯Ÿåˆ°ä»¥ä¸‹å›¾åƒâ†’ </strong></p><figure class="jz ka kb kc fd ke er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es mf"><img src="../Images/0c314ee39518a39e479e2bfbff91fb88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TkgN7NDtqL_mS1ha1Uajg.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx"><strong class="bd kx">Figure 3: Applying the image augmentation approach, e.g. Contrast</strong></figcaption></figure><p id="6c76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æ–¹æ³•02:é¥±å’Œåº¦</p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="8967" class="ly lz hh lu b fi ma mb l mc md">X_train_saturation = []</span><span id="e8d1" class="ly lz hh lu b fi me mb l mc md">for x in X_train:</span><span id="b438" class="ly lz hh lu b fi me mb l mc md">saturation = tf.image.adjust_saturation( x, 3 )</span><span id="0500" class="ly lz hh lu b fi me mb l mc md">X_train_saturation.append(saturation.numpy())</span><span id="90cf" class="ly lz hh lu b fi me mb l mc md">plot_images(X_train_saturation, 'Adjusted Saturation')</span></pre><p id="3987" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ‰§è¡Œæ–¹æ³•02åï¼Œæ‚¨å°†è§‚å¯Ÿåˆ°ä»¥ä¸‹å›¾åƒâ†’ </strong></p><figure class="jz ka kb kc fd ke er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es mf"><img src="../Images/0c314ee39518a39e479e2bfbff91fb88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TkgN7NDtqL_mS1ha1Uajg.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx"><strong class="bd kx">Figure 4: Performing the image augmentation approach, e.g. Saturation</strong></figcaption></figure><p id="6a45" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ–¹æ³•03:ä¸Šä¸‹ç¿»è½¬</strong></p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="c09c" class="ly lz hh lu b fi ma mb l mc md">X_train_flipped_up_down = []</span><span id="3e9c" class="ly lz hh lu b fi me mb l mc md">for x in X_train:</span><span id="33a1" class="ly lz hh lu b fi me mb l mc md">flipped = tf.image.flip_up_down(x)</span><span id="7670" class="ly lz hh lu b fi me mb l mc md">X_train_flipped_up_down.append(flipped.numpy())</span><span id="6b33" class="ly lz hh lu b fi me mb l mc md">plot_images(X_train_flipped_up_down, 'Flipped Up Down')</span></pre><figure class="jz ka kb kc fd ke er es paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><div class="er es mf"><img src="../Images/7e201c657370af0319519f4a20106113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OW2gnOcn_9KmRnGPQYSRqA.png"/></div></div><figcaption class="kq kr et er es ks kt bd b be z dx"><strong class="bd kx">Figure 5: Visualizing the augmented images, e.g. Flipped up-down</strong></figcaption></figure><p id="affc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ–¹æ³•04: </strong>åº”ç”¨æ—‹è½¬æŠ€æœ¯ã€‚è¿™é‡Œæˆ‘è€ƒè™‘è¿‡45åº¦ï¼Œ135åº¦ï¼Œ225åº¦ï¼Œ315åº¦ã€‚</p><pre class="jz ka kb kc fd lt lu lv lw aw lx bi"><span id="5da4" class="ly lz hh lu b fi ma mb l mc md">import tensorflow_addons as tfa</span><span id="2a64" class="ly lz hh lu b fi me mb l mc md">from math import radians</span><span id="6cc1" class="ly lz hh lu b fi me mb l mc md">X_train_rot_45_deg = []</span><span id="02b8" class="ly lz hh lu b fi me mb l mc md">X_train_rot_135_deg = []</span><span id="a6a9" class="ly lz hh lu b fi me mb l mc md">X_train_rot_225_deg = []</span><span id="7bf7" class="ly lz hh lu b fi me mb l mc md">X_train_rot_315_deg = []</span><span id="3427" class="ly lz hh lu b fi me mb l mc md">for x in X_train:</span><span id="de1a" class="ly lz hh lu b fi me mb l mc md">deg_45 = tfa.image.transform_ops.rotate(image, radians(45))</span><span id="66ce" class="ly lz hh lu b fi me mb l mc md">deg_135 = tfa.image.transform_ops.rotate(image, radians(135))</span><span id="b5ec" class="ly lz hh lu b fi me mb l mc md">deg_225 = tfa.image.transform_ops.rotate(image, radians(225))</span><span id="827e" class="ly lz hh lu b fi me mb l mc md">deg_315 = tfa.image.transform_ops.rotate(image, radians(315))</span><span id="8915" class="ly lz hh lu b fi me mb l mc md">X_train_rot_45_deg.append(deg_45)</span><span id="33f7" class="ly lz hh lu b fi me mb l mc md">X_train_rot_135_deg.append(deg_135)</span><span id="e37e" class="ly lz hh lu b fi me mb l mc md">X_train_rot_225_deg.append(deg_225)</span><span id="9453" class="ly lz hh lu b fi me mb l mc md">X_train_rot_315_deg.append(deg_315)</span><span id="9ac6" class="ly lz hh lu b fi me mb l mc md">plot_images(X_train_rot_45_deg, 'Rotated 45 Degrees')</span><span id="fc77" class="ly lz hh lu b fi me mb l mc md">plot_images(X_train_rot_135_deg, 'Rotated 135 Degrees')</span><span id="0d5b" class="ly lz hh lu b fi me mb l mc md">plot_images(X_train_rot_225_deg, 'Rotated 225 Degrees')</span><span id="15f0" class="ly lz hh lu b fi me mb l mc md">plot_images(X_train_rot_315_deg, 'Rotated 315 Degrees')</span></pre><div class="jz ka kb kc fd ab cb"><figure class="kd ke kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/775cb1eeb6519ccd3dee611c04ed1309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*wKPtHW3_5aMnuWOFGZvKQg.png"/></div></figure><figure class="kd ke kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/1a7c016efb471527b9d51d5cf3fface4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Q-Q_CtpLOzhGN4JG49JYjQ.png"/></div></figure></div><div class="ab cb"><figure class="kd ke kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/969de850e9b638418c58a714cafebbd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*HBDPF1r5u-la49GW_sJoQw.png"/></div></figure><figure class="kd ke kf kg kh ki kj paragraph-image"><div role="button" tabindex="0" class="kk kl di km bf kn"><img src="../Images/9a392e203953c4aee778f5eb0ef90080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*J4kxq2OyDtFtOOEO-Oy-9Q.png"/></div><figcaption class="kq kr et er es ks kt bd b be z dx ku di kv kw"><strong class="bd kx">Figure 6: Visualizing the augmented images, e.g. Rotated 135 degrees, 45 degrees, 225 degrees and 315 degrees</strong></figcaption></figure></div><p id="015d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jc translated">æ€»ä¹‹ï¼Œæœ¬æ–‡å±•ç¤ºäº†åŒ»å­¦å›¾åƒå¢å¼ºèƒŒåçš„ç†è®ºå’Œå®é™…å®ç°ã€‚ä¸ºäº†è¿›è¡Œå®éªŒï¼Œæˆ‘ä»¬é‡‡ç”¨äº†æ–°å† è‚ºç‚å›¾åƒæ•°æ®é›†ï¼Œå¹¶è§£é‡Šäº†å¦‚ä½•å¢å¼ºåŒ»å­¦å›¾åƒã€‚æˆ‘åšä¿¡è¿™ç¯‡æ–‡ç« ä¸­æä¾›çš„ä¿¡æ¯å¯¹é‚£äº›æƒ³åœ¨åŒ»ç–—ä¿å¥è¡Œä¸šå¼€å§‹å·¥ä½œçš„äººéå¸¸æœ‰å¸®åŠ©ã€‚</p><p id="3d5a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">ä»æˆ‘çš„Githubåº“æ‰¾åˆ°æºä»£ç :</strong></p><div class="mg mh ez fb mi mj"><a href="https://github.com/eliashossain001/Medium/blob/main/ImageAugmentation.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hi fi z dy mo ea eb mp ed ef hg bi translated">Medium/image augmentation . ipynb at main eliashossain 001/Medium</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">ç”Ÿç‰©åŒ»å­¦æˆåƒæ–¹é¢çš„å®éªŒæºä»£ç </h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">github.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx ko mj"/></div></div></a></div><p id="c770" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">å‚è€ƒæ–‡çŒ®</strong></p><ol class=""><li id="6ada" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb my jr js jt bi translated">Shortenï¼Œc .ï¼Œ&amp; Khoshgoftaarï¼ŒT. M. (2019å¹´)ã€‚é¢å‘æ·±åº¦å­¦ä¹ çš„å›¾åƒæ•°æ®å¢å¼ºç»¼è¿°ã€‚<em class="ln">å¤§æ•°æ®æ‚å¿—</em>ï¼Œ<em class="ln"> 6 </em> (1)ï¼Œ1â€“48ã€‚</li><li id="c6e7" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb my jr js jt bi translated">n . s . punnå’Œs . Agarwal(2021å¹´)ã€‚ä½¿ç”¨å¾®è°ƒæ·±åº¦ç¥ç»ç½‘ç»œåˆ©ç”¨æœ‰é™çš„åå‰èƒ¸éƒ¨Xå°„çº¿å›¾åƒè‡ªåŠ¨è¯Šæ–­æ–°å† è‚ºç‚ã€‚<em class="ln">åº”ç”¨æ™ºèƒ½</em>ï¼Œ<em class="ln"> 51 </em> (5)ï¼Œ2689â€“2702ã€‚</li></ol><p id="8837" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">åˆ°â†’ </strong>æ‰¾æˆ‘</p><p id="f6f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">https://www.researchgate.net/profile/Elias-Hossain-2</p><p id="5800" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">é¢†è‹±:<a class="ae mz" href="https://www.linkedin.com/in/elias-hossain-b70678160/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/elias-hossain-b70678160/</a></p></div></div>    
</body>
</html>