<html>
<head>
<title>A Beginners Guide to Building and Deploying a Container for your ML model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的ML模型构建和部署容器的初学者指南</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/a-beginners-guide-to-building-and-deploying-a-container-for-your-ml-model-3cbc45d16e9f?source=collection_archive---------12-----------------------#2022-07-04">https://medium.com/mlearning-ai/a-beginners-guide-to-building-and-deploying-a-container-for-your-ml-model-3cbc45d16e9f?source=collection_archive---------12-----------------------#2022-07-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><h2 id="aca7" class="hf hg hh bd b fp hi hj hk hl hm hn dx ho translated" aria-label="kicker paragraph">数据科学/部署</h2><div class=""/><div class=""><h2 id="dc35" class="pw-subtitle-paragraph in hq hh bd b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je dx translated">使用Streamlit制作并部署在Heroku上的Web应用程序。</h2></div><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/862116ed99c96d147176b412e8a202b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pt7x9aXPAsZYe539YpoVtg.png"/></div></div></figure><p id="410b" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi kn translated">我在之前的文章中已经讨论过了。现在让我们进行一些实际操作。我们会部署一个叫做House Hunter的机器学习模型。这是一个使用Streamlit制作的房价预测web应用程序。</p><p id="0d48" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">部署容器涉及的不同步骤有</p><ol class=""><li id="1850" class="kw kx hh jt b ju jv jx jy ka ky ke kz ki la km lb lc ld le bi translated">先决条件</li><li id="05b7" class="kw kx hh jt b ju lf jx lg ka lh ke li ki lj km lb lc ld le bi translated">创建Dockerfile文件</li><li id="9121" class="kw kx hh jt b ju lf jx lg ka lh ke li ki lj km lb lc ld le bi translated">建筑形象</li><li id="09d9" class="kw kx hh jt b ju lf jx lg ka lh ke li ki lj km lb lc ld le bi translated">创建Heroku Web应用程序</li><li id="0155" class="kw kx hh jt b ju lf jx lg ka lh ke li ki lj km lb lc ld le bi translated">将映像推送到Heroku上的容器注册表</li><li id="c7a0" class="kw kx hh jt b ju lf jx lg ka lh ke li ki lj km lb lc ld le bi translated">部署容器</li></ol><blockquote class="lk ll lm"><p id="ffd7" class="jr js ln jt b ju jv ir jw jx jy iu jz lo kb kc kd lp kf kg kh lq kj kk kl km ha bi translated">提示:对于每个新的基于Python的项目，有一个新的虚拟环境通常是好的。所以每个项目的依赖关系都是相互隔离的。</p></blockquote><h1 id="d552" class="lr ls hh bd lt lu lv lw lx ly lz ma mb iw mc ix md iz me ja mf jc mg jd mh mi bi translated"><strong class="ak"> 1。先决条件</strong></h1><p id="4ab0" class="pw-post-body-paragraph jr js hh jt b ju mj ir jw jx mk iu jz ka ml kc kd ke mm kg kh ki mn kk kl km ha bi translated">在我们开始构建容器之前，有两个先决条件。它们是:</p><p id="ab6b" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hr"> 1.1。安装Docker桌面</strong></p><p id="65cd" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">你可以参考David Bombal的视频来设置Docker桌面。</p><blockquote class="lk ll lm"><p id="4b29" class="jr js ln jt b ju jv ir jw jx jy iu jz lo kb kc kd lp kf kg kh lq kj kk kl km ha bi translated"><strong class="jt hr"> WSL 2与Docker入门作者大卫·邦巴尔<br/></strong><a class="ae mo" href="https://youtu.be/5RQbdMn04Oc" rel="noopener ugc nofollow" target="_blank">https://youtu.be/5RQbdMn04Oc</a></p></blockquote><p id="3757" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hr"> 1.2。构建一个ML web应用程序(或使用现有的web应用程序)</strong></p><p id="0205" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">在本文中，我们将使用House Hunter web应用程序，它已经部署在Heroku上，因为它低于500MB的限制。现在，我们将尝试将其装箱，然后进行部署。</p><blockquote class="lk ll lm"><p id="791b" class="jr js ln jt b ju jv ir jw jx jy iu jz lo kb kc kd lp kf kg kh lq kj kk kl km ha bi translated"><strong class="jt hr">房屋猎人Github链接<br/></strong><a class="ae mo" href="https://github.com/MSufiyanAG/House-Hunter" rel="noopener ugc nofollow" target="_blank">https://github.com/MSufiyanAG/House-Hunter</a></p></blockquote><p id="08c7" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">所以现在我们已经准备好Docker桌面和ML web应用程序了。</p><h1 id="283b" class="lr ls hh bd lt lu lv lw lx ly lz ma mb iw mc ix md iz me ja mf jc mg jd mh mi bi translated">2.创建Dockerfile文件</h1><p id="e7df" class="pw-post-body-paragraph jr js hh jt b ju mj ir jw jx mk iu jz ka ml kc kd ke mm kg kh ki mn kk kl km ha bi translated">Dockerfile是一个文本文档，它包含用户可以在命令行上调用的所有命令来组合一个图像。使用docker build，用户可以创建一个连续执行几个命令行指令的自动化构建。</p><h2 id="f7c5" class="mp ls hh bd lt mq mr ms lx mt mu mv mb ka mw mx md ke my mz mf ki na nb mh hn bi translated">Dockerfile:</h2><pre class="jg jh ji jj fd nc nd ne nf aw ng bi"><span id="358d" class="mp ls hh nd b fi nh ni l nj nk">FROM python:3.8 </span><span id="45a5" class="mp ls hh nd b fi nl ni l nj nk">COPY . /usr/app/ </span><span id="92a7" class="mp ls hh nd b fi nl ni l nj nk">WORKDIR /usr/app/ </span><span id="e00f" class="mp ls hh nd b fi nl ni l nj nk">RUN pip install -r requirements.txt      </span><span id="748c" class="mp ls hh nd b fi nl ni l nj nk">CMD sh setup.sh \ <br/>    &amp;&amp; streamlit run app.py</span></pre><p id="564d" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hr">从</strong>开始——为后续指令设置基础图像。<br/> <strong class="jt hr">复制</strong>—将源路径的内容复制到目的路径。<br/><strong class="jt hr">WORKDIR</strong>—定义Docker容器的工作目录。<br/> <strong class="jt hr">运行</strong> —它在当前图像之上的新图层中执行任何命令，并提交结果。<br/><strong class="jt hr">CMD</strong>—为正在执行的容器提供默认值。</p><blockquote class="lk ll lm"><p id="abb9" class="jr js ln jt b ju jv ir jw jx jy iu jz lo kb kc kd lp kf kg kh lq kj kk kl km ha bi translated">供参考:<a class="ae mo" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/engine/reference/builder/</a></p></blockquote><h1 id="b80b" class="lr ls hh bd lt lu lv lw lx ly lz ma mb iw mc ix md iz me ja mf jc mg jd mh mi bi translated">3.建筑形象</h1><p id="3096" class="pw-post-body-paragraph jr js hh jt b ju mj ir jw jx mk iu jz ka ml kc kd ke mm kg kh ki mn kk kl km ha bi translated">docker build命令从docker文件构建Docker映像。</p><pre class="jg jh ji jj fd nc nd ne nf aw ng bi"><span id="acf3" class="mp ls hh nd b fi nh ni l nj nk">$ docker build [OPTIONS] PATH | URL | -</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nm"><img src="../Images/a5970794a7e1a0825121f85ff3ca662b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HGHl8WtlORuVX12chxJ7kg.png"/></div></div></figure><p id="2017" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">一旦图像准备就绪，就可以使用命令来查看它</p><pre class="jg jh ji jj fd nc nd ne nf aw ng bi"><span id="bf8c" class="mp ls hh nd b fi nh ni l nj nk">$ docker images [OPTIONS] [REPOSITORY[:TAG]]</span></pre><blockquote class="lk ll lm"><p id="e750" class="jr js ln jt b ju jv ir jw jx jy iu jz lo kb kc kd lp kf kg kh lq kj kk kl km ha bi translated">要了解更多命令，如运行、标记，..<br/><a class="ae mo" href="https://docs.docker.com/engine/reference/commandline/docker/" rel="noopener ugc nofollow" target="_blank">https://docs . docker . com/engine/reference/command line/docker/</a></p></blockquote><h1 id="675a" class="lr ls hh bd lt lu lv lw lx ly lz ma mb iw mc ix md iz me ja mf jc mg jd mh mi bi translated">4.创建Heroku Web应用程序</h1><p id="8052" class="pw-post-body-paragraph jr js hh jt b ju mj ir jw jx mk iu jz ka ml kc kd ke mm kg kh ki mn kk kl km ha bi translated">登录Heroku，Heroku容器注册表</p><pre class="jg jh ji jj fd nc nd ne nf aw ng bi"><span id="e300" class="mp ls hh nd b fi nh ni l nj nk">$ heroku login<br/>$ heroku container:login</span></pre><p id="7ff7" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">现在创建一个新的webapp</p><pre class="jg jh ji jj fd nc nd ne nf aw ng bi"><span id="9e28" class="mp ls hh nd b fi nh ni l nj nk">$ heroku create app-name</span></pre><blockquote class="lk ll lm"><p id="ebbd" class="jr js ln jt b ju jv ir jw jx jy iu jz lo kb kc kd lp kf kg kh lq kj kk kl km ha bi translated">关于命令的详细信息:<br/><a class="ae mo" href="https://devcenter.heroku.com/articles/container-registry-and-runtime" rel="noopener ugc nofollow" target="_blank">https://dev center . heroku . com/articles/container-registry-and-runtime</a></p></blockquote><h1 id="00ac" class="lr ls hh bd lt lu lv lw lx ly lz ma mb iw mc ix md iz me ja mf jc mg jd mh mi bi translated">5.将映像推送到Heroku上的容器注册表</h1><p id="9462" class="pw-post-body-paragraph jr js hh jt b ju mj ir jw jx mk iu jz ka ml kc kd ke mm kg kh ki mn kk kl km ha bi translated">创建一个引用源图像的标记目标图像，该目标图像将被推送到容器注册表。</p><pre class="jg jh ji jj fd nc nd ne nf aw ng bi"><span id="b7e0" class="mp ls hh nd b fi nh ni l nj nk">$ docker tag &lt;image&gt; registry.heroku.com/&lt;app&gt;/&lt;process-type&gt;</span></pre><p id="74a7" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">将此映像推送到容器注册表</p><pre class="jg jh ji jj fd nc nd ne nf aw ng bi"><span id="8432" class="mp ls hh nd b fi nh ni l nj nk">$ docker push registry.heroku.com/&lt;app&gt;/&lt;process-type&gt;</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es nn"><img src="../Images/a233f5a4538ed8e3e131ee053d0053f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*1Wk1OiZQduKEgmR-N69rpw.png"/></div></figure><h1 id="f91e" class="lr ls hh bd lt lu lv lw lx ly lz ma mb iw mc ix md iz me ja mf jc mg jd mh mi bi translated">6.部署容器</h1><p id="41e4" class="pw-post-body-paragraph jr js hh jt b ju mj ir jw jx mk iu jz ka ml kc kd ke mm kg kh ki mn kk kl km ha bi translated">一旦图像被推送到容器注册表，我们将释放它。</p><pre class="jg jh ji jj fd nc nd ne nf aw ng bi"><span id="4049" class="mp ls hh nd b fi nh ni l nj nk">$ heroku container:release web --app app-name</span></pre><p id="840e" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">然后打开Heroku，打开app。</p><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es no"><img src="../Images/00b704253f290676d8f175364055a842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0qXlC2yLNXBNP9fCy8RxyQ.png"/></div></div></figure><p id="45c5" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">利用Heroku日志找出错误(如果有的话)。</p><p id="d568" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">python库中发生了很多变化；今天使用的库明天可能会被弃用。一般来说，良好的谷歌搜索技能会帮助你摆脱任何情况(我的学习方法)。</p><p id="568a" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">虽然本文展示了如何使用Docker来部署使用Streamlit制作的web应用程序。Docker的官方文档对底层概念提供了很好的解释。</p><p id="5bab" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hr">敬请期待。</strong></p><p id="3ab1" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hr">快乐学习</strong></p></div><div class="ab cl np nq go nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ha hb hc hd he"><p id="1e8d" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hr">参考文献</strong></p><p id="409e" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">[1]:戴维·邦巴尔，联合王国。Docker入门的WSL 2。(2020年6月11日6月)。访问时间:2022年7月4日。【在线视频】。可用:<a class="ae mo" href="https://www.youtube.com/watch?v=_fntjriRe48&amp;list=PLhfrWIlLOoKNMHhB39bh3XBpoLxV3f0V9" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=_fntjriRe48&amp;list = plhfrwillookmhhb 39 BH 3 xbpolxv 3 f 0v 9</a></p><p id="1685" class="pw-post-body-paragraph jr js hh jt b ju jv ir jw jx jy iu jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">[2] : Dockerfile参考。【在线】。可用:<a class="ae mo" href="https://docs.docker.com/engine/reference/builder/" rel="noopener ugc nofollow" target="_blank">https://docs.docker.com/engine/reference/builder/</a></p><div class="nw nx ez fb ny nz"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="oa ab dw"><div class="ob ab oc cl cj od"><h2 class="bd hr fi z dy oe ea eb of ed ef hq bi translated">Mlearning.ai提交建议</h2><div class="og l"><h3 class="bd b fi z dy oe ea eb of ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="oh l"><p class="bd b fp z dy oe ea eb of ed ef dx translated">medium.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on jp nz"/></div></div></a></div></div></div>    
</body>
</html>