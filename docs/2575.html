<html>
<head>
<title>Music genre classification using CNN: Part 1- Feature extraction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CNN的音乐流派分类:第1部分-特征提取</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/music-genre-classification-using-cnn-part-1-feature-extraction-b417547b8981?source=collection_archive---------1-----------------------#2022-05-20">https://medium.com/mlearning-ai/music-genre-classification-using-cnn-part-1-feature-extraction-b417547b8981?source=collection_archive---------1-----------------------#2022-05-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="b33f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">了解如何从音频中提取特征，并使用卷积神经网络将音乐分类为不同的流派。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/562ce9f3d89216e7d3a32fd02b5ba152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ECR78PVfyhwKhG3aLFM1cA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@marius?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Marius Masalar</a> on <a class="ae js" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="3fbb" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">介绍</h1><p id="7f64" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我们每天都听音乐，不管是在家里，在车里，还是在任何地方。音乐分为不同的流派，如流行、摇滚、金属、爵士、蓝调等。每天大约有24，000首歌曲被发布。每天发布的歌曲如此之多，以至于无法对它们进行手动分类。像Shazam和Spotify这样的应用程序可以播放数百万首歌曲，并使用音乐流派分类系统将它们归类。为此，我们使用机器学习算法来自动化这项工作。音乐平台使用音乐流派分类将音乐分为不同的类别，以实现定制的UX(用户体验)。Spotify将其音乐分为5071种类型。他们使用音乐分类向客户提供个性化的推荐。</p><p id="1f6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了分类的目的，我们从音频文件中提取时域和频域特征。这些特征是光谱图、梅尔光谱图、MFCC、光谱质心、色谱图、能量、光谱衰减、光谱通量、光谱熵、过零率和间距。音乐流派分类处理的一个主要问题是一些流派可能被错误地分类为彼此，例如乡村和摇滚、流行和迪斯科、爵士和雷鬼等。很少有类是高度相似的，并且彼此有显著的重叠。</p><h1 id="ab35" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated"><strong class="ak">数据集描述</strong></h1><p id="c7f2" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我们使用了<a class="ae js" href="https://www.tensorflow.org/datasets/catalog/gtzan" rel="noopener ugc nofollow" target="_blank"> GTZAN </a>数据集。GTZAN数据集包含1000个音频文件和每组100个音频(10组)。它包含以下类别:摇滚、流行、爵士、蓝调、乡村、金属、迪斯科、雷鬼、嘻哈和古典。读取音频文件时，发现了56个损坏的文件。因此，对944个文件进行了特征提取和分类。</p><p id="9233" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从时域提取时间特征，从频域提取频谱特征。然而，像光谱图、MFCCs等特征。包含时间和频率信息。</p><h1 id="b271" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">时频域特征</h1><p id="de37" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我们在分类任务中使用了以下功能:</p><h2 id="dbdd" class="kw ju hh bd jv kx ky kz jz la lb lc kd ip ld le kh it lf lg kl ix lh li kp lj bi translated"><strong class="ak"> 1。声谱图</strong></h2><p id="df6b" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">频谱图是信号强度随时间变化的直观表示，在每个时间步长都有不同的频率。就音频而言，它也被称为声谱图或声谱图。声谱图有三个维度，两个是频率(y轴)和时间(x轴)，第三个维度是振幅。</p><p id="9b17" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图是一个声谱图，黄色代表高振幅，蓝色代表低振幅。</p><p id="be6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用傅立叶变换从时域计算光谱图。当音频被采样时(在时域中)，它被分割成几个重叠的窗口。然后，使用短时傅立叶变换(STFT)来计算每个窗口的频谱，并且每个窗口表示图像中的一条垂直线。这些零件并排放在一起。这个过程被称为窗口。通过数字处理创建频谱图的过程实质上包括计算特定窗口宽度的信号STFT的平方幅度。音频文件的声谱图如图1所示。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lk"><img src="../Images/7b8641f7157224fce6f6c5766b59bb44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UI7lAifiZ-aACGW67bFK6A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig 1: Spectrogram of sample audio (Image by the Author)</figcaption></figure><h2 id="fff2" class="kw ju hh bd jv kx ky kz jz la lb lc kd ip ld le kh it lf lg kl ix lh li kp lj bi translated">2.<strong class="ak">梅尔谱图</strong></h2><p id="00f5" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">Mel标度(在单词melody之后)是一个感知标度，由听者判断彼此之间的距离相等。</p><p id="58b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">与较高频率相比，人类可以很好地检测较低频率。例如，我们可以轻松区分200 Hz和400 Hz之间的差异，但我们无法区分2000 Hz和2200 Hz之间的差异，即使两对之间的差异为200 Hz。原因是人类以非线性的方式感知声音。Mel-scale正是这样做的。为了简化，我们可以说mel标度随着频率的增加指数地分组更高的频率。Mel标度与Hertz标度的关系如图2所示。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ll"><img src="../Images/137320d3d3e1f1266d8147b8bb52d0f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TBHOP6jm9QLACImnb3rvZg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig 2: Mel scale versus Hertz scale (<a class="ae js" href="https://en.wikipedia.org/wiki/Mel_scale" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><p id="cb2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在mel频谱图中，使用mel滤波器组将频谱图转换为Mel标度。在计算谱图之后，我们将谱图的频率(y轴)映射到mel标度以形成Mel谱图。音频文件的Mel谱图如图3所示。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lk"><img src="../Images/de3a2f4f923d9468fc5ac1aebb2e8ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJQqMznP86O7-FCdH11r_Q.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig 3: Mel-Spectrogram of sample audio (Image by the Author)</figcaption></figure><h2 id="ae3f" class="kw ju hh bd jv kx ky kz jz la lb lc kd ip ld le kh it lf lg kl ix lh li kp lj bi translated">3.MFCC</h2><p id="2ecb" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">MFCC是梅尔频率倒谱系数。它们是精确描述光谱包络完整形状的一小组特征。MFCC使用MEL标度将频带划分为子带。然后，通过计算离散余弦变换(DCT)提取倒谱系数。在某种程度上，MFCCs压缩了Mel谱图的数据。DCT因易于图像压缩而流行。MFCC代表声道的形状。音频文件的MFCC如图5所示。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lm"><img src="../Images/6bee8e23f2b21e5df9b89bdd015b200a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OSNZTiz8ji6tUI48bigFmA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Fig 5: MFCC of sample audio (Image by the Author)</figcaption></figure><h1 id="cdff" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">履行</h1><p id="8f79" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">以下是提取不同类型特征的步骤:</p><ol class=""><li id="245f" class="ln lo hh ig b ih ii il im ip lp it lq ix lr jb ls lt lu lv bi translated"><strong class="ig hi">导入库</strong></li></ol><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="f5ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.<strong class="ig hi">保存音频路径和目标标签</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="7ef2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.提取特征:现在，我们从音频中提取不同的特征。这里，我们提取了光谱图、梅尔光谱图、MFCC、过零率、光谱质心和色谱图。但是出于分类的目的，我们将只使用声谱图、梅尔声谱图和MFCC。一些音频文件已损坏，因此我们找到了这些损坏的音频文件的索引，并将它们保存在一个列表中。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="ad0f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.<strong class="ig hi">删除损坏的文件:</strong>删除损坏索引处的音频文件和标签。然后，要素被转换为float32数据类型以节省内存使用。之后，我们给标签分配数值，并将它们转换成分类数据。最后，我们将所有提取的特征及其标签保存到一个. npz文件中。当我们开始分类任务时，我们可以直接加载。npz文件来使用这些功能。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lw lx l"/></div></figure><blockquote class="ly lz ma"><p id="d709" class="ie if mb ig b ih ii ij ik il im in io mc iq ir is md iu iv iw me iy iz ja jb ha bi translated">完整的代码可以在GitHub <a class="ae js" href="https://github.com/namratadutt/Music-genre-classification-Feature-extraction" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p></blockquote><h1 id="a069" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="a746" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在本文中，我们学习了如何从音频中提取不同的特征。在本文的下一部分，我们将学习如何分别使用这些特征和这些特征的组合来对音频进行分类。我们将探索音乐流派分类的深度CNN。</p><blockquote class="ly lz ma"><p id="8efe" class="ie if mb ig b ih ii ij ik il im in io mc iq ir is md iu iv iw me iy iz ja jb ha bi translated"><em class="hh">感谢阅读！我希望这篇文章对你有所帮助。</em></p><p id="537e" class="ie if mb ig b ih ii ij ik il im in io mc iq ir is md iu iv iw me iy iz ja jb ha bi translated">加油鳄鱼队！🐊</p></blockquote><h1 id="3cfa" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><div class="mf mg ez fb mh mi"><a href="https://en.wikipedia.org/wiki/Mel_scale" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">梅尔量表-维基百科</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">mel标度(单词后)是一个感知标度，由听众判断音高与一个…</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">en.wikipedia.org</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw jm mi"/></div></div></a></div><div class="mf mg ez fb mh mi"><a href="https://towardsdatascience.com/music-genre-classification-with-python-c714d032f0d8" rel="noopener follow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">用Python进行音乐流派分类</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">音乐就像一面镜子，它告诉人们你是谁，你关心什么。你就是你所流的。</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">towardsdatascience.com</p></div></div><div class="mr l"><div class="mx l mt mu mv mr mw jm mi"/></div></div></a></div><div class="mf mg ez fb mh mi"><a href="https://www.kaggle.com/datasets/andradaolteanu/gtzan-dataset-music-genre-classification" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">GTZAN数据集-音乐流派分类</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">音频文件| Mel光谱图|带提取特征的CSV</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">www.kaggle.com</p></div></div><div class="mr l"><div class="my l mt mu mv mr mw jm mi"/></div></div></a></div><div class="mf mg ez fb mh mi"><a href="https://www.tensorflow.org/datasets/catalog/gtzan" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">gtzan | TensorFlow数据集</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">数据集由1000个音轨组成，每个音轨长30秒。它包含10个流派，每个流派代表100首曲目…</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">www.tensorflow.org</p></div></div><div class="mr l"><div class="mz l mt mu mv mr mw jm mi"/></div></div></a></div><div class="mf mg ez fb mh mi"><a href="https://librosa.org/doc/main/feature.html" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">特征提取- librosa 0.9.1文档</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">编辑描述</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">librosa.org</p></div></div></div></a></div><div class="mf mg ez fb mh mi"><a href="https://ieeexplore.ieee.org/document/1021072" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">音频信号的音乐类型分类</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">音乐流派是人类创造的用来描述音乐作品的分类标签。音乐流派是…</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">ieeexplore.ieee.org</p></div></div><div class="mr l"><div class="na l mt mu mv mr mw jm mi"/></div></div></a></div><div class="mf mg ez fb mh mi"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">medium.com</p></div></div><div class="mr l"><div class="nb l mt mu mv mr mw jm mi"/></div></div></a></div></div></div>    
</body>
</html>