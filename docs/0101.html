<html>
<head>
<title>Email Next Word Predictions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过电子邮件发送下一个单词预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/email-next-word-predictions-7702349bd96?source=collection_archive---------1-----------------------#2021-02-03">https://medium.com/mlearning-ai/email-next-word-predictions-7702349bd96?source=collection_archive---------1-----------------------#2021-02-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/0a63c75874529f229bafaba6409f10bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1wxyvSYXPE6yv9LNpFvNw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://ronelssolutions.com/how-to-improve-your-email-marketing-performance/" rel="noopener ugc nofollow" target="_blank">source</a></figcaption></figure><p id="7083" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">内容:</strong></p><p id="144a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">1.介绍</p><p id="abdc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2业务问题</p><p id="23a0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3映射到ML/DL问题</p><p id="7124" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4数据来源</p><p id="0458" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">5种现有方法</p><p id="4736" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">6您的第一个切割解决方案</p><p id="e143" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">7 EDA，特征工程</p><p id="305e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">8模型解释</p><p id="11d1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">9个结果，部署</p><p id="e741" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">10未来的工作</p><p id="75c2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">11个人资料</p><p id="4b1a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">12篇参考文献</p><ol class=""><li id="c12f" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated"><strong class="iw hi">简介:</strong></li></ol><p id="d288" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有没有感觉到整天打邮件的负担？曾经困惑过用什么词来使你的邮件专业和良好？在创建电子邮件时，你可以获得下一个单词的建议。那岂不是太好了！让我们在这个案例研究中了解一下它是如何发生的。</p><p id="3fcd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 2。商务问题:</strong></p><p id="f4ad" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">文本在我们的日常生活中被广泛使用。从在社交媒体平台上发短信到官方邮件，我们一天要输入和阅读大量文本。因此，如果我们减少打字(即生成文本)的工作量，效果会更好。这就是自动文本生成的由来。电子邮件通常比较长，所以如果我们在生成邮件时正确预测下一个单词/句子，将会节省很多时间和精力。因此，我们当前的问题是在创建邮件时，根据用户在此之前给出的输入，正确预测句子的完成。</p><p id="8d50" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 3。映射到ML/DL问题:</strong></p><p id="f380" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">3.1ML问题的类型</strong></p><p id="c88f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如上所述，我们的任务是根据用户输入的文本生成句子。由于要做的预测将是英语句子，我们必须使用序列对序列深度学习模型来解决这个问题。一般来说，它们是为机器翻译而构建的，但也可以用来解决手头的问题。</p><p id="41a4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 3.2业务约束:</strong></p><p id="a4a6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于这是一个单词生成问题，模型解释很重要，也就是说，我们应该能够向他们解释/展示为什么基于给定的输入生成特定的单词。</p><p id="559f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">生成的句子应该有意义，即没有语法/拼写错误。此外，答案应该是100%相关的先前提供的文本。</p><p id="40e3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于这是用户输入时的单词预测，我们必须在不到一秒的时间内提供答案。</p><p id="7e38" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果我们有好的资源，培训时间不是问题。</p><p id="1abc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 3.3绩效指标:</strong></p><p id="75cb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因为这是下一个单词的预测，所以对于生成的单词没有严格的规则。因此，我们不能完全依赖一个指标来对模型的性能进行评级。但是应该有一些分数来决定模型的性能。</p><p id="c3fb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于我们无法手动检查生成的单词对所有数据是否有意义，我们将bleu score视为一种度量，以确保模型不会预测错误的单词。</p><p id="be6c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 4。数据来源:</strong></p><p id="9eb1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://www.kaggle.com/wcukierski/enron-email-dataset" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/wcukierski/enron-email-dataset</a></p><p id="f747" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该数据集在Kaggle中可用。它由安然公司的500，000封电子邮件组成。它有两列文件，分别是用户的名字、他的电子邮件文件夹和邮件正文。</p><p id="beef" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 5。现有解决问题的方法:</strong></p><p id="4f51" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些是针对给定问题的现有方法，</p><ul class=""><li id="c761" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr kb jy jz ka bi translated">预测下一个单词</li><li id="d078" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated">用LSTM模型预测下一个单词。</li></ul><p id="3631" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 6。第一种解决问题的方法:</strong></p><ol class=""><li id="abd4" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">对数据进行分析，如分析电子邮件中的文本，以及如何从电子邮件中仅提取相关文本。</li><li id="5b6a" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">清理文本以提取有用的信息。</li><li id="3104" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">以必要的格式准备数据以提供给模型。</li><li id="4740" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">实现一个基本的编码器/解码器模型，根据给定的单词预测下一个单词。</li><li id="03d5" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">尝试看看是否可以做些改进来提高模型的性能。</li></ol><p id="c335" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 7。EDA，特征工程:</strong></p><p id="55e0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于电子邮件的文本不直接出现在excel中，我们必须先处理它，提取和清理数据，然后对干净的文本进行分析。</p><p id="6ae0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 7.1数据清理和EDA </strong></p><p id="64cb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从电子邮件中提取的数据以不同的格式呈现，我们不能直接使用。</p><p id="749f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">例如:</p><figure class="ki kj kk kl fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kh"><img src="../Images/7405f55badeb7e8f4ecf423f2a3bc846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fZpJ-aP8tH1VZm-S"/></div></div></figure><p id="5864" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们需要提取邮件的主题和正文。</p><p id="7edb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是由一个已经可用的解析函数完成的。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="903b" class="kr ks hh kn b fi kt ku l kv kw">import email</span><span id="31ee" class="kr ks hh kn b fi kx ku l kv kw">def parse_func(x):</span><span id="db59" class="kr ks hh kn b fi kx ku l kv kw">b = email.message_from_string(x)</span><span id="8e32" class="kr ks hh kn b fi kx ku l kv kw">body = ''</span><span id="7603" class="kr ks hh kn b fi kx ku l kv kw">if b.is_multipart():</span><span id="2a00" class="kr ks hh kn b fi kx ku l kv kw">for payload in b.get_payload():</span><span id="c5ee" class="kr ks hh kn b fi kx ku l kv kw">body = body+ ' '</span><span id="623a" class="kr ks hh kn b fi kx ku l kv kw">body+=payload.get_payload()</span><span id="c8d1" class="kr ks hh kn b fi kx ku l kv kw">else:</span><span id="aff9" class="kr ks hh kn b fi kx ku l kv kw">body+=b.get_payload()</span><span id="040a" class="kr ks hh kn b fi kx ku l kv kw">return body</span><span id="cf78" class="kr ks hh kn b fi kx ku l kv kw">def parse_func_subj(x):</span><span id="8fe9" class="kr ks hh kn b fi kx ku l kv kw">b = email.message_from_string(x)</span><span id="146d" class="kr ks hh kn b fi kx ku l kv kw">if b.get('Subject'):</span><span id="07f8" class="kr ks hh kn b fi kx ku l kv kw">subj = b.get('Subject')</span><span id="808d" class="kr ks hh kn b fi kx ku l kv kw">else:</span><span id="75d2" class="kr ks hh kn b fi kx ku l kv kw">subj = '-'</span><span id="1ed7" class="kr ks hh kn b fi kx ku l kv kw">return subj</span><span id="f44a" class="kr ks hh kn b fi kx ku l kv kw">emails['Body'] = emails['message'].apply(parse_func)</span><span id="f938" class="kr ks hh kn b fi kx ku l kv kw">emails['Subject'] = emails['message'].apply(parse_func_subj)</span></pre><p id="5d37" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们为邮件正文和主题创建了一个新列，它是由上述函数提取的。</p><p id="03bb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，我们必须处理获得的文本，因为它有许多我们不能/不应该用来建立模型的不需要的字符，如日期、数字、特殊字符等。</p><p id="398d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在删除任何不需要的字符之前，我们对英文文本使用了缩写，即不能-不能，不应该-不应该等。我们使用正则表达式进行了基本的文本清理，比如删除字母以外的' \n '，' \t '，字符。我们保留了“.”因为这是用来句号的，我们需要它来分隔邮件中的句子。最后我们用一个空格代替了多个空格。在subject中，我们还必须删除“Re:”因为它没有任何用处。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="f50d" class="kr ks hh kn b fi kt ku l kv kw">import re</span><span id="4df7" class="kr ks hh kn b fi kx ku l kv kw">body = []</span><span id="e0de" class="kr ks hh kn b fi kx ku l kv kw">for text in emails['Body']:</span><span id="d5d3" class="kr ks hh kn b fi kx ku l kv kw">text = decontractions(text)</span><span id="1fa9" class="kr ks hh kn b fi kx ku l kv kw">text = re.sub(r"\n|\t", ' ', text)</span><span id="062d" class="kr ks hh kn b fi kx ku l kv kw">text = re.sub("[^a-zA-Z\s.]+",' ',text)</span><span id="31d6" class="kr ks hh kn b fi kx ku l kv kw">text = re.sub("\s+", ' ', text)</span><span id="3c9f" class="kr ks hh kn b fi kx ku l kv kw">body.append(text)</span><span id="db06" class="kr ks hh kn b fi kx ku l kv kw">emails['Processed_Text'] = body</span><span id="bbe5" class="kr ks hh kn b fi kx ku l kv kw">emails</span></pre><p id="158a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 7.2分析</strong></p><p id="304a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们从每封邮件中提取字符长度，统计如下。</p><p id="94da" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-最小值为0，这意味着在清理后，一些邮件包含0个字符。我们可以把它们从我们的数据中删除，因为它们没有任何用处。</p><p id="c0d6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-最大值为180万卢比，这绝对是一个异常值。它可能被错误地输入到数据中，或者某些特定的邮件可能很长。</p><p id="8f14" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-我们知道以上是第75百分位数据的异常值。长度为1.5k，为正常长度。</p><p id="f06a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了进一步分析，我们将看到电子邮件的句子长度和单词长度。</p><p id="d339" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">每封电子邮件的中位句子长度为9句。由于我们的任务是句子完成，我们必须从电子邮件中提取句子，创建每个句子作为数据点，然后创建所需格式的数据。在分析具有大量句子的电子邮件之后，我们发现邮件在一个邮件链中具有多个邮件。</p><p id="7aa0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 7.3特色工程</strong></p><p id="3a67" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如上所述，有些邮件有邮件链。由于有更多的数据可供我们依赖，我们选择删除存在“转发者”、“原始消息”的行，因为我们在这些行中有许多不需要的数据。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="f24b" class="kr ks hh kn b fi kt ku l kv kw">remove=[]</span><span id="9f13" class="kr ks hh kn b fi kx ku l kv kw">for i in emails.index:</span><span id="107b" class="kr ks hh kn b fi kx ku l kv kw">text = emails.loc[i]['Body']</span><span id="2695" class="kr ks hh kn b fi kx ku l kv kw">if ('Original Message' in text) or ('Forwarded by' in text):</span><span id="74a3" class="kr ks hh kn b fi kx ku l kv kw">remove.append(i)</span><span id="d7be" class="kr ks hh kn b fi kx ku l kv kw">emails.drop(remove,axis=0,inplace=True)</span><span id="0ec4" class="kr ks hh kn b fi kx ku l kv kw">emails.reset_index(drop=True,inplace=True)</span></pre><p id="af8c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，现在我们要建立序列到序列模型，我们需要准备的数据在这种格式，即打破句子，创造输入和输出。所以我们决定有三种数据。</p><p id="45b9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一是让短句作为输入，二是让我们的模型学习长句作为输入，三是打破单词，让我们的模型预测单词完成情况和下一对单词。我们将主题的前5个单词附加到输入中，以帮助模型更好地理解上下文并给出更有意义的预测。</p><p id="4718" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有些长句是特定的，在一般情况下不太可能出现。</p><p id="63e7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面是编写的代码和数据示例。</p><p id="0eff" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 7.3.1短句</strong></p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="bba1" class="kr ks hh kn b fi kt ku l kv kw">input = []</span><span id="5dae" class="kr ks hh kn b fi kx ku l kv kw">output = []</span><span id="050a" class="kr ks hh kn b fi kx ku l kv kw">for i in emails.index:</span><span id="9135" class="kr ks hh kn b fi kx ku l kv kw">subject = emails.loc[i]['Processed_Subject']</span><span id="b609" class="kr ks hh kn b fi kx ku l kv kw">sentences = emails.loc[i]['Processed_Text'].split('.')</span><span id="6f7c" class="kr ks hh kn b fi kx ku l kv kw">for sent in sentences:</span><span id="f7e2" class="kr ks hh kn b fi kx ku l kv kw">sent = sent.lower()</span><span id="e4a2" class="kr ks hh kn b fi kx ku l kv kw">noof_words = len(sent.split())</span><span id="a14b" class="kr ks hh kn b fi kx ku l kv kw">if noof_words in range(5,13):</span><span id="1994" class="kr ks hh kn b fi kx ku l kv kw"># half = int(noof_words/2)</span><span id="62f4" class="kr ks hh kn b fi kx ku l kv kw">words = sent.split()</span><span id="5627" class="kr ks hh kn b fi kx ku l kv kw">for i in range(3,noof_words):</span><span id="449d" class="kr ks hh kn b fi kx ku l kv kw">if i%3==0:</span><span id="30b2" class="kr ks hh kn b fi kx ku l kv kw">if noof_words-i&gt;=4:</span><span id="7947" class="kr ks hh kn b fi kx ku l kv kw">input.append(' '.join(subject.split()[:5]+words[:i]))</span><span id="4185" class="kr ks hh kn b fi kx ku l kv kw">output.append(' '.join(words[i:i+4]))</span><span id="07cc" class="kr ks hh kn b fi kx ku l kv kw">elif i%3==1:</span><span id="73f7" class="kr ks hh kn b fi kx ku l kv kw">if noof_words-i&gt;=3:</span><span id="198c" class="kr ks hh kn b fi kx ku l kv kw">input.append(' '.join(subject.split()[:5]+words[:i]))</span><span id="2487" class="kr ks hh kn b fi kx ku l kv kw">output.append(' '.join(words[i:i+3]))</span><span id="9903" class="kr ks hh kn b fi kx ku l kv kw">else:</span><span id="2c3c" class="kr ks hh kn b fi kx ku l kv kw">if noof_words-i&gt;=2:</span><span id="693f" class="kr ks hh kn b fi kx ku l kv kw">input.append(' '.join(subject.split()[:5]+words[:i]))</span><span id="8176" class="kr ks hh kn b fi kx ku l kv kw">output.append(' '.join(words[i:i+2]))</span></pre><figure class="ki kj kk kl fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/3047c4eeef829049f639cc613019bf8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/0*IeSMi8qQ9hIFLCQL"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Short sentences data</figcaption></figure><p id="6151" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 7.3.2长句</strong></p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="a87e" class="kr ks hh kn b fi kt ku l kv kw">import random</span><span id="6c5e" class="kr ks hh kn b fi kx ku l kv kw">input = []</span><span id="0b44" class="kr ks hh kn b fi kx ku l kv kw">output = []</span><span id="e3a9" class="kr ks hh kn b fi kx ku l kv kw">for i in emails.index:</span><span id="01d4" class="kr ks hh kn b fi kx ku l kv kw">subject = emails.loc[i]['Processed_Subject']</span><span id="3838" class="kr ks hh kn b fi kx ku l kv kw">sentences = emails.loc[i]['Processed_Text'].split('.')</span><span id="f2d5" class="kr ks hh kn b fi kx ku l kv kw">for sent in sentences:</span><span id="bd1e" class="kr ks hh kn b fi kx ku l kv kw">sent = sent.lower()</span><span id="101c" class="kr ks hh kn b fi kx ku l kv kw">noof_words = len(sent.split())</span><span id="e04b" class="kr ks hh kn b fi kx ku l kv kw">if noof_words in range(10,15):</span><span id="cca6" class="kr ks hh kn b fi kx ku l kv kw"># half = int(noof_words/2)</span><span id="196f" class="kr ks hh kn b fi kx ku l kv kw">words = sent.split()</span><span id="a1a7" class="kr ks hh kn b fi kx ku l kv kw">for i in range(10,noof_words):</span><span id="c327" class="kr ks hh kn b fi kx ku l kv kw">rn = random.randint(3,6)</span><span id="189a" class="kr ks hh kn b fi kx ku l kv kw">if noof_words-i&gt;=rn:</span><span id="de9d" class="kr ks hh kn b fi kx ku l kv kw">input.append(' '.join(subject.split()[:5]+words[:i]))</span><span id="b31c" class="kr ks hh kn b fi kx ku l kv kw">output.append(' '.join(words[i:i+rn]))</span></pre><figure class="ki kj kk kl fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/fc9c0cb18fcd8979f3d6b1161f38281e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/0*VwGo5rCP0Qg33Hwf"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Long sentences data</figcaption></figure><p id="fc22" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 7.3.3断字</strong></p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="3bc1" class="kr ks hh kn b fi kt ku l kv kw">input = []</span><span id="d2af" class="kr ks hh kn b fi kx ku l kv kw">output = []</span><span id="d936" class="kr ks hh kn b fi kx ku l kv kw">for i in emails.index:</span><span id="a903" class="kr ks hh kn b fi kx ku l kv kw">subject = emails.loc[i]['Processed_Subject']</span><span id="e5a0" class="kr ks hh kn b fi kx ku l kv kw">sentences = emails.loc[i]['Processed_Text'].split('.')</span><span id="e629" class="kr ks hh kn b fi kx ku l kv kw">for sent in sentences:</span><span id="3308" class="kr ks hh kn b fi kx ku l kv kw">sent = sent.lower()</span><span id="9b7f" class="kr ks hh kn b fi kx ku l kv kw">noof_words = len(sent.split())</span><span id="f165" class="kr ks hh kn b fi kx ku l kv kw">if noof_words in range(5,13):</span><span id="cf76" class="kr ks hh kn b fi kx ku l kv kw"># half = int(noof_words/2)</span><span id="4ef2" class="kr ks hh kn b fi kx ku l kv kw">words = sent.split()</span><span id="486f" class="kr ks hh kn b fi kx ku l kv kw">for i in range(3,noof_words):</span><span id="b03d" class="kr ks hh kn b fi kx ku l kv kw">if len(words[i])&gt;=5 and noof_words-i&gt;=3:</span><span id="2bd6" class="kr ks hh kn b fi kx ku l kv kw">for j in range(3,len(words[i])):</span><span id="c2b8" class="kr ks hh kn b fi kx ku l kv kw">if len(words[i])-j&gt;=2:</span><span id="76af" class="kr ks hh kn b fi kx ku l kv kw">half_word_1 = words[i][:j]</span><span id="8d51" class="kr ks hh kn b fi kx ku l kv kw">half_word_2 = words[i][j:]</span><span id="b260" class="kr ks hh kn b fi kx ku l kv kw">input.append(' '.join(subject.split()[:5]+words[:i-1]+[half_word_1]))</span><span id="60fc" class="kr ks hh kn b fi kx ku l kv kw">output.append(' '.join([half_word_2]+words[i+1:i+3]))</span></pre><figure class="ki kj kk kl fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/1be64f7b533445d931c5b520621034dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/0*MQy1g8rlt_Nxii3o"/></div></div></figure><p id="5b22" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，我们追加准备好的所有类型的数据，以便模型能够查看和学习所有类型的数据。</p><p id="e30b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们需要准备的数据的格式按照顺序到顺序模型。</p><p id="cdeb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于我们在编码-解码模型中使用教师强制技术，我们准备了三列数据，即编码输入、解码输入、解码输出，我们将在下一部分中详细讨论。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="760f" class="kr ks hh kn b fi kt ku l kv kw">new_data['decoder_input'] = '&lt;start&gt; ' + new_data['output'].astype(str)</span><span id="179e" class="kr ks hh kn b fi kx ku l kv kw">new_data['decoder_output'] = new_data['output'].astype(str) + ' &lt;end&gt;'</span><span id="d92b" class="kr ks hh kn b fi kx ku l kv kw">new_data = new_data.drop(['output'], axis=1)</span><span id="d3ab" class="kr ks hh kn b fi kx ku l kv kw">new_data.head()</span></pre><figure class="ki kj kk kl fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lb"><img src="../Images/001d9fd3edd82244209d8a0b43038d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TWxwsnoa3iSy4mNy"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">data for encoder decoder</figcaption></figure><p id="884a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用这个开始和结束标记是因为在将一个句子作为输入传递给编码器之后，我们将把<start>作为输入传递给解码器的第一步以生成下一个单词，并且当达到/预测到<end>标记时，我们将停止预测。</end></start></p><p id="2f46" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于我们知道不能将文本数据直接传递给模型，因此需要将其转换为数字形式。这就是Tokenizing发挥作用的地方，它会获取所有单词，并为词汇表中的每个单词分配唯一的id/索引。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="7079" class="kr ks hh kn b fi kt ku l kv kw">from tensorflow.keras.preprocessing.text import Tokenizer</span><span id="e644" class="kr ks hh kn b fi kx ku l kv kw">from tensorflow.keras.preprocessing.sequence import pad_sequences</span><span id="481b" class="kr ks hh kn b fi kx ku l kv kw">tokenizer_encoder = Tokenizer(oov_token='out_of_vocab')</span><span id="9b53" class="kr ks hh kn b fi kx ku l kv kw">tokenizer_encoder.fit_on_texts(new_data['input'].values)</span><span id="7077" class="kr ks hh kn b fi kx ku l kv kw">tokenizer_decoder = Tokenizer(filters='!"#$%&amp;()*+,-./:;=?@[\\]^_`{|}~\t\n')</span><span id="08c2" class="kr ks hh kn b fi kx ku l kv kw">tokenizer_decoder.fit_on_texts(np.append(new_data['decoder_input'].values,'&lt;end&gt;')) #to add &lt;end&gt; in the corpus</span><span id="fca6" class="kr ks hh kn b fi kx ku l kv kw">vocab_size_enc = len(tokenizer_encoder.word_index)+1</span><span id="7047" class="kr ks hh kn b fi kx ku l kv kw">vocab_size_dec = len(tokenizer_decoder.word_index)+1</span><span id="1b06" class="kr ks hh kn b fi kx ku l kv kw">print("Vocab sizes of encoder and decoder are ",vocab_size_enc,vocab_size_dec)</span></pre><p id="70d8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，在对输入和输出句子进行标记化之后，我们需要填充。填充基本上是使所有的输入和输出具有相同的长度，以便更容易地处理句子。</p><pre class="ki kj kk kl fd km kn ko kp aw kq bi"><span id="8b4a" class="kr ks hh kn b fi kt ku l kv kw">tokenzd_seq_enc = tokenizer_encoder.texts_to_sequences(new_data['input'].values)</span><span id="5db3" class="kr ks hh kn b fi kx ku l kv kw">tokenzd_seq_dec_ip = tokenizer_decoder.texts_to_sequences(new_data['decoder_input'].values)</span><span id="6915" class="kr ks hh kn b fi kx ku l kv kw">tokenzd_seq_dec_op = tokenizer_decoder.texts_to_sequences(new_data['decoder_output'].values)</span><span id="5be3" class="kr ks hh kn b fi kx ku l kv kw">enc_padded = pad_sequences(tokenzd_seq_enc, maxlen=max_len_enc, dtype='int32', padding='post')</span><span id="5210" class="kr ks hh kn b fi kx ku l kv kw">dec_ip_padded = pad_sequences(tokenzd_seq_dec_ip, maxlen=max_len_dec, dtype='int32', padding='post')</span><span id="9207" class="kr ks hh kn b fi kx ku l kv kw">dec_op_padded = pad_sequences(tokenzd_seq_dec_op, maxlen=max_len_dec, dtype='int32', padding='post')</span><span id="bc05" class="kr ks hh kn b fi kx ku l kv kw">BATCH_SIZE=1024</span><span id="bab7" class="kr ks hh kn b fi kx ku l kv kw">train_dataset = tf.data.Dataset.from_tensor_slices(((enc_padded, dec_ip_padded),dec_op_padded))</span><span id="7ecd" class="kr ks hh kn b fi kx ku l kv kw">train_dataset = train_dataset.batch(BATCH_SIZE, drop_remainder=True)</span></pre><p id="576f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了更快更好地加载数据，我们使用了tf.data.Dataset。</p><p id="5b3f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 8 .型号说明:</strong></p><p id="e2ca" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">既然我们决定用序列来序列，我们就用两个模型。一个是基本的编码-解码模型，另一个是使用注意的编码-解码模型。</p><p id="c213" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 8.1基本编码器—解码器型号:</strong></p><p id="72c9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">编码器层有两个步骤。嵌入层和LSTM层。我们将标记化的填充输入传递给编码器的嵌入层。在嵌入层，每个单词/标记被转换成n维向量，以保持单词之间的关系。然后，我们将嵌入的矩阵传递给编码器的LSTM层。这里，每个单词的嵌入矩阵按顺序传递给它。它从句子中学习信息，并返回LSTM的隐藏状态和最后一个时间步长的单元格状态，我们将把它们作为初始状态传递给解码器的LSTM。</p><p id="7597" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 8.2编码器—解码器模型注意:</strong></p><p id="c8db" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在上面的模型中，我们只使用了来自编码器的最后一个时间步长的隐藏和单元状态。这样，如果输入的句子很长，我们的模型将无法从句子中更好地学习趋势或上下文。这就是一个叫做“注意”的美丽方法出现的地方。</p><p id="77f4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将所有时间步长的隐藏状态作为编码器LSTM的输出。在解码过程中，在每个时间步，我们计算解码器的相似性得分/注意力权重-LSTM的前一步的隐藏状态与编码器-LSTM的所有步骤的隐藏状态。因此，我们有解码器的先前状态信息以及编码器的所有步骤信息来预测解码器中的下一个字。同样，通过注意力权重，我们可以了解编码器中的哪个单词对解码器中的预测单词给予了更多的权重。因为要在解码器中预测每个单词，我们有来自编码器的所有步骤的信息，这更好地保留了长句中的关系。因为我们在解码器的每一步都计算注意力权重，所以我们使用一个单步解码器层来执行注意力动作。然后在解码器中，我们循环运行一步解码器。</p><p id="9e44" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因为我们手头的任务是基于输入单词预测下一个单词，所以关于预测没有硬性的规则。一个输入可能有多个可能的下一个单词，例如，“我愿意”可能有下一个单词组合，如“请你帮个忙”、“告诉你一件事”、“和你谈谈”。所以我们目前只给出一个基于高概率的句子。但是在有很多可能性的情况下，为什么要坚持只说一句话。为此，我们有波束搜索逻辑。它的工作原理如下:</p><p id="1fc1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 8.3光束搜索</strong></p><p id="78ff" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们在解码器的第一步取前三个预测。</p><p id="5184" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将这三个字传递给解码器的下一步，并为之前生成的三个字中的每一个生成三个字。我们取9个单词组合的组合概率，对它们进行排序，并从中取前三个单词组合。然后重复这个过程，直到我们在三个单词组合中得到<end>令牌。</end></p><p id="40c7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这就是我们如何为给定的输入生成前三个预测。</p><p id="fc69" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 9。结果，部署:</strong></p><p id="abf4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 9.1结果</strong></p><p id="bd37" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">尽管我们不能完全依赖bleu分数，但由于我们使用了该指标来评估模型的性能，以下是模型获得的bleu分数的结果，</p><figure class="ki kj kk kl fd ii er es paragraph-image"><div class="er es lc"><img src="../Images/950e2d7ae9a2abd75c4032fc50b93b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*gZHXGvn1_Yvy2iwfs24fBg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx">Results</figcaption></figure><p id="dc5b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于注意力模型比之前的模型给出了更好的bleu分数和更好的预测，我们选择它作为最终模型。</p><p id="0d34" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是一些预测的例子:</p><p id="f1c2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">根据基本编码器-解码器模型，</p><p id="4f7e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">单一预测</p><p id="90da" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">— ip:信函副本请参见attac — prd: hed信函至</p><p id="80b3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">前三大预测，</p><p id="4369" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">— ip:您要求cgi nightrider删除的信息进一步— prd: ['她的邮件回复'，'她的邮件来自'，'她的邮件列表']</p><p id="6a06" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从注意力模型来看，</p><p id="2daa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">单一预测</p><p id="d84c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">— ip:投标周价格请告诉我— prd:如果您有</p><p id="31a3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">三大预测:</p><p id="70ee" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">— ip: executive reports viewer我收到了一封邮件morni—prd:[' ng about the '，' ng and represent '，' ng about this ']</p><p id="4da2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 9.2部署</strong></p><p id="09e2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们已经使用Flask应用程序部署了该模型。</p><p id="3cf2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">用Flask部署很简单。</p><p id="046b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们需要编写一个py文件来加载模型并进行预测。这个py文件本身就像一个flask应用程序。</p><p id="efd0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将在模板文件夹中有一个html文件，并在应用程序中导入该模板。</p><p id="9317" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们创建了一个基本的html模板，并部署了flask应用程序来预测接下来的单词。</p><p id="7e03" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面是同样的截图，</p><figure class="ki kj kk kl fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/05abc5bb6f0bd760a91839c12d9509de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/0*c2I5zQWp55Fwx5TJ"/></div><figcaption class="ip iq et er es ir is bd b be z dx">deployment</figcaption></figure><p id="202c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 9.3错误预测分析:</strong></p><p id="ab8d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">尽管我们不能完全依赖bleu分数，我们还是分离出了预测的bleu分数较低的句子。</p><p id="ace2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">注意:示例顺序:输入_原始_预测</p><p id="bb52" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从以上来自普通编码器/解码器模型和注意力模型的例子中，我们可以看到多种情况，</p><p id="d40f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-预测比原来更好</p><p id="783a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你能给我发一封电子邮件确认吗</p><p id="8427" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们不得不把离职日期推迟几个小时</p><p id="e559" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-因为句子很长，模特不能正确地学习</p><p id="adbd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">例如:全球eol保留清单替代这些实体的交易对手仍在接受安然公司信贷法律和合同部门的审查</p><p id="08e3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-预测与原始预测一样有意义，但两者不匹配</p><p id="d6e8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">嘿，马特，我给了她我的号码，让她给我打电话，我的号码是</p><p id="92c2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">例如:达博尔史蒂夫请看看下面的链接</p><p id="ca63" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-输入和原始很少出现，即如此具体</p><p id="6c9f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">例如:tagg交换用户我想从托德·沃里克·弗兰克开始</p><p id="a2e9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我和布莱恩·尼科尔斯谈论了8月份网上初选的事情</p><p id="c184" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">-一些示例看起来很简单，但模型预测不准确</p><p id="1a28" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我想你说过明天下午5点会工作到下班</p><p id="9d5b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 10。未来工作:</strong></p><p id="6021" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">目前我们最多给出4到5个单词作为预测。您可以尝试给出更多的预测词，但我们需要确保邮件的上下文，并且在预测更多的词时应该有一些概率阈值。</p><p id="202f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你可以尝试不同类型的注意机制，看看模型的表现如何。</p><p id="0101" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">11。简介:</p><p id="6d8b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 11.1 Github回购:</strong></p><p id="d6bb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://github.com/satwikparlapalli/nextwordsprediction" rel="noopener ugc nofollow" target="_blank">https://github.com/satwikparlapalli/nextwordsprediction</a></p><p id="d886" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 11.2 LinkedIN: </strong></p><p id="2630" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://www.linkedin.com/in/naga-satwik-parlapalli-2b93b1182/" rel="noopener ugc nofollow" target="_blank">https://www . LinkedIn . com/in/naga-satwik-parla palli-2b 93 b 1182/</a></p><p id="2d38" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> 12 .参考:</strong></p><ul class=""><li id="5d6d" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr kb jy jz ka bi translated"><a class="ae it" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="27a0" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated"><a class="ae it" href="https://towardsdatascience.com/next-word-prediction-with-nlp-and-deep-learning-48b9fe0a17bf" rel="noopener" target="_blank">https://towards data science . com/next-word-prediction-with-NLP-deep-learning-48 B9 fe0a 17 BF</a></li><li id="bfd1" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated"><a class="ae it" href="https://machinelearningmastery.com/calculate-bleu-score-for-text-python/" rel="noopener ugc nofollow" target="_blank">https://machinerlearnishingtable . com/calculate-bleu-score-for-text-python/</a></li><li id="e442" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated"><a class="ae it" href="https://towardsdatascience.com/word-level-english-to-marathi-neural-machine-translation-using-seq2seq-encoder-decoder-lstm-model-1a913f2dc4a7" rel="noopener" target="_blank">https://towards data science . com/word-level-English-to-maradi-neural-machine-translation-use-seq2seq-encoder-decoder-lstm-model-1a 913 F2 DC 4a 7</a></li><li id="93b8" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated"><a class="ae it" href="https://towardsdatascience.com/gmail-style-smart-compose-using-char-n-gram-language-models-a73c09550447" rel="noopener" target="_blank">https://towards data science . com/Gmail-style-smart-const-use-char-n-gram-language-models-a 73c 09550447</a></li><li id="90db" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated"><a class="ae it" href="https://www.tensorflow.org/addons/tutorials/networks_seq2seq_nmt" rel="noopener ugc nofollow" target="_blank">https://www . tensorflow . org/addons/教程/networks_seq2seq_nmt </a></li><li id="8e20" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated"><a class="ae it" href="https://towardsdatascience.com/an-intuitive-explanation-of-beam-search-9b1d744e7a0f" rel="noopener" target="_blank">https://towards data science . com/an-直观解释波束搜索-9b1d744e7a0f </a></li><li id="3e14" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated"><a class="ae it" href="https://stackoverflow.com/questions/19790188/expanding-english-language-contractions-in-python/47091490#47091490" rel="noopener ugc nofollow" target="_blank">https://stackoverflow . com/questions/19790188/expanding-English-language-language-constraints-in-python/47091490 # 47091490</a></li><li id="ead5" class="js jt hh iw b ix kc jb kd jf ke jj kf jn kg jr kb jy jz ka bi translated"><a class="ae it" href="https://stackoverflow.com/questions/17874360/python-how-to-parse-the-body-from-a-raw-email-given-that-raw-email-does-not" rel="noopener ugc nofollow" target="_blank">https://stackoverflow . com/questions/17874360/python如何解析原始电子邮件中的正文假定原始电子邮件不存在</a></li></ul></div></div>    
</body>
</html>