<html>
<head>
<title>Linear Regression: Ordinary Least Squares in a nutshell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归:简单的普通最小二乘法</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/linear-regression-ordinary-least-squares-in-a-nutshell-c2e0d7ed260f?source=collection_archive---------0-----------------------#2022-06-28">https://medium.com/mlearning-ai/linear-regression-ordinary-least-squares-in-a-nutshell-c2e0d7ed260f?source=collection_archive---------0-----------------------#2022-06-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="05e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大家好！</p><p id="bd56" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我上一篇<a class="ae jc" rel="noopener" href="/mlearning-ai/a-gentle-introduction-to-linear-regression-the-dart-way-9750214e6fa2?source=friends_link&amp;sk=e199d8f5b0bb71c97525be2ee7f5819b">文章</a>中，我用<a class="ae jc" href="https://github.com/gyrdym/ml_algo" rel="noopener ugc nofollow" target="_blank"> ml_algo </a>库解释了线性回归的基础。如果你没有读过或者对这个话题不熟悉，请熟悉我的<a class="ae jc" rel="noopener" href="/mlearning-ai/a-gentle-introduction-to-linear-regression-the-dart-way-9750214e6fa2?source=friends_link&amp;sk=e199d8f5b0bb71c97525be2ee7f5819b">帖子</a>。</p><p id="e785" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我提到过有几种方法可以找到预测线的系数。它们都是基于一个叫做“普通最小二乘法”的概念。</p><p id="fff1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了理解这个概念，让我们使用我以前的<a class="ae jc" rel="noopener" href="/mlearning-ai/a-gentle-introduction-to-linear-regression-the-dart-way-9750214e6fa2?source=friends_link&amp;sk=e199d8f5b0bb71c97525be2ee7f5819b">文章</a>中的例子。</p><p id="8811" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们有一个小数据集:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><p id="0482" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们用线性方程组的方式来写它:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jk"><img src="../Images/b127f09fafe49a3a3f30d77318f7f791.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*uFlez0wOOGIKIbh1LcCSkQ.png"/></div></figure><p id="ba0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">记住，我们的数据偏离原点:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es jn"><img src="../Images/0b47384fedef13188cb3f8b1191275d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rAKv-z7Dkp2kBEQOKAbtLA.png"/></div></div></figure><p id="8735" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这意味着我们必须通过向特征矩阵添加新列并向系数矩阵的开头添加新值来考虑偏差项:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es js"><img src="../Images/0e2a15cbdb8b8666dd857bbf8140677f.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*jWKclUfII83w0R_GE3hvhg.png"/></div></figure><p id="22d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">特征矩阵的第一列中的术语“1”来自线的等式:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jt"><img src="../Images/644a56105d97a253ee62f0b3d12fa347.png" data-original-src="https://miro.medium.com/v2/resize:fit:166/format:webp/1*Vzg1b3A7mTU5hQAEnpvazQ.png"/></div></figure><p id="6d16" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中:</p><ul class=""><li id="ce0b" class="ju jv hh ig b ih ii il im ip jw it jx ix jy jb jz ka kb kc bi translated">“b”是我们的偏差，我们记为“w_0_0”</li><li id="143a" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">“k”是我们的系数，我们记为“w_1_0”</li><li id="03c9" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">“y”是我们的结果</li></ul><p id="9d24" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以用下面的方式重写这个等式:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/b414c9180126174facbc8aa6f1d09be7.png" data-original-src="https://miro.medium.com/v2/resize:fit:250/format:webp/1*szCBknmHRa_0dQALQUlMqw.png"/></div></figure><p id="af6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意偏差项，你可以看到“1”——它是偏差的一个值，它总是1。这就是为什么我们用1填充矩阵X。</p><p id="d5a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们重写前面提到的线性方程组，考虑偏差项:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kj"><img src="../Images/1f3c2a9bdcb297513794284c5efc665c.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*4wEcdN7iayWDyOpknV-RcQ.png"/></div></figure><p id="08f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们应该想出求系数w0 _ 0和w1 _ 0的算法，它们是被称为“预测直线方程”的谜题的最后一部分。我们怎样才能找到他们？</p><p id="d9f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，我们可以对系数做一些最好的猜测，用它代替未知项w0 _ 0和w1 _ 0，并以某种方式将实际结果与预测结果进行比较。</p><p id="945d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设10和20是w0 _ 0和w1 _ 0系数的最佳猜测值。让我们用它们代替w_0_0和w_1_0变量:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/2376c00bedb33545fb5405ed1989752a.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*9ffI8UbWp5xB4l-O5xj-Rw.png"/></div></figure><p id="0441" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如我们所见，我们离实际结果还很远。</p><p id="1da8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看来，我们最好的猜测根本不是最好的，真遗憾。让我们重复上述步骤，对系数进行更多的随机猜测。</p></div><div class="ab cl kl km go kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ha hb hc hd he"><p id="be77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">经过数百天毫无结果的尝试，我们意识到应该有一个更聪明的方法来找到系数。我们不仅要直观地评估预测结果和实际结果之间的差异，还要通过两者相减来进行比较，并将相减的结果视为“我们的预测与实际值之间的差距”，或者简单地称为“误差”:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ks"><img src="../Images/e79f3e3333981b93f1b14cea9aba6746.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*qdJ7JUcpHkCTrC7r_ERnnw.png"/></div></div></figure><p id="7c85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们可以为上面系统中的每一行推断出一个共同的模式:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kt"><img src="../Images/57d432ce5304a13b18f21b73f39cc246.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*yfEAR3OVVgsqo1eH-DgvWQ.png"/></div></figure><p id="e197" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在哪里</p><ul class=""><li id="cfff" class="ju jv hh ig b ih ii il im ip jw it jx ix jy jb jz ka kb kc bi translated">y是我们的实际结果(价格)</li><li id="4610" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">w0 0是我们的偏差系数</li><li id="90cc" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">w1 _ 0是我们的特征系数</li></ul><p id="fa04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">老实说，误差是负数还是正数并不重要，我们只对误差的绝对值感兴趣。让我们考虑这一点，重写模式:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ku"><img src="../Images/f6841e8bc1212433a53611ec463220dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*2Kvq8rwvo3Mb8jdny6HCjg.png"/></div></figure><p id="385b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们做一个替换:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kv"><img src="../Images/6290b17658f1afb5c7442a73e0d7eb9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:162/format:webp/1*Dbi0MKy1ubICEk1kOdkilA.png"/></div></figure><p id="4586" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在哪里</p><ul class=""><li id="c9b5" class="ju jv hh ig b ih ii il im ip jw it jx ix jy jb jz ka kb kc bi translated">带帽子的y是我们预测的结果</li></ul><p id="6cec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">嗯，这看起来像是某个3d图形的方程式。我们来画一下:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es kw"><img src="../Images/1b4adb6144dd8fbcc9411f950e1d0f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4I-Wx1SReH7No-cvZ2VnDQ.png"/></div></div></figure><p id="c76f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这让我想起一张对折的纸。</p><p id="e0cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">显然，我们应该找到这样的w_0_0和w_1_0，使得我们的“z”坐标(也就是我们的误差)等于0(这是一条“折叠”线)。很符合逻辑，不是吗？我们需要最小化误差，也就是最小化“z”坐标。</p><p id="b61f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">怎样才能有效做到最小化？从数学的角度来看，我们可以找到极值点(在我们的例子中是最小值)，在这里<em class="kx">切线</em>(或者在我们的例子中是切面)接触曲线(或者在我们的例子中是曲面)。要找到这样一条线，只需要得到函数的全局最小点的导数。在这一点上，我们的导数总是等于零。</p><p id="c4ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为什么是最小点？因为我们只关心找到尽可能小的误差。</p><p id="578b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们对3d表面进行2d投影，并尝试绘制切线:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ky"><img src="../Images/a43f6e646d618c70466a6965173f65f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y2ID9K57AYYLL__sC07bHg.png"/></div></div></figure><p id="4720" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">粉色线是我们的切线。等等，这是唯一可能的切线吗？如果我们画出以下内容会怎么样:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es ky"><img src="../Images/5aebd09164de99dd70baae942c3f22c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aE2e6xlmvrfLw5rHU1s9JQ.png"/></div></div></figure><p id="e13a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看起来我们可以在这个函数的最小点画出无限多条切线，这意味着导数在我们的例子中没有定义。最好选择另一个功能。</p><p id="450a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，让我们问自己:我们如何消除负面价值真的重要吗，它改变了什么吗？显然不是。我们可以简单地用<em class="kx">平方误差</em>代替绝对误差:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kz"><img src="../Images/be0ffead66cbe23394fe02a9a0ae7fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:186/format:webp/1*Qr9cQnrdmu7NjnPlU2OS_A.png"/></div></figure><p id="4cac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">效果是一样的，但是函数现在有了导数。我们来看剧情:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="er es la"><img src="../Images/d5a98fcd77ef11f9d1ef1e75401a2476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S1n7HSx848A5Z8rXSqxG1g.png"/></div></div></figure><p id="0cae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从几何角度来看，我们只能在全局极小点处画一条切线。太好了，平方误差是我们最好的选择。</p><p id="7d2e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在找到合适的w0 _ 0和w1 _ 0要容易得多，因为我们有一个误差函数要最小化，所以我们有一个运动方向。</p><p id="a659" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">恭喜，我们刚刚推断出普通最小二乘法的目标函数！让我们再看一遍函数并记住它:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kz"><img src="../Images/0ce0467caa1cfc9ecc7d7b2b65acc265.png" data-original-src="https://miro.medium.com/v2/resize:fit:186/format:webp/1*-ZmRLR1_ZLVaEaB1Y_jg5w.png"/></div></figure><p id="d3be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是统计学和机器学习最重要的事情之一。普通最小二乘法的主要目标是最小化“y”和“带帽子的y”项之间的平方差。</p><p id="40b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以问我，如何把这个函数应用到实际的数据集上？要在多个数据点的上下文中使用该函数，我们应该找到数据集每个点的平方差，并将所有结果相加。让我们用10和20作为w_0_0和w_1_0的值:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lb"><img src="../Images/ca7b395907c2af9e679c7643a12fff4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*HDECf76L7zJMN5plM6BOvQ.png"/></div></figure><p id="2603" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦我们找到最小可能的平方误差，这意味着我们达到了我们的目标，我们可以使用w0 _ 0和w1 _ 0系数进行预测。</p><p id="8e0a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">目前为止的误差是368123020300，太多了。我们一定要提高我们的w0 _ 0和w1 _ 0系数的值。有几种方法可以找到最佳值，其中之一是<a class="ae jc" rel="noopener" href="/mlearning-ai/ordinary-least-squares-closed-form-solution-the-dart-way-d7c0ee0e0d02?source=friends_link&amp;sk=9ba5a9da7fd3160b28c450ff6dc446a4">我们的平方误差</a>的闭式解。</p><p id="6d4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">差不多就是这样，</p><p id="7ba2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">感谢您的阅读！</p><div class="lc ld ez fb le lf"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lg ab dw"><div class="lh ab li cl cj lj"><h2 class="bd hi fi z dy lk ea eb ll ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lm l"><h3 class="bd b fi z dy lk ea eb ll ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ln l"><p class="bd b fp z dy lk ea eb ll ed ef dx translated">medium.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt jl lf"/></div></div></a></div></div></div>    
</body>
</html>