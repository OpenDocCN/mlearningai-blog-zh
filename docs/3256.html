<html>
<head>
<title>Data Cleaning with SQL Server — Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SQL Server清理数据—演练</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/data-cleaning-with-sql-server-walkthrough-e4521447e7ae?source=collection_archive---------3-----------------------#2022-08-11">https://medium.com/mlearning-ai/data-cleaning-with-sql-server-walkthrough-e4521447e7ae?source=collection_archive---------3-----------------------#2022-08-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="bda4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最好保持干净！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/ca485788287bb06ad5eef2dfb4502e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cilm6DLWyv4nohGzkl44rA.png"/></div></div></figure><p id="0f15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据清理是数据分析师/科学家最重要的步骤之一，因为所有分析的结果/见解都取决于所用数据的质量。数据质量是对数据集可信度的一种衡量，因此可以从中获得真知灼见。如果我们得到原始数据并开始分析它，几乎可以肯定它会给我们不可靠的结果。</p><p id="5d20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有许多清理数据的技术，其中大部分深入到:删除重复数据、转换错误的数据类型(例如，字符串、整数、浮点、日期时间)、修复字符串输入错误、处理缺失值等。</p><p id="cc9a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个项目中，将对从美国收集的数据集进行简单的数据清理，并关注纳什维尔的城市住宅。</p><p id="a342" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果想查看这里用到的所有查询，可以查看我的<a class="ae jo" href="https://github.com/vitorxavierg/Portfolio_Projects/blob/4f8de1324745c549a849c95fa4d6c3f0a2f6f18b/SQL_DataCleaning" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> GitHub。</strong>T3】</a></p><p id="4e73" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们正在经历的步骤是:</p><ul class=""><li id="9561" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated"><strong class="ig hi">探索数据集(1) </strong></li><li id="f9ad" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated"><strong class="ig hi">标准化日期格式(二)</strong></li><li id="a59f" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated"><strong class="ig hi">删除缺失数据(3) </strong></li><li id="1503" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated"><strong class="ig hi">将列的内容分解成不同的列(4) </strong></li><li id="bc33" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated"><strong class="ig hi">修复字符串错别字(5) </strong></li><li id="011f" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated"><strong class="ig hi">删除重复的行(6) </strong></li></ul></div><div class="ab cl kd ke go kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ha hb hc hd he"><p id="b9f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> (1) —探索数据集</strong></p><p id="276f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以，让我们开始吧！首先，让我们看一下数据集，并检查我们是否可以注意到数据中的任何不规则性:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="4d31" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的查询有以下结果(附注:为了更好的可视化，我分两次发布):</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es km"><img src="../Images/d639991ecf6890db1e502ccd82b2004f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GZEx_FD47Sj4ipGm--JJg.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kn"><img src="../Images/fa547b386d60d2a9894d087d2841610f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*F0rRt6EEIS0jK-QlElw4iQ.png"/></div></figure><p id="8dce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> (2) —标准化日期格式</strong></p><p id="aab9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，可以看到在<strong class="ig hi"> <em class="ko">销售日期</em> </strong>一栏中，日期后面有时间“00:00:00:000”。在这种情况下，时间并不重要，所以我们将把它去掉，只得到日期。</p><p id="b12a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为此，让我们使用<strong class="ig hi">转换</strong>功能进行测试:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kp"><img src="../Images/80a7372a7ebd541f250b7d85c46a14c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*UBzhnY8VVE1mrjmzWAJT3Q.png"/></div></figure><p id="3ef6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们在数据集中创建一个新列，并用<strong class="ig hi"> <em class="ko"> New_SaleDate </em> </strong>列日期值填充它:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="9730" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">已经创建并填充了<strong class="ig hi"> <em class="ko">新销售日期</em> </strong>列:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kq"><img src="../Images/910552740136b6b89c7d4212fc4c69f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-cj10ss0ym3qOJ27ad7jw.png"/></div></div></figure><p id="e6cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> (3) —删除缺失数据</strong></p><p id="45a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">进一步研究数据集，可以发现有些行没有属性地址寄存器:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kr"><img src="../Images/17757c603182c67b4d901f14c5ac6a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*vfci7pjfKaqcoRIjukC58Q.png"/></div></figure><p id="28cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们知道属性地址永远不会改变，因此我们几乎可以肯定地说，如果我们有另一个具有相同参考点的行，并且该行具有针对<strong class="ig hi"><em class="ko">property address</em></strong>列的寄存器，则可以填充空值。我们用例子来看，这样更容易理解:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ks"><img src="../Images/16248faa4ce7169326327c74c2ed3449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*f4bCiB7RO4GSTeGlNnuTEg.png"/></div></figure><p id="dd5a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可见，在同一<strong class="ig hi"> <em class="ko"> ParcelID </em> </strong>注册的寄存器将始终具有相同的<strong class="ig hi"> <em class="ko"> PropertyAddress </em> </strong>。因此，在向相同的<strong class="ig hi"> <em class="ko"> ParcelID </em> </strong>注册的情况下，我们可以用具有相同<strong class="ig hi"> <em class="ko"> ParcelID </em> </strong>的其他寄存器来填充缺失的<strong class="ig hi"><em class="ko">property address</em></strong>(只有当其他寄存器具有<strong class="ig hi"><em class="ko">property address</em></strong>的值时，才能执行此操作)。</p><p id="9198" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，为了做到这一点，有必要找到一种方法来区分具有相同<strong class="ig hi"><em class="ko">parceled</em></strong>的行，以便应用<strong class="ig hi"> SQL </strong>。为此，我们将筛选具有相同<strong class="ig hi"> <em class="ko"> ParcelID </em> </strong>但具有不同<strong class="ig hi"> <em class="ko"> UniqueID </em> </strong>的行:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kt"><img src="../Images/176eb7d7be7054ff01a3c53ada5343e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*LvY-Q1ZVMKqOPYdDgbiR9A.png"/></div></figure><p id="f6e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上图可以看出，存在重复的<strong class="ig hi"><em class="ko">parcelets</em></strong>对于<strong class="ig hi"><em class="ko">property address</em></strong>列同时具有注册值和空值。现在，让我们使用<strong class="ig hi"> ISNULL </strong>函数测试填充缺失值:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ku"><img src="../Images/d50532fff5e3acc1d4b14d2bb3c03a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AUrVRkxrJya9nZXWWG37Tg.png"/></div></div></figure><p id="8521" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们创建了<strong class="ig hi"> <em class="ko"> Filling_Test </em> </strong>列来测试null<strong class="ig hi"><em class="ko">property address</em></strong>值基于<strong class="ig hi"> <em class="ko"> ParcelID </em> </strong>作为参考。在了解它的工作原理之后，现在让我们使用<strong class="ig hi"> UPDATE </strong>来填充它:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="5a3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，它已经被填充，让我们再次执行以下查询:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="d6f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"><em class="ko">property address</em></strong>没有空值，确认更新成功:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/665150d74a3ea1b855a53dae69b8aa69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zgIK3xILjvys10RLoQhZrA.png"/></div></div></figure><p id="09e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> (4) —将专栏内容拆分为不同的专栏</strong></p><p id="45c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们更仔细地看看<strong class="ig hi"><em class="ko">ownerraddress</em></strong>一栏:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kw"><img src="../Images/b9041dac52a97f19128878e0414e96a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*xc4VMLMUMYM732fw4-EW3A.png"/></div></figure><p id="6035" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们拥有所有人的地址、城市和州，用逗号分开。最好将这些属性分为不同的列，以便获得更好的数据质量和组织，从而可以从中获得更好的见解。在这种情况下，让我们使用<strong class="ig hi"> PARSENAME </strong>函数:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kx"><img src="../Images/871c329dfd3e1b30c0f044b2d72c4922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x-_Q8lZEr3b-x4KgNqA9Fw.png"/></div></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="2069" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">返回:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ky"><img src="../Images/c1dace21495e02431a89d54ad8663fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*lPSpMwtzSkFMzmfxUjrBmw.png"/></div></figure><p id="453d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，我们还在查询中使用了<strong class="ig hi"> REPLACE </strong>函数，因为<strong class="ig hi"> PARSENAME </strong>函数的标准分隔符是点，所以我们必须将所有的逗号(，)转换为点(。)，之后应用<strong class="ig hi"> PARSENAME </strong>功能。</p><p id="e3db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下一步是创建列<strong class="ig hi"><em class="ko">SplittedOwnerAddress</em></strong>、<strong class="ig hi"><em class="ko">SplittedOwnerCity</em></strong>和<strong class="ig hi"><em class="ko">SplittedOwnerState</em></strong>，并填充它们:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="9b1d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们可以看到表中的新列:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kz"><img src="../Images/350f0ece08f8b9feaedb291199fcc244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XW-VFs6nls5PFl7baw0aFw.png"/></div></div></figure><p id="e393" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> (5) —修复字符串错别字</strong></p><p id="31b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<strong class="ig hi"><em class="ko">soldas vacate</em></strong>列中，我们可以看到如下结果:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es la"><img src="../Images/445d35d108d025398f569362eecd65e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*b4dELdG36pWf9BXA_Cjsww.png"/></div></figure><p id="5e27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该列有四个不同的字符串，主寄存器分别为“是”和“否”，分别有4623条和51403条记录。字符串“Y”和“N”正在污染数据，因为它们复制了字符串“Yes”和“No”。</p><p id="41ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们将' Y '和' N '字符串转换为' Yes '和' No '，这样我们就可以有一个标准化的列:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lb"><img src="../Images/935e08d5e4048bfffa078041413da6b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*PhFWu-8SHUN8uI9QDJB7dg.png"/></div></figure><p id="d203" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，是时候对<strong class="ig hi">更新</strong><strong class="ig hi"><em class="ko">soldas vacate</em></strong>列进行如下转换了:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="ac66" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">更新后，让我们对同一列应用<strong class="ig hi"> DISTINCT </strong>函数，看看它是否还有任何重复的字符串:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="98ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是结果:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lc"><img src="../Images/ee96ca3f2ef8c781d25d59b1463a8070.png" data-original-src="https://miro.medium.com/v2/resize:fit:270/format:webp/1*Yiikvr2nMV0v4cECJMVl6w.png"/></div></figure><p id="4910" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">删除了“y”和“N ”,现在我们有了一个标准化的色谱柱，经过清洗，质量良好，可用于将来的分析。</p><p id="afc1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> (6) —删除重复行</strong></p><p id="cf49" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后一步是删除重复的行。由于删除数据库中的行不是一种标准做法，我们将使用<strong class="ig hi">公共表表达式(CTE) </strong>和<strong class="ig hi">窗口函数</strong>删除重复的行。</p><p id="6d86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们首先假设，对于这个数据集，每次我们有相同的<strong class="ig hi"> <em class="ko"> ParcelID、PropertyAddress、SaleDate、SalePrice和LegalReference </em> </strong>具有相同的值，它们肯定是重复的寄存器。</p><p id="547a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以，第一步是应用<strong class="ig hi">窗口函数</strong>和<strong class="ig hi">分区</strong> <strong class="ig hi">到</strong>我们在上一段引用的列，并按我们知道没有任何重复的唯一列对它们进行排序:<strong class="ig hi"> <em class="ko"> UniqueID </em> </strong>。结果如下:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ld"><img src="../Images/357741f64cdb21e483587c858f5ccc78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UvV6DMkuWLAqYhFvBeiwBQ.png"/></div></div></figure><p id="ffd9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以看出，在<strong class="ig hi">窗口函数</strong>中，如果参数划分的<strong class="ig hi">相同，则开始统计重复记录的数量。</strong></p><p id="6455" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建了<strong class="ig hi"> <em class="ko"> ROW_NUM </em> </strong>列后，我们现在可以将<strong class="ig hi">窗口函数</strong>放入<strong class="ig hi"> CTE </strong>中，之后只过滤具有<strong class="ig hi"><em class="ko">ROW _ NUM</em></strong>&gt;1的寄存器。这样，我们保证所有重复的行将被考虑:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es le"><img src="../Images/469cf5151b3a172fb4e0c3c741f18c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:216/format:webp/1*MXfJAVw23PC8qxyt-ZCwIA.png"/></div></figure><p id="13b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有104行有重复值。现在，让我们把它们从<strong class="ig hi"> CTE </strong>中删除:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><p id="4090" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在检查在<strong class="ig hi"> CTE </strong>中是否有任何重复的行，我们使用相同的查询:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kk kl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lf"><img src="../Images/9838a85fa9282b04205f34c42ef426f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_zSHq2FHK80aYOPSXq3FwQ.png"/></div></div></figure><p id="404e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在不再有重复的行，我们有了一个更干净的数据集。</p></div><div class="ab cl kd ke go kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="ha hb hc hd he"><p id="747e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">仅此而已！！我们已经完成了数据清理演练…</p><p id="66da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个数据集中还有更多的清理工作要做，使用这些SQL工具可以更进一步，做更多的工作。</p><p id="ca16" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢大家，希望你喜欢这个帖子。</p><p id="c845" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你能对这个帖子发表评论，提出你的反馈，分享你的经验，我会非常满意的！</p><p id="e15b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们也在<a class="ae jo" href="https://www.instagram.com/vitorxavierg/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> Instagram </strong> </a>或者<a class="ae jo" href="https://www.linkedin.com/in/vitor-xavier-guilherme-6866a3204/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> Linkedin </strong> </a>上连线吧。</p><p id="fddb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">再见，下次见。</p><p id="b665" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">:)</p><div class="lg lh ez fb li lj"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lk ab dw"><div class="ll ab lm cl cj ln"><h2 class="bd hi fi z dy lo ea eb lp ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lq l"><h3 class="bd b fi z dy lo ea eb lp ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lr l"><p class="bd b fp z dy lo ea eb lp ed ef dx translated">medium.com</p></div></div><div class="ls l"><div class="lt l lu lv lw ls lx jm lj"/></div></div></a></div></div></div>    
</body>
</html>