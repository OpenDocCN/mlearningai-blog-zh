<html>
<head>
<title>Image Classification with TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">张量流图像分类</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/image-classification-with-tensorflow-2-54fc601dfb6a?source=collection_archive---------1-----------------------#2021-04-16">https://medium.com/mlearning-ai/image-classification-with-tensorflow-2-54fc601dfb6a?source=collection_archive---------1-----------------------#2021-04-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><h2 id="935d" class="hf hg hh bd b fp hi hj hk hl hm hn dx ho translated" aria-label="kicker paragraph">深度学习教程</h2><div class=""/><div class=""><h2 id="a3ea" class="pw-subtitle-paragraph in hq hh bd b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je dx translated">一个如何进行图像分类的实例。</h2></div><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jf"><img src="../Images/065617729e1b40e736e0dd9a5b02dbd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QzpWxnDtQP3Xp6jS"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">Photo by <a class="ae jv" href="https://unsplash.com/@joshsrose?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Josh Rose</a> on <a class="ae jv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="11dd" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">计算机视觉是机器学习的重要研究领域之一，在机器人、健康、无人机、无人驾驶汽车、体育和娱乐等领域有着广泛的应用。</p><p id="b035" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">在本文中，我将讨论以下主题:</p><ul class=""><li id="09a8" class="ks kt hh jy b jz ka kc kd kf ku kj kv kn kw kr kx ky kz la bi translated">什么是计算机视觉？</li><li id="e414" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">正在加载数据集</li><li id="20c2" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">数据预处理</li><li id="c71f" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">模型结构</li><li id="d411" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">评估模型</li><li id="f005" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">预测新图像</li></ul><p id="0ba1" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们开始吧！</p><h1 id="b3f9" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">什么是计算机视觉？</h1><p id="1e60" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">计算机视觉是人工智能的一个分支，研究如何让计算机从数字图像或视频中获得高层次的理解。它还涵盖了从多个图像和视频序列中重建3D场景的方法，在医学领域，它涵盖了器官分割、肿瘤检测和乳房x线照片中的微钙化检测。</p><p id="3ca7" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们来看看计算机视觉应用的一些例子有:</p><ul class=""><li id="5382" class="ks kt hh jy b jz ka kc kd kf ku kj kv kn kw kr kx ky kz la bi translated">产品的自动化检测</li><li id="75f0" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">安全和监控</li><li id="0d91" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">制造过程的优化</li><li id="df3c" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">自动驾驶汽车</li><li id="987a" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">生物测定学</li><li id="f5bc" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">基于内容的图像检索</li><li id="3e47" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">医学图像分析</li><li id="8336" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">机器人视觉。</li></ul><h1 id="02ba" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">正在加载数据集</h1><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es md"><img src="../Images/4205f1da9139e2f5f1c92bd75bf0f04e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RVTO4vIek8O5B6d7O1pwGw.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx">Fashion MNIST dataset</figcaption></figure><h2 id="9280" class="me lh hh bd li mf mg mh lm mi mj mk lq kf ml mm ls kj mn mo lu kn mp mq lw hn bi translated">什么是时尚MNIST数据集？</h2><p id="be39" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">我将要使用的数据集是<a class="ae jv" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">时尚MNIST数据集</a>。与经典的MNIST数据集不同，该数据集包含时尚物品的图像，而不是数字的图像。时尚MNIST数据集中的类比经典MNIST数据集中的类种类更多。因此，对该数据集中的影像进行分类比对经典MNIST数据集中的影像进行分类更加困难。</p><p id="b33b" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">时尚MNIST数据集由70，000幅灰度图像和10个类别组成。60，000幅图像用于训练网络，10，000幅图像用于评估网络学习分类图像的准确程度。这些图片展示了尺寸为28 x 28像素的时尚单品。使用时尚MNIST数据集进行分析是计算机视觉的“Hello World”。该数据集相对较小，因此易于构建和测试计算机视觉模型。可以直接用TensorFlow加载这个数据集。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="2522" class="me lh hh ms b fi mw mx l my mz">import tensorflow as tf<br/>fashion_mnist = tf.keras.datasets.fashion_mnist<br/>(X_train, y_train), (X_test, y_test) = fashion_mnist.load_data()</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es na"><img src="../Images/93cf9ae47c0c25593500d02eb0bdc1d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGyDU8GRYAz3wpWZLEdMQA.png"/></div></div></figure><p id="4106" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">当加载数据集时，返回四个NumPy数组。X_train和y_train数组用于训练模型。X_test和y_test数组用于测试模型。图像中的像素是从0到255的整数。让我们看看训练集和测试集的形状和数据类型。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="b1f3" class="me lh hh ms b fi mw mx l my mz">X_train.shape, X_test.shape</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nb"><img src="../Images/3586680bf5ac8fd5e827073aade32905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7_KAPYNR3o4YP1pYF2u7Dg.png"/></div></div></figure><h1 id="98eb" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">数据预处理</h1><p id="9dac" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">数据预处理是数据分析的重要步骤之一。在训练网络之前，必须对数据进行预处理。数据集中的标签由数字组成。我们把这些数字对应的时尚单品名称赋给一个变量。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="b61e" class="me lh hh ms b fi mw mx l my mz">class_names = ["T-shirt / top", "Trouser", "Pullover", "Dress",<br/>        "Coat", "Sandal", "Shirt", "Sneaker", "Bag", "Ankle boot"]</span></pre><p id="698c" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们使用matplotlib库来查看第二个图像。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="7a31" class="me lh hh ms b fi mw mx l my mz">import matplotlib.pyplot as plt<br/>plt.figure()<br/>plt.imshow(X_train[1])<br/>plt.colorbar()<br/>plt.grid(False)<br/>plt.show()</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es nc"><img src="../Images/8959e01c0da269608f557cdcbb7ba6fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*eC2XAkZQuauPjlP2e_9nOw.png"/></div></figure><p id="46c4" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">可以看到像素值在0到255之间。</p><h2 id="aa5e" class="me lh hh bd li mf mg mh lm mi mj mk lq kf ml mm ls kj mn mo lu kn mp mq lw hn bi translated">标准化数据集</h2><p id="d0e0" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">让我们缩放输入以提高模型的训练速度和性能。您可以通过将条目的像素除以255来实现这一点。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="b5be" class="me lh hh ms b fi mw mx l my mz">X_train = X_train / 255.0<br/>X_test = X_test / 255.0</span></pre><h1 id="2d75" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">模型结构</h1><p id="b9cc" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">要构建神经网络，必须配置模型的层，然后才能编译模型。现在让我们使用顺序API来调整模型的层。</p><p id="eb4e" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">神经网络的基本块是层。图层从数据中提取制图表达。你希望这些表述对你正在处理的问题有意义。大多数深度学习模型是由层的链式链接形成的。让我们开始建立模型。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="2a19" class="me lh hh ms b fi mw mx l my mz">model = tf.keras.Sequential([<br/>   tf.keras.layers.Flatten(input_shape = (28, 28), name = "Input"),<br/>   tf.keras.layers.Dense(128, activation='relu', name = "Hidden"),<br/>   tf.keras.layers.Dense(10, name = "Output")<br/>])</span></pre><p id="92e8" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们一行一行地检查我写的这些代码。</p><p id="d21b" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><strong class="jy hr"> (1) </strong>第一行创建一个<code class="du nd ne nf ms b">Sequential</code>模型。顺序模型是Keras最简单的模型。在顺序模型中，各层按顺序排列。</p><p id="35af" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><strong class="jy hr"> (2) </strong>在下一行，我写了<code class="du nd ne nf ms b">Flatten</code>层，添加到模型中。平面层将28 x 28像素的输入图像转换为一维数组(28 * 28 = 784)。这一层不带任何参数，只改变数据的格式。</p><p id="4bc5" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><strong class="jy hr"> (3) </strong>在下一行，我给模型添加了一个隐藏的由128个神经元组成的<code class="du nd ne nf ms b">Dense</code>层。我在这一层使用了<code class="du nd ne nf ms b">ReLU</code>激活功能。致密层连接前一层的所有神经元。每个密集层都有其权重矩阵，该层包含输入和输出之间的所有权重。</p><p id="d702" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><strong class="jy hr"> (4) </strong>最后我加了一个<code class="du nd ne nf ms b">Dense</code>层，有10个神经元，每个类一个神经元。最后一层返回10个长度的logit数组。每个神经元包含一个分数，表明该图像属于10类中的一类。<code class="du nd ne nf ms b">summary</code>方法显示了模型的所有层以及层的名称。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="f1f7" class="me lh hh ms b fi mw mx l my mz">model.summary()</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ng"><img src="../Images/ab3eca7e583a6ceae1d7277c83cbbeb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-x-SEJralGY-f1UlBE7fg.png"/></div></div></figure><p id="7edb" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">请注意，如果不命名层，层名称将由Keras自动生成。输出中None的意思是批处理大小可以是任何值。参数总数显示在总结的末尾。您可以很容易地获得带有模型索引或名称的图层列表。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="ff06" class="me lh hh ms b fi mw mx l my mz">model.layers</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ng"><img src="../Images/52755474088843b0aef942da1d993490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kB0AFFB3fz_Fn_n-I8fyVA.png"/></div></div></figure><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="4bc2" class="me lh hh ms b fi mw mx l my mz">hidden = model.layers[1]<br/>print(hidden.name)</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nh"><img src="../Images/4a41eb84b9ea0385620637ee6326ed6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDb3PQEIpqFJJvIuDPNkeg.png"/></div></div></figure><p id="ed31" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">可通过<code class="du nd ne nf ms b">get_weights</code>和<code class="du nd ne nf ms b">set_weights</code>方法访问层的所有参数。让我们看看第一层的权重和偏差。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="cc07" class="me lh hh ms b fi mw mx l my mz">weights, biases = hidden.get_weights()<br/>print(weights)</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ni"><img src="../Images/80fbd606f4314a0226855d5d0ae3040f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*70w1XtyB2pi9qW7oeiyKrA.png"/></div></div></figure><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="3f9a" class="me lh hh ms b fi mw mx l my mz">print (biases)</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nj"><img src="../Images/f96faa5a1dbbf6a1e5795b44da69ffa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4TTlwdgBfEydTLBIfHw8Q.png"/></div></div></figure><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="d8b9" class="me lh hh ms b fi mw mx l my mz">weights.shape, biases.shape</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nk"><img src="../Images/2cca3814c625a085bd1e5826c40d9aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LaamjX6S5pLIB61n6HRd2Q.png"/></div></div></figure><p id="e4f6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">请注意，第一个密集层的权重是随机的，偏差初始化为零。还可以分别使用kernel_initializer和bias_initializer方法初始化层中的权重和偏差。关于这些方法的更多信息可以在<a class="ae jv" href="https://keras.io/initializers/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="0dbe" class="me lh hh bd li mf mg mh lm mi mj mk lq kf ml mm ls kj mn mo lu kn mp mq lw hn bi translated">编译模型</h2><p id="e09a" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">在开始模型的训练之前，需要用<code class="du nd ne nf ms b">compile</code>的方法编译模型。编译时，确定损失函数和优化器。或者，可以使用额外的指标来查看培训和评估期间的计算。</p><p id="cf24" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><code class="du nd ne nf ms b">loss</code>函数测量模型在训练期间预测的准确度。我们希望最小化这个函数，以便将模型引向正确的方向。<code class="du nd ne nf ms b">optimizer</code>根据损失函数和它看到的数据更新模型。<code class="du nd ne nf ms b">metrics </code>用于监控训练和测试步骤。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="deea" class="me lh hh ms b fi mw mx l my mz">model.compile(loss = tf.keras.losses.SparseCategoricalCrossentropy(<br/>                         from_logits = True),<br/>              optimizer = 'adam',<br/>              metrics = ['accuracy'])</span></pre><p id="e9e6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们检查一下这些代码。</p><p id="48e3" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><strong class="jy hr"> (1) </strong>我用<code class="du nd ne nf ms b">SparseCategoricalCrossentropy</code>作为损失函数，因为有从0到9的标签。如果您使用一键编码对标签进行编码，您可以使用<code class="du nd ne nf ms b">CategoricalCrossentropy</code>损失功能。</p><p id="8b33" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><strong class="jy hr"> (2) </strong>我用的是<code class="du nd ne nf ms b">adam</code>作为优化器，近几年流行的。</p><p id="90d8" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><strong class="jy hr"> (3) </strong>因为我们处理的问题是分类，所以我用<code class="du nd ne nf ms b">accuracy</code>作为度量。</p><h2 id="e3b8" class="me lh hh bd li mf mg mh lm mi mj mk lq kf ml mm ls kj mn mo lu kn mp mq lw hn bi translated">训练模型</h2><p id="3943" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">该模型在训练期间学习图像和标签之间的关系。现在我们可以通过调用<code class="du nd ne nf ms b">fit</code>方法来训练模型。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="1618" class="me lh hh ms b fi mw mx l my mz">history = model.fit( X_train, y_train, <br/>                     epochs = 10, <br/>                     validation_split = 0.1)</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nl"><img src="../Images/fa307d4c03f7b84c64b760249b51cd29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ZgAp7QkU1czfeHnH2z2Wg.png"/></div></div></figure><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nm"><img src="../Images/89eaa59f7c54d488aa585c81d332c3c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQsk-IlzgP9puRrCWHaOGA.png"/></div></div></figure><p id="95e3" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">训练集在训练模型时使用。用验证数据评估模型。您可以使用<code class="du nd ne nf ms b">validation_split</code>参数分离一些数据进行验证。通过在此参数中键入0.1，我希望10%的训练数据用于验证。</p><p id="91d6" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">在训练模型时，在每个时期结束时显示损失和准确性度量。监控这些指标对于查看模型的实际性能非常有用。如果训练集中模型的准确性优于验证集，则可能存在过拟合问题。</p><p id="5721" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如您所见，损失值在每个时期都在减少。这意味着模型从数据中学习。10个周期后，训练和验证的准确度被写在屏幕上。</p></div><div class="ab cl nn no go np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ha hb hc hd he"><p id="86a1" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><code class="du nd ne nf ms b">fit</code>方法返回一个包含训练参数的<code class="du nd ne nf ms b">History</code>对象。<code class="du nd ne nf ms b">history.history</code>是字典的形式。该字典包括在训练和验证集中每个时期之后测量的度量和损失。如果您将该字典结构转换为Pandas DataFrame结构并使用<code class="du nd ne nf ms b">plot</code>方法，您可以绘制训练曲线。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="257d" class="me lh hh ms b fi mw mx l my mz">import pandas as pd<br/>pd.DataFrame(history.history).plot(figsize = (8, 5))<br/>plt.grid(True)<br/>plt.show()</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div class="er es nu"><img src="../Images/91f576652ca282b4d88ebfac5857060c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*tj0RN2ZfRAy_TANlljO1iw.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx">Accuracy and loss for train and validation sets</figcaption></figure><p id="f309" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">从图中可以看出，模型在训练和验证数据方面的准确性提高了，而训练和验证方面的损失减少了。</p><p id="f28a" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如果模型表现不佳，您可以调整超参数。你应该检查的第一个参数是学习率。如果更改这个参数不起作用，您可以选择不同的优化器。如果模型的性能仍然没有提高，那么你可以改变层的数量，每层中神经元的数量，以及隐藏层中的激活函数。您还可以将参数设置为<code class="du nd ne nf ms b">batch_size</code>，这是<code class="du nd ne nf ms b">fit</code>方法中的默认参数32。</p><h1 id="c654" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">评估模型</h1><p id="65c6" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">我用训练数据建立了模型。您可能想看看模型如何预测它以前没有见过的数据。为了评估该模型，使用了在训练期间未使用的测试集。</p><p id="457d" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">让我们调用<code class="du nd ne nf ms b">evaluate</code>方法，通过使用测试集来评估模型。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="edab" class="me lh hh ms b fi mw mx l my mz">test_loss, test_acc = model.evaluate (X_test, y_test, verbose = 2)<br/>print ('\ nTest accuracy:', test_acc)</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nv"><img src="../Images/b5f0e0288b617f4296c1f02ebd6a16e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-LKVUz43GIpNqLyCmyi3pQ.png"/></div></div></figure><p id="c33b" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">模型在测试集上的准确性略低于在训练数据上的准确性。训练精度和测试精度之间的这种差异表明了过拟合问题。这个问题说明模型在记忆。换句话说，虽然模型可以很好地预测训练数据，但它无法预测以前没有见过的数据。我在L1、L2或上节课中使用的正则化技术可以用来克服这个问题。</p><h1 id="113c" class="lg lh hh bd li lj lk ll lm ln lo lp lq iw lr ix ls iz lt ja lu jc lv jd lw lx bi translated">做一个预测</h1><p id="4858" class="pw-post-body-paragraph jw jx hh jy b jz ly ir kb kc lz iu ke kf ma kh ki kj mb kl km kn mc kp kq kr ha bi translated">您可能希望使用您训练的模型来预测新图像。模型的线性输出是logit。您可以通过添加softmax图层将逻辑转换为可能性，以便于解释。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="53ac" class="me lh hh ms b fi mw mx l my mz">probability_model = tf.keras.Sequential (<br/>            [model, tf.keras.layers.Softmax()])</span></pre><p id="0b11" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">我们根据这个模型来估算一下测试数据。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="99dc" class="me lh hh ms b fi mw mx l my mz">predictions = probability_model.predict(X_test)</span></pre><p id="cdca" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">因此，该模型预测了测试集上每张图片的标签。我们先来做个预测。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="eefa" class="me lh hh ms b fi mw mx l my mz">predictions [0]</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nw"><img src="../Images/51ad99ce2526fbe8e62a8f691df79ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gbD87UMBlJ389ecC3HtjKg.png"/></div></div></figure><p id="2f44" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">注意，返回了对应于每个时尚项目的10种可能性。使用NumPy中的<code class="du nd ne nf ms b">argmax</code>方法可以看到概率最高的标签。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="2534" class="me lh hh ms b fi mw mx l my mz">import numpy as np<br/>np.argmax(predictions[0])</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nk"><img src="../Images/a565084b14195d2ef123405a8ff7b847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kI-idpETN497S8DP4jQn2w.png"/></div></div></figure><p id="53cf" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">该模型预测第一个图像为踝靴。让我们来看看第一张图片的实际标签。</p><pre class="jg jh ji jj fd mr ms mt mu aw mv bi"><span id="72ff" class="me lh hh ms b fi mw mx l my mz">y_test[0]</span></pre><figure class="jg jh ji jj fd jk er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es nk"><img src="../Images/a565084b14195d2ef123405a8ff7b847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kI-idpETN497S8DP4jQn2w.png"/></div></div></figure><p id="2490" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如您所见，模型做出了正确的预测。</p></div><div class="ab cl nn no go np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ha hb hc hd he"><p id="621d" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">就是这样。在博文中，我解释了使用MNIST数据集进行影像分类的以下主题:</p><ul class=""><li id="5960" class="ks kt hh jy b jz ka kc kd kf ku kj kv kn kw kr kx ky kz la bi translated">什么是计算机视觉？</li><li id="9b2a" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">构建模型</li><li id="6b45" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">调谐超参数</li><li id="a288" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">评估模型</li><li id="8782" class="ks kt hh jy b jz lb kc lc kf ld kj le kn lf kr kx ky kz la bi translated">预测新图像</li></ul><p id="27c9" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">我希望你喜欢这篇文章。感谢您阅读我的文章。你可以在<a class="ae jv" href="https://github.com/TirendazAcademy/DEEP-LEARNING-WITH-TENSORFLOW/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>或<a class="ae jv" href="https://www.kaggle.com/tirendazacademy/image-classification-with-tensorflow-2-x" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>页面访问我在本文中使用的笔记本。</p><p id="5e9f" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">就是这样。感谢您的阅读。我希望你喜欢它。别忘了在YouTube上关注我们👍</p><div class="nx ny ez fb nz oa"><a href="https://heartbeat.comet.ml/7-steps-for-a-successful-deep-learning-project-1d041b7e35d3" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab dw"><div class="oc ab od cl cj oe"><h2 class="bd hr fi z dy of ea eb og ed ef hq bi translated">成功深度学习项目的7个步骤</h2><div class="oh l"><h3 class="bd b fi z dy of ea eb og ed ef dx translated">如何开发有效的深度学习项目的指南。</h3></div><div class="oi l"><p class="bd b fp z dy of ea eb og ed ef dx translated">heartbeat.comet.ml</p></div></div><div class="oj l"><div class="ok l ol om on oj oo jp oa"/></div></div></a></div><div class="nx ny ez fb nz oa"><a rel="noopener follow" target="_blank" href="/geekculture/6-steps-to-become-a-machine-learning-expert-5a1f155f7207"><div class="ob ab dw"><div class="oc ab od cl cj oe"><h2 class="bd hr fi z dy of ea eb og ed ef hq bi translated">成为机器学习专家的6个步骤</h2><div class="oh l"><h3 class="bd b fi z dy of ea eb og ed ef dx translated">成为机器学习专家需要知道的一切。</h3></div><div class="oi l"><p class="bd b fp z dy of ea eb og ed ef dx translated">medium.com</p></div></div><div class="oj l"><div class="op l ol om on oj oo jp oa"/></div></div></a></div><p id="ae97" class="pw-post-body-paragraph jw jx hh jy b jz ka ir kb kc kd iu ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如果这篇文章有帮助，请点击拍手👏按钮几下，以示支持👇</p></div></div>    
</body>
</html>