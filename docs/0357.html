<html>
<head>
<title>Understanding the scope of the variables in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解Python中变量的范围</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/understanding-the-scope-of-the-variables-in-python-d83a95b73d90?source=collection_archive---------5-----------------------#2021-03-28">https://medium.com/mlearning-ai/understanding-the-scope-of-the-variables-in-python-d83a95b73d90?source=collection_archive---------5-----------------------#2021-03-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="fb87" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">本文讨论Python中变量的范围，这是Python编程的基本概念之一。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/5c63acf00277c662fb96b2ff7fafea0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1X0-98EiQNkwBJj2vnTTqQ.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by <a class="ae jm" href="https://unsplash.com/@cdr6934?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Chris Ried</a> on <a class="ae jm" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="addd" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">变量的作用域是代码中变量可用/可访问的区域。在函数外部(即代码的主区域)声明的变量称为全局变量，在函数内部声明的变量称为该函数的局部变量。</p><pre class="ix iy iz ja fd kj kk kl km aw kn bi"><span id="3680" class="ko kp hh kk b fi kq kr l ks kt">##################<br/> GLOBAL VARIABLES<br/>##################</span><span id="97f6" class="ko kp hh kk b fi ku kr l ks kt">def x:<br/>    ################<br/>     LOCAL VARIABLE<br/>    ################</span></pre><p id="bf2e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">让我们看一个例子来更好地理解它。在下面的例子中，我们在代码的主要部分声明了一个名为“global_variable”的变量，并在函数中声明了一个名为“local_variable”的变量。</p><pre class="ix iy iz ja fd kj kk kl km aw kn bi"><span id="06da" class="ko kp hh kk b fi kq kr l ks kt">global_variable = 1</span><span id="460d" class="ko kp hh kk b fi ku kr l ks kt">def function():<br/>    local_variable = 2<br/>    return global_variable</span><span id="1eac" class="ko kp hh kk b fi ku kr l ks kt">print(f'Global variable call inside function: {function()}')<br/>print(f'Global variable call outside function: {global_variable}')<br/>print(f'Local variable: {local_variable}')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es kv"><img src="../Images/fa10b1c6546f7c59c7c44fc18954d128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*nHfCaqutL-A_oWOz0J5UbA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by author</figcaption></figure><p id="b40c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">“global_variable”可以从代码中的任何地方访问。而在函数内部声明的“local_variable”只能从该函数内部访问。我们无法从函数外部访问它。在下一个例子中，我们将在局部和全局范围内创建一个同名的变量。</p><pre class="ix iy iz ja fd kj kk kl km aw kn bi"><span id="63f8" class="ko kp hh kk b fi kq kr l ks kt">variable = 1</span><span id="4c26" class="ko kp hh kk b fi ku kr l ks kt">def function():<br/>    variable = 2<br/>    return variable</span><span id="e6bf" class="ko kp hh kk b fi ku kr l ks kt">print(f'variable call inside function: {function()}')<br/>print(f'variable call outside function: {variable}')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es kw"><img src="../Images/3b54a39a6f87159abba6e91d39a37ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*4ZrsSG9dTmHAjrVroCcgCQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by author</figcaption></figure><p id="d3e1" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">从函数内部调用的“变量”返回2，而从函数外部调用的变量返回1。这是因为Python首先在局部范围内搜索变量，然后在全局范围内搜索。这里，在函数内部声明的“变量”是局部变量，并且只在函数内部可用。</p><p id="9a84" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">可以从程序的任何地方访问全局变量。虽然我们可以从函数中访问全局变量，但是我们不能修改它。让我们在下一个例子中看到它。</p><pre class="ix iy iz ja fd kj kk kl km aw kn bi"><span id="f34c" class="ko kp hh kk b fi kq kr l ks kt">global_variable = 1</span><span id="4188" class="ko kp hh kk b fi ku kr l ks kt">def function():<br/>    global_variable += 1 #Modifying a global variable<br/>    return global_variable</span><span id="3560" class="ko kp hh kk b fi ku kr l ks kt">function()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kx"><img src="../Images/325bee9ff96e6d1fae7ccaa43b40606b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JfFqrb3g1S0dJUQ2uLF2UQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by author</figcaption></figure><p id="1537" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">当我们试图从函数中递增“global_variable”时，出现了一个错误。为了避免这个错误并从函数内部修改全局变量，我们需要使用关键字' global '。我们将在下一个例子中看到它。</p><pre class="ix iy iz ja fd kj kk kl km aw kn bi"><span id="2bd6" class="ko kp hh kk b fi kq kr l ks kt">glob_var = 1</span><span id="dcd8" class="ko kp hh kk b fi ku kr l ks kt">def function():<br/>    global glob_var #Using global keyword<br/>    <br/>    print(f'Global var inside function before increment:{glob_var}')</span><span id="b694" class="ko kp hh kk b fi ku kr l ks kt">    glob_var += 1<br/>    <br/>    print(f'Global var inside function after increment:{glob_var}')</span><span id="211d" class="ko kp hh kk b fi ku kr l ks kt"><br/>function()<br/>print(f'Global variable call outside function:{glob_var}')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ky"><img src="../Images/1be145d041b4db63346fbe611c7a4b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*IoOTSjYaeXNS09N83lCP3w.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by author</figcaption></figure><p id="c470" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在函数中使用“global”关键字声明全局变量后，我们能够在函数中修改它。</p><p id="7811" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">让我们看看嵌套函数中变量的作用域。我们将创建一个名为“fourth_power”的函数和一个名为“square”的嵌套函数。函数“fourth_power”接受一个输入参数，并将其传递给嵌套函数“square ”,后者对输入参数求平方。然后，函数“fourth_power”返回嵌套函数“square”返回的输出的平方。</p><pre class="ix iy iz ja fd kj kk kl km aw kn bi"><span id="a5da" class="ko kp hh kk b fi kq kr l ks kt">def fourth_power(x):<br/>    def square(y):<br/>        return x ** 2 #x is accessed from fourth_power<br/>    return square(x) ** 2</span><span id="3644" class="ko kp hh kk b fi ku kr l ks kt">print(f'Fourth power of 3 (3^4) is {fourth_power(3)}')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es kz"><img src="../Images/d47e668d4c31a4de602ac2d6e1619992.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*t--57sT6Kp0lPyAWzT1smw.png"/></div></figure><p id="b627" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们可以看到，函数square接受一个输入参数“y”，但返回“x**2”。但是没有错误，这是因为，最初Python在“square”的局部范围内搜索变量“x”，但是没有找到。因此，它在函数‘fourth _ power’的范围内搜索变量‘x’并使用它。因此，函数' square '返回(3 ** 2)。函数的四次方返回(3 ** 2 ** 2)即81。</p><p id="0d9b" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">类似于我们之前的一个例子，如果我们试图修改一个没有在函数的局部范围内声明的变量，我们会得到一个错误。我们将在下一个例子中看到它。</p><pre class="ix iy iz ja fd kj kk kl km aw kn bi"><span id="a15b" class="ko kp hh kk b fi kq kr l ks kt">def fourth_power(x):<br/>    def square(y):<br/>        x = x + 1 - 1 # Modifying non-local variable<br/>        return x ** 2<br/>    return square(x) ** 2</span><span id="10b3" class="ko kp hh kk b fi ku kr l ks kt">print(f'Fourth power of 3 (3^4) is {fourth_power(3)}')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es la"><img src="../Images/23c34987a9bb4eb7d927d76a661688d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*gkDE8o_vIL-rkGmKwVauoA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx">Image by author</figcaption></figure><p id="7582" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">当我们试图修改一个未在函数“square”的局部范围内声明的变量时，出现了一个错误。我们可以使用关键字“非本地”来避免这个错误。因为变量“x”不在全局范围内，所以我们不能使用“global”关键字。</p><pre class="ix iy iz ja fd kj kk kl km aw kn bi"><span id="2de4" class="ko kp hh kk b fi kq kr l ks kt">def fourth_power(x):<br/>    def square(y):<br/>        nonlocal x #Using nonlocal keyword<br/>        x = x + 1 - 1<br/>        return x ** 2<br/>    return square(x) ** 2</span><span id="ab50" class="ko kp hh kk b fi ku kr l ks kt">print(f'Fourth power of 3 (3^4) is {fourth_power(3)}')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es kz"><img src="../Images/d47e668d4c31a4de602ac2d6e1619992.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*t--57sT6Kp0lPyAWzT1smw.png"/></div></figure><p id="740c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">使用关键字' nonlocal '，我们可以修改没有在函数的局部范围内声明的变量。因为，我们将变量递增1，递减1，所以变量的值保持不变。</p><p id="3c12" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这就把我们带到了本文的结尾，我们讨论了Python中变量的作用域，以及使用“全局”和“非局部”关键字来修改没有在函数的局部作用域中声明的变量。</p></div></div>    
</body>
</html>