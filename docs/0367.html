<html>
<head>
<title>Best Practices For Your Machine Learning Workflow in Scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Scikit-learn中机器学习工作流程的最佳实践</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/best-practices-for-your-machine-learning-workflow-in-scikit-learn-2fe857bcb962?source=collection_archive---------2-----------------------#2021-03-30">https://medium.com/mlearning-ai/best-practices-for-your-machine-learning-workflow-in-scikit-learn-2fe857bcb962?source=collection_archive---------2-----------------------#2021-03-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/f38edb1eeefde644cf4faab960b558ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kSw-njRsFwVlqbTElIX8oQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo Credit: Kevin Wu via Unsplash</figcaption></figure><p id="93ed" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在我学习数据科学的过程中，我接触了大量的Scikit-learn。Scikit learn是Python最流行的机器学习库之一。在本文中，我将讨论在使用Scikit-learn库构建有效模型时需要记住的一些重要实践。</p><h1 id="327c" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">保持数据预处理的一致性</h1><p id="a8a7" class="pw-post-body-paragraph it iu hh iv b iw kp iy iz ja kq jc jd je kr jg jh ji ks jk jl jm kt jo jp jq ha bi translated">Scikit-learn提供了许多用于进行数据转换的库和方法。为模型定型时使用的任何数据集转换也必须用于测试数据或部署到生产系统中。例如，如果您使用他们的StandardScaler来缩放X train以适合您的模型，则在获取预测或模型度量时，您还必须在X_test上使用StandardScaler。不应用一致的处理步骤将导致意外结果，并导致模型无法有效执行。</p><p id="93f5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">以下代码块由Sci-kit learn的文档提供，显示了对测试数据进行预测的<strong class="iv hi">错误的</strong>方式，而没有以与用于拟合模型的训练数据相同的方式对其进行处理</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="8c9c" class="ld js hh kz b fi le lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; from</strong> <strong class="kz hi">sklearn.metrics</strong> <strong class="kz hi">import</strong> mean_squared_error</span><span id="b981" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; from</strong> <strong class="kz hi">sklearn.linear_model</strong> <strong class="kz hi">import</strong> LinearRegression</span><span id="c7c2" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; from</strong> <strong class="kz hi">sklearn.preprocessing</strong> <strong class="kz hi">import</strong> StandardScaler</span><span id="e618" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>scaler = StandardScaler()</span><span id="4f58" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>X_train_transformed = scaler.fit_transform(X_train)</span><span id="937b" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>model = LinearRegression().fit(X_train_transformed, y_train)</span><span id="0482" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>mean_squared_error(y_test, model.predict(X_test))</span><span id="e4ac" class="ld js hh kz b fi li lf l lg lh">62.80...</span></pre><p id="1151" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">下面的代码块显示了<strong class="iv hi">正确的</strong>方式</p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="1dc3" class="ld js hh kz b fi le lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>X_test_transformed = scaler.transform(X_test)</span><span id="5d9e" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>mean_squared_error(y_test, model.predict(X_test_transformed))</span><span id="7042" class="ld js hh kz b fi li lf l lg lh">0.90...</span></pre><h1 id="7d7c" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">避免数据泄露</h1><blockquote class="lj lk ll"><p id="e65e" class="it iu lm iv b iw ix iy iz ja jb jc jd ln jf jg jh lo jj jk jl lp jn jo jp jq ha bi translated">数据泄漏是指在模型训练过程中使用了在预测时预计不可用的信息，导致预测分数(指标)过高估计了模型在生产环境中运行时的效用。</p></blockquote><p id="a6b2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">数据泄漏将导致您的模型表现得比预期的要好。</p><p id="4f70" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">以下是使用Scikit-learn时为避免数据泄露需要考虑的一些事项:</p><p id="a503" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">从不符合测试数据。</p><p id="131b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">当执行特征选择算法时，仅使用训练数据。训练，先测试分割你的数据，然后对训练数据做特征选择。</p><p id="5e6a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果您使用一些平均值或其他统计数据来对数据进行特征工程、估算、缩放或其他预处理，则应仅使用基于训练子集的统计数据，否则来自训练子集的信息将会影响模型。</p><p id="6433" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">注意/避免使用泄漏预测器作为特征。你不应该使用在目标实现后更新的变量。例如，如果您正在构建一个模型来预测人们是否生病，您不应该使用人们已经服药的事实来拟合该模型。人们吃药是因为生病，而不是相反(通常情况下)。在看不见的数据上部署该模型会导致不准确的结果！</p><p id="96b9" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">错了</strong></p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="f556" class="ld js hh kz b fi le lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong><em class="lm"># Incorrect preprocessing: the entire data is transformed</em></span><span id="9ea8" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>X_selected = SelectKBest(k=25).fit_transform(X, y)</span><span id="45c0" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>X_train, X_test, y_train, y_test = train_test_split(</span><span id="3ed4" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">… </strong>X_selected, y, random_state=42)</span></pre><p id="eeb0" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">右</strong></p><pre class="ku kv kw kx fd ky kz la lb aw lc bi"><span id="542e" class="ld js hh kz b fi le lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>X_train, X_test, y_train, y_test = train_test_split(</span><span id="13f7" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">... </strong>    X, y, random_state=42)</span><span id="3d61" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>select = SelectKBest(k=25)</span><span id="5702" class="ld js hh kz b fi li lf l lg lh"><strong class="kz hi">&gt;&gt;&gt; </strong>X_train_selected = select.fit_transform(X_train, y_train)</span></pre><p id="2af2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">交叉验证测试和训练折叠也应遵循上述指南</p><h1 id="b79b" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak">管道</strong></h1><p id="eeb9" class="pw-post-body-paragraph it iu hh iv b iw kp iy iz ja kq jc jd je kr jg jh ji ks jk jl jm kt jo jp jq ha bi translated">Scikit-learn有一个名为Pipelines的对象，它将帮助您避免许多来自坏代码的上述陷阱。一位核心开发人员自己建议每个人在使用Scikit时都应该使用管道。</p><blockquote class="lj lk ll"><p id="5bfd" class="it iu lm iv b iw ix iy iz ja jb jc jd ln jf jg jh lo jj jk jl lp jn jo jp jq ha bi translated">管道允许您封装所有预处理步骤、特征选择、缩放、变量编码等等，以及您通常在单个估计器中拥有的最终监督模型。- <a class="ae lq" href="https://datascience.columbia.edu/andreas-mueller" rel="noopener ugc nofollow" target="_blank"> Andreas Muller </a>，Scikit-learn的核心开发者</p></blockquote><p id="39a7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">管道在进行交叉验证时特别有用，因为它可以防止从训练到测试折叠的数据泄漏，并允许交叉验证评分提供更准确的模型性能图。</p><h1 id="6767" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">结论</h1><p id="3a44" class="pw-post-body-paragraph it iu hh iv b iw kp iy iz ja kq jc jd je kr jg jh ji ks jk jl jm kt jo jp jq ha bi translated">现在你有了一些在使用Scikit-learn时应该遵循的重要实践，这样你的模型就可以有效地处理看不见的数据！</p><h1 id="118c" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">来源</h1><p id="0303" class="pw-post-body-paragraph it iu hh iv b iw kp iy iz ja kq jc jd je kr jg jh ji ks jk jl jm kt jo jp jq ha bi translated">https://scikit-learn.org/stable/common_pitfalls.html<a class="ae lq" href="https://scikit-learn.org/stable/common_pitfalls.html" rel="noopener ugc nofollow" target="_blank"/></p><p id="ee63" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><a class="ae lq" href="https://scikit-learn.org/stable/modules/compose.html#pipeline" rel="noopener ugc nofollow" target="_blank">https://scikit-learn . org/stable/modules/compose . html # pipeline</a></p><p id="a634" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><a class="ae lq" href="https://drgabrielharris.medium.com/python-how-scikit-learn-0-20-optimal-pipeline-and-best-practices-dc4dd94d2c09" rel="noopener">https://drgabriel Harris . medium . com/python-how-sci kit-learn-0-20-optimal-pipeline-and-best-practices-DC 4d d94 D2 c 09</a></p><p id="17f4" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><a class="ae lq" href="https://towardsdatascience.com/want-to-truly-master-scikit-learn-2-essential-tips-from-the-official-developer-himself-dada6ff56b99" rel="noopener" target="_blank">https://towards data science . com/want-to-true-master-scikit-learn-2-essential-tips-from-the-official-developer-self-dada 6 ff 56 b 99</a></p><p id="949f" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><a class="ae lq" href="https://en.wikipedia.org/wiki/Leakage_(machine_learning)" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Leakage _(机器学习)</a></p><p id="5f62" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><a class="ae lq" href="https://www.kaggle.com/dansbecker/data-leakage" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/dansbecker/data-leakage</a></p></div></div>    
</body>
</html>