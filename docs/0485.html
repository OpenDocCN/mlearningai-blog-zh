<html>
<head>
<title>ElasticNet Regression Fundamentals and Modeling in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的ElasticNet回归基础和建模</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/elasticnet-regression-fundamentals-and-modeling-in-python-8668f3c2e39e?source=collection_archive---------1-----------------------#2021-05-02">https://medium.com/mlearning-ai/elasticnet-regression-fundamentals-and-modeling-in-python-8668f3c2e39e?source=collection_archive---------1-----------------------#2021-05-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c22c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博文中，我将首先尝试解释ElasticNet回归的基础知识。然后，我们将通过Python使用数据集构建模型。最后，我们将通过计算均方差来评估模型。让我们一步一步开始吧。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/9bab1c023b7df82c7524bf4f107b80e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*2yLvkXKz_IndTF-V2tcM8w.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Resource: <a class="ae jo" href="https://www.oreilly.com/library/view/machine-learning-with/9781787121515/5c5ec380-d139-49a5-99b1-3ce32ae5bd6f.xhtml" rel="noopener ugc nofollow" target="_blank">https://www.oreilly.com/library/view/machine-learning-with/9781787121515/5c5ec380-d139-49a5-99b1-3ce32ae5bd6f.xhtml</a></figcaption></figure><h1 id="8d93" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">什么是ElasticNet回归？</h1><p id="7fca" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">ElasticNet回归的主要目的是通过对这些系数应用惩罚来找到最小化误差平方和的系数。ElasticNet结合了L1和L2(套索和山脊)方法。因此，它执行更有效的平滑过程。在另一个来源中，它被定义如下:</p><blockquote class="ks kt ku"><p id="ec96" class="ie if kv ig b ih ii ij ik il im in io kw iq ir is kx iu iv iw ky iy iz ja jb ha bi translated">弹性网最早出现是由于对Lasso的批评，其变量选择可能过于依赖数据，因此不稳定。解决方案是结合岭回归和套索的惩罚，以获得两全其美。</p></blockquote><h2 id="be87" class="kz jq hh bd jr la lb lc jv ld le lf jz ip lg lh kd it li lj kh ix lk ll kl lm bi translated">ElasticNet回归的特征</h2><ul class=""><li id="066c" class="ln lo hh ig b ih kn il ko ip lp it lq ix lr jb ls lt lu lv bi translated">它结合了L1和L2的方法。</li><li id="0bc0" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">它执行更有效的正则化过程。</li><li id="b4a9" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">它有两个参数需要设置，<em class="kv"> λ </em>和<em class="kv"> α。</em></li></ul><blockquote class="ks kt ku"><p id="ed71" class="ie if kv ig b ih ii ij ik il im in io kw iq ir is kx iu iv iw ky iy iz ja jb ha bi translated">弹性网方法改进了lasso的局限性，即lasso只对高维数据进行少量采样，弹性网程序提供了“n”个变量，直至饱和。在变量是高度相关组的情况下，lasso倾向于从这些组中选择一个变量，而完全忽略其余的变量。</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mb"><img src="../Images/fe9ea8d5375a6f07941e53ab2649d096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q53XbAJdKv_l3sw-sUlCVA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Differences between L1, L2, and L1+L2 Norm</figcaption></figure><h1 id="22f5" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">弹性网络回归模型</h1><p id="836d" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">弹性网络旨在最小化以下损失函数:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mg"><img src="../Images/f208ee278e18df251d937d12eb52d086.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*XjDc54wcUkLcnSXmYjIH4Q.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">ElasticNet Mathematical Model</figcaption></figure><p id="06ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数学模型中使用的术语与岭和套索回归中的术语相同。这就是为什么我不会回到这里。你可以从我下面分享的文章中回顾一下关于数学模型的解释。</p><p id="9469" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://keremkargin.medium.com/ridge-regression-fundamentals-and-modeling-in-python-bb56f4301f62" rel="noopener">岭回归</a></p><p id="9990" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://keremkargin.medium.com/lasso-regression-fundamentals-and-modeling-in-python-ad8251a636cd" rel="noopener">拉索回归</a></p><h1 id="d6ce" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">用Python建模</h1><p id="cd4e" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">现在让我们在一个样本数据集上建立一个<code class="du mh mi mj mk b">ElasticNet Regression</code>模型。然后让我们计算模型的平方根，这将给出模型误差。</p><p id="6470" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们照常导入建模所需的库。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="655d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后我们做数据读取和一些数据编辑操作。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="adf2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过ElasticNet回归，我们在训练集上建立了模型。</p><p id="3854" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kv">我不会深入概念细节，例如什么是fit，什么是列车组。</em></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="77eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">根据我们拥有的数据集中的变量，我们发现ElasticNet模型中的可变系数如下。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="bfbd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们发现ElasticNet回归模型的常数为<strong class="ig hi"> -6，46 </strong>，函数如下。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><h2 id="2377" class="kz jq hh bd jr la lb lc jv ld le lf jz ip lg lh kd it li lj kh ix lk ll kl lm bi translated">预言；预测；预告</h2><p id="92fc" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">现在让我们在不指定任何参数的正常条件下进行模型预测。我们可以看到列车组模型预测的前10个观察值，如下所示。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="ee2b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">同样，我们可以看到测试集的模型预测的前10个观察值如下。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="d579" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们将在测试集上预测的值保存在一个名为y_pred的集群中。作为下面计算的结果，我们发现RMSE值为<strong class="ig hi"> 357，16 </strong>。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="5732" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">结果，我们发现R平方得分为0，41。R平方得分是自变量解释的因变量变化的百分比。</p><p id="267e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">换句话说，我们可以说ElasticNet回归模型中的自变量解释了该数据集因变量变化的41.07%。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="d9aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">什么是R平方？</strong></p><blockquote class="ks kt ku"><p id="1b5d" class="ie if kv ig b ih ii ij ik il im in io kw iq ir is kx iu iv iw ky iy iz ja jb ha bi translated">r平方(R2)是一种统计测量方法，表示由回归模型中的一个或多个自变量解释的因变量方差的比例。相关性解释了自变量和因变量之间的关系强度，而R平方解释了一个变量的方差在多大程度上解释了第二个变量的方差。因此，如果模型的R2是0.50，那么大约一半的观察到的变化可以用模型的输入来解释。</p></blockquote><h2 id="46db" class="kz jq hh bd jr la lb lc jv ld le lf jz ip lg lh kd it li lj kh ix lk ll kl lm bi translated">模型调整</h2><p id="7960" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">在本节中，我们将使用ElasticNetCV方法进行运算，以找到最佳的lambda值。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="31aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">相应地，我们发现阿尔法值为<strong class="ig hi"> 5230，76 </strong>。</p><p id="f891" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们可以找到用ElasticNetCV建立的模型的常数，如下所示。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="7760" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以找到用ElasticNetCV建立的模型的变量的系数如下。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="1beb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们用这个最佳alpha值重建调整后的ElasticNet模型。然后，我们将测试集中的预测值打印到y_pred中。结果，我们发现RMSE值为<strong class="ig hi"> 394，15。</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ml mm l"/></div></figure><h1 id="a448" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">最后</h1><p id="2d36" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">首先，我们在这篇博文中研究了什么是ElasticNet回归。然后我们谈到了ElasticNet回归的特性和基础。数学上，我们检查了这个算法的模型。然后在当前条件下建立模型，计算误差值。在模型调整部分，我们通过用ElasticNetCV计算最佳α值并根据该α值重建校正模型来计算校正误差值。</p><h1 id="26a6" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">资源</h1><ol class=""><li id="9470" class="ln lo hh ig b ih kn il ko ip lp it lq ix lr jb mn lt lu lv bi translated"><a class="ae jo" href="https://www.datacamp.com/community/tutorials/tutorial-ridge-lasso-elastic-net?utm_source=adwords_ppc&amp;utm_campaignid=1455363063&amp;utm_adgroupid=65083631748&amp;utm_device=c&amp;utm_keyword=&amp;utm_matchtype=b&amp;utm_network=g&amp;utm_adpostion=&amp;utm_creative=278443377095&amp;utm_targetid=aud-299261629574:dsa-429603003980&amp;utm_loc_interest_ms=&amp;utm_loc_physical_ms=1012782&amp;gclid=CjwKCAjwm7mEBhBsEiwA_of-TEfkgJzJgtfZDPfFBSf07sCnxj3oL40GlgMm4-JqD57-oQw7aKyOeBoCOd4QAvD_BwE" rel="noopener ugc nofollow" target="_blank">https://www . data camp . com/community/tutorials/tutorial-ridge-lasso-elastic-net？UTM _ source = AdWords _ PPC&amp;UTM _ campaignid = 1455363063&amp;UTM _ adgroupid = 65083631748&amp;UTM _ device = c&amp;UTM _ keyword =&amp;UTM _ match type = b&amp;UTM _ network = g&amp;UTM _ adpossion =&amp;UTM _ creative = 27843377095</a></li><li id="d19d" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb mn lt lu lv bi translated"><a class="ae jo" href="https://towardsdatascience.com/ridge-lasso-and-elasticnet-regression-b1f9c00ea3a3" rel="noopener" target="_blank">https://towards data science . com/ridge-lasso-and-elastic net-regression-B1 F9 c 00 ea 3a 3</a></li><li id="ae64" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb mn lt lu lv bi translated"><a class="ae jo" href="https://hackernoon.com/an-introduction-to-ridge-lasso-and-elastic-net-regression-cca60b4b934f" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/an-introduction-to-ridge-lasso-and-elastic-net-regression-CCA 60 B4 b 934 f</a></li><li id="4912" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb mn lt lu lv bi translated"><a class="ae jo" href="https://www.geeksforgeeks.org/elastic-net-regression-in-r-programming/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/elastic-net-regression-in-r-programming/</a></li><li id="4774" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb mn lt lu lv bi translated"><a class="ae jo" href="https://corporatefinanceinstitute.com/resources/knowledge/other/elastic-net/" rel="noopener ugc nofollow" target="_blank">https://corporatefinanceinstitute . com/resources/knowledge/other/elastic-net/</a></li><li id="c658" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb mn lt lu lv bi translated"><a class="ae jo" href="https://towardsdatascience.com/from-linear-regression-to-ridge-regression-the-lasso-and-the-elastic-net-4eaecaf5f7e6" rel="noopener" target="_blank">https://towards data science . com/from-linear-regression-to-ridge-regression-the-lasso-and-the-elastic-net-4 EAE caf 5 F7 e 6</a></li></ol></div></div>    
</body>
</html>