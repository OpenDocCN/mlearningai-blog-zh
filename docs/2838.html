<html>
<head>
<title>Data Tales: Unlikely Plots with Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据故事:与Plotly不太可能的阴谋</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/data-tales-unlikely-plots-with-plotly-f3e914f4f0a8?source=collection_archive---------2-----------------------#2022-06-16">https://medium.com/mlearning-ai/data-tales-unlikely-plots-with-plotly-f3e914f4f0a8?source=collection_archive---------2-----------------------#2022-06-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/55977d85578d5d9019554c482019bbea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6dtWrwtz_ZtjsJGfiv7N0g.png"/></div></div></figure><p id="4b40" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在我关于用于数据分析的<a class="ae jn" rel="noopener" href="/mlearning-ai/data-tales-unlikely-plots-1882c2a903da">不可能的</a>图的文章中，我提到了一些我们可以用于数据分析的图。python和R中提供的Plotly库允许用户创建漂亮的基于web的交互式可视化，可以在Jupyter笔记本中显示，保存到独立的HTML文件中，或者作为使用Dash的纯Python构建的web应用程序的一部分。</p><p id="e510" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该库还可用于创建交互式条形图、饼图、散点图等，但数据分析不限于这些图表，还可以其他方式可视化，尤其是当您想要捕获数据集中包含的大量信息时。为了解释这一点，我们将使用企鹅数据集，其中包含不同种类企鹅的信息，它们所在的岛屿，它们的长度和深度，鳍状肢长度，体重和性别。</p><p id="e68d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们来看看这个数据集:</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es jo"><img src="../Images/385476ecc174a8659f75320667b1e286.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PC_52-Qu2bGNTsS3Dy4iTg.png"/></div></div></figure><p id="580f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">分类变量是物种、岛屿和性别，而数值变量是长度和深度、鳍状肢长度、体重和性别。这些信息可以同时用旭日图、桑基图、树状图等图表来表示。为了可视化这个数据集，我删除了空值并清理了数据集。我将继续使用这些图来可视化数据集。</p><p id="7808" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jt">用Python导入Plotly</em></p><pre class="jp jq jr js fd ju jv jw jx aw jy bi"><span id="6832" class="jz ka hh jv b fi kb kc l kd ke">import plotly<br/>import plotly.graph_objs as go<br/>import plotly.express as px<br/>import plotly.graph_objects as go<br/>from plotly.offline import iplot<br/>import plotly.io as pio</span></pre><p id="4390" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">旭日图</strong></p><p id="89f5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">假设我们想要可视化性别、物种和岛屿，还想知道属于这一类别的企鹅的体重和鳍状肢长度。旭日图可以通过在语法中添加变量来显示我们需要的信息。</p><pre class="jp jq jr js fd ju jv jw jx aw jy bi"><span id="9cc9" class="jz ka hh jv b fi kb kc l kd ke">fig = px.sunburst(df, path=['sex', 'species', 'island'], values='flipper_length_mm',<br/>                  color='body_mass_g',<br/>                  color_continuous_scale='RdBu',<br/>                  color_continuous_midpoint=np.average(df['body_mass_g'], weights=df['flipper_length_mm']))<br/>iplot(fig, image='png', filename='penguin', image_width=1280, image_height=1280)</span></pre><p id="64e2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">环的尺寸值是脚蹼的长度，环的颜色是身体质量。</p><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="kf kg l"/></div></figure><p id="dbec" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从图中可以看出，在比斯科岛上发现的雄性巴布亚企鹅有最长的鳍状肢长度和最高的体重，而在比斯科岛上发现的雌性巴布亚企鹅也有很长的鳍状肢长度，但体重低于雄性。一般来说，雄性的体重和脚蹼长度都比雌性高。我们还可以看到，阿德利物种可以在梦岛、托格森岛和比斯库岛找到，而巴布亚只能在比斯库岛和梦岛上的下巴颏带上找到。</p><p id="8bbc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">树形图</strong></p><p id="72ce" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以用分类变量来形象化地表示它们的长度和深度。矩形的大小将是竿的深度，颜色将是竿的长度。</p><pre class="jp jq jr js fd ju jv jw jx aw jy bi"><span id="2ff0" class="jz ka hh jv b fi kb kc l kd ke">fig = px.treemap(df, path=["sex", 'species', 'island'], values='culmen_depth_mm',<br/>                  color='culmen_length_mm',<br/>                  color_continuous_scale='RdBu',<br/>                  color_continuous_midpoint=np.average(df['culmen_length_mm'], weights=df['culmen_length_mm']))<br/>fig.update_layout(margin = dict(t=50, l=25, r=25, b=25))<br/>fig.show()</span></pre><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="kf kg l"/></div></figure><p id="eedd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">就像旭日图一样，树形图显示了我们需要的矩形信息。</p><p id="c43b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">桑基</strong></p><p id="3d21" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以用体重作为桑基图的数字变量来比较企鹅性别和物种之间的流量。为此，我们必须从数据集创建一个新的dataframe来获取绘图变量。</p><pre class="jp jq jr js fd ju jv jw jx aw jy bi"><span id="0bb1" class="jz ka hh jv b fi kb kc l kd ke">df1 = df.groupby(['sex', 'species', 'island'])['body_mass_g'].mean()<br/>df1 = df1.to_frame(name='value').reset_index()<br/>df1.head()</span></pre><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kh"><img src="../Images/91bc4f5ec9600af2c1bb2ceaa6f3b9bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*QvCi2dneDRlFvskv8x2lkg.png"/></div></figure><pre class="jp jq jr js fd ju jv jw jx aw jy bi"><span id="ccb8" class="jz ka hh jv b fi kb kc l kd ke">#create the plot<br/>all_nodes = df1.sex.values.tolist() + df1.species.values.tolist()<br/>source_indices = [all_nodes.index(sex) for sex in df1.sex]<br/>target_indices = [all_nodes.index(species) for species in df1.species]</span><span id="7626" class="jz ka hh jv b fi ki kc l kd ke">fig = go.Figure(data=[go.Sankey(<br/>    node = dict(<br/>      pad = 20,<br/>      thickness = 20,<br/>      line = dict(color = "black", width = 1.0),<br/>      label =  all_nodes,<br/>    ),</span><span id="3570" class="jz ka hh jv b fi ki kc l kd ke">link = dict(<br/>      source =  source_indices,<br/>      target =  target_indices,<br/>      value =  df1.value,<br/>))])</span><span id="7152" class="jz ka hh jv b fi ki kc l kd ke">fig.update_layout(title_text="Penguins",<br/>                  font_size=10)<br/>fig.show()</span></pre><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="kf kg l"/></div></figure><p id="9ede" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们也可以用桑基图来观察物种和岛屿之间的流动。</p><pre class="jp jq jr js fd ju jv jw jx aw jy bi"><span id="41fc" class="jz ka hh jv b fi kb kc l kd ke">all_nodes = df1.species.values.tolist() + df1.island.values.tolist()<br/>source_indices = [all_nodes.index(species) for species in df1.species]<br/>target_indices = [all_nodes.index(island) for island in df1.island]</span><span id="5f8d" class="jz ka hh jv b fi ki kc l kd ke">fig = go.Figure(data=[go.Sankey(<br/>    node = dict(<br/>      pad = 20,<br/>      thickness = 20,<br/>      line = dict(color = "black", width = 1.0),<br/>      label =  all_nodes,<br/>    ),</span><span id="8a0c" class="jz ka hh jv b fi ki kc l kd ke">link = dict(<br/>      source =  source_indices,<br/>      target =  target_indices,<br/>      value =  df1.value,<br/>))])</span><span id="a254" class="jz ka hh jv b fi ki kc l kd ke">fig.update_layout(title_text="Penguins",<br/>                  font_size=10)<br/>fig.show()</span></pre><figure class="jp jq jr js fd ii"><div class="bz dy l di"><div class="kf kg l"/></div></figure><p id="4fc6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">通过使用<code class="du kj kk kl jv b">library(plotly) </code>命令安装和导入，Plotly库在R中也是可用的。</p><div class="km kn ez fb ko kp"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kq ab dw"><div class="kr ab ks cl cj kt"><h2 class="bd hi fi z dy ku ea eb kv ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kw l"><h3 class="bd b fi z dy ku ea eb kv ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="kx l"><p class="bd b fp z dy ku ea eb kv ed ef dx translated">medium.com</p></div></div><div class="ky l"><div class="kz l la lb lc ky ld in kp"/></div></div></a></div></div></div>    
</body>
</html>