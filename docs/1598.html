<html>
<head>
<title>Cats and Dogs Classifier â€” Easiest Wayâ€” with source codeâ€” Easy Explanation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">çŒ«ç‹—åˆ†ç±»å™¨â€”â€”æœ€ç®€å•çš„æ–¹æ³•â€”â€”å¸¦æºä»£ç â€”â€”ç®€å•æ˜“æ‡‚</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/cats-and-dogs-classifier-easiest-way-with-source-code-easy-explanation-97d2459af658?source=collection_archive---------0-----------------------#2022-01-10">https://medium.com/mlearning-ai/cats-and-dogs-classifier-easiest-way-with-source-code-easy-explanation-97d2459af658?source=collection_archive---------0-----------------------#2022-01-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e939" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">åœ¨ä»Šå¤©çš„åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œæ„å»ºä¸€ä¸ªçŒ«ç‹—åˆ†ç±»å™¨ã€‚è¿™å°†æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£çš„åšå®¢ï¼Œæ‰€ä»¥æ²¡æœ‰ä»»ä½•è¿›ä¸€æ­¥çš„åˆ°æœŸã€‚</p><p id="7f85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">åœ¨è¿™é‡Œé˜…è¯»å¸¦æºä»£ç çš„æ•´ç¯‡æ–‡ç« â€”</strong><a class="ae jc" href="https://machinelearningprojects.net/cats-and-dogs-classifier/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/cats-and-dogs-classifier/</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a33f869201a692068f009a221877ddc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BhCUa04WjtRH_uHR.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">augmented images</figcaption></figure><h1 id="ba2d" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">è®©æˆ‘ä»¬å¼€å§‹å§â€¦</h1><h2 id="86d2" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤1-å¯¼å…¥çŒ«ç‹—åˆ†ç±»å™¨æ‰€éœ€çš„åº“ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="acba" class="kr ju hh lg b fi lk ll l lm ln">import numpy as np<br/>import pandas as pd <br/>from keras.preprocessing.image import ImageDataGenerator, load_img<br/>from keras.utils.np_utils import to_categorical<br/>from sklearn.model_selection import train_test_split<br/>import matplotlib.pyplot as plt<br/>import random<br/>import os<br/>from keras.models import Sequential<br/>from keras.layers import Conv2D, MaxPooling2D, Dropout, Flatten, Dense, Activation, BatchNormalization<br/>from keras.callbacks import EarlyStopping, ReduceLROnPlateau<br/>import cv2</span></pre><h2 id="7c2b" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤2 â€”åˆå§‹åŒ–ä¸€äº›å¸¸æ•°ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="6dec" class="kr ju hh lg b fi lk ll l lm ln">IMAGE_WIDTH=128<br/>IMAGE_HEIGHT=128<br/>IMAGE_SIZE=(IMAGE_WIDTH, IMAGE_HEIGHT)<br/>IMAGE_CHANNELS=3</span></pre><h2 id="1ce2" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤3-åŠ è½½çŒ«ç‹—åˆ†ç±»å™¨çš„è¾“å…¥æ•°æ®ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="b1c6" class="kr ju hh lg b fi lk ll l lm ln">filenames = os.listdir("train")<br/>categories = []<br/>for filename in filenames:<br/>    category = filename.split('.')[0]<br/>    if category == 'dog':<br/>        categories.append(1)<br/>    else:<br/>        categories.append(0)<br/><br/>df = pd.DataFrame({<br/>    'filename': filenames,<br/>    'category': categories<br/>})</span></pre><ul class=""><li id="e1d7" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">æˆ‘ä»¬åœ¨ç«è½¦æ–‡ä»¶å¤¹é‡Œæœ‰æˆ‘ä»¬æ‰€æœ‰çš„å›¾åƒã€‚æ‰€ä»¥os.listdir('train ')ä¼šç»™å‡ºæ‰€æœ‰å›¾åƒåç§°çš„åˆ—è¡¨ã€‚</li><li id="2a92" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">ç„¶åæˆ‘ä»¬éå†æ‰€æœ‰å›¾åƒï¼Œä»å›¾åƒåç§°ä¸­æå–å®ƒä»¬çš„ç±»åˆ«(ç‹—æˆ–çŒ«)ã€‚</li><li id="cb47" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">æœ€åï¼Œæˆ‘ä»¬æ­£åœ¨åˆ›å»ºæ•°æ®çš„æ•°æ®æ¡†æ¶ã€‚</li></ul><h2 id="074f" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤4 â€”æ£€æŸ¥æ•°æ®çš„å¤´éƒ¨ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="ef3b" class="kr ju hh lg b fi lk ll l lm ln">df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/c120fc425969d5c286f2650fb333d1b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/0*HMrRcPkDQk1wXWIF.png"/></div></figure><h2 id="cb98" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤5 â€”æ£€æŸ¥æ•°æ®çš„å°¾éƒ¨ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="c895" class="kr ju hh lg b fi lk ll l lm ln">df.tail()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/ab6379e5c8d57b3844e956829daa9b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/0*GQUsBTGCsbRoTYPc.png"/></div></figure><h2 id="4778" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤6 â€”å¯è§†åŒ–ç±»åˆ«åˆ—ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="fc2c" class="kr ju hh lg b fi lk ll l lm ln">df[â€˜categoryâ€™].value_counts().plot.bar()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/cf2d110154437bba87d2cc042046458f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*WnNPwyfjaXh08Oso.png"/></div></figure><h2 id="5ef7" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤7-ä¸ºçŒ«ç‹—åˆ†ç±»å™¨å»ºç«‹æ¨¡å‹ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="848d" class="kr ju hh lg b fi lk ll l lm ln">model = Sequential()<br/><br/>model.add(Conv2D(32, (3, 3), activation='relu', input_shape=(IMAGE_WIDTH, IMAGE_HEIGHT, IMAGE_CHANNELS)))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Conv2D(64, (3, 3), activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Conv2D(128, (3, 3), activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Flatten())<br/>model.add(Dense(512, activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.5))<br/><br/>model.add(Dense(2, activation='softmax')) # 2 because we have cat and dog classes<br/><br/>model.compile(loss='categorical_crossentropy', optimizer='rmsprop', metrics=['accuracy'])<br/><br/>model.summary()</span></pre><ul class=""><li id="2eed" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªéå¸¸å®¹æ˜“ä½¿ç”¨çš„é¡ºåºKerasæ¨¡å‹ã€‚åªéœ€ä½¿ç”¨model.add()å¹¶æ ¹æ®æ‚¨çš„ç”¨ä¾‹æ–¹ä¾¿åœ°ç»§ç»­æ·»åŠ å±‚ã€‚</li><li id="1d11" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">è¿™é‡Œæˆ‘ä»¬åŸºæœ¬ä¸Šç”¨äº†3å¥—<a class="ae jc" href="https://keras.io/api/layers/convolution_layers/convolution2d/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">ã€Conv2Dã€‘</strong></a><strong class="ig hi">â€”â€”</strong><a class="ae jc" href="https://keras.io/api/layers/normalization_layers/batch_normalization/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">batch normalization</strong></a><strong class="ig hi">â€”â€”</strong><a class="ae jc" href="https://keras.io/api/layers/pooling_layers/max_pooling2d/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">max pooling</strong></a><strong class="ig hi">â€”â€”</strong><a class="ae jc" href="https://keras.io/api/layers/regularization_layers/dropout/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">Dropout</strong></a>å›¾å±‚ã€‚</li><li id="0886" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">ä¹‹åï¼Œæˆ‘ä»¬å±•å¹³è¿™äº›å±‚çš„ç»“æœï¼Œå¹¶å°†è¿™äº›ç»“æœä¼ é€’ç»™<a class="ae jc" href="https://keras.io/api/layers/core_layers/dense/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">å¯†é›†</strong> </a>å±‚æˆ–å®Œå…¨è¿æ¥çš„å±‚ã€‚</li><li id="cecd" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">æœ€åçš„<a class="ae jc" href="https://keras.io/api/layers/core_layers/dense/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">å¯†é›†</strong> </a>å±‚å°†æ€»æ˜¯åŒ…å«nä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­næ˜¯æ•°æ®é›†ä¸­çš„ç±»çš„æ•°é‡ã€‚</li><li id="ed2b" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">æ„å»ºæ¨¡å‹çš„æœ€åä¸€æ­¥æ˜¯model.compile()ï¼Œå®ƒç”¨äºå°†æˆ‘ä»¬ä¸Šé¢æ‰€åšçš„ä¸€åˆ‡æ”¾åœ¨ä¸€èµ·ã€‚</li><li id="04bc" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨<a class="ae jc" href="https://keras.io/api/losses/probabilistic_losses/#categoricalcrossentropy-class" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">åˆ†ç±»äº¤å‰ç†µ</strong> </a>å› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œæœ‰2ä¸ªåˆ†ç±»ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<a class="ae jc" href="https://keras.io/api/optimizers/rmsprop/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> rmsprop </strong> </a>ä¼˜åŒ–å™¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨adamï¼Œä½†rmspropåœ¨è¿™ç§æƒ…å†µä¸‹æä¾›äº†æ›´å¥½çš„ç»“æœï¼Œæˆ‘ä»¬å°†è¡¡é‡æ¨¡å‹æ€§èƒ½çš„æŒ‡æ ‡æ˜¯<strong class="ig hi">å‡†ç¡®æ€§</strong>ã€‚</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/8b9e09bbb2db4004fa062d8a0e903587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/0*2LBIwyPKhG_-EDtd.png"/></div></figure><h2 id="b365" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤8-åˆå§‹åŒ–çŒ«ç‹—åˆ†ç±»å™¨æ¨¡å‹çš„å›è°ƒã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="f5e5" class="kr ju hh lg b fi lk ll l lm ln">earlystop = EarlyStopping(patience=10)<br/><br/>learning_rate_reduction = ReduceLROnPlateau(monitor='val_accuracy', <br/>                                            patience=2, <br/>                                            verbose=1, <br/>                                            factor=0.5, <br/>                                            min_lr=0.00001)<br/><br/>callbacks = [earlystop, learning_rate_reduction]</span></pre><ul class=""><li id="bff1" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">ç®€å•åˆå§‹åŒ–<a class="ae jc" href="https://keras.io/api/callbacks/early_stopping/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">è¿™é‡Œæå‰åœæ­¢</strong> </a>å’Œ<a class="ae jc" href="https://keras.io/api/callbacks/reduce_lr_on_plateau/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">ReduceLROnPlateau</strong></a>ã€‚</li><li id="4e98" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">æå‰åœæ­¢å½“val_accuracyåœæ­¢å¢åŠ æˆ–val_lossåœæ­¢å‡å°‘æ—¶ï¼Œæå‰åœæ­¢è®­ç»ƒã€‚</li><li id="f0e3" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">å½“æˆ‘ä»¬çš„æ¨¡å‹è¾¾åˆ°æŸå¤±å‡½æ•°çš„æå°å€¼é™„è¿‘æ—¶ï¼ŒReduceLROnPlateaué™ä½å­¦ä¹ ç‡ã€‚</li></ul><h2 id="8bbf" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤9-ç”¨çŒ«ä»£æ›¿0ï¼Œç”¨ç‹—ä»£æ›¿1ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="4270" class="kr ju hh lg b fi lk ll l lm ln">df[â€œcategoryâ€] = df[â€œcategoryâ€].replace({0: â€˜catâ€™, 1: â€˜dogâ€™})</span></pre><h2 id="9415" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤10-å°†æ•°æ®åˆ†ä¸ºè®­ç»ƒå’ŒéªŒè¯ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="59ea" class="kr ju hh lg b fi lk ll l lm ln">train_df, validate_df = train_test_split(df, test_size=0.20, random_state=42)<br/><br/>train_df = train_df.reset_index(drop=True)<br/>validate_df = validate_df.reset_index(drop=True)</span></pre><h2 id="a222" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤11-åˆ—è½¦æ•°æ®ä¸­ä¸¤ä¸ªç±»åˆ«çš„è®¡æ•°ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="5079" class="kr ju hh lg b fi lk ll l lm ln">train_df[â€˜categoryâ€™].value_counts().plot.bar()</span></pre><ul class=""><li id="d494" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">0å’Œ1åœ¨è®­ç»ƒæ•°æ®é›†ä¸­å„æœ‰10000å¹…å›¾åƒã€‚</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mg"><img src="../Images/72abfd2fadca422ae26f2515c4abf53f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/0*qG1bY4uQftjqozTL.png"/></div></figure><h2 id="1fa3" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">ç¬¬12æ­¥â€”éªŒè¯æ•°æ®ä¸­ä¸¤ä¸ªç±»åˆ«çš„è®¡æ•°ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="ca38" class="kr ju hh lg b fi lk ll l lm ln">validate_df[â€˜categoryâ€™].value_counts().plot.bar()</span></pre><ul class=""><li id="44ed" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">0å’Œ1åœ¨éªŒè¯æ•°æ®é›†ä¸­å„æœ‰2500ä¸ªå›¾åƒã€‚</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/684db9b50d750b04b9981f704136549d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/0*v6LF10Tf3lrlmAfd.png"/></div></figure><h2 id="0328" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤13â€”â€”è·å¾—ä¸€äº›å½¢çŠ¶ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="2e9a" class="kr ju hh lg b fi lk ll l lm ln">total_train = train_df.shape[0]<br/>total_validate = validate_df.shape[0]<br/>batch_size=15</span></pre><ul class=""><li id="5270" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">ç¬¬ä¸€è¡Œç»™å‡ºäº†è®­ç»ƒæ•°æ®é›†ä¸­çš„å›¾åƒæ•°é‡ã€‚</li><li id="32bc" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">ç¬¬äºŒè¡Œç»™å‡ºäº†éªŒè¯æ•°æ®é›†ä¸­å›¾åƒçš„æ•°é‡ã€‚</li></ul><h2 id="e33d" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤14-æ‰©å……çŒ«ç‹—åˆ†ç±»å™¨çš„è®­ç»ƒæ•°æ®ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="6a92" class="kr ju hh lg b fi lk ll l lm ln">train_datagen = ImageDataGenerator(<br/>    rotation_range=15,<br/>    rescale=1./255,<br/>    shear_range=0.1,<br/>    zoom_range=0.2,<br/>    horizontal_flip=True,<br/>    width_shift_range=0.1,<br/>    height_shift_range=0.1<br/>)<br/><br/>train_generator = train_datagen.flow_from_dataframe(<br/>    train_df, <br/>    "train/", <br/>    x_col='filename',<br/>    y_col='category',<br/>    target_size=IMAGE_SIZE,<br/>    class_mode='categorical',<br/>    batch_size=batch_size<br/>)</span></pre><ul class=""><li id="598a" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">ä½¿ç”¨<a class="ae jc" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">å›¾åƒæ•°æ®ç”Ÿæˆå™¨</strong> </a>æ‰©å……åˆ—è½¦æ•°æ®ã€‚</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mi"><img src="../Images/4438b967562b3755046b5d8a9d2e7634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0mUYk82zQMApWu-i.png"/></div></div></figure><h2 id="2089" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤15â€”â€”æ‰©å……éªŒè¯æ•°æ®ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="1241" class="kr ju hh lg b fi lk ll l lm ln">validation_datagen = ImageDataGenerator(rescale=1./255)<br/><br/>validation_generator = validation_datagen.flow_from_dataframe(<br/>    validate_df, <br/>    "train/", <br/>    x_col='filename',<br/>    y_col='category',<br/>    target_size=IMAGE_SIZE,<br/>    class_mode='categorical',<br/>    batch_size=batch_size<br/>)</span></pre><ul class=""><li id="d3e5" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">ä½¿ç”¨<a class="ae jc" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">å›¾åƒæ•°æ®ç”Ÿæˆå™¨</strong> </a>æ‰©å……éªŒè¯æ•°æ®ã€‚</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/be47385c36f6b56fda2d245dc1fbd965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HuagMZO0i3qRvLIt.png"/></div></div></figure><h2 id="3369" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤16-åœ¨éšæœºç¤ºä¾‹å›¾åƒä¸Šå¯è§†åŒ–å¢å¼ºã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="2df3" class="kr ju hh lg b fi lk ll l lm ln">example_df = train_df.sample(n=1).reset_index(drop=True)<br/><br/>example_generator = train_datagen.flow_from_dataframe(<br/>    example_df, <br/>    "train/", <br/>    x_col='filename',<br/>    y_col='category',<br/>    target_size=IMAGE_SIZE,<br/>    class_mode='categorical'<br/>)<br/><br/>plt.figure(figsize=(12, 12))<br/>for i in range(0, 15):<br/>    plt.subplot(5, 3, i+1)<br/>    for X_batch, Y_batch in example_generator:<br/>        image = X_batch[0]<br/>        plt.imshow(image)<br/>        break<br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a33f869201a692068f009a221877ddc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BhCUa04WjtRH_uHR.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">augmented images</figcaption></figure><h2 id="164e" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤17-è®­ç»ƒå’Œä¿å­˜æˆ‘ä»¬çš„çŒ«ç‹—åˆ†ç±»å™¨æ¨¡å‹ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="567f" class="kr ju hh lg b fi lk ll l lm ln">epochs = 50<br/>history = model.fit_generator(<br/>    train_generator, <br/>    epochs=epochs,<br/>    validation_data=validation_generator,<br/>    validation_steps=total_validate//batch_size,<br/>    steps_per_epoch=total_train//batch_size,<br/>    callbacks=callbacks<br/>)<br/>model.save("model.h5")</span></pre><h2 id="fdd0" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">ç¬¬18æ­¥â€”â€”å¯è§†åŒ–åŸ¹è®­è¿‡ç¨‹ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="d3fc" class="kr ju hh lg b fi lk ll l lm ln">fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 6))<br/>ax1.plot(history.history['loss'], color='b', label="Training loss")<br/>ax1.plot(history.history['val_loss'], color='r', label="validation loss")<br/>ax1.set_xticks(np.arange(1, epochs, 1))<br/>ax1.set_yticks(np.arange(0, 1, 0.1))<br/><br/>ax2.plot(history.history['accuracy'], color='b', label="Training accuracy")<br/>ax2.plot(history.history['val_accuracy'], color='r',label="Validation accuracy")<br/>ax2.set_xticks(np.arange(1, epochs, 1))<br/><br/>legend = plt.legend(loc='best', shadow=True)<br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/06309d6a5ec496ccb1b9bbda27a614cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rZjokIS9a_dYuF7t.png"/></div></div></figure><h2 id="54d8" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">æ­¥éª¤19-çŒ«ç‹—åˆ†ç±»å™¨çš„å®æ—¶é¢„æµ‹ã€‚</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="7d66" class="kr ju hh lg b fi lk ll l lm ln">for i in range(10):<br/>    all_test_images = os.listdir('test')<br/>    random_image = random.choice(all_test_images)<br/>    img = cv2.imread(f'test/{random_image}')<br/>    img = cv2.resize(img,(IMAGE_HEIGHT,IMAGE_WIDTH))<br/>    <br/>    org = img.copy()<br/>    img = img.reshape(1,128,128,3)<br/>    <br/>    pred = model.predict(img)<br/>    print(['cat','dog'][int(pred[0][0])])<br/>    cv2.imshow('Live predictions',org)<br/>    cv2.waitKey(0)<br/>cv2.destroyAllWindows()</span></pre><ul class=""><li id="df2f" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">ä»æµ‹è¯•æ–‡ä»¶å¤¹ä¸­éšæœºå–å‡º10å¼ å›¾ç‰‡ï¼Œå¯¹å…¶è¿›è¡Œé¢„æµ‹ã€‚</li></ul><p id="1d2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å¦‚æœå¯¹çŒ«ç‹—åˆ†ç±»å™¨æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·é€šè¿‡ç”µå­é‚®ä»¶æˆ–LinkedInè”ç³»æˆ‘ã€‚</p><p id="64a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ml">æ¢ç´¢æ›´å¤šæœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€è®¡ç®—æœºè§†è§‰ã€NLPã€Flaské¡¹ç›®è®¿é—®æˆ‘çš„åšå®¢â€” </em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="ml">æœºå™¨å­¦ä¹ é¡¹ç›®</em> </strong> </a></p><p id="e2e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">å¦‚éœ€è¿›ä¸€æ­¥çš„ä»£ç è§£é‡Šå’Œæºä»£ç ï¼Œè¯·è®¿é—®æ­¤å¤„</strong>â€”<a class="ae jc" href="https://machinelearningprojects.net/cats-and-dogs-classifier/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/cats-and-dogs-classifier/</a></p><p id="e473" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="ml">è¿™å°±æ˜¯æˆ‘å†™ç»™è¿™ä¸ªåšå®¢çš„å…¨éƒ¨å†…å®¹ï¼Œæ„Ÿè°¢ä½ çš„é˜…è¯»ï¼Œæˆ‘å¸Œæœ›ä½ åœ¨é˜…è¯»å®Œè¿™ç¯‡æ–‡ç« åï¼Œèƒ½æœ‰æ‰€æ”¶è·ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡ğŸ‘‹â€¦ </em></p><p id="9498" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ml">é˜…è¯»æˆ‘ä¹‹å‰çš„å¸–å­:</em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/dimensionality-reduction-using-autoencoders/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="ml">ä½¿ç”¨è‡ªåŠ¨ç¼–ç å™¨é™ç»´</em> </strong> </a></p><div class="mm mn ez fb mo mp"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hi fi z dy mu ea eb mv ed ef hg bi translated">Mlearning.aiæäº¤å»ºè®®</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">å¦‚ä½•æˆä¸ºMlearning.aiä¸Šçš„ä½œå®¶</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">medium.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jn mp"/></div></div></a></div></div></div>    
</body>
</html>