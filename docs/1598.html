<html>
<head>
<title>Cats and Dogs Classifier — Easiest Way— with source code— Easy Explanation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">猫狗分类器——最简单的方法——带源代码——简单易懂</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/cats-and-dogs-classifier-easiest-way-with-source-code-easy-explanation-97d2459af658?source=collection_archive---------0-----------------------#2022-01-10">https://medium.com/mlearning-ai/cats-and-dogs-classifier-easiest-way-with-source-code-easy-explanation-97d2459af658?source=collection_archive---------0-----------------------#2022-01-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e939" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在今天的博客中，我们将使用卷积神经网络构建一个猫狗分类器。这将是一个非常有趣的博客，所以没有任何进一步的到期。</p><p id="7f85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在这里阅读带源代码的整篇文章—</strong><a class="ae jc" href="https://machinelearningprojects.net/cats-and-dogs-classifier/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/cats-and-dogs-classifier/</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a33f869201a692068f009a221877ddc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BhCUa04WjtRH_uHR.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">augmented images</figcaption></figure><h1 id="ba2d" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">让我们开始吧…</h1><h2 id="86d2" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤1-导入猫狗分类器所需的库。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="acba" class="kr ju hh lg b fi lk ll l lm ln">import numpy as np<br/>import pandas as pd <br/>from keras.preprocessing.image import ImageDataGenerator, load_img<br/>from keras.utils.np_utils import to_categorical<br/>from sklearn.model_selection import train_test_split<br/>import matplotlib.pyplot as plt<br/>import random<br/>import os<br/>from keras.models import Sequential<br/>from keras.layers import Conv2D, MaxPooling2D, Dropout, Flatten, Dense, Activation, BatchNormalization<br/>from keras.callbacks import EarlyStopping, ReduceLROnPlateau<br/>import cv2</span></pre><h2 id="7c2b" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤2 —初始化一些常数。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="6dec" class="kr ju hh lg b fi lk ll l lm ln">IMAGE_WIDTH=128<br/>IMAGE_HEIGHT=128<br/>IMAGE_SIZE=(IMAGE_WIDTH, IMAGE_HEIGHT)<br/>IMAGE_CHANNELS=3</span></pre><h2 id="1ce2" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤3-加载猫狗分类器的输入数据。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="b1c6" class="kr ju hh lg b fi lk ll l lm ln">filenames = os.listdir("train")<br/>categories = []<br/>for filename in filenames:<br/>    category = filename.split('.')[0]<br/>    if category == 'dog':<br/>        categories.append(1)<br/>    else:<br/>        categories.append(0)<br/><br/>df = pd.DataFrame({<br/>    'filename': filenames,<br/>    'category': categories<br/>})</span></pre><ul class=""><li id="e1d7" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">我们在火车文件夹里有我们所有的图像。所以os.listdir('train ')会给出所有图像名称的列表。</li><li id="2a92" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">然后我们遍历所有图像，从图像名称中提取它们的类别(狗或猫)。</li><li id="cb47" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">最后，我们正在创建数据的数据框架。</li></ul><h2 id="074f" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤4 —检查数据的头部。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="ef3b" class="kr ju hh lg b fi lk ll l lm ln">df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/c120fc425969d5c286f2650fb333d1b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/0*HMrRcPkDQk1wXWIF.png"/></div></figure><h2 id="cb98" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤5 —检查数据的尾部。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="c895" class="kr ju hh lg b fi lk ll l lm ln">df.tail()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/ab6379e5c8d57b3844e956829daa9b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/0*GQUsBTGCsbRoTYPc.png"/></div></figure><h2 id="4778" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤6 —可视化类别列。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="fc2c" class="kr ju hh lg b fi lk ll l lm ln">df[‘category’].value_counts().plot.bar()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/cf2d110154437bba87d2cc042046458f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*WnNPwyfjaXh08Oso.png"/></div></figure><h2 id="5ef7" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤7-为猫狗分类器建立模型。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="848d" class="kr ju hh lg b fi lk ll l lm ln">model = Sequential()<br/><br/>model.add(Conv2D(32, (3, 3), activation='relu', input_shape=(IMAGE_WIDTH, IMAGE_HEIGHT, IMAGE_CHANNELS)))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Conv2D(64, (3, 3), activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Conv2D(128, (3, 3), activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Flatten())<br/>model.add(Dense(512, activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.5))<br/><br/>model.add(Dense(2, activation='softmax')) # 2 because we have cat and dog classes<br/><br/>model.compile(loss='categorical_crossentropy', optimizer='rmsprop', metrics=['accuracy'])<br/><br/>model.summary()</span></pre><ul class=""><li id="2eed" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">在这里，我们创建了一个非常容易使用的顺序Keras模型。只需使用model.add()并根据您的用例方便地继续添加层。</li><li id="1d11" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">这里我们基本上用了3套<a class="ae jc" href="https://keras.io/api/layers/convolution_layers/convolution2d/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">【Conv2D】</strong></a><strong class="ig hi">——</strong><a class="ae jc" href="https://keras.io/api/layers/normalization_layers/batch_normalization/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">batch normalization</strong></a><strong class="ig hi">——</strong><a class="ae jc" href="https://keras.io/api/layers/pooling_layers/max_pooling2d/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">max pooling</strong></a><strong class="ig hi">——</strong><a class="ae jc" href="https://keras.io/api/layers/regularization_layers/dropout/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">Dropout</strong></a>图层。</li><li id="0886" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">之后，我们展平这些层的结果，并将这些结果传递给<a class="ae jc" href="https://keras.io/api/layers/core_layers/dense/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">密集</strong> </a>层或完全连接的层。</li><li id="cecd" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">最后的<a class="ae jc" href="https://keras.io/api/layers/core_layers/dense/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">密集</strong> </a>层将总是包含n个节点，其中n是数据集中的类的数量。</li><li id="ed2b" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">构建模型的最后一步是model.compile()，它用于将我们上面所做的一切放在一起。</li><li id="04bc" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">我们在这里使用<a class="ae jc" href="https://keras.io/api/losses/probabilistic_losses/#categoricalcrossentropy-class" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">分类交叉熵</strong> </a>因为我们在这里有2个分类，我们使用了<a class="ae jc" href="https://keras.io/api/optimizers/rmsprop/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> rmsprop </strong> </a>优化器，我们也可以使用adam，但rmsprop在这种情况下提供了更好的结果，我们将衡量模型性能的指标是<strong class="ig hi">准确性</strong>。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/8b9e09bbb2db4004fa062d8a0e903587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/0*2LBIwyPKhG_-EDtd.png"/></div></figure><h2 id="b365" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤8-初始化猫狗分类器模型的回调。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="f5e5" class="kr ju hh lg b fi lk ll l lm ln">earlystop = EarlyStopping(patience=10)<br/><br/>learning_rate_reduction = ReduceLROnPlateau(monitor='val_accuracy', <br/>                                            patience=2, <br/>                                            verbose=1, <br/>                                            factor=0.5, <br/>                                            min_lr=0.00001)<br/><br/>callbacks = [earlystop, learning_rate_reduction]</span></pre><ul class=""><li id="bff1" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">简单初始化<a class="ae jc" href="https://keras.io/api/callbacks/early_stopping/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">这里提前停止</strong> </a>和<a class="ae jc" href="https://keras.io/api/callbacks/reduce_lr_on_plateau/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">ReduceLROnPlateau</strong></a>。</li><li id="4e98" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">提前停止当val_accuracy停止增加或val_loss停止减少时，提前停止训练。</li><li id="f0e3" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">当我们的模型达到损失函数的极小值附近时，ReduceLROnPlateau降低学习率。</li></ul><h2 id="8bbf" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤9-用猫代替0，用狗代替1。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="4270" class="kr ju hh lg b fi lk ll l lm ln">df[“category”] = df[“category”].replace({0: ‘cat’, 1: ‘dog’})</span></pre><h2 id="9415" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤10-将数据分为训练和验证。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="59ea" class="kr ju hh lg b fi lk ll l lm ln">train_df, validate_df = train_test_split(df, test_size=0.20, random_state=42)<br/><br/>train_df = train_df.reset_index(drop=True)<br/>validate_df = validate_df.reset_index(drop=True)</span></pre><h2 id="a222" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤11-列车数据中两个类别的计数。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="5079" class="kr ju hh lg b fi lk ll l lm ln">train_df[‘category’].value_counts().plot.bar()</span></pre><ul class=""><li id="d494" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">0和1在训练数据集中各有10000幅图像。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mg"><img src="../Images/72abfd2fadca422ae26f2515c4abf53f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/0*qG1bY4uQftjqozTL.png"/></div></figure><h2 id="1fa3" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">第12步—验证数据中两个类别的计数。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="ca38" class="kr ju hh lg b fi lk ll l lm ln">validate_df[‘category’].value_counts().plot.bar()</span></pre><ul class=""><li id="44ed" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">0和1在验证数据集中各有2500个图像。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mh"><img src="../Images/684db9b50d750b04b9981f704136549d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/0*v6LF10Tf3lrlmAfd.png"/></div></figure><h2 id="0328" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤13——获得一些形状。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="2e9a" class="kr ju hh lg b fi lk ll l lm ln">total_train = train_df.shape[0]<br/>total_validate = validate_df.shape[0]<br/>batch_size=15</span></pre><ul class=""><li id="5270" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">第一行给出了训练数据集中的图像数量。</li><li id="32bc" class="lo lp hh ig b ih lx il ly ip lz it ma ix mb jb lt lu lv lw bi translated">第二行给出了验证数据集中图像的数量。</li></ul><h2 id="e33d" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤14-扩充猫狗分类器的训练数据。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="6a92" class="kr ju hh lg b fi lk ll l lm ln">train_datagen = ImageDataGenerator(<br/>    rotation_range=15,<br/>    rescale=1./255,<br/>    shear_range=0.1,<br/>    zoom_range=0.2,<br/>    horizontal_flip=True,<br/>    width_shift_range=0.1,<br/>    height_shift_range=0.1<br/>)<br/><br/>train_generator = train_datagen.flow_from_dataframe(<br/>    train_df, <br/>    "train/", <br/>    x_col='filename',<br/>    y_col='category',<br/>    target_size=IMAGE_SIZE,<br/>    class_mode='categorical',<br/>    batch_size=batch_size<br/>)</span></pre><ul class=""><li id="598a" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">使用<a class="ae jc" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">图像数据生成器</strong> </a>扩充列车数据。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mi"><img src="../Images/4438b967562b3755046b5d8a9d2e7634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0mUYk82zQMApWu-i.png"/></div></div></figure><h2 id="2089" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤15——扩充验证数据。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="1241" class="kr ju hh lg b fi lk ll l lm ln">validation_datagen = ImageDataGenerator(rescale=1./255)<br/><br/>validation_generator = validation_datagen.flow_from_dataframe(<br/>    validate_df, <br/>    "train/", <br/>    x_col='filename',<br/>    y_col='category',<br/>    target_size=IMAGE_SIZE,<br/>    class_mode='categorical',<br/>    batch_size=batch_size<br/>)</span></pre><ul class=""><li id="d3e5" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">使用<a class="ae jc" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">图像数据生成器</strong> </a>扩充验证数据。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/be47385c36f6b56fda2d245dc1fbd965.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HuagMZO0i3qRvLIt.png"/></div></div></figure><h2 id="3369" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤16-在随机示例图像上可视化增强。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="2df3" class="kr ju hh lg b fi lk ll l lm ln">example_df = train_df.sample(n=1).reset_index(drop=True)<br/><br/>example_generator = train_datagen.flow_from_dataframe(<br/>    example_df, <br/>    "train/", <br/>    x_col='filename',<br/>    y_col='category',<br/>    target_size=IMAGE_SIZE,<br/>    class_mode='categorical'<br/>)<br/><br/>plt.figure(figsize=(12, 12))<br/>for i in range(0, 15):<br/>    plt.subplot(5, 3, i+1)<br/>    for X_batch, Y_batch in example_generator:<br/>        image = X_batch[0]<br/>        plt.imshow(image)<br/>        break<br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/a33f869201a692068f009a221877ddc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BhCUa04WjtRH_uHR.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx">augmented images</figcaption></figure><h2 id="164e" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤17-训练和保存我们的猫狗分类器模型。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="567f" class="kr ju hh lg b fi lk ll l lm ln">epochs = 50<br/>history = model.fit_generator(<br/>    train_generator, <br/>    epochs=epochs,<br/>    validation_data=validation_generator,<br/>    validation_steps=total_validate//batch_size,<br/>    steps_per_epoch=total_train//batch_size,<br/>    callbacks=callbacks<br/>)<br/>model.save("model.h5")</span></pre><h2 id="fdd0" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">第18步——可视化培训过程。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="d3fc" class="kr ju hh lg b fi lk ll l lm ln">fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 6))<br/>ax1.plot(history.history['loss'], color='b', label="Training loss")<br/>ax1.plot(history.history['val_loss'], color='r', label="validation loss")<br/>ax1.set_xticks(np.arange(1, epochs, 1))<br/>ax1.set_yticks(np.arange(0, 1, 0.1))<br/><br/>ax2.plot(history.history['accuracy'], color='b', label="Training accuracy")<br/>ax2.plot(history.history['val_accuracy'], color='r',label="Validation accuracy")<br/>ax2.set_xticks(np.arange(1, epochs, 1))<br/><br/>legend = plt.legend(loc='best', shadow=True)<br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/06309d6a5ec496ccb1b9bbda27a614cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rZjokIS9a_dYuF7t.png"/></div></div></figure><h2 id="54d8" class="kr ju hh bd jv ks kt ku jz kv kw kx kd ip ky kz kh it la lb kl ix lc ld kp le bi translated">步骤19-猫狗分类器的实时预测。</h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="7d66" class="kr ju hh lg b fi lk ll l lm ln">for i in range(10):<br/>    all_test_images = os.listdir('test')<br/>    random_image = random.choice(all_test_images)<br/>    img = cv2.imread(f'test/{random_image}')<br/>    img = cv2.resize(img,(IMAGE_HEIGHT,IMAGE_WIDTH))<br/>    <br/>    org = img.copy()<br/>    img = img.reshape(1,128,128,3)<br/>    <br/>    pred = model.predict(img)<br/>    print(['cat','dog'][int(pred[0][0])])<br/>    cv2.imshow('Live predictions',org)<br/>    cv2.waitKey(0)<br/>cv2.destroyAllWindows()</span></pre><ul class=""><li id="df2f" class="lo lp hh ig b ih ii il im ip lq it lr ix ls jb lt lu lv lw bi translated">从测试文件夹中随机取出10张图片，对其进行预测。</li></ul><p id="1d2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果对猫狗分类器有任何疑问，请通过电子邮件或LinkedIn联系我。</p><p id="64a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ml">探索更多机器学习、深度学习、计算机视觉、NLP、Flask项目访问我的博客— </em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="ml">机器学习项目</em> </strong> </a></p><p id="e2e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如需进一步的代码解释和源代码，请访问此处</strong>—<a class="ae jc" href="https://machinelearningprojects.net/cats-and-dogs-classifier/" rel="noopener ugc nofollow" target="_blank">https://machine learning projects . net/cats-and-dogs-classifier/</a></p><p id="e473" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="ml">这就是我写给这个博客的全部内容，感谢你的阅读，我希望你在阅读完这篇文章后，能有所收获，直到下一次👋… </em></p><p id="9498" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="ml">阅读我之前的帖子:</em> </strong> <a class="ae jc" href="https://machinelearningprojects.net/dimensionality-reduction-using-autoencoders/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="ml">使用自动编码器降维</em> </strong> </a></p><div class="mm mn ez fb mo mp"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hi fi z dy mu ea eb mv ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">medium.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jn mp"/></div></div></a></div></div></div>    
</body>
</html>