<html>
<head>
<title>PDF Estimation with Parzen Window</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Parzen窗的PDF估计</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/pdf-estimation-with-parzen-window-a32f3bfffd4c?source=collection_archive---------5-----------------------#2022-03-12">https://medium.com/mlearning-ai/pdf-estimation-with-parzen-window-a32f3bfffd4c?source=collection_archive---------5-----------------------#2022-03-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="b4b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在模式识别中，我们经常会遇到参数估计问题。该参数可以是分布的平均值/方差或一些其他统计数据。我们主要利用参数方法，如最大似然，最大后验概率或贝叶斯学习。但是这些方法需要知道密度的形式(高斯、泊松等。)并尝试根据这个pdf表单假设来估计缺失的参数。可悲的是，密度的形式并不总是已知的。</p><p id="572c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此时，非参数方法开始发挥作用。在不假设任何形式的密度的情况下，非参数方法试图估计给定样本的pdf。Parzen Window就是这些非参数方法中的一种，我们将在本文中对其进行分析。</p><p id="19c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Parzen窗口方法的主要目的是为每个可能的向量x估计一个似然值p(x ),以便这些似然值可以被组合以产生一个概率密度函数。在每次迭代中，放置一个边长为<strong class="ig hi"> h_n </strong>的超立方体，并将超立方体的中心设置为当前的<strong class="ig hi"> x </strong>向量。在围绕x向量拟合超立方体之后，评估来自给定样本的每个输入x_i，不管它是否在超立方体中。该程序由窗口功能<strong class="ig hi">φ</strong>执行。窗口函数可以是离散函数，使得如果x_i在超立方体中，则它返回1，否则返回0。并且它也可以是诸如高斯的连续窗口。这样，每个样本的贡献将是连续的，取决于相对于中心向量<strong class="ig hi"> x </strong>的距离。下面给出了一个简单的公式来计算给定x向量的可能性p(x ):</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/9b3d61150532bf3c73b3a42bbe3802f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*cQsay4czihIFDN6uxr4tUA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Likelihood calculation for a given vector x</figcaption></figure><p id="8a2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的公式中；<strong class="ig hi">φ</strong>代表窗口函数，<strong class="ig hi"> x </strong>是我们要寻找其可能性的向量，<strong class="ig hi"> x_i </strong>是来自分布的<strong class="ig hi"> i </strong> ^th样本，<strong class="ig hi"> h_n </strong>是超立方体的边长，<strong class="ig hi"> V_n </strong>是超立方体的体积，最后<strong class="ig hi"> n </strong>是数据集中的样本数。如果我们总结这个公式中所发生的事情，我们可以说窗口函数<strong class="ig hi">φ</strong>是在每个样本<strong class="ig hi"> x_i </strong>上操作的，并且窗口的输出除以超立方体的体积。最后，将每个结果相加，并按样本数量<strong class="ig hi"> n </strong>进行平均。这个最终值给了我们向量<strong class="ig hi"> x </strong>的可能性！下面提供了一个示例来说明此过程:</p><p id="4e18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们首先创建100个双变量高斯样本，其平均值为<strong class="ig hi"> [-1.5，2] </strong>，协方差矩阵为<strong class="ig hi"> [0.7，0.1；0.1，0.5]: </strong></p><pre class="jd je jf jg fd jo jp jq jr aw js bi"><span id="8869" class="jt ju hh jp b fi jv jw l jx jy">mu = [-1.5 2];<br/>sigma = [0.7 0.1;0.1 0.5];<br/>N = 100;<br/>rng(‘default’)<br/>Samples = mvnrnd(mu,sigma,N);<br/>scatter(Samples(:,1),Samples(:,2))</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jz"><img src="../Images/3c7e0b87b2e4fb621abb4938aee973d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*9PI_7f2n-q7xTFKX68XQTg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Scatter Plot of 100 Bi-variate Gaussian Samples</figcaption></figure><p id="a3d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，使用Matlab中的<strong class="ig hi"> mvnpdf </strong>函数找到该分布的原始pdf，并绘制原始分布图:</p><pre class="jd je jf jg fd jo jp jq jr aw js bi"><span id="6e56" class="jt ju hh jp b fi jv jw l jx jy">x1 = -5:0.1:2;<br/>x2 = 0:0.1:4;<br/>[X1,X2] = meshgrid(x1,x2);<br/>X_grid = [X1(:) X2(:)];<br/>y = mvnpdf(X_grid,mu,sigma);<br/>y = reshape(y,length(x2),length(x1));<br/>figure()<br/>surf(x1,x2,y)<br/>title(‘3D PDF Distribution’)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jz"><img src="../Images/73347fd2e43962fe35be099eee3606f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*BypwxpNKU0-v-AANMHKBkA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Original PDF</figcaption></figure><p id="e12f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们实现我们自己的Parzen窗口函数，并尝试估计上面显示的原始pdf。</p><pre class="jd je jf jg fd jo jp jq jr aw js bi"><span id="b50a" class="jt ju hh jp b fi jv jw l jx jy">%% Parzen Window</span><span id="fda2" class="jt ju hh jp b fi ka jw l jx jy">pdf_estimate = zeros(size(X_grid,1),1);</span><span id="48d8" class="jt ju hh jp b fi ka jw l jx jy">h1 = 5; % Can be changed to see the effect of the edge length<br/>hn = h1 / sqrt(N);<br/>V0 = h1^2;<br/>Vn = 1 / sqrt(N);</span><span id="8610" class="jt ju hh jp b fi ka jw l jx jy">for i = 1:size(X_grid,1)<br/>    for j = 1 : N<br/>        u = X_grid(i,:) — Samples(j,:);<br/>        u = u / hn;<br/>        win_out = Window_Function(mu’,u’);<br/>        pdf_estimate(i) = pdf_estimate(i) + win_out / Vn;<br/>    end<br/>    pdf_estimate(i) = pdf_estimate(i) / N;<br/>end</span><span id="7741" class="jt ju hh jp b fi ka jw l jx jy">pdf_estimate = reshape(pdf_estimate,length(x2),length(x1));<br/>figure()<br/>surf(x1,x2,pdf_estimate)<br/>title(‘Estimated 3D PDF Distribution’)<br/>%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span id="6838" class="jt ju hh jp b fi ka jw l jx jy">% Gaussian Window is implemented in the function below<br/>function y = Window_Function(mu,u)<br/>d = length(mu);<br/>y = exp(-0.5 * u’ * u) / ((2*pi)^(d/2));<br/>end</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jz"><img src="../Images/4201c5e6e20685741bab3d8b30965910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*Vvf0PqwheATxQZQw6l9Itw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Estimated PDF</figcaption></figure><p id="8af5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上图中我们可以看出，估算的pdf与原始PDF相似。在<strong class="ig hi"> [-1.4，2.1] </strong>附近达到峰值，与原始均值<strong class="ig hi"> [-1.5，2] </strong>相当接近。尽管这个结果并不理想，但它仍然让我们了解了如何估计数据集的pdf，即使分布的形式是未知的。在这个例子中，我们不知道样本是正态分布的，但是我们仍然可以得到一个相似的分布。</p><p id="85aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">另一个挑战可能是使用n和h_n值来观察它们的效果，并找到理想的设置。下一篇文章再见！</p><div class="kb kc ez fb kd ke"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kf ab dw"><div class="kg ab kh cl cj ki"><h2 class="bd hi fi z dy kj ea eb kk ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kl l"><h3 class="bd b fi z dy kj ea eb kk ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="km l"><p class="bd b fp z dy kj ea eb kk ed ef dx translated">medium.com</p></div></div><div class="kn l"><div class="ko l kp kq kr kn ks ji ke"/></div></div></a></div></div></div>    
</body>
</html>