<html>
<head>
<title>Text-to-Image using an Image captioning dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用图像字幕数据集的文本到图像转换</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/text-to-image-using-an-image-captioning-dataset-282e1c1d8cfd?source=collection_archive---------2-----------------------#2022-09-13">https://medium.com/mlearning-ai/text-to-image-using-an-image-captioning-dataset-282e1c1d8cfd?source=collection_archive---------2-----------------------#2022-09-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5bdc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在过去的几周里，我一直试图理解如何从图片说明中预测图片，就像你如何在谷歌上搜索图片一样。</p><p id="c083" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在学习扩散和自动编码器技术之前，我想尝试用我所知道的基本技能来解决这个问题。我最初是用解决句子分类或句子生成问题的思维来解决这个问题的。使得图像的名称是标签，并且字幕可以被标记成序列；然后训练序列来预测相应的标签。我首先尝试了一个直接序列来标记组织，但是，当然，对于可用的序列有太多的类别，因此无法构建一个可靠的模型。</p><p id="c93c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我尝试使用n元语法复制句子的一部分，并创建许多相似的句子序列。然后，我使用K-means将相应的图像映射到n-gram序列，于是我能够编译/拟合一个模型，该模型获取文本，然后显示相应的图像。尽情享受吧！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/67ec952c184d674434237414ecea5ffc.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*c9qHfPtsorx1gvjMTOn0oQ.png"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><h1 id="2299" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">子功能</h1><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><h1 id="5c9f" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">加载数据</h1><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kk"><img src="../Images/0d4db436ade0ef567821e182ca9679b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nJgIv7c-5ZuSs9-WeNrJLA.png"/></div></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kk"><img src="../Images/9e827d3a39bbe78416a7588dfd030602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jESIUipZOJkiB211oGptxA.png"/></div></div></figure><h1 id="eb27" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">方式一:用图像标签匹配n-gram句子序列</h1><h2 id="d3ea" class="kp jn hh bd jo kq kr ks js kt ku kv jw ip kw kx ka it ky kz ke ix la lb ki lc bi translated">将同一图像的所有标题组合在一起</h2><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es kk"><img src="../Images/14a12f1aaa91286d72b4eaf1dbd9dd95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_CvvJSn5XzIZnrjI7YXE1w.png"/></div></div></figure><p id="eda0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我把句子的数量限制在200个以内，只是为了证明这个想法。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es ld"><img src="../Images/f6eb021cae7c33a1293937c362c50a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8InNpkAXGi1vc4KlEgTE9Q.png"/></div></div></figure><h2 id="0ec7" class="kp jn hh bd jo kq kr ks js kt ku kv jw ip kw kx ka it ky kz ke ix la lb ki lc bi translated">给单词赋值:Tokenize</h2><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es le"><img src="../Images/5ea73371a7162d23eb7070c55b5937a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*37K4WBYOjBtnLdk0woGC6A.png"/></div></div></figure><p id="37ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们使用K-means将标签重新分配给n-gram序列。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><p id="b062" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们对每个序列都有了一个标签，我们需要将原始图像名称映射到标签。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><p id="e96f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们有每个标签的连接n-gram句子，我们称之为sens。我们也有原始句子标题，称之为句子。接下来，我们尝试将每个“感觉”文本与一个“句子”文本进行匹配，这样我们就有了一个与特定单词相关联的图像。</p><p id="76a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">***一个缺陷:我没有验证“sens”和“sentences”的每个文本条目是否都是唯一的，这导致了错误预测的问题，我们将在后面看到。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><h2 id="4de4" class="kp jn hh bd jo kq kr ks js kt ku kv jw ip kw kx ka it ky kz ke ix la lb ki lc bi translated">难的部分:最大限度地对带有原始标题的n元句子进行排序</h2><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lf"><img src="../Images/d963e42bc9ddb314f115b01322dcbeff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rAlupP05ECq1tPXXkx_mbQ.png"/></div></div></figure><p id="c562" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意比率矩阵的条目是零。如果我们在找到匹配后将每个条目设置为零，我们假设每个文本条目都是唯一的，并且同一个图像不应该被分配给两个或更多的文本条目。</p><p id="1d6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">另一个注意事项是，对文本条目进行最大程度的排序允许n-gram序列与原始序列进行更精确的匹配。但是，这限制了许多不同照片的使用，因为文本条目有多余的单词；换句话说，同样的词可以用来描述两个完全不同的图像，但我们的算法只是选择一张照片，而不是各种照片。如果我们以非最大化的方式对文本条目进行排序，我们会得到更多种类的照片，但匹配不太精确。我们的目标是获得文本和图像的匹配，所以我们将坚持最大排序。</p><h2 id="d713" class="kp jn hh bd jo kq kr ks js kt ku kv jw ip kw kx ka it ky kz ke ix la lb ki lc bi translated">测试排序</h2><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lf"><img src="../Images/46312555c5c19e321f18821b3ed888a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0e8MN2QVQgXgOgO4vdNsA.png"/></div></div></figure><p id="05f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面是成功的，但下面是对齐文本条目的失败。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lg"><img src="../Images/5bad1b3e0fc4a4f61b0bc1a0e7cc2594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UXstm9AnNs3eIgdpKT4l6Q.png"/></div></div></figure><p id="a31d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到两个文本条目“sens”和“senses”是相似的。这不是一场精确的比赛，但这是一个有趣的开始！</p><p id="221d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们将图像映射到使用K-means找到的n-gram维度标签。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><h2 id="0c63" class="kp jn hh bd jo kq kr ks js kt ku kv jw ip kw kx ka it ky kz ke ix la lb ki lc bi translated">制作模型</h2><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lh"><img src="../Images/e91904a763d71b2cf1e6a4d4a96a33f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hp4kSxycLvX_Xy0Q0dDgEg.png"/></div></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es ld"><img src="../Images/9b224fd5f72e05bfe5f7809d77e7541b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E5nv11ZsDOhbJh23XthRlQ.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es li"><img src="../Images/bce36dbda482be29a000fa54b5a535d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5OdZqRv_eqKEF8sn0QPL6Q.png"/></div></div></figure><p id="5b4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用标准的嵌入和LSTM层，该模型可以训练到相当不错的0.7的准确度分数。</p><h2 id="f00b" class="kp jn hh bd jo kq kr ks js kt ku kv jw ip kw kx ka it ky kz ke ix la lb ki lc bi translated">测试模型</h2><p id="e466" class="pw-post-body-paragraph ie if hh ig b ih lj ij ik il lk in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">使用<strong class="ig hi"> seed_text = '狗跑'</strong>和<strong class="ig hi"> seed_text = '小孩玩水两个男孩跑橘子球'</strong>，用下面的代码单元格我们同样的一个狗跑的图像。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jk jl l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lo"><img src="../Images/05111f723445c37e065746cfa362cb2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hborFt9XLBmI1P6QLlGhgQ.png"/></div></div></figure><p id="d47b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">尝试更多的查询:</p><p id="cef2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">部分成功:seed_text = '男子棕色衬衫深色短裤玩沙滩'</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lo"><img src="../Images/dc75801681c1935ef63f0e5af3069353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWJNGXEWX5QCU3rrKOta4g.png"/></div></div></figure><p id="a09d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">失败:seed_text = '盖伊站在沙地滑雪板上'</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="er es lo"><img src="../Images/6298cec7e5d7ad1c6883084d44ac9e26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6hFy7Hb2L3Ql87OF2TwWg.png"/></div></div></figure><p id="f452" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用这些简单的方法，文本到图像似乎是可能的，但是它受到单词数量的限制，因为K-means只能找到大约1000个句子的标签。此外，如果在多个文本条目中发现相似的单词，会有很多不准确性。</p><p id="ff27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望你喜欢这个分析。练习愉快！👋</p><div class="lp lq ez fb lr ls"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">medium.com</p></div></div><div class="mb l"><div class="mc l md me mf mb mg ji ls"/></div></div></a></div></div></div>    
</body>
</html>