<html>
<head>
<title>Using HuggingfaceğŸ¤— Transformers with PyTorch ğŸ”¥ for NLP tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨æ‹¥æŠ±è„¸ğŸ¤—PyTorchå˜å½¢é‡‘åˆšğŸ”¥å¯¹äºNLPä»»åŠ¡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/mlearning-ai/using-huggingface-transformers-with-pytorch-for-nlp-tasks-afc430190e22?source=collection_archive---------0-----------------------#2022-03-20">https://medium.com/mlearning-ai/using-huggingface-transformers-with-pytorch-for-nlp-tasks-afc430190e22?source=collection_archive---------0-----------------------#2022-03-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/9b9b79b7e36f8c961b522061e8905616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*no87ODhe6YV_5Cm6"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@claudiotesta?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Claudio Testa</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="df72" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬æ— æ³•æƒ³è±¡æ²¡æœ‰å˜å½¢é‡‘åˆšçš„NLPï¼Œæœ€åˆï¼Œå®ƒä»¬æ˜¯ç”¨äºç¿»è¯‘ä»»åŠ¡çš„ã€‚ä½†æ˜¯ï¼Œç”±äºå®ƒä»¬çš„åŠç›‘ç£å­¦ä¹ å’Œæ³¨æ„åŠ›å±‚ï¼Œå®ƒä»¬åœ¨åˆ†ç±»ã€æ‘˜è¦å’Œæ–‡æœ¬ç”Ÿæˆç­‰å…¶ä»–ä»»åŠ¡ä¸Šä¹Ÿè¡¨ç°å‡ºè‰²ã€‚å˜å½¢é‡‘åˆšèƒ½å¤Ÿä»å¥å­ä¸­è·å–ä¸Šä¸‹æ–‡å«ä¹‰ï¼Œå¹¶ç»™æˆ‘ä»¬é¢„æµ‹ã€‚</p><p id="c939" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®­ç»ƒè¿™ç§é«˜æ€§èƒ½å˜å‹å™¨æ˜¯æ˜‚è´µçš„ï¼Œå¹¶ä¸”éœ€è¦é«˜è®¡ç®—èƒ½åŠ›ã€‚è¿™æ˜¯åƒHuggingFaceï¼ŒGoogleï¼ŒFaceboook researchè¿™æ ·çš„ç»„ç»‡ç«™å‡ºæ¥è®­ç»ƒè¿™äº›æ¨¡å‹çš„åœ°æ–¹ã€‚ä»–ä»¬æŠŠå®ƒä»¬å…è´¹æä¾›ç»™å…¬ä¼—ä½¿ç”¨ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©é¢„è®­ç»ƒæ¨¡å‹ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œè¿ç§»å­¦ä¹ ã€‚</p><h2 id="b7a5" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">ä»€ä¹ˆæ˜¯åŠç›‘ç£å­¦ä¹ ï¼Ÿ</h2><p id="6577" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">å˜å‹å™¨æ¥å—å„ç§æ•°æ®çš„è®­ç»ƒã€‚ç ”ç©¶äººå‘˜ä½¿ç”¨äº†ä»–ä»¬èƒ½æƒ³åˆ°çš„æ‰€æœ‰æ•°æ®æºæ¥è®­ç»ƒè¿™äº›æ¨¡å‹ã€‚è¿™äº›å˜å‹å™¨çš„åˆå§‹æ¶æ„æ²¡æœ‰ç›‘ç£å­¦ä¹ çš„æ ‡ç­¾ã€‚ç¼–ç å™¨å’Œè§£ç å™¨é‡‡ç”¨åŠç›‘ç£å­¦ä¹ æ–¹æ³•è¿›è¡Œè®­ç»ƒã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæ¨¡å‹è‡ªåŠ¨ç¡®å®šæ ‡ç­¾ã€‚</p><h2 id="da54" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">å…³æ³¨å±‚æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p id="8f5d" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">å¯¹äºNLPä»»åŠ¡ï¼Œå°†æ–‡æœ¬å¥å­è½¬æ¢æˆæ•°å­—è¡¨ç¤ºæ˜¯å¿…è¦çš„ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†è®°å·èµ‹äºˆå™¨ï¼Œå®ƒå°†è¯æ±‡åŠå…¶å‰åçš„å¥å­è€ƒè™‘åœ¨å†…ï¼Œä¸ºå•è¯åˆ›å»ºæ•°å­—è®°å·ã€‚</p><h2 id="a3f9" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">ç”¨äºä»å˜å‹å™¨è¿›è¡Œæ¨æ–­çš„å…¬å…±ç®¡é“</h2><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ks"><img src="../Images/ed90f7eac38b448188cc07b260f39573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-MfC3zovrtbhLFPjIe1cg.png"/></div></div></figure><p id="4a47" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Huggingfaceåº“æä¾›äº†å˜å½¢é‡‘åˆšç±»ï¼Œåœ¨è¿™ä¸ªç±»ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä»é¢„å…ˆè®­ç»ƒçš„æ¨¡å‹ä¸­è¿›è¡Œç®€å•çš„æ¨ç†ï¼Œå¹¶ä½¿ç”¨æœ€æ–°çš„æ¨¡å‹ã€‚</p><h2 id="4c0b" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">æˆ‘ä»¬å¦‚ä½•å®‰è£…å˜å‹å™¨</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="edf4" class="js jt hh ky b fi lc ld l le lf">!pip -q install transformers </span></pre><h2 id="05f9" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å®ƒä»¬</h2><p id="a0f7" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">è¿™ä¸€æ¬¡ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨æ¨¡å‹3è¡Œä»£ç transformersåº“æä¾›çš„ç®¡é“æ¨¡å—ï¼Œå…¶ä¸­æœ‰é¢„å®šä¹‰çš„æ–¹æ³•ï¼Œæ‚¨å¯ä»¥åœ¨çŸ­çŸ­3è¡Œä»£ç ä¸­è·å¾—è¾“å‡º</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="5808" class="js jt hh ky b fi lc ld l le lf">from transformers import pipeline <br/>cls = pipeline("sentiment-analysis")<br/>cls("I like the way it is and I love it")</span></pre><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lg"><img src="../Images/f136a2f462f3cebeb69dc3b4f326b261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H38Xo7tx51pwexm6hFDMrQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">here we are getting sentiment analysis out of the box.</figcaption></figure><p id="ea51" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬è¿˜èƒ½åˆ©ç”¨è¿™æ¡ç®¡é“åšäº›ä»€ä¹ˆ</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="f587" class="js jt hh ky b fi lc ld l le lf">cls_b = pipeline("zero-shot-classification")<br/>cls_b(["This is related to computers" , "I love apples"] , ["apples", "computers"])</span></pre><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lh"><img src="../Images/5c25473b38c81b0cee9b930f65a69ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSeidrnEbSKqyu4keoPr_w.png"/></div></div></figure><p id="8193" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®©æˆ‘ä»¬ä½¿ç”¨æ‘˜è¦ç®¡é“æ¥è·å¾—æ®µè½çš„æ‘˜è¦:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="728f" class="js jt hh ky b fi lc ld l le lf">sum = pipeline("summarization")</span><span id="f156" class="js jt hh ky b fi li ld l le lf">sum("""What's the semi supervised learning? The transformers are trained on wide variety of data. Researchers have used all the data sources they can think of to train these models. Initial architecture of these transformers didn't have labels for supervised learnings. The encoder and decoders were trained with semi-supervised learning method. In this method model determines labels automatically.</span><span id="cfaa" class="js jt hh ky b fi li ld l le lf">What's the attention layer? For NLP tasks converting textual sentences to their numerical representation is necessary. For this we are using tokenizers which takes vocabulary into account along with the sentences before and after it for creating numerical tokens for words.""")[0]["summary_text"]</span></pre><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/5b4b3b22bc53557697de5d59e72bad48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqvZ4B81SBgf2tng2d38CQ.png"/></div></div></figure><p id="9114" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æœ‰å„ç§å¯ç”¨çš„é¢„å®šä¹‰ç®¡é“ï¼Œæ‚¨å¯ä»¥å€ŸåŠ©ä»¥ä¸‹å†…å®¹è¿›è¡Œæ¨æ–­:</p><ul class=""><li id="9f0e" class="lk ll hh iw b ix iy jb jc jf lm jj ln jn lo jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">feature-extraction</code>(è·å–æ–‡æœ¬çš„çŸ¢é‡è¡¨ç¤º)</li><li id="408b" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">fill-mask</code></li><li id="6a18" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">ner</code>(å‘½åå®ä½“è¯†åˆ«)</li><li id="88cc" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">question-answering</code></li><li id="a827" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">sentiment-analysis</code></li><li id="f8a0" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">summarization</code></li><li id="f234" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">text-generation</code></li><li id="3610" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">translation</code></li><li id="2fac" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">zero-shot-classification</code></li></ul><h2 id="1f99" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">ä½¿ç”¨è¿™äº›é¢„å…ˆæ„å»ºçš„æ¨¡å‹æ¥å®Œæˆæˆ‘ä»¬çš„ä»»åŠ¡</h2><p id="78e1" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ¨¡å‹ä½œä¸ºåŸºç¡€æ¨¡å‹æ¥ä¸ºæˆ‘ä»¬çš„ä»»åŠ¡æ„å»ºæ¨¡å‹ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨PyTorchä¸­å®ç°å®ƒğŸ”¥</p><figure class="kt ku kv kw fd ii"><div class="bz dy l di"><div class="mb mc l"/></div></figure><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/d9500854c2e2c2c71e2abb60ee5a2f96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RM2H6nsGRHJ3VG70W4tIdw.png"/></div></div></figure><p id="7165" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç¬”è®°æœ¬é“¾æ¥:</p><div class="me mf ez fb mg mh"><a href="https://colab.research.google.com/drive/1AFUqAc1uwF3xFYQUv_B2H8jOjGuhoXTh?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hi fi z dy mm ea eb mn ed ef hg bi translated">è°·æ­Œè”åˆå®éªŒå®¤</h2><div class="mo l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">é“¾æ¥åˆ°colab.research.google.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu in mh"/></div></div></a></div><blockquote class="mv mw mx"><p id="0395" class="iu iv my iw b ix iy iz ja jb jc jd je mz jg jh ji na jk jl jm nb jo jp jq jr ha bi translated">æ„Ÿè°¢é˜…è¯»æˆ‘çš„åšå®¢:)å…³æ³¨æ›´å¤šï¼Œ<br/>ç¥ä½ æœ‰ç¾å¥½çš„ä¸€å¤©ğŸ˜ƒ</p></blockquote><div class="me mf ez fb mg mh"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hi fi z dy mm ea eb mn ed ef hg bi translated">Mlearning.aiæäº¤å»ºè®®</h2><div class="nc l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">å¦‚ä½•æˆä¸ºMlearning.aiä¸Šçš„ä½œå®¶</h3></div><div class="mo l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">medium.com</p></div></div><div class="mp l"><div class="nd l mr ms mt mp mu in mh"/></div></div></a></div></div></div>    
</body>
</html>