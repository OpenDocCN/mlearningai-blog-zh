<html>
<head>
<title>Using Huggingface🤗 Transformers with PyTorch 🔥 for NLP tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用拥抱脸🤗PyTorch变形金刚🔥对于NLP任务</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/using-huggingface-transformers-with-pytorch-for-nlp-tasks-afc430190e22?source=collection_archive---------0-----------------------#2022-03-20">https://medium.com/mlearning-ai/using-huggingface-transformers-with-pytorch-for-nlp-tasks-afc430190e22?source=collection_archive---------0-----------------------#2022-03-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/9b9b79b7e36f8c961b522061e8905616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*no87ODhe6YV_5Cm6"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/@claudiotesta?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Claudio Testa</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="df72" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们无法想象没有变形金刚的NLP，最初，它们是用于翻译任务的。但是，由于它们的半监督学习和注意力层，它们在分类、摘要和文本生成等其他任务上也表现出色。变形金刚能够从句子中获取上下文含义，并给我们预测。</p><p id="c939" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">训练这种高性能变压器是昂贵的，并且需要高计算能力。这是像HuggingFace，Google，Faceboook research这样的组织站出来训练这些模型的地方。他们把它们免费提供给公众使用。现在，我们可以选择预训练模型，并在此基础上进行迁移学习。</p><h2 id="b7a5" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">什么是半监督学习？</h2><p id="6577" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">变压器接受各种数据的训练。研究人员使用了他们能想到的所有数据源来训练这些模型。这些变压器的初始架构没有监督学习的标签。编码器和解码器采用半监督学习方法进行训练。在这种方法中，模型自动确定标签。</p><h2 id="da54" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">关注层是什么？</h2><p id="8f5d" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">对于NLP任务，将文本句子转换成数字表示是必要的。为此，我们使用了记号赋予器，它将词汇及其前后的句子考虑在内，为单词创建数字记号。</p><h2 id="a3f9" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">用于从变压器进行推断的公共管道</h2><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ks"><img src="../Images/ed90f7eac38b448188cc07b260f39573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-MfC3zovrtbhLFPjIe1cg.png"/></div></div></figure><p id="4a47" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Huggingface库提供了变形金刚类，在这个类中，我们可以从预先训练的模型中进行简单的推理，并使用最新的模型。</p><h2 id="4c0b" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">我们如何安装变压器</h2><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="edf4" class="js jt hh ky b fi lc ld l le lf">!pip -q install transformers </span></pre><h2 id="05f9" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">让我们看看如何使用它们</h2><p id="a0f7" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">这一次，让我们看看如何使用模型3行代码transformers库提供的管道模块，其中有预定义的方法，您可以在短短3行代码中获得输出</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="5808" class="js jt hh ky b fi lc ld l le lf">from transformers import pipeline <br/>cls = pipeline("sentiment-analysis")<br/>cls("I like the way it is and I love it")</span></pre><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lg"><img src="../Images/f136a2f462f3cebeb69dc3b4f326b261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H38Xo7tx51pwexm6hFDMrQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">here we are getting sentiment analysis out of the box.</figcaption></figure><p id="ea51" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们看看我们还能利用这条管道做些什么</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="f587" class="js jt hh ky b fi lc ld l le lf">cls_b = pipeline("zero-shot-classification")<br/>cls_b(["This is related to computers" , "I love apples"] , ["apples", "computers"])</span></pre><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lh"><img src="../Images/5c25473b38c81b0cee9b930f65a69ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSeidrnEbSKqyu4keoPr_w.png"/></div></div></figure><p id="8193" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们使用摘要管道来获得段落的摘要:</p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="728f" class="js jt hh ky b fi lc ld l le lf">sum = pipeline("summarization")</span><span id="f156" class="js jt hh ky b fi li ld l le lf">sum("""What's the semi supervised learning? The transformers are trained on wide variety of data. Researchers have used all the data sources they can think of to train these models. Initial architecture of these transformers didn't have labels for supervised learnings. The encoder and decoders were trained with semi-supervised learning method. In this method model determines labels automatically.</span><span id="cfaa" class="js jt hh ky b fi li ld l le lf">What's the attention layer? For NLP tasks converting textual sentences to their numerical representation is necessary. For this we are using tokenizers which takes vocabulary into account along with the sentences before and after it for creating numerical tokens for words.""")[0]["summary_text"]</span></pre><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/5b4b3b22bc53557697de5d59e72bad48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dqvZ4B81SBgf2tng2d38CQ.png"/></div></div></figure><p id="9114" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有各种可用的预定义管道，您可以借助以下内容进行推断:</p><ul class=""><li id="9f0e" class="lk ll hh iw b ix iy jb jc jf lm jj ln jn lo jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">feature-extraction</code>(获取文本的矢量表示)</li><li id="408b" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">fill-mask</code></li><li id="6a18" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">ner</code>(命名实体识别)</li><li id="88cc" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">question-answering</code></li><li id="a827" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">sentiment-analysis</code></li><li id="f8a0" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">summarization</code></li><li id="f234" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">text-generation</code></li><li id="3610" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">translation</code></li><li id="2fac" class="lk ll hh iw b ix lw jb lx jf ly jj lz jn ma jr lp lq lr ls bi translated"><code class="du lt lu lv ky b">zero-shot-classification</code></li></ul><h2 id="1f99" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">使用这些预先构建的模型来完成我们的任务</h2><p id="78e1" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">我们可以使用这些模型作为基础模型来为我们的任务构建模型。让我们看看如何在PyTorch中实现它🔥</p><figure class="kt ku kv kw fd ii"><div class="bz dy l di"><div class="mb mc l"/></div></figure><figure class="kt ku kv kw fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/d9500854c2e2c2c71e2abb60ee5a2f96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RM2H6nsGRHJ3VG70W4tIdw.png"/></div></div></figure><p id="7165" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">笔记本链接:</p><div class="me mf ez fb mg mh"><a href="https://colab.research.google.com/drive/1AFUqAc1uwF3xFYQUv_B2H8jOjGuhoXTh?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hi fi z dy mm ea eb mn ed ef hg bi translated">谷歌联合实验室</h2><div class="mo l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">链接到colab.research.google.com</p></div></div><div class="mp l"><div class="mq l mr ms mt mp mu in mh"/></div></div></a></div><blockquote class="mv mw mx"><p id="0395" class="iu iv my iw b ix iy iz ja jb jc jd je mz jg jh ji na jk jl jm nb jo jp jq jr ha bi translated">感谢阅读我的博客:)关注更多，<br/>祝你有美好的一天😃</p></blockquote><div class="me mf ez fb mg mh"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hi fi z dy mm ea eb mn ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nc l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mo l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">medium.com</p></div></div><div class="mp l"><div class="nd l mr ms mt mp mu in mh"/></div></div></a></div></div></div>    
</body>
</html>