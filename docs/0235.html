<html>
<head>
<title>LeNet and MNIST handwritten digit recognition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">LeNet和MNIST手写数字识别</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/lenet-and-mnist-handwritten-digit-classification-354f5646c590?source=collection_archive---------0-----------------------#2021-03-08">https://medium.com/mlearning-ai/lenet-and-mnist-handwritten-digit-classification-354f5646c590?source=collection_archive---------0-----------------------#2021-03-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6cf4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">LeNet(或称LeNet-5)是Yann LeCun、Léon Bottou、Yoshua Bengio和Patrick Haffner在1989年提出的一种卷积神经网络结构。该网络的第一个目的是识别图像中的手写数字。成功应用于美国邮政提供的手写邮政编码识别<a class="ae jc" href="http://yann.lecun.com/exdb/publis/pdf/lecun-90c.pdf" rel="noopener ugc nofollow" target="_blank"> [1] </a>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/ae5428745325393e2f8c2d7f0c1b8635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/1*XYaxSCj98d4Kg24aH3tXZw.gif"/></div><figcaption class="jl jm et er es jn jo bd b be z dx"><a class="ae jc" href="http://yann.lecun.com/exdb/lenet/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="105e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将探索该网络的体系结构及其在MNIST手写数字图像中的应用。</p></div><div class="ab cl jp jq go jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="ha hb hc hd he"><h1 id="abee" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">一、建筑</h1><p id="569f" class="pw-post-body-paragraph ie if hh ig b ih ku ij ik il kv in io ip kw ir is it kx iv iw ix ky iz ja jb ha bi translated">LeNet由2个部分组成:</p><ul class=""><li id="f2b6" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">第一部分包括交替放置的两个卷积层和两个池层。</li><li id="b376" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">第二部分由三个完全连接的层组成。</li></ul><p id="0e5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图描述了LeNet的体系结构:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es ln"><img src="../Images/9e25b5a5c30aa6deb27390cb3989d12c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYiQq1Gg_yHKszun23MocQ.png"/></div></div><figcaption class="jl jm et er es jn jo bd b be z dx">LeNet architecture. <a class="ae jc" href="https://d2l.ai/chapter_convolutional-neural-networks/lenet.html#lenet" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="988b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上图中，Cx、Sx、Fx分别对应于卷积层、子采样层(也称汇集层)和全连接层，其中x表示层索引。</p><ul class=""><li id="2eda" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">输入是大小为28 × 28的图像</li><li id="542f" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">C1是第一个具有6个5× 5卷积核的卷积层。</li><li id="0774" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">S2是输出6路14 × 14图像的汇聚层。在这种情况下，池窗口大小是2 × 2的正方形矩阵。</li><li id="960d" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">C3是一个卷积层，有16个5 × 5大小的卷积核。因此，该层的输出是16幅大小为10 × 10的特征图像。</li><li id="7c39" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">S4是一个池层，池窗口大小为2 × 2。因此，通过该层的图像尺寸减半，它输出16幅5 × 5尺寸的特征图像。</li><li id="3cbe" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">C5是具有大小为5 × 5的120个卷积核的卷积层。由于该层的输入与内核大小相同，因此该层的输出大小为1 × 1。输出中的通道数等于内核的通道数，即120。因此，该层的输出是120幅1 × 1大小的特征图像。</li><li id="acb8" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">F6是具有84个神经元的完全连接层，所有神经元都连接到C5的输出。</li><li id="1c70" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">输出层由10个神经元组成，对应于类的个数(从0到9的个数)。</li></ul><h1 id="39b4" class="jw jx hh bd jy jz ls kb kc kd lt kf kg kh lu kj kk kl lv kn ko kp lw kr ks kt bi translated">二、议案LeNet在MNIST数据识别中的应用</h1><p id="bb48" class="pw-post-body-paragraph ie if hh ig b ih ku ij ik il kv in io ip kw ir is it kx iv iw ix ky iz ja jb ha bi translated">在本部分中，我们将LeNet应用于MNIST手写数字图像的识别。该网络构建于Keras平台:</p><h2 id="dad4" class="lx jx hh bd jy ly lz ma kc mb mc md kg ip me mf kk it mg mh ko ix mi mj ks mk bi translated">1.正在加载MNIST数据集</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="6ed2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随机可视化训练集中的一些图像:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/ae551b3e147e583ab2951be9a8b13546.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Xn0r6G1fwvLptXi7B5LiBQ.png"/></div></figure><h2 id="4270" class="lx jx hh bd jy ly lz ma kc mb mc md kg ip me mf kk it mg mh ko ix mi mj ks mk bi translated">2.预处理数据</h2><p id="1b1d" class="pw-post-body-paragraph ie if hh ig b ih ku ij ik il kv in io ip kw ir is it kx iv iw ix ky iz ja jb ha bi translated">此任务包括以下步骤:</p><ul class=""><li id="8c99" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">将图像重塑为所需的Keras大小</li><li id="37e1" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">将整数值转换为浮点值</li><li id="58ab" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">标准化数据</li><li id="ec1c" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">热门编码标签</li></ul><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><h2 id="737d" class="lx jx hh bd jy ly lz ma kc mb mc md kg ip me mf kk it mg mh ko ix mi mj ks mk bi translated">3.构建LeNet模型</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><pre class="je jf jg jh fd mo mp mq mr aw ms bi"><span id="e7b1" class="lx jx hh mp b fi mt mu l mv mw">LeNet_model = LeNet()<br/>LeNet_model.summary()</span><span id="515d" class="lx jx hh mp b fi mx mu l mv mw">Model: "sequential"<br/>_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>conv2d (Conv2D)              (None, 28, 28, 6)         156       <br/>_________________________________________________________________<br/>max_pooling2d (MaxPooling2D) (None, 14, 14, 6)         0         <br/>_________________________________________________________________<br/>conv2d_1 (Conv2D)            (None, 10, 10, 16)        2416      <br/>_________________________________________________________________<br/>max_pooling2d_1 (MaxPooling2 (None, 5, 5, 16)          0         <br/>_________________________________________________________________<br/>flatten (Flatten)            (None, 400)               0         <br/>_________________________________________________________________<br/>dense (Dense)                (None, 120)               48120     <br/>_________________________________________________________________<br/>dense_1 (Dense)              (None, 10)                1210      <br/>=================================================================<br/>Total params: 51,902<br/>Trainable params: 51,902<br/>Non-trainable params: 0<br/>_________________________________________________________________</span></pre><h2 id="0ae1" class="lx jx hh bd jy ly lz ma kc mb mc md kg ip me mf kk it mg mh ko ix mi mj ks mk bi translated">4.培训模式</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><pre class="je jf jg jh fd mo mp mq mr aw ms bi"><span id="5149" class="lx jx hh mp b fi mt mu l mv mw">train_model(LeNet_model, X_train, y_train, X_test, y_test)</span><span id="f873" class="lx jx hh mp b fi mx mu l mv mw">Epoch 1/50<br/>468/468 [==============================] - 35s 5ms/step - loss: 1.5654 - accuracy: 0.5390 - val_loss: 36.5179 - val_accuracy: 0.9097<br/>Epoch 2/50<br/>468/468 [==============================] - 2s 4ms/step - loss: 0.3126 - accuracy: 0.9072 - val_loss: 26.5710 - val_accuracy: 0.9378<br/>...................<br/>...................<br/>...................<br/>Epoch 49/50<br/>468/468 [==============================] - 2s 4ms/step - loss: 0.0249 - accuracy: 0.9927 - val_loss: 6.1983 - val_accuracy: 0.9875<br/>Epoch 50/50<br/>468/468 [==============================] - 2s 4ms/step - loss: 0.0262 - accuracy: 0.9922 - val_loss: 6.0475 - val_accuracy: 0.9869<br/>313/313 [==============================] - 1s 2ms/step - loss: 6.0378 - accuracy: 0.9869</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/06333d54ba4b6ae83fdd7949204be99f.png" data-original-src="https://miro.medium.com/v2/format:webp/1*2bCBqeGvoWG-LtIZHr-hcQ.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx">Accuracy on training and testing set</figcaption></figure><h2 id="340e" class="lx jx hh bd jy ly lz ma kc mb mc md kg ip me mf kk it mg mh ko ix mi mj ks mk bi translated">5.预言；预测；预告</h2><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><p id="bebd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">确定混淆矩阵:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/8ac23a84f2d493c15635c06667c14dd7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*eRPn71rODVmlb3RyUnWkuw.png"/></div></figure><p id="38b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随机可视化测试集中的一些图像及其预测标签:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ml mm l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/493c9f5ee207b60c56fdee8e2f63d288.png" data-original-src="https://miro.medium.com/v2/format:webp/1*xA8Q_Sc7GeoflElmLHmS1w.png"/></div></figure><h1 id="7776" class="jw jx hh bd jy jz ls kb kc kd lt kf kg kh lu kj kk kl lv kn ko kp lw kr ks kt bi translated">三、议案结论</h1><p id="7663" class="pw-post-body-paragraph ie if hh ig b ih ku ij ik il kv in io ip kw ir is it kx iv iw ix ky iz ja jb ha bi translated">我们已经发现了LeNet模型的架构以及如何在Keras中实现它。该模型成功地应用于MNIST手写数字图像的分类，取得了98.69%的分类性能。在接下来的文章中，我们将发现一些现代卷积模型以及它们在更复杂问题中的应用。</p><p id="d3d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望这篇文章对你有帮助。</p><p id="7031" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">感谢阅读！</p><p id="ebed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="my">本文Github代码</em></strong>:<a class="ae jc" href="https://github.com/KhuyenLE-maths/LeNet_model_with_MNIST_recognition/blob/main/LeNet_with_MNIST_recognition.ipynb" rel="noopener ugc nofollow" target="_blank">https://Github . com/khu yenle-maths/LeNet _ model _ with _ MNIST _ recognition/blob/main/LeNet _ with _ MNIST _ recognition . ipynb</a></p><p id="2f36" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="my">我的博客页面</em></strong>:<a class="ae jc" href="https://lekhuyen.medium.com/" rel="noopener">https://lekhuyen.medium.com/</a></p><p id="aad2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">________________________________________________________________</p><h2 id="98b3" class="lx jx hh bd jy ly lz ma kc mb mc md kg ip me mf kk it mg mh ko ix mi mj ks mk bi translated">参考:</h2><p id="01b1" class="pw-post-body-paragraph ie if hh ig b ih ku ij ik il kv in io ip kw ir is it kx iv iw ix ky iz ja jb ha bi translated">[1] Le Cun，y .，Boser，b .，Denker，J. S .，Henderson，d .，Howard，R. E .，Hubbard，w .，&amp; Jackel，L. D. (1989年1月)。基于反向传播网络的手写数字识别。第二届国际神经信息处理系统会议论文集<em class="my">(第396-404页)。</em></p></div></div>    
</body>
</html>