<html>
<head>
<title>Data Leakage — Be Aware From What Your Model Learns</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据泄漏—从您的模型中了解到的信息</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/data-leakage-be-aware-from-what-your-model-learns-f33080fa2f5e?source=collection_archive---------5-----------------------#2022-06-20">https://medium.com/mlearning-ai/data-leakage-be-aware-from-what-your-model-learns-f33080fa2f5e?source=collection_archive---------5-----------------------#2022-06-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="52bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章的目的是展示数据泄露如何成为机器学习中的一个真正的眼中钉。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/3b9a3dbf2f457166944a1afa692efa0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*U86XlL_-lo0CfPJe"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@unstable_affliction?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ivan Bandura</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4f9b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">模型性能的提高令人欢欣鼓舞，但正如我在另一篇文章中所表达的，模型泛化的目标比拥有一个99%准确率的模型更重要。</p><h1 id="8559" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">什么是数据泄露</h1><p id="910b" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated"><strong class="ig hi">数据泄露</strong>是一个可以被称为<strong class="ig hi">数据窥探</strong>的概念(如果你感兴趣，请查看我写的<a class="ae js" rel="noopener" href="/geekculture/data-snooping-in-data-science-a-not-enough-known-issue-b6936e3552b7">文章</a>)因为窥探在某些时候可能会成为泄露并导致相同的问题，但它会走得更远，让我们看看这个。</p><p id="dd04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当一个模型用来训练和学习的数据是<strong class="ig hi"> <em class="kw">泄漏</em> </strong>时，它就面临<strong class="ig hi">数据泄漏</strong>，这意味着一些信息来自外部，帮助它改进预测。<br/>来自之外的<strong class="ig hi">的信息可以简化为当模型将在新的观察上工作时不可用的数据。</strong></p><blockquote class="kx ky kz"><p id="7c00" class="ie if kw ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated">数据收集、汇总和准备过程中无意引入的关于目标的预测信息</p><p id="bd37" class="ie if kw ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated">(Rosset等人——医疗数据挖掘:从赢得两次比赛中吸取的教训)</p></blockquote><p id="a07f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">泄漏导致一个众所周知的问题:<strong class="ig hi">过度配合</strong>。事实上，虽然模型在训练时会显示出很好的性能，但当它投入生产时就会丢失，让我们来谈谈一些例子…</p><p id="95ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以区分<strong class="ig hi">不同类型的</strong>数据泄露:</p><ul class=""><li id="16a9" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi">训练观测值</strong>内部的泄漏:在任何分割之前(或交叉验证(CV)之前)对整个数据集进行数据预处理<strong class="ig hi">的情况。例如，从一列中其余部分的平均值中输入该列中缺失的值，并执行交叉验证。CV中训练的每个模型的评估都是错误的，因为每个模型都是用整个数据集上转换的数据训练的。</strong></li><li id="8d29" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">通过添加新特征的泄漏</strong>:使用一个或几个与目标有很大关系但只有在收集数据后才可用的特征来训练模型的情况。例如，为雨天预测指定降雨量的列。此栏仅在一天结束后可用，不会用于新的预测。</li></ul><p id="bd53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">了解泄漏的一个好方法是检查培训期间使用的功能是否:</p><ul class=""><li id="d57b" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">不是由目标本身产生的(不像以前的降雨特征)。</li><li id="4384" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">不基于验证数据进行转换。</li></ul><blockquote class="kx ky kz"><p id="aff2" class="ie if kw ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated">为了防止这种类型的数据泄漏，应该排除在实现目标值之后更新(或创建)的任何变量。【Kaggle的数据泄露)</p></blockquote><p id="b077" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在你明白了什么是数据泄露，我就给你讲一个我遇到的例子…</p></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><h1 id="441c" class="jt ju hh bd jv jw ly jy jz ka lz kc kd ke ma kg kh ki mb kk kl km mc ko kp kq bi translated">数据泄漏示例:表格操场系列—2022年1月</h1><p id="a2d9" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在<strong class="ig hi"> Kaggle </strong>上，每个月都会发布一个新的挑战，叫做<strong class="ig hi">表格游乐场系列</strong>。这些挑战就像竞赛一样，但要在各种问题上练习技巧。比如2022年6月的<a class="ae js" href="https://www.kaggle.com/competitions/tabular-playground-series-jun-2022" rel="noopener ugc nofollow" target="_blank"> TPS就是关于数据插补和缺失值的。</a></p><p id="cc5a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2022年1月，我决定参加每月一次的<a class="ae js" href="https://www.kaggle.com/competitions/tabular-playground-series-jan-2022/data?select=test.csv" rel="noopener ugc nofollow" target="_blank">表格游乐场系列</a>。这一个是关于预测位于<strong class="ig hi">3</strong>17】真实国家的2 <strong class="ig hi">虚拟商店</strong>的<strong class="ig hi">3</strong>11】虚拟商品的销售。这个想法是为了找到可以识别销售高峰的季节性时段。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es md"><img src="../Images/04e4ec6ccbb62d18fd2fd696a24a35f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mj3fZsVcanfsKf9EUvCIQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">TPS January 2022 Training Dataset (made with <a class="ae js" href="https://xnapper.com/" rel="noopener ugc nofollow" target="_blank">Xnapper</a>)</figcaption></figure><p id="75fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">举个例子:<em class="kw">年底</em>、<em class="kw">复活节</em>、<em class="kw">节假日</em>都是销售较多的时段。一些伟大的Kagglers已经成功地控制了数据中的这种噪声，并允许模型通过知道这些时期是不同的(就销售而言)来学习。</p><h2 id="4eda" class="me ju hh bd jv mf mg mh jz mi mj mk kd ip ml mm kh it mn mo kl ix mp mq kp mr bi translated">但是……哪里漏了？</h2><p id="ff85" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">挑战的主要特征之一是销售的国家:瑞典、挪威或芬兰。</p><p id="b41e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过一些特征工程和研究，挑战者发现国内生产总值(GDP)可能与销售额有关。当你思考这种关系时，如果一个国家看到它的全球收入增加，这个国家的人民也会看到他们的收入增加(通过简化和忽略人均收入)。<br/>凯格勒特级大师<a class="ae js" href="https://www.kaggle.com/ambrosm" rel="noopener ugc nofollow" target="_blank">安布罗姆</a>在他的<a class="ae js" href="https://www.kaggle.com/code/ambrosm/tpsjan22-06-lightgbm-quickstart/notebook" rel="noopener ugc nofollow" target="_blank">作品</a>中找到的最终比例值是:1.212。意思是每年的销售额会按照1.212 ** GDP(年)变化。如果国内生产总值下降，与上一年相比，销售额将按比例下降。</p><p id="63f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">你看出数据泄露在哪里了吗？</strong></p><p id="2e93" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个非常有用的新功能是年度的<strong class="ig hi"> GDP </strong>，它是在学习过程中帮助模型的一个很好的方式，但在根据新数据进行预测时却成为一个真正的问题。</p><p id="dc2e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设你想在2022年2月使用模型(假设我们在2022年，一年还没完)。<strong class="ig hi">将不会有任何真实的数据来替代当年</strong>的GDP  <strong class="ig hi">，你的功能也将变得毫无用处。然而，模型需要它，并且不会像在训练期间那样准确，更糟糕的是，它会估计无意义的销售。</strong></p><p id="74a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">显然，这个例子来自一个用虚拟数据进行的Kaggle竞赛，并被用于实践。然而，这种类型的错误可能发生在实际的问题解决中。</p><h1 id="dded" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="14da" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">数据泄漏是模型训练被破坏的情况，或者是由于<strong class="ig hi">一个</strong> <strong class="ig hi">新特征</strong>或者是由于<strong class="ig hi">在没有分割数据的情况下对现有特征</strong>进行的转换。由于<strong class="ig hi">过度拟合</strong>，它可以简单地使模型在新数据上不可用。<br/>为了处理泄漏，你应该知道你的模型中的数据和用于使模型学习的数据！</p><p id="3dd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">感谢你阅读文章，我希望你喜欢它，并了解什么是数据泄漏！</p><h2 id="7e8e" class="me ju hh bd jv mf mg mh jz mi mj mk kd ip ml mm kh it mn mo kl ix mp mq kp mr bi translated">资源:</h2><div class="ms mt ez fb mu mv"><a href="https://dl.acm.org/doi/10.1145/2020408.2020496" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">数据挖掘中的泄漏|第17届ACM SIGKDD国际知识会议论文集…</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">被认为是“十大数据挖掘错误之一”的泄漏本质上是关于数据信息的引入…</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">dl.acm.org</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj jm mv"/></div></div></a></div><div class="ms mt ez fb mu mv"><a href="https://www.kaggle.com/code/alexisbcook/data-leakage/tutorial" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">数据泄露</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自《计量经济学…》一书的信用卡数据</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">www.kaggle.com</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj jm mv"/></div></div></a></div><div class="ms mt ez fb mu mv"><a href="https://machinelearningmastery.com/data-leakage-machine-learning/" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">机器学习中的数据泄漏-机器学习掌握</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">在开发预测模型时，数据泄漏是机器学习中的一个大问题。数据泄漏是指当信息…</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">machinelearningmastery.com</p></div></div><div class="ne l"><div class="nl l ng nh ni ne nj jm mv"/></div></div></a></div><div class="ms mt ez fb mu mv"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">medium.com</p></div></div><div class="ne l"><div class="nm l ng nh ni ne nj jm mv"/></div></div></a></div></div></div>    
</body>
</html>