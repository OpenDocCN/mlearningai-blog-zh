<html>
<head>
<title>Machine Learning App with Shiny</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带Shiny的机器学习App</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/machine-learning-app-with-shiny-8c088f2f4646?source=collection_archive---------3-----------------------#2022-11-14">https://medium.com/mlearning-ai/machine-learning-app-with-shiny-8c088f2f4646?source=collection_archive---------3-----------------------#2022-11-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/fcddd75626bdb62997b48bdd15e1ef9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*M-4vbAhZpCENsQds.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx"><a class="ae it" href="https://appsilon.com/scaling-and-infrastructure-why-is-my-shiny-app-slow/" rel="noopener ugc nofollow" target="_blank">https://appsilon.com/scaling-and-infrastructure-why-is-my-shiny-app-slow/</a></figcaption></figure><p id="8e38" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本文将介绍如何使用R Studio构建一个闪亮的应用程序。此外，还将讨论Shiny是什么以及使用Shiny的好处。本演练的先决条件如下:</p><ul class=""><li id="2b63" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">R的安装</li><li id="d2d9" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">R Studio的安装</li><li id="e22c" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">安装用于R Studio演示的包</li></ul><p id="fd9c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要查看本演练中使用的文件，请使用下面的我的GitLab或GitHub库:</p><p id="1b81" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">git lab—<a class="ae it" href="https://gitlab.com/rshowrav/machine_learning_shiny_demo" rel="noopener ugc nofollow" target="_blank">https://gitlab.com/rshowrav/machine_learning_shiny_demo</a></p><p id="ec50" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">GitHub—【https://github.com/rshowrav/machine_learning_shiny_demo T2】</p><h2 id="e5be" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">什么是闪亮的？</h2><p id="b493" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr ha bi translated">Shiny是Posit(以前的R Studio)开发的一个包，可以帮助用R或Python轻松构建web应用程序。此外，有一个开源的服务器可以发布和维护这些内容。闪亮的应用程序可以使用CSS主题、htmlwidgets和Javascript动作进行扩展。通过本演练，您将看到使用它是多么简单。</p><h2 id="bb08" class="kg kh hh bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">演练</h2><p id="70ac" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr ha bi translated">本演练将使用R-Studio提供的数据集Longley数据集。这是一个经济回归数据集。数据集有七个经济变量(GNP .平减指数、GNP、失业、武装部队、人口、年份和就业)。我们的最终输出将如下所示:</p><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lg"><img src="../Images/76740a858849813d81c82651db2b6a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHUHU5nwx7RMKkVlrsxTsQ.png"/></div></div></figure><ol class=""><li id="a7d1" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr ll jy jz ka bi translated">在R Studio中选择新的闪亮网络应用</li></ol><figure class="lh li lj lk fd ii er es paragraph-image"><div class="er es lm"><img src="../Images/547c41778a0c13aa02c03d50e4724223.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*Mry4nbJI04G-XsWe8q8H8g.png"/></div></figure><p id="1403" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2.第一步会给你以下两个文件。第一个是用户界面(ui。r)而第二个是针对服务器(Server。r)。清理这些文件。</p><figure class="lh li lj lk fd ii er es paragraph-image"><div class="er es ln"><img src="../Images/a6d1ad36d04aabbbf90670d26dda7a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*9tK6iN32b3DwqZepChwaKg.png"/></div></figure><p id="dec7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.在用户界面文件中，使用以下代码加载以下库(注意:如果尚未完成，请安装)。</p><pre class="lh li lj lk fd lo lp lq bn lr ls bi"><span id="9ac3" class="lt kh hh lp b be lu lv l lw lx">library(shiny)<br/>library(shinydashboard)<br/>library(maps)<br/>library(dplyr)<br/>library(leaflet)<br/>library(shinycssloaders)<br/>library(shinythemes)<br/>library(datadigest)<br/>library(rio)<br/>library(DT)<br/>library(stargazer)</span></pre><p id="aaa2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4.使用下面的代码在服务器文件中做同样的事情。</p><pre class="lh li lj lk fd lo lp lq bn lr ls bi"><span id="d49c" class="lt kh hh lp b be lu lv l lw lx">library(shiny)<br/>library(shinydashboard)<br/>library(maps)<br/>library(dplyr)<br/>library(leaflet)<br/>library(ggplot2)<br/>library(tidyverse)<br/>library(DT)<br/>library(plotly)<br/>library(corrplot)<br/>library(caret)<br/>library(stargazer)</span></pre><p id="86b0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">5.用户界面是使用下面的代码构建的。</p><pre class="lh li lj lk fd lo lp lq bn lr ls bi"><span id="3d67" class="lt kh hh lp b be lu lv l lw lx">dashboardPage(<br/>  dashboardHeader(title = "Machine Learning Demo", dropdownMenuOutput("msgOutput")),<br/>  dashboardSidebar(<br/>    sliderInput(<br/>      "Slider",<br/>      label = h3("Train/Test Split %"),<br/>      min = 0,<br/>      max = 100,<br/>      value = 75<br/>    ),<br/>    textOutput("cntTrain"),<br/>    textOutput("cntTest"),<br/>    br()<br/>  ),<br/>  dashboardBody(<br/>    fluidPage(<br/>      box(<br/>        selectInput(<br/>          "SelectX",<br/>          label = "Select variables:",<br/>          choices = names(longley),<br/>          multiple = TRUE,<br/>          selected = names(longley)<br/>        ),<br/>        solidHeader = TRUE,<br/>        width = "3",<br/>        status = "primary",<br/>        title = "X variables"<br/>      ),<br/>      box(<br/>        selectInput("SelectY", label = "Select variable to predict:", choices = names(longley)),<br/>        solidHeader = TRUE,<br/>        width = "3",<br/>        status = "primary",<br/>        title = "Y variable"<br/>      )<br/>    ),<br/>    <br/>    fluidPage(  <br/>      <br/>      tabBox(<br/>        id = "tabset",<br/>        height = "1000px",<br/>        width = 12,<br/>        <br/>        tabPanel("Data",<br/>                 box(withSpinner(DTOutput(<br/>                   "Data"<br/>                 )), width = 12)),<br/>        tabPanel(<br/>          "Data Summary",<br/>          box(withSpinner(verbatimTextOutput("Summ")), width = 6),<br/>          box(withSpinner(verbatimTextOutput("Summ_old")), width = 6)<br/>        ),<br/>        tabPanel(<br/>          "Model",<br/>          box(<br/>            withSpinner(verbatimTextOutput("Model")),<br/>            width = 6,<br/>            title = "Model Summary"<br/>          ),<br/>          box(<br/>            withSpinner(verbatimTextOutput("ImpVar")),<br/>            width = 5,<br/>            title = "Variable Importance"<br/>          )<br/>        ),<br/>        tabPanel(<br/>          "Prediction",<br/>          box(withSpinner(plotOutput("Prediction")), width = 6, title = "Best Fit Line"),<br/>          box(withSpinner(plotOutput("residualPlots")), width = 6, title = "Diagnostic Plots")<br/>        )<br/>      )<br/>    )<br/>  )<br/>)</span></pre><p id="ae77" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在开始之前，让我们了解一下这段代码的每一部分都在做什么。</p><p id="3f06" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">dashboardPage()中编码的第一部分代码构建了用户界面的以下两个部分</p><figure class="lh li lj lk fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/bc38c3e6d60f7759858f09a30787c65e.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*zO_UpTpYPuwU4KR-1sdKlQ.png"/></div></figure><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lz"><img src="../Images/24d79ccc66ce0070ed1c6b40a9d6d652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GFiI9ktTULiw9HoD_KN3LQ.png"/></div></div></figure><p id="ceb6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的代码fluidpage()的下一部分构建了以下选项卡:</p><figure class="lh li lj lk fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/b848caee5d57097ca8c4c3dec6464400.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*qbunKEM7dwUFGlJvf_8VXw.png"/></div></figure><p id="d396" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在fluidpage()中，您会发现tabbox()，它构建了如下所示的每个选项卡:</p><p id="5d89" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">数据</strong></p><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/3d9d94a709de655f2df3ad9c8e412cf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ICZVpA9EjrBGYlvWJzB_0Q.png"/></div></div></figure><p id="115d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">数据汇总</strong></p><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/45d2d33304378779979920bdad61a3b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5KqOVTAn_Ax4aZOi65GyJA.png"/></div></div></figure><p id="0ffa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">型号</strong></p><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/67527899dbffe6b5b74c6743dac8fd95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7pkTmsANT99Cxtd6EErAiw.png"/></div></div></figure><p id="ae43" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">预测</strong></p><figure class="lh li lj lk fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/bb245a5f1ed5a1dd5b3ffd196087467c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jpDQPti4NgGBkGhvWJ8jPA.png"/></div></div></figure><p id="9cc9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">6.既然我们已经构建了用户界面，我们需要一种与服务器通信的方法。接下来，我们使用下面的代码更新服务器文件。请注意，下面的内容与我们编写R文件的方式没有什么不同。这将创建一个接受输入、输出和会话的函数。我们的输入是朗利数据本身。输入的值由X和Y变量的用户输入以及训练和测试分割来定义。输出是我们在选项卡中看到的已定义的视觉效果或表格结构，即数据本身、描述性统计数据(数据摘要选项卡)、模型结果(模型选项卡)和模型诊断(预测选项卡)。会话是自动定义的，除非放在Shiny服务器中。</p><pre class="lh li lj lk fd lo lp lq bn lr ls bi"><span id="372b" class="lt kh hh lp b be lu lv l lw lx"># Define server logic required to draw a histogram<br/><br/>shinyServer(function(input, output, session) {<br/>  <br/>  InputDataset &lt;- reactive({<br/>    longley<br/>  })<br/>  <br/>  <br/>  InputDataset_model &lt;- reactive({<br/>    if (is.null(input$SelectX)) {<br/>      dt &lt;- longley<br/>    }<br/>    else{<br/>      dt &lt;- longley[, c(input$SelectX)]<br/>    }<br/>    <br/>  })<br/>  <br/>  <br/>  observe({<br/>    lstname &lt;- names(InputDataset())<br/>    updateSelectInput(session = session,<br/>                      inputId = "SelectY",<br/>                      choices = lstname)<br/>  })<br/>  <br/>  splitSlider &lt;- reactive({<br/>    input$Slider / 100<br/>  })<br/>  output$Summ &lt;-<br/>    renderPrint(<br/>      stargazer(<br/>        InputDataset(),<br/>        type = "text",<br/>        title = "Descriptive statistics",<br/>        digits = 1,<br/>        out = "table1.txt"<br/>      )<br/>    )<br/>  output$Summ_old &lt;- renderPrint(summary(InputDataset()))<br/>  output$structure &lt;- renderPrint(str(InputDataset()))<br/>  <br/>  set.seed(123)  # setting seed to reproduce results of random sampling<br/>  trainingRowIndex &lt;-<br/>    reactive({<br/>      sample(1:nrow(InputDataset_model()),<br/>             splitSlider() * nrow(InputDataset_model()))<br/>    })# row indices for training data<br/>  <br/>  trainingData &lt;- reactive({<br/>    tmptraindt &lt;- InputDataset_model()<br/>    tmptraindt[trainingRowIndex(), ]<br/>  })<br/>  <br/>  testData &lt;- reactive({<br/>    tmptestdt &lt;- InputDataset_model()<br/>    tmptestdt[-trainingRowIndex(),]<br/>  })<br/>  <br/>  <br/>  <br/>  output$cntTrain &lt;-<br/>    renderText(paste("Train Data:", NROW(trainingData()), "records"))<br/>  output$cntTest &lt;-<br/>    renderText(paste("Test Data:", NROW(testData()), "records"))<br/>  <br/>  output$Data &lt;- renderDT(InputDataset())<br/>  <br/>  <br/>  cormat &lt;- reactive({<br/>    round(cor(InputDataset()), 1)<br/>  })<br/>  output$Corr &lt;-<br/>    renderPlot(corrplot(<br/>      cormat(),<br/>      type = "lower",<br/>      order = "hclust",<br/>      method = "number"<br/>    ))<br/>  <br/>  <br/>  #Linear Regression<br/>  <br/>  f &lt;- reactive({<br/>    as.formula(paste(input$SelectY, "~."))<br/>  })<br/>  <br/>  <br/>  Linear_Model &lt;- reactive({<br/>    lm(f(), data = trainingData())<br/>  })<br/>  <br/>  output$Model &lt;- renderPrint(summary(Linear_Model()))<br/>  output$Model_new &lt;-<br/>    renderPrint(<br/>      stargazer(<br/>        Linear_Model(),<br/>        type = "text",<br/>        title = "Model Results",<br/>        digits = 1,<br/>        out = "table1.txt"<br/>      )<br/>    )<br/>  <br/>  Importance &lt;- reactive({<br/>    varImp(Linear_Model(), scale = FALSE)<br/>  })<br/>  <br/>  tmpImp &lt;- reactive({<br/>    <br/>    imp &lt;- as.data.frame(varImp(Linear_Model()))<br/>    imp &lt;- data.frame(overall = imp$Overall,<br/>                      names   = rownames(imp))<br/>    imp[order(imp$overall, decreasing = T),]<br/>    <br/>  })<br/>  <br/>  output$ImpVar &lt;- renderPrint(tmpImp())<br/>  <br/>  price_predict &lt;- reactive({<br/>    predict(Linear_Model(), testData())<br/>  })<br/>  <br/>  tmp &lt;- reactive({<br/>    tmp1 &lt;- testData()<br/>    tmp1[, c(input$SelectY)]<br/>  })<br/>  <br/>  <br/>  actuals_preds &lt;-<br/>    reactive({<br/>      data.frame(cbind(actuals = tmp(), predicted = price_predict()))<br/>    })<br/>  <br/>  Fit &lt;-<br/>    reactive({<br/>      (<br/>        plot(<br/>          actuals_preds()$actuals,<br/>          actuals_preds()$predicted,<br/>          pch = 16,<br/>          cex = 1.3,<br/>          col = "blue",<br/>          main = "Best Fit Line",<br/>          xlab = "Actual",<br/>          ylab = "Predicted"<br/>        )<br/>      )<br/>    })<br/>  <br/>  output$Prediction &lt;- renderPlot(Fit())<br/>  <br/>  output$residualPlots &lt;- renderPlot({<br/>    par(mfrow = c(2, 2)) # Change the panel layout to 2 x 2<br/>    plot(Linear_Model())<br/>    par(mfrow = c(1, 1)) # Change back to 1 x 1<br/>    <br/>  })<br/>  <br/>  output$digest &lt;- renderExplorer({<br/>    <br/>    explorer(data = dd$data, demo = F)<br/>    <br/>  })  <br/>  <br/>})</span></pre><p id="8376" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">结论</strong></p><p id="581e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本演练将提供一个shell来构建您自己的模型，该模型可以加载到Shiny服务器上。这个简单的构建可以帮助监控模型并对其进行诊断。Shiny提供了这些简单的功能，可以在开源环境中轻松构建web应用。</p><p id="3c3b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="mf">请注意，我仍然是一个新的媒体作者。我感谢你能提供的任何建议和支持。反馈越多，我就越能改进要讨论的主题和各种方法，以确保我的文章真正提供有意义的见解。</em></p><div class="mg mh ez fb mi mj"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hi fi z dy mo ea eb mp ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">medium.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx in mj"/></div></div></a></div></div></div>    
</body>
</html>