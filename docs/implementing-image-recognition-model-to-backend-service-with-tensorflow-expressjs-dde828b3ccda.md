# ä½¿ç”¨ TensorFlow + ExpressJS æ„å»ºç®€å•çš„å›¾åƒè¯†åˆ«åç«¯æœåŠ¡

> åŸæ–‡ï¼š<https://medium.com/mlearning-ai/implementing-image-recognition-model-to-backend-service-with-tensorflow-expressjs-dde828b3ccda?source=collection_archive---------3----------------------->

å°† Python ä¸­å†…ç½®çš„ TensorFlow æ¨¡å‹åº”ç”¨åˆ° Node çš„åˆ†æ­¥æŒ‡å—ã€‚Js(å¿«é€’)åç«¯ã€‚

![](img/c2e6d1ee9955f20da9efaf16f9045a6e.png)

Photo by [Boitumelo Phetla](https://unsplash.com/@writecodenow?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# ä»‹ç»

åœ¨å½“å‰æ—¶ä»£ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è®¸å¤šå¹³å°ã€ç½‘ç«™å’Œåº”ç”¨ç¨‹åºå®ç°æœºå™¨å­¦ä¹ æ¥å¢å¼ºä»–ä»¬çš„ä¸šåŠ¡æµç¨‹å’Œä½“éªŒã€‚TensorFlow æ˜¯ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„å¼€æºæ¡†æ¶ï¼Œå¹¿æ³›ç”¨äºå¼€å‘æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚å®ƒè¿˜å¯ä»¥é›†æˆåˆ°å¤šç§è¯­è¨€çš„å¹³å°ä¸Šï¼Œå¦‚ Pythonã€JavaScriptã€Javaã€C++ç­‰ã€‚

å¦ä¸€æ–¹é¢ï¼Œè¡¨è¾¾ã€‚Js æ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„æ¡†æ¶ï¼Œå¹¿æ³›ç”¨äºæ„å»ºåç«¯æœåŠ¡ã€‚å³ä½¿ Tensorflow å¯ä»¥ç”¨ Tensorflow åœ¨ JavaScript ä¸Šæ„å»ºã€‚Jsï¼ŒPython ä¼¼ä¹æœ‰æ›´å¤šçš„å®ç”¨ç¨‹åºå’Œæ–¹ä¾¿çš„å·¥å…·å’Œç‰¹æ€§æ¥æ„å»ºä¸€ä¸ª ML æ¨¡å‹ï¼Œæ¯”å¦‚ NumPyï¼ŒPandasï¼Œä»¥åŠå…¶ä»–ä¸€äº›å¯ä»¥å¸®åŠ© ML å¼€å‘è€…åœ¨æ„å»ºæ¨¡å‹æ—¶è¿›è¡Œç ”ç©¶å’Œå®éªŒçš„ä¸œè¥¿ã€‚é‚£ä¹ˆï¼Œ**æœ‰æ²¡æœ‰å¯èƒ½ç”¨ Tensorflow(åœ¨ Python ä¸­)æ„å»ºçš„ ML æ¨¡å‹å®ç°åˆ° express** ä¸­çš„åç«¯æœåŠ¡ï¼Ÿç­”æ¡ˆç»å¯¹æ˜¯è‚¯å®šçš„ã€‚

TensorFlow æä¾›äº†å„ç§å„æ ·çš„æ ¼å¼æ¥æ˜¾ç¤ºæ‚¨å¸Œæœ›å¦‚ä½•ä¿å­˜ ML æ¨¡å‹ï¼ŒTensorFlow.js å¯ä»¥åˆ©ç”¨åŸºæœ¬çš„ SavedModel æ ¼å¼ï¼Œè¿™ç§æ ¼å¼å¯ä»¥é€šè¿‡æ‰§è¡Œ`model.save('folder_name_of_saved_model')`ç”ŸæˆåŒ…å«å‡ ä¸ª`.pb`æ–‡ä»¶çš„æ–‡ä»¶å¤¹æ¥è½»æ¾è·å¾—ï¼›æˆ–è€…æ‚¨å¯ä»¥åœ¨å°†æ¨¡å‹ä¿å­˜ä¸º TensorFlow.js æ ¼å¼åå°†å…¶è½¬æ¢ä¸ºåŒ…å« JSON æ–‡ä»¶å’Œå‡ ä¸ª`.bin`æ–‡ä»¶çš„æ–‡ä»¶å¤¹ã€‚

ç„¶è€Œï¼Œå…³äº TensorFlow åšå®¢çš„è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸ä½¿ç”¨è½¬æ¢çš„ TensorFlow.js æ¨¡å‹ç›¸æ¯”ï¼Œç›´æ¥åº”ç”¨ SavedModel çš„æœåŠ¡åœ¨é¢„æµ‹æ–¹é¢è·å¾—äº†æ›´å¥½(æ›´å¿«)çš„æ¨ç†æ—¶é—´ï¼Œè€Œä¸ç®¡ä½¿ç”¨çš„æ˜¯å“ªä¸ªç‰ˆæœ¬çš„`tfjs-node`(CPU å’Œ GPU)ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†æ€§èƒ½å¯¹æ¯”ã€‚

![](img/c0c098e0b5e4c5ecbb39e5866649f3fd.png)

Performance Benchmark of the saved model formats (from TensorFlow Blog).

å› æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­ä½¿ç”¨ SavedModelã€‚

# å‡†å¤‡ææ–™

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘åœ¨[è¿™ä¸ªé“¾æ¥](https://github.com/ddhira123/tensorflow_with_expressjs/tree/main/SavedModel)å‡†å¤‡äº†çŸ³å¤´å‰ªåˆ€å¸ƒæ‰‹åŠ¿åˆ†ç±»å™¨çš„ SavedModelã€‚è¯¥æ¨¡å‹å°†ä¸ºæ¯ä¸ªç±»åˆ«ç”Ÿæˆæ¦‚ç‡æ•°ç»„ï¼Œæ ¼å¼å¦‚ä¸‹:

```
[[paper_prob, rock_prob, scissors_prob]]
```

è¿™æ˜¯æ¥è‡ª Laurence Moroney çš„ RPS æ•°æ®é›†çš„å²©çŸ³æ ‡å¿—å›¾åƒï¼Œç”¨äº SavedModel çš„ç¤ºä¾‹æµ‹è¯•ã€‚

![](img/9b653931bd63f77b183ee3f3ddb84db1.png)

Sample Test Image (Source: [Laurence Moroneyâ€™s Dataset](https://laurencemoroney.com/datasets.html))

![](img/e939678cb5c616d7716c97697f4d7f16.png)

Prediction of Sample Image

åœ¨æ‰§è¡Œåç»­æ­¥éª¤ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„è®¾å¤‡ä¸­å·²ç»å®‰è£…äº† NodeJS å’Œ NPMï¼Œå¹¶å‡†å¤‡å¥½è·å–æ‰€éœ€çš„åŒ…ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨æ‚¨çš„ç»ˆç«¯æˆ– powershell æˆ–å‘½ä»¤æç¤ºç¬¦æˆ–å¦ä¸€ä¸ª shell ä¸­è¿è¡Œ`npm -v`å’Œ`node -v`æ¥æ£€æŸ¥å®ƒä»¬æ˜¯å¦å‡†å¤‡å¥½äº†(åœ¨è¿™ä¹‹åæˆ‘å°†ç®€å•åœ°ç§°ä¹‹ä¸ºâ€œshellâ€)ã€‚å¦‚æœä½ æ²¡æœ‰å®‰è£… Node åŠå…¶é™„åŠ åŠŸèƒ½(node-gyp)ï¼Œå¦‚æœä½ ä½¿ç”¨ Windowsï¼Œä½ å¯èƒ½éœ€è¦é€šè¿‡æ¥å—é™„åŠ å®‰è£…ä» GUI é‡æ–°å®‰è£… Node LTSï¼Œæˆ–è€…é˜…è¯»[this stack overflow thread](https://stackoverflow.com/questions/45801457/node-js-python-not-found-exception-due-to-node-sass-and-node-gyp)ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª express.js åº”ç”¨ã€‚åœ¨æ‚¨çš„ shell ä¸­è¿è¡Œè¿™ä¸€è¡Œæ¥åˆ›å»ºæˆ‘ä»¬çš„ Express åç«¯æœåŠ¡çš„æ¨¡æ¿ã€‚è¿™ä¸ªå‘½ä»¤å°†åˆ›å»ºä¸€ä¸ªåä¸º`imageRecogAPI`çš„ express.js åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨ Pug ä½œä¸º[æ¨¡æ¿å¼•æ“](https://expressjs.com/en/guide/using-template-engines.html)ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåŒ…å«æˆ‘ä»¬åç«¯æœåŠ¡æºä»£ç çš„åŒåæ–‡ä»¶å¤¹ã€‚

```
npx express-generator --view=pug imageRecogAPI
```

ç„¶åï¼Œåœ¨æ‚¨çš„ shell ä¸Šè¿è¡Œä¸‹é¢ä»£ç å—ä¸­çš„è¿™ä¸ªå‘½ä»¤ï¼Œä¸ºè¿™ä¸ªé¡¹ç›®å®‰è£…æ•´ä¸ªä¾èµ–é¡¹ã€‚æ ‡å¿—`--legacy-peer-deps`åªæ˜¯ä¸ºäº†é¢„é˜²åŒ…ä¹‹é—´çš„ä¾èµ–å†²çªï¼Œä»¥é˜²ä»»ä½•åŒ…æœ‰ä¸‹é¢åˆ—å‡ºçš„å…¶ä»–åŒ…ï¼Œä½†ç‰ˆæœ¬è¾ƒæ—§ã€‚å¦‚æœæ‚¨æƒ³æŸ¥çœ‹å®‰è£…è¿›åº¦(ä»¥é˜²å®‰è£…å¡ä½)ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨`--legacy-peer-deps`æ ‡å¿—åæ·»åŠ æ ‡å¿—`--verbose`ã€‚

```
npm install @tensorflow/tfjs-node cookie-parser cors multer debug get-image-data jimp morgan express pug --save --legacy-peer-deps
```

å¦‚æœä½ åœ¨å®‰è£…æ—¶é‡åˆ°é”™è¯¯ï¼Œä½ å¯ä»¥è¿è¡Œä¸‹é¢çš„è„šæœ¬ï¼Œæˆ–è€…å¦‚æœä½ åœ¨å®‰è£…æ—¶å¡ä½äº†ï¼Œç‚¹å‡»`Ctrl` + `C`ï¼Œç„¶åè¿è¡Œä¸‹é¢çš„è„šæœ¬ã€‚ä¹‹åï¼Œé‡æ–°è¿è¡Œä¸Šé¢çš„å‘½ä»¤`npm install`ã€‚å¦‚æœæ‚¨å®é™…ä¸Šæ˜¯åœ¨ä»£ç†åé¢å·¥ä½œï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥é€šè¿‡è¿™ç¯‡æ–‡ç« æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

```
npm cache clear --force
```

[](/@d_dhana/working-with-npm-behind-network-proxy-444ced82a3) [## åœ¨ç½‘ç»œä»£ç†èƒŒåä¸ NPM åˆä½œ

### ä»‹ç»

medium.com](/@d_dhana/working-with-npm-behind-network-proxy-444ced82a3) 

å®‰è£…åŒ…å®Œæˆåï¼Œå°† SavedModel æ–‡ä»¶å¤¹ç§»åŠ¨æˆ–å¤åˆ¶åˆ°è¿™ä¸ª express é¡¹ç›®çš„æ–‡ä»¶å¤¹ä¸­ã€‚å› æ­¤ï¼Œåœ¨å®Œæˆä¸Šè¿°æ‰€æœ‰å·¥ä½œåï¼Œæ‚¨çš„é¡¹ç›®ç»“æ„åº”è¯¥ç±»ä¼¼å¦‚ä¸‹:

```
imageRecogAPI/
â”œâ”€â”€ node_modules/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ www
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ javascripts/
â”‚   â””â”€â”€ stylesheets/
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ index.js
â”‚   â””â”€â”€ users.js
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ error.pug
â”‚   â”œâ”€â”€ index.pug
â”‚   â””â”€â”€ layout.pug
â”œâ”€â”€ SavedModel/
â”‚   â”œâ”€â”€ variables/
â”‚   â”œâ”€â”€ keras_metadata.pb
â”‚   â””â”€â”€ saved_model.pb
â”œâ”€â”€ app.js
â”œâ”€â”€ package.json
â””â”€â”€ package-lock.json
```

# æœåŠ¡çš„å‘å±•

## è®¾ç½® app.js å’Œè·¯çº¿

è®©æˆ‘ä»¬å¼€å§‹å‘å±•ã€‚æˆ‘ä»¬å·²ç»åœ¨é¡¹ç›®ç»“æ„ä¸­çœ‹åˆ°çš„æœ€é‡è¦çš„ä¸œè¥¿æ˜¯`app.js`ã€‚ä¸åšä»»ä½•ä¿®æ”¹ï¼Œæ‚¨åº”è¯¥å·²ç»å¾—åˆ°äº†è¿™ä¸ªæ¨¡æ¿:

å¦‚æœæ‚¨å¸Œæœ›æ›´æ”¹åº”ç”¨ç¨‹åºçš„ç«¯å£ï¼Œæ‚¨å¯ä»¥åœ¨æ‚¨çš„`app.js`ä¸­çš„`module.export`ä¸Šæ–¹æ·»åŠ è¿™äº›è¡Œã€‚æ ¹æ®ä¸‹é¢çš„ä»£ç ï¼Œé»˜è®¤ç«¯å£å°†æ˜¯`9000`ã€‚æ‚¨å¯ä»¥ç®€å•åœ°æ›´æ”¹é‚£é‡Œçš„å€¼æˆ–æ·»åŠ ä¸€ä¸ª`.env`æ–‡ä»¶ï¼Œç„¶åç¼–å†™`PORT=9000`(å¦‚æœæ‚¨æƒ³è®©æœåŠ¡åœ¨ç«¯å£ 9000 ä¸Šè¿è¡Œ)ã€‚

```
const PORT = process.env.PORT || 9000;
app.listen(PORT);
console.log(`Running server at http://localhost:${PORT}`);
```

ç„¶åä½¿ç”¨å‘½ä»¤`npm run start`è¿è¡Œåº”ç”¨ç¨‹åºï¼Œç„¶åæ‰“å¼€æµè§ˆå™¨ï¼Œç„¶åè½¬åˆ°`[http://localhost:9000](http://localhost:9000)`ï¼Œæ‚¨å°†çœ‹åˆ°é»˜è®¤çš„å¿«é€Ÿæ¬¢è¿é¡µé¢ã€‚

ä¹‹åï¼Œæˆ‘ä»¬æ£€æŸ¥ app.js ä¸­çš„è·¯ç”±ï¼Œå·²ç»æœ‰ 2 ä¸ªè·¯ç”±å™¨(`/`å’Œ`/users`)ã€‚æ‚¨ä¹Ÿå¯ä»¥å°è¯•è®¿é—®`[http://localhost:9000/users](http://localhost:9000/users)`ã€‚å¦‚æœä½ è¯»äº†ä¸Šé¢çš„å†…å®¹ï¼Œä½ å°±ä¼šæ˜ç™½è·¯çº¿æ˜¯å¦‚ä½•å®šä¹‰å’Œä½¿ç”¨çš„ã€‚ç„¶åï¼Œå°†ä¸‹é¢çš„ç²—ä½“ä»£ç è¡Œæ·»åŠ åˆ°æ‚¨çš„`app.js`ä¸­ã€‚

```
var indexRouter = require('./routes/index');
var usersRouter = require('./routes/users'); 
**var predictionRouter = require('./routes/predict');**...app.use('/', indexRouter);
app.use('/users', usersRouter);
**app.use('/predict', predictionRouter);**
```

å› æ­¤ï¼Œæˆ‘ä»¬å°†é€šè¿‡åœ¨ç›®å½•`routes/`ä¸­åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶`predict.js`æ¥åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„è·¯ç”±ï¼Œå¹¶å°†ä¸‹é¢çš„ä»£ç å¤åˆ¶åˆ°å…¶ä¸­ã€‚

ä¸‹é¢æ˜¯å¯¹ä¸Šé¢ä»£ç çš„è§£é‡Š:

1.  é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥æ‰€éœ€çš„åŒ…ï¼Œå³`express`å’Œ`multer`ã€‚è‡³äº`controller`ï¼Œæˆ‘ä»¬å°†ç¨ååˆ›å»ºä¸€ä¸ªï¼Œå› ä¸ºå®ƒæ˜¯ç”¨äºåˆ©ç”¨ ML æ¨¡å‹è¿›è¡Œå›¾åƒè¯†åˆ«çš„ä¸»è¦è¿‡ç¨‹ã€‚
2.  ç„¶åï¼Œæˆ‘ä»¬å£°æ˜æ‚¨å¸Œæœ›ä½¿ç”¨çš„æ–‡ä»¶åã€‚è¯¥æ–‡ä»¶åå¿…é¡»ä¸æ‚¨å°†åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨çš„æ–‡ä»¶åç›¸åŒã€‚
3.  ä¹‹åï¼Œæˆ‘ä»¬è®¾ç½®äº†å¤šç£ç›˜å­˜å‚¨å’Œæ–‡ä»¶æ£€æŸ¥å™¨/è¿‡æ»¤å™¨æ¥å¤„ç†ä¸Šä¼ çš„å›¾åƒã€‚è®°ä½ï¼Œåœ¨ç›®çš„åœ°ï¼Œæˆ‘ä»¬å°†ä¸Šä¼ çš„å›¾åƒè®¾ç½®ä¸ºä»é¡¹ç›®æ ¹ç›®å½•ä¿å­˜åˆ°æ–‡ä»¶å¤¹`images/`ä¸­ã€‚
4.  æœ€åï¼Œæˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªå…·æœ‰å‰ç¼€`/predict`çš„å†…éƒ¨è·¯ç”±å™¨`/`ã€‚å°† multer æ”¾åœ¨é‚£é‡Œï¼Œæ£€æŸ¥æ–‡ä»¶ç±»å‹ä»¥åŠæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œå› ä¸ºå®ƒåº”è¯¥æ˜¯`multipart/form-data`è¯·æ±‚ä¸­çš„å¿…å¡«å­—æ®µã€‚ç„¶åï¼Œå¦‚æœè¯·æ±‚ç¬¦åˆè¦æ±‚ï¼Œå°±å°†å®ƒä»¬å…¨éƒ¨ä¼ é€’ç»™æ§åˆ¶å™¨ã€‚

## æ„å»ºæ§åˆ¶å™¨

å¤„ç†å®Œè·¯ç”±ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºæ§åˆ¶å™¨æ¥å¤„ç†å›¾åƒè¯†åˆ«è¿‡ç¨‹ã€‚é¦–å…ˆï¼Œä»é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºåä¸º`controllers`çš„æ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»ºåä¸º`PredictController.js`çš„æ–‡ä»¶ã€‚ä¹‹åï¼ŒæŠŠè¿™ä¸€æ•´å—å¤åˆ¶è¿›å»ã€‚

è¿™äº›æ˜¯ä¸Šé¢ä»£ç çš„è§£é‡Š:

1.  é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥æ‰€æœ‰çš„åŒ…(ä¸€å¦‚æ—¢å¾€)ã€‚
2.  æˆ‘ä»¬åªæ˜¯æŠŠæ•´ä¸ªè¿‡ç¨‹ï¼Œä¸€æ¬¡å…¨éƒ¨å¯¼å‡ºã€‚
3.  åœ¨å¯¼å‡ºçš„å‡½æ•°ä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦çš„å‡½æ•°:`loadModel()`å’Œ`image()`ï¼Œä¸‹é¢å°†è¿›è¡Œè¯´æ˜ã€‚

å‡½æ•°`loadModel()`æ‰§è¡Œè¿™äº›æ­¥éª¤:

1.  ç”¨`await tf.node.loadSavedModel()`åŠ è½½ä¿å­˜çš„æ¨¡å‹
2.  ç”¨`await model.predict().data()`è¿›è¡Œé¢„æµ‹å¹¶å¾—åˆ°ç»“æœ
3.  å°†é¢„æµ‹ç»“æœè½¬æ¢ä¸ºæ•°ç»„ï¼Œç„¶åä½œä¸ºå“åº”å‘é€ã€‚

å‡½æ•°`image()`æ‰§è¡Œè¿™äº›æ­¥éª¤:

1.  è¯»å–ä¸Šä¼ çš„å¾…é¢„æµ‹å›¾åƒã€‚
2.  å°†å›¾åƒè½¬æ¢ä¸ºå¼ é‡ï¼Œä»¥ä¾¿å¯ä»¥é€šè¿‡æ¨¡å‹è¿›è¡Œé¢„æµ‹ã€‚
3.  ç”±äºæ¨¡å‹æ˜¯ä¸ºäº†è¯»å–å½¢çŠ¶ä¸º`(None, 150, 150, 3)`çš„å›¾åƒè€Œæ„å»ºçš„ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡`resizeNearestNeighbor()`å°†å›¾åƒå¤§å°è°ƒæ•´ä¸º 150 x 150ï¼Œå¹¶é€šè¿‡`expandDims()`æ·»åŠ ä¸€ä¸ªç»´åº¦ï¼Œå°†è¿™ä¸ªå¼ é‡è°ƒæ•´ä¸ºè¯¥å½¢çŠ¶ã€‚å› ä¸ºå›¾åƒå·²ç»æ˜¯ RGB æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æ‹…å¿ƒå½¢çŠ¶ä¸­çš„`3`ã€‚
4.  ä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡å°†å›¾åƒå¼ é‡åˆ’åˆ†ä¸º 255 æ¥å½’ä¸€åŒ–å®ƒä»¬ã€‚
5.  ç„¶åæˆ‘ä»¬è°ƒç”¨`loadModel()`å¹¶åœ¨é¢„æµ‹å®Œæˆååˆ é™¤å›¾åƒæ–‡ä»¶ã€‚

ç„¶åï¼Œè½¬åˆ°æ‚¨çš„ shellï¼Œè¿è¡Œ`npm run start`ã€‚å°è¯•ä½ çš„é‚®å·®æ–°é²œæœåŠ¡ã€‚åœ¨é”®åˆ—ä¸­é€‰æ‹©ä¸‹æ‹‰èœå•`File`ã€‚å¦‚æœä½ ä»ä¸€å¼€å§‹å°±æ­£ç¡®åœ°åšäº†æ‰€æœ‰çš„æ­¥éª¤ï¼Œä½ åº”è¯¥èƒ½å¾—åˆ°è¿™ä¸ªã€‚

![](img/cc0ed5e6ef10a454c27cf5b24d4652fb.png)

The Finished API.

ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ç”¨è‡ªå·±çš„é£æ ¼æ¥å¢å¼ºé¢„æµ‹çš„å›æŠ¥ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åªæƒ³å¾—åˆ°æ¦‚ç‡æœ€é«˜çš„ç±»åå’Œæ¦‚ç‡ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æŠ€å·§ã€‚ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬çŸ¥é“é¢„æµ‹æ•°ç»„çš„å€¼å°†æŒ‰ç…§`[paper, rock, scissors]`çš„æ–¹å¼æ’åˆ—ã€‚é€šè¿‡å¯¹æ•°ç»„ä½¿ç”¨ Javascript æœ¬åœ°æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è·å¾—å®ƒã€‚

å›å¤´çœ‹ä¸€ä¸‹`PredictionController`ï¼Œæˆ‘ä»¬æœ‰è¿™æ ·ä¸€è¡Œ:

```
predictions = Array.from(predictions);
```

æˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¹æˆ

```
predictions = Array.from(predictions)
                   // Construct
                .map((prob, idx) => {
                  var classes = ['paper', 'rock', 'scissors'];
                  return {class: classes[idx], probability: prob};
                })
                   // Sort Descending, Get the highest one                
                .sort((a, b) => b.probability - a.probability)[0];
```

ç„¶åï¼Œæˆ‘ä»¬å®Œæˆè¿™ä¸ªã€‚

![](img/3517ac9a8c11ffa44bc56a114c091631.png)

Enhanced Response.

åœ¨æˆ‘å¿˜è®°ä¹‹å‰ï¼Œè¿™æ•´ä¸ªä»£ç ä¹Ÿå¯ä»¥åœ¨ github åº“ä¸­æ‰¾åˆ°ï¼Œå› ä¸ºæˆ‘æŠŠé“¾æ¥æ”¾åœ¨äº†æœ¬æ–‡çš„æœ€åã€‚

# ç»“è®º

æˆ‘ä»¬ç»ˆäºèµ¶ä¸Šäº†è¿™ç¯‡æ–‡ç« çš„ç»“å°¾ã€‚ç”±äº TensorFlow å¼€å‘äº†è®¸å¤šè·¨å„ç§å¹³å°å’Œè¯­è¨€çš„é›†æˆï¼Œå› æ­¤åœ¨ä»»ä½•åœ°æ–¹åº”ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹éƒ½å˜å¾—æ›´åŠ å®¹æ˜“ï¼ŒåŒ…æ‹¬ NodeJs å’Œ Expressã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©æ‚¨ç†è§£å¦‚ä½•ç”¨ Express æ„å»ºå›¾åƒè¯†åˆ« APIã€‚

[](https://github.com/ddhira123/tensorflow_with_expressjs) [## GitHub-DD hira 123/tensor flow _ with _ express js:è¿™æ˜¯å…³äº Medium ä¸­æ–‡ç« çš„æŠ¥å‘Š

### æ­¤æ—¶æ‚¨ä¸èƒ½æ‰§è¡Œè¯¥æ“ä½œã€‚æ‚¨å·²ä½¿ç”¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µæˆ–çª—å£ç™»å½•ã€‚æ‚¨å·²åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ³¨é”€ï¼Œæˆ–è€…â€¦

github.com](https://github.com/ddhira123/tensorflow_with_expressjs) 

# å…³äºä½œè€…

Dhana ç›®å‰åœ¨ä¸€å®¶å°åº¦å°¼è¥¿äºšé“¶è¡Œæ‹…ä»»è½¯ä»¶å·¥ç¨‹å¸ˆï¼Œè‡´åŠ›äºé€šè¿‡åˆ›å»ºæˆ–å¢å¼ºæœåŠ¡æ¥ä¼˜åŒ–ä¸šåŠ¡æµç¨‹ã€‚

é™¤äº†è½¯ä»¶å·¥ç¨‹ï¼ŒDhana å–œæ¬¢å­¦ä¹ å’Œåˆ†äº«æœºå™¨å­¦ä¹ ï¼Œå¹¶è‡ª 2021 å¹´ä»¥æ¥ä¸€ç›´è¢«è®¤è¯ä¸º TensorFlow å¼€å‘è€…ã€‚æœ€åï¼Œè¯·åœ¨[åª’ä½“](/@d_dhana)å’Œ [LinkedIn](https://www.linkedin.com/in/dhanadhira) ä¼¸å‡ºè¾¾é‚£ã€‚

[](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb) [## Mlearning.ai æäº¤å»ºè®®

### å¦‚ä½•æˆä¸º Mlearning.ai ä¸Šçš„ä½œå®¶

medium.com](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb) 

ğŸ”µ [**æˆä¸ºä½œå®¶**](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb)