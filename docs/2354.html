<html>
<head>
<title>Heart Disease Prediction with Python From Scratch — Multiclass and Binary Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python从头开始预测心脏病——多类和二元分类</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/heart-disease-prediction-with-python-from-scratch-multiclass-and-binary-classification-a01c55f1faaa?source=collection_archive---------0-----------------------#2022-04-19">https://medium.com/mlearning-ai/heart-disease-prediction-with-python-from-scratch-multiclass-and-binary-classification-a01c55f1faaa?source=collection_archive---------0-----------------------#2022-04-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="8511" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">介绍</h1><p id="343f" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">心脏病是西方国家的一个主要问题。根据美国政府统计，每36秒就有一人死于心脏病[1]。这是由许多问题和许多因素如胆固醇、血糖水平等造成的。影响我们的健康。我不会详细说明心脏病是如何引起的，但是，我的目标是根据主要的13个属性来预测心脏病。</p><p id="9d70" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">有许多机器学习算法来执行这一分析，但我将使用卷积神经网络来完成这一分析。然而，CNN最有可能用于图像和视频处理应用，但让我们来试试它的表现。</p><p id="11e6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">以下数据集取自UCI机器学习知识库。我将在克利夫兰数据集上做预测。下面提供了相同内容的链接:</p><p id="a766" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">https://archive.ics.uci.edu/ml/datasets/heart+disease<a class="ae kf" href="https://archive.ics.uci.edu/ml/datasets/heart+disease" rel="noopener ugc nofollow" target="_blank">UCI链接</a></p><h1 id="c3e1" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">分析数据集</h1><h2 id="707f" class="kg if hh bd ig kh ki kj ik kk kl km io jn kn ko is jr kp kq iw jv kr ks ja kt bi translated">输入属性:</h2><p id="43ec" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">1.<br/>(年龄)2。<br/>(性)3。<br/>(CP)4。<br/>(trest bps)5。<br/>(CHOL)6。(fbs) <br/> 7。(restecg) <br/> 8。<br/>(thal ach)9。【例】10。<br/> 11。<br/>(斜坡)12。<br/> 13。(thal)</p><h2 id="f283" class="kg if hh bd ig kh ki kj ik kk kl km io jn kn ko is jr kp kq iw jv kr ks ja kt bi translated">输出属性:</h2><p id="94fb" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><strong class="je hi">类</strong>:该属性包含5个变量0，1，2，3，4，其中0为无心脏病，4为非常关键阶段。</p><p id="281a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">所以从输出属性可以看出，这是一个多类分类问题。然而，我将展示如何将这转换成一个二元分类问题，我将比较两种分类的结果。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/84eeff9831bf3bcb2f69d6ed1143e54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XpkfiG-azUiZSwhNbMBhbg.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Data Analysis on all 14 attributes</figcaption></figure><h1 id="1c1a" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">多类与二元分类</h1><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lk"><img src="../Images/77eb8119c3164d39687ba55ea1c20875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*d9PBvyE6U4PwruUi.jpg"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Binary vs Multi-Class. Image Source: [2]</figcaption></figure><p id="a947" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">二进制分类</strong>顾名思义，我们只有两个类，机器理解为0和1。</p><p id="f6b6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">大多数人试图最小化二进制分类问题主要有两个原因。</p><ol class=""><li id="2505" class="ll lm hh je b jf ka jj kb jn ln jr lo jv lp jz lq lr ls lt bi translated">二进制分类问题更加灵活和简单，因为我们只需要从2个类中获取信息。</li><li id="0672" class="ll lm hh je b jf lu jj lv jn lw jr lx jv ly jz lq lr ls lt bi translated">不需要一次性编码，因此避免混淆的机会更少。</li></ol><p id="5971" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">另一方面，<strong class="je hi">多级分类</strong>有两个以上的级。在我们的数据集上，有5个类，所以这是一个明显的多类分类问题。由于以下原因，多级分类更加复杂。</p><ol class=""><li id="20ab" class="ll lm hh je b jf ka jj kb jn ln jr lo jv lp jz lq lr ls lt bi translated">因为它们应该是一次性编码的，并且用于模型预测，我们需要解码它来绘制我们的度量。</li><li id="7bb5" class="ll lm hh je b jf lu jj lv jn lw jr lx jv ly jz lq lr ls lt bi translated">此外，假设模型的训练过程中存在不规则性，由于有多个类，因此需要更多的时间投入来调试预处理部分。</li></ol><h1 id="4a22" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated"><strong class="ak">多级分类:</strong></h1><p id="d41e" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们有4节课，我希望在CovNet中进行培训。让我们从这个开始:</p><figure class="kv kw kx ky fd kz"><div class="bz dy l di"><div class="lz ma l"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Multi-Class Classification.py</figcaption></figure><p id="0266" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在上面的程序中，我取了1个有10个神经元的输入层，2个分别有8个和4个神经元的隐藏层，1个全连接的激活输出层。对于多类分类，我们总是利用softmax激活功能。对于每个预测，softmax激活函数总是将概率加到1。它从1到10不等。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es mb"><img src="../Images/2cd46212bb6dceb433ca515b1f89f3f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*P0kz4SeH_EnK415q.jpg"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Softmax Activation Function. Image Source: [3]</figcaption></figure><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es mb"><img src="../Images/3f9b7f85955a6eb7c0c61aa89582863f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*GPAOhmki0nkHDOKgKea23A.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Model Accuracy — Multi-Class Classification</figcaption></figure><p id="08a9" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">经过60个周期后，我得到了63 %的测试准确率。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es mb"><img src="../Images/e5c949fd99758552b62a28440d4b1d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Yb-AXbB8zBgelPw7c7QbrQ.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Model Loss — Multi-Class Classification</figcaption></figure><p id="4aed" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">我们可以看到测试损失接近1。</strong></p><h1 id="c865" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">二元分类:</h1><p id="5a63" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我将把我的程序转换成二进制分类，这样标签大于0的类列将有心脏病。</p><p id="f38a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">1 —会有心脏病。</p><p id="4b3d" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">0 —没有心脏病。</p><figure class="kv kw kx ky fd kz"><div class="bz dy l di"><div class="lz ma l"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Binary Classification.py</figcaption></figure><p id="cb65" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">正如你在上面的程序中看到的，我已经使用了sigmoid激活函数。乙状结肠从0到1不等。所以，我设置了一个阈值，如果它大于0.5，那么这个人将会有心脏病，否则这个人将不会有心脏病。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es mc"><img src="../Images/7fd7b6738c4799d13ad567479ae626fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gdJcA60W3gj3eVX_.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Sigmoid Activation Function. Image Source: [4]</figcaption></figure><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es mb"><img src="../Images/3bdbe3b3e5dc749d8ea9b5cf6dcadb07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*yhIS3Ygl5O8HrPbeLsooXw.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Model Accuracy — Binary Classification</figcaption></figure><p id="a4bb" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">在这里，我得到了大约78 %的测试准确率。</strong></p><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es mb"><img src="../Images/60bd12011aeb51f87b9f470ebbeec3e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Kg5pGCOgg6dTYeiPy6nvMg.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx">Model loss — Binary Classification</figcaption></figure><p id="5cda" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">在这里，我得到了大约57%的测试损失。</strong></p><h1 id="1a5c" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结果</h1><p id="c36a" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们可以清楚地看到，二元分类优于多类分类的原因是，如果有两个以上的类，神经网络将难以识别这些类。并非每个问题都是如此。同样，这取决于许多因素，如不同的数据集、其预处理部分及其特征。</p><ol class=""><li id="3c98" class="ll lm hh je b jf ka jj kb jn ln jr lo jv lp jz lq lr ls lt bi translated">测试<strong class="je hi">多级分类</strong>的分类准确率为:63 %</li><li id="8e2c" class="ll lm hh je b jf lu jj lv jn lw jr lx jv ly jz lq lr ls lt bi translated">测试<strong class="je hi">二元分类</strong>的分类准确率为:78 %</li></ol><p id="1658" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在Github上关注我:<a class="ae kf" href="https://github.com/durveshshah" rel="noopener ugc nofollow" target="_blank">https://github.com/durveshshah</a></p><p id="de0a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如果你喜欢我的文章，请点击下面的链接给我买杯咖啡，这样我就可以写更多的科技文章，支持科技社区。</p><p id="ef5b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><a class="ae kf" href="https://www.buymeacoffee.com/durveshshaK" rel="noopener ugc nofollow" target="_blank"><strong class="je hi"><em class="md">https://www.buymeacoffee.com/durveshshaK</em></strong></a></p><h1 id="e5ae" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">参考</h1><p id="a0d9" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">[1]《心脏病事实| CDC . gov》.<em class="md">美国疾病控制与预防中心</em>，2022年2月7日，<a class="ae kf" href="http://www.cdc.gov/heartdisease/facts.htm." rel="noopener ugc nofollow" target="_blank">www.cdc.gov/heartdisease/facts.htm.</a></p><p id="3c75" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">[2] Vijayakumari和E. Emerson Nithiyaraj。"基于FPGA的支持向量机实时分类."</p><p id="6a34" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">[3] Es-Sabery，Fatima等，“使用并行模糊深度学习分类器的句子级分类。”<em class="md"> IEEE访问</em>9(2021):17943–17985。</p><p id="c5f1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">[4]维基百科贡献者。“乙状结肠功能。”<em class="md">维基百科</em>，2022年4月4日，en.wikipedia.org/wiki/Sigmoid_function.</p><div class="me mf ez fb mg mh"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mi ab dw"><div class="mj ab mk cl cj ml"><h2 class="bd hi fi z dy mm ea eb mn ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mo l"><h3 class="bd b fi z dy mm ea eb mn ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mp l"><p class="bd b fp z dy mm ea eb mn ed ef dx translated">medium.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv le mh"/></div></div></a></div></div></div>    
</body>
</html>