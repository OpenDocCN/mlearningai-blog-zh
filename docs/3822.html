<html>
<head>
<title>5 DateTime Functions I Use Every Day as a Data Scientist</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">作为数据科学家，我每天都在使用5个日期时间函数</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/5-datetime-functions-i-use-every-day-as-a-data-scientist-eb7c6d2dc1c8?source=collection_archive---------2-----------------------#2022-10-26">https://medium.com/mlearning-ai/5-datetime-functions-i-use-every-day-as-a-data-scientist-eb7c6d2dc1c8?source=collection_archive---------2-----------------------#2022-10-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="1bcf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在进行探索性数据分析时，发现临时数据是非常常见的，因此非常有必要了解如何使用DateTime函数来轻松操作数据并进行更好的分析。下面我将描述的函数是我在分析时态数据时经常使用的函数。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/d47373052d47a57e15c810d7006660e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-Vag3wLlBysVprlNJbPAQ.png"/></div></div></figure><p id="c1b0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了查看每个特性的实际用法，我将使用从Kaggle获得的销售数据</p><h1 id="a832" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">1.pd.to_datetime()</h1><p id="0565" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">当我们使用pandas加载数据时，该包通常不能识别date类型的列。在这种情况下，pandas将订单日期列识别为一个对象。使用函数pd.to_datetime()，我们可以更改该列的类型，以便能够将它作为日期进行操作，如下所示</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ks"><img src="../Images/909818b904ae9a498b415f4477d2ebbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*srhxioWzTnyzKi8MvrA5Ag.png"/></div></figure><pre class="jd je jf jg fd kt ku kv kw aw kx bi"><span id="1fea" class="ky jq hh ku b fi kz la l lb lc">df["ORDERDATE"] = pd.to_datetime(df["ORDERDATE"])</span></pre><h1 id="135a" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">2.日期至周期()</h1><p id="060d" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">将列转换为日期时间后，我们可以在pandas中使用有用的函数。to_period()函数只能用于DateTime类型的列，用于将日期更改为某个所需的时间段。例如，完整日期可以更改为年月格式，如下所示</p><pre class="jd je jf jg fd kt ku kv kw aw kx bi"><span id="84e4" class="ky jq hh ku b fi kz la l lb lc">df["ORDERDATE"].dt.to_period('M')</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ld"><img src="../Images/a0c8b1b4da4b1fb72a3ac6d0f9ff79f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*RPnyYB8MUkckS5MrwMohdw.png"/></div></figure><h1 id="de2b" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">3.np.timedelta64()</h1><p id="b922" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">日期列对于计算有趣的统计数据也很有用。常见的数据分析任务是计算自客户上次购买或上次购买产品以来已经过去了多少个月。计算差值非常简单，只需像这样减去两列</p><pre class="jd je jf jg fd kt ku kv kw aw kx bi"><span id="ae29" class="ky jq hh ku b fi kz la l lb lc">df["ORDERDATE"]-df["PREV_ORDERDATE"]</span></pre><p id="bfa5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是熊猫默认给你天差。要将差值改为月份，我们可以使用NumPy的timedelta64函数，如下所示</p><pre class="jd je jf jg fd kt ku kv kw aw kx bi"><span id="3994" class="ky jq hh ku b fi kz la l lb lc">(df["ORDERDATE"]-df["PREV_ORDERDATE"])/np.timedelta64(1,'M')</span></pre><h1 id="3078" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">4.pd.to_timedelta()</h1><p id="8597" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">有时，不仅需要找出日期差异，还需要在某个确定的日期上添加天数。为此，我们可以获取当前日期，并使用to_timedelta函数添加所需的日期</p><pre class="jd je jf jg fd kt ku kv kw aw kx bi"><span id="4e9d" class="ky jq hh ku b fi kz la l lb lc">df["ORDERDATE"]+pd.to_timedelta(4,unit="D")</span></pre><h1 id="9649" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">5.pd.date_range()</h1><p id="96fb" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">大多数时候，给定范围内的所有日期都不会在我们的数据表中。要创建一个包含给定范围内所有日期的列表，我们可以使用一个接收开始日期和结束日期的pandas函数来返回一个包含该范围内所有日期的Pandas系列</p><pre class="jd je jf jg fd kt ku kv kw aw kx bi"><span id="ca03" class="ky jq hh ku b fi kz la l lb lc">pd.date_range(start="13/4/2022",end="5/5/2022")</span></pre><p id="6cd7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果这篇文章有用的话，你可以关注我的个人资料，了解新的Python和数据科学文章。</p><p id="01ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">代码可以在<a class="ae jo" href="https://github.com/danielguerreros/5-datetime-functions" rel="noopener ugc nofollow" target="_blank">我的GitHub </a>上的jupyter笔记本中找到。</p><div class="le lf ez fb lg lh"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="li ab dw"><div class="lj ab lk cl cj ll"><h2 class="bd hi fi z dy lm ea eb ln ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lo l"><h3 class="bd b fi z dy lm ea eb ln ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lp l"><p class="bd b fp z dy lm ea eb ln ed ef dx translated">medium.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv jm lh"/></div></div></a></div></div></div>    
</body>
</html>