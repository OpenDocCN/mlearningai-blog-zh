# ä¸ªæ€§åŒ–å’Œæ¨èä¸ä¸Šä¸‹æ–‡å¼ºç›—ğŸ¤–

> åŸæ–‡ï¼š<https://medium.com/mlearning-ai/simulating-content-personalization-with-contextual-bandits-6f4efb902af?source=collection_archive---------0----------------------->

ç”¨ Vowpal Wabbit æ¨¡æ‹Ÿä¸€ä¸ªå†…å®¹ä¸ªæ€§åŒ–åœºæ™¯ï¼Œä½¿ç”¨ä¸Šä¸‹æ–‡åœŸåŒªåœ¨ç»™å®šçš„ä¸Šä¸‹æ–‡ä¸­é€‰æ‹©åŠ¨ä½œã€‚

![](img/19535a7299d6cc44040f4fb9b209a82b.png)

Photo by [Markus Spiske](https://unsplash.com/@markusspiske?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

# ä»‹ç»

å‘ç”¨æˆ·æ¨èç›¸å…³å’Œä¸ªæ€§åŒ–çš„å†…å®¹å¯¹äºåª’ä½“æœåŠ¡æä¾›å•†ã€ç”µå­å•†åŠ¡å¹³å°ã€åŸºäºå†…å®¹çš„å¹³å°ç­‰è‡³å…³é‡è¦ã€‚

äº‹å®ä¸Šï¼Œæœ‰æ•ˆçš„æ¨èç³»ç»Ÿé€šè¿‡å¸®åŠ©ç”¨æˆ·æµè§ˆå¤§é‡å†…å®¹ï¼Œæ”¹å–„äº†ç”¨æˆ·åœ¨å¹³å°ä¸Šçš„ä½“éªŒå’Œå‚ä¸åº¦ã€‚

éšç€å¯¹ä¸ªæ€§åŒ–ç³»ç»Ÿã€é«˜æ•ˆä¿¡æ¯æ£€ç´¢å’Œå¼‚å¸¸æ£€æµ‹ç­‰åŠŸèƒ½éœ€æ±‚çš„å¢é•¿ï¼Œå¯¹ä¼˜åŒ–è¿™äº›åŠŸèƒ½çš„è§£å†³æ–¹æ¡ˆçš„éœ€æ±‚ä¹Ÿåœ¨å¢é•¿ã€‚Contextual bandit æ˜¯ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¡†æ¶ï¼Œæ—¨åœ¨è§£å†³è¿™äº›ä»¥åŠå…¶ä»–å¤æ‚çš„æƒ…å†µã€‚

æœ¬æ•™ç¨‹åŒ…æ‹¬å¼ºåŒ–å­¦ä¹ çš„ç®€è¦æ¦‚è¿°ï¼Œè¿™ç§æœºå™¨å­¦ä¹ èŒƒå¼çš„ä¸Šä¸‹æ–‡å¼ºç›—æ–¹æ³•ï¼Œå¹¶æè¿°äº†å¦‚ä½•ç”¨ Vowpal Wabbit å¤„ç†ä¸Šä¸‹æ–‡å¼ºç›—é—®é¢˜ã€‚

[](https://github.com/99sbr/fastapi-template) [## GitHub - 99sbr/fastapi-template:å®Œå…¨å¯æ‰©å±•çš„åŸºäº fastapi çš„æœºå™¨å­¦ä¹ æ¨¡æ¿â€¦

### å®Œå…¨å¯æ‰©å±•çš„åŸºäº FastAPI çš„æ¨¡æ¿ï¼Œç”¨äºæœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ å’Œä»»ä½•å…¶ä»–è½¯ä»¶é¡¹ç›®

github.com](https://github.com/99sbr/fastapi-template) 

# ä»€ä¹ˆæ˜¯å¼ºåŒ–å­¦ä¹ ï¼Ÿ

[å¼ºåŒ–å­¦ä¹ ](https://docs.microsoft.com/en-us/azure/cognitive-services/personalizer/concepts-reinforcement-learning)æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ èŒƒå¼ï¼Œç”¨äºè®­ç»ƒæ¨¡å‹è¿›è¡Œé¡ºåºå†³ç­–ã€‚å®ƒåŒ…æ‹¬ä½¿ç”¨ä¸è½¯ä»¶ä»£ç†å¦‚ä½•åœ¨å¤æ‚ç¯å¢ƒä¸­é‡‡å–é€‚å½“è¡ŒåŠ¨æœ‰å…³çš„ç®—æ³•ï¼Œå¹¶ä½¿ç”¨åé¦ˆæ¥éšç€æ—¶é—´çš„æ¨ç§»æœ€å¤§åŒ–å›æŠ¥ã€‚è¿™ç§æ–¹æ³•æä¾›äº†åœ¨ç»™å®šçš„ä¸Šä¸‹æ–‡ä¸­åˆ¶å®šç‰¹å®šç”¨æˆ·è¡Œä¸ºçš„è‡ªç”±ï¼Œå¹¶æä¾›äº†å…³äºå¦‚ä½•æ ¹æ®ç›®æ ‡å¥–åŠ±æ‰€é€‰è¡Œä¸ºçš„åé¦ˆã€‚

# åœŸåŒªè§£é‡Šé“

![](img/5b5d0920a338bff2d675ee655cf4caa2.png)

å‡è®¾æ‚¨æ˜¯ä¸€å®¶åœ¨çº¿é›¶å”®å•†ï¼Œå¸Œæœ›åœ¨ä¸»é¡µä¸Šæ˜¾ç¤ºä¸ªæ€§åŒ–çš„äº§å“å»ºè®®ã€‚

ä½ åªèƒ½ç»™ä¸€ä¸ªç‰¹å®šçš„å®¢æˆ·å±•ç¤ºæœ‰é™æ•°é‡çš„äº§å“ï¼Œä½ ä¸çŸ¥é“å“ªäº›ä¼šæœ‰æœ€å¥½çš„å›æŠ¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœå®¢æˆ·ä¸è´­ä¹°äº§å“ï¼Œæˆ‘ä»¬å°†å¥–åŠ±è®¾ä¸º 0 ç¾å…ƒï¼Œå¦‚æœä»–ä»¬è´­ä¹°ï¼Œå°†å•†å“ä»·æ ¼è®¾ä¸º 0 ç¾å…ƒã€‚

ä¸ºäº†æœ€å¤§åŒ–ä½ çš„å›æŠ¥ï¼Œä½ å¯ä»¥åˆ©ç”¨å¤šè‡‚åœŸåŒª(MAB)ç®—æ³•ï¼Œå…¶ä¸­æ¯ä¸ªäº§å“éƒ½æ˜¯åœŸåŒªâ€”â€”å¯ä¾›ç®—æ³•å°è¯•çš„é€‰æ‹©ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ä¸‹é¢çœ‹åˆ°çš„ï¼Œå¤šè‡‚å¼ºç›—ä»£ç†å¿…é¡»åœ¨æ¯æ¬¡æ¸¸æˆä¸­é€‰æ‹©å‘ç”¨æˆ·å±•ç¤ºç‰©å“ 1 æˆ–ç‰©å“ 2ã€‚æ¯æ¬¡æ¸¸æˆéƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„â€”â€”æœ‰æ—¶ç”¨æˆ·ä¼šèŠ± 22 ç¾å…ƒè´­ä¹°ç‰©å“ 2ï¼Œæœ‰æ—¶ç”¨æˆ·ä¼šä¸¤æ¬¡è´­ä¹°ç‰©å“ 2ï¼Œè·å¾— 44 ç¾å…ƒçš„å¥–åŠ±ã€‚

[](/mlearning-ai/semantic-search-with-s-bert-is-all-you-need-951bc710e160) [## ä½¿ç”¨ S-BERT è¿›è¡Œè¯­ä¹‰æœç´¢æ˜¯æ‚¨æ‰€éœ€è¦çš„

### ä»å¤´å¼€å§‹æ„å»ºå†…éƒ¨è¯­ä¹‰æœç´¢å¼•æ“â€”å¿«é€Ÿè€Œå‡†ç¡®

medium.com](/mlearning-ai/semantic-search-with-s-bert-is-all-you-need-951bc710e160) 

# èƒŒæ™¯å¼ºç›—é—®é¢˜

ç°åœ¨ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå®¢æˆ·ï¼Œä»–æ˜¯ä¸€åä¸“ä¸šçš„å®¤å†…è®¾è®¡å¸ˆï¼Œä¹Ÿæ˜¯ä¸€åç‹‚çƒ­çš„é’ˆç»‡çˆ±å¥½è€…ã€‚ä»–ä»¬å¯èƒ½åœ¨å·¥ä½œæ—¶é—´è®¢è´­å£çº¸å’Œé•œå­ï¼Œå›å®¶åæµè§ˆä¸åŒçš„çº±çº¿ã€‚æ ¹æ®ä»–ä»¬è®¿é—®æˆ‘ä»¬ç½‘ç«™çš„æ—¶é—´ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå‘ä»–ä»¬å±•ç¤ºä¸åŒçš„äº§å“ã€‚

ä¸Šä¸‹æ–‡ bandit ç®—æ³•æ˜¯å¤šè‡‚ bandit æ–¹æ³•çš„æ‰©å±•ï¼Œåœ¨é€‰æ‹© bandit æ—¶ï¼Œæˆ‘ä»¬ä¼šè€ƒè™‘å®¢æˆ·çš„ç¯å¢ƒæˆ–ä¸Šä¸‹æ–‡ã€‚ç¯å¢ƒå½±å“å¥–åŠ±å¦‚ä½•ä¸æ¯ä¸ªå¼ºç›—ç›¸å…³è”ï¼Œå› æ­¤éšç€ç¯å¢ƒçš„å˜åŒ–ï¼Œæ¨¡å‹åº”è¯¥å­¦ä¼šé€‚åº”å®ƒçš„å¼ºç›—é€‰æ‹©ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/85afae248b4aa1d69e460a27f6b22327.png)

åœ¨æƒ…å¢ƒå¼ºç›—é—®é¢˜ä¸­ï¼Œå­¦ä¹ è€…åå¤è§‚å¯Ÿæƒ…å¢ƒï¼Œé€‰æ‹©è¡ŒåŠ¨ï¼Œå¹¶ä¸”åªè§‚å¯Ÿæ‰€é€‰è¡ŒåŠ¨çš„æŸå¤±/æˆæœ¬/å›æŠ¥ã€‚ä¸Šä¸‹æ–‡åœŸåŒªç®—æ³•ä½¿ç”¨é¢å¤–çš„è¾…åŠ©ä¿¡æ¯(æˆ–ä¸Šä¸‹æ–‡)æ¥å¸®åŠ©ç°å®ä¸–ç•Œçš„å†³ç­–ã€‚å®ƒä»¬éå¸¸é€‚åˆåœ¨åŠ¨æ€ç¯å¢ƒä¸­é€‰æ‹©æ“ä½œï¼Œåœ¨è¿™ç§ç¯å¢ƒä¸­ï¼Œé€‰é¡¹å˜åŒ–å¾ˆå¿«ï¼Œå¹¶ä¸”å¯ç”¨çš„æ“ä½œé›†æœ‰é™ã€‚

æœ‰äº† contextual banditï¼Œå­¦ä¹ ç®—æ³•å¯ä»¥æµ‹è¯•ä¸åŒçš„åŠ¨ä½œï¼Œå¹¶è‡ªåŠ¨å­¦ä¹ å“ªä¸€ä¸ªåœ¨ç»™å®šçš„æƒ…å†µä¸‹å…·æœ‰æœ€æœ‰ç›Šçš„ç»“æœã€‚è¿™æ˜¯ä¸€ç§å¼ºå¤§çš„ã€é€šç”¨çš„æ–¹æ³•ï¼Œå¯ä»¥è§£å†³ä»åŒ»ç–—ä¿å¥åˆ°é‡‘èç­‰è¡Œä¸šçš„å…³é”®ä¸šåŠ¡éœ€æ±‚ã€‚

# æ²ƒå¸•å°”Â·ç“¦æ¯”ç‰¹:ä¸èƒŒæ™¯å¼ºç›—ä¸€èµ·å·¥ä½œ

Vowpal Wabbit æ˜¯ä¸€ä¸ªäº¤äº’å¼æœºå™¨å­¦ä¹ åº“ï¼Œä¹Ÿæ˜¯åƒ[å¾®è½¯ä¸ªæ€§åŒ–å™¨](https://azure.microsoft.com/en-us/services/cognitive-services/personalizer/)è¿™æ ·çš„æœåŠ¡çš„å¼ºåŒ–å­¦ä¹ æ¡†æ¶ã€‚åœ¨è¿›è¡Œä¸ªæ€§åŒ–æ’åºå’Œç”¨æ‰€æœ‰äº‹ä»¶è®­ç»ƒæ¨¡å‹æ—¶ï¼Œå®ƒå…è®¸æœ€å¤§ååé‡å’Œæœ€ä½å»¶è¿Ÿã€‚

æœ¬æ•™ç¨‹ä½¿ç”¨ä¸€ä¸ªæˆ‘ä»¬ç§°ä¹‹ä¸º **Con-Ban Agent** çš„åº”ç”¨ç¤ºä¾‹æ¥ä»‹ç»ä¸€ç§è§£å†³ä¸Šä¸‹æ–‡å¼ºç›—é—®é¢˜çš„ Vowpal Wabbit æ–¹æ³•ï¼Œå¹¶æ¢ç´¢è¿™ç§å¼ºåŒ–å­¦ä¹ æ–¹æ³•çš„èƒ½åŠ›ã€‚**ç½‘é¡µå†…å®¹ä¸ªæ€§åŒ–**çš„é—®é¢˜åœºæ™¯æ¿€å‘äº†æˆ‘ä»¬çš„ä¾‹å­**ç¦æ­¢ä»£ç†**ã€‚ç›®æ ‡æ˜¯åœ¨æ¯ä¸ªé¡µé¢ä¸Šå‘ç”¨æˆ·å±•ç¤ºæœ€ç›¸å…³çš„ç½‘é¡µå†…å®¹ï¼Œä»¥æœ€å¤§åŒ–å‚ä¸åº¦(ç‚¹å‡»é‡)ã€‚

**ç¦æ­¢ä»£ç†**æ‰§è¡Œä»¥ä¸‹åŠŸèƒ½:

*   æŸä¸ªä¸Šä¸‹æ–‡ **x** åˆ°è¾¾å¹¶è¢«**ç¦æ­¢ä»£ç†**è§‚å¯Ÿåˆ°ã€‚
*   **ç¦æ­¢ä»£ç†**ä»ä¸€ç»„åŠ¨ä½œ **A** ä¸­é€‰æ‹©ä¸€ä¸ªåŠ¨ä½œ **a** ï¼Œå³**A**âˆˆ**A**(**A**å¯èƒ½ä¾èµ–äº **x** )ã€‚
*   è¢«é€‰ä¸­çš„ **a** çš„æŸäº›å¥–åŠ± **r** è¢«**æ§åˆ¶ä»£ç†**è§‚å¯Ÿåˆ°ã€‚

åœ¨ä¸Šä¸‹æ–‡ bandit è®¾ç½®ä¸­ï¼Œæ•°æ®ç‚¹æœ‰å››ä¸ªç»„æˆéƒ¨åˆ†:

*   è¯­å¢ƒ
*   è¡ŒåŠ¨
*   é€‰æ‹©è¡ŒåŠ¨çš„æ¦‚ç‡
*   æ‰€é€‰è¡ŒåŠ¨çš„å¥–åŠ±/æˆæœ¬

**ä¾‹å¦‚:**

**Con-Ban ä»£ç†**æ–°é—»ç½‘ç«™:

*   **ä¼˜åŒ–å†³ç­–**:æ˜¾ç¤ºç»™ç”¨æˆ·çš„æ–‡ç« ã€‚
*   **ä¸Šä¸‹æ–‡**:ç”¨æˆ·æ•°æ®(æµè§ˆå†å²ã€ä½ç½®ã€è®¾å¤‡ã€æ—¶é—´)
*   **åŠ¨ä½œ**:å¯ç”¨çš„æ–°é—»æ–‡ç« 
*   **å¥–åŠ±**:ç”¨æˆ·å‚ä¸åº¦(ç‚¹å‡»æˆ–ä¸ç‚¹å‡»)

æˆ‘ä»¬éœ€è¦åœ¨æ¨¡æ‹Ÿå™¨ä¸­ç”Ÿæˆä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œä»¥è·å¾—ç»™å®šä¸Šä¸‹æ–‡çš„æ“ä½œ/å†³ç­–ï¼Œå¹¶æ¨¡æ‹Ÿç”Ÿæˆå¥–åŠ±ã€‚æ¨¡æ‹Ÿå™¨çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–å›æŠ¥(CTR)â€”â€”æˆ–æœ€å°åŒ–æŸå¤±(CTR)ã€‚

å› æ­¤ï¼Œ**ä¸Šä¸‹æ–‡**æ˜¯(ç”¨æˆ·ï¼Œä¸€å¤©ä¸­çš„æ—¶é—´):

*   æˆ‘ä»¬æœ‰ä¸¤ä¸ªç½‘ç«™è®¿é—®è€…:â€œæ±¤å§†â€å’Œâ€œå®‰å¨œã€‚â€
*   æ±¤å§†å’Œå®‰å¨œåœ¨ä¸Šåˆæˆ–ä¸‹åˆè®¿é—®ç½‘ç«™ã€‚

æˆ‘ä»¬å¯ä»¥é€‰æ‹©å‘æ±¤å§†å’Œå®‰å¨œæ¨èå„ç§å„æ ·çš„å•†å“ã€‚å› æ­¤ï¼Œ**åŠ¨ä½œ**æ˜¯æ–‡ç« çš„ä¸åŒé€‰æ‹©:â€œæ”¿æ²»â€ã€â€œä½“è‚²â€ã€â€œéŸ³ä¹â€ã€â€œç¾é£Ÿâ€ã€â€œé‡‘èâ€ã€â€œå¥åº·â€ï¼Œæˆ–è€…â€œå¥¶é…ªâ€ã€‚

**å¥–åŠ±**æ˜¯ä»–ä»¬æ˜¯å¦ç‚¹å‡»æ–‡ç« :â€œç‚¹å‡»â€æˆ–â€œä¸ç‚¹å‡»â€

# Vowpal Wabbit ä¸­çš„ä¸Šä¸‹æ–‡å¼ºç›—åŠŸèƒ½

VW åŒ…å«ä¸€ä¸ªä¸Šä¸‹æ–‡ bandit æ¨¡å—ï¼Œå…è®¸æ‚¨æ ¹æ®å·²ç»æ”¶é›†çš„ä¸Šä¸‹æ–‡ bandit æ•°æ®ä¼˜åŒ–é¢„æµ‹å™¨ã€‚æ¢å¥è¯è¯´ï¼Œè¯¥æ¨¡å—ä¸å®ç°æµè§ˆï¼Œå®ƒå‡å®šå®ƒåªèƒ½ä½¿ç”¨é€šè¿‡æµè§ˆç­–ç•¥è®°å½•çš„å½“å‰å¯ç”¨æ•°æ®ã€‚(æ³¨æ„:æœ‰å…³å®Œæ•´çš„åœ¨çº¿ä¸Šä¸‹æ–‡ banditï¼Œè¯·å‚è§æ­¤å¤„çš„â€” cb_explore å’Œâ€” cb_explore_adf é€‰é¡¹[çš„ä½¿ç”¨ã€‚)](https://github.com/JohnLangford/vowpal_wabbit/wiki/Contextual-Bandit-algorithms)

æ•°æ®è¢«æŒ‡å®šä¸ºä¸€ç»„å…ƒç»„(xï¼Œaï¼Œcï¼Œp ),å…¶ä¸­ x æ˜¯å†³ç­–çš„å½“å‰ç‰¹å¾/ä¸Šä¸‹æ–‡ï¼Œa æ˜¯ä¸Šä¸‹æ–‡ x çš„æ¢ç´¢ç­–ç•¥é€‰æ‹©çš„åŠ¨ä½œï¼Œc æ˜¯ä¸Šä¸‹æ–‡ x ä¸­åŠ¨ä½œ a çš„è§‚å¯Ÿæˆæœ¬ï¼Œp æ˜¯æ¢ç´¢ç­–ç•¥åœ¨ä¸Šä¸‹æ–‡ x ä¸­é€‰æ‹©è¯¥åŠ¨ä½œçš„æ¦‚ç‡ã€‚

æ¯ä¸ªç¤ºä¾‹ç°åœ¨è·¨è¶Šå¤šè¡Œï¼Œæ¯ä¸ªåŠ¨ä½œä¸€è¡Œã€‚å¯¹äºæ¯ä¸ªåŠ¨ä½œï¼Œæˆ‘ä»¬éƒ½æœ‰æ ‡ç­¾ä¿¡æ¯`(a,c,p)`ï¼Œå¦‚æœå·²çŸ¥çš„è¯ï¼Œå’Œä»¥å‰ä¸€æ ·ã€‚åŠ¨ä½œå­—æ®µ`a`ç°åœ¨è¢«å¿½ç•¥ï¼Œå› ä¸ºåŠ¨ä½œç”±è¡Œå·æ ‡è¯†ï¼Œé€šå¸¸è®¾ç½®ä¸º 0ã€‚æˆæœ¬å’Œæ¦‚ç‡çš„è¯­ä¹‰å’Œä»¥å‰ä¸€æ ·ã€‚æ¯ä¸ªç¤ºä¾‹è¿˜å…è®¸ç²¾ç¡®åœ°æŒ‡å®šä¸€ä¸ªåŠ¨ä½œçš„æ ‡ç­¾ä¿¡æ¯ã€‚æ¢è¡Œç¬¦è¡¨ç¤ºå¤šè¡Œç¤ºä¾‹çš„ç»“æŸã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªä¾‹å­çš„å¼€å¤´æŒ‡å®šæ‰€æœ‰åŠ¨ä½œå…±äº«çš„ä¸Šä¸‹æ–‡ç‰¹æ€§ï¼Œè¿™ä¸ªä¾‹å­æ€»æ˜¯æœ‰ä¸€ä¸ªæ ‡ç­¾`shared`ï¼Œå°±åƒä¸Šé¢ç¬¬äºŒä¸ªå¤šè¡Œä¾‹å­ä¸€æ ·ã€‚å› ä¸ºå…±äº«è¡Œä¸ä¸ä»»ä½•åŠ¨ä½œç›¸å…³è”ï¼Œæ‰€ä»¥å®ƒä¸åº”è¯¥åŒ…å«æ ‡ç­¾ä¿¡æ¯ã€‚

**ç®€å•çš„ä¾‹å­**

ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œè¯´æ˜äº†è¾“å…¥æ ¼å¼ä»¥åŠå¦‚ä½•å¯¹è¿™äº›æ•°æ®ä½¿ç”¨ vwã€‚

æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæœ‰ 4 ä¸ªåŠ¨ä½œçš„é—®é¢˜ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ° VW æ ¼å¼çš„ä»¥ä¸‹ 5 ä¸ªæ•°æ®ç‚¹:

```
1:2:0.4 | a c  
3:0.5:0.2 | b d  
4:1.2:0.5 | a b c  
2:1:0.3 | b c  
3:1.5:0.7 | a d
```

è¿™é‡Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„ç¤ºä¾‹ï¼Œæ¯ä¸€è¡Œéƒ½é‡‡ç”¨ä»¥ä¸‹å½¢å¼:

```
action:cost:probability | features
```

åœ¨å“ªé‡Œ

*   action æ˜¯æˆ‘ä»¬è§‚å¯Ÿæˆæœ¬æ—¶æ‰€é‡‡å–çš„æ“ä½œçš„ id ({ 1ï¼Œk}ä¸­çš„æ­£æ•´æ•°)
*   æˆæœ¬æ˜¯æ­¤æ“ä½œçš„è§‚å¯Ÿæˆæœ¬(æµ®ç‚¹ï¼Œè¶Šä½è¶Šå¥½)
*   æ¦‚ç‡æ˜¯æ¦‚ç‡(æµ®ç‚¹ï¼Œä»¥[0..1])ï¼Œä»¥åœ¨æ”¶é›†æ•°æ®æ—¶é€‰æ‹©æ­¤æ“ä½œ
*   ç‰¹æ€§æ˜¯è¿™ä¸ªä¾‹å­ä¸­æ‰€æœ‰ç‰¹æ€§çš„åˆ—è¡¨ï¼Œé€šå¸¸æŒ‡å®šç”¨äº vw çš„åˆ†ç±»/å›å½’é—®é¢˜

å› æ­¤ï¼Œä¸Šé¢çš„ç¬¬ä¸€è¡Œè¡¨æ˜ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªå…·æœ‰ç‰¹å¾ a å’Œ c çš„ç¤ºä¾‹ä¸­è§‚å¯Ÿåˆ°åŠ¨ä½œ 1 çš„æˆæœ¬ä¸º 2ï¼Œå¹¶ä¸”åœ¨æ”¶é›†æ•°æ®æ—¶ï¼Œè¯¥åŠ¨ä½œè¢«ç¯å¢ƒä¸­çš„æ¢ç´¢ç­–ç•¥ä»¥æ¦‚ç‡ 0.4 é€‰æ‹©ã€‚

# æ¨¡æ‹Ÿå¥–åŠ±æ²ƒå¸•å°”ç“¦æ¯”ç‰¹

åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œæˆ‘ä»¬åœ¨è§‚å¯Ÿæ±¤å§†å’Œå®‰å¨œçš„äº’åŠ¨æ—¶ï¼Œå¿…é¡»äº†è§£ä»–ä»¬å¯¹æ–‡ç« çš„åå¥½ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿï¼Œæˆ‘ä»¬å¿…é¡»å®šä¹‰ Tom å’Œ Anna çš„åå¥½é…ç½®æ–‡ä»¶ã€‚

æˆ‘ä»¬æä¾›ç»™å­¦ä¹ è€…çš„å¥–åŠ±éµå¾ªè¿™ä¸ªåå¥½ç®€æ¡£ã€‚æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°ï¼Œéšç€æˆ‘ä»¬çœ‹åˆ°æ›´å¤šæ ·æœ¬ï¼Œå­¦ä¹ è€…æ˜¯å¦èƒ½åšå‡ºè¶Šæ¥è¶Šå¥½çš„å†³å®šï¼Œè¿™åè¿‡æ¥æ„å‘³ç€æˆ‘ä»¬æ­£åœ¨æœ€å¤§åŒ–å›æŠ¥ã€‚

ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ä»¥å‡ ç§ä¸åŒçš„æ–¹å¼ä¿®æ”¹å¥–åŠ±å‡½æ•°ï¼Œå¹¶çœ‹çœ‹ä¸Šä¸‹æ–‡ä¸­çš„ bandit å­¦ä¹ è€…æ˜¯å¦ä¼šå‘ç°è¿™äº›å˜åŒ–ã€‚ç„¶åï¼Œæˆ‘ä»¬æ¯”è¾ƒæœ‰å­¦ä¹ å’Œæ²¡æœ‰å­¦ä¹ çš„ CTRã€‚

Vowpal Wabbit ä¼˜åŒ–ä»¥æœ€å°åŒ–æˆæœ¬ï¼Œè¿™æ˜¯å›æŠ¥çš„è´Ÿæ•°ã€‚

å› æ­¤ï¼Œ**æˆ‘ä»¬æ€»æ˜¯å°†æŠ¥é…¬çš„è´Ÿæ•°ä½œä¸ºæˆæœ¬ä¼ é€’ç»™ Vowpal Wabbitã€‚**

```
*# VW tries to minimize loss/cost, therefore we will pass cost as -reward* USER_LIKED_ARTICLE **=** **-**1.0
USER_DISLIKED_ARTICLE **=** 0.0
```

ä¸‹é¢çš„å¥–åŠ±å‡½æ•°æŒ‡å®šäº† ***æ±¤å§†æ—©ä¸Šå–œæ¬¢æ”¿æ²»ï¼Œä¸‹åˆå–œæ¬¢éŸ³ä¹ã€‚å®‰å¨œæ—©ä¸Šå–œæ¬¢è¿åŠ¨ï¼Œä¸‹åˆå–œæ¬¢æ”¿æ²»ã€‚è¿™çœ‹èµ·æ¥å¾ˆéš¾ç†è§£ï¼Œä½†æˆ‘ä»¬æ˜¯åœ¨ä»¥å­¦ä¹ è€…ç†è§£çš„åé¦ˆå½¢å¼â€”â€”æˆæœ¬â€”â€”æ¨¡æ‹Ÿä¸€ä¸ªå‡æƒ³çš„ä¸–ç•Œã€‚***

å¦‚æœå­¦ä¹ è€…æ¨èäº†ä¸€ç¯‡ç¬¦åˆå¥–åŠ±åŠŸèƒ½çš„æ–‡ç« ï¼Œæˆ‘ä»¬ä¼šç»™äºˆç§¯æçš„å¥–åŠ±ã€‚åœ¨æˆ‘ä»¬çš„æ¨¡æ‹Ÿä¸­ï¼Œè¿™æ˜¯ä¸€æ¬¡ç‚¹å‡»ã€‚

# äº†è§£ Vowpal Wabbit æ ¼å¼

æˆ‘ä»¬éœ€è¦é‡‡å–ä¸€äº›æ­¥éª¤ä»¥ Vowpal Wabbit ç†è§£çš„æ ¼å¼è®¾ç½®æˆ‘ä»¬çš„è¾“å…¥ã€‚

è¿™ä¸ªå‡½æ•°å¤„ç†ä»æˆ‘ä»¬çš„ä¸Šä¸‹æ–‡(å¦‚å­—å…¸ã€æ–‡ç« åˆ—è¡¨å’Œè´¹ç”¨ï¼Œå¦‚æœæœ‰çš„è¯)åˆ°å®ƒç†è§£çš„æ–‡æœ¬æ ¼å¼çš„è½¬æ¢:

ä¸ºäº†ç†è§£è¿™ç§æ ¼å¼ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæ—¶é—´æ˜¯æ—©ä¸Šï¼Œç”¨æˆ·æ˜¯ Tomã€‚æœ‰å››ç§å¯èƒ½çš„æ–‡ç« ã€‚

åœ¨ Vowpal Wabbit æ ¼å¼ä¸­ï¼Œæœ‰ä¸€è¡Œä»¥ shared å¼€å§‹ï¼Œå³å…±äº«ä¸Šä¸‹æ–‡ï¼Œåé¢æ˜¯å››è¡Œï¼Œæ¯è¡Œå¯¹åº”ä¸€ç¯‡æ–‡ç« :

![](img/0ef93a95515543fdee5eab1047685df1.png)

Figure 3

æ›´å¤šè¯¦æƒ…åœ¨è¿™é‡Œ:[https://github . com/VowpalWabbit/vowpal _ wabbit/wiki/Input-format](https://github.com/VowpalWabbit/vowpal_wabbit/wiki/Input-format)

# ä»æ²ƒå¸•å°”Â·ç“¦æ¯”ç‰¹é‚£é‡Œå¾—åˆ°ä¸€ä¸ªå†³å®š

å½“æˆ‘ä»¬è°ƒç”¨ Vowpal Wabbit æ—¶ï¼Œè¾“å‡ºæ˜¯ä¸€ä¸ª[æ¦‚ç‡è´¨é‡å‡½æ•°](https://en.wikipedia.org/wiki/Probability_mass_function) (PMF)ã€‚Vowpal Wabbit æä¾›äº†ä¸€ç³»åˆ—è¡ŒåŠ¨çš„å¯èƒ½æ€§åˆ—è¡¨ï¼Œå› ä¸ºæˆ‘ä»¬å°†å‹˜æ¢çº³å…¥äº†æˆ‘ä»¬çš„æˆ˜ç•¥ã€‚è¿™ç§æ¢ç´¢æ„å‘³ç€åˆ—è¡¨ä¸­ç»™å®šç´¢å¼•å¤„çš„æ¦‚ç‡å¯¹åº”äºé€‰æ‹©ç‰¹å®šåŠ¨ä½œçš„å¯èƒ½æ€§ã€‚

ä¸ºäº†åšå‡ºå†³å®š/é‡‡å–è¡ŒåŠ¨ï¼Œæˆ‘ä»¬å¿…é¡»ä»è¿™ä»½æ¸…å•ä¸­å–æ ·ã€‚

ä¾‹å¦‚ï¼Œç»™å®š list**ã€0.7ï¼Œ0.1ï¼Œ0.1ï¼Œ0.1ã€‘**ï¼Œæˆ‘ä»¬ä¼šä»¥ 70%çš„æ¦‚ç‡é€‰æ‹©ç¬¬ä¸€ä¸ªé¡¹ç›®ã€‚å‘½ä»¤`**sample_custom_pmf**`è·å–è¿™æ ·ä¸€ä¸ªåˆ—è¡¨ï¼Œå¹¶ç»™å‡ºå®ƒé€‰æ‹©çš„ç´¢å¼•ä»¥åŠé€‰æ‹©è¯¥ç´¢å¼•çš„æ¦‚ç‡ã€‚

æˆ‘ä»¬æ‹¥æœ‰ä¸ºç‰¹å®šç”¨æˆ·å’Œä¸Šä¸‹æ–‡é€‰æ‹©æ“ä½œæ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚ä½¿ç”¨ Vowpal Wabbit é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°è¿™ä¸€ç‚¹:

1.  å°†ä¸Šä¸‹æ–‡å’ŒåŠ¨ä½œè½¬æ¢æˆæ‰€éœ€çš„æ–‡æœ¬æ ¼å¼ã€‚
2.  å°†æ­¤ç¤ºä¾‹ä¼ é€’ç»™ Vowpal Wabbitï¼Œå¹¶è·å¾— PMF è¾“å‡ºã€‚
3.  å°è¯•æ­¤ PMF ä»¥è·å–è¦å±•ç¤ºçš„æ–‡ç« ã€‚
4.  è¿”å›é€‰æ‹©çš„æ–‡ç« å’Œé€‰æ‹©å®ƒçš„æ¦‚ç‡ã€‚

# å¼ºåŒ–å­¦ä¹ æ¨¡æ‹Ÿ

ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†æ‰€æœ‰çš„è®¾ç½®å·¥ä½œï¼Œå¹¶ä¸”çŸ¥é“äº†å¦‚ä½•ä¸ Vowpal Wabbit äº¤äº’ï¼Œè®©æˆ‘ä»¬æ¥æ¨¡æ‹Ÿ Tom å’Œ Anna çš„ä¸–ç•Œã€‚åœºæ™¯å¦‚ä¸‹:æ±¤å§†å’Œå®‰å¨œè®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œçœ‹åˆ°ä¸€ç¯‡æ–‡ç« ã€‚è¯·è®°ä½ï¼Œå¥–åŠ±åŠŸèƒ½å…è®¸æˆ‘ä»¬å®šä¹‰å¯¹ Vowpal Wabbit æ¨èçš„å†…å®¹çš„çœŸå®ååº”ã€‚

æˆ‘ä»¬éšæœºåœ°åœ¨æ±¤å§†å’Œå®‰å¨œä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼Œå¹¶ä¸”éšæœºåœ°é€‰æ‹©ä»–ä»¬è®¿é—®ç½‘ç«™çš„æ—¶é—´ã€‚æŠŠè¿™æƒ³è±¡æˆæŠ›ç¡¬å¸æ¥é€‰æ‹©æ±¤å§†å’Œå®‰å¨œï¼Œå†æŠ›ä¸€æ¬¡ç¡¬å¸æ¥é€‰æ‹©ä¸€å¤©ä¸­çš„æ—¶é—´ã€‚

# å®ä¾‹åŒ–å­¦å‘˜

æˆ‘ä»¬åœ¨ Vowpal Wabbit ä¸­å®ä¾‹åŒ–ä¸€ä¸ªä¸Šä¸‹æ–‡ bandit å­¦ä¹ å™¨ï¼Œç„¶åæ¨¡æ‹Ÿ Tom å’Œ Anna çš„ç½‘ç«™è®¿é—®æ¬¡æ•° num_iterationsã€‚æ¯æ¬¡è®¿é—®æ—¶ï¼Œæˆ‘ä»¬éƒ½è¦åšä»¥ä¸‹å·¥ä½œ:

1.  åœ¨æ±¤å§†å’Œå®‰å¨œä¹‹é—´åšå†³å®š
2.  å†³å®šä¸€å¤©ä¸­çš„æ—¶é—´
3.  å°†ä¸Šä¸‹æ–‡(å³ç”¨æˆ·ã€ä¸€å¤©ä¸­çš„æ—¶é—´)ä¼ é€’ç»™å­¦ä¹ è€…ä»¥è·å¾—è¡ŒåŠ¨(å³æ–‡ç« æ¨èå’Œé€‰æ‹©è¡ŒåŠ¨çš„æ¦‚ç‡)ã€‚
4.  è·å¾—å¥–åŠ±(å³ï¼ŒæŸ¥çœ‹ç”¨æˆ·æ˜¯å¦ç‚¹å‡»)ã€‚è®°ä½ï¼Œæˆæœ¬åªæ˜¯ä¸€ä¸ªè´Ÿå›æŠ¥ã€‚
5.  ä»¥ Vowpal Wabbit æ ¼å¼æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ã€åŠ¨ä½œã€æ¦‚ç‡ã€å¥–åŠ±
6.  ä»ä¾‹å­ä¸­å­¦ä¹ 

è¿™ç§å‡å°‘å¯¹äºæˆ‘ä»¬çš„æ¯ä¸€ä¸ªæ¨¡æ‹Ÿéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨`**run_simulation**`å‡½æ•°ä¸­å®šä¹‰è¿™ä¸ªè¿‡ç¨‹ã€‚æˆ‘ä»¬å¿…é¡»æä¾›æˆæœ¬å‡½æ•°æ¥æ¨¡æ‹Ÿç°å®ä¸–ç•Œæ˜¯å¦‚ä½•å·¥ä½œçš„:

> ***ç°å®ä¸–ç•Œä¸­äººä»¬çš„åå¥½éšç€æ—¶é—´è€Œå˜åŒ–ã€‚ä¸ºäº†åœ¨æ¨¡æ‹Ÿä¸­è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åˆå¹¶äº†ä¸¤ä¸ªä¸åŒçš„æˆæœ¬å‡½æ•°ï¼Œå¹¶åœ¨ä¸­é€”åˆ‡æ¢åˆ°ç¬¬äºŒä¸ªå‡½æ•°(å›¾ 7)ã€‚***

å½“æˆ‘ä»¬æ”¹å˜æˆæœ¬å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¼€å§‹å¥–åŠ±ä»¥å‰ä»æœªæœ‰è¿‡å›æŠ¥çš„è¡Œä¸º:

![](img/2eddcd93083bcd799fabbd22da96d318.png)

User Behaviour

ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨å‡ ä¸ªæ ·æœ¬ä¹‹ååˆ‡æ¢åˆ°æ–°çš„å¥–åŠ±å‡½æ•°(è¿è¡Œç¬¬ä¸€ä¸ªå¥–åŠ±å‡½æ•°)ã€‚è¯·è®°ä½ï¼Œè¿™ä¸ªå¥–åŠ±åŠŸèƒ½ä¼šæ”¹å˜ç”¨æˆ·çš„åå¥½ã€‚å®ƒæ­£åœ¨ä¸ä¸€ä¸ª**ä¸åŒçš„**è¡ŒåŠ¨ç©ºé—´æ¯”ä»¥å‰ã€‚æˆ‘ä»¬åº”è¯¥çœ‹åˆ°å­¦ä¹ è€…æ¥å—è¿™äº›å˜åŒ–å¹¶ä¼˜åŒ–æ–°çš„åå¥½ã€‚

![](img/4c7bab0e561a3de825f223cbdc6f245e.png)

# æ¨¡å‹ä¿å­˜å’ŒåŠ è½½ Python

VW æ”¯æŒä¿å­˜æ¨¡å‹å¹¶å°†å…¶åŠ è½½åˆ°å¦ä¸€ä¸ª VW æµç¨‹ä¸­ã€‚è¯¥æ¨¡å‹çš„å†…å®¹åŒ…æ‹¬:

*   å¤§ä¼—ç‰ˆæœ¬
*   æ ‡è®°ä¸º`keep`çš„å‘½ä»¤è¡Œå‚æ•°
*   è¿™æ˜¯ä¸€äº›æ··ä¹±çš„æ¥æºï¼Œæ¨¡å‹çš„å†…å®¹é€šå¸¸åŒ…å«æ¯”æœ€åˆè¿è¡Œ VW æ—¶æä¾›çš„æ›´å¤šæˆ–æ›´å°‘çš„å‚æ•°ã€‚è¿™æ˜¯å› ä¸ºé`keep`å‚æ•°ä¸ä¼šè¢«ä¿å­˜ï¼Œä¸€äº›ç¼©å‡ä¼šæ’å…¥é¢å¤–çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œè¿™äº›å‚æ•°æœ¬èº«è¢«æ ‡è®°ä¸º`keep`
*   é€šç”¨å¤§ä¼—çŠ¶æ€
*   æ¯ä¸ªå·²å¯ç”¨ç¼©å‡çš„çŠ¶æ€

åœ¨ Python ä¸­ä½¿ç”¨ VW æ—¶ï¼Œå‡ ä¹æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°éƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚

# ä¿å­˜æ¨¡å‹

åœ¨ Python ä¸­ä¿å­˜æ¨¡å‹å¯ä»¥ä½¿ç”¨`final_regressor`ã€‚ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¨¡å‹ä¿å­˜å‘ç”Ÿåœ¨ VW æ¸…ç†çš„æ—¶å€™ï¼Œæ‰€ä»¥ä½ éœ€è¦è°ƒç”¨`[finish](https://vowpalwabbit.org/docs/vowpal_wabbit/python/latest/vowpalwabbit.pyvw.html?highlight=finish#vowpalwabbit.pyvw.vw.finish)`æˆ–è€…é”€æ¯å¯¹è±¡(ä¾‹å¦‚ç”¨`del`)ï¼Œè¿™å°†ä¾æ¬¡è°ƒç”¨`[finish](https://vowpalwabbit.org/docs/vowpal_wabbit/python/latest/vowpalwabbit.pyvw.html?highlight=finish#vowpalwabbit.pyvw.vw.finish)`ã€‚

ä½ ä¹Ÿå¯ä»¥éšæ—¶è°ƒç”¨`[save](https://vowpalwabbit.org/docs/vowpal_wabbit/python/latest/vowpalwabbit.pyvw.html?highlight=finish#vowpalwabbit.pyvw.vw.save)`æ¥ä¿å­˜ä¸€ä¸ªæ¨¡å‹æ–‡ä»¶ã€‚è¿™åªæ”¯æŒä¿å­˜äºŒè¿›åˆ¶æ¨¡å‹æ–‡ä»¶ï¼Œä¸æ”¯æŒå¯è¯»ç‰ˆæœ¬ã€‚

```
vw = pyvw.vw("-f vw.model")
vw = pyvw.vw(final_regressor="vw.model")
vw.save("vw.model")
```

# åŠ è½½æ¨¡å‹

è¦åœ¨ Python ä¸­åŠ è½½æ¨¡å‹æ–‡ä»¶ï¼Œæ‚¨åº”è¯¥åœ¨åˆ›å»º`vw`å®ä¾‹æ—¶ä½¿ç”¨`initial_regressor`é…ç½®å¯¹è±¡ã€‚

```
vw = pyvw.vw("-i vw.model")
vw = pyvw.vw(initial_regressor="vw.model")
```

# èµ„æº

æˆ‘æ²¡æœ‰è¯•å›¾ä¿®æ”¹å¤§ä¼—ç°æœ‰çš„æ•™ç¨‹ï¼Œå¹¶è¯•å›¾åªæ”¶é›†ç›¸å…³çš„éƒ¨åˆ†ï¼Œä¸ºè¿™ä¸ªæ•™ç¨‹ã€‚è¿™é‡Œå¯ä¾›æ¢ç´¢çš„é€‰æ‹©éå¸¸å¤šã€‚åŠ¡å¿…é˜…è¯»ä»–ä»¬çš„å‚è€ƒèµ„æ–™ï¼Œå¹¶ç›¸åº”åœ°è¿›è¡Œå®éªŒã€‚æˆ‘å¸Œæœ›è¿™ç¯‡åšå®¢è®©ä½ å¯¹å¤§ä¼—çš„å¼ºå¤§æœ‰äº†ä¸€ä¸ªå¾ˆå¥½çš„äº†è§£ã€‚

*   [https://github.com/VowpalWabbit/vowpal_wabbit/wiki](https://github.com/VowpalWabbit/vowpal_wabbit/wiki)
*   [https://vowpalwabbit . org/tutorials/contextual _ bandits . html # python-tutorial](https://vowpalwabbit.org/tutorials/contextual_bandits.html#python-tutorial)
*   [https://www . Microsoft . com/en-us/research/publication/a-contextual-bandit-bake-off-2/](https://www.microsoft.com/en-us/research/publication/a-contextual-bandit-bake-off-2/)

æˆ‘ä»¥å‰çš„æŠ¥é“:[https://subirverma.medium.com](https://subirverma.medium.com)

[](https://www.linkedin.com/in/sbrvrm/) [## è‹æ¯”å°”ç»´å°”é©¬-æ•°æ®ç§‘å­¦å®¶ lll -å¡”å¡” 1mg | LinkedIn

### Subir æ˜¯ä¸€ä½å……æ»¡æ¿€æƒ…ã€è‡ªå­¦æˆæ‰çš„æ•°æ®ç§‘å­¦å®¶ã€‚ä»–ä» 2016 å¹´å¼€å§‹ä»äº‹æ•°æ®ç§‘å­¦é¢†åŸŸçš„å·¥ä½œâ€¦

www.linkedin.com](https://www.linkedin.com/in/sbrvrm/) 

è°¢è°¢

[](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb) [## Mlearning.ai æäº¤å»ºè®®

### å¦‚ä½•æˆä¸º Mlearning.ai ä¸Šçš„ä½œå®¶

medium.com](/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb)