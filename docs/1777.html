<html>
<head>
<title>Immortal Snake Game in Python using OpenCV — with source code— Fun Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用OpenCV的Python不朽的蛇游戏——带源代码——有趣的项目</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/immortal-snake-game-in-python-using-opencv-with-source-code-fun-project-1bf45c1f69cf?source=collection_archive---------4-----------------------#2022-01-28">https://medium.com/mlearning-ai/immortal-snake-game-in-python-using-opencv-with-source-code-fun-project-1bf45c1f69cf?source=collection_archive---------4-----------------------#2022-01-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="02a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">到目前为止，我已经在数据科学的几乎每个领域做了大量的项目，从ML、DL、计算机视觉到NLP，但是这个用Python编写的<strong class="ig hi">不朽的贪吃蛇游戏</strong>仍然是我<em class="jc">最喜欢的项目之一</em>，因为它的简单性和用户交互。在看了大约100行代码的结果后，你会感到非常惊讶。</p><p id="d094" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">https://machinelearningprojects.net/snake-game-in-python/<a class="ae jd" href="https://machinelearningprojects.net/snake-game-in-python/" rel="noopener ugc nofollow" target="_blank"/>点击此处阅读全文及源代码</p><p id="835f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">点击此处查看视频—<a class="ae jd" href="https://youtu.be/g3brEQ_1QsI" rel="noopener ugc nofollow" target="_blank">https://youtu.be/g3brEQ_1QsI</a></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/69ee273277639fca60f50904f3e373c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*E87uqZGsKgtzZyR7_K0kQA.gif"/></div></div></figure><h1 id="f2b4" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">让我们开始吧…</h1><h2 id="d062" class="ko jr hh bd js kp kq kr jw ks kt ku ka ip kv kw ke it kx ky ki ix kz la km lb bi translated">用python写的不死蛇游戏代码…</h2><pre class="jf jg jh ji fd lc ld le lf aw lg bi"><span id="a573" class="ko jr hh ld b fi lh li l lj lk">import cv2<br/>import imutils<br/>from collections import deque<br/>import numpy as np<br/>import time<br/><br/>score = 0<br/>max_score=20<br/>list_capacity = 0<br/>max_lc =20<br/>l = []<br/>flag=0<br/>apple_x = None<br/>apple_y = None<br/>center = None<br/><br/># distance function<br/>def dist(pt1,pt2):<br/>    return np.sqrt((pt1[0]-pt2[0])**2 + (pt1[1]-pt2[1])**2)<br/>cap = cv2.VideoCapture(0)<br/><br/># Snake game in Python<br/>while 1:<br/><br/>    ret,frame = cap.read()<br/>    img = imutils.resize(frame.copy(),width=600)<br/>    img = cv2.GaussianBlur(img,(11,11),0)          <br/>    img = cv2.cvtColor(img,cv2.COLOR_BGR2HSV)     <br/>    <br/>    if apple_x is None or apple_y is None:<br/>        <br/>        # assigning random coefficients for apple coordinates<br/>        apple_x = np.random.randint(30,frame.shape[0]-30) <br/>        apple_y = np.random.randint(100,350)       <br/><br/>    cv2.circle(frame,(apple_x,apple_y),3,(0,0,255),-1)<br/>    <br/>    # change this range acc to your need <br/>    greenLower = (29, 86, 18)<br/>    greenUpper = (93, 255, 255)<br/>    <br/>    # masking out the green color  <br/>    mask = cv2.inRange(img,greenLower,greenUpper)<br/>    mask = cv2.erode(mask,None,iterations=2)<br/>    mask = cv2.dilate(mask,None,iterations=2)<br/>    <br/>    # find contours<br/>    cnts = cv2.findContours(mask,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)<br/>    cnts = imutils.grab_contours(cnts)<br/>    <br/>    <br/>    if len(cnts)&gt;0:<br/>        ball_cont = max(cnts,key=cv2.contourArea)<br/>        (x,y),radius = cv2.minEnclosingCircle(ball_cont) # find the minimum enclosing circle about the found contour <br/>        <br/>        M = cv2.moments(ball_cont)<br/>        center = (int(M['m10']/M['m00']),int(M['m01']/M['m00']))<br/>        <br/>        if radius&gt;10:<br/>            cv2.circle(frame,center,2,(0,0,255),3)<br/>            <br/>            if len(l)&gt;list_capacity:<br/>                l = l[1:]<br/>            <br/>            if prev_c and (dist(prev_c,center) &gt;3.5):<br/>                l.append(center)<br/>                <br/>            apple = (apple_x,apple_y)<br/>            if dist(apple,center)&lt;5:<br/>                score+=1<br/>                if score==max_score:<br/>                    flag=1<br/>                list_capacity+=1<br/>                apple_x = None<br/>                apple_y = None<br/>        <br/>    for i in range(1,len(l)):<br/>        if l[i-1] is None or l[i] is None:<br/>            continue<br/>        r,g,b = np.random.randint(0,255,3)<br/>        <br/>        cv2.line(frame,l[i],l[i-1],(int(r),int(g),int(b)), thickness = int(len(l)/max_lc+2)+2)    <br/>    <br/>    <br/>    cv2.putText(frame,'Score :'+str(score),(450,100),cv2.FONT_HERSHEY_SIMPLEX,1,(255,0,203),2)<br/>    if flag==1:<br/>        cv2.putText(frame,'YOU WIN !!',(100,250),cv2.FONT_HERSHEY_SIMPLEX,3,(255,255,0),3)<br/>        <br/>    cv2.imshow('live feed',frame)<br/>    cv2.imshow('mask',mask)<br/>    prev_c = center<br/>    <br/>    if cv2.waitKey(1)==27:<br/>        break<br/>        <br/>cv2.destroyAllWindows()<br/>cap.release()<br/><br/># This was the code for snake game in Python</span></pre><ul class=""><li id="724c" class="ll lm hh ig b ih ii il im ip ln it lo ix lp jb lq lr ls lt bi translated">第1–5行—导入所需的库。</li><li id="6a30" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第7–14行——初始化一些我们将进一步用到的常量。</li><li id="b4a8" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第17–19行—只声明了一个距离函数，该函数将简单地计算两点(x1，y1)和(x2，y2)之间的距离。</li><li id="eebd" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第20行—声明<a class="ae jd" href="https://docs.opencv.org/3.4/d8/dfe/classcv_1_1VideoCapture.html" rel="noopener ugc nofollow" target="_blank"> VideoCapture </a>对象来访问网络摄像头。</li><li id="e32a" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated"><strong class="ig hi">让我们启动infinit循环来玩Python中的贪吃蛇游戏……</strong></li><li id="a9d9" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第25行—从网络摄像头读取图像。</li><li id="00f7" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第26行—将图像的宽度调整为600，imutils库将保持纵横比。</li><li id="e138" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第27行——模糊图像以去除噪声。</li><li id="a424" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第28行——将BGR图像转换为HSV模式，因为我们将在后面的步骤中制作遮罩，这在HSV模式下效果最好。</li><li id="d2b9" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第30行——只是检查它是否是循环的开始，因为在开始时只有apple_x和apple_y都是None。在这里，苹果是蛇吃的红点以获得分数。</li><li id="34cb" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第33–34行——将整数随机分配给apple_x和apple_y，这两个整数将一起给出苹果的坐标。</li><li id="49cd" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第36行——画一个圆，或者我们可以说在框架上放一个点/苹果。半径为3个像素的圆看起来像一个点。</li><li id="54ec" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第39–40行—设置绿色的范围。这是一个非常敏感的步骤，因为选择错误的范围会完全破坏游戏的运行。这个范围被调整为绿色瓶盖，我在下面的视频中使用。根据物体的颜色进行调整。</li><li id="6f1a" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第43行——这将创建遮罩。它将检查图像的每个像素，并检查该像素的颜色是否在范围内(上面指定的范围)。如果在范围内，将其标记为白色像素，否则将其标记为黑色像素。</li><li id="0bd7" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第44–45行我们正在<a class="ae jd" href="https://machinelearningprojects.net/how-to-perform-morphological-operations-like-erosion-dilation-and-gradient-in-opencv/" rel="noopener ugc nofollow" target="_blank">腐蚀和扩张</a>图像，以消除任何噪声(如果有的话),从而增强Python中贪吃蛇游戏的响应。</li><li id="29f6" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第48–49行——我们只是从遮罩中检测轮廓。因为我们的瓶盖是圆的，所以我们的面具也是黑底白字。所以它会选择这个白色轮廓。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lz"><img src="../Images/bca2441c55fa595458eb455c1dddb8df.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*-YcM0nRl4fH7P7AX.jpg"/></div></figure><ul class=""><li id="f2e9" class="ll lm hh ig b ih ii il im ip ln it lo ix lp jb lq lr ls lt bi translated">第52行——我们正在检查是否发现了任何轮廓。</li><li id="139f" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第53行—选择面积最大的等值线，因为在许多情况下，小的噪声等值线也会被拾取。</li><li id="905e" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第54行——计算轮廓的<a class="ae jd" href="https://docs.opencv.org/3.4/dd/d49/tutorial_py_contour_features.html" rel="noopener ugc nofollow" target="_blank">最小外接圆</a>。</li><li id="636c" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第56–57行——计算轮廓的<a class="ae jd" href="https://docs.opencv.org/3.4/dd/d49/tutorial_py_contour_features.html" rel="noopener ugc nofollow" target="_blank">矩</a>,并找到轮廓的质心。这个质心将与瓶盖的中心相同。</li><li id="fe8f" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第59行——如果我们发现的最大轮廓的半径大于10，那么我们确定这是瓶盖。</li><li id="f931" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第60行—在中心(你可以看到瓶子的中心)画一个半径为2的圆(看起来像一个点)。</li><li id="b4eb" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第62–63行—就这么做:)，做了一些调整。</li><li id="93d9" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第68–70行—我们只是检查我们的蛇嘴(瓶子中心)和苹果之间的距离是否小于5个像素，将其标记为被吃掉，并增加分数。</li><li id="6105" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第71–72行—如果分数达到20，设置flag=1，这将在屏幕上显示“您赢了”。</li><li id="cfa2" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第73–75行—增加列表容量并将apple_x和apple_y重置为无。</li><li id="78c2" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第77–82行—构建蛇。列表l将包含我们的蛇经过的所有最后n个点，并在它们之间画一条看起来像蛇的线。第80行只是给每一行分配一个随机的颜色。</li><li id="dbdd" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第85行——把乐谱放在画框上。</li><li id="8e44" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第86–87行—如果flag=1表示您已经达到20分，打印“您赢了”。</li><li id="9832" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第89–90行—显示主图像。</li><li id="4932" class="ll lm hh ig b ih lu il lv ip lw it lx ix ly jb lq lr ls lt bi translated">第93–94行—如果用户按下ESC键，则破解代码。</li></ul><h2 id="d0e6" class="ko jr hh bd js kp kq kr jw ks kt ku ka ip kv kw ke it kx ky ki ix kz la km lb bi translated">最终结果…</h2><p id="a44a" class="pw-post-body-paragraph ie if hh ig b ih ma ij ik il mb in io ip mc ir is it md iv iw ix me iz ja jb ha bi translated">让我们玩游戏吧…</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/69ee273277639fca60f50904f3e373c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*E87uqZGsKgtzZyR7_K0kQA.gif"/></div></div></figure><p id="7eb8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果对Python中的贪吃蛇游戏有任何疑问，请通过电子邮件或LinkedIn联系我。</p><p id="bc46" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如需进一步的代码解释和源代码，请访问此处</strong>—<a class="ae jd" href="https://machinelearningprojects.net/snake-game-in-python/" rel="noopener ugc nofollow" target="_blank">https://machinelearningprojects.net/snake-game-in-python/</a></p><p id="0c64" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">这就是我写给这个博客的全部内容，感谢你的阅读，我希望你在阅读完这篇文章后，能有所收获，直到下一次👋… </em></p><p id="754c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">看我以前的帖子:</em> </strong> <a class="ae jd" href="https://machinelearningprojects.net/how-to-find-the-most-dominant-colors-in-an-image-in-opencv/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="jc">如何在PYTHON中使用KMEANS聚类找到一幅图像中最主要的颜色</em> </strong> </a></p><p id="951b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">查看我的其他</strong> <a class="ae jd" href="https://machinelearningprojects.net/machine-learning-projects/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">机器学习项目</strong></a><strong class="ig hi"/><a class="ae jd" href="https://machinelearningprojects.net/deep-learning-projects/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">深度学习项目</strong></a><strong class="ig hi"/><a class="ae jd" href="https://machinelearningprojects.net/opencv-projects/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">计算机视觉项目</strong></a><strong class="ig hi"/><a class="ae jd" href="https://machinelearningprojects.net/nlp-projects/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">NLP项目</strong></a><strong class="ig hi"/><a class="ae jd" href="https://machinelearningprojects.net/flask-projects/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">烧瓶项目</strong> </a> <strong class="ig hi"> at</strong></p><div class="mf mg ez fb mh mi"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mj ab dw"><div class="mk ab ml cl cj mm"><h2 class="bd hi fi z dy mn ea eb mo ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="mp l"><h3 class="bd b fi z dy mn ea eb mo ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mq l"><p class="bd b fp z dy mn ea eb mo ed ef dx translated">medium.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw jo mi"/></div></div></a></div></div></div>    
</body>
</html>