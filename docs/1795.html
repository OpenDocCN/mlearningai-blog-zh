<html>
<head>
<title>Multivariate Time Series Forecasting using FBProphet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于FBProphet的多元时间序列预测</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/multivariate-time-series-forecasting-using-fbprophet-66147f049e66?source=collection_archive---------0-----------------------#2022-01-30">https://medium.com/mlearning-ai/multivariate-time-series-forecasting-using-fbprophet-66147f049e66?source=collection_archive---------0-----------------------#2022-01-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="fb8a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大家好，希望你们都过得好。今天我想出了一个帖子，可以帮助我们使用FBProphet做多元变量时间序列预测。这是一个由脸书提供的扩展库，它将帮助我们基于多种特征对标记的输出进行预测。这个过程很简单，我想这篇文章可能会帮助你在你的个人项目中创建模型。</p><p id="a41d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从导入基本模块开始编码。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/ac5b124d070f70e693640bb11d0b8065.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*li5bj1roNmaJLqmOEd7Pfg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Basic modules imported</figcaption></figure><p id="0901" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们尝试将数据集和列名可视化，并向您解释这个场景。在下面的数据集中，我们试图预测股票的开盘价，开盘价不仅取决于股票本身以前的价值，还取决于其他对其有很大影响的特征。在下面的例子中，像高、低、收盘这样的列在决定价格时起着重要的作用。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jo"><img src="../Images/838c1d8363b0820548d5bf74f1d0f514.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E1M4-8fQ-qQmB0Nv9y-Ffw.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Data Training Visualization</figcaption></figure><p id="a535" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们也有一个类似的数据集，我们将在其上测试我们的模型，并尝试预测预测值。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jt"><img src="../Images/5d69dc8e53d55bbb8bdcef6c6bd74849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kcBIPA4vty_1Ck4ZDpSq8A.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Visualization of test Dataset</figcaption></figure><p id="4a1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在应用FBProphet模型之前，请验证所有列是否都具有所需的数据类型。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ju"><img src="../Images/22cce74956ec370eb48132582b573b8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*Dr0vAiNj_nBDjFDu_zuCKA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Training set Datatypes</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jv"><img src="../Images/4243559a83cc6106b8c280ecc888fc5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*4b2JPPKHnbqRIiNYnkC9nQ.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Testing set datatypes</figcaption></figure><p id="6f21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们尝试使用我们的肉眼和智能来可视化所有单个列的数据集。-).我们正试图确定相同的趋势、季节性和模式。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jw"><img src="../Images/1047dd44b5c6f0229f0b94ec318da748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yS9VSmOZ5bqdCR3ApmqtpA.png"/></div></div></figure><p id="a748" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我能够确定使用探索性数据分析，股票开盘价是依赖或有保存的趋势，作为高价格和低价格的特点。虽然收盘时的股票特征趋势似乎与开盘价有很大不同。在应用该模型之前，请确保将日期列名转换为'<strong class="ig hi"> ds </strong>，将预测列名转换为'<strong class="ig hi"> y </strong>'。其余的一切都可以保持原样。如果你有任何疑问，请参考下面的链接，我曾尝试使用FBProphet解决单变量时间序列问题。你会很容易理解的。</p><p id="a9da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">链接:<a class="ae jx" rel="noopener" href="/mlearning-ai/univariate-time-series-forecasting-using-fbprophet-ad9ad68e59bc"><strong class="ig hi">https://medium . com/mlearning-ai/univariate-time-series-forecasting-using-fbprophet-ad 9 ad 68 e 59 BC</strong></a></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jy"><img src="../Images/81c475cf635e1954d028467f1fd48fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bkHbMFtQXwQDpUX4nRQFfQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Renamed Columns</figcaption></figure><p id="2ee8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们尝试创建一个FBProphet模型的实例，并尝试适应我们的训练数据集。在这种情况下，它与我们没有使用add_regressor函数的单变量时间序列略有不同。我们正在尝试使用多种功能来确定我们的标签输出(“开放”)。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jz"><img src="../Images/cdeffeee595b9b6d311d823475881fe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IpsrUM7PJuntX9ylsyPW3w.png"/></div></div></figure><p id="5651" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意:如果你不确定季节性，请不要提及任何事情，因为FBProphet足够聪明可以这样做。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es ka"><img src="../Images/6b05c1158cfad5744efdad87d9cffd4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mfZLfSPa14g8febkSYP8yQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Parameters for my model</figcaption></figure><p id="34d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们试着创建另一个测试数据框，在这里我可以删除Open的实际值。它将帮助我们预测期望的输出。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kb"><img src="../Images/255bdae7341e15db7e2412838321dd97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*w_XNVSex77FyUIwl2MQ-fQ.png"/></div></figure><p id="9c64" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">尝试为我的测试数据集预测'<strong class="ig hi"> Open </strong>'值。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kc"><img src="../Images/c3aba767ca21d72c4f44510524bb1972.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*KOQ5RstDF2PfD2Eg3lHjXg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx"><strong class="bd kd">yhat-Forecasted Open Value</strong></figcaption></figure><p id="372f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们试着将预测值和实际值放在一起，然后试着直观地看到它们之间的差异。如果你想和其他模型进行比较，你可以使用像<strong class="ig hi"> MAE，MSE &amp; RMSE这样的指标。</strong></p><p id="6345" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为我已经有了实际值，所以我会尝试将它们与预测值进行比较。事情是这样的！！！！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ke"><img src="../Images/f4259a2d8ab2739c1e4ae3c3ba8b9c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*dBZyWZB_LjnFklPpugFvyg.png"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kf"><img src="../Images/44f7f2edd5f818ccf3e1299e509ea678.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*R6tnySetpFGB3to6-TsV6A.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">y-Actual_value, y_hat — Forecasted value</figcaption></figure><p id="e021" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最终可视化:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es kg"><img src="../Images/8797f51ca5b7955d5860f7c4d90b7cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_DgVAZPIGkSi51M5tn2bTw.png"/></div></div></figure><p id="6b26" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我觉得这个模型效果很好，比递归神经网络和Arima模型都好得多。在这种情况下，我觉得RNN可以用更好的方式来训练。我想请你在LSTM模型上玩更多的超参数调谐，这反过来可以帮助你有明亮的结果。</p><p id="7c08" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢大家！！！如果您有任何疑问，请发表评论。这不仅有助于我改进和调整，而且我还能以更好的方式构建我的模型。再次感谢！！！</p><div class="kh ki ez fb kj kk"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kl ab dw"><div class="km ab kn cl cj ko"><h2 class="bd hi fi z dy kp ea eb kq ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="kr l"><h3 class="bd b fi z dy kp ea eb kq ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="ks l"><p class="bd b fp z dy kp ea eb kq ed ef dx translated">medium.com</p></div></div><div class="kt l"><div class="ku l kv kw kx kt ky ji kk"/></div></div></a></div></div></div>    
</body>
</html>