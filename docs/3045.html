<html>
<head>
<title>Linear Regression vs Elastic Net Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的线性回归与弹性网回归</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/linear-regression-vs-elastic-net-regression-in-python-ea52a11efd7a?source=collection_archive---------4-----------------------#2022-07-12">https://medium.com/mlearning-ai/linear-regression-vs-elastic-net-regression-in-python-ea52a11efd7a?source=collection_archive---------4-----------------------#2022-07-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c4c3389053dcf1c0d5b2883816b58d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ECPR1EHrAmzB9Czw"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx">Photo by <a class="ae it" href="https://unsplash.com/es/@clintadair?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Clint Adair</a> on <a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="61f5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我最近发现了使用Python构建模型的elastic net，所以我想我应该把它写下来，因为它对社区有好处，也是我自己的参考。</p><p id="e9e9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">弹性网回归是将岭回归和套索回归结合成一个算法。超参数阿尔法和L1比率控制着我们对算法施加的惩罚。例如，如果L1比率=0，我们有岭回归，如果L1比率= 1，我们有套索。</p><p id="3c6d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">弹性净回归的一个伟大之处在于，它可以通过将弱变量尽可能地变为0或接近0来删除弱变量。这些是组成弹性网的套索和脊的元素。此外，我喜欢弹性网的一个好处，我想提的是它能够强制变量为正。例如，如果KPI的所有驱动因素都是积极的，而线性回归显示其中一个因素有负面影响，那么您可以使用弹性网络强制所有驱动因素都是积极的。</p><p id="747c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下一步，让我们运行一个线性回归和弹性净回归的例子，看看它们的区别。</p><ol class=""><li id="604d" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">让我们导入本练习所需的所有库</li></ol><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="7ac3" class="kk kl hh kg b fi km kn l ko kp">import numpy as np<br/>import pandas as pd<br/>from sklearn.model_selection import GridSearchCV<br/>from sklearn.linear_model import ElasticNet<br/>from sklearn.linear_model import LinearRegression<br/>from sklearn.metrics import mean_squared_error</span></pre><p id="a759" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2.从UCI下载数据到熊猫数据框架，并设置我们的X和Y变量</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="5951" class="kk kl hh kg b fi km kn l ko kp">url = ‘<a class="ae it" href="http://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv'" rel="noopener ugc nofollow" target="_blank">http://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv'</a><br/>df = pd.read_csv(url, sep=’;’)</span><span id="7ae8" class="kk kl hh kg b fi kq kn l ko kp">X=df.loc[:, ~df.columns.isin([‘quality’])]<br/>y=df[‘quality’]</span></pre><p id="298d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.运行线性回归并报告MSE</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="6bfe" class="kk kl hh kg b fi km kn l ko kp">regression=LinearRegression()<br/>regression.fit(X,y)<br/>first_model_MSE=(mean_squared_error(y_true=y,y_pred=regression.predict(X)))<br/>print(first_model_MSE)<br/>#0.41676716722140805</span></pre><p id="f808" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4.查看线性回归的系数</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="600c" class="kk kl hh kg b fi km kn l ko kp">coef_dict_baseline = {}<br/>for coef, feat in zip(regression.coef_,X.columns):<br/> coef_dict_baseline[feat] = coef<br/>coef_dict_baseline</span><span id="1377" class="kk kl hh kg b fi kq kn l ko kp">{'fixed acidity': 0.02499055267167325,<br/> 'volatile acidity': -1.0835902586934376,<br/> 'citric acid': -0.18256394841070975,<br/> 'residual sugar': 0.01633126976547429,<br/> 'chlorides': -1.8742251580992035,<br/> 'free sulfur dioxide': 0.004361333309096989,<br/> 'total sulfur dioxide': -0.0032645797030686347,<br/> 'density': -17.881163832495734,<br/> 'pH': -0.41365314382176305,<br/> 'sulphates': 0.9163344127211318,<br/> 'alcohol': 0.27619769922688664}</span></pre><p id="0ad6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">正如我们在上面看到的，我们有x中所有变量的系数。它们是否有意义是另一回事。我对葡萄酒质量了解不多，无法判断！</p><p id="474b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">5.让我们用标准化的值建立一个弹性网络。然而，作为第一步，我们需要使用网格搜索来帮助我们找到阿尔法和L1比率的可靠值，这将产生最佳模型。根据您的机器，此位需要几秒钟来运行。</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="3fcf" class="kk kl hh kg b fi km kn l ko kp">elastic=ElasticNet(normalize=True)<br/>search=GridSearchCV(estimator=elastic<br/> ,param_grid={‘alpha’:np.logspace(-5,2,8)<br/> ,’l1_ratio’:[0,.2,.4,.6,.8,1]}<br/> ,scoring=’neg_mean_squared_error’,n_jobs=1,refit=True,cv=10)</span><span id="f92f" class="kk kl hh kg b fi kq kn l ko kp">search.fit(X,y)<br/>search.best_params_<br/>#{'alpha': 0.0001, 'l1_ratio': 0.4}<br/>abs(search.best_score_)<br/>#0.43413742198432625</span></pre><p id="d326" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">6.用网格搜索确定的阿尔法和L1比值重新运行一个弹性网</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="c229" class="kk kl hh kg b fi km kn l ko kp">elastic=ElasticNet(normalize=True,alpha=0.001,l1_ratio=0.4)<br/>elastic.fit(X,y)<br/>second_model_mse=(mean_squared_error(y_true=y,y_pred=elastic.predict(X)))<br/>print(second_model_mse)<br/>#0.46183127160398396</span></pre><p id="2f3f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">7.让我们回顾一下弹性网的系数，看看它们是如何比较的</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="e609" class="kk kl hh kg b fi km kn l ko kp">coef_dict_baseline = {}<br/>for coef, feat in zip(elastic.coef_,X.columns):<br/> coef_dict_baseline[feat] = coef<br/>coef_dict_baseline</span><span id="31b4" class="kk kl hh kg b fi kq kn l ko kp">{'fixed acidity': 0.014285479621796009,<br/> 'volatile acidity': -0.6103163705349157,<br/> 'citric acid': 0.1826794358574798,<br/> 'residual sugar': 0.002222720304848855,<br/> 'chlorides': -0.8351842130958829,<br/> 'free sulfur dioxide': 0.0,<br/> 'total sulfur dioxide': -0.0014228214139999087,<br/> 'density': -21.637643588877914,<br/> 'pH': -0.04056906676888897,<br/> 'sulphates': 0.451421857492302,<br/> 'alcohol': 0.14341814232976277}</span></pre><p id="4aaa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你能注意到可变的游离二氧化硫是如何变成0的吗？因为它是一个弱变量，所以弹性网把它设为0。此外，该模型略有不同，因为柠檬酸与线性回归的系数为负，而与弹性网的系数为正。您可能会认为，由于输入的变量及其设置不同，模型会有所不同。</p><p id="7519" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你想在回归中强制所有变量为正，你会怎么做？</p><p id="7c9e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">8.将正=真参数添加到弹性网络函数中，让我们重新运行模型</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="abb5" class="kk kl hh kg b fi km kn l ko kp">elastic=ElasticNet(normalize=True,alpha=0.001,l1_ratio=0.4, positive=True)<br/>elastic.fit(X,y)<br/>third_model_mse=(mean_squared_error(y_true=y,y_pred=elastic.predict(X)))<br/>print(third_model_mse)<br/>#0.5079920349191247</span><span id="d609" class="kk kl hh kg b fi kq kn l ko kp">coef_dict_baseline = {}<br/>for coef, feat in zip(elastic.coef_,X.columns):<br/> coef_dict_baseline[feat] = coef<br/>coef_dict_baseline</span><span id="a6d4" class="kk kl hh kg b fi kq kn l ko kp">{'fixed acidity': 0.01306609743058668,<br/> 'volatile acidity': 0.0,<br/> 'citric acid': 0.2824161323218671,<br/> 'residual sugar': 0.0,<br/> 'chlorides': 0.0,<br/> 'free sulfur dioxide': 0.0,<br/> 'total sulfur dioxide': 0.0,<br/> 'density': 0.0,<br/> 'pH': 0.0,<br/> 'sulphates': 0.44743438091280563,<br/> 'alcohol': 0.17087338339714536}</span></pre><p id="75ed" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以这里发生了一些有趣的事情。所有的变量都是正的(这是我们想要的),然而，那些不能被建模为正的变量被强制设为0。游离二氧化硫为0，因为它是一个弱变量，正如我们之前看到的。值得注意的是，我们使用了以前模型中的阿尔法和L1比率。让我们更进一步，通过网格搜索一个弹性网络超参数，强制变量为正，看看它会产生什么。</p><p id="ad09" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">9.让我们重复第5、6、7步，但正值=真</p><pre class="kb kc kd ke fd kf kg kh ki aw kj bi"><span id="b48c" class="kk kl hh kg b fi km kn l ko kp">elastic=ElasticNet(normalize=True, positive=True)<br/>search=GridSearchCV(estimator=elastic<br/> ,param_grid={‘alpha’:np.logspace(-5,2,8)<br/> ,’l1_ratio’:[0,.2,.4,.6,.8,1]}<br/> ,scoring=’neg_mean_squared_error’,n_jobs=1,refit=True,cv=10)</span><span id="c317" class="kk kl hh kg b fi kq kn l ko kp">search.fit(X,y)<br/>search.best_params_<br/>#{‘alpha’: 0.00001, ‘l1_ratio’: 0.0}<br/>abs(search.best_score_)<br/>#0.48067437262107227</span><span id="26f2" class="kk kl hh kg b fi kq kn l ko kp">elastic=ElasticNet(normalize=True,alpha=0.00001,l1_ratio=0.0, positive=True)<br/>elastic.fit(X,y)<br/>fourth_model_mse=(mean_squared_error(y_true=y,y_pred=elastic.predict(X)))<br/>print(fourth_model_mse)<br/>#0.46524447657943874</span><span id="e56f" class="kk kl hh kg b fi kq kn l ko kp">coef_dict_baseline = {}<br/>for coef, feat in zip(elastic.coef_,X.columns):<br/> coef_dict_baseline[feat] = coef<br/>coef_dict_baseline</span><span id="94ea" class="kk kl hh kg b fi kq kn l ko kp">{'fixed acidity': 0.031400560143859536,<br/> 'volatile acidity': 0.0,<br/> 'citric acid': 0.31972354746287335,<br/> 'residual sugar': 0.0,<br/> 'chlorides': 0.0,<br/> 'free sulfur dioxide': 0.0,<br/> 'total sulfur dioxide': 0.0,<br/> 'density': 0.0,<br/> 'pH': 0.0,<br/> 'sulphates': 0.8106956946266386,<br/> 'alcohol': 0.3400753372952517}</span></pre><p id="35a8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，这产生了一个与步骤8中相似的模型，除了系数因超参数而不同。</p><p id="3510" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我希望有些人觉得这很有帮助。我知道我会更经常地使用弹性网，因为我已经遇到了它。</p><div class="kr ks ez fb kt ku"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="kv ab dw"><div class="kw ab kx cl cj ky"><h2 class="bd hi fi z dy kz ea eb la ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="lb l"><h3 class="bd b fi z dy kz ea eb la ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="lc l"><p class="bd b fp z dy kz ea eb la ed ef dx translated">medium.com</p></div></div><div class="ld l"><div class="le l lf lg lh ld li in ku"/></div></div></a></div></div></div>    
</body>
</html>