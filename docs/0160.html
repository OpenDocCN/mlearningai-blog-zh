<html>
<head>
<title>Linear Regression — Simple explanation with example !!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归——简单举例说明！！</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/linear-regression-simple-explanation-with-example-fba51b2c181d?source=collection_archive---------0-----------------------#2021-02-24">https://medium.com/mlearning-ai/linear-regression-simple-explanation-with-example-fba51b2c181d?source=collection_archive---------0-----------------------#2021-02-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0013" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我试图用最简单的方法和例子来解释线性回归。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/ba79a510c3671617e52d3e6dab4b7278.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*VpV-UlPM9Bwilb2CCP9WPw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Typical Linear Regression plot</figcaption></figure><p id="69fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">回归被定义为一种试图确定两个或多个相关变量之间关系的统计方法。它用于在给定其他变量(也称为预测变量)的值的情况下，预测一个变量(也称为因变量)的值。</p><p id="51cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">回归算法属于监督学习方法，其中历史数据被标记并用于确定输出变量的值。</p><p id="4651" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果两个数值变量是线性相关的，那么它们的相关系数值将介于-1和1之间。当我们希望使用这种关系根据一个变量(因变量)的值来预测另一个变量(预测变量)的值时，我们使用线性回归。</p><p id="afb2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基于预测变量的数量，有两种类型的线性回归。：</p><ol class=""><li id="2f4e" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb jt ju jv jw bi translated"><strong class="ig hi">简单线性回归</strong>:只用一个预测变量来预测因变量的值。</li></ol><p id="9f51" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">直线方程:y = c + mx ( </strong>只有一个预测变量<strong class="ig hi"> x </strong>带系数<strong class="ig hi"> m) </strong></p><p id="affb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。多元线性回归</strong>:多个预测变量用于预测因变量的值。</p><p id="7830" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">直线方程:y = c + m1x1+ m2x2 + m3x3 … + mixi ( </strong>多预测变量x1，x2 … xi)。(<strong class="ig hi"> m1，m2 … mi </strong>是各自的系数<strong class="ig hi"> ) </strong></p><h1 id="d8f0" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">最佳拟合线:</strong></h1><p id="c2fc" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">我们知道散点图用于查看两个数值变量之间的相互关系，如果存在线性关系，我们通常会尝试拟合直线。但是我们不能称任何线为最佳拟合线。</p><p id="3f90" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的数据包含因变量(用<strong class="ig hi"> y </strong>表示)和自变量(用<strong class="ig hi"> X </strong>表示)的一组值，最佳拟合线是误差项的<strong class="ig hi">残差平方和</strong>最小的线。什么是错误术语？让我们找出答案。</p><p id="f4cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以会有一个由我们的线给出的‘y’值(我们称之为y_pred)和一个已经存在于我们的数据中的‘y’值(我们称之为y_true)。y_true和y_pred之间的差异给出了误差项(e)。每个X和y值都有一个误差项。</p><p id="7f2e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个误差项可以是正的，也可以是负的。所以我们取所有误差项的平方并求和。这称为误差项的<strong class="ig hi">残差平方和</strong>。</p><p id="7a00" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">因此，线性回归的目的是找到给定X和y变量的最佳拟合线，使得误差的残差平方和最小</strong>。在数学术语中，RSS是我们需要最小化的成本函数。有几种最小化技术，但最常用的是梯度下降法。</p><h1 id="a1eb" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">线性回归的假设:</strong></h1><p id="7e40" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">为了使用线性回归进行预测，有一些相关的假设:</p><ol class=""><li id="4793" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb jt ju jv jw bi translated">X和y之间存在线性关系。</li><li id="34e4" class="jo jp hh ig b ih la il lb ip lc it ld ix le jb jt ju jv jw bi translated">误差项服从正态分布。</li><li id="b8c3" class="jo jp hh ig b ih la il lb ip lc it ld ix le jb jt ju jv jw bi translated">误差项是相互独立的。</li><li id="93c2" class="jo jp hh ig b ih la il lb ip lc it ld ix le jb jt ju jv jw bi translated">误差项具有恒定的方差，也就是说，它们表现出同方差性。</li></ol><p id="fe83" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意，这里没有关于X和y分布的假设。</p><p id="9d83" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些假设适用于简单线性回归和多元线性回归。然而，当涉及到多元线性回归时，还有一些需要考虑的问题，我们将在举例时讨论。</p><p id="21da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们用一个例子来更好地理解整个线性回归概念。</p><p id="b2af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我采用了易于理解的医疗费用数据集，我们将在python中构建一个线性回归模型，用于使用给定的属性或变量集预测医疗费用。</p><p id="4877" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们导入必要的库:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lf"><img src="../Images/59be9ea987d6603e978674b65f7abd64.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*b0zLLyshP7CMA9sqBs9w2w.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Necessary libraries imported</figcaption></figure><p id="9ec5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后我们加载数据帧作为df。让我们看看我们的数据是什么样的。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lg"><img src="../Images/320a43ed5e49a8992ac9c735645d6cd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*wqAwGY6ynndf70MV8JWBSA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">First five rows of our data</figcaption></figure><p id="7886" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们可以看到，年龄、性别、体重指数、儿童、吸烟者和地区等各列构成了我们的预测变量(X ),费用是我们的因变量(y)</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lh"><img src="../Images/953f6ae32abe206874870cd4a87be473.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*65mIHYp1EOmB7Crgp85wig.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Basic analysis</figcaption></figure><p id="1600" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对我们的数据的基本分析表明，数据是干净的，没有丢失的值。然而，线性回归对异常值很敏感，因为异常值会影响RSS功能。所以我们需要确保没有异常值。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es li"><img src="../Images/e4e73018e4c28e8aae28622338120052.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*Uby3jiDqydNDNLv_hBYExg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Outliers analysis</figcaption></figure><p id="6c4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据似乎不错，所有的价值似乎都是真实的。</p><p id="b9fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我对这些数据进行了探索性数据分析(EDA)。在此过程中，我添加了两个分类列，即年龄组和身体质量指数组(分组基于世卫组织标准—<a class="ae lj" href="https://www.euro.who.int/en/health-topics/disease-prevention/nutrition/a-healthy-lifestyle/body-mass-index-bmi" rel="noopener ugc nofollow" target="_blank">https://www . euro . who . int/en/health-topics/disease-prevention/nutrition/a-healthy-life style/body-mass-index-BMI</a>。)</p><p id="b084" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些是我发现的重要推论:</p><ol class=""><li id="18ff" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb jt ju jv jw bi translated">吸烟者往往有较高的体重指数。</li><li id="599c" class="jo jp hh ig b ih la il lb ip lc it ld ix le jb jt ju jv jw bi translated"><strong class="ig hi"> 60+男性往往bmi较高。</strong></li><li id="3926" class="jo jp hh ig b ih la il lb ip lc it ld ix le jb jt ju jv jw bi translated"><strong class="ig hi">肥胖和超重的人bmi较高。</strong></li><li id="0862" class="jo jp hh ig b ih la il lb ip lc it ld ix le jb jt ju jv jw bi translated"><strong class="ig hi">西南地区bmi值高的人群较多。</strong></li><li id="a711" class="jo jp hh ig b ih la il lb ip lc it ld ix le jb jt ju jv jw bi translated"><strong class="ig hi">一般来说，肥胖和bmi会随着年龄的增长而增加。</strong></li></ol><p id="4663" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将进行回归分析。</p><p id="e7ca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们使用热图来看看我们的数据df的变量是如何关联的。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lk"><img src="../Images/acdf3f3851f97beebd9abd7622891a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*ZkCEpcqTbnI0hwVGecNERw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Heatmap showing correlations for data variables</figcaption></figure><p id="99c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们可以看到，由于我们的数据包含分类变量，因此并非所有变量都被捕获。我们需要首先对这些变量进行编码，以便在我们的模型构建过程中使用它们。为此，我们使用sklearn库中的标签编码器和预处理包。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ll"><img src="../Images/613a37667134dcabd1c4367e3f84eee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*7HCay1bn_7HUjayzyT5Csg.png"/></div></figure><p id="2899" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们对以下分类变量进行编码:“性别”、“身体质量指数群体”、“年龄群体”、“吸烟者”、“地区”。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lm"><img src="../Images/1d7d372c0a404c487ecf1df5ae37a68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*Xkp0eCd6Ms0K7qzEwh3zgw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Data frame after encoding categorical variables</figcaption></figure><p id="cdef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">回归分析最重要的部分之一是将数据分成训练集和测试集。训练集将是我们有标签的历史数据，我们将使用这些数据来训练我们的模型。然后，测试数据用于使用我们基于列车数据建立的模型进行预测。</p><p id="4595" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们使用sklearn库中的train_test_split方法将数据帧df分为df_train(包含70%的数据)和df_test(包含30%的数据)。</p><p id="5472" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，重要的一步是缩放数据。为什么要缩放？缩放有助于简化数据的可视化，最重要的是有助于梯度下降法更快地实现基础成本函数的最小值。有两种缩放方法:</p><p id="fc09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据标准化，我们将平均值= 0，标准差= 1的数据标准化。</p><p id="922e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MinMaxScaling，转换全部数据，使所有值都落在min。0和最大值。一</p><p id="8825" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们使用sklearn库中的MinMaxScaler来使用MinMaxScaling。</p><p id="1d3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，我们只对训练数据执行缩放。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ln"><img src="../Images/996cc2edf6eb72fed1e2e36766a7953d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*Y7j8Kx0xKXbIjnmB2tfKng.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Train data after scaling</figcaption></figure><h1 id="3421" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">建立模型:</strong></h1><p id="b04f" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">现在让我们使用热图来看看我们的预测变量是如何与因变量相关联的。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lo"><img src="../Images/1b2fa433738f981839530dea46f38618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*ePE60C0pvlVnYDz5wg64PA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Heatmap showing correlation between data variables</figcaption></figure><p id="269a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到变量“吸烟者”与变量“费用”的相关性最高，为0.78。然后是“年龄”、“体重指数”等。</p><p id="3169" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">简单线性回归:</strong>目前我们知道，简单线性回归有一个预测变量，用来预测因变量的值。因此，我们使用“吸烟者”变量建立一个简单的线性回归模型。</p><p id="8e8c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们使用statsmodels.api库来构建模型。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="er es lp"><img src="../Images/426a89cf4ab746a059cbd002ed59dc02.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*NeC8BdQkUgAUVU2GfCo6Uw.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx">Statistical Results of Simple Linear Regression model</figcaption></figure><p id="d75e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们了解一些统计基础知识。</p><p id="ceeb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> R </strong> - <strong class="ig hi">平方</strong> ( <strong class="ig hi"> R2 </strong>)是一个统计量，表示回归模型中自变量解释的因变量方差的比例。它随着变量数量的增加而增加。</p><p id="825b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">调整后的R </strong> - <strong class="ig hi">平方</strong>是对<strong class="ig hi"> R </strong> - <strong class="ig hi">平方</strong>的修改版本，用于调整回归模型中不重要的预测值。我们将在多元线性回归中说明它的意义。</p><p id="a1a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> p值</strong>表示自变量的显著性。值越低，该变量的意义越大。</p><p id="5bf8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">F-统计量和Prob(F-统计量)</strong>表示整体模型拟合度。F-statistic值应该很高，Prob(F-statistic_)值应该理想地接近零。这意味着很好的模型拟合。</p><p id="313b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们可以看到上面的统计数据，R平方值为0.61，这意味着因变量方差的61%由自变量解释。常数和吸烟者的p值为0。f统计量，两个值都是理想值。<strong class="ig hi">这是一个很好的模型，模型方程:</strong></p><p id="a419" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">费用= 0.1180 + 0.3822*(吸烟者)</strong></p><p id="eecf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们看看这个模型是否验证了线性回归的假设。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lu"><img src="../Images/d9b1c1c93f1beaff780dc2cb0516505e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*esa091kk_ah4nCy17OARnQ.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Plot of error terms</figcaption></figure><p id="6870" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们看到，通过从实际y_train值中减去训练数据的预测值而获得的误差项遵循正态分布。</p><p id="bd73" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">多元线性回归:</strong>即使我们得到了一个只有一个预测变量的好模型，让我们看看是否可以通过添加更多的变量来建立一个更好的模型。</p><p id="271f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们在“吸烟者”变量之后，添加与我们的目标变量“费用”相关的下一个变量“年龄”，相关性为0.31。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lv"><img src="../Images/f55441c4014b361209ad4580d4085b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*uuoTBc2R07i_if3BzuFe_Q.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Statistics after adding age variable</figcaption></figure><p id="935c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们看到，R平方增加了，调整后的R平方也增加了。“年龄”的p值为0，模型的F统计显示了良好的值。</p><p id="0c7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这意味着“年龄”是我们模型的一个重要变量。</p><p id="7ad0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们再增加一个变量“bmi”。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lw"><img src="../Images/d8ea34c598fc7e3c1d350f9686047e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*bm-NBeQjXkt80LGmtJnoUw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Statistics after adding bmi variable</figcaption></figure><p id="3511" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们看到，R平方增加了，调整后的R平方也增加了。bmi '再次具有0 p值，并且模型的F统计显示了良好的值。</p><p id="2702" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这意味着“bmi”是我们模型的一个重要变量。</p><p id="8ab1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们说过多元线性回归还有一些额外的考虑。它们是模型复杂性、多重共线性和特征选择。</p><p id="cae6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">模型复杂性:</strong>当您增加模型中的变量数量时，您的R平方将保持不变或增加。但是如果增加的变量微不足道呢？还增加了不必要的变量，使得模型庞大而复杂。也可能发生这样的情况，您的模型学习训练数据非常好，它对训练数据完全准确，但对测试数据给出不准确的结果。这被称为<strong class="ig hi">过拟合</strong>。为了解决这个问题，我们使用调整的R平方测量，惩罚无关紧要的变量的增加。这意味着，当我们在模型中加入任何无关紧要的变量时，调整后的R平方值就会减小。</p><p id="61c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">多重共线性:</strong>如果一个或多个变量之间存在相关关系，这种现象称为多重共线性。这影响了模型的推断和解释部分(统计)。系数可能在数值和符号上摇摆。但是多重共线性不会影响整体预测和模型拟合。因此，虽然我们的模型可以很好地处理一定量的多重共线性，但我们需要在必要时解决多重共线性。<strong class="ig hi"> VIF(方差膨胀因子)</strong>是解决多重共线性的好措施。</p><h2 id="7ca9" class="lx jy hh bd jz ly lz ma kd mb mc md kh ip me mf kl it mg mh kp ix mi mj kt mk bi translated"><strong class="ak"> VIF = 1/ (1 - R平方)</strong></h2><p id="849f" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">VIF &gt; 10是高的，不可接受的。</p><p id="e711" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">VIF &gt; 5需要检查。</p><p id="6d04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">VIF &lt; 5 acceptable.</p><p id="bec9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">As a thumb rule we can drop the variables that are highly correlated with others.</p><p id="5b86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">特征选择:</strong>可以称为选择建立模型所需变量的一种方法。有许多方法可以做到这一点。手动或自动、向前或向后、组合或平衡方法等。</p><p id="c00c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">继续我们的模型构建</strong>，到目前为止，我们不需要担心过度拟合，因为我们的变量数量较少。我们将逐步选择特征变量。但是随着变量数量的增加，我们需要寻找多重共线性。</p><p id="e282" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为此，我们使用sklearn库中的variance_inflation_factor。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ml"><img src="../Images/18237ffc0850b3578607ecc6304fde1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:290/format:webp/1*nkaQwlA_2nIQkpHuys0yZw.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">VIF values for independent variables</figcaption></figure><p id="cc63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所有数值似乎都在验收标准范围内。</p><p id="258a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们再添加一个变量‘孩子’。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mm"><img src="../Images/c3c383bfd3289c11f751c5adae60f659.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*2AN6nFg5Es3PM6ZDAmaqlQ.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Statistics after adding children variable</figcaption></figure><p id="8cba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们看到，R平方值增加到0.736，调整后的R平方值增加到0.735。预测变量的p值表明它们迄今为止是显著的。F统计值也是可以接受的。到目前为止，我们的模型运行良好。让我们看看VIF。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mn"><img src="../Images/e43c73bf5c99d419f6ad1c7c7f84e022.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/1*ipNdpTb6-hgRWjaWdzrdoQ.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">VIF values for predictor variables</figcaption></figure><p id="2373" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">到目前为止，VIF值也在可接受的范围内。</p><p id="ce0a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们加入另一个变量会发生什么？让我们添加“性别”变量。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mo"><img src="../Images/72f438e628d7e683a0dddcf8e1a3f689.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*hBIsov0CCXAsRThJNiFu0w.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Statistics after adding sex variable</figcaption></figure><p id="9b50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们观察到“性别”变量的p值很高。调整后的R平方值也略有下降。所以‘性别’变量并不显著。</p><p id="6ace" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还要注意，其他变量与我们的目标变量相关性很低或没有相关性。所以我们到此为止。</p><p id="1722" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们的最终模型由以下预测变量及其系数组成，如下所示:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mp"><img src="../Images/7ab4f9888a805346e41cfe74ff2adffa.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/format:webp/1*JTh8KKm47CC8WzHpgtymCg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Final predictor variables and their co-efficients</figcaption></figure><p id="b2d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以我们的模型准备好了。现在让我们检查测试数据的预测。</p><p id="6dae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们找到y_pred，然后计算误差项(y_test-y_pred)并绘制误差项。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mq"><img src="../Images/e157f8cbebaf966d22d06aff8bb1597e.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*u0mCccA7bD02QW4kKTyD-g.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx">Error terms plot for test data</figcaption></figure><p id="3f97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以我们最终得出结论，线性回归假设得到了验证。</p><p id="113d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们从零开始理解线性回归，先建立简单的线性回归模型，再建立多元线性回归模型。</p><p id="2c7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我试图用最简单的方式解释这些概念，这样每个阅读这篇文章的人都能理解线性回归是如何工作的。</p><p id="b229" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢你。</p><p id="f8f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mr">可以在LinkedIn上联系我:</em></strong><a class="ae lj" href="https://www.linkedin.com/in/pathakpuja/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi"><em class="mr">https://www.linkedin.com/in/pathakpuja/</em></strong></a></p><p id="23cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="mr">请访问我的GitHub简介获取python代码:</em></strong><a class="ae lj" href="https://github.com/pujappathak" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi"><em class="mr">https://github.com/pujappathak</em></strong></a></p><p id="5120" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你喜欢我的文章，请随时评论并给出你的反馈。 </p></div></div>    
</body>
</html>