<html>
<head>
<title>Extend BigQuery NLP armory with Stemmers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用词干分析器扩展BigQuery NLP库</h1>
<blockquote>原文：<a href="https://medium.com/mlearning-ai/extend-bigquery-nlp-armory-with-stemmers-995fae853b0e?source=collection_archive---------5-----------------------#2022-12-08">https://medium.com/mlearning-ai/extend-bigquery-nlp-armory-with-stemmers-995fae853b0e?source=collection_archive---------5-----------------------#2022-12-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="60e1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用Javascript UDFs实现英语、西班牙语和希腊语词干分析器。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/e22ac932ec1374595dfcaf1e8d97602d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHHm9ZeUIInTTYT6SmFr-Q.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/ja/@brett_jordan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Brett Jordan</a> on <a class="ae js" href="https://unsplash.com/s/photos/WORDS?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="870b" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">动机</h1><p id="81f6" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">为什么要扩展现代数据库的功能，而不是编写一个简短的Python函数？</p><p id="afda" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在云计算和无服务器架构的时代，许多组织正在脱离传统的内部系统，将其数据和应用程序迁移到云中。这使他们能够利用云计算的诸多优势，如可扩展性、灵活性和成本效益。</p><p id="f314" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个例子是现代数据库的广泛使用，如Google Bigquery、Amazon Redshift和Snowflake。现代数据库不仅能有效地存储和处理大量数据，还能支持超出传统数据库能力的各种附加功能。这些功能包括数据集成、数据处理、数据可视化甚至机器学习等特性。由于所有这些不同的任务都可以简化，用户可以减少他们需要花费的时间和精力，转而关注最重要的事情。</p><p id="1a96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，我们从各种来源收集了大量新闻文章，我们希望训练一个NLP模型。<br/>这需要几个领域的知识，包括编程、机器学习框架、数据库和服务器管理。必须知道如何用Python等编程语言编写脚本来准备数据，如何使用TensorFlow或PyTorch等机器学习框架来训练模型，以及如何使用MongoDB等NoSQL数据库来存储和检索数据。此外，在大型数据集上训练机器学习模型需要大量的计算能力，而管理基础设施来支持这一点可能是一项具有挑战性的任务，需要服务器管理方面的专业知识。<br/>另一方面，在像BigQuery这样的现代数据库中执行相同的步骤只需要了解SQL，这是一种广泛用于处理关系数据库中的数据的语言。</p><p id="6f8b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这样，使用现代数据库可以大大简化处理数据的过程，使更广泛的用户更容易访问数据。</p><h1 id="438a" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">堵塞物</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kw"><img src="../Images/9d2f40a90451e5ebc7aa9371aebbacf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/0*ltIGZv_0fGs66B4A.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Stemming, Photo by Author.</figcaption></figure><p id="c28f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">词干化是一种标准化单词技术，也是自然语言处理(NLP)中非常常见的预处理步骤，用于将单词简化为其基本形式或词干。词干是指一个词的词根形式的形态变体，它不一定总是有效的词根形式。词干处理允许将具有相同含义的单词视为单个项目，例如“连接”、“被连接”、“正在连接”、“连接”和“连接”，它们都源自相同的基本形式“连接”。这一过程减少了数据集中唯一单词的数量，这可以显著提高文本分析算法的效率和准确性。</p><p id="8ecb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谷歌搜索在2003年采用了词干分析法。以前搜索“鱼”不会返回“钓鱼”或“鱼”[1]。</p><p id="eede" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">词干算法通常使用试探法或基于规则的方法来从单词中识别和移除词缀(如前缀和后缀)，从而得到简化的单词形式。虽然这种方法可以非常快，但它也可能<strong class="ig hi"> </strong>容易出错，因此当速度和效率是重要的考虑因素时，应该首选这种方法。</p><p id="d1eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">错误可以被描述为词干过多或不足。<br/>当算法将单词减少到相同的词干，而它应该将它们减少到不同的词干时，就会发生过度词干化。例如，根据Porter stemmer,“大学”和“宇宙”被简化为“宇宙”,而应该简化为两个不同的词干，因为它们没有相同的含义。<br/>当算法将单词缩减为不同的词干，而它应该将它们缩减为相同的词干时，就会出现词干不足。例如，基于波特词干分析器，单词“数据”和“数据”在应该归入同一词干时，分别归入“数据”和“基准”。</p><p id="96e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">词干算法大致分为两类:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ky"><img src="../Images/7662acc33a179f12529c0fa4e69550b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xW7ab_TvH-YsQLwq.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Types of stemming algorithms. Photo by Singh J., Gupta V. [2].</figcaption></figure><p id="eb30" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">基于规则的<br/> </strong>一种强力方法是使用查表法将单词映射到词干。另一种众所周知的方法是通过应用一系列规则去除词缀来减少单词的词干。其他过程考虑词的形态，包括词性。这些方法需要大量的语言规则，因此是语言相关的。因此，大多数已知的基于规则的词干分析器可用于广泛研究的语言(英语)。基于规则的词干分析器包括Lovins、Dawson(基于Lovins)、Porter(最近的Porter2)、Paice/Husk(又名Lancaster)词干分析器。</p><p id="dde1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">统计<br/> </strong>统计方法需要从词典、语料库或语言单词的基于字符的n元语法中训练模型。使用这种方法，词缀剥离规则被导出。<br/>统计词干分析器与语言无关，因为它们不需要任何特定于语言的信息。统计词干分析器包括N-Gram、Krovetz和Xerox词干分析器。<br/>统计方法也是一个开放的研究领域，因为人们对具有少量语言资源的语言的文本搜索感兴趣。</p><p id="cce0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本教程中，我们将使用Javascript中已有的部分实现来实现一些基于规则的词干分析器:</p><ol class=""><li id="e080" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">Lovins(英语)[3] — <a class="ae js" href="https://github.com/Yomguithereal/talisman" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>(麻省理工学院许可)</li><li id="553f" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">波特(英语)[3] — <a class="ae js" href="https://github.com/Yomguithereal/talisman" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>(麻省理工学院许可证)</li><li id="7afe" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">Paice-Husk / Lancaster(英语)[3] — <a class="ae js" href="https://github.com/Yomguithereal/talisman" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>(麻省理工学院许可)</li><li id="d6d6" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">UniNE(西班牙语)[3] — <a class="ae js" href="https://github.com/Yomguithereal/talisman" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>(麻省理工学院许可)</li><li id="dd7f" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">希腊语斯特梅尔(希腊语)[4] — <a class="ae js" href="https://github.com/skroutz/greek_stemmer" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>(麻省理工学院许可)</li></ol><h1 id="38ac" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">BigQuery用户定义函数(UDF)</h1><p id="adfb" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated"><em class="kx">用户自定义函数(UDF)允许您使用SQL表达式或JavaScript代码创建函数。UDF接受输入列，对输入执行操作，并将这些操作的结果作为值返回。</em> <a class="ae js" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/user-defined-functions" rel="noopener ugc nofollow" target="_blank"> <em class="kx">谷歌文档</em> </a></p><p id="e8b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我们前面讨论的，我们选择使用BigQuery UDFs(用户定义函数)而不是为特定任务编写Python程序有几个原因。</p><ul class=""><li id="7d18" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb ln lf lg lh bi translated">简单易用:允许使用SQL在Bigquery中实现定制逻辑。这有很多好处，特别是对于不熟悉Python或其他编程语言的用户。</li><li id="b5b9" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ln lf lg lh bi translated">性能和可伸缩性:BigQuery UDFs可以在BigQuery分布式系统中的多个虚拟CPU(slot)上并行执行，允许对大型数据集进行高效和可伸缩的处理。相比之下，Python程序通常在单个服务器上运行，可能也无法扩展。</li><li id="8840" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ln lf lg lh bi translated">成本节约:BigQuery UDFs允许用户利用BigQuery的现有基础设施和资源，而不需要管理额外的计算资源来运行Python程序。</li></ul><p id="df0f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Bigquery支持两种类型的UDF，基于SQL的和基于Javascript的(也支持远程函数UDF，但我们将在另一篇文章中引用该功能)。</p><p id="81ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">基于SQL的<br/> </strong>当我们想要创建一个使用BigQuery现有功能的函数时，我们应该使用SQL UDFs。例如，我们想创建一个从单词中删除重复字母的函数。</p><pre class="jd je jf jg fd lo lp lq bn lr ls bi"><span id="e045" class="lt ju hh lp b be lu lv l lw lx">CREATE OR REPLACE FUNCTION `my-project.my-dataset.dedup_chars`(s STRING) AS (<br/>(SELECT<br/>  STRING_AGG(<br/>    IF<br/>      (c = SPLIT(s, '')[SAFE_OFFSET(off - 1)],<br/>        NULL,<br/>        c), '' ORDER BY off)<br/>FROM<br/>  UNNEST(SPLIT(s, '')) AS c<br/>  WITH OFFSET off)<br/>);</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ly"><img src="../Images/124256152377e195de680165300aebe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/0*Hj_n0x1aZ0OHVMWu.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">SQL-based UDF, Photo by Author.</figcaption></figure><p id="e888" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">基于Javascript的<br/> </strong>另一方面，当我们想要创建一个在<a class="ae js" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/functions-and-operators" rel="noopener ugc nofollow" target="_blank"> BigQuery的函数</a>上找不到，但在外部Javascript库中可以找到的函数时，我们应该使用基于Javascript的UDF。</p><p id="a68f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本教程中，我们将把不同的Javascript库组合成一个自定义的Javascript库，并用它来创建一些基于Javascript的UDF。</p><h1 id="9388" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">词干分析器实现</h1><p id="3a6c" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">点击查看完整代码<a class="ae js" href="https://github.com/justdataplease/bigquery-stemmers" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="3a44" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您只想在BigQuery中测试或使用词干功能，而不想实现它，请跳过这一节，转到下一个——词干分析器演示。T3】</p><p id="c28e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了实现Bigquery的词干分析器，我们将执行以下步骤:</p><ol class=""><li id="475a" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">克隆存储库</li></ol><pre class="jd je jf jg fd lo lp lq bn lr ls bi"><span id="c025" class="lt ju hh lp b be lu lv l lw lx">git clone https://github.com/justdataplease/bigquery-stemmers</span></pre><p id="dc28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的存储库具有以下结构:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lz"><img src="../Images/34cbf2f26b09a4803985687e96692382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*6-yBldJ-iplrgGyONcgxdQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx">Project structure, Photo by the Author.</figcaption></figure><ul class=""><li id="90a0" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb ln lf lg lh bi translated"><strong class="ig hi"> package.json </strong>:保存与项目相关的各种元数据，处理项目的依赖关系。</li><li id="5d71" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ln lf lg lh bi translated">src 文件夹:包含我们的javascript函数。里面有一个<strong class="ig hi"> index.js </strong>文件，我们在其中定义了函数(以及它们的名字)，我们希望将它们实现为UDF函数。</li><li id="d821" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ln lf lg lh bi translated"><strong class="ig hi"> webpack.config.js </strong>:使用<a class="ae js" href="https://webpack.js.org/" rel="noopener ugc nofollow" target="_blank"> webpack </a>包将我们所有的函数(在<strong class="ig hi"> index.js </strong>中定义)捆绑到一个文件<strong class="ig hi"> stemmers.js </strong>中。</li><li id="dd27" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb ln lf lg lh bi translated"><strong class="ig hi"> dist </strong>文件夹:包含webpack输出，<strong class="ig hi"> stemmers.js </strong>。</li></ul><p id="9d7e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.安装<strong class="ig hi"> package.json </strong>中定义的必要包。</p><pre class="jd je jf jg fd lo lp lq bn lr ls bi"><span id="be96" class="lt ju hh lp b be lu lv l lw lx">npm install</span></pre><p id="e4e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.使用<a class="ae js" href="https://webpack.js.org/" rel="noopener ugc nofollow" target="_blank"> webpack </a>运行<strong class="ig hi"> webpack.config.js </strong>来创建我们的包。</p><pre class="jd je jf jg fd lo lp lq bn lr ls bi"><span id="a8a0" class="lt ju hh lp b be lu lv l lw lx">npm run-script build</span></pre><p id="d7bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.在GCS中创建一个存储桶。确保用您的<a class="ae js" href="https://support.google.com/googleapi/answer/7014113?hl=en" rel="noopener ugc nofollow" target="_blank"> GCP项目id </a>更改“您的项目”,用您想要的存储桶名称更改“您的存储桶”(必须是全球唯一的)。</p><pre class="jd je jf jg fd lo lp lq bn lr ls bi"><span id="efe4" class="lt ju hh lp b be lu lv l lw lx">gsutil mb -c nearline -l europe-west3 -p yourproject gs://yourbucket</span></pre><p id="d781" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.将webpack输出或<strong class="ig hi"> stemmers.js </strong>复制到GCS。</p><pre class="jd je jf jg fd lo lp lq bn lr ls bi"><span id="0b0d" class="lt ju hh lp b be lu lv l lw lx">gsutil cp dist/stemmers.js gs://yourbucket</span></pre><p id="e04e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6.实现词干分析器。例如，我们将把下面的英语句子翻译成希腊语和西班牙语。</p><p id="517a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">“自然语言处理是语言学、计算机科学和人工智能的一个分支，涉及计算机和人类语言之间的交互”</strong></p><pre class="jd je jf jg fd lo lp lq bn lr ls bi"><span id="a8e5" class="lt ju hh lp b be lu lv l lw lx">-- Define corpus<br/>DECLARE grString,enString,esString STRING;<br/>SET grString = "Η επεξεργασία φυσικής γλώσσας είναι ένα υποπεδίο της γλωσσολογίας της επιστήμης των υπολογιστών και της τεχνητής νοημοσύνης που ασχολείται με τις αλληλεπιδράσεις μεταξύ των υπολογιστών και της ανθρώπινης γλώσσας";<br/>SET enString = "Natural language processing is a subfield of linguistics computer science and artificial intelligence concerned with the interactions between computers and human language";<br/>SET esString = "El procesamiento del lenguaje natural es un subcampo de la lingüística la informática y la inteligencia artificial que se ocupa de las interacciones entre las computadoras y el lenguaje humano";<br/><br/>-- Create greek stemmer<br/>CREATE TEMP FUNCTION grStemmer(word STRING)<br/>RETURNS STRING<br/>LANGUAGE js<br/>OPTIONS (<br/>library=["gs://yourbucket/stemmers.js"]<br/>)<br/>AS r"""<br/>return utils.greekStemmer(word);<br/>""";<br/><br/>-- Create english stemmer<br/>CREATE TEMP FUNCTION porterStemmer(word STRING)<br/>RETURNS STRING<br/>LANGUAGE js<br/>OPTIONS (<br/>library=["gs://yourbucket/stemmers.js"]<br/>)<br/>AS r"""<br/>return utils.porterStemmer(word);<br/>""";<br/><br/>-- Create Spanish stemmer<br/>CREATE TEMP FUNCTION esStemmer(word STRING)<br/>RETURNS STRING<br/>LANGUAGE js<br/>OPTIONS (<br/>library=["gs://yourbucket/stemmers.js"]<br/>)<br/>AS r"""<br/>return utils.unineStemmer(word);<br/>""";<br/><br/>-- Remove accents and convers to upper case - greek stemmer requirement<br/>CREATE TEMP FUNCTION fix_word(word STRING) AS ((<br/>SELECT UPPER(regexp_replace(normalize(word, NFD), r"\pM", ''))<br/>));<br/><br/>-- Union all sentenses<br/>WITH corpus AS (<br/>  SELECT word, 'gr' lang FROM UNNEST(SPLIT(grString," ")) word <br/>  UNION ALL<br/>  SELECT word, 'en' lang FROM UNNEST(SPLIT(enString," ")) word <br/>  UNION ALL<br/>  SELECT word,'es' lang FROM UNNEST(SPLIT(esString," ")) word <br/>)<br/><br/>-- Run stemmers<br/>SELECT <br/>lang,<br/>string_agg(<br/>CASE lang <br/>WHEN 'gr' THEN grStemmer(fix_word(word))<br/>WHEN 'en' THEN porterStemmer(word)<br/>WHEN 'es' THEN esStemmer(word) <br/>ELSE 'missing' END," ") stemmed, <br/>string_agg(word," ") original<br/>FROM corpus<br/>GROUP BY 1</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ma"><img src="../Images/dda3a34cde703995094e86461f7c34ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UOLIvdToFnbBfTEj.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Stemming output, Photo by the Author.</figcaption></figure><h1 id="2951" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">词干分析器演示</h1><p id="c8d5" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">您可以使用公开可用的函数来测试或使用BigQuery中词干分析器的功能(由Author — <a class="ae js" href="https://justdataplease.com/bigquery-justfunctions/" rel="noopener ugc nofollow" target="_blank"> JustFunctions </a>创建)。</p><p id="a009" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kx">以下示例是基于欧洲的数据集。要将位置更改为基于美国的数据集，请将“eu”更改为“us”(即just functions . eu . porter stemmer-&gt;just functions . us . porter stemmer)</em></p><pre class="jd je jf jg fd lo lp lq bn lr ls bi"><span id="0c81" class="lt ju hh lp b be lu lv l lw lx">-- Define corpus<br/>DECLARE grString,enString,esString STRING;<br/>SET grString = "Η επεξεργασία φυσικής γλώσσας είναι ένα υποπεδίο της γλωσσολογίας της επιστήμης των υπολογιστών και της τεχνητής νοημοσύνης που ασχολείται με τις αλληλεπιδράσεις μεταξύ των υπολογιστών και της ανθρώπινης γλώσσας";<br/>SET enString = "Natural language processing is a subfield of linguistics computer science and artificial intelligence concerned with the interactions between computers and human language";<br/>SET esString = "El procesamiento del lenguaje natural es un subcampo de la lingüística la informática y la inteligencia artificial que se ocupa de las interacciones entre las computadoras y el lenguaje humano";<br/><br/><br/>-- Remove accents and convers to upper case - greek stemmer requirement<br/>CREATE TEMP FUNCTION fix_word(word STRING) AS ((<br/>SELECT UPPER(regexp_replace(normalize(word, NFD), r"\pM", ''))<br/>));<br/><br/>-- Union all sentenses<br/>WITH corpus AS (<br/>  SELECT word, 'gr' lang FROM UNNEST(SPLIT(grString," ")) word <br/>  UNION ALL<br/>  SELECT word, 'en' lang FROM UNNEST(SPLIT(enString," ")) word <br/>  UNION ALL<br/>  SELECT word,'es' lang FROM UNNEST(SPLIT(esString," ")) word <br/>)<br/><br/>-- Run stemmers<br/>SELECT <br/>lang,<br/>string_agg(<br/>CASE lang <br/>WHEN 'gr' THEN justfunctions.eu.grStemmer(fix_word(word))<br/>WHEN 'en' THEN justfunctions.eu.porterStemmer(word)<br/>WHEN 'es' THEN justfunctions.eu.esStemmer(word) <br/>ELSE 'missing' END," ") stemmed, <br/>string_agg(word," ") original<br/>FROM corpus<br/>GROUP BY 1</span></pre><h1 id="3865" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="5c15" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">本文强调了现代数据库的重要性，以及如何使用BigQuery用户定义函数(UDF)来执行复杂的预处理任务，如词干提取。我们还通过用三种不同的语言实现一些基于规则的词干分析器来演示这一点。</p><h1 id="c01b" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><p id="8278" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">【1】<a class="ae js" href="https://en.wikipedia.org/wiki/Stemming" rel="noopener ugc nofollow" target="_blank">词干</a>，维基百科。</p><p id="3dd9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[2]辛格，j .，古普塔，v .，<a class="ae js" href="https://doi.org/10.1007/s10462-016-9498-2" rel="noopener ugc nofollow" target="_blank">对文本词干提取技术的系统评述。<em class="kx">Artif Intell Rev</em>T5】48，157–217</a>(2017)，<a class="ae js" href="https://www.springer.com/" rel="noopener ugc nofollow" target="_blank"> Springer </a>。</p><p id="10e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[3] Plique，g .<a class="ae js" href="https://joss.theoj.org/papers/10.21105/joss.02405" rel="noopener ugc nofollow" target="_blank">Talisman(2020)</a>，<a class="ae js" href="https://joss.theoj.org/" rel="noopener ugc nofollow" target="_blank">开源软件杂志(JOSS) </a>。</p><p id="a9ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[4] Ntais，g .，<a class="ae js" href="https://people.dsv.su.se/~hercules/papers/Ntais_greek_stemmer_thesis_final.pdf" rel="noopener ugc nofollow" target="_blank">希腊语斯特梅尔的开发(2006) </a>，<a class="ae js" href="http://dsv.su.se/" rel="noopener ugc nofollow" target="_blank">硕士论文——斯德哥尔摩大学计算机与系统科学系</a>。</p><div class="mb mc ez fb md me"><a rel="noopener follow" target="_blank" href="/mlearning-ai/mlearning-ai-submission-suggestions-b51e2b130bfb"><div class="mf ab dw"><div class="mg ab mh cl cj mi"><h2 class="bd hi fi z dy mj ea eb mk ed ef hg bi translated">Mlearning.ai提交建议</h2><div class="ml l"><h3 class="bd b fi z dy mj ea eb mk ed ef dx translated">如何成为Mlearning.ai上的作家</h3></div><div class="mm l"><p class="bd b fp z dy mj ea eb mk ed ef dx translated">medium.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms jm me"/></div></div></a></div></div></div>    
</body>
</html>